[
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich conference published the most publications in the last 15 years? Give the conference name and publication count.\n\n【数据库schema】\n【DB_ID】 academic\n【Schema】\n# Table: author\n[\n  (aid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3'].),\n  (homepage:text, URL of the author's personal website. Value examples: ['www.larry.com', 'www.ashish.com', 'www.noam.com'].),\n  (name:text, Name of the author. Value examples: ['Larry Summers', 'Ashish Vaswani', 'Noam Shazeer'].),\n  (oid:bigint, Foreign key referencing the organization the author belongs to. Value examples: ['2', '3', '3'].),\n]\n# Table: cite\n[\n  (cited:bigint, ID of the publication being cited. Value examples: ['1', '1', '1'].),\n  (citing:bigint, ID of the publication that is citing another publication. Value examples: ['2', '3', '4'].),\n]\n# Table: conference\n[\n  (cid:bigint, Unique identifier for a conference. Value examples: ['1', '2', '3'].),\n  (homepage:text, The homepage URL for the conference. Value examples: ['www.isa.com', 'www.aaas.com', 'www.icml.com'].),\n  (name:text, The name of the conference. Value examples: ['ISA', 'AAAS', 'ICML'].),\n]\n# Table: domain\n[\n  (did:bigint, Unique identifier for a domain. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the domain. Value examples: ['Data Science', 'Natural Sciences', 'Computer Science'].),\n]\n# Table: domain_author\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1'].),\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['2', '4'].),\n]\n# Table: domain_conference\n[\n  (cid:bigint, Foreign key referencing the cid column in the conference table. Value examples: ['1', '2', '3'].),\n  (did:bigint, Foreign key referencing the did column in the domain table. Value examples: ['2', '4', '5'].),\n]\n# Table: domain_journal\n[\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['1', '2'].),\n  (jid:bigint, Foreign key referencing the journal table's primary key. Value examples: ['2', '3'].),\n]\n# Table: domain_keyword\n[\n  (did:bigint, Foreign key referencing the 'did' column of the 'domain' table. Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the 'kid' column of the 'keyword' table. Value examples: ['2', '3'].),\n]\n# Table: domain_publication\n[\n  (did:bigint, Foreign key referencing the domain table's primary key column (did). Value examples: ['4', '2', '1'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key column (pid). Value examples: ['1', '2', '3'].),\n]\n# Table: journal\n[\n  (homepage:text, The homepage URL for the journal. Value examples: ['www.aijournal.com', 'www.nature.com', 'www.science.com', 'www.ml.com'].),\n  (jid:bigint, Unique identifier for a journal. Value examples: ['1', '2', '3', '4'].),\n  (name:text, The name of the journal. Value examples: ['Journal of Artificial Intelligence Research', 'Nature', 'Science', 'Journal of Machine Learning Research'].),\n]\n# Table: keyword\n[\n  (keyword:text, The actual keyword. Value examples: ['AI', 'Neuroscience', 'Machine Learning', 'Keyword 4'].),\n  (kid:bigint, Unique identifier for a keyword. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: organization\n[\n  (continent:text, Continent where the organization is located. Value examples: ['Asia', 'North America', 'North America'].),\n  (homepage:text, URL of the organization's homepage. Value examples: ['www.organization1.com', 'www.organization2.com', 'www.organization3.com'].),\n  (name:text, Name of the organization. Value examples: ['Organization 1', 'Organization 2', 'Organization 3'].),\n  (oid:bigint, Unique identifier for the organization. Value examples: ['1', '2', '3'].),\n]\n# Table: publication\n[\n  (abstract:text, The abstract of the publication. Value examples: ['Abstract 1', 'Abstract 2'].),\n  (cid:bigint, The ID of the conference where the publication was presented. Value examples: ['1', '2'].),\n  (citation_num:bigint, The number of citations received by the publication. Value examples: ['4', '2'].),\n  (jid:bigint, The ID of the journal where the publication was published. Value examples: ['1', '2'].),\n  (pid:bigint, The unique ID of the publication. Value examples: ['1', '2'].),\n  (reference_num:bigint, The number of references cited by the publication. Value examples: ['0', '1'].),\n  (title:text, The title of the publication. Value examples: ['The Effects of Climate Change on Agriculture', 'A Study on the Effects of Social Media on Mental Health'].),\n  (year:bigint, The year of publication. Value examples: ['2020', '2020'].),\n]\n# Table: publication_keyword\n[\n  (pid:bigint, Foreign key referencing the publication table's primary key (pid). Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the keyword table's primary key (kid). Value examples: ['2', '3'].),\n]\n# Table: writes\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1', '2', '2'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.aid = domain_author.aid\nauthor.oid = organization.oid\nauthor.aid = writes.aid\ncite.cited = publication.pid\nconference.cid = domain_conference.cid\nconference.cid = publication.cid\ndomain.did = domain_author.did\ndomain.did = domain_conference.did\ndomain.did = domain_journal.did\ndomain.did = domain_keyword.did\ndomain_journal.jid = journal.jid\ndomain_keyword.kid = keyword.kid\ndomain_publication.pid = publication.pid\njournal.jid = publication.jid\nkeyword.kid = publication_keyword.kid\npublication.pid = publication_keyword.pid\npublication.pid = writes.pid\n\n【参考信息】\n\n\n【用户问题】\nWhich conference published the most publications in the last 15 years? Give the conference name and publication count.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT conference.name, count(publication.pid) AS publication_count FROM publication JOIN conference ON publication.cid = conference.cid WHERE publication.year >= extract(YEAR FROM CURRENT_DATE) - 15 GROUP BY conference.name ORDER BY publication_count DESC LIMIT 1;",
        "role": "assistant"
      }
    ],
    "db_name": "academic",
    "id": 0,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many publications were published between 2019 and 2021?\n\n【数据库schema】\n【DB_ID】 academic\n【Schema】\n# Table: author\n[\n  (aid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3'].),\n  (homepage:text, URL of the author's personal website. Value examples: ['www.larry.com', 'www.ashish.com', 'www.noam.com'].),\n  (name:text, Name of the author. Value examples: ['Larry Summers', 'Ashish Vaswani', 'Noam Shazeer'].),\n  (oid:bigint, Foreign key referencing the organization the author belongs to. Value examples: ['2', '3', '3'].),\n]\n# Table: cite\n[\n  (cited:bigint, ID of the publication being cited. Value examples: ['1', '1', '1'].),\n  (citing:bigint, ID of the publication that is citing another publication. Value examples: ['2', '3', '4'].),\n]\n# Table: conference\n[\n  (cid:bigint, Unique identifier for a conference. Value examples: ['1', '2', '3'].),\n  (homepage:text, The homepage URL for the conference. Value examples: ['www.isa.com', 'www.aaas.com', 'www.icml.com'].),\n  (name:text, The name of the conference. Value examples: ['ISA', 'AAAS', 'ICML'].),\n]\n# Table: domain\n[\n  (did:bigint, Unique identifier for a domain. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the domain. Value examples: ['Data Science', 'Natural Sciences', 'Computer Science'].),\n]\n# Table: domain_author\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1'].),\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['2', '4'].),\n]\n# Table: domain_conference\n[\n  (cid:bigint, Foreign key referencing the cid column in the conference table. Value examples: ['1', '2', '3'].),\n  (did:bigint, Foreign key referencing the did column in the domain table. Value examples: ['2', '4', '5'].),\n]\n# Table: domain_journal\n[\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['1', '2'].),\n  (jid:bigint, Foreign key referencing the journal table's primary key. Value examples: ['2', '3'].),\n]\n# Table: domain_keyword\n[\n  (did:bigint, Foreign key referencing the 'did' column of the 'domain' table. Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the 'kid' column of the 'keyword' table. Value examples: ['2', '3'].),\n]\n# Table: domain_publication\n[\n  (did:bigint, Foreign key referencing the domain table's primary key column (did). Value examples: ['4', '2', '1'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key column (pid). Value examples: ['1', '2', '3'].),\n]\n# Table: journal\n[\n  (homepage:text, The homepage URL for the journal. Value examples: ['www.aijournal.com', 'www.nature.com', 'www.science.com', 'www.ml.com'].),\n  (jid:bigint, Unique identifier for a journal. Value examples: ['1', '2', '3', '4'].),\n  (name:text, The name of the journal. Value examples: ['Journal of Artificial Intelligence Research', 'Nature', 'Science', 'Journal of Machine Learning Research'].),\n]\n# Table: keyword\n[\n  (keyword:text, The actual keyword. Value examples: ['AI', 'Neuroscience', 'Machine Learning', 'Keyword 4'].),\n  (kid:bigint, Unique identifier for a keyword. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: organization\n[\n  (continent:text, Continent where the organization is located. Value examples: ['Asia', 'North America', 'North America'].),\n  (homepage:text, URL of the organization's homepage. Value examples: ['www.organization1.com', 'www.organization2.com', 'www.organization3.com'].),\n  (name:text, Name of the organization. Value examples: ['Organization 1', 'Organization 2', 'Organization 3'].),\n  (oid:bigint, Unique identifier for the organization. Value examples: ['1', '2', '3'].),\n]\n# Table: publication\n[\n  (abstract:text, The abstract of the publication. Value examples: ['Abstract 1', 'Abstract 2'].),\n  (cid:bigint, The ID of the conference where the publication was presented. Value examples: ['1', '2'].),\n  (citation_num:bigint, The number of citations received by the publication. Value examples: ['4', '2'].),\n  (jid:bigint, The ID of the journal where the publication was published. Value examples: ['1', '2'].),\n  (pid:bigint, The unique ID of the publication. Value examples: ['1', '2'].),\n  (reference_num:bigint, The number of references cited by the publication. Value examples: ['0', '1'].),\n  (title:text, The title of the publication. Value examples: ['The Effects of Climate Change on Agriculture', 'A Study on the Effects of Social Media on Mental Health'].),\n  (year:bigint, The year of publication. Value examples: ['2020', '2020'].),\n]\n# Table: publication_keyword\n[\n  (pid:bigint, Foreign key referencing the publication table's primary key (pid). Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the keyword table's primary key (kid). Value examples: ['2', '3'].),\n]\n# Table: writes\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1', '2', '2'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.aid = domain_author.aid\nauthor.oid = organization.oid\nauthor.aid = writes.aid\ncite.cited = publication.pid\nconference.cid = domain_conference.cid\nconference.cid = publication.cid\ndomain.did = domain_author.did\ndomain.did = domain_conference.did\ndomain.did = domain_journal.did\ndomain.did = domain_keyword.did\ndomain_journal.jid = journal.jid\ndomain_keyword.kid = keyword.kid\ndomain_publication.pid = publication.pid\njournal.jid = publication.jid\nkeyword.kid = publication_keyword.kid\npublication.pid = publication_keyword.pid\npublication.pid = writes.pid\n\n【参考信息】\n\n\n【用户问题】\nHow many publications were published between 2019 and 2021?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT count(DISTINCT publication.pid) FROM publication WHERE publication.year BETWEEN 2019 AND 2021;",
        "role": "assistant"
      }
    ],
    "db_name": "academic",
    "id": 1,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the average number of citations received by publications in the last 5 years?\n\n【数据库schema】\n【DB_ID】 academic\n【Schema】\n# Table: author\n[\n  (aid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3'].),\n  (homepage:text, URL of the author's personal website. Value examples: ['www.larry.com', 'www.ashish.com', 'www.noam.com'].),\n  (name:text, Name of the author. Value examples: ['Larry Summers', 'Ashish Vaswani', 'Noam Shazeer'].),\n  (oid:bigint, Foreign key referencing the organization the author belongs to. Value examples: ['2', '3', '3'].),\n]\n# Table: cite\n[\n  (cited:bigint, ID of the publication being cited. Value examples: ['1', '1', '1'].),\n  (citing:bigint, ID of the publication that is citing another publication. Value examples: ['2', '3', '4'].),\n]\n# Table: conference\n[\n  (cid:bigint, Unique identifier for a conference. Value examples: ['1', '2', '3'].),\n  (homepage:text, The homepage URL for the conference. Value examples: ['www.isa.com', 'www.aaas.com', 'www.icml.com'].),\n  (name:text, The name of the conference. Value examples: ['ISA', 'AAAS', 'ICML'].),\n]\n# Table: domain\n[\n  (did:bigint, Unique identifier for a domain. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the domain. Value examples: ['Data Science', 'Natural Sciences', 'Computer Science'].),\n]\n# Table: domain_author\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1'].),\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['2', '4'].),\n]\n# Table: domain_conference\n[\n  (cid:bigint, Foreign key referencing the cid column in the conference table. Value examples: ['1', '2', '3'].),\n  (did:bigint, Foreign key referencing the did column in the domain table. Value examples: ['2', '4', '5'].),\n]\n# Table: domain_journal\n[\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['1', '2'].),\n  (jid:bigint, Foreign key referencing the journal table's primary key. Value examples: ['2', '3'].),\n]\n# Table: domain_keyword\n[\n  (did:bigint, Foreign key referencing the 'did' column of the 'domain' table. Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the 'kid' column of the 'keyword' table. Value examples: ['2', '3'].),\n]\n# Table: domain_publication\n[\n  (did:bigint, Foreign key referencing the domain table's primary key column (did). Value examples: ['4', '2', '1'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key column (pid). Value examples: ['1', '2', '3'].),\n]\n# Table: journal\n[\n  (homepage:text, The homepage URL for the journal. Value examples: ['www.aijournal.com', 'www.nature.com', 'www.science.com', 'www.ml.com'].),\n  (jid:bigint, Unique identifier for a journal. Value examples: ['1', '2', '3', '4'].),\n  (name:text, The name of the journal. Value examples: ['Journal of Artificial Intelligence Research', 'Nature', 'Science', 'Journal of Machine Learning Research'].),\n]\n# Table: keyword\n[\n  (keyword:text, The actual keyword. Value examples: ['AI', 'Neuroscience', 'Machine Learning', 'Keyword 4'].),\n  (kid:bigint, Unique identifier for a keyword. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: organization\n[\n  (continent:text, Continent where the organization is located. Value examples: ['Asia', 'North America', 'North America'].),\n  (homepage:text, URL of the organization's homepage. Value examples: ['www.organization1.com', 'www.organization2.com', 'www.organization3.com'].),\n  (name:text, Name of the organization. Value examples: ['Organization 1', 'Organization 2', 'Organization 3'].),\n  (oid:bigint, Unique identifier for the organization. Value examples: ['1', '2', '3'].),\n]\n# Table: publication\n[\n  (abstract:text, The abstract of the publication. Value examples: ['Abstract 1', 'Abstract 2'].),\n  (cid:bigint, The ID of the conference where the publication was presented. Value examples: ['1', '2'].),\n  (citation_num:bigint, The number of citations received by the publication. Value examples: ['4', '2'].),\n  (jid:bigint, The ID of the journal where the publication was published. Value examples: ['1', '2'].),\n  (pid:bigint, The unique ID of the publication. Value examples: ['1', '2'].),\n  (reference_num:bigint, The number of references cited by the publication. Value examples: ['0', '1'].),\n  (title:text, The title of the publication. Value examples: ['The Effects of Climate Change on Agriculture', 'A Study on the Effects of Social Media on Mental Health'].),\n  (year:bigint, The year of publication. Value examples: ['2020', '2020'].),\n]\n# Table: publication_keyword\n[\n  (pid:bigint, Foreign key referencing the publication table's primary key (pid). Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the keyword table's primary key (kid). Value examples: ['2', '3'].),\n]\n# Table: writes\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1', '2', '2'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.aid = domain_author.aid\nauthor.oid = organization.oid\nauthor.aid = writes.aid\ncite.cited = publication.pid\nconference.cid = domain_conference.cid\nconference.cid = publication.cid\ndomain.did = domain_author.did\ndomain.did = domain_conference.did\ndomain.did = domain_journal.did\ndomain.did = domain_keyword.did\ndomain_journal.jid = journal.jid\ndomain_keyword.kid = keyword.kid\ndomain_publication.pid = publication.pid\njournal.jid = publication.jid\nkeyword.kid = publication_keyword.kid\npublication.pid = publication_keyword.pid\npublication.pid = writes.pid\n\n【参考信息】\n\n\n【用户问题】\nWhat is the average number of citations received by publications in the last 5 years?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT avg(publication.citation_num) FROM publication WHERE publication.year >= extract(YEAR FROM CURRENT_DATE) - 5;",
        "role": "assistant"
      }
    ],
    "db_name": "academic",
    "id": 2,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich authors have published papers in journals within the past 20 years?\n\n【数据库schema】\n【DB_ID】 academic\n【Schema】\n# Table: author\n[\n  (aid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3'].),\n  (homepage:text, URL of the author's personal website. Value examples: ['www.larry.com', 'www.ashish.com', 'www.noam.com'].),\n  (name:text, Name of the author. Value examples: ['Larry Summers', 'Ashish Vaswani', 'Noam Shazeer'].),\n  (oid:bigint, Foreign key referencing the organization the author belongs to. Value examples: ['2', '3', '3'].),\n]\n# Table: cite\n[\n  (cited:bigint, ID of the publication being cited. Value examples: ['1', '1', '1'].),\n  (citing:bigint, ID of the publication that is citing another publication. Value examples: ['2', '3', '4'].),\n]\n# Table: conference\n[\n  (cid:bigint, Unique identifier for a conference. Value examples: ['1', '2', '3'].),\n  (homepage:text, The homepage URL for the conference. Value examples: ['www.isa.com', 'www.aaas.com', 'www.icml.com'].),\n  (name:text, The name of the conference. Value examples: ['ISA', 'AAAS', 'ICML'].),\n]\n# Table: domain\n[\n  (did:bigint, Unique identifier for a domain. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the domain. Value examples: ['Data Science', 'Natural Sciences', 'Computer Science'].),\n]\n# Table: domain_author\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1'].),\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['2', '4'].),\n]\n# Table: domain_conference\n[\n  (cid:bigint, Foreign key referencing the cid column in the conference table. Value examples: ['1', '2', '3'].),\n  (did:bigint, Foreign key referencing the did column in the domain table. Value examples: ['2', '4', '5'].),\n]\n# Table: domain_journal\n[\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['1', '2'].),\n  (jid:bigint, Foreign key referencing the journal table's primary key. Value examples: ['2', '3'].),\n]\n# Table: domain_keyword\n[\n  (did:bigint, Foreign key referencing the 'did' column of the 'domain' table. Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the 'kid' column of the 'keyword' table. Value examples: ['2', '3'].),\n]\n# Table: domain_publication\n[\n  (did:bigint, Foreign key referencing the domain table's primary key column (did). Value examples: ['4', '2', '1'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key column (pid). Value examples: ['1', '2', '3'].),\n]\n# Table: journal\n[\n  (homepage:text, The homepage URL for the journal. Value examples: ['www.aijournal.com', 'www.nature.com', 'www.science.com', 'www.ml.com'].),\n  (jid:bigint, Unique identifier for a journal. Value examples: ['1', '2', '3', '4'].),\n  (name:text, The name of the journal. Value examples: ['Journal of Artificial Intelligence Research', 'Nature', 'Science', 'Journal of Machine Learning Research'].),\n]\n# Table: keyword\n[\n  (keyword:text, The actual keyword. Value examples: ['AI', 'Neuroscience', 'Machine Learning', 'Keyword 4'].),\n  (kid:bigint, Unique identifier for a keyword. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: organization\n[\n  (continent:text, Continent where the organization is located. Value examples: ['Asia', 'North America', 'North America'].),\n  (homepage:text, URL of the organization's homepage. Value examples: ['www.organization1.com', 'www.organization2.com', 'www.organization3.com'].),\n  (name:text, Name of the organization. Value examples: ['Organization 1', 'Organization 2', 'Organization 3'].),\n  (oid:bigint, Unique identifier for the organization. Value examples: ['1', '2', '3'].),\n]\n# Table: publication\n[\n  (abstract:text, The abstract of the publication. Value examples: ['Abstract 1', 'Abstract 2'].),\n  (cid:bigint, The ID of the conference where the publication was presented. Value examples: ['1', '2'].),\n  (citation_num:bigint, The number of citations received by the publication. Value examples: ['4', '2'].),\n  (jid:bigint, The ID of the journal where the publication was published. Value examples: ['1', '2'].),\n  (pid:bigint, The unique ID of the publication. Value examples: ['1', '2'].),\n  (reference_num:bigint, The number of references cited by the publication. Value examples: ['0', '1'].),\n  (title:text, The title of the publication. Value examples: ['The Effects of Climate Change on Agriculture', 'A Study on the Effects of Social Media on Mental Health'].),\n  (year:bigint, The year of publication. Value examples: ['2020', '2020'].),\n]\n# Table: publication_keyword\n[\n  (pid:bigint, Foreign key referencing the publication table's primary key (pid). Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the keyword table's primary key (kid). Value examples: ['2', '3'].),\n]\n# Table: writes\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1', '2', '2'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.aid = domain_author.aid\nauthor.oid = organization.oid\nauthor.aid = writes.aid\ncite.cited = publication.pid\nconference.cid = domain_conference.cid\nconference.cid = publication.cid\ndomain.did = domain_author.did\ndomain.did = domain_conference.did\ndomain.did = domain_journal.did\ndomain.did = domain_keyword.did\ndomain_journal.jid = journal.jid\ndomain_keyword.kid = keyword.kid\ndomain_publication.pid = publication.pid\njournal.jid = publication.jid\nkeyword.kid = publication_keyword.kid\npublication.pid = publication_keyword.pid\npublication.pid = writes.pid\n\n【参考信息】\n\n\n【用户问题】\nWhich authors have published papers in journals within the past 20 years?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT DISTINCT author.name, author.aid FROM author JOIN writes ON author.aid = writes.aid JOIN publication ON writes.pid = publication.pid WHERE publication.year >= extract(YEAR FROM CURRENT_DATE) - 20",
        "role": "assistant"
      }
    ],
    "db_name": "academic",
    "id": 3,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat's the difference in time between the first and last paper published?\n\n【数据库schema】\n【DB_ID】 academic\n【Schema】\n# Table: author\n[\n  (aid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3'].),\n  (homepage:text, URL of the author's personal website. Value examples: ['www.larry.com', 'www.ashish.com', 'www.noam.com'].),\n  (name:text, Name of the author. Value examples: ['Larry Summers', 'Ashish Vaswani', 'Noam Shazeer'].),\n  (oid:bigint, Foreign key referencing the organization the author belongs to. Value examples: ['2', '3', '3'].),\n]\n# Table: cite\n[\n  (cited:bigint, ID of the publication being cited. Value examples: ['1', '1', '1'].),\n  (citing:bigint, ID of the publication that is citing another publication. Value examples: ['2', '3', '4'].),\n]\n# Table: conference\n[\n  (cid:bigint, Unique identifier for a conference. Value examples: ['1', '2', '3'].),\n  (homepage:text, The homepage URL for the conference. Value examples: ['www.isa.com', 'www.aaas.com', 'www.icml.com'].),\n  (name:text, The name of the conference. Value examples: ['ISA', 'AAAS', 'ICML'].),\n]\n# Table: domain\n[\n  (did:bigint, Unique identifier for a domain. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the domain. Value examples: ['Data Science', 'Natural Sciences', 'Computer Science'].),\n]\n# Table: domain_author\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1'].),\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['2', '4'].),\n]\n# Table: domain_conference\n[\n  (cid:bigint, Foreign key referencing the cid column in the conference table. Value examples: ['1', '2', '3'].),\n  (did:bigint, Foreign key referencing the did column in the domain table. Value examples: ['2', '4', '5'].),\n]\n# Table: domain_journal\n[\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['1', '2'].),\n  (jid:bigint, Foreign key referencing the journal table's primary key. Value examples: ['2', '3'].),\n]\n# Table: domain_keyword\n[\n  (did:bigint, Foreign key referencing the 'did' column of the 'domain' table. Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the 'kid' column of the 'keyword' table. Value examples: ['2', '3'].),\n]\n# Table: domain_publication\n[\n  (did:bigint, Foreign key referencing the domain table's primary key column (did). Value examples: ['4', '2', '1'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key column (pid). Value examples: ['1', '2', '3'].),\n]\n# Table: journal\n[\n  (homepage:text, The homepage URL for the journal. Value examples: ['www.aijournal.com', 'www.nature.com', 'www.science.com', 'www.ml.com'].),\n  (jid:bigint, Unique identifier for a journal. Value examples: ['1', '2', '3', '4'].),\n  (name:text, The name of the journal. Value examples: ['Journal of Artificial Intelligence Research', 'Nature', 'Science', 'Journal of Machine Learning Research'].),\n]\n# Table: keyword\n[\n  (keyword:text, The actual keyword. Value examples: ['AI', 'Neuroscience', 'Machine Learning', 'Keyword 4'].),\n  (kid:bigint, Unique identifier for a keyword. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: organization\n[\n  (continent:text, Continent where the organization is located. Value examples: ['Asia', 'North America', 'North America'].),\n  (homepage:text, URL of the organization's homepage. Value examples: ['www.organization1.com', 'www.organization2.com', 'www.organization3.com'].),\n  (name:text, Name of the organization. Value examples: ['Organization 1', 'Organization 2', 'Organization 3'].),\n  (oid:bigint, Unique identifier for the organization. Value examples: ['1', '2', '3'].),\n]\n# Table: publication\n[\n  (abstract:text, The abstract of the publication. Value examples: ['Abstract 1', 'Abstract 2'].),\n  (cid:bigint, The ID of the conference where the publication was presented. Value examples: ['1', '2'].),\n  (citation_num:bigint, The number of citations received by the publication. Value examples: ['4', '2'].),\n  (jid:bigint, The ID of the journal where the publication was published. Value examples: ['1', '2'].),\n  (pid:bigint, The unique ID of the publication. Value examples: ['1', '2'].),\n  (reference_num:bigint, The number of references cited by the publication. Value examples: ['0', '1'].),\n  (title:text, The title of the publication. Value examples: ['The Effects of Climate Change on Agriculture', 'A Study on the Effects of Social Media on Mental Health'].),\n  (year:bigint, The year of publication. Value examples: ['2020', '2020'].),\n]\n# Table: publication_keyword\n[\n  (pid:bigint, Foreign key referencing the publication table's primary key (pid). Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the keyword table's primary key (kid). Value examples: ['2', '3'].),\n]\n# Table: writes\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1', '2', '2'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.aid = domain_author.aid\nauthor.oid = organization.oid\nauthor.aid = writes.aid\ncite.cited = publication.pid\nconference.cid = domain_conference.cid\nconference.cid = publication.cid\ndomain.did = domain_author.did\ndomain.did = domain_conference.did\ndomain.did = domain_journal.did\ndomain.did = domain_keyword.did\ndomain_journal.jid = journal.jid\ndomain_keyword.kid = keyword.kid\ndomain_publication.pid = publication.pid\njournal.jid = publication.jid\nkeyword.kid = publication_keyword.kid\npublication.pid = publication_keyword.pid\npublication.pid = writes.pid\n\n【参考信息】\n\n\n【用户问题】\nWhat's the difference in time between the first and last paper published?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT max(YEAR) - min(YEAR) AS time_difference FROM publication;",
        "role": "assistant"
      }
    ],
    "db_name": "academic",
    "id": 4,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich authors have written publications in both the domain \"Machine Learning\" and the domain \"Data Science\"?\n\n【数据库schema】\n【DB_ID】 academic\n【Schema】\n# Table: author\n[\n  (aid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3'].),\n  (homepage:text, URL of the author's personal website. Value examples: ['www.larry.com', 'www.ashish.com', 'www.noam.com'].),\n  (name:text, Name of the author. Value examples: ['Larry Summers', 'Ashish Vaswani', 'Noam Shazeer'].),\n  (oid:bigint, Foreign key referencing the organization the author belongs to. Value examples: ['2', '3', '3'].),\n]\n# Table: cite\n[\n  (cited:bigint, ID of the publication being cited. Value examples: ['1', '1', '1'].),\n  (citing:bigint, ID of the publication that is citing another publication. Value examples: ['2', '3', '4'].),\n]\n# Table: conference\n[\n  (cid:bigint, Unique identifier for a conference. Value examples: ['1', '2', '3'].),\n  (homepage:text, The homepage URL for the conference. Value examples: ['www.isa.com', 'www.aaas.com', 'www.icml.com'].),\n  (name:text, The name of the conference. Value examples: ['ISA', 'AAAS', 'ICML'].),\n]\n# Table: domain\n[\n  (did:bigint, Unique identifier for a domain. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the domain. Value examples: ['Data Science', 'Natural Sciences', 'Computer Science'].),\n]\n# Table: domain_author\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1'].),\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['2', '4'].),\n]\n# Table: domain_conference\n[\n  (cid:bigint, Foreign key referencing the cid column in the conference table. Value examples: ['1', '2', '3'].),\n  (did:bigint, Foreign key referencing the did column in the domain table. Value examples: ['2', '4', '5'].),\n]\n# Table: domain_journal\n[\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['1', '2'].),\n  (jid:bigint, Foreign key referencing the journal table's primary key. Value examples: ['2', '3'].),\n]\n# Table: domain_keyword\n[\n  (did:bigint, Foreign key referencing the 'did' column of the 'domain' table. Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the 'kid' column of the 'keyword' table. Value examples: ['2', '3'].),\n]\n# Table: domain_publication\n[\n  (did:bigint, Foreign key referencing the domain table's primary key column (did). Value examples: ['4', '2', '1'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key column (pid). Value examples: ['1', '2', '3'].),\n]\n# Table: journal\n[\n  (homepage:text, The homepage URL for the journal. Value examples: ['www.aijournal.com', 'www.nature.com', 'www.science.com', 'www.ml.com'].),\n  (jid:bigint, Unique identifier for a journal. Value examples: ['1', '2', '3', '4'].),\n  (name:text, The name of the journal. Value examples: ['Journal of Artificial Intelligence Research', 'Nature', 'Science', 'Journal of Machine Learning Research'].),\n]\n# Table: keyword\n[\n  (keyword:text, The actual keyword. Value examples: ['AI', 'Neuroscience', 'Machine Learning', 'Keyword 4'].),\n  (kid:bigint, Unique identifier for a keyword. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: organization\n[\n  (continent:text, Continent where the organization is located. Value examples: ['Asia', 'North America', 'North America'].),\n  (homepage:text, URL of the organization's homepage. Value examples: ['www.organization1.com', 'www.organization2.com', 'www.organization3.com'].),\n  (name:text, Name of the organization. Value examples: ['Organization 1', 'Organization 2', 'Organization 3'].),\n  (oid:bigint, Unique identifier for the organization. Value examples: ['1', '2', '3'].),\n]\n# Table: publication\n[\n  (abstract:text, The abstract of the publication. Value examples: ['Abstract 1', 'Abstract 2'].),\n  (cid:bigint, The ID of the conference where the publication was presented. Value examples: ['1', '2'].),\n  (citation_num:bigint, The number of citations received by the publication. Value examples: ['4', '2'].),\n  (jid:bigint, The ID of the journal where the publication was published. Value examples: ['1', '2'].),\n  (pid:bigint, The unique ID of the publication. Value examples: ['1', '2'].),\n  (reference_num:bigint, The number of references cited by the publication. Value examples: ['0', '1'].),\n  (title:text, The title of the publication. Value examples: ['The Effects of Climate Change on Agriculture', 'A Study on the Effects of Social Media on Mental Health'].),\n  (year:bigint, The year of publication. Value examples: ['2020', '2020'].),\n]\n# Table: publication_keyword\n[\n  (pid:bigint, Foreign key referencing the publication table's primary key (pid). Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the keyword table's primary key (kid). Value examples: ['2', '3'].),\n]\n# Table: writes\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1', '2', '2'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.aid = domain_author.aid\nauthor.oid = organization.oid\nauthor.aid = writes.aid\ncite.cited = publication.pid\nconference.cid = domain_conference.cid\nconference.cid = publication.cid\ndomain.did = domain_author.did\ndomain.did = domain_conference.did\ndomain.did = domain_journal.did\ndomain.did = domain_keyword.did\ndomain_journal.jid = journal.jid\ndomain_keyword.kid = keyword.kid\ndomain_publication.pid = publication.pid\njournal.jid = publication.jid\nkeyword.kid = publication_keyword.kid\npublication.pid = publication_keyword.pid\npublication.pid = writes.pid\n\n【参考信息】\n\n\n【用户问题】\nWhich authors have written publications in both the domain \"Machine Learning\" and the domain \"Data Science\"?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT author.name, author.aid FROM author WHERE author.aid IN (SELECT domain_author.aid FROM domain_author WHERE domain_author.did IN (SELECT domain.did FROM DOMAIN WHERE domain.name IN ('Machine Learning', 'Data Science') ) GROUP BY 1 HAVING COUNT(DISTINCT domain_author.did) = 2)",
        "role": "assistant"
      }
    ],
    "db_name": "academic",
    "id": 5,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the total number of citations received by each author?\n\n【数据库schema】\n【DB_ID】 academic\n【Schema】\n# Table: author\n[\n  (aid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3'].),\n  (homepage:text, URL of the author's personal website. Value examples: ['www.larry.com', 'www.ashish.com', 'www.noam.com'].),\n  (name:text, Name of the author. Value examples: ['Larry Summers', 'Ashish Vaswani', 'Noam Shazeer'].),\n  (oid:bigint, Foreign key referencing the organization the author belongs to. Value examples: ['2', '3', '3'].),\n]\n# Table: cite\n[\n  (cited:bigint, ID of the publication being cited. Value examples: ['1', '1', '1'].),\n  (citing:bigint, ID of the publication that is citing another publication. Value examples: ['2', '3', '4'].),\n]\n# Table: conference\n[\n  (cid:bigint, Unique identifier for a conference. Value examples: ['1', '2', '3'].),\n  (homepage:text, The homepage URL for the conference. Value examples: ['www.isa.com', 'www.aaas.com', 'www.icml.com'].),\n  (name:text, The name of the conference. Value examples: ['ISA', 'AAAS', 'ICML'].),\n]\n# Table: domain\n[\n  (did:bigint, Unique identifier for a domain. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the domain. Value examples: ['Data Science', 'Natural Sciences', 'Computer Science'].),\n]\n# Table: domain_author\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1'].),\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['2', '4'].),\n]\n# Table: domain_conference\n[\n  (cid:bigint, Foreign key referencing the cid column in the conference table. Value examples: ['1', '2', '3'].),\n  (did:bigint, Foreign key referencing the did column in the domain table. Value examples: ['2', '4', '5'].),\n]\n# Table: domain_journal\n[\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['1', '2'].),\n  (jid:bigint, Foreign key referencing the journal table's primary key. Value examples: ['2', '3'].),\n]\n# Table: domain_keyword\n[\n  (did:bigint, Foreign key referencing the 'did' column of the 'domain' table. Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the 'kid' column of the 'keyword' table. Value examples: ['2', '3'].),\n]\n# Table: domain_publication\n[\n  (did:bigint, Foreign key referencing the domain table's primary key column (did). Value examples: ['4', '2', '1'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key column (pid). Value examples: ['1', '2', '3'].),\n]\n# Table: journal\n[\n  (homepage:text, The homepage URL for the journal. Value examples: ['www.aijournal.com', 'www.nature.com', 'www.science.com', 'www.ml.com'].),\n  (jid:bigint, Unique identifier for a journal. Value examples: ['1', '2', '3', '4'].),\n  (name:text, The name of the journal. Value examples: ['Journal of Artificial Intelligence Research', 'Nature', 'Science', 'Journal of Machine Learning Research'].),\n]\n# Table: keyword\n[\n  (keyword:text, The actual keyword. Value examples: ['AI', 'Neuroscience', 'Machine Learning', 'Keyword 4'].),\n  (kid:bigint, Unique identifier for a keyword. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: organization\n[\n  (continent:text, Continent where the organization is located. Value examples: ['Asia', 'North America', 'North America'].),\n  (homepage:text, URL of the organization's homepage. Value examples: ['www.organization1.com', 'www.organization2.com', 'www.organization3.com'].),\n  (name:text, Name of the organization. Value examples: ['Organization 1', 'Organization 2', 'Organization 3'].),\n  (oid:bigint, Unique identifier for the organization. Value examples: ['1', '2', '3'].),\n]\n# Table: publication\n[\n  (abstract:text, The abstract of the publication. Value examples: ['Abstract 1', 'Abstract 2'].),\n  (cid:bigint, The ID of the conference where the publication was presented. Value examples: ['1', '2'].),\n  (citation_num:bigint, The number of citations received by the publication. Value examples: ['4', '2'].),\n  (jid:bigint, The ID of the journal where the publication was published. Value examples: ['1', '2'].),\n  (pid:bigint, The unique ID of the publication. Value examples: ['1', '2'].),\n  (reference_num:bigint, The number of references cited by the publication. Value examples: ['0', '1'].),\n  (title:text, The title of the publication. Value examples: ['The Effects of Climate Change on Agriculture', 'A Study on the Effects of Social Media on Mental Health'].),\n  (year:bigint, The year of publication. Value examples: ['2020', '2020'].),\n]\n# Table: publication_keyword\n[\n  (pid:bigint, Foreign key referencing the publication table's primary key (pid). Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the keyword table's primary key (kid). Value examples: ['2', '3'].),\n]\n# Table: writes\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1', '2', '2'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.aid = domain_author.aid\nauthor.oid = organization.oid\nauthor.aid = writes.aid\ncite.cited = publication.pid\nconference.cid = domain_conference.cid\nconference.cid = publication.cid\ndomain.did = domain_author.did\ndomain.did = domain_conference.did\ndomain.did = domain_journal.did\ndomain.did = domain_keyword.did\ndomain_journal.jid = journal.jid\ndomain_keyword.kid = keyword.kid\ndomain_publication.pid = publication.pid\njournal.jid = publication.jid\nkeyword.kid = publication_keyword.kid\npublication.pid = publication_keyword.pid\npublication.pid = writes.pid\n\n【参考信息】\n\n\n【用户问题】\nWhat is the total number of citations received by each author?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT author.name, author.aid, sum(publication.citation_num) AS total_citations FROM author JOIN writes ON author.aid = writes.aid JOIN publication ON writes.pid = publication.pid GROUP BY author.name, author.aid ORDER BY total_citations DESC NULLS LAST",
        "role": "assistant"
      }
    ],
    "db_name": "academic",
    "id": 6,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the total number of publications published in each year?\n\n【数据库schema】\n【DB_ID】 academic\n【Schema】\n# Table: author\n[\n  (aid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3'].),\n  (homepage:text, URL of the author's personal website. Value examples: ['www.larry.com', 'www.ashish.com', 'www.noam.com'].),\n  (name:text, Name of the author. Value examples: ['Larry Summers', 'Ashish Vaswani', 'Noam Shazeer'].),\n  (oid:bigint, Foreign key referencing the organization the author belongs to. Value examples: ['2', '3', '3'].),\n]\n# Table: cite\n[\n  (cited:bigint, ID of the publication being cited. Value examples: ['1', '1', '1'].),\n  (citing:bigint, ID of the publication that is citing another publication. Value examples: ['2', '3', '4'].),\n]\n# Table: conference\n[\n  (cid:bigint, Unique identifier for a conference. Value examples: ['1', '2', '3'].),\n  (homepage:text, The homepage URL for the conference. Value examples: ['www.isa.com', 'www.aaas.com', 'www.icml.com'].),\n  (name:text, The name of the conference. Value examples: ['ISA', 'AAAS', 'ICML'].),\n]\n# Table: domain\n[\n  (did:bigint, Unique identifier for a domain. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the domain. Value examples: ['Data Science', 'Natural Sciences', 'Computer Science'].),\n]\n# Table: domain_author\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1'].),\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['2', '4'].),\n]\n# Table: domain_conference\n[\n  (cid:bigint, Foreign key referencing the cid column in the conference table. Value examples: ['1', '2', '3'].),\n  (did:bigint, Foreign key referencing the did column in the domain table. Value examples: ['2', '4', '5'].),\n]\n# Table: domain_journal\n[\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['1', '2'].),\n  (jid:bigint, Foreign key referencing the journal table's primary key. Value examples: ['2', '3'].),\n]\n# Table: domain_keyword\n[\n  (did:bigint, Foreign key referencing the 'did' column of the 'domain' table. Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the 'kid' column of the 'keyword' table. Value examples: ['2', '3'].),\n]\n# Table: domain_publication\n[\n  (did:bigint, Foreign key referencing the domain table's primary key column (did). Value examples: ['4', '2', '1'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key column (pid). Value examples: ['1', '2', '3'].),\n]\n# Table: journal\n[\n  (homepage:text, The homepage URL for the journal. Value examples: ['www.aijournal.com', 'www.nature.com', 'www.science.com', 'www.ml.com'].),\n  (jid:bigint, Unique identifier for a journal. Value examples: ['1', '2', '3', '4'].),\n  (name:text, The name of the journal. Value examples: ['Journal of Artificial Intelligence Research', 'Nature', 'Science', 'Journal of Machine Learning Research'].),\n]\n# Table: keyword\n[\n  (keyword:text, The actual keyword. Value examples: ['AI', 'Neuroscience', 'Machine Learning', 'Keyword 4'].),\n  (kid:bigint, Unique identifier for a keyword. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: organization\n[\n  (continent:text, Continent where the organization is located. Value examples: ['Asia', 'North America', 'North America'].),\n  (homepage:text, URL of the organization's homepage. Value examples: ['www.organization1.com', 'www.organization2.com', 'www.organization3.com'].),\n  (name:text, Name of the organization. Value examples: ['Organization 1', 'Organization 2', 'Organization 3'].),\n  (oid:bigint, Unique identifier for the organization. Value examples: ['1', '2', '3'].),\n]\n# Table: publication\n[\n  (abstract:text, The abstract of the publication. Value examples: ['Abstract 1', 'Abstract 2'].),\n  (cid:bigint, The ID of the conference where the publication was presented. Value examples: ['1', '2'].),\n  (citation_num:bigint, The number of citations received by the publication. Value examples: ['4', '2'].),\n  (jid:bigint, The ID of the journal where the publication was published. Value examples: ['1', '2'].),\n  (pid:bigint, The unique ID of the publication. Value examples: ['1', '2'].),\n  (reference_num:bigint, The number of references cited by the publication. Value examples: ['0', '1'].),\n  (title:text, The title of the publication. Value examples: ['The Effects of Climate Change on Agriculture', 'A Study on the Effects of Social Media on Mental Health'].),\n  (year:bigint, The year of publication. Value examples: ['2020', '2020'].),\n]\n# Table: publication_keyword\n[\n  (pid:bigint, Foreign key referencing the publication table's primary key (pid). Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the keyword table's primary key (kid). Value examples: ['2', '3'].),\n]\n# Table: writes\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1', '2', '2'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.aid = domain_author.aid\nauthor.oid = organization.oid\nauthor.aid = writes.aid\ncite.cited = publication.pid\nconference.cid = domain_conference.cid\nconference.cid = publication.cid\ndomain.did = domain_author.did\ndomain.did = domain_conference.did\ndomain.did = domain_journal.did\ndomain.did = domain_keyword.did\ndomain_journal.jid = journal.jid\ndomain_keyword.kid = keyword.kid\ndomain_publication.pid = publication.pid\njournal.jid = publication.jid\nkeyword.kid = publication_keyword.kid\npublication.pid = publication_keyword.pid\npublication.pid = writes.pid\n\n【参考信息】\n\n\n【用户问题】\nWhat is the total number of publications published in each year?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT publication.year, COUNT(DISTINCT publication.pid) AS total_publications FROM publication GROUP BY publication.year ORDER BY publication.year;",
        "role": "assistant"
      }
    ],
    "db_name": "academic",
    "id": 7,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the average number of references cited by publications in each domain name?\n\n【数据库schema】\n【DB_ID】 academic\n【Schema】\n# Table: author\n[\n  (aid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3'].),\n  (homepage:text, URL of the author's personal website. Value examples: ['www.larry.com', 'www.ashish.com', 'www.noam.com'].),\n  (name:text, Name of the author. Value examples: ['Larry Summers', 'Ashish Vaswani', 'Noam Shazeer'].),\n  (oid:bigint, Foreign key referencing the organization the author belongs to. Value examples: ['2', '3', '3'].),\n]\n# Table: cite\n[\n  (cited:bigint, ID of the publication being cited. Value examples: ['1', '1', '1'].),\n  (citing:bigint, ID of the publication that is citing another publication. Value examples: ['2', '3', '4'].),\n]\n# Table: conference\n[\n  (cid:bigint, Unique identifier for a conference. Value examples: ['1', '2', '3'].),\n  (homepage:text, The homepage URL for the conference. Value examples: ['www.isa.com', 'www.aaas.com', 'www.icml.com'].),\n  (name:text, The name of the conference. Value examples: ['ISA', 'AAAS', 'ICML'].),\n]\n# Table: domain\n[\n  (did:bigint, Unique identifier for a domain. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the domain. Value examples: ['Data Science', 'Natural Sciences', 'Computer Science'].),\n]\n# Table: domain_author\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1'].),\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['2', '4'].),\n]\n# Table: domain_conference\n[\n  (cid:bigint, Foreign key referencing the cid column in the conference table. Value examples: ['1', '2', '3'].),\n  (did:bigint, Foreign key referencing the did column in the domain table. Value examples: ['2', '4', '5'].),\n]\n# Table: domain_journal\n[\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['1', '2'].),\n  (jid:bigint, Foreign key referencing the journal table's primary key. Value examples: ['2', '3'].),\n]\n# Table: domain_keyword\n[\n  (did:bigint, Foreign key referencing the 'did' column of the 'domain' table. Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the 'kid' column of the 'keyword' table. Value examples: ['2', '3'].),\n]\n# Table: domain_publication\n[\n  (did:bigint, Foreign key referencing the domain table's primary key column (did). Value examples: ['4', '2', '1'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key column (pid). Value examples: ['1', '2', '3'].),\n]\n# Table: journal\n[\n  (homepage:text, The homepage URL for the journal. Value examples: ['www.aijournal.com', 'www.nature.com', 'www.science.com', 'www.ml.com'].),\n  (jid:bigint, Unique identifier for a journal. Value examples: ['1', '2', '3', '4'].),\n  (name:text, The name of the journal. Value examples: ['Journal of Artificial Intelligence Research', 'Nature', 'Science', 'Journal of Machine Learning Research'].),\n]\n# Table: keyword\n[\n  (keyword:text, The actual keyword. Value examples: ['AI', 'Neuroscience', 'Machine Learning', 'Keyword 4'].),\n  (kid:bigint, Unique identifier for a keyword. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: organization\n[\n  (continent:text, Continent where the organization is located. Value examples: ['Asia', 'North America', 'North America'].),\n  (homepage:text, URL of the organization's homepage. Value examples: ['www.organization1.com', 'www.organization2.com', 'www.organization3.com'].),\n  (name:text, Name of the organization. Value examples: ['Organization 1', 'Organization 2', 'Organization 3'].),\n  (oid:bigint, Unique identifier for the organization. Value examples: ['1', '2', '3'].),\n]\n# Table: publication\n[\n  (abstract:text, The abstract of the publication. Value examples: ['Abstract 1', 'Abstract 2'].),\n  (cid:bigint, The ID of the conference where the publication was presented. Value examples: ['1', '2'].),\n  (citation_num:bigint, The number of citations received by the publication. Value examples: ['4', '2'].),\n  (jid:bigint, The ID of the journal where the publication was published. Value examples: ['1', '2'].),\n  (pid:bigint, The unique ID of the publication. Value examples: ['1', '2'].),\n  (reference_num:bigint, The number of references cited by the publication. Value examples: ['0', '1'].),\n  (title:text, The title of the publication. Value examples: ['The Effects of Climate Change on Agriculture', 'A Study on the Effects of Social Media on Mental Health'].),\n  (year:bigint, The year of publication. Value examples: ['2020', '2020'].),\n]\n# Table: publication_keyword\n[\n  (pid:bigint, Foreign key referencing the publication table's primary key (pid). Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the keyword table's primary key (kid). Value examples: ['2', '3'].),\n]\n# Table: writes\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1', '2', '2'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.aid = domain_author.aid\nauthor.oid = organization.oid\nauthor.aid = writes.aid\ncite.cited = publication.pid\nconference.cid = domain_conference.cid\nconference.cid = publication.cid\ndomain.did = domain_author.did\ndomain.did = domain_conference.did\ndomain.did = domain_journal.did\ndomain.did = domain_keyword.did\ndomain_journal.jid = journal.jid\ndomain_keyword.kid = keyword.kid\ndomain_publication.pid = publication.pid\njournal.jid = publication.jid\nkeyword.kid = publication_keyword.kid\npublication.pid = publication_keyword.pid\npublication.pid = writes.pid\n\n【参考信息】\n\n\n【用户问题】\nWhat is the average number of references cited by publications in each domain name?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT domain.name, domain.did, AVG(publication.reference_num) AS average_references FROM domain_publication JOIN publication ON domain_publication.pid = publication.pid JOIN domain ON domain.did = domain_publication.did GROUP BY domain.name, domain.did",
        "role": "assistant"
      }
    ],
    "db_name": "academic",
    "id": 8,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the average number of citations received by publications in each year?\n\n【数据库schema】\n【DB_ID】 academic\n【Schema】\n# Table: author\n[\n  (aid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3'].),\n  (homepage:text, URL of the author's personal website. Value examples: ['www.larry.com', 'www.ashish.com', 'www.noam.com'].),\n  (name:text, Name of the author. Value examples: ['Larry Summers', 'Ashish Vaswani', 'Noam Shazeer'].),\n  (oid:bigint, Foreign key referencing the organization the author belongs to. Value examples: ['2', '3', '3'].),\n]\n# Table: cite\n[\n  (cited:bigint, ID of the publication being cited. Value examples: ['1', '1', '1'].),\n  (citing:bigint, ID of the publication that is citing another publication. Value examples: ['2', '3', '4'].),\n]\n# Table: conference\n[\n  (cid:bigint, Unique identifier for a conference. Value examples: ['1', '2', '3'].),\n  (homepage:text, The homepage URL for the conference. Value examples: ['www.isa.com', 'www.aaas.com', 'www.icml.com'].),\n  (name:text, The name of the conference. Value examples: ['ISA', 'AAAS', 'ICML'].),\n]\n# Table: domain\n[\n  (did:bigint, Unique identifier for a domain. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the domain. Value examples: ['Data Science', 'Natural Sciences', 'Computer Science'].),\n]\n# Table: domain_author\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1'].),\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['2', '4'].),\n]\n# Table: domain_conference\n[\n  (cid:bigint, Foreign key referencing the cid column in the conference table. Value examples: ['1', '2', '3'].),\n  (did:bigint, Foreign key referencing the did column in the domain table. Value examples: ['2', '4', '5'].),\n]\n# Table: domain_journal\n[\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['1', '2'].),\n  (jid:bigint, Foreign key referencing the journal table's primary key. Value examples: ['2', '3'].),\n]\n# Table: domain_keyword\n[\n  (did:bigint, Foreign key referencing the 'did' column of the 'domain' table. Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the 'kid' column of the 'keyword' table. Value examples: ['2', '3'].),\n]\n# Table: domain_publication\n[\n  (did:bigint, Foreign key referencing the domain table's primary key column (did). Value examples: ['4', '2', '1'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key column (pid). Value examples: ['1', '2', '3'].),\n]\n# Table: journal\n[\n  (homepage:text, The homepage URL for the journal. Value examples: ['www.aijournal.com', 'www.nature.com', 'www.science.com', 'www.ml.com'].),\n  (jid:bigint, Unique identifier for a journal. Value examples: ['1', '2', '3', '4'].),\n  (name:text, The name of the journal. Value examples: ['Journal of Artificial Intelligence Research', 'Nature', 'Science', 'Journal of Machine Learning Research'].),\n]\n# Table: keyword\n[\n  (keyword:text, The actual keyword. Value examples: ['AI', 'Neuroscience', 'Machine Learning', 'Keyword 4'].),\n  (kid:bigint, Unique identifier for a keyword. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: organization\n[\n  (continent:text, Continent where the organization is located. Value examples: ['Asia', 'North America', 'North America'].),\n  (homepage:text, URL of the organization's homepage. Value examples: ['www.organization1.com', 'www.organization2.com', 'www.organization3.com'].),\n  (name:text, Name of the organization. Value examples: ['Organization 1', 'Organization 2', 'Organization 3'].),\n  (oid:bigint, Unique identifier for the organization. Value examples: ['1', '2', '3'].),\n]\n# Table: publication\n[\n  (abstract:text, The abstract of the publication. Value examples: ['Abstract 1', 'Abstract 2'].),\n  (cid:bigint, The ID of the conference where the publication was presented. Value examples: ['1', '2'].),\n  (citation_num:bigint, The number of citations received by the publication. Value examples: ['4', '2'].),\n  (jid:bigint, The ID of the journal where the publication was published. Value examples: ['1', '2'].),\n  (pid:bigint, The unique ID of the publication. Value examples: ['1', '2'].),\n  (reference_num:bigint, The number of references cited by the publication. Value examples: ['0', '1'].),\n  (title:text, The title of the publication. Value examples: ['The Effects of Climate Change on Agriculture', 'A Study on the Effects of Social Media on Mental Health'].),\n  (year:bigint, The year of publication. Value examples: ['2020', '2020'].),\n]\n# Table: publication_keyword\n[\n  (pid:bigint, Foreign key referencing the publication table's primary key (pid). Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the keyword table's primary key (kid). Value examples: ['2', '3'].),\n]\n# Table: writes\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1', '2', '2'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.aid = domain_author.aid\nauthor.oid = organization.oid\nauthor.aid = writes.aid\ncite.cited = publication.pid\nconference.cid = domain_conference.cid\nconference.cid = publication.cid\ndomain.did = domain_author.did\ndomain.did = domain_conference.did\ndomain.did = domain_journal.did\ndomain.did = domain_keyword.did\ndomain_journal.jid = journal.jid\ndomain_keyword.kid = keyword.kid\ndomain_publication.pid = publication.pid\njournal.jid = publication.jid\nkeyword.kid = publication_keyword.kid\npublication.pid = publication_keyword.pid\npublication.pid = writes.pid\n\n【参考信息】\n\n\n【用户问题】\nWhat is the average number of citations received by publications in each year?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT publication.year, AVG(publication.citation_num) AS average_citations FROM publication GROUP BY publication.year ORDER BY publication.year NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "academic",
    "id": 9,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the title of the publication that has received the highest number of citations?\n\n【数据库schema】\n【DB_ID】 academic\n【Schema】\n# Table: author\n[\n  (aid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3'].),\n  (homepage:text, URL of the author's personal website. Value examples: ['www.larry.com', 'www.ashish.com', 'www.noam.com'].),\n  (name:text, Name of the author. Value examples: ['Larry Summers', 'Ashish Vaswani', 'Noam Shazeer'].),\n  (oid:bigint, Foreign key referencing the organization the author belongs to. Value examples: ['2', '3', '3'].),\n]\n# Table: cite\n[\n  (cited:bigint, ID of the publication being cited. Value examples: ['1', '1', '1'].),\n  (citing:bigint, ID of the publication that is citing another publication. Value examples: ['2', '3', '4'].),\n]\n# Table: conference\n[\n  (cid:bigint, Unique identifier for a conference. Value examples: ['1', '2', '3'].),\n  (homepage:text, The homepage URL for the conference. Value examples: ['www.isa.com', 'www.aaas.com', 'www.icml.com'].),\n  (name:text, The name of the conference. Value examples: ['ISA', 'AAAS', 'ICML'].),\n]\n# Table: domain\n[\n  (did:bigint, Unique identifier for a domain. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the domain. Value examples: ['Data Science', 'Natural Sciences', 'Computer Science'].),\n]\n# Table: domain_author\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1'].),\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['2', '4'].),\n]\n# Table: domain_conference\n[\n  (cid:bigint, Foreign key referencing the cid column in the conference table. Value examples: ['1', '2', '3'].),\n  (did:bigint, Foreign key referencing the did column in the domain table. Value examples: ['2', '4', '5'].),\n]\n# Table: domain_journal\n[\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['1', '2'].),\n  (jid:bigint, Foreign key referencing the journal table's primary key. Value examples: ['2', '3'].),\n]\n# Table: domain_keyword\n[\n  (did:bigint, Foreign key referencing the 'did' column of the 'domain' table. Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the 'kid' column of the 'keyword' table. Value examples: ['2', '3'].),\n]\n# Table: domain_publication\n[\n  (did:bigint, Foreign key referencing the domain table's primary key column (did). Value examples: ['4', '2', '1'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key column (pid). Value examples: ['1', '2', '3'].),\n]\n# Table: journal\n[\n  (homepage:text, The homepage URL for the journal. Value examples: ['www.aijournal.com', 'www.nature.com', 'www.science.com', 'www.ml.com'].),\n  (jid:bigint, Unique identifier for a journal. Value examples: ['1', '2', '3', '4'].),\n  (name:text, The name of the journal. Value examples: ['Journal of Artificial Intelligence Research', 'Nature', 'Science', 'Journal of Machine Learning Research'].),\n]\n# Table: keyword\n[\n  (keyword:text, The actual keyword. Value examples: ['AI', 'Neuroscience', 'Machine Learning', 'Keyword 4'].),\n  (kid:bigint, Unique identifier for a keyword. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: organization\n[\n  (continent:text, Continent where the organization is located. Value examples: ['Asia', 'North America', 'North America'].),\n  (homepage:text, URL of the organization's homepage. Value examples: ['www.organization1.com', 'www.organization2.com', 'www.organization3.com'].),\n  (name:text, Name of the organization. Value examples: ['Organization 1', 'Organization 2', 'Organization 3'].),\n  (oid:bigint, Unique identifier for the organization. Value examples: ['1', '2', '3'].),\n]\n# Table: publication\n[\n  (abstract:text, The abstract of the publication. Value examples: ['Abstract 1', 'Abstract 2'].),\n  (cid:bigint, The ID of the conference where the publication was presented. Value examples: ['1', '2'].),\n  (citation_num:bigint, The number of citations received by the publication. Value examples: ['4', '2'].),\n  (jid:bigint, The ID of the journal where the publication was published. Value examples: ['1', '2'].),\n  (pid:bigint, The unique ID of the publication. Value examples: ['1', '2'].),\n  (reference_num:bigint, The number of references cited by the publication. Value examples: ['0', '1'].),\n  (title:text, The title of the publication. Value examples: ['The Effects of Climate Change on Agriculture', 'A Study on the Effects of Social Media on Mental Health'].),\n  (year:bigint, The year of publication. Value examples: ['2020', '2020'].),\n]\n# Table: publication_keyword\n[\n  (pid:bigint, Foreign key referencing the publication table's primary key (pid). Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the keyword table's primary key (kid). Value examples: ['2', '3'].),\n]\n# Table: writes\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1', '2', '2'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.aid = domain_author.aid\nauthor.oid = organization.oid\nauthor.aid = writes.aid\ncite.cited = publication.pid\nconference.cid = domain_conference.cid\nconference.cid = publication.cid\ndomain.did = domain_author.did\ndomain.did = domain_conference.did\ndomain.did = domain_journal.did\ndomain.did = domain_keyword.did\ndomain_journal.jid = journal.jid\ndomain_keyword.kid = keyword.kid\ndomain_publication.pid = publication.pid\njournal.jid = publication.jid\nkeyword.kid = publication_keyword.kid\npublication.pid = publication_keyword.pid\npublication.pid = writes.pid\n\n【参考信息】\n\n\n【用户问题】\nWhat is the title of the publication that has received the highest number of citations?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT publication.title FROM publication ORDER BY publication.citation_num DESC NULLS LAST LIMIT 1;",
        "role": "assistant"
      }
    ],
    "db_name": "academic",
    "id": 10,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the top 5 domains with the highest number of authors associated with them?\n\n【数据库schema】\n【DB_ID】 academic\n【Schema】\n# Table: author\n[\n  (aid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3'].),\n  (homepage:text, URL of the author's personal website. Value examples: ['www.larry.com', 'www.ashish.com', 'www.noam.com'].),\n  (name:text, Name of the author. Value examples: ['Larry Summers', 'Ashish Vaswani', 'Noam Shazeer'].),\n  (oid:bigint, Foreign key referencing the organization the author belongs to. Value examples: ['2', '3', '3'].),\n]\n# Table: cite\n[\n  (cited:bigint, ID of the publication being cited. Value examples: ['1', '1', '1'].),\n  (citing:bigint, ID of the publication that is citing another publication. Value examples: ['2', '3', '4'].),\n]\n# Table: conference\n[\n  (cid:bigint, Unique identifier for a conference. Value examples: ['1', '2', '3'].),\n  (homepage:text, The homepage URL for the conference. Value examples: ['www.isa.com', 'www.aaas.com', 'www.icml.com'].),\n  (name:text, The name of the conference. Value examples: ['ISA', 'AAAS', 'ICML'].),\n]\n# Table: domain\n[\n  (did:bigint, Unique identifier for a domain. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the domain. Value examples: ['Data Science', 'Natural Sciences', 'Computer Science'].),\n]\n# Table: domain_author\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1'].),\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['2', '4'].),\n]\n# Table: domain_conference\n[\n  (cid:bigint, Foreign key referencing the cid column in the conference table. Value examples: ['1', '2', '3'].),\n  (did:bigint, Foreign key referencing the did column in the domain table. Value examples: ['2', '4', '5'].),\n]\n# Table: domain_journal\n[\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['1', '2'].),\n  (jid:bigint, Foreign key referencing the journal table's primary key. Value examples: ['2', '3'].),\n]\n# Table: domain_keyword\n[\n  (did:bigint, Foreign key referencing the 'did' column of the 'domain' table. Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the 'kid' column of the 'keyword' table. Value examples: ['2', '3'].),\n]\n# Table: domain_publication\n[\n  (did:bigint, Foreign key referencing the domain table's primary key column (did). Value examples: ['4', '2', '1'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key column (pid). Value examples: ['1', '2', '3'].),\n]\n# Table: journal\n[\n  (homepage:text, The homepage URL for the journal. Value examples: ['www.aijournal.com', 'www.nature.com', 'www.science.com', 'www.ml.com'].),\n  (jid:bigint, Unique identifier for a journal. Value examples: ['1', '2', '3', '4'].),\n  (name:text, The name of the journal. Value examples: ['Journal of Artificial Intelligence Research', 'Nature', 'Science', 'Journal of Machine Learning Research'].),\n]\n# Table: keyword\n[\n  (keyword:text, The actual keyword. Value examples: ['AI', 'Neuroscience', 'Machine Learning', 'Keyword 4'].),\n  (kid:bigint, Unique identifier for a keyword. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: organization\n[\n  (continent:text, Continent where the organization is located. Value examples: ['Asia', 'North America', 'North America'].),\n  (homepage:text, URL of the organization's homepage. Value examples: ['www.organization1.com', 'www.organization2.com', 'www.organization3.com'].),\n  (name:text, Name of the organization. Value examples: ['Organization 1', 'Organization 2', 'Organization 3'].),\n  (oid:bigint, Unique identifier for the organization. Value examples: ['1', '2', '3'].),\n]\n# Table: publication\n[\n  (abstract:text, The abstract of the publication. Value examples: ['Abstract 1', 'Abstract 2'].),\n  (cid:bigint, The ID of the conference where the publication was presented. Value examples: ['1', '2'].),\n  (citation_num:bigint, The number of citations received by the publication. Value examples: ['4', '2'].),\n  (jid:bigint, The ID of the journal where the publication was published. Value examples: ['1', '2'].),\n  (pid:bigint, The unique ID of the publication. Value examples: ['1', '2'].),\n  (reference_num:bigint, The number of references cited by the publication. Value examples: ['0', '1'].),\n  (title:text, The title of the publication. Value examples: ['The Effects of Climate Change on Agriculture', 'A Study on the Effects of Social Media on Mental Health'].),\n  (year:bigint, The year of publication. Value examples: ['2020', '2020'].),\n]\n# Table: publication_keyword\n[\n  (pid:bigint, Foreign key referencing the publication table's primary key (pid). Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the keyword table's primary key (kid). Value examples: ['2', '3'].),\n]\n# Table: writes\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1', '2', '2'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.aid = domain_author.aid\nauthor.oid = organization.oid\nauthor.aid = writes.aid\ncite.cited = publication.pid\nconference.cid = domain_conference.cid\nconference.cid = publication.cid\ndomain.did = domain_author.did\ndomain.did = domain_conference.did\ndomain.did = domain_journal.did\ndomain.did = domain_keyword.did\ndomain_journal.jid = journal.jid\ndomain_keyword.kid = keyword.kid\ndomain_publication.pid = publication.pid\njournal.jid = publication.jid\nkeyword.kid = publication_keyword.kid\npublication.pid = publication_keyword.pid\npublication.pid = writes.pid\n\n【参考信息】\n\n\n【用户问题】\nWhat are the top 5 domains with the highest number of authors associated with them?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT d.name, d.did, COUNT(DISTINCT a.aid) AS author_count FROM author a JOIN domain_author da ON a.aid = da.aid JOIN domain d ON da.did = d.did GROUP BY d.name, d.did ORDER BY author_count DESC LIMIT 5",
        "role": "assistant"
      }
    ],
    "db_name": "academic",
    "id": 11,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the top 3 titles of the publications that have the highest number of references cited, ordered by the number of references cited in descending order?\n\n【数据库schema】\n【DB_ID】 academic\n【Schema】\n# Table: author\n[\n  (aid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3'].),\n  (homepage:text, URL of the author's personal website. Value examples: ['www.larry.com', 'www.ashish.com', 'www.noam.com'].),\n  (name:text, Name of the author. Value examples: ['Larry Summers', 'Ashish Vaswani', 'Noam Shazeer'].),\n  (oid:bigint, Foreign key referencing the organization the author belongs to. Value examples: ['2', '3', '3'].),\n]\n# Table: cite\n[\n  (cited:bigint, ID of the publication being cited. Value examples: ['1', '1', '1'].),\n  (citing:bigint, ID of the publication that is citing another publication. Value examples: ['2', '3', '4'].),\n]\n# Table: conference\n[\n  (cid:bigint, Unique identifier for a conference. Value examples: ['1', '2', '3'].),\n  (homepage:text, The homepage URL for the conference. Value examples: ['www.isa.com', 'www.aaas.com', 'www.icml.com'].),\n  (name:text, The name of the conference. Value examples: ['ISA', 'AAAS', 'ICML'].),\n]\n# Table: domain\n[\n  (did:bigint, Unique identifier for a domain. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the domain. Value examples: ['Data Science', 'Natural Sciences', 'Computer Science'].),\n]\n# Table: domain_author\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1'].),\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['2', '4'].),\n]\n# Table: domain_conference\n[\n  (cid:bigint, Foreign key referencing the cid column in the conference table. Value examples: ['1', '2', '3'].),\n  (did:bigint, Foreign key referencing the did column in the domain table. Value examples: ['2', '4', '5'].),\n]\n# Table: domain_journal\n[\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['1', '2'].),\n  (jid:bigint, Foreign key referencing the journal table's primary key. Value examples: ['2', '3'].),\n]\n# Table: domain_keyword\n[\n  (did:bigint, Foreign key referencing the 'did' column of the 'domain' table. Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the 'kid' column of the 'keyword' table. Value examples: ['2', '3'].),\n]\n# Table: domain_publication\n[\n  (did:bigint, Foreign key referencing the domain table's primary key column (did). Value examples: ['4', '2', '1'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key column (pid). Value examples: ['1', '2', '3'].),\n]\n# Table: journal\n[\n  (homepage:text, The homepage URL for the journal. Value examples: ['www.aijournal.com', 'www.nature.com', 'www.science.com', 'www.ml.com'].),\n  (jid:bigint, Unique identifier for a journal. Value examples: ['1', '2', '3', '4'].),\n  (name:text, The name of the journal. Value examples: ['Journal of Artificial Intelligence Research', 'Nature', 'Science', 'Journal of Machine Learning Research'].),\n]\n# Table: keyword\n[\n  (keyword:text, The actual keyword. Value examples: ['AI', 'Neuroscience', 'Machine Learning', 'Keyword 4'].),\n  (kid:bigint, Unique identifier for a keyword. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: organization\n[\n  (continent:text, Continent where the organization is located. Value examples: ['Asia', 'North America', 'North America'].),\n  (homepage:text, URL of the organization's homepage. Value examples: ['www.organization1.com', 'www.organization2.com', 'www.organization3.com'].),\n  (name:text, Name of the organization. Value examples: ['Organization 1', 'Organization 2', 'Organization 3'].),\n  (oid:bigint, Unique identifier for the organization. Value examples: ['1', '2', '3'].),\n]\n# Table: publication\n[\n  (abstract:text, The abstract of the publication. Value examples: ['Abstract 1', 'Abstract 2'].),\n  (cid:bigint, The ID of the conference where the publication was presented. Value examples: ['1', '2'].),\n  (citation_num:bigint, The number of citations received by the publication. Value examples: ['4', '2'].),\n  (jid:bigint, The ID of the journal where the publication was published. Value examples: ['1', '2'].),\n  (pid:bigint, The unique ID of the publication. Value examples: ['1', '2'].),\n  (reference_num:bigint, The number of references cited by the publication. Value examples: ['0', '1'].),\n  (title:text, The title of the publication. Value examples: ['The Effects of Climate Change on Agriculture', 'A Study on the Effects of Social Media on Mental Health'].),\n  (year:bigint, The year of publication. Value examples: ['2020', '2020'].),\n]\n# Table: publication_keyword\n[\n  (pid:bigint, Foreign key referencing the publication table's primary key (pid). Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the keyword table's primary key (kid). Value examples: ['2', '3'].),\n]\n# Table: writes\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1', '2', '2'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.aid = domain_author.aid\nauthor.oid = organization.oid\nauthor.aid = writes.aid\ncite.cited = publication.pid\nconference.cid = domain_conference.cid\nconference.cid = publication.cid\ndomain.did = domain_author.did\ndomain.did = domain_conference.did\ndomain.did = domain_journal.did\ndomain.did = domain_keyword.did\ndomain_journal.jid = journal.jid\ndomain_keyword.kid = keyword.kid\ndomain_publication.pid = publication.pid\njournal.jid = publication.jid\nkeyword.kid = publication_keyword.kid\npublication.pid = publication_keyword.pid\npublication.pid = writes.pid\n\n【参考信息】\n\n\n【用户问题】\nWhat are the top 3 titles of the publications that have the highest number of references cited, ordered by the number of references cited in descending order?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT publication.title FROM publication ORDER BY publication.reference_num DESC LIMIT 3;",
        "role": "assistant"
      }
    ],
    "db_name": "academic",
    "id": 12,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the top 3 publications with the highest number of citations?\n\n【数据库schema】\n【DB_ID】 academic\n【Schema】\n# Table: author\n[\n  (aid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3'].),\n  (homepage:text, URL of the author's personal website. Value examples: ['www.larry.com', 'www.ashish.com', 'www.noam.com'].),\n  (name:text, Name of the author. Value examples: ['Larry Summers', 'Ashish Vaswani', 'Noam Shazeer'].),\n  (oid:bigint, Foreign key referencing the organization the author belongs to. Value examples: ['2', '3', '3'].),\n]\n# Table: cite\n[\n  (cited:bigint, ID of the publication being cited. Value examples: ['1', '1', '1'].),\n  (citing:bigint, ID of the publication that is citing another publication. Value examples: ['2', '3', '4'].),\n]\n# Table: conference\n[\n  (cid:bigint, Unique identifier for a conference. Value examples: ['1', '2', '3'].),\n  (homepage:text, The homepage URL for the conference. Value examples: ['www.isa.com', 'www.aaas.com', 'www.icml.com'].),\n  (name:text, The name of the conference. Value examples: ['ISA', 'AAAS', 'ICML'].),\n]\n# Table: domain\n[\n  (did:bigint, Unique identifier for a domain. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the domain. Value examples: ['Data Science', 'Natural Sciences', 'Computer Science'].),\n]\n# Table: domain_author\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1'].),\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['2', '4'].),\n]\n# Table: domain_conference\n[\n  (cid:bigint, Foreign key referencing the cid column in the conference table. Value examples: ['1', '2', '3'].),\n  (did:bigint, Foreign key referencing the did column in the domain table. Value examples: ['2', '4', '5'].),\n]\n# Table: domain_journal\n[\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['1', '2'].),\n  (jid:bigint, Foreign key referencing the journal table's primary key. Value examples: ['2', '3'].),\n]\n# Table: domain_keyword\n[\n  (did:bigint, Foreign key referencing the 'did' column of the 'domain' table. Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the 'kid' column of the 'keyword' table. Value examples: ['2', '3'].),\n]\n# Table: domain_publication\n[\n  (did:bigint, Foreign key referencing the domain table's primary key column (did). Value examples: ['4', '2', '1'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key column (pid). Value examples: ['1', '2', '3'].),\n]\n# Table: journal\n[\n  (homepage:text, The homepage URL for the journal. Value examples: ['www.aijournal.com', 'www.nature.com', 'www.science.com', 'www.ml.com'].),\n  (jid:bigint, Unique identifier for a journal. Value examples: ['1', '2', '3', '4'].),\n  (name:text, The name of the journal. Value examples: ['Journal of Artificial Intelligence Research', 'Nature', 'Science', 'Journal of Machine Learning Research'].),\n]\n# Table: keyword\n[\n  (keyword:text, The actual keyword. Value examples: ['AI', 'Neuroscience', 'Machine Learning', 'Keyword 4'].),\n  (kid:bigint, Unique identifier for a keyword. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: organization\n[\n  (continent:text, Continent where the organization is located. Value examples: ['Asia', 'North America', 'North America'].),\n  (homepage:text, URL of the organization's homepage. Value examples: ['www.organization1.com', 'www.organization2.com', 'www.organization3.com'].),\n  (name:text, Name of the organization. Value examples: ['Organization 1', 'Organization 2', 'Organization 3'].),\n  (oid:bigint, Unique identifier for the organization. Value examples: ['1', '2', '3'].),\n]\n# Table: publication\n[\n  (abstract:text, The abstract of the publication. Value examples: ['Abstract 1', 'Abstract 2'].),\n  (cid:bigint, The ID of the conference where the publication was presented. Value examples: ['1', '2'].),\n  (citation_num:bigint, The number of citations received by the publication. Value examples: ['4', '2'].),\n  (jid:bigint, The ID of the journal where the publication was published. Value examples: ['1', '2'].),\n  (pid:bigint, The unique ID of the publication. Value examples: ['1', '2'].),\n  (reference_num:bigint, The number of references cited by the publication. Value examples: ['0', '1'].),\n  (title:text, The title of the publication. Value examples: ['The Effects of Climate Change on Agriculture', 'A Study on the Effects of Social Media on Mental Health'].),\n  (year:bigint, The year of publication. Value examples: ['2020', '2020'].),\n]\n# Table: publication_keyword\n[\n  (pid:bigint, Foreign key referencing the publication table's primary key (pid). Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the keyword table's primary key (kid). Value examples: ['2', '3'].),\n]\n# Table: writes\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1', '2', '2'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.aid = domain_author.aid\nauthor.oid = organization.oid\nauthor.aid = writes.aid\ncite.cited = publication.pid\nconference.cid = domain_conference.cid\nconference.cid = publication.cid\ndomain.did = domain_author.did\ndomain.did = domain_conference.did\ndomain.did = domain_journal.did\ndomain.did = domain_keyword.did\ndomain_journal.jid = journal.jid\ndomain_keyword.kid = keyword.kid\ndomain_publication.pid = publication.pid\njournal.jid = publication.jid\nkeyword.kid = publication_keyword.kid\npublication.pid = publication_keyword.pid\npublication.pid = writes.pid\n\n【参考信息】\n\n\n【用户问题】\nWhat are the top 3 publications with the highest number of citations?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT publication.title, publication.pid, publication.citation_num FROM publication ORDER BY publication.citation_num DESC LIMIT 3",
        "role": "assistant"
      }
    ],
    "db_name": "academic",
    "id": 13,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the titles of all publications ordered alphabetically?\n\n【数据库schema】\n【DB_ID】 academic\n【Schema】\n# Table: author\n[\n  (aid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3'].),\n  (homepage:text, URL of the author's personal website. Value examples: ['www.larry.com', 'www.ashish.com', 'www.noam.com'].),\n  (name:text, Name of the author. Value examples: ['Larry Summers', 'Ashish Vaswani', 'Noam Shazeer'].),\n  (oid:bigint, Foreign key referencing the organization the author belongs to. Value examples: ['2', '3', '3'].),\n]\n# Table: cite\n[\n  (cited:bigint, ID of the publication being cited. Value examples: ['1', '1', '1'].),\n  (citing:bigint, ID of the publication that is citing another publication. Value examples: ['2', '3', '4'].),\n]\n# Table: conference\n[\n  (cid:bigint, Unique identifier for a conference. Value examples: ['1', '2', '3'].),\n  (homepage:text, The homepage URL for the conference. Value examples: ['www.isa.com', 'www.aaas.com', 'www.icml.com'].),\n  (name:text, The name of the conference. Value examples: ['ISA', 'AAAS', 'ICML'].),\n]\n# Table: domain\n[\n  (did:bigint, Unique identifier for a domain. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the domain. Value examples: ['Data Science', 'Natural Sciences', 'Computer Science'].),\n]\n# Table: domain_author\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1'].),\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['2', '4'].),\n]\n# Table: domain_conference\n[\n  (cid:bigint, Foreign key referencing the cid column in the conference table. Value examples: ['1', '2', '3'].),\n  (did:bigint, Foreign key referencing the did column in the domain table. Value examples: ['2', '4', '5'].),\n]\n# Table: domain_journal\n[\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['1', '2'].),\n  (jid:bigint, Foreign key referencing the journal table's primary key. Value examples: ['2', '3'].),\n]\n# Table: domain_keyword\n[\n  (did:bigint, Foreign key referencing the 'did' column of the 'domain' table. Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the 'kid' column of the 'keyword' table. Value examples: ['2', '3'].),\n]\n# Table: domain_publication\n[\n  (did:bigint, Foreign key referencing the domain table's primary key column (did). Value examples: ['4', '2', '1'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key column (pid). Value examples: ['1', '2', '3'].),\n]\n# Table: journal\n[\n  (homepage:text, The homepage URL for the journal. Value examples: ['www.aijournal.com', 'www.nature.com', 'www.science.com', 'www.ml.com'].),\n  (jid:bigint, Unique identifier for a journal. Value examples: ['1', '2', '3', '4'].),\n  (name:text, The name of the journal. Value examples: ['Journal of Artificial Intelligence Research', 'Nature', 'Science', 'Journal of Machine Learning Research'].),\n]\n# Table: keyword\n[\n  (keyword:text, The actual keyword. Value examples: ['AI', 'Neuroscience', 'Machine Learning', 'Keyword 4'].),\n  (kid:bigint, Unique identifier for a keyword. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: organization\n[\n  (continent:text, Continent where the organization is located. Value examples: ['Asia', 'North America', 'North America'].),\n  (homepage:text, URL of the organization's homepage. Value examples: ['www.organization1.com', 'www.organization2.com', 'www.organization3.com'].),\n  (name:text, Name of the organization. Value examples: ['Organization 1', 'Organization 2', 'Organization 3'].),\n  (oid:bigint, Unique identifier for the organization. Value examples: ['1', '2', '3'].),\n]\n# Table: publication\n[\n  (abstract:text, The abstract of the publication. Value examples: ['Abstract 1', 'Abstract 2'].),\n  (cid:bigint, The ID of the conference where the publication was presented. Value examples: ['1', '2'].),\n  (citation_num:bigint, The number of citations received by the publication. Value examples: ['4', '2'].),\n  (jid:bigint, The ID of the journal where the publication was published. Value examples: ['1', '2'].),\n  (pid:bigint, The unique ID of the publication. Value examples: ['1', '2'].),\n  (reference_num:bigint, The number of references cited by the publication. Value examples: ['0', '1'].),\n  (title:text, The title of the publication. Value examples: ['The Effects of Climate Change on Agriculture', 'A Study on the Effects of Social Media on Mental Health'].),\n  (year:bigint, The year of publication. Value examples: ['2020', '2020'].),\n]\n# Table: publication_keyword\n[\n  (pid:bigint, Foreign key referencing the publication table's primary key (pid). Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the keyword table's primary key (kid). Value examples: ['2', '3'].),\n]\n# Table: writes\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1', '2', '2'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.aid = domain_author.aid\nauthor.oid = organization.oid\nauthor.aid = writes.aid\ncite.cited = publication.pid\nconference.cid = domain_conference.cid\nconference.cid = publication.cid\ndomain.did = domain_author.did\ndomain.did = domain_conference.did\ndomain.did = domain_journal.did\ndomain.did = domain_keyword.did\ndomain_journal.jid = journal.jid\ndomain_keyword.kid = keyword.kid\ndomain_publication.pid = publication.pid\njournal.jid = publication.jid\nkeyword.kid = publication_keyword.kid\npublication.pid = publication_keyword.pid\npublication.pid = writes.pid\n\n【参考信息】\n\n\n【用户问题】\nWhat are the titles of all publications ordered alphabetically?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT DISTINCT publication.title FROM publication ORDER BY publication.title ASC NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "academic",
    "id": 14,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the ratio of publications to authors in the database?\n\n【数据库schema】\n【DB_ID】 academic\n【Schema】\n# Table: author\n[\n  (aid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3'].),\n  (homepage:text, URL of the author's personal website. Value examples: ['www.larry.com', 'www.ashish.com', 'www.noam.com'].),\n  (name:text, Name of the author. Value examples: ['Larry Summers', 'Ashish Vaswani', 'Noam Shazeer'].),\n  (oid:bigint, Foreign key referencing the organization the author belongs to. Value examples: ['2', '3', '3'].),\n]\n# Table: cite\n[\n  (cited:bigint, ID of the publication being cited. Value examples: ['1', '1', '1'].),\n  (citing:bigint, ID of the publication that is citing another publication. Value examples: ['2', '3', '4'].),\n]\n# Table: conference\n[\n  (cid:bigint, Unique identifier for a conference. Value examples: ['1', '2', '3'].),\n  (homepage:text, The homepage URL for the conference. Value examples: ['www.isa.com', 'www.aaas.com', 'www.icml.com'].),\n  (name:text, The name of the conference. Value examples: ['ISA', 'AAAS', 'ICML'].),\n]\n# Table: domain\n[\n  (did:bigint, Unique identifier for a domain. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the domain. Value examples: ['Data Science', 'Natural Sciences', 'Computer Science'].),\n]\n# Table: domain_author\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1'].),\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['2', '4'].),\n]\n# Table: domain_conference\n[\n  (cid:bigint, Foreign key referencing the cid column in the conference table. Value examples: ['1', '2', '3'].),\n  (did:bigint, Foreign key referencing the did column in the domain table. Value examples: ['2', '4', '5'].),\n]\n# Table: domain_journal\n[\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['1', '2'].),\n  (jid:bigint, Foreign key referencing the journal table's primary key. Value examples: ['2', '3'].),\n]\n# Table: domain_keyword\n[\n  (did:bigint, Foreign key referencing the 'did' column of the 'domain' table. Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the 'kid' column of the 'keyword' table. Value examples: ['2', '3'].),\n]\n# Table: domain_publication\n[\n  (did:bigint, Foreign key referencing the domain table's primary key column (did). Value examples: ['4', '2', '1'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key column (pid). Value examples: ['1', '2', '3'].),\n]\n# Table: journal\n[\n  (homepage:text, The homepage URL for the journal. Value examples: ['www.aijournal.com', 'www.nature.com', 'www.science.com', 'www.ml.com'].),\n  (jid:bigint, Unique identifier for a journal. Value examples: ['1', '2', '3', '4'].),\n  (name:text, The name of the journal. Value examples: ['Journal of Artificial Intelligence Research', 'Nature', 'Science', 'Journal of Machine Learning Research'].),\n]\n# Table: keyword\n[\n  (keyword:text, The actual keyword. Value examples: ['AI', 'Neuroscience', 'Machine Learning', 'Keyword 4'].),\n  (kid:bigint, Unique identifier for a keyword. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: organization\n[\n  (continent:text, Continent where the organization is located. Value examples: ['Asia', 'North America', 'North America'].),\n  (homepage:text, URL of the organization's homepage. Value examples: ['www.organization1.com', 'www.organization2.com', 'www.organization3.com'].),\n  (name:text, Name of the organization. Value examples: ['Organization 1', 'Organization 2', 'Organization 3'].),\n  (oid:bigint, Unique identifier for the organization. Value examples: ['1', '2', '3'].),\n]\n# Table: publication\n[\n  (abstract:text, The abstract of the publication. Value examples: ['Abstract 1', 'Abstract 2'].),\n  (cid:bigint, The ID of the conference where the publication was presented. Value examples: ['1', '2'].),\n  (citation_num:bigint, The number of citations received by the publication. Value examples: ['4', '2'].),\n  (jid:bigint, The ID of the journal where the publication was published. Value examples: ['1', '2'].),\n  (pid:bigint, The unique ID of the publication. Value examples: ['1', '2'].),\n  (reference_num:bigint, The number of references cited by the publication. Value examples: ['0', '1'].),\n  (title:text, The title of the publication. Value examples: ['The Effects of Climate Change on Agriculture', 'A Study on the Effects of Social Media on Mental Health'].),\n  (year:bigint, The year of publication. Value examples: ['2020', '2020'].),\n]\n# Table: publication_keyword\n[\n  (pid:bigint, Foreign key referencing the publication table's primary key (pid). Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the keyword table's primary key (kid). Value examples: ['2', '3'].),\n]\n# Table: writes\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1', '2', '2'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.aid = domain_author.aid\nauthor.oid = organization.oid\nauthor.aid = writes.aid\ncite.cited = publication.pid\nconference.cid = domain_conference.cid\nconference.cid = publication.cid\ndomain.did = domain_author.did\ndomain.did = domain_conference.did\ndomain.did = domain_journal.did\ndomain.did = domain_keyword.did\ndomain_journal.jid = journal.jid\ndomain_keyword.kid = keyword.kid\ndomain_publication.pid = publication.pid\njournal.jid = publication.jid\nkeyword.kid = publication_keyword.kid\npublication.pid = publication_keyword.pid\npublication.pid = writes.pid\n\n【参考信息】\n\n\n【用户问题】\nWhat is the ratio of publications to authors in the database?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT CAST(COUNT(DISTINCT publication.pid) AS FLOAT) / NULLIF(COUNT(DISTINCT author.aid), 0) AS publication_to_author_ratio FROM publication, author;",
        "role": "assistant"
      }
    ],
    "db_name": "academic",
    "id": 15,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the ratio of publications presented in conferences to publications published in journals?\n\n【数据库schema】\n【DB_ID】 academic\n【Schema】\n# Table: author\n[\n  (aid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3'].),\n  (homepage:text, URL of the author's personal website. Value examples: ['www.larry.com', 'www.ashish.com', 'www.noam.com'].),\n  (name:text, Name of the author. Value examples: ['Larry Summers', 'Ashish Vaswani', 'Noam Shazeer'].),\n  (oid:bigint, Foreign key referencing the organization the author belongs to. Value examples: ['2', '3', '3'].),\n]\n# Table: cite\n[\n  (cited:bigint, ID of the publication being cited. Value examples: ['1', '1', '1'].),\n  (citing:bigint, ID of the publication that is citing another publication. Value examples: ['2', '3', '4'].),\n]\n# Table: conference\n[\n  (cid:bigint, Unique identifier for a conference. Value examples: ['1', '2', '3'].),\n  (homepage:text, The homepage URL for the conference. Value examples: ['www.isa.com', 'www.aaas.com', 'www.icml.com'].),\n  (name:text, The name of the conference. Value examples: ['ISA', 'AAAS', 'ICML'].),\n]\n# Table: domain\n[\n  (did:bigint, Unique identifier for a domain. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the domain. Value examples: ['Data Science', 'Natural Sciences', 'Computer Science'].),\n]\n# Table: domain_author\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1'].),\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['2', '4'].),\n]\n# Table: domain_conference\n[\n  (cid:bigint, Foreign key referencing the cid column in the conference table. Value examples: ['1', '2', '3'].),\n  (did:bigint, Foreign key referencing the did column in the domain table. Value examples: ['2', '4', '5'].),\n]\n# Table: domain_journal\n[\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['1', '2'].),\n  (jid:bigint, Foreign key referencing the journal table's primary key. Value examples: ['2', '3'].),\n]\n# Table: domain_keyword\n[\n  (did:bigint, Foreign key referencing the 'did' column of the 'domain' table. Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the 'kid' column of the 'keyword' table. Value examples: ['2', '3'].),\n]\n# Table: domain_publication\n[\n  (did:bigint, Foreign key referencing the domain table's primary key column (did). Value examples: ['4', '2', '1'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key column (pid). Value examples: ['1', '2', '3'].),\n]\n# Table: journal\n[\n  (homepage:text, The homepage URL for the journal. Value examples: ['www.aijournal.com', 'www.nature.com', 'www.science.com', 'www.ml.com'].),\n  (jid:bigint, Unique identifier for a journal. Value examples: ['1', '2', '3', '4'].),\n  (name:text, The name of the journal. Value examples: ['Journal of Artificial Intelligence Research', 'Nature', 'Science', 'Journal of Machine Learning Research'].),\n]\n# Table: keyword\n[\n  (keyword:text, The actual keyword. Value examples: ['AI', 'Neuroscience', 'Machine Learning', 'Keyword 4'].),\n  (kid:bigint, Unique identifier for a keyword. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: organization\n[\n  (continent:text, Continent where the organization is located. Value examples: ['Asia', 'North America', 'North America'].),\n  (homepage:text, URL of the organization's homepage. Value examples: ['www.organization1.com', 'www.organization2.com', 'www.organization3.com'].),\n  (name:text, Name of the organization. Value examples: ['Organization 1', 'Organization 2', 'Organization 3'].),\n  (oid:bigint, Unique identifier for the organization. Value examples: ['1', '2', '3'].),\n]\n# Table: publication\n[\n  (abstract:text, The abstract of the publication. Value examples: ['Abstract 1', 'Abstract 2'].),\n  (cid:bigint, The ID of the conference where the publication was presented. Value examples: ['1', '2'].),\n  (citation_num:bigint, The number of citations received by the publication. Value examples: ['4', '2'].),\n  (jid:bigint, The ID of the journal where the publication was published. Value examples: ['1', '2'].),\n  (pid:bigint, The unique ID of the publication. Value examples: ['1', '2'].),\n  (reference_num:bigint, The number of references cited by the publication. Value examples: ['0', '1'].),\n  (title:text, The title of the publication. Value examples: ['The Effects of Climate Change on Agriculture', 'A Study on the Effects of Social Media on Mental Health'].),\n  (year:bigint, The year of publication. Value examples: ['2020', '2020'].),\n]\n# Table: publication_keyword\n[\n  (pid:bigint, Foreign key referencing the publication table's primary key (pid). Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the keyword table's primary key (kid). Value examples: ['2', '3'].),\n]\n# Table: writes\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1', '2', '2'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.aid = domain_author.aid\nauthor.oid = organization.oid\nauthor.aid = writes.aid\ncite.cited = publication.pid\nconference.cid = domain_conference.cid\nconference.cid = publication.cid\ndomain.did = domain_author.did\ndomain.did = domain_conference.did\ndomain.did = domain_journal.did\ndomain.did = domain_keyword.did\ndomain_journal.jid = journal.jid\ndomain_keyword.kid = keyword.kid\ndomain_publication.pid = publication.pid\njournal.jid = publication.jid\nkeyword.kid = publication_keyword.kid\npublication.pid = publication_keyword.pid\npublication.pid = writes.pid\n\n【参考信息】\n\n\n【用户问题】\nWhat is the ratio of publications presented in conferences to publications published in journals?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT CAST(COUNT(DISTINCT CASE WHEN cid IS NOT NULL THEN pid END) AS FLOAT) / NULLIF(COUNT(DISTINCT CASE WHEN jid IS NOT NULL THEN pid END), 0) AS ratio FROM publication;",
        "role": "assistant"
      }
    ],
    "db_name": "academic",
    "id": 16,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the ratio of the total number of publications to the total number of keywords within each domain ID? Show all domain IDs.\n\n【数据库schema】\n【DB_ID】 academic\n【Schema】\n# Table: author\n[\n  (aid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3'].),\n  (homepage:text, URL of the author's personal website. Value examples: ['www.larry.com', 'www.ashish.com', 'www.noam.com'].),\n  (name:text, Name of the author. Value examples: ['Larry Summers', 'Ashish Vaswani', 'Noam Shazeer'].),\n  (oid:bigint, Foreign key referencing the organization the author belongs to. Value examples: ['2', '3', '3'].),\n]\n# Table: cite\n[\n  (cited:bigint, ID of the publication being cited. Value examples: ['1', '1', '1'].),\n  (citing:bigint, ID of the publication that is citing another publication. Value examples: ['2', '3', '4'].),\n]\n# Table: conference\n[\n  (cid:bigint, Unique identifier for a conference. Value examples: ['1', '2', '3'].),\n  (homepage:text, The homepage URL for the conference. Value examples: ['www.isa.com', 'www.aaas.com', 'www.icml.com'].),\n  (name:text, The name of the conference. Value examples: ['ISA', 'AAAS', 'ICML'].),\n]\n# Table: domain\n[\n  (did:bigint, Unique identifier for a domain. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the domain. Value examples: ['Data Science', 'Natural Sciences', 'Computer Science'].),\n]\n# Table: domain_author\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1'].),\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['2', '4'].),\n]\n# Table: domain_conference\n[\n  (cid:bigint, Foreign key referencing the cid column in the conference table. Value examples: ['1', '2', '3'].),\n  (did:bigint, Foreign key referencing the did column in the domain table. Value examples: ['2', '4', '5'].),\n]\n# Table: domain_journal\n[\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['1', '2'].),\n  (jid:bigint, Foreign key referencing the journal table's primary key. Value examples: ['2', '3'].),\n]\n# Table: domain_keyword\n[\n  (did:bigint, Foreign key referencing the 'did' column of the 'domain' table. Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the 'kid' column of the 'keyword' table. Value examples: ['2', '3'].),\n]\n# Table: domain_publication\n[\n  (did:bigint, Foreign key referencing the domain table's primary key column (did). Value examples: ['4', '2', '1'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key column (pid). Value examples: ['1', '2', '3'].),\n]\n# Table: journal\n[\n  (homepage:text, The homepage URL for the journal. Value examples: ['www.aijournal.com', 'www.nature.com', 'www.science.com', 'www.ml.com'].),\n  (jid:bigint, Unique identifier for a journal. Value examples: ['1', '2', '3', '4'].),\n  (name:text, The name of the journal. Value examples: ['Journal of Artificial Intelligence Research', 'Nature', 'Science', 'Journal of Machine Learning Research'].),\n]\n# Table: keyword\n[\n  (keyword:text, The actual keyword. Value examples: ['AI', 'Neuroscience', 'Machine Learning', 'Keyword 4'].),\n  (kid:bigint, Unique identifier for a keyword. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: organization\n[\n  (continent:text, Continent where the organization is located. Value examples: ['Asia', 'North America', 'North America'].),\n  (homepage:text, URL of the organization's homepage. Value examples: ['www.organization1.com', 'www.organization2.com', 'www.organization3.com'].),\n  (name:text, Name of the organization. Value examples: ['Organization 1', 'Organization 2', 'Organization 3'].),\n  (oid:bigint, Unique identifier for the organization. Value examples: ['1', '2', '3'].),\n]\n# Table: publication\n[\n  (abstract:text, The abstract of the publication. Value examples: ['Abstract 1', 'Abstract 2'].),\n  (cid:bigint, The ID of the conference where the publication was presented. Value examples: ['1', '2'].),\n  (citation_num:bigint, The number of citations received by the publication. Value examples: ['4', '2'].),\n  (jid:bigint, The ID of the journal where the publication was published. Value examples: ['1', '2'].),\n  (pid:bigint, The unique ID of the publication. Value examples: ['1', '2'].),\n  (reference_num:bigint, The number of references cited by the publication. Value examples: ['0', '1'].),\n  (title:text, The title of the publication. Value examples: ['The Effects of Climate Change on Agriculture', 'A Study on the Effects of Social Media on Mental Health'].),\n  (year:bigint, The year of publication. Value examples: ['2020', '2020'].),\n]\n# Table: publication_keyword\n[\n  (pid:bigint, Foreign key referencing the publication table's primary key (pid). Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the keyword table's primary key (kid). Value examples: ['2', '3'].),\n]\n# Table: writes\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1', '2', '2'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.aid = domain_author.aid\nauthor.oid = organization.oid\nauthor.aid = writes.aid\ncite.cited = publication.pid\nconference.cid = domain_conference.cid\nconference.cid = publication.cid\ndomain.did = domain_author.did\ndomain.did = domain_conference.did\ndomain.did = domain_journal.did\ndomain.did = domain_keyword.did\ndomain_journal.jid = journal.jid\ndomain_keyword.kid = keyword.kid\ndomain_publication.pid = publication.pid\njournal.jid = publication.jid\nkeyword.kid = publication_keyword.kid\npublication.pid = publication_keyword.pid\npublication.pid = writes.pid\n\n【参考信息】\n\n\n【用户问题】\nWhat is the ratio of the total number of publications to the total number of keywords within each domain ID? Show all domain IDs.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT domain_publication.did, CAST(COUNT(DISTINCT domain_publication.pid) AS FLOAT) / NULLIF(COUNT(DISTINCT domain_keyword.kid), 0) AS publication_to_keyword_ratio FROM domain_publication LEFT JOIN domain_keyword ON domain_publication.did = domain_keyword.did GROUP BY domain_publication.did ORDER BY publication_to_keyword_ratio DESC NULLS LAST;SELECT domain_publication.did, CAST(COUNT(DISTINCT domain_publication.pid) AS FLOAT) / NULLIF(COUNT(DISTINCT domain_keyword.kid), 0) AS publication_to_keyword_ratio FROM domain_keyword LEFT JOIN domain_publication ON domain_publication.did = domain_keyword.did GROUP BY domain_publication.did ORDER BY publication_to_keyword_ratio DESC NULLS LAST;SELECT d.did, COALESCE(CAST(COUNT(DISTINCT dp.pid) AS FLOAT) / NULLIF(COUNT(DISTINCT dk.kid), 0), 0) AS publication_to_keyword_ratio FROM domain d LEFT JOIN domain_publication dp ON d.did = dp.did LEFT JOIN domain_keyword dk ON d.did = dk.did GROUP BY d.did ORDER BY publication_to_keyword_ratio DESC NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "academic",
    "id": 17,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow does the ratio of publications to journals change over the years? Return the annual numbers of publications and journals as well.\n\n【数据库schema】\n【DB_ID】 academic\n【Schema】\n# Table: author\n[\n  (aid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3'].),\n  (homepage:text, URL of the author's personal website. Value examples: ['www.larry.com', 'www.ashish.com', 'www.noam.com'].),\n  (name:text, Name of the author. Value examples: ['Larry Summers', 'Ashish Vaswani', 'Noam Shazeer'].),\n  (oid:bigint, Foreign key referencing the organization the author belongs to. Value examples: ['2', '3', '3'].),\n]\n# Table: cite\n[\n  (cited:bigint, ID of the publication being cited. Value examples: ['1', '1', '1'].),\n  (citing:bigint, ID of the publication that is citing another publication. Value examples: ['2', '3', '4'].),\n]\n# Table: conference\n[\n  (cid:bigint, Unique identifier for a conference. Value examples: ['1', '2', '3'].),\n  (homepage:text, The homepage URL for the conference. Value examples: ['www.isa.com', 'www.aaas.com', 'www.icml.com'].),\n  (name:text, The name of the conference. Value examples: ['ISA', 'AAAS', 'ICML'].),\n]\n# Table: domain\n[\n  (did:bigint, Unique identifier for a domain. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the domain. Value examples: ['Data Science', 'Natural Sciences', 'Computer Science'].),\n]\n# Table: domain_author\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1'].),\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['2', '4'].),\n]\n# Table: domain_conference\n[\n  (cid:bigint, Foreign key referencing the cid column in the conference table. Value examples: ['1', '2', '3'].),\n  (did:bigint, Foreign key referencing the did column in the domain table. Value examples: ['2', '4', '5'].),\n]\n# Table: domain_journal\n[\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['1', '2'].),\n  (jid:bigint, Foreign key referencing the journal table's primary key. Value examples: ['2', '3'].),\n]\n# Table: domain_keyword\n[\n  (did:bigint, Foreign key referencing the 'did' column of the 'domain' table. Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the 'kid' column of the 'keyword' table. Value examples: ['2', '3'].),\n]\n# Table: domain_publication\n[\n  (did:bigint, Foreign key referencing the domain table's primary key column (did). Value examples: ['4', '2', '1'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key column (pid). Value examples: ['1', '2', '3'].),\n]\n# Table: journal\n[\n  (homepage:text, The homepage URL for the journal. Value examples: ['www.aijournal.com', 'www.nature.com', 'www.science.com', 'www.ml.com'].),\n  (jid:bigint, Unique identifier for a journal. Value examples: ['1', '2', '3', '4'].),\n  (name:text, The name of the journal. Value examples: ['Journal of Artificial Intelligence Research', 'Nature', 'Science', 'Journal of Machine Learning Research'].),\n]\n# Table: keyword\n[\n  (keyword:text, The actual keyword. Value examples: ['AI', 'Neuroscience', 'Machine Learning', 'Keyword 4'].),\n  (kid:bigint, Unique identifier for a keyword. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: organization\n[\n  (continent:text, Continent where the organization is located. Value examples: ['Asia', 'North America', 'North America'].),\n  (homepage:text, URL of the organization's homepage. Value examples: ['www.organization1.com', 'www.organization2.com', 'www.organization3.com'].),\n  (name:text, Name of the organization. Value examples: ['Organization 1', 'Organization 2', 'Organization 3'].),\n  (oid:bigint, Unique identifier for the organization. Value examples: ['1', '2', '3'].),\n]\n# Table: publication\n[\n  (abstract:text, The abstract of the publication. Value examples: ['Abstract 1', 'Abstract 2'].),\n  (cid:bigint, The ID of the conference where the publication was presented. Value examples: ['1', '2'].),\n  (citation_num:bigint, The number of citations received by the publication. Value examples: ['4', '2'].),\n  (jid:bigint, The ID of the journal where the publication was published. Value examples: ['1', '2'].),\n  (pid:bigint, The unique ID of the publication. Value examples: ['1', '2'].),\n  (reference_num:bigint, The number of references cited by the publication. Value examples: ['0', '1'].),\n  (title:text, The title of the publication. Value examples: ['The Effects of Climate Change on Agriculture', 'A Study on the Effects of Social Media on Mental Health'].),\n  (year:bigint, The year of publication. Value examples: ['2020', '2020'].),\n]\n# Table: publication_keyword\n[\n  (pid:bigint, Foreign key referencing the publication table's primary key (pid). Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the keyword table's primary key (kid). Value examples: ['2', '3'].),\n]\n# Table: writes\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1', '2', '2'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.aid = domain_author.aid\nauthor.oid = organization.oid\nauthor.aid = writes.aid\ncite.cited = publication.pid\nconference.cid = domain_conference.cid\nconference.cid = publication.cid\ndomain.did = domain_author.did\ndomain.did = domain_conference.did\ndomain.did = domain_journal.did\ndomain.did = domain_keyword.did\ndomain_journal.jid = journal.jid\ndomain_keyword.kid = keyword.kid\ndomain_publication.pid = publication.pid\njournal.jid = publication.jid\nkeyword.kid = publication_keyword.kid\npublication.pid = publication_keyword.pid\npublication.pid = writes.pid\n\n【参考信息】\n\n\n【用户问题】\nHow does the ratio of publications to journals change over the years? Return the annual numbers of publications and journals as well.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT publication.year, COUNT(DISTINCT publication.pid) AS num_publications, COUNT(DISTINCT publication.jid) AS num_journals, CAST(COUNT(DISTINCT publication.pid) AS FLOAT) / NULLIF(COUNT(DISTINCT publication.jid), 0) AS ratio FROM publication GROUP BY publication.year ORDER BY publication.year;",
        "role": "assistant"
      }
    ],
    "db_name": "academic",
    "id": 18,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow does the ratio of authors to organizations differ by continent?\n\n【数据库schema】\n【DB_ID】 academic\n【Schema】\n# Table: author\n[\n  (aid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3'].),\n  (homepage:text, URL of the author's personal website. Value examples: ['www.larry.com', 'www.ashish.com', 'www.noam.com'].),\n  (name:text, Name of the author. Value examples: ['Larry Summers', 'Ashish Vaswani', 'Noam Shazeer'].),\n  (oid:bigint, Foreign key referencing the organization the author belongs to. Value examples: ['2', '3', '3'].),\n]\n# Table: cite\n[\n  (cited:bigint, ID of the publication being cited. Value examples: ['1', '1', '1'].),\n  (citing:bigint, ID of the publication that is citing another publication. Value examples: ['2', '3', '4'].),\n]\n# Table: conference\n[\n  (cid:bigint, Unique identifier for a conference. Value examples: ['1', '2', '3'].),\n  (homepage:text, The homepage URL for the conference. Value examples: ['www.isa.com', 'www.aaas.com', 'www.icml.com'].),\n  (name:text, The name of the conference. Value examples: ['ISA', 'AAAS', 'ICML'].),\n]\n# Table: domain\n[\n  (did:bigint, Unique identifier for a domain. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the domain. Value examples: ['Data Science', 'Natural Sciences', 'Computer Science'].),\n]\n# Table: domain_author\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1'].),\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['2', '4'].),\n]\n# Table: domain_conference\n[\n  (cid:bigint, Foreign key referencing the cid column in the conference table. Value examples: ['1', '2', '3'].),\n  (did:bigint, Foreign key referencing the did column in the domain table. Value examples: ['2', '4', '5'].),\n]\n# Table: domain_journal\n[\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['1', '2'].),\n  (jid:bigint, Foreign key referencing the journal table's primary key. Value examples: ['2', '3'].),\n]\n# Table: domain_keyword\n[\n  (did:bigint, Foreign key referencing the 'did' column of the 'domain' table. Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the 'kid' column of the 'keyword' table. Value examples: ['2', '3'].),\n]\n# Table: domain_publication\n[\n  (did:bigint, Foreign key referencing the domain table's primary key column (did). Value examples: ['4', '2', '1'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key column (pid). Value examples: ['1', '2', '3'].),\n]\n# Table: journal\n[\n  (homepage:text, The homepage URL for the journal. Value examples: ['www.aijournal.com', 'www.nature.com', 'www.science.com', 'www.ml.com'].),\n  (jid:bigint, Unique identifier for a journal. Value examples: ['1', '2', '3', '4'].),\n  (name:text, The name of the journal. Value examples: ['Journal of Artificial Intelligence Research', 'Nature', 'Science', 'Journal of Machine Learning Research'].),\n]\n# Table: keyword\n[\n  (keyword:text, The actual keyword. Value examples: ['AI', 'Neuroscience', 'Machine Learning', 'Keyword 4'].),\n  (kid:bigint, Unique identifier for a keyword. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: organization\n[\n  (continent:text, Continent where the organization is located. Value examples: ['Asia', 'North America', 'North America'].),\n  (homepage:text, URL of the organization's homepage. Value examples: ['www.organization1.com', 'www.organization2.com', 'www.organization3.com'].),\n  (name:text, Name of the organization. Value examples: ['Organization 1', 'Organization 2', 'Organization 3'].),\n  (oid:bigint, Unique identifier for the organization. Value examples: ['1', '2', '3'].),\n]\n# Table: publication\n[\n  (abstract:text, The abstract of the publication. Value examples: ['Abstract 1', 'Abstract 2'].),\n  (cid:bigint, The ID of the conference where the publication was presented. Value examples: ['1', '2'].),\n  (citation_num:bigint, The number of citations received by the publication. Value examples: ['4', '2'].),\n  (jid:bigint, The ID of the journal where the publication was published. Value examples: ['1', '2'].),\n  (pid:bigint, The unique ID of the publication. Value examples: ['1', '2'].),\n  (reference_num:bigint, The number of references cited by the publication. Value examples: ['0', '1'].),\n  (title:text, The title of the publication. Value examples: ['The Effects of Climate Change on Agriculture', 'A Study on the Effects of Social Media on Mental Health'].),\n  (year:bigint, The year of publication. Value examples: ['2020', '2020'].),\n]\n# Table: publication_keyword\n[\n  (pid:bigint, Foreign key referencing the publication table's primary key (pid). Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the keyword table's primary key (kid). Value examples: ['2', '3'].),\n]\n# Table: writes\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1', '2', '2'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.aid = domain_author.aid\nauthor.oid = organization.oid\nauthor.aid = writes.aid\ncite.cited = publication.pid\nconference.cid = domain_conference.cid\nconference.cid = publication.cid\ndomain.did = domain_author.did\ndomain.did = domain_conference.did\ndomain.did = domain_journal.did\ndomain.did = domain_keyword.did\ndomain_journal.jid = journal.jid\ndomain_keyword.kid = keyword.kid\ndomain_publication.pid = publication.pid\njournal.jid = publication.jid\nkeyword.kid = publication_keyword.kid\npublication.pid = publication_keyword.pid\npublication.pid = writes.pid\n\n【参考信息】\n\n\n【用户问题】\nHow does the ratio of authors to organizations differ by continent?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT o.continent, CAST(COUNT(DISTINCT a.aid) AS FLOAT) / NULLIF(COUNT(DISTINCT o.oid), 0) AS author_to_organization_ratio FROM author a JOIN organization o ON a.oid = o.oid GROUP BY o.continent ORDER BY author_to_organization_ratio DESC NULLS LAST;SELECT organization.continent, COUNT(DISTINCT author.aid)::float / NULLIF(COUNT(DISTINCT organization.oid), 0) AS ratio FROM organization LEFT JOIN author ON author.oid = organization.oid GROUP BY organization.continent ORDER BY ratio DESC NULLS LAST;SELECT organization.continent, COUNT(DISTINCT author.aid)::float / NULLIF(COUNT(DISTINCT organization.oid), 0) AS ratio FROM author LEFT JOIN organization ON author.oid = organization.oid GROUP BY organization.continent ORDER BY ratio DESC NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "academic",
    "id": 19,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich author had the most publications in the year 2021 and how many publications did he/she have that year?\n\n【数据库schema】\n【DB_ID】 academic\n【Schema】\n# Table: author\n[\n  (aid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3'].),\n  (homepage:text, URL of the author's personal website. Value examples: ['www.larry.com', 'www.ashish.com', 'www.noam.com'].),\n  (name:text, Name of the author. Value examples: ['Larry Summers', 'Ashish Vaswani', 'Noam Shazeer'].),\n  (oid:bigint, Foreign key referencing the organization the author belongs to. Value examples: ['2', '3', '3'].),\n]\n# Table: cite\n[\n  (cited:bigint, ID of the publication being cited. Value examples: ['1', '1', '1'].),\n  (citing:bigint, ID of the publication that is citing another publication. Value examples: ['2', '3', '4'].),\n]\n# Table: conference\n[\n  (cid:bigint, Unique identifier for a conference. Value examples: ['1', '2', '3'].),\n  (homepage:text, The homepage URL for the conference. Value examples: ['www.isa.com', 'www.aaas.com', 'www.icml.com'].),\n  (name:text, The name of the conference. Value examples: ['ISA', 'AAAS', 'ICML'].),\n]\n# Table: domain\n[\n  (did:bigint, Unique identifier for a domain. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the domain. Value examples: ['Data Science', 'Natural Sciences', 'Computer Science'].),\n]\n# Table: domain_author\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1'].),\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['2', '4'].),\n]\n# Table: domain_conference\n[\n  (cid:bigint, Foreign key referencing the cid column in the conference table. Value examples: ['1', '2', '3'].),\n  (did:bigint, Foreign key referencing the did column in the domain table. Value examples: ['2', '4', '5'].),\n]\n# Table: domain_journal\n[\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['1', '2'].),\n  (jid:bigint, Foreign key referencing the journal table's primary key. Value examples: ['2', '3'].),\n]\n# Table: domain_keyword\n[\n  (did:bigint, Foreign key referencing the 'did' column of the 'domain' table. Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the 'kid' column of the 'keyword' table. Value examples: ['2', '3'].),\n]\n# Table: domain_publication\n[\n  (did:bigint, Foreign key referencing the domain table's primary key column (did). Value examples: ['4', '2', '1'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key column (pid). Value examples: ['1', '2', '3'].),\n]\n# Table: journal\n[\n  (homepage:text, The homepage URL for the journal. Value examples: ['www.aijournal.com', 'www.nature.com', 'www.science.com', 'www.ml.com'].),\n  (jid:bigint, Unique identifier for a journal. Value examples: ['1', '2', '3', '4'].),\n  (name:text, The name of the journal. Value examples: ['Journal of Artificial Intelligence Research', 'Nature', 'Science', 'Journal of Machine Learning Research'].),\n]\n# Table: keyword\n[\n  (keyword:text, The actual keyword. Value examples: ['AI', 'Neuroscience', 'Machine Learning', 'Keyword 4'].),\n  (kid:bigint, Unique identifier for a keyword. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: organization\n[\n  (continent:text, Continent where the organization is located. Value examples: ['Asia', 'North America', 'North America'].),\n  (homepage:text, URL of the organization's homepage. Value examples: ['www.organization1.com', 'www.organization2.com', 'www.organization3.com'].),\n  (name:text, Name of the organization. Value examples: ['Organization 1', 'Organization 2', 'Organization 3'].),\n  (oid:bigint, Unique identifier for the organization. Value examples: ['1', '2', '3'].),\n]\n# Table: publication\n[\n  (abstract:text, The abstract of the publication. Value examples: ['Abstract 1', 'Abstract 2'].),\n  (cid:bigint, The ID of the conference where the publication was presented. Value examples: ['1', '2'].),\n  (citation_num:bigint, The number of citations received by the publication. Value examples: ['4', '2'].),\n  (jid:bigint, The ID of the journal where the publication was published. Value examples: ['1', '2'].),\n  (pid:bigint, The unique ID of the publication. Value examples: ['1', '2'].),\n  (reference_num:bigint, The number of references cited by the publication. Value examples: ['0', '1'].),\n  (title:text, The title of the publication. Value examples: ['The Effects of Climate Change on Agriculture', 'A Study on the Effects of Social Media on Mental Health'].),\n  (year:bigint, The year of publication. Value examples: ['2020', '2020'].),\n]\n# Table: publication_keyword\n[\n  (pid:bigint, Foreign key referencing the publication table's primary key (pid). Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the keyword table's primary key (kid). Value examples: ['2', '3'].),\n]\n# Table: writes\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1', '2', '2'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.aid = domain_author.aid\nauthor.oid = organization.oid\nauthor.aid = writes.aid\ncite.cited = publication.pid\nconference.cid = domain_conference.cid\nconference.cid = publication.cid\ndomain.did = domain_author.did\ndomain.did = domain_conference.did\ndomain.did = domain_journal.did\ndomain.did = domain_keyword.did\ndomain_journal.jid = journal.jid\ndomain_keyword.kid = keyword.kid\ndomain_publication.pid = publication.pid\njournal.jid = publication.jid\nkeyword.kid = publication_keyword.kid\npublication.pid = publication_keyword.pid\npublication.pid = writes.pid\n\n【参考信息】\n\n\n【用户问题】\nWhich author had the most publications in the year 2021 and how many publications did he/she have that year?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT author.name, author.aid, COUNT(publication.pid) AS publication_count FROM writes JOIN author ON writes.aid = author.aid JOIN publication ON writes.pid = publication.pid WHERE publication.year = 2021 GROUP BY author.name, author.aid ORDER BY publication_count DESC NULLS LAST LIMIT 1",
        "role": "assistant"
      }
    ],
    "db_name": "academic",
    "id": 20,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the total number of publications presented in each conference?\n\n【数据库schema】\n【DB_ID】 academic\n【Schema】\n# Table: author\n[\n  (aid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3'].),\n  (homepage:text, URL of the author's personal website. Value examples: ['www.larry.com', 'www.ashish.com', 'www.noam.com'].),\n  (name:text, Name of the author. Value examples: ['Larry Summers', 'Ashish Vaswani', 'Noam Shazeer'].),\n  (oid:bigint, Foreign key referencing the organization the author belongs to. Value examples: ['2', '3', '3'].),\n]\n# Table: cite\n[\n  (cited:bigint, ID of the publication being cited. Value examples: ['1', '1', '1'].),\n  (citing:bigint, ID of the publication that is citing another publication. Value examples: ['2', '3', '4'].),\n]\n# Table: conference\n[\n  (cid:bigint, Unique identifier for a conference. Value examples: ['1', '2', '3'].),\n  (homepage:text, The homepage URL for the conference. Value examples: ['www.isa.com', 'www.aaas.com', 'www.icml.com'].),\n  (name:text, The name of the conference. Value examples: ['ISA', 'AAAS', 'ICML'].),\n]\n# Table: domain\n[\n  (did:bigint, Unique identifier for a domain. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the domain. Value examples: ['Data Science', 'Natural Sciences', 'Computer Science'].),\n]\n# Table: domain_author\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1'].),\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['2', '4'].),\n]\n# Table: domain_conference\n[\n  (cid:bigint, Foreign key referencing the cid column in the conference table. Value examples: ['1', '2', '3'].),\n  (did:bigint, Foreign key referencing the did column in the domain table. Value examples: ['2', '4', '5'].),\n]\n# Table: domain_journal\n[\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['1', '2'].),\n  (jid:bigint, Foreign key referencing the journal table's primary key. Value examples: ['2', '3'].),\n]\n# Table: domain_keyword\n[\n  (did:bigint, Foreign key referencing the 'did' column of the 'domain' table. Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the 'kid' column of the 'keyword' table. Value examples: ['2', '3'].),\n]\n# Table: domain_publication\n[\n  (did:bigint, Foreign key referencing the domain table's primary key column (did). Value examples: ['4', '2', '1'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key column (pid). Value examples: ['1', '2', '3'].),\n]\n# Table: journal\n[\n  (homepage:text, The homepage URL for the journal. Value examples: ['www.aijournal.com', 'www.nature.com', 'www.science.com', 'www.ml.com'].),\n  (jid:bigint, Unique identifier for a journal. Value examples: ['1', '2', '3', '4'].),\n  (name:text, The name of the journal. Value examples: ['Journal of Artificial Intelligence Research', 'Nature', 'Science', 'Journal of Machine Learning Research'].),\n]\n# Table: keyword\n[\n  (keyword:text, The actual keyword. Value examples: ['AI', 'Neuroscience', 'Machine Learning', 'Keyword 4'].),\n  (kid:bigint, Unique identifier for a keyword. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: organization\n[\n  (continent:text, Continent where the organization is located. Value examples: ['Asia', 'North America', 'North America'].),\n  (homepage:text, URL of the organization's homepage. Value examples: ['www.organization1.com', 'www.organization2.com', 'www.organization3.com'].),\n  (name:text, Name of the organization. Value examples: ['Organization 1', 'Organization 2', 'Organization 3'].),\n  (oid:bigint, Unique identifier for the organization. Value examples: ['1', '2', '3'].),\n]\n# Table: publication\n[\n  (abstract:text, The abstract of the publication. Value examples: ['Abstract 1', 'Abstract 2'].),\n  (cid:bigint, The ID of the conference where the publication was presented. Value examples: ['1', '2'].),\n  (citation_num:bigint, The number of citations received by the publication. Value examples: ['4', '2'].),\n  (jid:bigint, The ID of the journal where the publication was published. Value examples: ['1', '2'].),\n  (pid:bigint, The unique ID of the publication. Value examples: ['1', '2'].),\n  (reference_num:bigint, The number of references cited by the publication. Value examples: ['0', '1'].),\n  (title:text, The title of the publication. Value examples: ['The Effects of Climate Change on Agriculture', 'A Study on the Effects of Social Media on Mental Health'].),\n  (year:bigint, The year of publication. Value examples: ['2020', '2020'].),\n]\n# Table: publication_keyword\n[\n  (pid:bigint, Foreign key referencing the publication table's primary key (pid). Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the keyword table's primary key (kid). Value examples: ['2', '3'].),\n]\n# Table: writes\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1', '2', '2'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.aid = domain_author.aid\nauthor.oid = organization.oid\nauthor.aid = writes.aid\ncite.cited = publication.pid\nconference.cid = domain_conference.cid\nconference.cid = publication.cid\ndomain.did = domain_author.did\ndomain.did = domain_conference.did\ndomain.did = domain_journal.did\ndomain.did = domain_keyword.did\ndomain_journal.jid = journal.jid\ndomain_keyword.kid = keyword.kid\ndomain_publication.pid = publication.pid\njournal.jid = publication.jid\nkeyword.kid = publication_keyword.kid\npublication.pid = publication_keyword.pid\npublication.pid = writes.pid\n\n【参考信息】\n\n\n【用户问题】\nWhat is the total number of publications presented in each conference?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT conference.name, conference.cid, COUNT(publication.pid) AS total_publications FROM publication JOIN conference ON publication.cid = conference.cid GROUP BY conference.name, conference.cid ORDER BY total_publications DESC",
        "role": "assistant"
      }
    ],
    "db_name": "academic",
    "id": 21,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the total number of publications in each journal, ordered by the number of publications in descending order?\n\n【数据库schema】\n【DB_ID】 academic\n【Schema】\n# Table: author\n[\n  (aid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3'].),\n  (homepage:text, URL of the author's personal website. Value examples: ['www.larry.com', 'www.ashish.com', 'www.noam.com'].),\n  (name:text, Name of the author. Value examples: ['Larry Summers', 'Ashish Vaswani', 'Noam Shazeer'].),\n  (oid:bigint, Foreign key referencing the organization the author belongs to. Value examples: ['2', '3', '3'].),\n]\n# Table: cite\n[\n  (cited:bigint, ID of the publication being cited. Value examples: ['1', '1', '1'].),\n  (citing:bigint, ID of the publication that is citing another publication. Value examples: ['2', '3', '4'].),\n]\n# Table: conference\n[\n  (cid:bigint, Unique identifier for a conference. Value examples: ['1', '2', '3'].),\n  (homepage:text, The homepage URL for the conference. Value examples: ['www.isa.com', 'www.aaas.com', 'www.icml.com'].),\n  (name:text, The name of the conference. Value examples: ['ISA', 'AAAS', 'ICML'].),\n]\n# Table: domain\n[\n  (did:bigint, Unique identifier for a domain. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the domain. Value examples: ['Data Science', 'Natural Sciences', 'Computer Science'].),\n]\n# Table: domain_author\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1'].),\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['2', '4'].),\n]\n# Table: domain_conference\n[\n  (cid:bigint, Foreign key referencing the cid column in the conference table. Value examples: ['1', '2', '3'].),\n  (did:bigint, Foreign key referencing the did column in the domain table. Value examples: ['2', '4', '5'].),\n]\n# Table: domain_journal\n[\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['1', '2'].),\n  (jid:bigint, Foreign key referencing the journal table's primary key. Value examples: ['2', '3'].),\n]\n# Table: domain_keyword\n[\n  (did:bigint, Foreign key referencing the 'did' column of the 'domain' table. Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the 'kid' column of the 'keyword' table. Value examples: ['2', '3'].),\n]\n# Table: domain_publication\n[\n  (did:bigint, Foreign key referencing the domain table's primary key column (did). Value examples: ['4', '2', '1'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key column (pid). Value examples: ['1', '2', '3'].),\n]\n# Table: journal\n[\n  (homepage:text, The homepage URL for the journal. Value examples: ['www.aijournal.com', 'www.nature.com', 'www.science.com', 'www.ml.com'].),\n  (jid:bigint, Unique identifier for a journal. Value examples: ['1', '2', '3', '4'].),\n  (name:text, The name of the journal. Value examples: ['Journal of Artificial Intelligence Research', 'Nature', 'Science', 'Journal of Machine Learning Research'].),\n]\n# Table: keyword\n[\n  (keyword:text, The actual keyword. Value examples: ['AI', 'Neuroscience', 'Machine Learning', 'Keyword 4'].),\n  (kid:bigint, Unique identifier for a keyword. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: organization\n[\n  (continent:text, Continent where the organization is located. Value examples: ['Asia', 'North America', 'North America'].),\n  (homepage:text, URL of the organization's homepage. Value examples: ['www.organization1.com', 'www.organization2.com', 'www.organization3.com'].),\n  (name:text, Name of the organization. Value examples: ['Organization 1', 'Organization 2', 'Organization 3'].),\n  (oid:bigint, Unique identifier for the organization. Value examples: ['1', '2', '3'].),\n]\n# Table: publication\n[\n  (abstract:text, The abstract of the publication. Value examples: ['Abstract 1', 'Abstract 2'].),\n  (cid:bigint, The ID of the conference where the publication was presented. Value examples: ['1', '2'].),\n  (citation_num:bigint, The number of citations received by the publication. Value examples: ['4', '2'].),\n  (jid:bigint, The ID of the journal where the publication was published. Value examples: ['1', '2'].),\n  (pid:bigint, The unique ID of the publication. Value examples: ['1', '2'].),\n  (reference_num:bigint, The number of references cited by the publication. Value examples: ['0', '1'].),\n  (title:text, The title of the publication. Value examples: ['The Effects of Climate Change on Agriculture', 'A Study on the Effects of Social Media on Mental Health'].),\n  (year:bigint, The year of publication. Value examples: ['2020', '2020'].),\n]\n# Table: publication_keyword\n[\n  (pid:bigint, Foreign key referencing the publication table's primary key (pid). Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the keyword table's primary key (kid). Value examples: ['2', '3'].),\n]\n# Table: writes\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1', '2', '2'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.aid = domain_author.aid\nauthor.oid = organization.oid\nauthor.aid = writes.aid\ncite.cited = publication.pid\nconference.cid = domain_conference.cid\nconference.cid = publication.cid\ndomain.did = domain_author.did\ndomain.did = domain_conference.did\ndomain.did = domain_journal.did\ndomain.did = domain_keyword.did\ndomain_journal.jid = journal.jid\ndomain_keyword.kid = keyword.kid\ndomain_publication.pid = publication.pid\njournal.jid = publication.jid\nkeyword.kid = publication_keyword.kid\npublication.pid = publication_keyword.pid\npublication.pid = writes.pid\n\n【参考信息】\n\n\n【用户问题】\nWhat is the total number of publications in each journal, ordered by the number of publications in descending order?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT journal.name, journal.jid, COUNT(publication.pid) AS total_publications FROM journal LEFT JOIN publication ON journal.jid=publication.jid GROUP BY journal.name, journal.jid ORDER BY total_publications DESC NULLS LAST",
        "role": "assistant"
      }
    ],
    "db_name": "academic",
    "id": 22,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many publications were presented at each conference, ordered by the number of publications in descending order? Give the names of the conferences and their corresponding number of publications.\n\n【数据库schema】\n【DB_ID】 academic\n【Schema】\n# Table: author\n[\n  (aid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3'].),\n  (homepage:text, URL of the author's personal website. Value examples: ['www.larry.com', 'www.ashish.com', 'www.noam.com'].),\n  (name:text, Name of the author. Value examples: ['Larry Summers', 'Ashish Vaswani', 'Noam Shazeer'].),\n  (oid:bigint, Foreign key referencing the organization the author belongs to. Value examples: ['2', '3', '3'].),\n]\n# Table: cite\n[\n  (cited:bigint, ID of the publication being cited. Value examples: ['1', '1', '1'].),\n  (citing:bigint, ID of the publication that is citing another publication. Value examples: ['2', '3', '4'].),\n]\n# Table: conference\n[\n  (cid:bigint, Unique identifier for a conference. Value examples: ['1', '2', '3'].),\n  (homepage:text, The homepage URL for the conference. Value examples: ['www.isa.com', 'www.aaas.com', 'www.icml.com'].),\n  (name:text, The name of the conference. Value examples: ['ISA', 'AAAS', 'ICML'].),\n]\n# Table: domain\n[\n  (did:bigint, Unique identifier for a domain. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the domain. Value examples: ['Data Science', 'Natural Sciences', 'Computer Science'].),\n]\n# Table: domain_author\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1'].),\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['2', '4'].),\n]\n# Table: domain_conference\n[\n  (cid:bigint, Foreign key referencing the cid column in the conference table. Value examples: ['1', '2', '3'].),\n  (did:bigint, Foreign key referencing the did column in the domain table. Value examples: ['2', '4', '5'].),\n]\n# Table: domain_journal\n[\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['1', '2'].),\n  (jid:bigint, Foreign key referencing the journal table's primary key. Value examples: ['2', '3'].),\n]\n# Table: domain_keyword\n[\n  (did:bigint, Foreign key referencing the 'did' column of the 'domain' table. Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the 'kid' column of the 'keyword' table. Value examples: ['2', '3'].),\n]\n# Table: domain_publication\n[\n  (did:bigint, Foreign key referencing the domain table's primary key column (did). Value examples: ['4', '2', '1'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key column (pid). Value examples: ['1', '2', '3'].),\n]\n# Table: journal\n[\n  (homepage:text, The homepage URL for the journal. Value examples: ['www.aijournal.com', 'www.nature.com', 'www.science.com', 'www.ml.com'].),\n  (jid:bigint, Unique identifier for a journal. Value examples: ['1', '2', '3', '4'].),\n  (name:text, The name of the journal. Value examples: ['Journal of Artificial Intelligence Research', 'Nature', 'Science', 'Journal of Machine Learning Research'].),\n]\n# Table: keyword\n[\n  (keyword:text, The actual keyword. Value examples: ['AI', 'Neuroscience', 'Machine Learning', 'Keyword 4'].),\n  (kid:bigint, Unique identifier for a keyword. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: organization\n[\n  (continent:text, Continent where the organization is located. Value examples: ['Asia', 'North America', 'North America'].),\n  (homepage:text, URL of the organization's homepage. Value examples: ['www.organization1.com', 'www.organization2.com', 'www.organization3.com'].),\n  (name:text, Name of the organization. Value examples: ['Organization 1', 'Organization 2', 'Organization 3'].),\n  (oid:bigint, Unique identifier for the organization. Value examples: ['1', '2', '3'].),\n]\n# Table: publication\n[\n  (abstract:text, The abstract of the publication. Value examples: ['Abstract 1', 'Abstract 2'].),\n  (cid:bigint, The ID of the conference where the publication was presented. Value examples: ['1', '2'].),\n  (citation_num:bigint, The number of citations received by the publication. Value examples: ['4', '2'].),\n  (jid:bigint, The ID of the journal where the publication was published. Value examples: ['1', '2'].),\n  (pid:bigint, The unique ID of the publication. Value examples: ['1', '2'].),\n  (reference_num:bigint, The number of references cited by the publication. Value examples: ['0', '1'].),\n  (title:text, The title of the publication. Value examples: ['The Effects of Climate Change on Agriculture', 'A Study on the Effects of Social Media on Mental Health'].),\n  (year:bigint, The year of publication. Value examples: ['2020', '2020'].),\n]\n# Table: publication_keyword\n[\n  (pid:bigint, Foreign key referencing the publication table's primary key (pid). Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the keyword table's primary key (kid). Value examples: ['2', '3'].),\n]\n# Table: writes\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1', '2', '2'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.aid = domain_author.aid\nauthor.oid = organization.oid\nauthor.aid = writes.aid\ncite.cited = publication.pid\nconference.cid = domain_conference.cid\nconference.cid = publication.cid\ndomain.did = domain_author.did\ndomain.did = domain_conference.did\ndomain.did = domain_journal.did\ndomain.did = domain_keyword.did\ndomain_journal.jid = journal.jid\ndomain_keyword.kid = keyword.kid\ndomain_publication.pid = publication.pid\njournal.jid = publication.jid\nkeyword.kid = publication_keyword.kid\npublication.pid = publication_keyword.pid\npublication.pid = writes.pid\n\n【参考信息】\n\n\n【用户问题】\nHow many publications were presented at each conference, ordered by the number of publications in descending order? Give the names of the conferences and their corresponding number of publications.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT conference.name, COUNT(publication.pid) AS num_publications FROM publication JOIN conference ON publication.cid=conference.cid GROUP BY conference.name, conference.cid ORDER BY num_publications DESC NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "academic",
    "id": 23,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many publications were published in journals whose names start with the letter \"J\"?\n\n【数据库schema】\n【DB_ID】 academic\n【Schema】\n# Table: author\n[\n  (aid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3'].),\n  (homepage:text, URL of the author's personal website. Value examples: ['www.larry.com', 'www.ashish.com', 'www.noam.com'].),\n  (name:text, Name of the author. Value examples: ['Larry Summers', 'Ashish Vaswani', 'Noam Shazeer'].),\n  (oid:bigint, Foreign key referencing the organization the author belongs to. Value examples: ['2', '3', '3'].),\n]\n# Table: cite\n[\n  (cited:bigint, ID of the publication being cited. Value examples: ['1', '1', '1'].),\n  (citing:bigint, ID of the publication that is citing another publication. Value examples: ['2', '3', '4'].),\n]\n# Table: conference\n[\n  (cid:bigint, Unique identifier for a conference. Value examples: ['1', '2', '3'].),\n  (homepage:text, The homepage URL for the conference. Value examples: ['www.isa.com', 'www.aaas.com', 'www.icml.com'].),\n  (name:text, The name of the conference. Value examples: ['ISA', 'AAAS', 'ICML'].),\n]\n# Table: domain\n[\n  (did:bigint, Unique identifier for a domain. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the domain. Value examples: ['Data Science', 'Natural Sciences', 'Computer Science'].),\n]\n# Table: domain_author\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1'].),\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['2', '4'].),\n]\n# Table: domain_conference\n[\n  (cid:bigint, Foreign key referencing the cid column in the conference table. Value examples: ['1', '2', '3'].),\n  (did:bigint, Foreign key referencing the did column in the domain table. Value examples: ['2', '4', '5'].),\n]\n# Table: domain_journal\n[\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['1', '2'].),\n  (jid:bigint, Foreign key referencing the journal table's primary key. Value examples: ['2', '3'].),\n]\n# Table: domain_keyword\n[\n  (did:bigint, Foreign key referencing the 'did' column of the 'domain' table. Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the 'kid' column of the 'keyword' table. Value examples: ['2', '3'].),\n]\n# Table: domain_publication\n[\n  (did:bigint, Foreign key referencing the domain table's primary key column (did). Value examples: ['4', '2', '1'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key column (pid). Value examples: ['1', '2', '3'].),\n]\n# Table: journal\n[\n  (homepage:text, The homepage URL for the journal. Value examples: ['www.aijournal.com', 'www.nature.com', 'www.science.com', 'www.ml.com'].),\n  (jid:bigint, Unique identifier for a journal. Value examples: ['1', '2', '3', '4'].),\n  (name:text, The name of the journal. Value examples: ['Journal of Artificial Intelligence Research', 'Nature', 'Science', 'Journal of Machine Learning Research'].),\n]\n# Table: keyword\n[\n  (keyword:text, The actual keyword. Value examples: ['AI', 'Neuroscience', 'Machine Learning', 'Keyword 4'].),\n  (kid:bigint, Unique identifier for a keyword. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: organization\n[\n  (continent:text, Continent where the organization is located. Value examples: ['Asia', 'North America', 'North America'].),\n  (homepage:text, URL of the organization's homepage. Value examples: ['www.organization1.com', 'www.organization2.com', 'www.organization3.com'].),\n  (name:text, Name of the organization. Value examples: ['Organization 1', 'Organization 2', 'Organization 3'].),\n  (oid:bigint, Unique identifier for the organization. Value examples: ['1', '2', '3'].),\n]\n# Table: publication\n[\n  (abstract:text, The abstract of the publication. Value examples: ['Abstract 1', 'Abstract 2'].),\n  (cid:bigint, The ID of the conference where the publication was presented. Value examples: ['1', '2'].),\n  (citation_num:bigint, The number of citations received by the publication. Value examples: ['4', '2'].),\n  (jid:bigint, The ID of the journal where the publication was published. Value examples: ['1', '2'].),\n  (pid:bigint, The unique ID of the publication. Value examples: ['1', '2'].),\n  (reference_num:bigint, The number of references cited by the publication. Value examples: ['0', '1'].),\n  (title:text, The title of the publication. Value examples: ['The Effects of Climate Change on Agriculture', 'A Study on the Effects of Social Media on Mental Health'].),\n  (year:bigint, The year of publication. Value examples: ['2020', '2020'].),\n]\n# Table: publication_keyword\n[\n  (pid:bigint, Foreign key referencing the publication table's primary key (pid). Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the keyword table's primary key (kid). Value examples: ['2', '3'].),\n]\n# Table: writes\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1', '2', '2'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.aid = domain_author.aid\nauthor.oid = organization.oid\nauthor.aid = writes.aid\ncite.cited = publication.pid\nconference.cid = domain_conference.cid\nconference.cid = publication.cid\ndomain.did = domain_author.did\ndomain.did = domain_conference.did\ndomain.did = domain_journal.did\ndomain.did = domain_keyword.did\ndomain_journal.jid = journal.jid\ndomain_keyword.kid = keyword.kid\ndomain_publication.pid = publication.pid\njournal.jid = publication.jid\nkeyword.kid = publication_keyword.kid\npublication.pid = publication_keyword.pid\npublication.pid = writes.pid\n\n【参考信息】\n\n\n【用户问题】\nHow many publications were published in journals whose names start with the letter \"J\"?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT count(DISTINCT publication.pid) FROM publication JOIN journal ON publication.jid = journal.jid WHERE journal.name ilike 'J%';",
        "role": "assistant"
      }
    ],
    "db_name": "academic",
    "id": 24,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich organizations have authors who have written publications in the domain \"Machine Learning\"?\n\n【数据库schema】\n【DB_ID】 academic\n【Schema】\n# Table: author\n[\n  (aid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3'].),\n  (homepage:text, URL of the author's personal website. Value examples: ['www.larry.com', 'www.ashish.com', 'www.noam.com'].),\n  (name:text, Name of the author. Value examples: ['Larry Summers', 'Ashish Vaswani', 'Noam Shazeer'].),\n  (oid:bigint, Foreign key referencing the organization the author belongs to. Value examples: ['2', '3', '3'].),\n]\n# Table: cite\n[\n  (cited:bigint, ID of the publication being cited. Value examples: ['1', '1', '1'].),\n  (citing:bigint, ID of the publication that is citing another publication. Value examples: ['2', '3', '4'].),\n]\n# Table: conference\n[\n  (cid:bigint, Unique identifier for a conference. Value examples: ['1', '2', '3'].),\n  (homepage:text, The homepage URL for the conference. Value examples: ['www.isa.com', 'www.aaas.com', 'www.icml.com'].),\n  (name:text, The name of the conference. Value examples: ['ISA', 'AAAS', 'ICML'].),\n]\n# Table: domain\n[\n  (did:bigint, Unique identifier for a domain. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the domain. Value examples: ['Data Science', 'Natural Sciences', 'Computer Science'].),\n]\n# Table: domain_author\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1'].),\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['2', '4'].),\n]\n# Table: domain_conference\n[\n  (cid:bigint, Foreign key referencing the cid column in the conference table. Value examples: ['1', '2', '3'].),\n  (did:bigint, Foreign key referencing the did column in the domain table. Value examples: ['2', '4', '5'].),\n]\n# Table: domain_journal\n[\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['1', '2'].),\n  (jid:bigint, Foreign key referencing the journal table's primary key. Value examples: ['2', '3'].),\n]\n# Table: domain_keyword\n[\n  (did:bigint, Foreign key referencing the 'did' column of the 'domain' table. Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the 'kid' column of the 'keyword' table. Value examples: ['2', '3'].),\n]\n# Table: domain_publication\n[\n  (did:bigint, Foreign key referencing the domain table's primary key column (did). Value examples: ['4', '2', '1'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key column (pid). Value examples: ['1', '2', '3'].),\n]\n# Table: journal\n[\n  (homepage:text, The homepage URL for the journal. Value examples: ['www.aijournal.com', 'www.nature.com', 'www.science.com', 'www.ml.com'].),\n  (jid:bigint, Unique identifier for a journal. Value examples: ['1', '2', '3', '4'].),\n  (name:text, The name of the journal. Value examples: ['Journal of Artificial Intelligence Research', 'Nature', 'Science', 'Journal of Machine Learning Research'].),\n]\n# Table: keyword\n[\n  (keyword:text, The actual keyword. Value examples: ['AI', 'Neuroscience', 'Machine Learning', 'Keyword 4'].),\n  (kid:bigint, Unique identifier for a keyword. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: organization\n[\n  (continent:text, Continent where the organization is located. Value examples: ['Asia', 'North America', 'North America'].),\n  (homepage:text, URL of the organization's homepage. Value examples: ['www.organization1.com', 'www.organization2.com', 'www.organization3.com'].),\n  (name:text, Name of the organization. Value examples: ['Organization 1', 'Organization 2', 'Organization 3'].),\n  (oid:bigint, Unique identifier for the organization. Value examples: ['1', '2', '3'].),\n]\n# Table: publication\n[\n  (abstract:text, The abstract of the publication. Value examples: ['Abstract 1', 'Abstract 2'].),\n  (cid:bigint, The ID of the conference where the publication was presented. Value examples: ['1', '2'].),\n  (citation_num:bigint, The number of citations received by the publication. Value examples: ['4', '2'].),\n  (jid:bigint, The ID of the journal where the publication was published. Value examples: ['1', '2'].),\n  (pid:bigint, The unique ID of the publication. Value examples: ['1', '2'].),\n  (reference_num:bigint, The number of references cited by the publication. Value examples: ['0', '1'].),\n  (title:text, The title of the publication. Value examples: ['The Effects of Climate Change on Agriculture', 'A Study on the Effects of Social Media on Mental Health'].),\n  (year:bigint, The year of publication. Value examples: ['2020', '2020'].),\n]\n# Table: publication_keyword\n[\n  (pid:bigint, Foreign key referencing the publication table's primary key (pid). Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the keyword table's primary key (kid). Value examples: ['2', '3'].),\n]\n# Table: writes\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1', '2', '2'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.aid = domain_author.aid\nauthor.oid = organization.oid\nauthor.aid = writes.aid\ncite.cited = publication.pid\nconference.cid = domain_conference.cid\nconference.cid = publication.cid\ndomain.did = domain_author.did\ndomain.did = domain_conference.did\ndomain.did = domain_journal.did\ndomain.did = domain_keyword.did\ndomain_journal.jid = journal.jid\ndomain_keyword.kid = keyword.kid\ndomain_publication.pid = publication.pid\njournal.jid = publication.jid\nkeyword.kid = publication_keyword.kid\npublication.pid = publication_keyword.pid\npublication.pid = writes.pid\n\n【参考信息】\nAlways filter names using an exact match\n\n【用户问题】\nWhich organizations have authors who have written publications in the domain \"Machine Learning\"?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT DISTINCT organization.name, organization.oid FROM organization JOIN author ON organization.oid = author.oid JOIN writes ON author.aid = writes.aid JOIN domain_publication ON writes.pid = domain_publication.pid JOIN domain ON domain_publication.did = domain.did WHERE domain.name = 'Machine Learning'",
        "role": "assistant"
      }
    ],
    "db_name": "academic",
    "id": 25,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich authors belong to the same domain as Martin?\n\n【数据库schema】\n【DB_ID】 academic\n【Schema】\n# Table: author\n[\n  (aid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3'].),\n  (homepage:text, URL of the author's personal website. Value examples: ['www.larry.com', 'www.ashish.com', 'www.noam.com'].),\n  (name:text, Name of the author. Value examples: ['Larry Summers', 'Ashish Vaswani', 'Noam Shazeer'].),\n  (oid:bigint, Foreign key referencing the organization the author belongs to. Value examples: ['2', '3', '3'].),\n]\n# Table: cite\n[\n  (cited:bigint, ID of the publication being cited. Value examples: ['1', '1', '1'].),\n  (citing:bigint, ID of the publication that is citing another publication. Value examples: ['2', '3', '4'].),\n]\n# Table: conference\n[\n  (cid:bigint, Unique identifier for a conference. Value examples: ['1', '2', '3'].),\n  (homepage:text, The homepage URL for the conference. Value examples: ['www.isa.com', 'www.aaas.com', 'www.icml.com'].),\n  (name:text, The name of the conference. Value examples: ['ISA', 'AAAS', 'ICML'].),\n]\n# Table: domain\n[\n  (did:bigint, Unique identifier for a domain. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the domain. Value examples: ['Data Science', 'Natural Sciences', 'Computer Science'].),\n]\n# Table: domain_author\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1'].),\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['2', '4'].),\n]\n# Table: domain_conference\n[\n  (cid:bigint, Foreign key referencing the cid column in the conference table. Value examples: ['1', '2', '3'].),\n  (did:bigint, Foreign key referencing the did column in the domain table. Value examples: ['2', '4', '5'].),\n]\n# Table: domain_journal\n[\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['1', '2'].),\n  (jid:bigint, Foreign key referencing the journal table's primary key. Value examples: ['2', '3'].),\n]\n# Table: domain_keyword\n[\n  (did:bigint, Foreign key referencing the 'did' column of the 'domain' table. Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the 'kid' column of the 'keyword' table. Value examples: ['2', '3'].),\n]\n# Table: domain_publication\n[\n  (did:bigint, Foreign key referencing the domain table's primary key column (did). Value examples: ['4', '2', '1'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key column (pid). Value examples: ['1', '2', '3'].),\n]\n# Table: journal\n[\n  (homepage:text, The homepage URL for the journal. Value examples: ['www.aijournal.com', 'www.nature.com', 'www.science.com', 'www.ml.com'].),\n  (jid:bigint, Unique identifier for a journal. Value examples: ['1', '2', '3', '4'].),\n  (name:text, The name of the journal. Value examples: ['Journal of Artificial Intelligence Research', 'Nature', 'Science', 'Journal of Machine Learning Research'].),\n]\n# Table: keyword\n[\n  (keyword:text, The actual keyword. Value examples: ['AI', 'Neuroscience', 'Machine Learning', 'Keyword 4'].),\n  (kid:bigint, Unique identifier for a keyword. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: organization\n[\n  (continent:text, Continent where the organization is located. Value examples: ['Asia', 'North America', 'North America'].),\n  (homepage:text, URL of the organization's homepage. Value examples: ['www.organization1.com', 'www.organization2.com', 'www.organization3.com'].),\n  (name:text, Name of the organization. Value examples: ['Organization 1', 'Organization 2', 'Organization 3'].),\n  (oid:bigint, Unique identifier for the organization. Value examples: ['1', '2', '3'].),\n]\n# Table: publication\n[\n  (abstract:text, The abstract of the publication. Value examples: ['Abstract 1', 'Abstract 2'].),\n  (cid:bigint, The ID of the conference where the publication was presented. Value examples: ['1', '2'].),\n  (citation_num:bigint, The number of citations received by the publication. Value examples: ['4', '2'].),\n  (jid:bigint, The ID of the journal where the publication was published. Value examples: ['1', '2'].),\n  (pid:bigint, The unique ID of the publication. Value examples: ['1', '2'].),\n  (reference_num:bigint, The number of references cited by the publication. Value examples: ['0', '1'].),\n  (title:text, The title of the publication. Value examples: ['The Effects of Climate Change on Agriculture', 'A Study on the Effects of Social Media on Mental Health'].),\n  (year:bigint, The year of publication. Value examples: ['2020', '2020'].),\n]\n# Table: publication_keyword\n[\n  (pid:bigint, Foreign key referencing the publication table's primary key (pid). Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the keyword table's primary key (kid). Value examples: ['2', '3'].),\n]\n# Table: writes\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1', '2', '2'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.aid = domain_author.aid\nauthor.oid = organization.oid\nauthor.aid = writes.aid\ncite.cited = publication.pid\nconference.cid = domain_conference.cid\nconference.cid = publication.cid\ndomain.did = domain_author.did\ndomain.did = domain_conference.did\ndomain.did = domain_journal.did\ndomain.did = domain_keyword.did\ndomain_journal.jid = journal.jid\ndomain_keyword.kid = keyword.kid\ndomain_publication.pid = publication.pid\njournal.jid = publication.jid\nkeyword.kid = publication_keyword.kid\npublication.pid = publication_keyword.pid\npublication.pid = writes.pid\n\n【参考信息】\nAlways filter names using ILIKE with percent sign wildcards\n\n【用户问题】\nWhich authors belong to the same domain as Martin?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT DISTINCT a2.name, a2.aid FROM author a1 JOIN domain_author da1 ON a1.aid = da1.aid JOIN domain_author da2 ON da1.did = da2.did JOIN author a2 ON da2.aid = a2.aid WHERE LOWER(a1.name) ILIKE '%martin%'",
        "role": "assistant"
      }
    ],
    "db_name": "academic",
    "id": 26,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich authors are not part of any organization?\n\n【数据库schema】\n【DB_ID】 academic\n【Schema】\n# Table: author\n[\n  (aid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3'].),\n  (homepage:text, URL of the author's personal website. Value examples: ['www.larry.com', 'www.ashish.com', 'www.noam.com'].),\n  (name:text, Name of the author. Value examples: ['Larry Summers', 'Ashish Vaswani', 'Noam Shazeer'].),\n  (oid:bigint, Foreign key referencing the organization the author belongs to. Value examples: ['2', '3', '3'].),\n]\n# Table: cite\n[\n  (cited:bigint, ID of the publication being cited. Value examples: ['1', '1', '1'].),\n  (citing:bigint, ID of the publication that is citing another publication. Value examples: ['2', '3', '4'].),\n]\n# Table: conference\n[\n  (cid:bigint, Unique identifier for a conference. Value examples: ['1', '2', '3'].),\n  (homepage:text, The homepage URL for the conference. Value examples: ['www.isa.com', 'www.aaas.com', 'www.icml.com'].),\n  (name:text, The name of the conference. Value examples: ['ISA', 'AAAS', 'ICML'].),\n]\n# Table: domain\n[\n  (did:bigint, Unique identifier for a domain. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the domain. Value examples: ['Data Science', 'Natural Sciences', 'Computer Science'].),\n]\n# Table: domain_author\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1'].),\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['2', '4'].),\n]\n# Table: domain_conference\n[\n  (cid:bigint, Foreign key referencing the cid column in the conference table. Value examples: ['1', '2', '3'].),\n  (did:bigint, Foreign key referencing the did column in the domain table. Value examples: ['2', '4', '5'].),\n]\n# Table: domain_journal\n[\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['1', '2'].),\n  (jid:bigint, Foreign key referencing the journal table's primary key. Value examples: ['2', '3'].),\n]\n# Table: domain_keyword\n[\n  (did:bigint, Foreign key referencing the 'did' column of the 'domain' table. Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the 'kid' column of the 'keyword' table. Value examples: ['2', '3'].),\n]\n# Table: domain_publication\n[\n  (did:bigint, Foreign key referencing the domain table's primary key column (did). Value examples: ['4', '2', '1'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key column (pid). Value examples: ['1', '2', '3'].),\n]\n# Table: journal\n[\n  (homepage:text, The homepage URL for the journal. Value examples: ['www.aijournal.com', 'www.nature.com', 'www.science.com', 'www.ml.com'].),\n  (jid:bigint, Unique identifier for a journal. Value examples: ['1', '2', '3', '4'].),\n  (name:text, The name of the journal. Value examples: ['Journal of Artificial Intelligence Research', 'Nature', 'Science', 'Journal of Machine Learning Research'].),\n]\n# Table: keyword\n[\n  (keyword:text, The actual keyword. Value examples: ['AI', 'Neuroscience', 'Machine Learning', 'Keyword 4'].),\n  (kid:bigint, Unique identifier for a keyword. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: organization\n[\n  (continent:text, Continent where the organization is located. Value examples: ['Asia', 'North America', 'North America'].),\n  (homepage:text, URL of the organization's homepage. Value examples: ['www.organization1.com', 'www.organization2.com', 'www.organization3.com'].),\n  (name:text, Name of the organization. Value examples: ['Organization 1', 'Organization 2', 'Organization 3'].),\n  (oid:bigint, Unique identifier for the organization. Value examples: ['1', '2', '3'].),\n]\n# Table: publication\n[\n  (abstract:text, The abstract of the publication. Value examples: ['Abstract 1', 'Abstract 2'].),\n  (cid:bigint, The ID of the conference where the publication was presented. Value examples: ['1', '2'].),\n  (citation_num:bigint, The number of citations received by the publication. Value examples: ['4', '2'].),\n  (jid:bigint, The ID of the journal where the publication was published. Value examples: ['1', '2'].),\n  (pid:bigint, The unique ID of the publication. Value examples: ['1', '2'].),\n  (reference_num:bigint, The number of references cited by the publication. Value examples: ['0', '1'].),\n  (title:text, The title of the publication. Value examples: ['The Effects of Climate Change on Agriculture', 'A Study on the Effects of Social Media on Mental Health'].),\n  (year:bigint, The year of publication. Value examples: ['2020', '2020'].),\n]\n# Table: publication_keyword\n[\n  (pid:bigint, Foreign key referencing the publication table's primary key (pid). Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the keyword table's primary key (kid). Value examples: ['2', '3'].),\n]\n# Table: writes\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1', '2', '2'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.aid = domain_author.aid\nauthor.oid = organization.oid\nauthor.aid = writes.aid\ncite.cited = publication.pid\nconference.cid = domain_conference.cid\nconference.cid = publication.cid\ndomain.did = domain_author.did\ndomain.did = domain_conference.did\ndomain.did = domain_journal.did\ndomain.did = domain_keyword.did\ndomain_journal.jid = journal.jid\ndomain_keyword.kid = keyword.kid\ndomain_publication.pid = publication.pid\njournal.jid = publication.jid\nkeyword.kid = publication_keyword.kid\npublication.pid = publication_keyword.pid\npublication.pid = writes.pid\n\n【参考信息】\nAlways filter names using ILIKE\n\n【用户问题】\nWhich authors are not part of any organization?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT DISTINCT name, aid FROM author WHERE oid IS NULL",
        "role": "assistant"
      }
    ],
    "db_name": "academic",
    "id": 27,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the publications written by authors from the 'Sociology' domain and presented at conferences in the year 2020?\n\n【数据库schema】\n【DB_ID】 academic\n【Schema】\n# Table: author\n[\n  (aid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3'].),\n  (homepage:text, URL of the author's personal website. Value examples: ['www.larry.com', 'www.ashish.com', 'www.noam.com'].),\n  (name:text, Name of the author. Value examples: ['Larry Summers', 'Ashish Vaswani', 'Noam Shazeer'].),\n  (oid:bigint, Foreign key referencing the organization the author belongs to. Value examples: ['2', '3', '3'].),\n]\n# Table: cite\n[\n  (cited:bigint, ID of the publication being cited. Value examples: ['1', '1', '1'].),\n  (citing:bigint, ID of the publication that is citing another publication. Value examples: ['2', '3', '4'].),\n]\n# Table: conference\n[\n  (cid:bigint, Unique identifier for a conference. Value examples: ['1', '2', '3'].),\n  (homepage:text, The homepage URL for the conference. Value examples: ['www.isa.com', 'www.aaas.com', 'www.icml.com'].),\n  (name:text, The name of the conference. Value examples: ['ISA', 'AAAS', 'ICML'].),\n]\n# Table: domain\n[\n  (did:bigint, Unique identifier for a domain. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the domain. Value examples: ['Data Science', 'Natural Sciences', 'Computer Science'].),\n]\n# Table: domain_author\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1'].),\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['2', '4'].),\n]\n# Table: domain_conference\n[\n  (cid:bigint, Foreign key referencing the cid column in the conference table. Value examples: ['1', '2', '3'].),\n  (did:bigint, Foreign key referencing the did column in the domain table. Value examples: ['2', '4', '5'].),\n]\n# Table: domain_journal\n[\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['1', '2'].),\n  (jid:bigint, Foreign key referencing the journal table's primary key. Value examples: ['2', '3'].),\n]\n# Table: domain_keyword\n[\n  (did:bigint, Foreign key referencing the 'did' column of the 'domain' table. Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the 'kid' column of the 'keyword' table. Value examples: ['2', '3'].),\n]\n# Table: domain_publication\n[\n  (did:bigint, Foreign key referencing the domain table's primary key column (did). Value examples: ['4', '2', '1'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key column (pid). Value examples: ['1', '2', '3'].),\n]\n# Table: journal\n[\n  (homepage:text, The homepage URL for the journal. Value examples: ['www.aijournal.com', 'www.nature.com', 'www.science.com', 'www.ml.com'].),\n  (jid:bigint, Unique identifier for a journal. Value examples: ['1', '2', '3', '4'].),\n  (name:text, The name of the journal. Value examples: ['Journal of Artificial Intelligence Research', 'Nature', 'Science', 'Journal of Machine Learning Research'].),\n]\n# Table: keyword\n[\n  (keyword:text, The actual keyword. Value examples: ['AI', 'Neuroscience', 'Machine Learning', 'Keyword 4'].),\n  (kid:bigint, Unique identifier for a keyword. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: organization\n[\n  (continent:text, Continent where the organization is located. Value examples: ['Asia', 'North America', 'North America'].),\n  (homepage:text, URL of the organization's homepage. Value examples: ['www.organization1.com', 'www.organization2.com', 'www.organization3.com'].),\n  (name:text, Name of the organization. Value examples: ['Organization 1', 'Organization 2', 'Organization 3'].),\n  (oid:bigint, Unique identifier for the organization. Value examples: ['1', '2', '3'].),\n]\n# Table: publication\n[\n  (abstract:text, The abstract of the publication. Value examples: ['Abstract 1', 'Abstract 2'].),\n  (cid:bigint, The ID of the conference where the publication was presented. Value examples: ['1', '2'].),\n  (citation_num:bigint, The number of citations received by the publication. Value examples: ['4', '2'].),\n  (jid:bigint, The ID of the journal where the publication was published. Value examples: ['1', '2'].),\n  (pid:bigint, The unique ID of the publication. Value examples: ['1', '2'].),\n  (reference_num:bigint, The number of references cited by the publication. Value examples: ['0', '1'].),\n  (title:text, The title of the publication. Value examples: ['The Effects of Climate Change on Agriculture', 'A Study on the Effects of Social Media on Mental Health'].),\n  (year:bigint, The year of publication. Value examples: ['2020', '2020'].),\n]\n# Table: publication_keyword\n[\n  (pid:bigint, Foreign key referencing the publication table's primary key (pid). Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the keyword table's primary key (kid). Value examples: ['2', '3'].),\n]\n# Table: writes\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1', '2', '2'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.aid = domain_author.aid\nauthor.oid = organization.oid\nauthor.aid = writes.aid\ncite.cited = publication.pid\nconference.cid = domain_conference.cid\nconference.cid = publication.cid\ndomain.did = domain_author.did\ndomain.did = domain_conference.did\ndomain.did = domain_journal.did\ndomain.did = domain_keyword.did\ndomain_journal.jid = journal.jid\ndomain_keyword.kid = keyword.kid\ndomain_publication.pid = publication.pid\njournal.jid = publication.jid\nkeyword.kid = publication_keyword.kid\npublication.pid = publication_keyword.pid\npublication.pid = writes.pid\n\n【参考信息】\nTo get publications written by authors from a given domain, you would need to join domain, domain_author, author to link the domain to the author first, and then join with write to link with the publication id. Finally, to see which ones were presented at conferences, you must join the domain table with the domain_conference table. You must also filter names using ILIKE.\n\n【用户问题】\nWhat are the publications written by authors from the 'Sociology' domain and presented at conferences in the year 2020?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT DISTINCT publication.title, publication.pid FROM DOMAIN JOIN domain_author ON domain.did = domain_author.did JOIN writes ON domain_author.aid = writes.aid JOIN publication ON writes.pid = publication.pid JOIN domain_conference ON domain.did = domain_conference.did WHERE domain.name ILIKE '%Sociology%' AND publication.year = 2020 AND publication.cid = domain_conference.cid",
        "role": "assistant"
      }
    ],
    "db_name": "academic",
    "id": 28,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the names of the authors who have written publications in the domain \"Computer Science\"?\n\n【数据库schema】\n【DB_ID】 academic\n【Schema】\n# Table: author\n[\n  (aid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3'].),\n  (homepage:text, URL of the author's personal website. Value examples: ['www.larry.com', 'www.ashish.com', 'www.noam.com'].),\n  (name:text, Name of the author. Value examples: ['Larry Summers', 'Ashish Vaswani', 'Noam Shazeer'].),\n  (oid:bigint, Foreign key referencing the organization the author belongs to. Value examples: ['2', '3', '3'].),\n]\n# Table: cite\n[\n  (cited:bigint, ID of the publication being cited. Value examples: ['1', '1', '1'].),\n  (citing:bigint, ID of the publication that is citing another publication. Value examples: ['2', '3', '4'].),\n]\n# Table: conference\n[\n  (cid:bigint, Unique identifier for a conference. Value examples: ['1', '2', '3'].),\n  (homepage:text, The homepage URL for the conference. Value examples: ['www.isa.com', 'www.aaas.com', 'www.icml.com'].),\n  (name:text, The name of the conference. Value examples: ['ISA', 'AAAS', 'ICML'].),\n]\n# Table: domain\n[\n  (did:bigint, Unique identifier for a domain. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the domain. Value examples: ['Data Science', 'Natural Sciences', 'Computer Science'].),\n]\n# Table: domain_author\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1'].),\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['2', '4'].),\n]\n# Table: domain_conference\n[\n  (cid:bigint, Foreign key referencing the cid column in the conference table. Value examples: ['1', '2', '3'].),\n  (did:bigint, Foreign key referencing the did column in the domain table. Value examples: ['2', '4', '5'].),\n]\n# Table: domain_journal\n[\n  (did:bigint, Foreign key referencing the domain table's primary key. Value examples: ['1', '2'].),\n  (jid:bigint, Foreign key referencing the journal table's primary key. Value examples: ['2', '3'].),\n]\n# Table: domain_keyword\n[\n  (did:bigint, Foreign key referencing the 'did' column of the 'domain' table. Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the 'kid' column of the 'keyword' table. Value examples: ['2', '3'].),\n]\n# Table: domain_publication\n[\n  (did:bigint, Foreign key referencing the domain table's primary key column (did). Value examples: ['4', '2', '1'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key column (pid). Value examples: ['1', '2', '3'].),\n]\n# Table: journal\n[\n  (homepage:text, The homepage URL for the journal. Value examples: ['www.aijournal.com', 'www.nature.com', 'www.science.com', 'www.ml.com'].),\n  (jid:bigint, Unique identifier for a journal. Value examples: ['1', '2', '3', '4'].),\n  (name:text, The name of the journal. Value examples: ['Journal of Artificial Intelligence Research', 'Nature', 'Science', 'Journal of Machine Learning Research'].),\n]\n# Table: keyword\n[\n  (keyword:text, The actual keyword. Value examples: ['AI', 'Neuroscience', 'Machine Learning', 'Keyword 4'].),\n  (kid:bigint, Unique identifier for a keyword. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: organization\n[\n  (continent:text, Continent where the organization is located. Value examples: ['Asia', 'North America', 'North America'].),\n  (homepage:text, URL of the organization's homepage. Value examples: ['www.organization1.com', 'www.organization2.com', 'www.organization3.com'].),\n  (name:text, Name of the organization. Value examples: ['Organization 1', 'Organization 2', 'Organization 3'].),\n  (oid:bigint, Unique identifier for the organization. Value examples: ['1', '2', '3'].),\n]\n# Table: publication\n[\n  (abstract:text, The abstract of the publication. Value examples: ['Abstract 1', 'Abstract 2'].),\n  (cid:bigint, The ID of the conference where the publication was presented. Value examples: ['1', '2'].),\n  (citation_num:bigint, The number of citations received by the publication. Value examples: ['4', '2'].),\n  (jid:bigint, The ID of the journal where the publication was published. Value examples: ['1', '2'].),\n  (pid:bigint, The unique ID of the publication. Value examples: ['1', '2'].),\n  (reference_num:bigint, The number of references cited by the publication. Value examples: ['0', '1'].),\n  (title:text, The title of the publication. Value examples: ['The Effects of Climate Change on Agriculture', 'A Study on the Effects of Social Media on Mental Health'].),\n  (year:bigint, The year of publication. Value examples: ['2020', '2020'].),\n]\n# Table: publication_keyword\n[\n  (pid:bigint, Foreign key referencing the publication table's primary key (pid). Value examples: ['1', '2'].),\n  (kid:bigint, Foreign key referencing the keyword table's primary key (kid). Value examples: ['2', '3'].),\n]\n# Table: writes\n[\n  (aid:bigint, Foreign key referencing the author table's primary key. Value examples: ['1', '1', '2', '2'].),\n  (pid:bigint, Foreign key referencing the publication table's primary key. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.aid = domain_author.aid\nauthor.oid = organization.oid\nauthor.aid = writes.aid\ncite.cited = publication.pid\nconference.cid = domain_conference.cid\nconference.cid = publication.cid\ndomain.did = domain_author.did\ndomain.did = domain_conference.did\ndomain.did = domain_journal.did\ndomain.did = domain_keyword.did\ndomain_journal.jid = journal.jid\ndomain_keyword.kid = keyword.kid\ndomain_publication.pid = publication.pid\njournal.jid = publication.jid\nkeyword.kid = publication_keyword.kid\npublication.pid = publication_keyword.pid\npublication.pid = writes.pid\n\n【参考信息】\nTo get publications written by authors from a given domain, you would need to join domain, domain_author, author to link the domain to the author first, and then join with write to link with the publication id. You must also filter names using ILIKE.\n\n【用户问题】\nWhat are the names of the authors who have written publications in the domain \"Computer Science\"?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT DISTINCT author.name FROM author JOIN writes ON author.aid = writes.aid JOIN publication ON writes.pid = publication.pid JOIN domain_publication ON publication.pid = domain_publication.pid JOIN domain ON domain_publication.did = domain.did WHERE domain.name ilike '%computer%science%';",
        "role": "assistant"
      }
    ],
    "db_name": "academic",
    "id": 29,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat month were most students admitted?\n\n【数据库schema】\n【DB_ID】 advising\n【Schema】\n# Table: area\n[\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2'].),\n  (area:text, The area of study for each course. Value examples: ['Computer Science', 'Mathematics'].),\n]\n# Table: comment_instructor\n[\n  (instructor_id:bigint, Unique identifier for the instructor. Value examples: ['1', '2'].),\n  (student_id:bigint, Unique identifier for the student. Value examples: ['1', '2'].),\n  (score:bigint, Score given by the student to the instructor. Value examples: ['5', '4'].),\n  (comment_text:text, Textual comment given by the student about the instructor. Value examples: ['John Smith is a great instructor.', 'Jane Doe explains concepts clearly.'].),\n]\n# Table: course\n[\n  (course_id:bigint, The unique identifier for the course.. Value examples: ['1', '2'].),\n  (name:text, The name of the course.. Value examples: ['Introduction to Computer Science', 'Advanced Calculus'].),\n  (department:text, The department offering the course. Eg 'Mathematics', 'Physics'. Value examples: ['Computer Science', 'Mathematics'].),\n  (number:text, The course number/code.. Value examples: ['CS101', 'MATH201'].),\n  (credits:text, The number of credits awarded for completing the course.. Value examples: ['3', '4'].),\n  (advisory_requirement:text, Any advisory requirements for taking the course.. Value examples: ['NULL', 'CS101'].),\n  (enforced_requirement:text, Any enforced requirements for taking the course.. Value examples: ['NULL', 'NULL'].),\n  (description:text, A brief description of the course content.. Value examples: ['This course introduces the basics of computer science.', 'This course covers advanced topics in calculus.'].),\n  (num_semesters:bigint, The number of semesters the course is offered in a year.. Value examples: ['2', '1'].),\n  (num_enrolled:bigint, The total number of students enrolled in the course.. Value examples: ['2', '3'].),\n  (has_discussion:boolean, Indicates whether the course has any discussion sessions or not.. Value examples: ['true', 'false'].),\n  (has_lab:boolean, Indicates whether the course has any lab sessions or not.. Value examples: ['false', 'false'].),\n  (has_projects:boolean, Indicates whether the course has any projects or not.. Value examples: ['true', 'true'].),\n  (has_exams:boolean, Indicates whether the course has any exams or not.. Value examples: ['false', 'true'].),\n  (num_reviews:bigint, The total number of reviews/ratings for the course.. Value examples: ['10', '5'].),\n  (clarity_score:bigint, The overall clarity score of the course as rated by students.. Value examples: ['5', '4'].),\n  (easiness_score:bigint, The overall easiness score of the course as rated by students.. Value examples: ['3', '2'].),\n  (helpfulness_score:bigint, The overall helpfulness score of the course as rated by students.. Value examples: ['4', '3'].),\n]\n# Table: course_offering\n[\n  (offering_id:bigint, Unique identifier for each course offering. Value examples: ['1', '2', '3'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course is offered. Value examples: ['1', '1', '2'].),\n  (section_number:bigint, The section number of the course. Value examples: ['1', '1', '1'].),\n  (start_time:time, The start time of the course. Value examples: ['08:00:00', '10:00:00', '08:00:00'].),\n  (end_time:time, The end time of the course. Value examples: ['10:00:00', '12:00:00', '10:00:00'].),\n  (monday:text, The instructor's name for Monday. Value examples: ['John Smith', 'NULL', 'John Smith'].),\n  (tuesday:text, The instructor's name for Tuesday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (wednesday:text, The instructor's name for Wednesday. Value examples: ['NULL', 'Gilbert Strang', 'NULL'].),\n  (thursday:text, The instructor's name for Thursday. Value examples: ['Jane Doe', 'NULL', 'Jane Doe'].),\n  (friday:text, The instructor's name for Friday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (saturday:text, The instructor's name for Saturday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (sunday:text, The instructor's name for Sunday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (has_final_project:boolean, Indicates whether the course has a final project. Value examples: ['true', 'true', 'false'].),\n  (has_final_exam:boolean, Indicates whether the course has a final exam. Value examples: ['false', 'true', 'true'].),\n  (textbook:text, The name of the textbook used in the course. Value examples: ['Introduction to Computer Science', 'Advanced Calculus', 'Introduction to Physics'].),\n  (class_address:text, The address of the classroom where the course is held. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (allow_audit:text, Indicates whether auditing the course is allowed. Value examples: ['true', 'false', 'true'].),\n]\n# Table: course_prerequisite\n[\n  (pre_course_id:bigint, The ID of the prerequisite course. Value examples: ['1', '2'].),\n  (course_id:bigint, The ID of the course that has the prerequisite. Value examples: ['2', '3'].),\n]\n# Table: course_tags_count\n[\n  (course_id:bigint, The unique identifier for each course.. Value examples: ['1', '2', '3'].),\n  (clear_grading:bigint, Number of students who found the grading criteria clear and easy to understand.. Value examples: ['5', '4', '3'].),\n  (pop_quiz:bigint, Number of pop quizzes given during the course.. Value examples: ['2', '1', '2'].),\n  (group_projects:bigint, Number of group projects assigned during the course.. Value examples: ['3', '2', '1'].),\n  (inspirational:bigint, Number of students who found the course content inspirational.. Value examples: ['4', '3', '2'].),\n  (long_lectures:bigint, Number of students who found the lectures to be too long.. Value examples: ['2', '1', '3'].),\n  (extra_credit:bigint, Number of extra credit opportunities provided during the course.. Value examples: ['1', '2', '1'].),\n  (few_tests:bigint, Number of tests given during the course.. Value examples: ['3', '2', '1'].),\n  (good_feedback:bigint, Number of students who received good feedback from the instructor.. Value examples: ['4', '3', '2'].),\n  (tough_tests:bigint, Number of students who found the tests to be tough.. Value examples: ['2', '1', '3'].),\n  (heavy_papers:bigint, Number of papers assigned during the course.. Value examples: ['1', '2', '1'].),\n  (cares_for_students:bigint, Number of students who felt that the instructor cared for their well-being.. Value examples: ['5', '4', '3'].),\n  (heavy_assignments:bigint, Number of assignments given during the course.. Value examples: ['3', '2', '1'].),\n  (respected:bigint, Number of students who respected the instructor.. Value examples: ['4', '3', '2'].),\n  (participation:bigint, Number of students who participated actively in the course.. Value examples: ['2', '1', '3'].),\n  (heavy_reading:bigint, Number of reading assignments given during the course.. Value examples: ['1', '2', '1'].),\n  (tough_grader:bigint, Number of students who found the instructor to be a tough grader.. Value examples: ['5', '4', '3'].),\n  (hilarious:bigint, Number of students who found the instructor to be hilarious.. Value examples: ['3', '2', '1'].),\n  (would_take_again:bigint, Number of students who would take the course again.. Value examples: ['4', '3', '2'].),\n  (good_lecture:bigint, Number of students who found the lectures to be good.. Value examples: ['2', '1', '3'].),\n  (no_skip:bigint, Number of students who did not skip any classes during the course.. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: instructor\n[\n  (instructor_id:bigint, Unique identifier for each instructor. Value examples: ['1', '2'].),\n  (name:text, Name of the instructor. Value examples: ['John Smith', 'Jane Doe'].),\n  (uniqname:text, Unique name of the instructor used for login and identification purposes. Value examples: ['jsmith', 'jdoe'].),\n]\n# Table: offering_instructor\n[\n  (offering_instructor_id:bigint, Unique identifier for each offering-instructor pair. Value examples: ['1', '2', '3'].),\n  (offering_id:bigint, Foreign key referencing the offering table. Value examples: ['1', '1', '2'].),\n  (instructor_id:bigint, Foreign key referencing the instructor table. Value examples: ['1', '2', '3'].),\n]\n# Table: program\n[\n  (program_id:bigint, Unique identifier for each program. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the program, Eg 'Computer Science', 'Physics'. Value examples: ['Computer Science', 'Mathematics', 'Physics'].),\n  (college:text, Name of the college offering the program. Value examples: ['Engineering', 'Arts and Sciences', 'Arts and Sciences'].),\n  (introduction:text, Introduction to the program. Value examples: ['This program focuses on computer science principles and applications.', 'This program provides a comprehensive study of mathematical concepts and theories.', 'This program explores the fundamental principles of physics and their applications.'].),\n]\n# Table: program_course\n[\n  (program_id:bigint, The ID of the program associated with the course. Value examples: ['1', '1'].),\n  (course_id:bigint, The ID of the course. Value examples: ['1', '4'].),\n  (workload:bigint, The workload of the course in hours. Value examples: ['100', '80'].),\n  (category:text, The category of the course. Can only be 'Core' or 'Elective'.. Value examples: ['Core', 'Elective'].),\n]\n# Table: program_requirement\n[\n  (program_id:bigint, Unique identifier for a program. Value examples: ['1', '2', '3'].),\n  (category:text, Category of the program. Value examples: ['Core', 'Core', 'Core'].),\n  (min_credit:bigint, Minimum number of credits required for the program. Value examples: ['120', '90', '200'].),\n  (additional_req:text, Additional requirements for the program, if any. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: semester\n[\n  (semester_id:bigint, Unique identifier for each semester. Sort by this column to get the right year-semester order.. Value examples: ['1', '2', '3', '4'].),\n  (semester:text, The name or identifier for the semester Can only be 'Fall', 'Spring', or 'Summer'. Value examples: ['Fall', 'Spring', 'Summer', 'Fall'].),\n  (year:bigint, The year in which the semester takes place. Value examples: ['2020', '2021', '2021', '2021'].),\n]\n# Table: student\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '2', '3'].),\n  (lastname:text, Last name of the student. Value examples: ['Smith', 'Doe', 'Johnson'].),\n  (firstname:text, First name of the student. Value examples: ['John', 'Jane', 'David'].),\n  (program_id:bigint, Identifier for the program the student is enrolled in. Value examples: ['1', '1', '2'].),\n  (declare_major:text, Major program the student declared. Value examples: ['Computer Science', 'Computer Science', 'Mathematics'].),\n  (total_credit:bigint, Total number of credits earned by the student. Value examples: ['13', '7', '7'].),\n  (total_gpa:numeric, Cumulative GPA of the student. Value examples: ['3.5', '3.2', '3.6'].),\n  (entered_as:text, Status of the student when they entered the program. e.g. 'Freshman', 'Transfer Student'. Value examples: ['Freshman', 'Freshman', 'Freshman'].),\n  (admit_term:date, Term in which the student was admitted. Format is YYYY-MM-DD. Value examples: ['2018-01-01', '2018-01-01', '2019-01-01'].),\n  (predicted_graduation_semester:date, Semester in which the student is predicted to graduate. Format is YYYY-MM-DD. Value examples: ['2022-05-01', '2022-05-01', '2022-05-01'].),\n  (degree:text, Degree program the student is enrolled in. Can only be 'Bachelor of Science' or 'Bachelor of Arts'.. Value examples: ['Bachelor of Science', 'Bachelor of Science', 'Bachelor of Arts'].),\n  (minor:text, Minor program the student is enrolled in. Value examples: ['NULL', 'NULL', 'Mathematics'].),\n  (internship:text, Internship program the student is enrolled in. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: student_record\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '1', '1'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course was taken. Value examples: ['1', '1', '2'].),\n  (grade:text, The grade received for the course. Value examples: ['A', 'A', 'A'].),\n  (how:text, How the student took the course. Can only be 'in-person' or 'online'.. Value examples: ['in-person', 'in-person', 'in-person'].),\n  (transfer_source:text, If the course was transferred from another institution, the name of that institution. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (earn_credit:text, Whether the student earned credit for the course (e.g. Yes, No). Value examples: ['Yes', 'Yes', 'Yes'].),\n  (repeat_term:text, If the student repeated the course, the semester in which it was repeated. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (test_id:text, Unique identifier for each test taken in the course. Value examples: ['1', '1', '1'].),\n  (offering_id:bigint, Unique identifier for each offering of a course. Value examples: ['1', '2', '3'].),\n]\n\n【Foreign keys】\narea.course_id = course.course_id\ncomment_instructor.instructor_id = instructor.instructor_id\ncomment_instructor.student_id = student.student_id\ncourse.course_id = course_offering.course_id\ncourse.course_id = course_prerequisite.course_id\ncourse.course_id = course_tags_count.course_id\ncourse.course_id = program_course.course_id\ncourse.course_id = student_record.course_id\ncourse_offering.offering_id = offering_instructor.offering_id\ncourse_offering.offering_id = student_record.offering_id\ninstructor.instructor_id = offering_instructor.instructor_id\nprogram.program_id = program_course.program_id\nprogram.program_id = program_requirement.program_id\nprogram.program_id = student.program_id\nstudent.student_id = student_record.student_id\n\n【参考信息】\n\n\n【用户问题】\nWhat month were most students admitted?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT date_trunc('month', s.admit_term) AS month, COUNT(*) AS total_students FROM student s GROUP BY MONTH ORDER BY total_students DESC LIMIT 1;",
        "role": "assistant"
      }
    ],
    "db_name": "advising",
    "id": 30,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat's the average predicted time to graduation since admission in no. of days?\n\n【数据库schema】\n【DB_ID】 advising\n【Schema】\n# Table: area\n[\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2'].),\n  (area:text, The area of study for each course. Value examples: ['Computer Science', 'Mathematics'].),\n]\n# Table: comment_instructor\n[\n  (instructor_id:bigint, Unique identifier for the instructor. Value examples: ['1', '2'].),\n  (student_id:bigint, Unique identifier for the student. Value examples: ['1', '2'].),\n  (score:bigint, Score given by the student to the instructor. Value examples: ['5', '4'].),\n  (comment_text:text, Textual comment given by the student about the instructor. Value examples: ['John Smith is a great instructor.', 'Jane Doe explains concepts clearly.'].),\n]\n# Table: course\n[\n  (course_id:bigint, The unique identifier for the course.. Value examples: ['1', '2'].),\n  (name:text, The name of the course.. Value examples: ['Introduction to Computer Science', 'Advanced Calculus'].),\n  (department:text, The department offering the course. Eg 'Mathematics', 'Physics'. Value examples: ['Computer Science', 'Mathematics'].),\n  (number:text, The course number/code.. Value examples: ['CS101', 'MATH201'].),\n  (credits:text, The number of credits awarded for completing the course.. Value examples: ['3', '4'].),\n  (advisory_requirement:text, Any advisory requirements for taking the course.. Value examples: ['NULL', 'CS101'].),\n  (enforced_requirement:text, Any enforced requirements for taking the course.. Value examples: ['NULL', 'NULL'].),\n  (description:text, A brief description of the course content.. Value examples: ['This course introduces the basics of computer science.', 'This course covers advanced topics in calculus.'].),\n  (num_semesters:bigint, The number of semesters the course is offered in a year.. Value examples: ['2', '1'].),\n  (num_enrolled:bigint, The total number of students enrolled in the course.. Value examples: ['2', '3'].),\n  (has_discussion:boolean, Indicates whether the course has any discussion sessions or not.. Value examples: ['true', 'false'].),\n  (has_lab:boolean, Indicates whether the course has any lab sessions or not.. Value examples: ['false', 'false'].),\n  (has_projects:boolean, Indicates whether the course has any projects or not.. Value examples: ['true', 'true'].),\n  (has_exams:boolean, Indicates whether the course has any exams or not.. Value examples: ['false', 'true'].),\n  (num_reviews:bigint, The total number of reviews/ratings for the course.. Value examples: ['10', '5'].),\n  (clarity_score:bigint, The overall clarity score of the course as rated by students.. Value examples: ['5', '4'].),\n  (easiness_score:bigint, The overall easiness score of the course as rated by students.. Value examples: ['3', '2'].),\n  (helpfulness_score:bigint, The overall helpfulness score of the course as rated by students.. Value examples: ['4', '3'].),\n]\n# Table: course_offering\n[\n  (offering_id:bigint, Unique identifier for each course offering. Value examples: ['1', '2', '3'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course is offered. Value examples: ['1', '1', '2'].),\n  (section_number:bigint, The section number of the course. Value examples: ['1', '1', '1'].),\n  (start_time:time, The start time of the course. Value examples: ['08:00:00', '10:00:00', '08:00:00'].),\n  (end_time:time, The end time of the course. Value examples: ['10:00:00', '12:00:00', '10:00:00'].),\n  (monday:text, The instructor's name for Monday. Value examples: ['John Smith', 'NULL', 'John Smith'].),\n  (tuesday:text, The instructor's name for Tuesday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (wednesday:text, The instructor's name for Wednesday. Value examples: ['NULL', 'Gilbert Strang', 'NULL'].),\n  (thursday:text, The instructor's name for Thursday. Value examples: ['Jane Doe', 'NULL', 'Jane Doe'].),\n  (friday:text, The instructor's name for Friday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (saturday:text, The instructor's name for Saturday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (sunday:text, The instructor's name for Sunday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (has_final_project:boolean, Indicates whether the course has a final project. Value examples: ['true', 'true', 'false'].),\n  (has_final_exam:boolean, Indicates whether the course has a final exam. Value examples: ['false', 'true', 'true'].),\n  (textbook:text, The name of the textbook used in the course. Value examples: ['Introduction to Computer Science', 'Advanced Calculus', 'Introduction to Physics'].),\n  (class_address:text, The address of the classroom where the course is held. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (allow_audit:text, Indicates whether auditing the course is allowed. Value examples: ['true', 'false', 'true'].),\n]\n# Table: course_prerequisite\n[\n  (pre_course_id:bigint, The ID of the prerequisite course. Value examples: ['1', '2'].),\n  (course_id:bigint, The ID of the course that has the prerequisite. Value examples: ['2', '3'].),\n]\n# Table: course_tags_count\n[\n  (course_id:bigint, The unique identifier for each course.. Value examples: ['1', '2', '3'].),\n  (clear_grading:bigint, Number of students who found the grading criteria clear and easy to understand.. Value examples: ['5', '4', '3'].),\n  (pop_quiz:bigint, Number of pop quizzes given during the course.. Value examples: ['2', '1', '2'].),\n  (group_projects:bigint, Number of group projects assigned during the course.. Value examples: ['3', '2', '1'].),\n  (inspirational:bigint, Number of students who found the course content inspirational.. Value examples: ['4', '3', '2'].),\n  (long_lectures:bigint, Number of students who found the lectures to be too long.. Value examples: ['2', '1', '3'].),\n  (extra_credit:bigint, Number of extra credit opportunities provided during the course.. Value examples: ['1', '2', '1'].),\n  (few_tests:bigint, Number of tests given during the course.. Value examples: ['3', '2', '1'].),\n  (good_feedback:bigint, Number of students who received good feedback from the instructor.. Value examples: ['4', '3', '2'].),\n  (tough_tests:bigint, Number of students who found the tests to be tough.. Value examples: ['2', '1', '3'].),\n  (heavy_papers:bigint, Number of papers assigned during the course.. Value examples: ['1', '2', '1'].),\n  (cares_for_students:bigint, Number of students who felt that the instructor cared for their well-being.. Value examples: ['5', '4', '3'].),\n  (heavy_assignments:bigint, Number of assignments given during the course.. Value examples: ['3', '2', '1'].),\n  (respected:bigint, Number of students who respected the instructor.. Value examples: ['4', '3', '2'].),\n  (participation:bigint, Number of students who participated actively in the course.. Value examples: ['2', '1', '3'].),\n  (heavy_reading:bigint, Number of reading assignments given during the course.. Value examples: ['1', '2', '1'].),\n  (tough_grader:bigint, Number of students who found the instructor to be a tough grader.. Value examples: ['5', '4', '3'].),\n  (hilarious:bigint, Number of students who found the instructor to be hilarious.. Value examples: ['3', '2', '1'].),\n  (would_take_again:bigint, Number of students who would take the course again.. Value examples: ['4', '3', '2'].),\n  (good_lecture:bigint, Number of students who found the lectures to be good.. Value examples: ['2', '1', '3'].),\n  (no_skip:bigint, Number of students who did not skip any classes during the course.. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: instructor\n[\n  (instructor_id:bigint, Unique identifier for each instructor. Value examples: ['1', '2'].),\n  (name:text, Name of the instructor. Value examples: ['John Smith', 'Jane Doe'].),\n  (uniqname:text, Unique name of the instructor used for login and identification purposes. Value examples: ['jsmith', 'jdoe'].),\n]\n# Table: offering_instructor\n[\n  (offering_instructor_id:bigint, Unique identifier for each offering-instructor pair. Value examples: ['1', '2', '3'].),\n  (offering_id:bigint, Foreign key referencing the offering table. Value examples: ['1', '1', '2'].),\n  (instructor_id:bigint, Foreign key referencing the instructor table. Value examples: ['1', '2', '3'].),\n]\n# Table: program\n[\n  (program_id:bigint, Unique identifier for each program. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the program, Eg 'Computer Science', 'Physics'. Value examples: ['Computer Science', 'Mathematics', 'Physics'].),\n  (college:text, Name of the college offering the program. Value examples: ['Engineering', 'Arts and Sciences', 'Arts and Sciences'].),\n  (introduction:text, Introduction to the program. Value examples: ['This program focuses on computer science principles and applications.', 'This program provides a comprehensive study of mathematical concepts and theories.', 'This program explores the fundamental principles of physics and their applications.'].),\n]\n# Table: program_course\n[\n  (program_id:bigint, The ID of the program associated with the course. Value examples: ['1', '1'].),\n  (course_id:bigint, The ID of the course. Value examples: ['1', '4'].),\n  (workload:bigint, The workload of the course in hours. Value examples: ['100', '80'].),\n  (category:text, The category of the course. Can only be 'Core' or 'Elective'.. Value examples: ['Core', 'Elective'].),\n]\n# Table: program_requirement\n[\n  (program_id:bigint, Unique identifier for a program. Value examples: ['1', '2', '3'].),\n  (category:text, Category of the program. Value examples: ['Core', 'Core', 'Core'].),\n  (min_credit:bigint, Minimum number of credits required for the program. Value examples: ['120', '90', '200'].),\n  (additional_req:text, Additional requirements for the program, if any. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: semester\n[\n  (semester_id:bigint, Unique identifier for each semester. Sort by this column to get the right year-semester order.. Value examples: ['1', '2', '3', '4'].),\n  (semester:text, The name or identifier for the semester Can only be 'Fall', 'Spring', or 'Summer'. Value examples: ['Fall', 'Spring', 'Summer', 'Fall'].),\n  (year:bigint, The year in which the semester takes place. Value examples: ['2020', '2021', '2021', '2021'].),\n]\n# Table: student\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '2', '3'].),\n  (lastname:text, Last name of the student. Value examples: ['Smith', 'Doe', 'Johnson'].),\n  (firstname:text, First name of the student. Value examples: ['John', 'Jane', 'David'].),\n  (program_id:bigint, Identifier for the program the student is enrolled in. Value examples: ['1', '1', '2'].),\n  (declare_major:text, Major program the student declared. Value examples: ['Computer Science', 'Computer Science', 'Mathematics'].),\n  (total_credit:bigint, Total number of credits earned by the student. Value examples: ['13', '7', '7'].),\n  (total_gpa:numeric, Cumulative GPA of the student. Value examples: ['3.5', '3.2', '3.6'].),\n  (entered_as:text, Status of the student when they entered the program. e.g. 'Freshman', 'Transfer Student'. Value examples: ['Freshman', 'Freshman', 'Freshman'].),\n  (admit_term:date, Term in which the student was admitted. Format is YYYY-MM-DD. Value examples: ['2018-01-01', '2018-01-01', '2019-01-01'].),\n  (predicted_graduation_semester:date, Semester in which the student is predicted to graduate. Format is YYYY-MM-DD. Value examples: ['2022-05-01', '2022-05-01', '2022-05-01'].),\n  (degree:text, Degree program the student is enrolled in. Can only be 'Bachelor of Science' or 'Bachelor of Arts'.. Value examples: ['Bachelor of Science', 'Bachelor of Science', 'Bachelor of Arts'].),\n  (minor:text, Minor program the student is enrolled in. Value examples: ['NULL', 'NULL', 'Mathematics'].),\n  (internship:text, Internship program the student is enrolled in. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: student_record\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '1', '1'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course was taken. Value examples: ['1', '1', '2'].),\n  (grade:text, The grade received for the course. Value examples: ['A', 'A', 'A'].),\n  (how:text, How the student took the course. Can only be 'in-person' or 'online'.. Value examples: ['in-person', 'in-person', 'in-person'].),\n  (transfer_source:text, If the course was transferred from another institution, the name of that institution. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (earn_credit:text, Whether the student earned credit for the course (e.g. Yes, No). Value examples: ['Yes', 'Yes', 'Yes'].),\n  (repeat_term:text, If the student repeated the course, the semester in which it was repeated. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (test_id:text, Unique identifier for each test taken in the course. Value examples: ['1', '1', '1'].),\n  (offering_id:bigint, Unique identifier for each offering of a course. Value examples: ['1', '2', '3'].),\n]\n\n【Foreign keys】\narea.course_id = course.course_id\ncomment_instructor.instructor_id = instructor.instructor_id\ncomment_instructor.student_id = student.student_id\ncourse.course_id = course_offering.course_id\ncourse.course_id = course_prerequisite.course_id\ncourse.course_id = course_tags_count.course_id\ncourse.course_id = program_course.course_id\ncourse.course_id = student_record.course_id\ncourse_offering.offering_id = offering_instructor.offering_id\ncourse_offering.offering_id = student_record.offering_id\ninstructor.instructor_id = offering_instructor.instructor_id\nprogram.program_id = program_course.program_id\nprogram.program_id = program_requirement.program_id\nprogram.program_id = student.program_id\nstudent.student_id = student_record.student_id\n\n【参考信息】\n\n\n【用户问题】\nWhat's the average predicted time to graduation since admission in no. of days?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT avg(predicted_graduation_semester - admit_term) AS average_predicted_time_to_graduation FROM student;",
        "role": "assistant"
      }
    ],
    "db_name": "advising",
    "id": 31,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many students were predicted to graduate in the last 10 years?\n\n【数据库schema】\n【DB_ID】 advising\n【Schema】\n# Table: area\n[\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2'].),\n  (area:text, The area of study for each course. Value examples: ['Computer Science', 'Mathematics'].),\n]\n# Table: comment_instructor\n[\n  (instructor_id:bigint, Unique identifier for the instructor. Value examples: ['1', '2'].),\n  (student_id:bigint, Unique identifier for the student. Value examples: ['1', '2'].),\n  (score:bigint, Score given by the student to the instructor. Value examples: ['5', '4'].),\n  (comment_text:text, Textual comment given by the student about the instructor. Value examples: ['John Smith is a great instructor.', 'Jane Doe explains concepts clearly.'].),\n]\n# Table: course\n[\n  (course_id:bigint, The unique identifier for the course.. Value examples: ['1', '2'].),\n  (name:text, The name of the course.. Value examples: ['Introduction to Computer Science', 'Advanced Calculus'].),\n  (department:text, The department offering the course. Eg 'Mathematics', 'Physics'. Value examples: ['Computer Science', 'Mathematics'].),\n  (number:text, The course number/code.. Value examples: ['CS101', 'MATH201'].),\n  (credits:text, The number of credits awarded for completing the course.. Value examples: ['3', '4'].),\n  (advisory_requirement:text, Any advisory requirements for taking the course.. Value examples: ['NULL', 'CS101'].),\n  (enforced_requirement:text, Any enforced requirements for taking the course.. Value examples: ['NULL', 'NULL'].),\n  (description:text, A brief description of the course content.. Value examples: ['This course introduces the basics of computer science.', 'This course covers advanced topics in calculus.'].),\n  (num_semesters:bigint, The number of semesters the course is offered in a year.. Value examples: ['2', '1'].),\n  (num_enrolled:bigint, The total number of students enrolled in the course.. Value examples: ['2', '3'].),\n  (has_discussion:boolean, Indicates whether the course has any discussion sessions or not.. Value examples: ['true', 'false'].),\n  (has_lab:boolean, Indicates whether the course has any lab sessions or not.. Value examples: ['false', 'false'].),\n  (has_projects:boolean, Indicates whether the course has any projects or not.. Value examples: ['true', 'true'].),\n  (has_exams:boolean, Indicates whether the course has any exams or not.. Value examples: ['false', 'true'].),\n  (num_reviews:bigint, The total number of reviews/ratings for the course.. Value examples: ['10', '5'].),\n  (clarity_score:bigint, The overall clarity score of the course as rated by students.. Value examples: ['5', '4'].),\n  (easiness_score:bigint, The overall easiness score of the course as rated by students.. Value examples: ['3', '2'].),\n  (helpfulness_score:bigint, The overall helpfulness score of the course as rated by students.. Value examples: ['4', '3'].),\n]\n# Table: course_offering\n[\n  (offering_id:bigint, Unique identifier for each course offering. Value examples: ['1', '2', '3'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course is offered. Value examples: ['1', '1', '2'].),\n  (section_number:bigint, The section number of the course. Value examples: ['1', '1', '1'].),\n  (start_time:time, The start time of the course. Value examples: ['08:00:00', '10:00:00', '08:00:00'].),\n  (end_time:time, The end time of the course. Value examples: ['10:00:00', '12:00:00', '10:00:00'].),\n  (monday:text, The instructor's name for Monday. Value examples: ['John Smith', 'NULL', 'John Smith'].),\n  (tuesday:text, The instructor's name for Tuesday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (wednesday:text, The instructor's name for Wednesday. Value examples: ['NULL', 'Gilbert Strang', 'NULL'].),\n  (thursday:text, The instructor's name for Thursday. Value examples: ['Jane Doe', 'NULL', 'Jane Doe'].),\n  (friday:text, The instructor's name for Friday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (saturday:text, The instructor's name for Saturday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (sunday:text, The instructor's name for Sunday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (has_final_project:boolean, Indicates whether the course has a final project. Value examples: ['true', 'true', 'false'].),\n  (has_final_exam:boolean, Indicates whether the course has a final exam. Value examples: ['false', 'true', 'true'].),\n  (textbook:text, The name of the textbook used in the course. Value examples: ['Introduction to Computer Science', 'Advanced Calculus', 'Introduction to Physics'].),\n  (class_address:text, The address of the classroom where the course is held. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (allow_audit:text, Indicates whether auditing the course is allowed. Value examples: ['true', 'false', 'true'].),\n]\n# Table: course_prerequisite\n[\n  (pre_course_id:bigint, The ID of the prerequisite course. Value examples: ['1', '2'].),\n  (course_id:bigint, The ID of the course that has the prerequisite. Value examples: ['2', '3'].),\n]\n# Table: course_tags_count\n[\n  (course_id:bigint, The unique identifier for each course.. Value examples: ['1', '2', '3'].),\n  (clear_grading:bigint, Number of students who found the grading criteria clear and easy to understand.. Value examples: ['5', '4', '3'].),\n  (pop_quiz:bigint, Number of pop quizzes given during the course.. Value examples: ['2', '1', '2'].),\n  (group_projects:bigint, Number of group projects assigned during the course.. Value examples: ['3', '2', '1'].),\n  (inspirational:bigint, Number of students who found the course content inspirational.. Value examples: ['4', '3', '2'].),\n  (long_lectures:bigint, Number of students who found the lectures to be too long.. Value examples: ['2', '1', '3'].),\n  (extra_credit:bigint, Number of extra credit opportunities provided during the course.. Value examples: ['1', '2', '1'].),\n  (few_tests:bigint, Number of tests given during the course.. Value examples: ['3', '2', '1'].),\n  (good_feedback:bigint, Number of students who received good feedback from the instructor.. Value examples: ['4', '3', '2'].),\n  (tough_tests:bigint, Number of students who found the tests to be tough.. Value examples: ['2', '1', '3'].),\n  (heavy_papers:bigint, Number of papers assigned during the course.. Value examples: ['1', '2', '1'].),\n  (cares_for_students:bigint, Number of students who felt that the instructor cared for their well-being.. Value examples: ['5', '4', '3'].),\n  (heavy_assignments:bigint, Number of assignments given during the course.. Value examples: ['3', '2', '1'].),\n  (respected:bigint, Number of students who respected the instructor.. Value examples: ['4', '3', '2'].),\n  (participation:bigint, Number of students who participated actively in the course.. Value examples: ['2', '1', '3'].),\n  (heavy_reading:bigint, Number of reading assignments given during the course.. Value examples: ['1', '2', '1'].),\n  (tough_grader:bigint, Number of students who found the instructor to be a tough grader.. Value examples: ['5', '4', '3'].),\n  (hilarious:bigint, Number of students who found the instructor to be hilarious.. Value examples: ['3', '2', '1'].),\n  (would_take_again:bigint, Number of students who would take the course again.. Value examples: ['4', '3', '2'].),\n  (good_lecture:bigint, Number of students who found the lectures to be good.. Value examples: ['2', '1', '3'].),\n  (no_skip:bigint, Number of students who did not skip any classes during the course.. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: instructor\n[\n  (instructor_id:bigint, Unique identifier for each instructor. Value examples: ['1', '2'].),\n  (name:text, Name of the instructor. Value examples: ['John Smith', 'Jane Doe'].),\n  (uniqname:text, Unique name of the instructor used for login and identification purposes. Value examples: ['jsmith', 'jdoe'].),\n]\n# Table: offering_instructor\n[\n  (offering_instructor_id:bigint, Unique identifier for each offering-instructor pair. Value examples: ['1', '2', '3'].),\n  (offering_id:bigint, Foreign key referencing the offering table. Value examples: ['1', '1', '2'].),\n  (instructor_id:bigint, Foreign key referencing the instructor table. Value examples: ['1', '2', '3'].),\n]\n# Table: program\n[\n  (program_id:bigint, Unique identifier for each program. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the program, Eg 'Computer Science', 'Physics'. Value examples: ['Computer Science', 'Mathematics', 'Physics'].),\n  (college:text, Name of the college offering the program. Value examples: ['Engineering', 'Arts and Sciences', 'Arts and Sciences'].),\n  (introduction:text, Introduction to the program. Value examples: ['This program focuses on computer science principles and applications.', 'This program provides a comprehensive study of mathematical concepts and theories.', 'This program explores the fundamental principles of physics and their applications.'].),\n]\n# Table: program_course\n[\n  (program_id:bigint, The ID of the program associated with the course. Value examples: ['1', '1'].),\n  (course_id:bigint, The ID of the course. Value examples: ['1', '4'].),\n  (workload:bigint, The workload of the course in hours. Value examples: ['100', '80'].),\n  (category:text, The category of the course. Can only be 'Core' or 'Elective'.. Value examples: ['Core', 'Elective'].),\n]\n# Table: program_requirement\n[\n  (program_id:bigint, Unique identifier for a program. Value examples: ['1', '2', '3'].),\n  (category:text, Category of the program. Value examples: ['Core', 'Core', 'Core'].),\n  (min_credit:bigint, Minimum number of credits required for the program. Value examples: ['120', '90', '200'].),\n  (additional_req:text, Additional requirements for the program, if any. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: semester\n[\n  (semester_id:bigint, Unique identifier for each semester. Sort by this column to get the right year-semester order.. Value examples: ['1', '2', '3', '4'].),\n  (semester:text, The name or identifier for the semester Can only be 'Fall', 'Spring', or 'Summer'. Value examples: ['Fall', 'Spring', 'Summer', 'Fall'].),\n  (year:bigint, The year in which the semester takes place. Value examples: ['2020', '2021', '2021', '2021'].),\n]\n# Table: student\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '2', '3'].),\n  (lastname:text, Last name of the student. Value examples: ['Smith', 'Doe', 'Johnson'].),\n  (firstname:text, First name of the student. Value examples: ['John', 'Jane', 'David'].),\n  (program_id:bigint, Identifier for the program the student is enrolled in. Value examples: ['1', '1', '2'].),\n  (declare_major:text, Major program the student declared. Value examples: ['Computer Science', 'Computer Science', 'Mathematics'].),\n  (total_credit:bigint, Total number of credits earned by the student. Value examples: ['13', '7', '7'].),\n  (total_gpa:numeric, Cumulative GPA of the student. Value examples: ['3.5', '3.2', '3.6'].),\n  (entered_as:text, Status of the student when they entered the program. e.g. 'Freshman', 'Transfer Student'. Value examples: ['Freshman', 'Freshman', 'Freshman'].),\n  (admit_term:date, Term in which the student was admitted. Format is YYYY-MM-DD. Value examples: ['2018-01-01', '2018-01-01', '2019-01-01'].),\n  (predicted_graduation_semester:date, Semester in which the student is predicted to graduate. Format is YYYY-MM-DD. Value examples: ['2022-05-01', '2022-05-01', '2022-05-01'].),\n  (degree:text, Degree program the student is enrolled in. Can only be 'Bachelor of Science' or 'Bachelor of Arts'.. Value examples: ['Bachelor of Science', 'Bachelor of Science', 'Bachelor of Arts'].),\n  (minor:text, Minor program the student is enrolled in. Value examples: ['NULL', 'NULL', 'Mathematics'].),\n  (internship:text, Internship program the student is enrolled in. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: student_record\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '1', '1'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course was taken. Value examples: ['1', '1', '2'].),\n  (grade:text, The grade received for the course. Value examples: ['A', 'A', 'A'].),\n  (how:text, How the student took the course. Can only be 'in-person' or 'online'.. Value examples: ['in-person', 'in-person', 'in-person'].),\n  (transfer_source:text, If the course was transferred from another institution, the name of that institution. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (earn_credit:text, Whether the student earned credit for the course (e.g. Yes, No). Value examples: ['Yes', 'Yes', 'Yes'].),\n  (repeat_term:text, If the student repeated the course, the semester in which it was repeated. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (test_id:text, Unique identifier for each test taken in the course. Value examples: ['1', '1', '1'].),\n  (offering_id:bigint, Unique identifier for each offering of a course. Value examples: ['1', '2', '3'].),\n]\n\n【Foreign keys】\narea.course_id = course.course_id\ncomment_instructor.instructor_id = instructor.instructor_id\ncomment_instructor.student_id = student.student_id\ncourse.course_id = course_offering.course_id\ncourse.course_id = course_prerequisite.course_id\ncourse.course_id = course_tags_count.course_id\ncourse.course_id = program_course.course_id\ncourse.course_id = student_record.course_id\ncourse_offering.offering_id = offering_instructor.offering_id\ncourse_offering.offering_id = student_record.offering_id\ninstructor.instructor_id = offering_instructor.instructor_id\nprogram.program_id = program_course.program_id\nprogram.program_id = program_requirement.program_id\nprogram.program_id = student.program_id\nstudent.student_id = student_record.student_id\n\n【参考信息】\n\n\n【用户问题】\nHow many students were predicted to graduate in the last 10 years?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT count(*) AS num_students_graduated FROM student WHERE predicted_graduation_semester >= DATE_TRUNC('year', CURRENT_DATE) - interval '10 year';",
        "role": "assistant"
      }
    ],
    "db_name": "advising",
    "id": 32,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow long has it been in days since the last admitted student?\n\n【数据库schema】\n【DB_ID】 advising\n【Schema】\n# Table: area\n[\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2'].),\n  (area:text, The area of study for each course. Value examples: ['Computer Science', 'Mathematics'].),\n]\n# Table: comment_instructor\n[\n  (instructor_id:bigint, Unique identifier for the instructor. Value examples: ['1', '2'].),\n  (student_id:bigint, Unique identifier for the student. Value examples: ['1', '2'].),\n  (score:bigint, Score given by the student to the instructor. Value examples: ['5', '4'].),\n  (comment_text:text, Textual comment given by the student about the instructor. Value examples: ['John Smith is a great instructor.', 'Jane Doe explains concepts clearly.'].),\n]\n# Table: course\n[\n  (course_id:bigint, The unique identifier for the course.. Value examples: ['1', '2'].),\n  (name:text, The name of the course.. Value examples: ['Introduction to Computer Science', 'Advanced Calculus'].),\n  (department:text, The department offering the course. Eg 'Mathematics', 'Physics'. Value examples: ['Computer Science', 'Mathematics'].),\n  (number:text, The course number/code.. Value examples: ['CS101', 'MATH201'].),\n  (credits:text, The number of credits awarded for completing the course.. Value examples: ['3', '4'].),\n  (advisory_requirement:text, Any advisory requirements for taking the course.. Value examples: ['NULL', 'CS101'].),\n  (enforced_requirement:text, Any enforced requirements for taking the course.. Value examples: ['NULL', 'NULL'].),\n  (description:text, A brief description of the course content.. Value examples: ['This course introduces the basics of computer science.', 'This course covers advanced topics in calculus.'].),\n  (num_semesters:bigint, The number of semesters the course is offered in a year.. Value examples: ['2', '1'].),\n  (num_enrolled:bigint, The total number of students enrolled in the course.. Value examples: ['2', '3'].),\n  (has_discussion:boolean, Indicates whether the course has any discussion sessions or not.. Value examples: ['true', 'false'].),\n  (has_lab:boolean, Indicates whether the course has any lab sessions or not.. Value examples: ['false', 'false'].),\n  (has_projects:boolean, Indicates whether the course has any projects or not.. Value examples: ['true', 'true'].),\n  (has_exams:boolean, Indicates whether the course has any exams or not.. Value examples: ['false', 'true'].),\n  (num_reviews:bigint, The total number of reviews/ratings for the course.. Value examples: ['10', '5'].),\n  (clarity_score:bigint, The overall clarity score of the course as rated by students.. Value examples: ['5', '4'].),\n  (easiness_score:bigint, The overall easiness score of the course as rated by students.. Value examples: ['3', '2'].),\n  (helpfulness_score:bigint, The overall helpfulness score of the course as rated by students.. Value examples: ['4', '3'].),\n]\n# Table: course_offering\n[\n  (offering_id:bigint, Unique identifier for each course offering. Value examples: ['1', '2', '3'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course is offered. Value examples: ['1', '1', '2'].),\n  (section_number:bigint, The section number of the course. Value examples: ['1', '1', '1'].),\n  (start_time:time, The start time of the course. Value examples: ['08:00:00', '10:00:00', '08:00:00'].),\n  (end_time:time, The end time of the course. Value examples: ['10:00:00', '12:00:00', '10:00:00'].),\n  (monday:text, The instructor's name for Monday. Value examples: ['John Smith', 'NULL', 'John Smith'].),\n  (tuesday:text, The instructor's name for Tuesday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (wednesday:text, The instructor's name for Wednesday. Value examples: ['NULL', 'Gilbert Strang', 'NULL'].),\n  (thursday:text, The instructor's name for Thursday. Value examples: ['Jane Doe', 'NULL', 'Jane Doe'].),\n  (friday:text, The instructor's name for Friday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (saturday:text, The instructor's name for Saturday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (sunday:text, The instructor's name for Sunday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (has_final_project:boolean, Indicates whether the course has a final project. Value examples: ['true', 'true', 'false'].),\n  (has_final_exam:boolean, Indicates whether the course has a final exam. Value examples: ['false', 'true', 'true'].),\n  (textbook:text, The name of the textbook used in the course. Value examples: ['Introduction to Computer Science', 'Advanced Calculus', 'Introduction to Physics'].),\n  (class_address:text, The address of the classroom where the course is held. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (allow_audit:text, Indicates whether auditing the course is allowed. Value examples: ['true', 'false', 'true'].),\n]\n# Table: course_prerequisite\n[\n  (pre_course_id:bigint, The ID of the prerequisite course. Value examples: ['1', '2'].),\n  (course_id:bigint, The ID of the course that has the prerequisite. Value examples: ['2', '3'].),\n]\n# Table: course_tags_count\n[\n  (course_id:bigint, The unique identifier for each course.. Value examples: ['1', '2', '3'].),\n  (clear_grading:bigint, Number of students who found the grading criteria clear and easy to understand.. Value examples: ['5', '4', '3'].),\n  (pop_quiz:bigint, Number of pop quizzes given during the course.. Value examples: ['2', '1', '2'].),\n  (group_projects:bigint, Number of group projects assigned during the course.. Value examples: ['3', '2', '1'].),\n  (inspirational:bigint, Number of students who found the course content inspirational.. Value examples: ['4', '3', '2'].),\n  (long_lectures:bigint, Number of students who found the lectures to be too long.. Value examples: ['2', '1', '3'].),\n  (extra_credit:bigint, Number of extra credit opportunities provided during the course.. Value examples: ['1', '2', '1'].),\n  (few_tests:bigint, Number of tests given during the course.. Value examples: ['3', '2', '1'].),\n  (good_feedback:bigint, Number of students who received good feedback from the instructor.. Value examples: ['4', '3', '2'].),\n  (tough_tests:bigint, Number of students who found the tests to be tough.. Value examples: ['2', '1', '3'].),\n  (heavy_papers:bigint, Number of papers assigned during the course.. Value examples: ['1', '2', '1'].),\n  (cares_for_students:bigint, Number of students who felt that the instructor cared for their well-being.. Value examples: ['5', '4', '3'].),\n  (heavy_assignments:bigint, Number of assignments given during the course.. Value examples: ['3', '2', '1'].),\n  (respected:bigint, Number of students who respected the instructor.. Value examples: ['4', '3', '2'].),\n  (participation:bigint, Number of students who participated actively in the course.. Value examples: ['2', '1', '3'].),\n  (heavy_reading:bigint, Number of reading assignments given during the course.. Value examples: ['1', '2', '1'].),\n  (tough_grader:bigint, Number of students who found the instructor to be a tough grader.. Value examples: ['5', '4', '3'].),\n  (hilarious:bigint, Number of students who found the instructor to be hilarious.. Value examples: ['3', '2', '1'].),\n  (would_take_again:bigint, Number of students who would take the course again.. Value examples: ['4', '3', '2'].),\n  (good_lecture:bigint, Number of students who found the lectures to be good.. Value examples: ['2', '1', '3'].),\n  (no_skip:bigint, Number of students who did not skip any classes during the course.. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: instructor\n[\n  (instructor_id:bigint, Unique identifier for each instructor. Value examples: ['1', '2'].),\n  (name:text, Name of the instructor. Value examples: ['John Smith', 'Jane Doe'].),\n  (uniqname:text, Unique name of the instructor used for login and identification purposes. Value examples: ['jsmith', 'jdoe'].),\n]\n# Table: offering_instructor\n[\n  (offering_instructor_id:bigint, Unique identifier for each offering-instructor pair. Value examples: ['1', '2', '3'].),\n  (offering_id:bigint, Foreign key referencing the offering table. Value examples: ['1', '1', '2'].),\n  (instructor_id:bigint, Foreign key referencing the instructor table. Value examples: ['1', '2', '3'].),\n]\n# Table: program\n[\n  (program_id:bigint, Unique identifier for each program. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the program, Eg 'Computer Science', 'Physics'. Value examples: ['Computer Science', 'Mathematics', 'Physics'].),\n  (college:text, Name of the college offering the program. Value examples: ['Engineering', 'Arts and Sciences', 'Arts and Sciences'].),\n  (introduction:text, Introduction to the program. Value examples: ['This program focuses on computer science principles and applications.', 'This program provides a comprehensive study of mathematical concepts and theories.', 'This program explores the fundamental principles of physics and their applications.'].),\n]\n# Table: program_course\n[\n  (program_id:bigint, The ID of the program associated with the course. Value examples: ['1', '1'].),\n  (course_id:bigint, The ID of the course. Value examples: ['1', '4'].),\n  (workload:bigint, The workload of the course in hours. Value examples: ['100', '80'].),\n  (category:text, The category of the course. Can only be 'Core' or 'Elective'.. Value examples: ['Core', 'Elective'].),\n]\n# Table: program_requirement\n[\n  (program_id:bigint, Unique identifier for a program. Value examples: ['1', '2', '3'].),\n  (category:text, Category of the program. Value examples: ['Core', 'Core', 'Core'].),\n  (min_credit:bigint, Minimum number of credits required for the program. Value examples: ['120', '90', '200'].),\n  (additional_req:text, Additional requirements for the program, if any. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: semester\n[\n  (semester_id:bigint, Unique identifier for each semester. Sort by this column to get the right year-semester order.. Value examples: ['1', '2', '3', '4'].),\n  (semester:text, The name or identifier for the semester Can only be 'Fall', 'Spring', or 'Summer'. Value examples: ['Fall', 'Spring', 'Summer', 'Fall'].),\n  (year:bigint, The year in which the semester takes place. Value examples: ['2020', '2021', '2021', '2021'].),\n]\n# Table: student\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '2', '3'].),\n  (lastname:text, Last name of the student. Value examples: ['Smith', 'Doe', 'Johnson'].),\n  (firstname:text, First name of the student. Value examples: ['John', 'Jane', 'David'].),\n  (program_id:bigint, Identifier for the program the student is enrolled in. Value examples: ['1', '1', '2'].),\n  (declare_major:text, Major program the student declared. Value examples: ['Computer Science', 'Computer Science', 'Mathematics'].),\n  (total_credit:bigint, Total number of credits earned by the student. Value examples: ['13', '7', '7'].),\n  (total_gpa:numeric, Cumulative GPA of the student. Value examples: ['3.5', '3.2', '3.6'].),\n  (entered_as:text, Status of the student when they entered the program. e.g. 'Freshman', 'Transfer Student'. Value examples: ['Freshman', 'Freshman', 'Freshman'].),\n  (admit_term:date, Term in which the student was admitted. Format is YYYY-MM-DD. Value examples: ['2018-01-01', '2018-01-01', '2019-01-01'].),\n  (predicted_graduation_semester:date, Semester in which the student is predicted to graduate. Format is YYYY-MM-DD. Value examples: ['2022-05-01', '2022-05-01', '2022-05-01'].),\n  (degree:text, Degree program the student is enrolled in. Can only be 'Bachelor of Science' or 'Bachelor of Arts'.. Value examples: ['Bachelor of Science', 'Bachelor of Science', 'Bachelor of Arts'].),\n  (minor:text, Minor program the student is enrolled in. Value examples: ['NULL', 'NULL', 'Mathematics'].),\n  (internship:text, Internship program the student is enrolled in. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: student_record\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '1', '1'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course was taken. Value examples: ['1', '1', '2'].),\n  (grade:text, The grade received for the course. Value examples: ['A', 'A', 'A'].),\n  (how:text, How the student took the course. Can only be 'in-person' or 'online'.. Value examples: ['in-person', 'in-person', 'in-person'].),\n  (transfer_source:text, If the course was transferred from another institution, the name of that institution. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (earn_credit:text, Whether the student earned credit for the course (e.g. Yes, No). Value examples: ['Yes', 'Yes', 'Yes'].),\n  (repeat_term:text, If the student repeated the course, the semester in which it was repeated. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (test_id:text, Unique identifier for each test taken in the course. Value examples: ['1', '1', '1'].),\n  (offering_id:bigint, Unique identifier for each offering of a course. Value examples: ['1', '2', '3'].),\n]\n\n【Foreign keys】\narea.course_id = course.course_id\ncomment_instructor.instructor_id = instructor.instructor_id\ncomment_instructor.student_id = student.student_id\ncourse.course_id = course_offering.course_id\ncourse.course_id = course_prerequisite.course_id\ncourse.course_id = course_tags_count.course_id\ncourse.course_id = program_course.course_id\ncourse.course_id = student_record.course_id\ncourse_offering.offering_id = offering_instructor.offering_id\ncourse_offering.offering_id = student_record.offering_id\ninstructor.instructor_id = offering_instructor.instructor_id\nprogram.program_id = program_course.program_id\nprogram.program_id = program_requirement.program_id\nprogram.program_id = student.program_id\nstudent.student_id = student_record.student_id\n\n【参考信息】\n\n\n【用户问题】\nHow long has it been in days since the last admitted student?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT CURRENT_DATE - max(admit_term) AS duration_since_last_admitted_student FROM student;",
        "role": "assistant"
      }
    ],
    "db_name": "advising",
    "id": 33,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nSubtract 2 weeks from the most recent predicted graduation date and give the month.\n\n【数据库schema】\n【DB_ID】 advising\n【Schema】\n# Table: area\n[\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2'].),\n  (area:text, The area of study for each course. Value examples: ['Computer Science', 'Mathematics'].),\n]\n# Table: comment_instructor\n[\n  (instructor_id:bigint, Unique identifier for the instructor. Value examples: ['1', '2'].),\n  (student_id:bigint, Unique identifier for the student. Value examples: ['1', '2'].),\n  (score:bigint, Score given by the student to the instructor. Value examples: ['5', '4'].),\n  (comment_text:text, Textual comment given by the student about the instructor. Value examples: ['John Smith is a great instructor.', 'Jane Doe explains concepts clearly.'].),\n]\n# Table: course\n[\n  (course_id:bigint, The unique identifier for the course.. Value examples: ['1', '2'].),\n  (name:text, The name of the course.. Value examples: ['Introduction to Computer Science', 'Advanced Calculus'].),\n  (department:text, The department offering the course. Eg 'Mathematics', 'Physics'. Value examples: ['Computer Science', 'Mathematics'].),\n  (number:text, The course number/code.. Value examples: ['CS101', 'MATH201'].),\n  (credits:text, The number of credits awarded for completing the course.. Value examples: ['3', '4'].),\n  (advisory_requirement:text, Any advisory requirements for taking the course.. Value examples: ['NULL', 'CS101'].),\n  (enforced_requirement:text, Any enforced requirements for taking the course.. Value examples: ['NULL', 'NULL'].),\n  (description:text, A brief description of the course content.. Value examples: ['This course introduces the basics of computer science.', 'This course covers advanced topics in calculus.'].),\n  (num_semesters:bigint, The number of semesters the course is offered in a year.. Value examples: ['2', '1'].),\n  (num_enrolled:bigint, The total number of students enrolled in the course.. Value examples: ['2', '3'].),\n  (has_discussion:boolean, Indicates whether the course has any discussion sessions or not.. Value examples: ['true', 'false'].),\n  (has_lab:boolean, Indicates whether the course has any lab sessions or not.. Value examples: ['false', 'false'].),\n  (has_projects:boolean, Indicates whether the course has any projects or not.. Value examples: ['true', 'true'].),\n  (has_exams:boolean, Indicates whether the course has any exams or not.. Value examples: ['false', 'true'].),\n  (num_reviews:bigint, The total number of reviews/ratings for the course.. Value examples: ['10', '5'].),\n  (clarity_score:bigint, The overall clarity score of the course as rated by students.. Value examples: ['5', '4'].),\n  (easiness_score:bigint, The overall easiness score of the course as rated by students.. Value examples: ['3', '2'].),\n  (helpfulness_score:bigint, The overall helpfulness score of the course as rated by students.. Value examples: ['4', '3'].),\n]\n# Table: course_offering\n[\n  (offering_id:bigint, Unique identifier for each course offering. Value examples: ['1', '2', '3'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course is offered. Value examples: ['1', '1', '2'].),\n  (section_number:bigint, The section number of the course. Value examples: ['1', '1', '1'].),\n  (start_time:time, The start time of the course. Value examples: ['08:00:00', '10:00:00', '08:00:00'].),\n  (end_time:time, The end time of the course. Value examples: ['10:00:00', '12:00:00', '10:00:00'].),\n  (monday:text, The instructor's name for Monday. Value examples: ['John Smith', 'NULL', 'John Smith'].),\n  (tuesday:text, The instructor's name for Tuesday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (wednesday:text, The instructor's name for Wednesday. Value examples: ['NULL', 'Gilbert Strang', 'NULL'].),\n  (thursday:text, The instructor's name for Thursday. Value examples: ['Jane Doe', 'NULL', 'Jane Doe'].),\n  (friday:text, The instructor's name for Friday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (saturday:text, The instructor's name for Saturday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (sunday:text, The instructor's name for Sunday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (has_final_project:boolean, Indicates whether the course has a final project. Value examples: ['true', 'true', 'false'].),\n  (has_final_exam:boolean, Indicates whether the course has a final exam. Value examples: ['false', 'true', 'true'].),\n  (textbook:text, The name of the textbook used in the course. Value examples: ['Introduction to Computer Science', 'Advanced Calculus', 'Introduction to Physics'].),\n  (class_address:text, The address of the classroom where the course is held. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (allow_audit:text, Indicates whether auditing the course is allowed. Value examples: ['true', 'false', 'true'].),\n]\n# Table: course_prerequisite\n[\n  (pre_course_id:bigint, The ID of the prerequisite course. Value examples: ['1', '2'].),\n  (course_id:bigint, The ID of the course that has the prerequisite. Value examples: ['2', '3'].),\n]\n# Table: course_tags_count\n[\n  (course_id:bigint, The unique identifier for each course.. Value examples: ['1', '2', '3'].),\n  (clear_grading:bigint, Number of students who found the grading criteria clear and easy to understand.. Value examples: ['5', '4', '3'].),\n  (pop_quiz:bigint, Number of pop quizzes given during the course.. Value examples: ['2', '1', '2'].),\n  (group_projects:bigint, Number of group projects assigned during the course.. Value examples: ['3', '2', '1'].),\n  (inspirational:bigint, Number of students who found the course content inspirational.. Value examples: ['4', '3', '2'].),\n  (long_lectures:bigint, Number of students who found the lectures to be too long.. Value examples: ['2', '1', '3'].),\n  (extra_credit:bigint, Number of extra credit opportunities provided during the course.. Value examples: ['1', '2', '1'].),\n  (few_tests:bigint, Number of tests given during the course.. Value examples: ['3', '2', '1'].),\n  (good_feedback:bigint, Number of students who received good feedback from the instructor.. Value examples: ['4', '3', '2'].),\n  (tough_tests:bigint, Number of students who found the tests to be tough.. Value examples: ['2', '1', '3'].),\n  (heavy_papers:bigint, Number of papers assigned during the course.. Value examples: ['1', '2', '1'].),\n  (cares_for_students:bigint, Number of students who felt that the instructor cared for their well-being.. Value examples: ['5', '4', '3'].),\n  (heavy_assignments:bigint, Number of assignments given during the course.. Value examples: ['3', '2', '1'].),\n  (respected:bigint, Number of students who respected the instructor.. Value examples: ['4', '3', '2'].),\n  (participation:bigint, Number of students who participated actively in the course.. Value examples: ['2', '1', '3'].),\n  (heavy_reading:bigint, Number of reading assignments given during the course.. Value examples: ['1', '2', '1'].),\n  (tough_grader:bigint, Number of students who found the instructor to be a tough grader.. Value examples: ['5', '4', '3'].),\n  (hilarious:bigint, Number of students who found the instructor to be hilarious.. Value examples: ['3', '2', '1'].),\n  (would_take_again:bigint, Number of students who would take the course again.. Value examples: ['4', '3', '2'].),\n  (good_lecture:bigint, Number of students who found the lectures to be good.. Value examples: ['2', '1', '3'].),\n  (no_skip:bigint, Number of students who did not skip any classes during the course.. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: instructor\n[\n  (instructor_id:bigint, Unique identifier for each instructor. Value examples: ['1', '2'].),\n  (name:text, Name of the instructor. Value examples: ['John Smith', 'Jane Doe'].),\n  (uniqname:text, Unique name of the instructor used for login and identification purposes. Value examples: ['jsmith', 'jdoe'].),\n]\n# Table: offering_instructor\n[\n  (offering_instructor_id:bigint, Unique identifier for each offering-instructor pair. Value examples: ['1', '2', '3'].),\n  (offering_id:bigint, Foreign key referencing the offering table. Value examples: ['1', '1', '2'].),\n  (instructor_id:bigint, Foreign key referencing the instructor table. Value examples: ['1', '2', '3'].),\n]\n# Table: program\n[\n  (program_id:bigint, Unique identifier for each program. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the program, Eg 'Computer Science', 'Physics'. Value examples: ['Computer Science', 'Mathematics', 'Physics'].),\n  (college:text, Name of the college offering the program. Value examples: ['Engineering', 'Arts and Sciences', 'Arts and Sciences'].),\n  (introduction:text, Introduction to the program. Value examples: ['This program focuses on computer science principles and applications.', 'This program provides a comprehensive study of mathematical concepts and theories.', 'This program explores the fundamental principles of physics and their applications.'].),\n]\n# Table: program_course\n[\n  (program_id:bigint, The ID of the program associated with the course. Value examples: ['1', '1'].),\n  (course_id:bigint, The ID of the course. Value examples: ['1', '4'].),\n  (workload:bigint, The workload of the course in hours. Value examples: ['100', '80'].),\n  (category:text, The category of the course. Can only be 'Core' or 'Elective'.. Value examples: ['Core', 'Elective'].),\n]\n# Table: program_requirement\n[\n  (program_id:bigint, Unique identifier for a program. Value examples: ['1', '2', '3'].),\n  (category:text, Category of the program. Value examples: ['Core', 'Core', 'Core'].),\n  (min_credit:bigint, Minimum number of credits required for the program. Value examples: ['120', '90', '200'].),\n  (additional_req:text, Additional requirements for the program, if any. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: semester\n[\n  (semester_id:bigint, Unique identifier for each semester. Sort by this column to get the right year-semester order.. Value examples: ['1', '2', '3', '4'].),\n  (semester:text, The name or identifier for the semester Can only be 'Fall', 'Spring', or 'Summer'. Value examples: ['Fall', 'Spring', 'Summer', 'Fall'].),\n  (year:bigint, The year in which the semester takes place. Value examples: ['2020', '2021', '2021', '2021'].),\n]\n# Table: student\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '2', '3'].),\n  (lastname:text, Last name of the student. Value examples: ['Smith', 'Doe', 'Johnson'].),\n  (firstname:text, First name of the student. Value examples: ['John', 'Jane', 'David'].),\n  (program_id:bigint, Identifier for the program the student is enrolled in. Value examples: ['1', '1', '2'].),\n  (declare_major:text, Major program the student declared. Value examples: ['Computer Science', 'Computer Science', 'Mathematics'].),\n  (total_credit:bigint, Total number of credits earned by the student. Value examples: ['13', '7', '7'].),\n  (total_gpa:numeric, Cumulative GPA of the student. Value examples: ['3.5', '3.2', '3.6'].),\n  (entered_as:text, Status of the student when they entered the program. e.g. 'Freshman', 'Transfer Student'. Value examples: ['Freshman', 'Freshman', 'Freshman'].),\n  (admit_term:date, Term in which the student was admitted. Format is YYYY-MM-DD. Value examples: ['2018-01-01', '2018-01-01', '2019-01-01'].),\n  (predicted_graduation_semester:date, Semester in which the student is predicted to graduate. Format is YYYY-MM-DD. Value examples: ['2022-05-01', '2022-05-01', '2022-05-01'].),\n  (degree:text, Degree program the student is enrolled in. Can only be 'Bachelor of Science' or 'Bachelor of Arts'.. Value examples: ['Bachelor of Science', 'Bachelor of Science', 'Bachelor of Arts'].),\n  (minor:text, Minor program the student is enrolled in. Value examples: ['NULL', 'NULL', 'Mathematics'].),\n  (internship:text, Internship program the student is enrolled in. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: student_record\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '1', '1'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course was taken. Value examples: ['1', '1', '2'].),\n  (grade:text, The grade received for the course. Value examples: ['A', 'A', 'A'].),\n  (how:text, How the student took the course. Can only be 'in-person' or 'online'.. Value examples: ['in-person', 'in-person', 'in-person'].),\n  (transfer_source:text, If the course was transferred from another institution, the name of that institution. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (earn_credit:text, Whether the student earned credit for the course (e.g. Yes, No). Value examples: ['Yes', 'Yes', 'Yes'].),\n  (repeat_term:text, If the student repeated the course, the semester in which it was repeated. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (test_id:text, Unique identifier for each test taken in the course. Value examples: ['1', '1', '1'].),\n  (offering_id:bigint, Unique identifier for each offering of a course. Value examples: ['1', '2', '3'].),\n]\n\n【Foreign keys】\narea.course_id = course.course_id\ncomment_instructor.instructor_id = instructor.instructor_id\ncomment_instructor.student_id = student.student_id\ncourse.course_id = course_offering.course_id\ncourse.course_id = course_prerequisite.course_id\ncourse.course_id = course_tags_count.course_id\ncourse.course_id = program_course.course_id\ncourse.course_id = student_record.course_id\ncourse_offering.offering_id = offering_instructor.offering_id\ncourse_offering.offering_id = student_record.offering_id\ninstructor.instructor_id = offering_instructor.instructor_id\nprogram.program_id = program_course.program_id\nprogram.program_id = program_requirement.program_id\nprogram.program_id = student.program_id\nstudent.student_id = student_record.student_id\n\n【参考信息】\n\n\n【用户问题】\nSubtract 2 weeks from the most recent predicted graduation date and give the month.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT DATE_TRUNC('month', s.predicted_graduation_semester - INTERVAL '2 weeks') AS month FROM student s ORDER BY s.predicted_graduation_semester DESC LIMIT 1;SELECT extract(MONTH FROM predicted_graduation_semester - interval '2 weeks') AS month FROM student ORDER BY predicted_graduation_semester DESC LIMIT 1;",
        "role": "assistant"
      }
    ],
    "db_name": "advising",
    "id": 34,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the total number of students who found the instructor to be hilarious per course id?\n\n【数据库schema】\n【DB_ID】 advising\n【Schema】\n# Table: area\n[\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2'].),\n  (area:text, The area of study for each course. Value examples: ['Computer Science', 'Mathematics'].),\n]\n# Table: comment_instructor\n[\n  (instructor_id:bigint, Unique identifier for the instructor. Value examples: ['1', '2'].),\n  (student_id:bigint, Unique identifier for the student. Value examples: ['1', '2'].),\n  (score:bigint, Score given by the student to the instructor. Value examples: ['5', '4'].),\n  (comment_text:text, Textual comment given by the student about the instructor. Value examples: ['John Smith is a great instructor.', 'Jane Doe explains concepts clearly.'].),\n]\n# Table: course\n[\n  (course_id:bigint, The unique identifier for the course.. Value examples: ['1', '2'].),\n  (name:text, The name of the course.. Value examples: ['Introduction to Computer Science', 'Advanced Calculus'].),\n  (department:text, The department offering the course. Eg 'Mathematics', 'Physics'. Value examples: ['Computer Science', 'Mathematics'].),\n  (number:text, The course number/code.. Value examples: ['CS101', 'MATH201'].),\n  (credits:text, The number of credits awarded for completing the course.. Value examples: ['3', '4'].),\n  (advisory_requirement:text, Any advisory requirements for taking the course.. Value examples: ['NULL', 'CS101'].),\n  (enforced_requirement:text, Any enforced requirements for taking the course.. Value examples: ['NULL', 'NULL'].),\n  (description:text, A brief description of the course content.. Value examples: ['This course introduces the basics of computer science.', 'This course covers advanced topics in calculus.'].),\n  (num_semesters:bigint, The number of semesters the course is offered in a year.. Value examples: ['2', '1'].),\n  (num_enrolled:bigint, The total number of students enrolled in the course.. Value examples: ['2', '3'].),\n  (has_discussion:boolean, Indicates whether the course has any discussion sessions or not.. Value examples: ['true', 'false'].),\n  (has_lab:boolean, Indicates whether the course has any lab sessions or not.. Value examples: ['false', 'false'].),\n  (has_projects:boolean, Indicates whether the course has any projects or not.. Value examples: ['true', 'true'].),\n  (has_exams:boolean, Indicates whether the course has any exams or not.. Value examples: ['false', 'true'].),\n  (num_reviews:bigint, The total number of reviews/ratings for the course.. Value examples: ['10', '5'].),\n  (clarity_score:bigint, The overall clarity score of the course as rated by students.. Value examples: ['5', '4'].),\n  (easiness_score:bigint, The overall easiness score of the course as rated by students.. Value examples: ['3', '2'].),\n  (helpfulness_score:bigint, The overall helpfulness score of the course as rated by students.. Value examples: ['4', '3'].),\n]\n# Table: course_offering\n[\n  (offering_id:bigint, Unique identifier for each course offering. Value examples: ['1', '2', '3'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course is offered. Value examples: ['1', '1', '2'].),\n  (section_number:bigint, The section number of the course. Value examples: ['1', '1', '1'].),\n  (start_time:time, The start time of the course. Value examples: ['08:00:00', '10:00:00', '08:00:00'].),\n  (end_time:time, The end time of the course. Value examples: ['10:00:00', '12:00:00', '10:00:00'].),\n  (monday:text, The instructor's name for Monday. Value examples: ['John Smith', 'NULL', 'John Smith'].),\n  (tuesday:text, The instructor's name for Tuesday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (wednesday:text, The instructor's name for Wednesday. Value examples: ['NULL', 'Gilbert Strang', 'NULL'].),\n  (thursday:text, The instructor's name for Thursday. Value examples: ['Jane Doe', 'NULL', 'Jane Doe'].),\n  (friday:text, The instructor's name for Friday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (saturday:text, The instructor's name for Saturday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (sunday:text, The instructor's name for Sunday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (has_final_project:boolean, Indicates whether the course has a final project. Value examples: ['true', 'true', 'false'].),\n  (has_final_exam:boolean, Indicates whether the course has a final exam. Value examples: ['false', 'true', 'true'].),\n  (textbook:text, The name of the textbook used in the course. Value examples: ['Introduction to Computer Science', 'Advanced Calculus', 'Introduction to Physics'].),\n  (class_address:text, The address of the classroom where the course is held. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (allow_audit:text, Indicates whether auditing the course is allowed. Value examples: ['true', 'false', 'true'].),\n]\n# Table: course_prerequisite\n[\n  (pre_course_id:bigint, The ID of the prerequisite course. Value examples: ['1', '2'].),\n  (course_id:bigint, The ID of the course that has the prerequisite. Value examples: ['2', '3'].),\n]\n# Table: course_tags_count\n[\n  (course_id:bigint, The unique identifier for each course.. Value examples: ['1', '2', '3'].),\n  (clear_grading:bigint, Number of students who found the grading criteria clear and easy to understand.. Value examples: ['5', '4', '3'].),\n  (pop_quiz:bigint, Number of pop quizzes given during the course.. Value examples: ['2', '1', '2'].),\n  (group_projects:bigint, Number of group projects assigned during the course.. Value examples: ['3', '2', '1'].),\n  (inspirational:bigint, Number of students who found the course content inspirational.. Value examples: ['4', '3', '2'].),\n  (long_lectures:bigint, Number of students who found the lectures to be too long.. Value examples: ['2', '1', '3'].),\n  (extra_credit:bigint, Number of extra credit opportunities provided during the course.. Value examples: ['1', '2', '1'].),\n  (few_tests:bigint, Number of tests given during the course.. Value examples: ['3', '2', '1'].),\n  (good_feedback:bigint, Number of students who received good feedback from the instructor.. Value examples: ['4', '3', '2'].),\n  (tough_tests:bigint, Number of students who found the tests to be tough.. Value examples: ['2', '1', '3'].),\n  (heavy_papers:bigint, Number of papers assigned during the course.. Value examples: ['1', '2', '1'].),\n  (cares_for_students:bigint, Number of students who felt that the instructor cared for their well-being.. Value examples: ['5', '4', '3'].),\n  (heavy_assignments:bigint, Number of assignments given during the course.. Value examples: ['3', '2', '1'].),\n  (respected:bigint, Number of students who respected the instructor.. Value examples: ['4', '3', '2'].),\n  (participation:bigint, Number of students who participated actively in the course.. Value examples: ['2', '1', '3'].),\n  (heavy_reading:bigint, Number of reading assignments given during the course.. Value examples: ['1', '2', '1'].),\n  (tough_grader:bigint, Number of students who found the instructor to be a tough grader.. Value examples: ['5', '4', '3'].),\n  (hilarious:bigint, Number of students who found the instructor to be hilarious.. Value examples: ['3', '2', '1'].),\n  (would_take_again:bigint, Number of students who would take the course again.. Value examples: ['4', '3', '2'].),\n  (good_lecture:bigint, Number of students who found the lectures to be good.. Value examples: ['2', '1', '3'].),\n  (no_skip:bigint, Number of students who did not skip any classes during the course.. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: instructor\n[\n  (instructor_id:bigint, Unique identifier for each instructor. Value examples: ['1', '2'].),\n  (name:text, Name of the instructor. Value examples: ['John Smith', 'Jane Doe'].),\n  (uniqname:text, Unique name of the instructor used for login and identification purposes. Value examples: ['jsmith', 'jdoe'].),\n]\n# Table: offering_instructor\n[\n  (offering_instructor_id:bigint, Unique identifier for each offering-instructor pair. Value examples: ['1', '2', '3'].),\n  (offering_id:bigint, Foreign key referencing the offering table. Value examples: ['1', '1', '2'].),\n  (instructor_id:bigint, Foreign key referencing the instructor table. Value examples: ['1', '2', '3'].),\n]\n# Table: program\n[\n  (program_id:bigint, Unique identifier for each program. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the program, Eg 'Computer Science', 'Physics'. Value examples: ['Computer Science', 'Mathematics', 'Physics'].),\n  (college:text, Name of the college offering the program. Value examples: ['Engineering', 'Arts and Sciences', 'Arts and Sciences'].),\n  (introduction:text, Introduction to the program. Value examples: ['This program focuses on computer science principles and applications.', 'This program provides a comprehensive study of mathematical concepts and theories.', 'This program explores the fundamental principles of physics and their applications.'].),\n]\n# Table: program_course\n[\n  (program_id:bigint, The ID of the program associated with the course. Value examples: ['1', '1'].),\n  (course_id:bigint, The ID of the course. Value examples: ['1', '4'].),\n  (workload:bigint, The workload of the course in hours. Value examples: ['100', '80'].),\n  (category:text, The category of the course. Can only be 'Core' or 'Elective'.. Value examples: ['Core', 'Elective'].),\n]\n# Table: program_requirement\n[\n  (program_id:bigint, Unique identifier for a program. Value examples: ['1', '2', '3'].),\n  (category:text, Category of the program. Value examples: ['Core', 'Core', 'Core'].),\n  (min_credit:bigint, Minimum number of credits required for the program. Value examples: ['120', '90', '200'].),\n  (additional_req:text, Additional requirements for the program, if any. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: semester\n[\n  (semester_id:bigint, Unique identifier for each semester. Sort by this column to get the right year-semester order.. Value examples: ['1', '2', '3', '4'].),\n  (semester:text, The name or identifier for the semester Can only be 'Fall', 'Spring', or 'Summer'. Value examples: ['Fall', 'Spring', 'Summer', 'Fall'].),\n  (year:bigint, The year in which the semester takes place. Value examples: ['2020', '2021', '2021', '2021'].),\n]\n# Table: student\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '2', '3'].),\n  (lastname:text, Last name of the student. Value examples: ['Smith', 'Doe', 'Johnson'].),\n  (firstname:text, First name of the student. Value examples: ['John', 'Jane', 'David'].),\n  (program_id:bigint, Identifier for the program the student is enrolled in. Value examples: ['1', '1', '2'].),\n  (declare_major:text, Major program the student declared. Value examples: ['Computer Science', 'Computer Science', 'Mathematics'].),\n  (total_credit:bigint, Total number of credits earned by the student. Value examples: ['13', '7', '7'].),\n  (total_gpa:numeric, Cumulative GPA of the student. Value examples: ['3.5', '3.2', '3.6'].),\n  (entered_as:text, Status of the student when they entered the program. e.g. 'Freshman', 'Transfer Student'. Value examples: ['Freshman', 'Freshman', 'Freshman'].),\n  (admit_term:date, Term in which the student was admitted. Format is YYYY-MM-DD. Value examples: ['2018-01-01', '2018-01-01', '2019-01-01'].),\n  (predicted_graduation_semester:date, Semester in which the student is predicted to graduate. Format is YYYY-MM-DD. Value examples: ['2022-05-01', '2022-05-01', '2022-05-01'].),\n  (degree:text, Degree program the student is enrolled in. Can only be 'Bachelor of Science' or 'Bachelor of Arts'.. Value examples: ['Bachelor of Science', 'Bachelor of Science', 'Bachelor of Arts'].),\n  (minor:text, Minor program the student is enrolled in. Value examples: ['NULL', 'NULL', 'Mathematics'].),\n  (internship:text, Internship program the student is enrolled in. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: student_record\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '1', '1'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course was taken. Value examples: ['1', '1', '2'].),\n  (grade:text, The grade received for the course. Value examples: ['A', 'A', 'A'].),\n  (how:text, How the student took the course. Can only be 'in-person' or 'online'.. Value examples: ['in-person', 'in-person', 'in-person'].),\n  (transfer_source:text, If the course was transferred from another institution, the name of that institution. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (earn_credit:text, Whether the student earned credit for the course (e.g. Yes, No). Value examples: ['Yes', 'Yes', 'Yes'].),\n  (repeat_term:text, If the student repeated the course, the semester in which it was repeated. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (test_id:text, Unique identifier for each test taken in the course. Value examples: ['1', '1', '1'].),\n  (offering_id:bigint, Unique identifier for each offering of a course. Value examples: ['1', '2', '3'].),\n]\n\n【Foreign keys】\narea.course_id = course.course_id\ncomment_instructor.instructor_id = instructor.instructor_id\ncomment_instructor.student_id = student.student_id\ncourse.course_id = course_offering.course_id\ncourse.course_id = course_prerequisite.course_id\ncourse.course_id = course_tags_count.course_id\ncourse.course_id = program_course.course_id\ncourse.course_id = student_record.course_id\ncourse_offering.offering_id = offering_instructor.offering_id\ncourse_offering.offering_id = student_record.offering_id\ninstructor.instructor_id = offering_instructor.instructor_id\nprogram.program_id = program_course.program_id\nprogram.program_id = program_requirement.program_id\nprogram.program_id = student.program_id\nstudent.student_id = student_record.student_id\n\n【参考信息】\n\n\n【用户问题】\nWhat is the total number of students who found the instructor to be hilarious per course id?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT course_tags_count.course_id, SUM(course_tags_count.hilarious) AS total_hilarious FROM course_tags_count GROUP BY course_tags_count.course_id;",
        "role": "assistant"
      }
    ],
    "db_name": "advising",
    "id": 35,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the average clarity score for each instructor who taught a course?\n\n【数据库schema】\n【DB_ID】 advising\n【Schema】\n# Table: area\n[\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2'].),\n  (area:text, The area of study for each course. Value examples: ['Computer Science', 'Mathematics'].),\n]\n# Table: comment_instructor\n[\n  (instructor_id:bigint, Unique identifier for the instructor. Value examples: ['1', '2'].),\n  (student_id:bigint, Unique identifier for the student. Value examples: ['1', '2'].),\n  (score:bigint, Score given by the student to the instructor. Value examples: ['5', '4'].),\n  (comment_text:text, Textual comment given by the student about the instructor. Value examples: ['John Smith is a great instructor.', 'Jane Doe explains concepts clearly.'].),\n]\n# Table: course\n[\n  (course_id:bigint, The unique identifier for the course.. Value examples: ['1', '2'].),\n  (name:text, The name of the course.. Value examples: ['Introduction to Computer Science', 'Advanced Calculus'].),\n  (department:text, The department offering the course. Eg 'Mathematics', 'Physics'. Value examples: ['Computer Science', 'Mathematics'].),\n  (number:text, The course number/code.. Value examples: ['CS101', 'MATH201'].),\n  (credits:text, The number of credits awarded for completing the course.. Value examples: ['3', '4'].),\n  (advisory_requirement:text, Any advisory requirements for taking the course.. Value examples: ['NULL', 'CS101'].),\n  (enforced_requirement:text, Any enforced requirements for taking the course.. Value examples: ['NULL', 'NULL'].),\n  (description:text, A brief description of the course content.. Value examples: ['This course introduces the basics of computer science.', 'This course covers advanced topics in calculus.'].),\n  (num_semesters:bigint, The number of semesters the course is offered in a year.. Value examples: ['2', '1'].),\n  (num_enrolled:bigint, The total number of students enrolled in the course.. Value examples: ['2', '3'].),\n  (has_discussion:boolean, Indicates whether the course has any discussion sessions or not.. Value examples: ['true', 'false'].),\n  (has_lab:boolean, Indicates whether the course has any lab sessions or not.. Value examples: ['false', 'false'].),\n  (has_projects:boolean, Indicates whether the course has any projects or not.. Value examples: ['true', 'true'].),\n  (has_exams:boolean, Indicates whether the course has any exams or not.. Value examples: ['false', 'true'].),\n  (num_reviews:bigint, The total number of reviews/ratings for the course.. Value examples: ['10', '5'].),\n  (clarity_score:bigint, The overall clarity score of the course as rated by students.. Value examples: ['5', '4'].),\n  (easiness_score:bigint, The overall easiness score of the course as rated by students.. Value examples: ['3', '2'].),\n  (helpfulness_score:bigint, The overall helpfulness score of the course as rated by students.. Value examples: ['4', '3'].),\n]\n# Table: course_offering\n[\n  (offering_id:bigint, Unique identifier for each course offering. Value examples: ['1', '2', '3'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course is offered. Value examples: ['1', '1', '2'].),\n  (section_number:bigint, The section number of the course. Value examples: ['1', '1', '1'].),\n  (start_time:time, The start time of the course. Value examples: ['08:00:00', '10:00:00', '08:00:00'].),\n  (end_time:time, The end time of the course. Value examples: ['10:00:00', '12:00:00', '10:00:00'].),\n  (monday:text, The instructor's name for Monday. Value examples: ['John Smith', 'NULL', 'John Smith'].),\n  (tuesday:text, The instructor's name for Tuesday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (wednesday:text, The instructor's name for Wednesday. Value examples: ['NULL', 'Gilbert Strang', 'NULL'].),\n  (thursday:text, The instructor's name for Thursday. Value examples: ['Jane Doe', 'NULL', 'Jane Doe'].),\n  (friday:text, The instructor's name for Friday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (saturday:text, The instructor's name for Saturday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (sunday:text, The instructor's name for Sunday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (has_final_project:boolean, Indicates whether the course has a final project. Value examples: ['true', 'true', 'false'].),\n  (has_final_exam:boolean, Indicates whether the course has a final exam. Value examples: ['false', 'true', 'true'].),\n  (textbook:text, The name of the textbook used in the course. Value examples: ['Introduction to Computer Science', 'Advanced Calculus', 'Introduction to Physics'].),\n  (class_address:text, The address of the classroom where the course is held. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (allow_audit:text, Indicates whether auditing the course is allowed. Value examples: ['true', 'false', 'true'].),\n]\n# Table: course_prerequisite\n[\n  (pre_course_id:bigint, The ID of the prerequisite course. Value examples: ['1', '2'].),\n  (course_id:bigint, The ID of the course that has the prerequisite. Value examples: ['2', '3'].),\n]\n# Table: course_tags_count\n[\n  (course_id:bigint, The unique identifier for each course.. Value examples: ['1', '2', '3'].),\n  (clear_grading:bigint, Number of students who found the grading criteria clear and easy to understand.. Value examples: ['5', '4', '3'].),\n  (pop_quiz:bigint, Number of pop quizzes given during the course.. Value examples: ['2', '1', '2'].),\n  (group_projects:bigint, Number of group projects assigned during the course.. Value examples: ['3', '2', '1'].),\n  (inspirational:bigint, Number of students who found the course content inspirational.. Value examples: ['4', '3', '2'].),\n  (long_lectures:bigint, Number of students who found the lectures to be too long.. Value examples: ['2', '1', '3'].),\n  (extra_credit:bigint, Number of extra credit opportunities provided during the course.. Value examples: ['1', '2', '1'].),\n  (few_tests:bigint, Number of tests given during the course.. Value examples: ['3', '2', '1'].),\n  (good_feedback:bigint, Number of students who received good feedback from the instructor.. Value examples: ['4', '3', '2'].),\n  (tough_tests:bigint, Number of students who found the tests to be tough.. Value examples: ['2', '1', '3'].),\n  (heavy_papers:bigint, Number of papers assigned during the course.. Value examples: ['1', '2', '1'].),\n  (cares_for_students:bigint, Number of students who felt that the instructor cared for their well-being.. Value examples: ['5', '4', '3'].),\n  (heavy_assignments:bigint, Number of assignments given during the course.. Value examples: ['3', '2', '1'].),\n  (respected:bigint, Number of students who respected the instructor.. Value examples: ['4', '3', '2'].),\n  (participation:bigint, Number of students who participated actively in the course.. Value examples: ['2', '1', '3'].),\n  (heavy_reading:bigint, Number of reading assignments given during the course.. Value examples: ['1', '2', '1'].),\n  (tough_grader:bigint, Number of students who found the instructor to be a tough grader.. Value examples: ['5', '4', '3'].),\n  (hilarious:bigint, Number of students who found the instructor to be hilarious.. Value examples: ['3', '2', '1'].),\n  (would_take_again:bigint, Number of students who would take the course again.. Value examples: ['4', '3', '2'].),\n  (good_lecture:bigint, Number of students who found the lectures to be good.. Value examples: ['2', '1', '3'].),\n  (no_skip:bigint, Number of students who did not skip any classes during the course.. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: instructor\n[\n  (instructor_id:bigint, Unique identifier for each instructor. Value examples: ['1', '2'].),\n  (name:text, Name of the instructor. Value examples: ['John Smith', 'Jane Doe'].),\n  (uniqname:text, Unique name of the instructor used for login and identification purposes. Value examples: ['jsmith', 'jdoe'].),\n]\n# Table: offering_instructor\n[\n  (offering_instructor_id:bigint, Unique identifier for each offering-instructor pair. Value examples: ['1', '2', '3'].),\n  (offering_id:bigint, Foreign key referencing the offering table. Value examples: ['1', '1', '2'].),\n  (instructor_id:bigint, Foreign key referencing the instructor table. Value examples: ['1', '2', '3'].),\n]\n# Table: program\n[\n  (program_id:bigint, Unique identifier for each program. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the program, Eg 'Computer Science', 'Physics'. Value examples: ['Computer Science', 'Mathematics', 'Physics'].),\n  (college:text, Name of the college offering the program. Value examples: ['Engineering', 'Arts and Sciences', 'Arts and Sciences'].),\n  (introduction:text, Introduction to the program. Value examples: ['This program focuses on computer science principles and applications.', 'This program provides a comprehensive study of mathematical concepts and theories.', 'This program explores the fundamental principles of physics and their applications.'].),\n]\n# Table: program_course\n[\n  (program_id:bigint, The ID of the program associated with the course. Value examples: ['1', '1'].),\n  (course_id:bigint, The ID of the course. Value examples: ['1', '4'].),\n  (workload:bigint, The workload of the course in hours. Value examples: ['100', '80'].),\n  (category:text, The category of the course. Can only be 'Core' or 'Elective'.. Value examples: ['Core', 'Elective'].),\n]\n# Table: program_requirement\n[\n  (program_id:bigint, Unique identifier for a program. Value examples: ['1', '2', '3'].),\n  (category:text, Category of the program. Value examples: ['Core', 'Core', 'Core'].),\n  (min_credit:bigint, Minimum number of credits required for the program. Value examples: ['120', '90', '200'].),\n  (additional_req:text, Additional requirements for the program, if any. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: semester\n[\n  (semester_id:bigint, Unique identifier for each semester. Sort by this column to get the right year-semester order.. Value examples: ['1', '2', '3', '4'].),\n  (semester:text, The name or identifier for the semester Can only be 'Fall', 'Spring', or 'Summer'. Value examples: ['Fall', 'Spring', 'Summer', 'Fall'].),\n  (year:bigint, The year in which the semester takes place. Value examples: ['2020', '2021', '2021', '2021'].),\n]\n# Table: student\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '2', '3'].),\n  (lastname:text, Last name of the student. Value examples: ['Smith', 'Doe', 'Johnson'].),\n  (firstname:text, First name of the student. Value examples: ['John', 'Jane', 'David'].),\n  (program_id:bigint, Identifier for the program the student is enrolled in. Value examples: ['1', '1', '2'].),\n  (declare_major:text, Major program the student declared. Value examples: ['Computer Science', 'Computer Science', 'Mathematics'].),\n  (total_credit:bigint, Total number of credits earned by the student. Value examples: ['13', '7', '7'].),\n  (total_gpa:numeric, Cumulative GPA of the student. Value examples: ['3.5', '3.2', '3.6'].),\n  (entered_as:text, Status of the student when they entered the program. e.g. 'Freshman', 'Transfer Student'. Value examples: ['Freshman', 'Freshman', 'Freshman'].),\n  (admit_term:date, Term in which the student was admitted. Format is YYYY-MM-DD. Value examples: ['2018-01-01', '2018-01-01', '2019-01-01'].),\n  (predicted_graduation_semester:date, Semester in which the student is predicted to graduate. Format is YYYY-MM-DD. Value examples: ['2022-05-01', '2022-05-01', '2022-05-01'].),\n  (degree:text, Degree program the student is enrolled in. Can only be 'Bachelor of Science' or 'Bachelor of Arts'.. Value examples: ['Bachelor of Science', 'Bachelor of Science', 'Bachelor of Arts'].),\n  (minor:text, Minor program the student is enrolled in. Value examples: ['NULL', 'NULL', 'Mathematics'].),\n  (internship:text, Internship program the student is enrolled in. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: student_record\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '1', '1'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course was taken. Value examples: ['1', '1', '2'].),\n  (grade:text, The grade received for the course. Value examples: ['A', 'A', 'A'].),\n  (how:text, How the student took the course. Can only be 'in-person' or 'online'.. Value examples: ['in-person', 'in-person', 'in-person'].),\n  (transfer_source:text, If the course was transferred from another institution, the name of that institution. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (earn_credit:text, Whether the student earned credit for the course (e.g. Yes, No). Value examples: ['Yes', 'Yes', 'Yes'].),\n  (repeat_term:text, If the student repeated the course, the semester in which it was repeated. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (test_id:text, Unique identifier for each test taken in the course. Value examples: ['1', '1', '1'].),\n  (offering_id:bigint, Unique identifier for each offering of a course. Value examples: ['1', '2', '3'].),\n]\n\n【Foreign keys】\narea.course_id = course.course_id\ncomment_instructor.instructor_id = instructor.instructor_id\ncomment_instructor.student_id = student.student_id\ncourse.course_id = course_offering.course_id\ncourse.course_id = course_prerequisite.course_id\ncourse.course_id = course_tags_count.course_id\ncourse.course_id = program_course.course_id\ncourse.course_id = student_record.course_id\ncourse_offering.offering_id = offering_instructor.offering_id\ncourse_offering.offering_id = student_record.offering_id\ninstructor.instructor_id = offering_instructor.instructor_id\nprogram.program_id = program_course.program_id\nprogram.program_id = program_requirement.program_id\nprogram.program_id = student.program_id\nstudent.student_id = student_record.student_id\n\n【参考信息】\n\n\n【用户问题】\nWhat is the average clarity score for each instructor who taught a course?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT i.name, i.instructor_id, AVG(c.clarity_score) FROM course c JOIN course_offering co ON c.course_id = co.course_id JOIN offering_instructor oi ON co.offering_id = oi.offering_id JOIN instructor i ON oi.instructor_id = i.instructor_id GROUP BY i.name, i.instructor_id",
        "role": "assistant"
      }
    ],
    "db_name": "advising",
    "id": 36,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many course offerings have a final exam and how many do not?\n\n【数据库schema】\n【DB_ID】 advising\n【Schema】\n# Table: area\n[\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2'].),\n  (area:text, The area of study for each course. Value examples: ['Computer Science', 'Mathematics'].),\n]\n# Table: comment_instructor\n[\n  (instructor_id:bigint, Unique identifier for the instructor. Value examples: ['1', '2'].),\n  (student_id:bigint, Unique identifier for the student. Value examples: ['1', '2'].),\n  (score:bigint, Score given by the student to the instructor. Value examples: ['5', '4'].),\n  (comment_text:text, Textual comment given by the student about the instructor. Value examples: ['John Smith is a great instructor.', 'Jane Doe explains concepts clearly.'].),\n]\n# Table: course\n[\n  (course_id:bigint, The unique identifier for the course.. Value examples: ['1', '2'].),\n  (name:text, The name of the course.. Value examples: ['Introduction to Computer Science', 'Advanced Calculus'].),\n  (department:text, The department offering the course. Eg 'Mathematics', 'Physics'. Value examples: ['Computer Science', 'Mathematics'].),\n  (number:text, The course number/code.. Value examples: ['CS101', 'MATH201'].),\n  (credits:text, The number of credits awarded for completing the course.. Value examples: ['3', '4'].),\n  (advisory_requirement:text, Any advisory requirements for taking the course.. Value examples: ['NULL', 'CS101'].),\n  (enforced_requirement:text, Any enforced requirements for taking the course.. Value examples: ['NULL', 'NULL'].),\n  (description:text, A brief description of the course content.. Value examples: ['This course introduces the basics of computer science.', 'This course covers advanced topics in calculus.'].),\n  (num_semesters:bigint, The number of semesters the course is offered in a year.. Value examples: ['2', '1'].),\n  (num_enrolled:bigint, The total number of students enrolled in the course.. Value examples: ['2', '3'].),\n  (has_discussion:boolean, Indicates whether the course has any discussion sessions or not.. Value examples: ['true', 'false'].),\n  (has_lab:boolean, Indicates whether the course has any lab sessions or not.. Value examples: ['false', 'false'].),\n  (has_projects:boolean, Indicates whether the course has any projects or not.. Value examples: ['true', 'true'].),\n  (has_exams:boolean, Indicates whether the course has any exams or not.. Value examples: ['false', 'true'].),\n  (num_reviews:bigint, The total number of reviews/ratings for the course.. Value examples: ['10', '5'].),\n  (clarity_score:bigint, The overall clarity score of the course as rated by students.. Value examples: ['5', '4'].),\n  (easiness_score:bigint, The overall easiness score of the course as rated by students.. Value examples: ['3', '2'].),\n  (helpfulness_score:bigint, The overall helpfulness score of the course as rated by students.. Value examples: ['4', '3'].),\n]\n# Table: course_offering\n[\n  (offering_id:bigint, Unique identifier for each course offering. Value examples: ['1', '2', '3'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course is offered. Value examples: ['1', '1', '2'].),\n  (section_number:bigint, The section number of the course. Value examples: ['1', '1', '1'].),\n  (start_time:time, The start time of the course. Value examples: ['08:00:00', '10:00:00', '08:00:00'].),\n  (end_time:time, The end time of the course. Value examples: ['10:00:00', '12:00:00', '10:00:00'].),\n  (monday:text, The instructor's name for Monday. Value examples: ['John Smith', 'NULL', 'John Smith'].),\n  (tuesday:text, The instructor's name for Tuesday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (wednesday:text, The instructor's name for Wednesday. Value examples: ['NULL', 'Gilbert Strang', 'NULL'].),\n  (thursday:text, The instructor's name for Thursday. Value examples: ['Jane Doe', 'NULL', 'Jane Doe'].),\n  (friday:text, The instructor's name for Friday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (saturday:text, The instructor's name for Saturday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (sunday:text, The instructor's name for Sunday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (has_final_project:boolean, Indicates whether the course has a final project. Value examples: ['true', 'true', 'false'].),\n  (has_final_exam:boolean, Indicates whether the course has a final exam. Value examples: ['false', 'true', 'true'].),\n  (textbook:text, The name of the textbook used in the course. Value examples: ['Introduction to Computer Science', 'Advanced Calculus', 'Introduction to Physics'].),\n  (class_address:text, The address of the classroom where the course is held. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (allow_audit:text, Indicates whether auditing the course is allowed. Value examples: ['true', 'false', 'true'].),\n]\n# Table: course_prerequisite\n[\n  (pre_course_id:bigint, The ID of the prerequisite course. Value examples: ['1', '2'].),\n  (course_id:bigint, The ID of the course that has the prerequisite. Value examples: ['2', '3'].),\n]\n# Table: course_tags_count\n[\n  (course_id:bigint, The unique identifier for each course.. Value examples: ['1', '2', '3'].),\n  (clear_grading:bigint, Number of students who found the grading criteria clear and easy to understand.. Value examples: ['5', '4', '3'].),\n  (pop_quiz:bigint, Number of pop quizzes given during the course.. Value examples: ['2', '1', '2'].),\n  (group_projects:bigint, Number of group projects assigned during the course.. Value examples: ['3', '2', '1'].),\n  (inspirational:bigint, Number of students who found the course content inspirational.. Value examples: ['4', '3', '2'].),\n  (long_lectures:bigint, Number of students who found the lectures to be too long.. Value examples: ['2', '1', '3'].),\n  (extra_credit:bigint, Number of extra credit opportunities provided during the course.. Value examples: ['1', '2', '1'].),\n  (few_tests:bigint, Number of tests given during the course.. Value examples: ['3', '2', '1'].),\n  (good_feedback:bigint, Number of students who received good feedback from the instructor.. Value examples: ['4', '3', '2'].),\n  (tough_tests:bigint, Number of students who found the tests to be tough.. Value examples: ['2', '1', '3'].),\n  (heavy_papers:bigint, Number of papers assigned during the course.. Value examples: ['1', '2', '1'].),\n  (cares_for_students:bigint, Number of students who felt that the instructor cared for their well-being.. Value examples: ['5', '4', '3'].),\n  (heavy_assignments:bigint, Number of assignments given during the course.. Value examples: ['3', '2', '1'].),\n  (respected:bigint, Number of students who respected the instructor.. Value examples: ['4', '3', '2'].),\n  (participation:bigint, Number of students who participated actively in the course.. Value examples: ['2', '1', '3'].),\n  (heavy_reading:bigint, Number of reading assignments given during the course.. Value examples: ['1', '2', '1'].),\n  (tough_grader:bigint, Number of students who found the instructor to be a tough grader.. Value examples: ['5', '4', '3'].),\n  (hilarious:bigint, Number of students who found the instructor to be hilarious.. Value examples: ['3', '2', '1'].),\n  (would_take_again:bigint, Number of students who would take the course again.. Value examples: ['4', '3', '2'].),\n  (good_lecture:bigint, Number of students who found the lectures to be good.. Value examples: ['2', '1', '3'].),\n  (no_skip:bigint, Number of students who did not skip any classes during the course.. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: instructor\n[\n  (instructor_id:bigint, Unique identifier for each instructor. Value examples: ['1', '2'].),\n  (name:text, Name of the instructor. Value examples: ['John Smith', 'Jane Doe'].),\n  (uniqname:text, Unique name of the instructor used for login and identification purposes. Value examples: ['jsmith', 'jdoe'].),\n]\n# Table: offering_instructor\n[\n  (offering_instructor_id:bigint, Unique identifier for each offering-instructor pair. Value examples: ['1', '2', '3'].),\n  (offering_id:bigint, Foreign key referencing the offering table. Value examples: ['1', '1', '2'].),\n  (instructor_id:bigint, Foreign key referencing the instructor table. Value examples: ['1', '2', '3'].),\n]\n# Table: program\n[\n  (program_id:bigint, Unique identifier for each program. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the program, Eg 'Computer Science', 'Physics'. Value examples: ['Computer Science', 'Mathematics', 'Physics'].),\n  (college:text, Name of the college offering the program. Value examples: ['Engineering', 'Arts and Sciences', 'Arts and Sciences'].),\n  (introduction:text, Introduction to the program. Value examples: ['This program focuses on computer science principles and applications.', 'This program provides a comprehensive study of mathematical concepts and theories.', 'This program explores the fundamental principles of physics and their applications.'].),\n]\n# Table: program_course\n[\n  (program_id:bigint, The ID of the program associated with the course. Value examples: ['1', '1'].),\n  (course_id:bigint, The ID of the course. Value examples: ['1', '4'].),\n  (workload:bigint, The workload of the course in hours. Value examples: ['100', '80'].),\n  (category:text, The category of the course. Can only be 'Core' or 'Elective'.. Value examples: ['Core', 'Elective'].),\n]\n# Table: program_requirement\n[\n  (program_id:bigint, Unique identifier for a program. Value examples: ['1', '2', '3'].),\n  (category:text, Category of the program. Value examples: ['Core', 'Core', 'Core'].),\n  (min_credit:bigint, Minimum number of credits required for the program. Value examples: ['120', '90', '200'].),\n  (additional_req:text, Additional requirements for the program, if any. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: semester\n[\n  (semester_id:bigint, Unique identifier for each semester. Sort by this column to get the right year-semester order.. Value examples: ['1', '2', '3', '4'].),\n  (semester:text, The name or identifier for the semester Can only be 'Fall', 'Spring', or 'Summer'. Value examples: ['Fall', 'Spring', 'Summer', 'Fall'].),\n  (year:bigint, The year in which the semester takes place. Value examples: ['2020', '2021', '2021', '2021'].),\n]\n# Table: student\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '2', '3'].),\n  (lastname:text, Last name of the student. Value examples: ['Smith', 'Doe', 'Johnson'].),\n  (firstname:text, First name of the student. Value examples: ['John', 'Jane', 'David'].),\n  (program_id:bigint, Identifier for the program the student is enrolled in. Value examples: ['1', '1', '2'].),\n  (declare_major:text, Major program the student declared. Value examples: ['Computer Science', 'Computer Science', 'Mathematics'].),\n  (total_credit:bigint, Total number of credits earned by the student. Value examples: ['13', '7', '7'].),\n  (total_gpa:numeric, Cumulative GPA of the student. Value examples: ['3.5', '3.2', '3.6'].),\n  (entered_as:text, Status of the student when they entered the program. e.g. 'Freshman', 'Transfer Student'. Value examples: ['Freshman', 'Freshman', 'Freshman'].),\n  (admit_term:date, Term in which the student was admitted. Format is YYYY-MM-DD. Value examples: ['2018-01-01', '2018-01-01', '2019-01-01'].),\n  (predicted_graduation_semester:date, Semester in which the student is predicted to graduate. Format is YYYY-MM-DD. Value examples: ['2022-05-01', '2022-05-01', '2022-05-01'].),\n  (degree:text, Degree program the student is enrolled in. Can only be 'Bachelor of Science' or 'Bachelor of Arts'.. Value examples: ['Bachelor of Science', 'Bachelor of Science', 'Bachelor of Arts'].),\n  (minor:text, Minor program the student is enrolled in. Value examples: ['NULL', 'NULL', 'Mathematics'].),\n  (internship:text, Internship program the student is enrolled in. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: student_record\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '1', '1'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course was taken. Value examples: ['1', '1', '2'].),\n  (grade:text, The grade received for the course. Value examples: ['A', 'A', 'A'].),\n  (how:text, How the student took the course. Can only be 'in-person' or 'online'.. Value examples: ['in-person', 'in-person', 'in-person'].),\n  (transfer_source:text, If the course was transferred from another institution, the name of that institution. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (earn_credit:text, Whether the student earned credit for the course (e.g. Yes, No). Value examples: ['Yes', 'Yes', 'Yes'].),\n  (repeat_term:text, If the student repeated the course, the semester in which it was repeated. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (test_id:text, Unique identifier for each test taken in the course. Value examples: ['1', '1', '1'].),\n  (offering_id:bigint, Unique identifier for each offering of a course. Value examples: ['1', '2', '3'].),\n]\n\n【Foreign keys】\narea.course_id = course.course_id\ncomment_instructor.instructor_id = instructor.instructor_id\ncomment_instructor.student_id = student.student_id\ncourse.course_id = course_offering.course_id\ncourse.course_id = course_prerequisite.course_id\ncourse.course_id = course_tags_count.course_id\ncourse.course_id = program_course.course_id\ncourse.course_id = student_record.course_id\ncourse_offering.offering_id = offering_instructor.offering_id\ncourse_offering.offering_id = student_record.offering_id\ninstructor.instructor_id = offering_instructor.instructor_id\nprogram.program_id = program_course.program_id\nprogram.program_id = program_requirement.program_id\nprogram.program_id = student.program_id\nstudent.student_id = student_record.student_id\n\n【参考信息】\n\n\n【用户问题】\nHow many course offerings have a final exam and how many do not?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT course_offering.has_final_exam, COUNT(offering_id) AS num_courses FROM course_offering GROUP BY course_offering.has_final_exam;SELECT COUNT(CASE WHEN co.has_final_exam THEN 1 END) AS num_with_final_exam, COUNT(CASE WHEN NOT co.has_final_exam THEN 1 END) AS num_without_final_exam FROM course_offering co;",
        "role": "assistant"
      }
    ],
    "db_name": "advising",
    "id": 37,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many courses does each department offer?\n\n【数据库schema】\n【DB_ID】 advising\n【Schema】\n# Table: area\n[\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2'].),\n  (area:text, The area of study for each course. Value examples: ['Computer Science', 'Mathematics'].),\n]\n# Table: comment_instructor\n[\n  (instructor_id:bigint, Unique identifier for the instructor. Value examples: ['1', '2'].),\n  (student_id:bigint, Unique identifier for the student. Value examples: ['1', '2'].),\n  (score:bigint, Score given by the student to the instructor. Value examples: ['5', '4'].),\n  (comment_text:text, Textual comment given by the student about the instructor. Value examples: ['John Smith is a great instructor.', 'Jane Doe explains concepts clearly.'].),\n]\n# Table: course\n[\n  (course_id:bigint, The unique identifier for the course.. Value examples: ['1', '2'].),\n  (name:text, The name of the course.. Value examples: ['Introduction to Computer Science', 'Advanced Calculus'].),\n  (department:text, The department offering the course. Eg 'Mathematics', 'Physics'. Value examples: ['Computer Science', 'Mathematics'].),\n  (number:text, The course number/code.. Value examples: ['CS101', 'MATH201'].),\n  (credits:text, The number of credits awarded for completing the course.. Value examples: ['3', '4'].),\n  (advisory_requirement:text, Any advisory requirements for taking the course.. Value examples: ['NULL', 'CS101'].),\n  (enforced_requirement:text, Any enforced requirements for taking the course.. Value examples: ['NULL', 'NULL'].),\n  (description:text, A brief description of the course content.. Value examples: ['This course introduces the basics of computer science.', 'This course covers advanced topics in calculus.'].),\n  (num_semesters:bigint, The number of semesters the course is offered in a year.. Value examples: ['2', '1'].),\n  (num_enrolled:bigint, The total number of students enrolled in the course.. Value examples: ['2', '3'].),\n  (has_discussion:boolean, Indicates whether the course has any discussion sessions or not.. Value examples: ['true', 'false'].),\n  (has_lab:boolean, Indicates whether the course has any lab sessions or not.. Value examples: ['false', 'false'].),\n  (has_projects:boolean, Indicates whether the course has any projects or not.. Value examples: ['true', 'true'].),\n  (has_exams:boolean, Indicates whether the course has any exams or not.. Value examples: ['false', 'true'].),\n  (num_reviews:bigint, The total number of reviews/ratings for the course.. Value examples: ['10', '5'].),\n  (clarity_score:bigint, The overall clarity score of the course as rated by students.. Value examples: ['5', '4'].),\n  (easiness_score:bigint, The overall easiness score of the course as rated by students.. Value examples: ['3', '2'].),\n  (helpfulness_score:bigint, The overall helpfulness score of the course as rated by students.. Value examples: ['4', '3'].),\n]\n# Table: course_offering\n[\n  (offering_id:bigint, Unique identifier for each course offering. Value examples: ['1', '2', '3'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course is offered. Value examples: ['1', '1', '2'].),\n  (section_number:bigint, The section number of the course. Value examples: ['1', '1', '1'].),\n  (start_time:time, The start time of the course. Value examples: ['08:00:00', '10:00:00', '08:00:00'].),\n  (end_time:time, The end time of the course. Value examples: ['10:00:00', '12:00:00', '10:00:00'].),\n  (monday:text, The instructor's name for Monday. Value examples: ['John Smith', 'NULL', 'John Smith'].),\n  (tuesday:text, The instructor's name for Tuesday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (wednesday:text, The instructor's name for Wednesday. Value examples: ['NULL', 'Gilbert Strang', 'NULL'].),\n  (thursday:text, The instructor's name for Thursday. Value examples: ['Jane Doe', 'NULL', 'Jane Doe'].),\n  (friday:text, The instructor's name for Friday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (saturday:text, The instructor's name for Saturday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (sunday:text, The instructor's name for Sunday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (has_final_project:boolean, Indicates whether the course has a final project. Value examples: ['true', 'true', 'false'].),\n  (has_final_exam:boolean, Indicates whether the course has a final exam. Value examples: ['false', 'true', 'true'].),\n  (textbook:text, The name of the textbook used in the course. Value examples: ['Introduction to Computer Science', 'Advanced Calculus', 'Introduction to Physics'].),\n  (class_address:text, The address of the classroom where the course is held. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (allow_audit:text, Indicates whether auditing the course is allowed. Value examples: ['true', 'false', 'true'].),\n]\n# Table: course_prerequisite\n[\n  (pre_course_id:bigint, The ID of the prerequisite course. Value examples: ['1', '2'].),\n  (course_id:bigint, The ID of the course that has the prerequisite. Value examples: ['2', '3'].),\n]\n# Table: course_tags_count\n[\n  (course_id:bigint, The unique identifier for each course.. Value examples: ['1', '2', '3'].),\n  (clear_grading:bigint, Number of students who found the grading criteria clear and easy to understand.. Value examples: ['5', '4', '3'].),\n  (pop_quiz:bigint, Number of pop quizzes given during the course.. Value examples: ['2', '1', '2'].),\n  (group_projects:bigint, Number of group projects assigned during the course.. Value examples: ['3', '2', '1'].),\n  (inspirational:bigint, Number of students who found the course content inspirational.. Value examples: ['4', '3', '2'].),\n  (long_lectures:bigint, Number of students who found the lectures to be too long.. Value examples: ['2', '1', '3'].),\n  (extra_credit:bigint, Number of extra credit opportunities provided during the course.. Value examples: ['1', '2', '1'].),\n  (few_tests:bigint, Number of tests given during the course.. Value examples: ['3', '2', '1'].),\n  (good_feedback:bigint, Number of students who received good feedback from the instructor.. Value examples: ['4', '3', '2'].),\n  (tough_tests:bigint, Number of students who found the tests to be tough.. Value examples: ['2', '1', '3'].),\n  (heavy_papers:bigint, Number of papers assigned during the course.. Value examples: ['1', '2', '1'].),\n  (cares_for_students:bigint, Number of students who felt that the instructor cared for their well-being.. Value examples: ['5', '4', '3'].),\n  (heavy_assignments:bigint, Number of assignments given during the course.. Value examples: ['3', '2', '1'].),\n  (respected:bigint, Number of students who respected the instructor.. Value examples: ['4', '3', '2'].),\n  (participation:bigint, Number of students who participated actively in the course.. Value examples: ['2', '1', '3'].),\n  (heavy_reading:bigint, Number of reading assignments given during the course.. Value examples: ['1', '2', '1'].),\n  (tough_grader:bigint, Number of students who found the instructor to be a tough grader.. Value examples: ['5', '4', '3'].),\n  (hilarious:bigint, Number of students who found the instructor to be hilarious.. Value examples: ['3', '2', '1'].),\n  (would_take_again:bigint, Number of students who would take the course again.. Value examples: ['4', '3', '2'].),\n  (good_lecture:bigint, Number of students who found the lectures to be good.. Value examples: ['2', '1', '3'].),\n  (no_skip:bigint, Number of students who did not skip any classes during the course.. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: instructor\n[\n  (instructor_id:bigint, Unique identifier for each instructor. Value examples: ['1', '2'].),\n  (name:text, Name of the instructor. Value examples: ['John Smith', 'Jane Doe'].),\n  (uniqname:text, Unique name of the instructor used for login and identification purposes. Value examples: ['jsmith', 'jdoe'].),\n]\n# Table: offering_instructor\n[\n  (offering_instructor_id:bigint, Unique identifier for each offering-instructor pair. Value examples: ['1', '2', '3'].),\n  (offering_id:bigint, Foreign key referencing the offering table. Value examples: ['1', '1', '2'].),\n  (instructor_id:bigint, Foreign key referencing the instructor table. Value examples: ['1', '2', '3'].),\n]\n# Table: program\n[\n  (program_id:bigint, Unique identifier for each program. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the program, Eg 'Computer Science', 'Physics'. Value examples: ['Computer Science', 'Mathematics', 'Physics'].),\n  (college:text, Name of the college offering the program. Value examples: ['Engineering', 'Arts and Sciences', 'Arts and Sciences'].),\n  (introduction:text, Introduction to the program. Value examples: ['This program focuses on computer science principles and applications.', 'This program provides a comprehensive study of mathematical concepts and theories.', 'This program explores the fundamental principles of physics and their applications.'].),\n]\n# Table: program_course\n[\n  (program_id:bigint, The ID of the program associated with the course. Value examples: ['1', '1'].),\n  (course_id:bigint, The ID of the course. Value examples: ['1', '4'].),\n  (workload:bigint, The workload of the course in hours. Value examples: ['100', '80'].),\n  (category:text, The category of the course. Can only be 'Core' or 'Elective'.. Value examples: ['Core', 'Elective'].),\n]\n# Table: program_requirement\n[\n  (program_id:bigint, Unique identifier for a program. Value examples: ['1', '2', '3'].),\n  (category:text, Category of the program. Value examples: ['Core', 'Core', 'Core'].),\n  (min_credit:bigint, Minimum number of credits required for the program. Value examples: ['120', '90', '200'].),\n  (additional_req:text, Additional requirements for the program, if any. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: semester\n[\n  (semester_id:bigint, Unique identifier for each semester. Sort by this column to get the right year-semester order.. Value examples: ['1', '2', '3', '4'].),\n  (semester:text, The name or identifier for the semester Can only be 'Fall', 'Spring', or 'Summer'. Value examples: ['Fall', 'Spring', 'Summer', 'Fall'].),\n  (year:bigint, The year in which the semester takes place. Value examples: ['2020', '2021', '2021', '2021'].),\n]\n# Table: student\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '2', '3'].),\n  (lastname:text, Last name of the student. Value examples: ['Smith', 'Doe', 'Johnson'].),\n  (firstname:text, First name of the student. Value examples: ['John', 'Jane', 'David'].),\n  (program_id:bigint, Identifier for the program the student is enrolled in. Value examples: ['1', '1', '2'].),\n  (declare_major:text, Major program the student declared. Value examples: ['Computer Science', 'Computer Science', 'Mathematics'].),\n  (total_credit:bigint, Total number of credits earned by the student. Value examples: ['13', '7', '7'].),\n  (total_gpa:numeric, Cumulative GPA of the student. Value examples: ['3.5', '3.2', '3.6'].),\n  (entered_as:text, Status of the student when they entered the program. e.g. 'Freshman', 'Transfer Student'. Value examples: ['Freshman', 'Freshman', 'Freshman'].),\n  (admit_term:date, Term in which the student was admitted. Format is YYYY-MM-DD. Value examples: ['2018-01-01', '2018-01-01', '2019-01-01'].),\n  (predicted_graduation_semester:date, Semester in which the student is predicted to graduate. Format is YYYY-MM-DD. Value examples: ['2022-05-01', '2022-05-01', '2022-05-01'].),\n  (degree:text, Degree program the student is enrolled in. Can only be 'Bachelor of Science' or 'Bachelor of Arts'.. Value examples: ['Bachelor of Science', 'Bachelor of Science', 'Bachelor of Arts'].),\n  (minor:text, Minor program the student is enrolled in. Value examples: ['NULL', 'NULL', 'Mathematics'].),\n  (internship:text, Internship program the student is enrolled in. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: student_record\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '1', '1'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course was taken. Value examples: ['1', '1', '2'].),\n  (grade:text, The grade received for the course. Value examples: ['A', 'A', 'A'].),\n  (how:text, How the student took the course. Can only be 'in-person' or 'online'.. Value examples: ['in-person', 'in-person', 'in-person'].),\n  (transfer_source:text, If the course was transferred from another institution, the name of that institution. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (earn_credit:text, Whether the student earned credit for the course (e.g. Yes, No). Value examples: ['Yes', 'Yes', 'Yes'].),\n  (repeat_term:text, If the student repeated the course, the semester in which it was repeated. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (test_id:text, Unique identifier for each test taken in the course. Value examples: ['1', '1', '1'].),\n  (offering_id:bigint, Unique identifier for each offering of a course. Value examples: ['1', '2', '3'].),\n]\n\n【Foreign keys】\narea.course_id = course.course_id\ncomment_instructor.instructor_id = instructor.instructor_id\ncomment_instructor.student_id = student.student_id\ncourse.course_id = course_offering.course_id\ncourse.course_id = course_prerequisite.course_id\ncourse.course_id = course_tags_count.course_id\ncourse.course_id = program_course.course_id\ncourse.course_id = student_record.course_id\ncourse_offering.offering_id = offering_instructor.offering_id\ncourse_offering.offering_id = student_record.offering_id\ninstructor.instructor_id = offering_instructor.instructor_id\nprogram.program_id = program_course.program_id\nprogram.program_id = program_requirement.program_id\nprogram.program_id = student.program_id\nstudent.student_id = student_record.student_id\n\n【参考信息】\n\n\n【用户问题】\nHow many courses does each department offer?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT course.department, COUNT(DISTINCT course.course_id) AS num_courses FROM course GROUP BY course.department ORDER BY num_courses DESC NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "advising",
    "id": 38,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many courses are offered for each semester id?\n\n【数据库schema】\n【DB_ID】 advising\n【Schema】\n# Table: area\n[\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2'].),\n  (area:text, The area of study for each course. Value examples: ['Computer Science', 'Mathematics'].),\n]\n# Table: comment_instructor\n[\n  (instructor_id:bigint, Unique identifier for the instructor. Value examples: ['1', '2'].),\n  (student_id:bigint, Unique identifier for the student. Value examples: ['1', '2'].),\n  (score:bigint, Score given by the student to the instructor. Value examples: ['5', '4'].),\n  (comment_text:text, Textual comment given by the student about the instructor. Value examples: ['John Smith is a great instructor.', 'Jane Doe explains concepts clearly.'].),\n]\n# Table: course\n[\n  (course_id:bigint, The unique identifier for the course.. Value examples: ['1', '2'].),\n  (name:text, The name of the course.. Value examples: ['Introduction to Computer Science', 'Advanced Calculus'].),\n  (department:text, The department offering the course. Eg 'Mathematics', 'Physics'. Value examples: ['Computer Science', 'Mathematics'].),\n  (number:text, The course number/code.. Value examples: ['CS101', 'MATH201'].),\n  (credits:text, The number of credits awarded for completing the course.. Value examples: ['3', '4'].),\n  (advisory_requirement:text, Any advisory requirements for taking the course.. Value examples: ['NULL', 'CS101'].),\n  (enforced_requirement:text, Any enforced requirements for taking the course.. Value examples: ['NULL', 'NULL'].),\n  (description:text, A brief description of the course content.. Value examples: ['This course introduces the basics of computer science.', 'This course covers advanced topics in calculus.'].),\n  (num_semesters:bigint, The number of semesters the course is offered in a year.. Value examples: ['2', '1'].),\n  (num_enrolled:bigint, The total number of students enrolled in the course.. Value examples: ['2', '3'].),\n  (has_discussion:boolean, Indicates whether the course has any discussion sessions or not.. Value examples: ['true', 'false'].),\n  (has_lab:boolean, Indicates whether the course has any lab sessions or not.. Value examples: ['false', 'false'].),\n  (has_projects:boolean, Indicates whether the course has any projects or not.. Value examples: ['true', 'true'].),\n  (has_exams:boolean, Indicates whether the course has any exams or not.. Value examples: ['false', 'true'].),\n  (num_reviews:bigint, The total number of reviews/ratings for the course.. Value examples: ['10', '5'].),\n  (clarity_score:bigint, The overall clarity score of the course as rated by students.. Value examples: ['5', '4'].),\n  (easiness_score:bigint, The overall easiness score of the course as rated by students.. Value examples: ['3', '2'].),\n  (helpfulness_score:bigint, The overall helpfulness score of the course as rated by students.. Value examples: ['4', '3'].),\n]\n# Table: course_offering\n[\n  (offering_id:bigint, Unique identifier for each course offering. Value examples: ['1', '2', '3'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course is offered. Value examples: ['1', '1', '2'].),\n  (section_number:bigint, The section number of the course. Value examples: ['1', '1', '1'].),\n  (start_time:time, The start time of the course. Value examples: ['08:00:00', '10:00:00', '08:00:00'].),\n  (end_time:time, The end time of the course. Value examples: ['10:00:00', '12:00:00', '10:00:00'].),\n  (monday:text, The instructor's name for Monday. Value examples: ['John Smith', 'NULL', 'John Smith'].),\n  (tuesday:text, The instructor's name for Tuesday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (wednesday:text, The instructor's name for Wednesday. Value examples: ['NULL', 'Gilbert Strang', 'NULL'].),\n  (thursday:text, The instructor's name for Thursday. Value examples: ['Jane Doe', 'NULL', 'Jane Doe'].),\n  (friday:text, The instructor's name for Friday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (saturday:text, The instructor's name for Saturday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (sunday:text, The instructor's name for Sunday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (has_final_project:boolean, Indicates whether the course has a final project. Value examples: ['true', 'true', 'false'].),\n  (has_final_exam:boolean, Indicates whether the course has a final exam. Value examples: ['false', 'true', 'true'].),\n  (textbook:text, The name of the textbook used in the course. Value examples: ['Introduction to Computer Science', 'Advanced Calculus', 'Introduction to Physics'].),\n  (class_address:text, The address of the classroom where the course is held. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (allow_audit:text, Indicates whether auditing the course is allowed. Value examples: ['true', 'false', 'true'].),\n]\n# Table: course_prerequisite\n[\n  (pre_course_id:bigint, The ID of the prerequisite course. Value examples: ['1', '2'].),\n  (course_id:bigint, The ID of the course that has the prerequisite. Value examples: ['2', '3'].),\n]\n# Table: course_tags_count\n[\n  (course_id:bigint, The unique identifier for each course.. Value examples: ['1', '2', '3'].),\n  (clear_grading:bigint, Number of students who found the grading criteria clear and easy to understand.. Value examples: ['5', '4', '3'].),\n  (pop_quiz:bigint, Number of pop quizzes given during the course.. Value examples: ['2', '1', '2'].),\n  (group_projects:bigint, Number of group projects assigned during the course.. Value examples: ['3', '2', '1'].),\n  (inspirational:bigint, Number of students who found the course content inspirational.. Value examples: ['4', '3', '2'].),\n  (long_lectures:bigint, Number of students who found the lectures to be too long.. Value examples: ['2', '1', '3'].),\n  (extra_credit:bigint, Number of extra credit opportunities provided during the course.. Value examples: ['1', '2', '1'].),\n  (few_tests:bigint, Number of tests given during the course.. Value examples: ['3', '2', '1'].),\n  (good_feedback:bigint, Number of students who received good feedback from the instructor.. Value examples: ['4', '3', '2'].),\n  (tough_tests:bigint, Number of students who found the tests to be tough.. Value examples: ['2', '1', '3'].),\n  (heavy_papers:bigint, Number of papers assigned during the course.. Value examples: ['1', '2', '1'].),\n  (cares_for_students:bigint, Number of students who felt that the instructor cared for their well-being.. Value examples: ['5', '4', '3'].),\n  (heavy_assignments:bigint, Number of assignments given during the course.. Value examples: ['3', '2', '1'].),\n  (respected:bigint, Number of students who respected the instructor.. Value examples: ['4', '3', '2'].),\n  (participation:bigint, Number of students who participated actively in the course.. Value examples: ['2', '1', '3'].),\n  (heavy_reading:bigint, Number of reading assignments given during the course.. Value examples: ['1', '2', '1'].),\n  (tough_grader:bigint, Number of students who found the instructor to be a tough grader.. Value examples: ['5', '4', '3'].),\n  (hilarious:bigint, Number of students who found the instructor to be hilarious.. Value examples: ['3', '2', '1'].),\n  (would_take_again:bigint, Number of students who would take the course again.. Value examples: ['4', '3', '2'].),\n  (good_lecture:bigint, Number of students who found the lectures to be good.. Value examples: ['2', '1', '3'].),\n  (no_skip:bigint, Number of students who did not skip any classes during the course.. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: instructor\n[\n  (instructor_id:bigint, Unique identifier for each instructor. Value examples: ['1', '2'].),\n  (name:text, Name of the instructor. Value examples: ['John Smith', 'Jane Doe'].),\n  (uniqname:text, Unique name of the instructor used for login and identification purposes. Value examples: ['jsmith', 'jdoe'].),\n]\n# Table: offering_instructor\n[\n  (offering_instructor_id:bigint, Unique identifier for each offering-instructor pair. Value examples: ['1', '2', '3'].),\n  (offering_id:bigint, Foreign key referencing the offering table. Value examples: ['1', '1', '2'].),\n  (instructor_id:bigint, Foreign key referencing the instructor table. Value examples: ['1', '2', '3'].),\n]\n# Table: program\n[\n  (program_id:bigint, Unique identifier for each program. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the program, Eg 'Computer Science', 'Physics'. Value examples: ['Computer Science', 'Mathematics', 'Physics'].),\n  (college:text, Name of the college offering the program. Value examples: ['Engineering', 'Arts and Sciences', 'Arts and Sciences'].),\n  (introduction:text, Introduction to the program. Value examples: ['This program focuses on computer science principles and applications.', 'This program provides a comprehensive study of mathematical concepts and theories.', 'This program explores the fundamental principles of physics and their applications.'].),\n]\n# Table: program_course\n[\n  (program_id:bigint, The ID of the program associated with the course. Value examples: ['1', '1'].),\n  (course_id:bigint, The ID of the course. Value examples: ['1', '4'].),\n  (workload:bigint, The workload of the course in hours. Value examples: ['100', '80'].),\n  (category:text, The category of the course. Can only be 'Core' or 'Elective'.. Value examples: ['Core', 'Elective'].),\n]\n# Table: program_requirement\n[\n  (program_id:bigint, Unique identifier for a program. Value examples: ['1', '2', '3'].),\n  (category:text, Category of the program. Value examples: ['Core', 'Core', 'Core'].),\n  (min_credit:bigint, Minimum number of credits required for the program. Value examples: ['120', '90', '200'].),\n  (additional_req:text, Additional requirements for the program, if any. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: semester\n[\n  (semester_id:bigint, Unique identifier for each semester. Sort by this column to get the right year-semester order.. Value examples: ['1', '2', '3', '4'].),\n  (semester:text, The name or identifier for the semester Can only be 'Fall', 'Spring', or 'Summer'. Value examples: ['Fall', 'Spring', 'Summer', 'Fall'].),\n  (year:bigint, The year in which the semester takes place. Value examples: ['2020', '2021', '2021', '2021'].),\n]\n# Table: student\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '2', '3'].),\n  (lastname:text, Last name of the student. Value examples: ['Smith', 'Doe', 'Johnson'].),\n  (firstname:text, First name of the student. Value examples: ['John', 'Jane', 'David'].),\n  (program_id:bigint, Identifier for the program the student is enrolled in. Value examples: ['1', '1', '2'].),\n  (declare_major:text, Major program the student declared. Value examples: ['Computer Science', 'Computer Science', 'Mathematics'].),\n  (total_credit:bigint, Total number of credits earned by the student. Value examples: ['13', '7', '7'].),\n  (total_gpa:numeric, Cumulative GPA of the student. Value examples: ['3.5', '3.2', '3.6'].),\n  (entered_as:text, Status of the student when they entered the program. e.g. 'Freshman', 'Transfer Student'. Value examples: ['Freshman', 'Freshman', 'Freshman'].),\n  (admit_term:date, Term in which the student was admitted. Format is YYYY-MM-DD. Value examples: ['2018-01-01', '2018-01-01', '2019-01-01'].),\n  (predicted_graduation_semester:date, Semester in which the student is predicted to graduate. Format is YYYY-MM-DD. Value examples: ['2022-05-01', '2022-05-01', '2022-05-01'].),\n  (degree:text, Degree program the student is enrolled in. Can only be 'Bachelor of Science' or 'Bachelor of Arts'.. Value examples: ['Bachelor of Science', 'Bachelor of Science', 'Bachelor of Arts'].),\n  (minor:text, Minor program the student is enrolled in. Value examples: ['NULL', 'NULL', 'Mathematics'].),\n  (internship:text, Internship program the student is enrolled in. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: student_record\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '1', '1'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course was taken. Value examples: ['1', '1', '2'].),\n  (grade:text, The grade received for the course. Value examples: ['A', 'A', 'A'].),\n  (how:text, How the student took the course. Can only be 'in-person' or 'online'.. Value examples: ['in-person', 'in-person', 'in-person'].),\n  (transfer_source:text, If the course was transferred from another institution, the name of that institution. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (earn_credit:text, Whether the student earned credit for the course (e.g. Yes, No). Value examples: ['Yes', 'Yes', 'Yes'].),\n  (repeat_term:text, If the student repeated the course, the semester in which it was repeated. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (test_id:text, Unique identifier for each test taken in the course. Value examples: ['1', '1', '1'].),\n  (offering_id:bigint, Unique identifier for each offering of a course. Value examples: ['1', '2', '3'].),\n]\n\n【Foreign keys】\narea.course_id = course.course_id\ncomment_instructor.instructor_id = instructor.instructor_id\ncomment_instructor.student_id = student.student_id\ncourse.course_id = course_offering.course_id\ncourse.course_id = course_prerequisite.course_id\ncourse.course_id = course_tags_count.course_id\ncourse.course_id = program_course.course_id\ncourse.course_id = student_record.course_id\ncourse_offering.offering_id = offering_instructor.offering_id\ncourse_offering.offering_id = student_record.offering_id\ninstructor.instructor_id = offering_instructor.instructor_id\nprogram.program_id = program_course.program_id\nprogram.program_id = program_requirement.program_id\nprogram.program_id = student.program_id\nstudent.student_id = student_record.student_id\n\n【参考信息】\n\n\n【用户问题】\nHow many courses are offered for each semester id?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT course_offering.semester, COUNT(DISTINCT course_offering.course_id) AS num_courses FROM course_offering GROUP BY course_offering.semester ORDER BY course_offering.semester;SELECT semester.semester_id, COUNT(DISTINCT course_offering.course_id) AS num_courses FROM semester LEFT JOIN course_offering ON semester.semester_id = course_offering.semester GROUP BY semester.semester_id;",
        "role": "assistant"
      }
    ],
    "db_name": "advising",
    "id": 39,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich course has the highest number of enrolled students, and what is the enrollment number?\n\n【数据库schema】\n【DB_ID】 advising\n【Schema】\n# Table: area\n[\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2'].),\n  (area:text, The area of study for each course. Value examples: ['Computer Science', 'Mathematics'].),\n]\n# Table: comment_instructor\n[\n  (instructor_id:bigint, Unique identifier for the instructor. Value examples: ['1', '2'].),\n  (student_id:bigint, Unique identifier for the student. Value examples: ['1', '2'].),\n  (score:bigint, Score given by the student to the instructor. Value examples: ['5', '4'].),\n  (comment_text:text, Textual comment given by the student about the instructor. Value examples: ['John Smith is a great instructor.', 'Jane Doe explains concepts clearly.'].),\n]\n# Table: course\n[\n  (course_id:bigint, The unique identifier for the course.. Value examples: ['1', '2'].),\n  (name:text, The name of the course.. Value examples: ['Introduction to Computer Science', 'Advanced Calculus'].),\n  (department:text, The department offering the course. Eg 'Mathematics', 'Physics'. Value examples: ['Computer Science', 'Mathematics'].),\n  (number:text, The course number/code.. Value examples: ['CS101', 'MATH201'].),\n  (credits:text, The number of credits awarded for completing the course.. Value examples: ['3', '4'].),\n  (advisory_requirement:text, Any advisory requirements for taking the course.. Value examples: ['NULL', 'CS101'].),\n  (enforced_requirement:text, Any enforced requirements for taking the course.. Value examples: ['NULL', 'NULL'].),\n  (description:text, A brief description of the course content.. Value examples: ['This course introduces the basics of computer science.', 'This course covers advanced topics in calculus.'].),\n  (num_semesters:bigint, The number of semesters the course is offered in a year.. Value examples: ['2', '1'].),\n  (num_enrolled:bigint, The total number of students enrolled in the course.. Value examples: ['2', '3'].),\n  (has_discussion:boolean, Indicates whether the course has any discussion sessions or not.. Value examples: ['true', 'false'].),\n  (has_lab:boolean, Indicates whether the course has any lab sessions or not.. Value examples: ['false', 'false'].),\n  (has_projects:boolean, Indicates whether the course has any projects or not.. Value examples: ['true', 'true'].),\n  (has_exams:boolean, Indicates whether the course has any exams or not.. Value examples: ['false', 'true'].),\n  (num_reviews:bigint, The total number of reviews/ratings for the course.. Value examples: ['10', '5'].),\n  (clarity_score:bigint, The overall clarity score of the course as rated by students.. Value examples: ['5', '4'].),\n  (easiness_score:bigint, The overall easiness score of the course as rated by students.. Value examples: ['3', '2'].),\n  (helpfulness_score:bigint, The overall helpfulness score of the course as rated by students.. Value examples: ['4', '3'].),\n]\n# Table: course_offering\n[\n  (offering_id:bigint, Unique identifier for each course offering. Value examples: ['1', '2', '3'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course is offered. Value examples: ['1', '1', '2'].),\n  (section_number:bigint, The section number of the course. Value examples: ['1', '1', '1'].),\n  (start_time:time, The start time of the course. Value examples: ['08:00:00', '10:00:00', '08:00:00'].),\n  (end_time:time, The end time of the course. Value examples: ['10:00:00', '12:00:00', '10:00:00'].),\n  (monday:text, The instructor's name for Monday. Value examples: ['John Smith', 'NULL', 'John Smith'].),\n  (tuesday:text, The instructor's name for Tuesday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (wednesday:text, The instructor's name for Wednesday. Value examples: ['NULL', 'Gilbert Strang', 'NULL'].),\n  (thursday:text, The instructor's name for Thursday. Value examples: ['Jane Doe', 'NULL', 'Jane Doe'].),\n  (friday:text, The instructor's name for Friday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (saturday:text, The instructor's name for Saturday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (sunday:text, The instructor's name for Sunday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (has_final_project:boolean, Indicates whether the course has a final project. Value examples: ['true', 'true', 'false'].),\n  (has_final_exam:boolean, Indicates whether the course has a final exam. Value examples: ['false', 'true', 'true'].),\n  (textbook:text, The name of the textbook used in the course. Value examples: ['Introduction to Computer Science', 'Advanced Calculus', 'Introduction to Physics'].),\n  (class_address:text, The address of the classroom where the course is held. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (allow_audit:text, Indicates whether auditing the course is allowed. Value examples: ['true', 'false', 'true'].),\n]\n# Table: course_prerequisite\n[\n  (pre_course_id:bigint, The ID of the prerequisite course. Value examples: ['1', '2'].),\n  (course_id:bigint, The ID of the course that has the prerequisite. Value examples: ['2', '3'].),\n]\n# Table: course_tags_count\n[\n  (course_id:bigint, The unique identifier for each course.. Value examples: ['1', '2', '3'].),\n  (clear_grading:bigint, Number of students who found the grading criteria clear and easy to understand.. Value examples: ['5', '4', '3'].),\n  (pop_quiz:bigint, Number of pop quizzes given during the course.. Value examples: ['2', '1', '2'].),\n  (group_projects:bigint, Number of group projects assigned during the course.. Value examples: ['3', '2', '1'].),\n  (inspirational:bigint, Number of students who found the course content inspirational.. Value examples: ['4', '3', '2'].),\n  (long_lectures:bigint, Number of students who found the lectures to be too long.. Value examples: ['2', '1', '3'].),\n  (extra_credit:bigint, Number of extra credit opportunities provided during the course.. Value examples: ['1', '2', '1'].),\n  (few_tests:bigint, Number of tests given during the course.. Value examples: ['3', '2', '1'].),\n  (good_feedback:bigint, Number of students who received good feedback from the instructor.. Value examples: ['4', '3', '2'].),\n  (tough_tests:bigint, Number of students who found the tests to be tough.. Value examples: ['2', '1', '3'].),\n  (heavy_papers:bigint, Number of papers assigned during the course.. Value examples: ['1', '2', '1'].),\n  (cares_for_students:bigint, Number of students who felt that the instructor cared for their well-being.. Value examples: ['5', '4', '3'].),\n  (heavy_assignments:bigint, Number of assignments given during the course.. Value examples: ['3', '2', '1'].),\n  (respected:bigint, Number of students who respected the instructor.. Value examples: ['4', '3', '2'].),\n  (participation:bigint, Number of students who participated actively in the course.. Value examples: ['2', '1', '3'].),\n  (heavy_reading:bigint, Number of reading assignments given during the course.. Value examples: ['1', '2', '1'].),\n  (tough_grader:bigint, Number of students who found the instructor to be a tough grader.. Value examples: ['5', '4', '3'].),\n  (hilarious:bigint, Number of students who found the instructor to be hilarious.. Value examples: ['3', '2', '1'].),\n  (would_take_again:bigint, Number of students who would take the course again.. Value examples: ['4', '3', '2'].),\n  (good_lecture:bigint, Number of students who found the lectures to be good.. Value examples: ['2', '1', '3'].),\n  (no_skip:bigint, Number of students who did not skip any classes during the course.. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: instructor\n[\n  (instructor_id:bigint, Unique identifier for each instructor. Value examples: ['1', '2'].),\n  (name:text, Name of the instructor. Value examples: ['John Smith', 'Jane Doe'].),\n  (uniqname:text, Unique name of the instructor used for login and identification purposes. Value examples: ['jsmith', 'jdoe'].),\n]\n# Table: offering_instructor\n[\n  (offering_instructor_id:bigint, Unique identifier for each offering-instructor pair. Value examples: ['1', '2', '3'].),\n  (offering_id:bigint, Foreign key referencing the offering table. Value examples: ['1', '1', '2'].),\n  (instructor_id:bigint, Foreign key referencing the instructor table. Value examples: ['1', '2', '3'].),\n]\n# Table: program\n[\n  (program_id:bigint, Unique identifier for each program. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the program, Eg 'Computer Science', 'Physics'. Value examples: ['Computer Science', 'Mathematics', 'Physics'].),\n  (college:text, Name of the college offering the program. Value examples: ['Engineering', 'Arts and Sciences', 'Arts and Sciences'].),\n  (introduction:text, Introduction to the program. Value examples: ['This program focuses on computer science principles and applications.', 'This program provides a comprehensive study of mathematical concepts and theories.', 'This program explores the fundamental principles of physics and their applications.'].),\n]\n# Table: program_course\n[\n  (program_id:bigint, The ID of the program associated with the course. Value examples: ['1', '1'].),\n  (course_id:bigint, The ID of the course. Value examples: ['1', '4'].),\n  (workload:bigint, The workload of the course in hours. Value examples: ['100', '80'].),\n  (category:text, The category of the course. Can only be 'Core' or 'Elective'.. Value examples: ['Core', 'Elective'].),\n]\n# Table: program_requirement\n[\n  (program_id:bigint, Unique identifier for a program. Value examples: ['1', '2', '3'].),\n  (category:text, Category of the program. Value examples: ['Core', 'Core', 'Core'].),\n  (min_credit:bigint, Minimum number of credits required for the program. Value examples: ['120', '90', '200'].),\n  (additional_req:text, Additional requirements for the program, if any. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: semester\n[\n  (semester_id:bigint, Unique identifier for each semester. Sort by this column to get the right year-semester order.. Value examples: ['1', '2', '3', '4'].),\n  (semester:text, The name or identifier for the semester Can only be 'Fall', 'Spring', or 'Summer'. Value examples: ['Fall', 'Spring', 'Summer', 'Fall'].),\n  (year:bigint, The year in which the semester takes place. Value examples: ['2020', '2021', '2021', '2021'].),\n]\n# Table: student\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '2', '3'].),\n  (lastname:text, Last name of the student. Value examples: ['Smith', 'Doe', 'Johnson'].),\n  (firstname:text, First name of the student. Value examples: ['John', 'Jane', 'David'].),\n  (program_id:bigint, Identifier for the program the student is enrolled in. Value examples: ['1', '1', '2'].),\n  (declare_major:text, Major program the student declared. Value examples: ['Computer Science', 'Computer Science', 'Mathematics'].),\n  (total_credit:bigint, Total number of credits earned by the student. Value examples: ['13', '7', '7'].),\n  (total_gpa:numeric, Cumulative GPA of the student. Value examples: ['3.5', '3.2', '3.6'].),\n  (entered_as:text, Status of the student when they entered the program. e.g. 'Freshman', 'Transfer Student'. Value examples: ['Freshman', 'Freshman', 'Freshman'].),\n  (admit_term:date, Term in which the student was admitted. Format is YYYY-MM-DD. Value examples: ['2018-01-01', '2018-01-01', '2019-01-01'].),\n  (predicted_graduation_semester:date, Semester in which the student is predicted to graduate. Format is YYYY-MM-DD. Value examples: ['2022-05-01', '2022-05-01', '2022-05-01'].),\n  (degree:text, Degree program the student is enrolled in. Can only be 'Bachelor of Science' or 'Bachelor of Arts'.. Value examples: ['Bachelor of Science', 'Bachelor of Science', 'Bachelor of Arts'].),\n  (minor:text, Minor program the student is enrolled in. Value examples: ['NULL', 'NULL', 'Mathematics'].),\n  (internship:text, Internship program the student is enrolled in. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: student_record\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '1', '1'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course was taken. Value examples: ['1', '1', '2'].),\n  (grade:text, The grade received for the course. Value examples: ['A', 'A', 'A'].),\n  (how:text, How the student took the course. Can only be 'in-person' or 'online'.. Value examples: ['in-person', 'in-person', 'in-person'].),\n  (transfer_source:text, If the course was transferred from another institution, the name of that institution. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (earn_credit:text, Whether the student earned credit for the course (e.g. Yes, No). Value examples: ['Yes', 'Yes', 'Yes'].),\n  (repeat_term:text, If the student repeated the course, the semester in which it was repeated. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (test_id:text, Unique identifier for each test taken in the course. Value examples: ['1', '1', '1'].),\n  (offering_id:bigint, Unique identifier for each offering of a course. Value examples: ['1', '2', '3'].),\n]\n\n【Foreign keys】\narea.course_id = course.course_id\ncomment_instructor.instructor_id = instructor.instructor_id\ncomment_instructor.student_id = student.student_id\ncourse.course_id = course_offering.course_id\ncourse.course_id = course_prerequisite.course_id\ncourse.course_id = course_tags_count.course_id\ncourse.course_id = program_course.course_id\ncourse.course_id = student_record.course_id\ncourse_offering.offering_id = offering_instructor.offering_id\ncourse_offering.offering_id = student_record.offering_id\ninstructor.instructor_id = offering_instructor.instructor_id\nprogram.program_id = program_course.program_id\nprogram.program_id = program_requirement.program_id\nprogram.program_id = student.program_id\nstudent.student_id = student_record.student_id\n\n【参考信息】\n\n\n【用户问题】\nWhich course has the highest number of enrolled students, and what is the enrollment number?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT course.name, course.course_id, course.number, course.num_enrolled FROM course ORDER BY course.num_enrolled DESC NULLS LAST LIMIT 1",
        "role": "assistant"
      }
    ],
    "db_name": "advising",
    "id": 40,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the total number of students who participated actively for each course id, ordered from highest to lowest participants?\n\n【数据库schema】\n【DB_ID】 advising\n【Schema】\n# Table: area\n[\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2'].),\n  (area:text, The area of study for each course. Value examples: ['Computer Science', 'Mathematics'].),\n]\n# Table: comment_instructor\n[\n  (instructor_id:bigint, Unique identifier for the instructor. Value examples: ['1', '2'].),\n  (student_id:bigint, Unique identifier for the student. Value examples: ['1', '2'].),\n  (score:bigint, Score given by the student to the instructor. Value examples: ['5', '4'].),\n  (comment_text:text, Textual comment given by the student about the instructor. Value examples: ['John Smith is a great instructor.', 'Jane Doe explains concepts clearly.'].),\n]\n# Table: course\n[\n  (course_id:bigint, The unique identifier for the course.. Value examples: ['1', '2'].),\n  (name:text, The name of the course.. Value examples: ['Introduction to Computer Science', 'Advanced Calculus'].),\n  (department:text, The department offering the course. Eg 'Mathematics', 'Physics'. Value examples: ['Computer Science', 'Mathematics'].),\n  (number:text, The course number/code.. Value examples: ['CS101', 'MATH201'].),\n  (credits:text, The number of credits awarded for completing the course.. Value examples: ['3', '4'].),\n  (advisory_requirement:text, Any advisory requirements for taking the course.. Value examples: ['NULL', 'CS101'].),\n  (enforced_requirement:text, Any enforced requirements for taking the course.. Value examples: ['NULL', 'NULL'].),\n  (description:text, A brief description of the course content.. Value examples: ['This course introduces the basics of computer science.', 'This course covers advanced topics in calculus.'].),\n  (num_semesters:bigint, The number of semesters the course is offered in a year.. Value examples: ['2', '1'].),\n  (num_enrolled:bigint, The total number of students enrolled in the course.. Value examples: ['2', '3'].),\n  (has_discussion:boolean, Indicates whether the course has any discussion sessions or not.. Value examples: ['true', 'false'].),\n  (has_lab:boolean, Indicates whether the course has any lab sessions or not.. Value examples: ['false', 'false'].),\n  (has_projects:boolean, Indicates whether the course has any projects or not.. Value examples: ['true', 'true'].),\n  (has_exams:boolean, Indicates whether the course has any exams or not.. Value examples: ['false', 'true'].),\n  (num_reviews:bigint, The total number of reviews/ratings for the course.. Value examples: ['10', '5'].),\n  (clarity_score:bigint, The overall clarity score of the course as rated by students.. Value examples: ['5', '4'].),\n  (easiness_score:bigint, The overall easiness score of the course as rated by students.. Value examples: ['3', '2'].),\n  (helpfulness_score:bigint, The overall helpfulness score of the course as rated by students.. Value examples: ['4', '3'].),\n]\n# Table: course_offering\n[\n  (offering_id:bigint, Unique identifier for each course offering. Value examples: ['1', '2', '3'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course is offered. Value examples: ['1', '1', '2'].),\n  (section_number:bigint, The section number of the course. Value examples: ['1', '1', '1'].),\n  (start_time:time, The start time of the course. Value examples: ['08:00:00', '10:00:00', '08:00:00'].),\n  (end_time:time, The end time of the course. Value examples: ['10:00:00', '12:00:00', '10:00:00'].),\n  (monday:text, The instructor's name for Monday. Value examples: ['John Smith', 'NULL', 'John Smith'].),\n  (tuesday:text, The instructor's name for Tuesday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (wednesday:text, The instructor's name for Wednesday. Value examples: ['NULL', 'Gilbert Strang', 'NULL'].),\n  (thursday:text, The instructor's name for Thursday. Value examples: ['Jane Doe', 'NULL', 'Jane Doe'].),\n  (friday:text, The instructor's name for Friday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (saturday:text, The instructor's name for Saturday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (sunday:text, The instructor's name for Sunday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (has_final_project:boolean, Indicates whether the course has a final project. Value examples: ['true', 'true', 'false'].),\n  (has_final_exam:boolean, Indicates whether the course has a final exam. Value examples: ['false', 'true', 'true'].),\n  (textbook:text, The name of the textbook used in the course. Value examples: ['Introduction to Computer Science', 'Advanced Calculus', 'Introduction to Physics'].),\n  (class_address:text, The address of the classroom where the course is held. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (allow_audit:text, Indicates whether auditing the course is allowed. Value examples: ['true', 'false', 'true'].),\n]\n# Table: course_prerequisite\n[\n  (pre_course_id:bigint, The ID of the prerequisite course. Value examples: ['1', '2'].),\n  (course_id:bigint, The ID of the course that has the prerequisite. Value examples: ['2', '3'].),\n]\n# Table: course_tags_count\n[\n  (course_id:bigint, The unique identifier for each course.. Value examples: ['1', '2', '3'].),\n  (clear_grading:bigint, Number of students who found the grading criteria clear and easy to understand.. Value examples: ['5', '4', '3'].),\n  (pop_quiz:bigint, Number of pop quizzes given during the course.. Value examples: ['2', '1', '2'].),\n  (group_projects:bigint, Number of group projects assigned during the course.. Value examples: ['3', '2', '1'].),\n  (inspirational:bigint, Number of students who found the course content inspirational.. Value examples: ['4', '3', '2'].),\n  (long_lectures:bigint, Number of students who found the lectures to be too long.. Value examples: ['2', '1', '3'].),\n  (extra_credit:bigint, Number of extra credit opportunities provided during the course.. Value examples: ['1', '2', '1'].),\n  (few_tests:bigint, Number of tests given during the course.. Value examples: ['3', '2', '1'].),\n  (good_feedback:bigint, Number of students who received good feedback from the instructor.. Value examples: ['4', '3', '2'].),\n  (tough_tests:bigint, Number of students who found the tests to be tough.. Value examples: ['2', '1', '3'].),\n  (heavy_papers:bigint, Number of papers assigned during the course.. Value examples: ['1', '2', '1'].),\n  (cares_for_students:bigint, Number of students who felt that the instructor cared for their well-being.. Value examples: ['5', '4', '3'].),\n  (heavy_assignments:bigint, Number of assignments given during the course.. Value examples: ['3', '2', '1'].),\n  (respected:bigint, Number of students who respected the instructor.. Value examples: ['4', '3', '2'].),\n  (participation:bigint, Number of students who participated actively in the course.. Value examples: ['2', '1', '3'].),\n  (heavy_reading:bigint, Number of reading assignments given during the course.. Value examples: ['1', '2', '1'].),\n  (tough_grader:bigint, Number of students who found the instructor to be a tough grader.. Value examples: ['5', '4', '3'].),\n  (hilarious:bigint, Number of students who found the instructor to be hilarious.. Value examples: ['3', '2', '1'].),\n  (would_take_again:bigint, Number of students who would take the course again.. Value examples: ['4', '3', '2'].),\n  (good_lecture:bigint, Number of students who found the lectures to be good.. Value examples: ['2', '1', '3'].),\n  (no_skip:bigint, Number of students who did not skip any classes during the course.. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: instructor\n[\n  (instructor_id:bigint, Unique identifier for each instructor. Value examples: ['1', '2'].),\n  (name:text, Name of the instructor. Value examples: ['John Smith', 'Jane Doe'].),\n  (uniqname:text, Unique name of the instructor used for login and identification purposes. Value examples: ['jsmith', 'jdoe'].),\n]\n# Table: offering_instructor\n[\n  (offering_instructor_id:bigint, Unique identifier for each offering-instructor pair. Value examples: ['1', '2', '3'].),\n  (offering_id:bigint, Foreign key referencing the offering table. Value examples: ['1', '1', '2'].),\n  (instructor_id:bigint, Foreign key referencing the instructor table. Value examples: ['1', '2', '3'].),\n]\n# Table: program\n[\n  (program_id:bigint, Unique identifier for each program. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the program, Eg 'Computer Science', 'Physics'. Value examples: ['Computer Science', 'Mathematics', 'Physics'].),\n  (college:text, Name of the college offering the program. Value examples: ['Engineering', 'Arts and Sciences', 'Arts and Sciences'].),\n  (introduction:text, Introduction to the program. Value examples: ['This program focuses on computer science principles and applications.', 'This program provides a comprehensive study of mathematical concepts and theories.', 'This program explores the fundamental principles of physics and their applications.'].),\n]\n# Table: program_course\n[\n  (program_id:bigint, The ID of the program associated with the course. Value examples: ['1', '1'].),\n  (course_id:bigint, The ID of the course. Value examples: ['1', '4'].),\n  (workload:bigint, The workload of the course in hours. Value examples: ['100', '80'].),\n  (category:text, The category of the course. Can only be 'Core' or 'Elective'.. Value examples: ['Core', 'Elective'].),\n]\n# Table: program_requirement\n[\n  (program_id:bigint, Unique identifier for a program. Value examples: ['1', '2', '3'].),\n  (category:text, Category of the program. Value examples: ['Core', 'Core', 'Core'].),\n  (min_credit:bigint, Minimum number of credits required for the program. Value examples: ['120', '90', '200'].),\n  (additional_req:text, Additional requirements for the program, if any. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: semester\n[\n  (semester_id:bigint, Unique identifier for each semester. Sort by this column to get the right year-semester order.. Value examples: ['1', '2', '3', '4'].),\n  (semester:text, The name or identifier for the semester Can only be 'Fall', 'Spring', or 'Summer'. Value examples: ['Fall', 'Spring', 'Summer', 'Fall'].),\n  (year:bigint, The year in which the semester takes place. Value examples: ['2020', '2021', '2021', '2021'].),\n]\n# Table: student\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '2', '3'].),\n  (lastname:text, Last name of the student. Value examples: ['Smith', 'Doe', 'Johnson'].),\n  (firstname:text, First name of the student. Value examples: ['John', 'Jane', 'David'].),\n  (program_id:bigint, Identifier for the program the student is enrolled in. Value examples: ['1', '1', '2'].),\n  (declare_major:text, Major program the student declared. Value examples: ['Computer Science', 'Computer Science', 'Mathematics'].),\n  (total_credit:bigint, Total number of credits earned by the student. Value examples: ['13', '7', '7'].),\n  (total_gpa:numeric, Cumulative GPA of the student. Value examples: ['3.5', '3.2', '3.6'].),\n  (entered_as:text, Status of the student when they entered the program. e.g. 'Freshman', 'Transfer Student'. Value examples: ['Freshman', 'Freshman', 'Freshman'].),\n  (admit_term:date, Term in which the student was admitted. Format is YYYY-MM-DD. Value examples: ['2018-01-01', '2018-01-01', '2019-01-01'].),\n  (predicted_graduation_semester:date, Semester in which the student is predicted to graduate. Format is YYYY-MM-DD. Value examples: ['2022-05-01', '2022-05-01', '2022-05-01'].),\n  (degree:text, Degree program the student is enrolled in. Can only be 'Bachelor of Science' or 'Bachelor of Arts'.. Value examples: ['Bachelor of Science', 'Bachelor of Science', 'Bachelor of Arts'].),\n  (minor:text, Minor program the student is enrolled in. Value examples: ['NULL', 'NULL', 'Mathematics'].),\n  (internship:text, Internship program the student is enrolled in. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: student_record\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '1', '1'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course was taken. Value examples: ['1', '1', '2'].),\n  (grade:text, The grade received for the course. Value examples: ['A', 'A', 'A'].),\n  (how:text, How the student took the course. Can only be 'in-person' or 'online'.. Value examples: ['in-person', 'in-person', 'in-person'].),\n  (transfer_source:text, If the course was transferred from another institution, the name of that institution. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (earn_credit:text, Whether the student earned credit for the course (e.g. Yes, No). Value examples: ['Yes', 'Yes', 'Yes'].),\n  (repeat_term:text, If the student repeated the course, the semester in which it was repeated. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (test_id:text, Unique identifier for each test taken in the course. Value examples: ['1', '1', '1'].),\n  (offering_id:bigint, Unique identifier for each offering of a course. Value examples: ['1', '2', '3'].),\n]\n\n【Foreign keys】\narea.course_id = course.course_id\ncomment_instructor.instructor_id = instructor.instructor_id\ncomment_instructor.student_id = student.student_id\ncourse.course_id = course_offering.course_id\ncourse.course_id = course_prerequisite.course_id\ncourse.course_id = course_tags_count.course_id\ncourse.course_id = program_course.course_id\ncourse.course_id = student_record.course_id\ncourse_offering.offering_id = offering_instructor.offering_id\ncourse_offering.offering_id = student_record.offering_id\ninstructor.instructor_id = offering_instructor.instructor_id\nprogram.program_id = program_course.program_id\nprogram.program_id = program_requirement.program_id\nprogram.program_id = student.program_id\nstudent.student_id = student_record.student_id\n\n【参考信息】\n\n\n【用户问题】\nWhat is the total number of students who participated actively for each course id, ordered from highest to lowest participants?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT course_tags_count.course_id, course_tags_count.participation FROM course_tags_count ORDER BY course_tags_count.participation DESC NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "advising",
    "id": 41,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the total number of students enrolled in each course, ordered from highest to lowest?\n\n【数据库schema】\n【DB_ID】 advising\n【Schema】\n# Table: area\n[\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2'].),\n  (area:text, The area of study for each course. Value examples: ['Computer Science', 'Mathematics'].),\n]\n# Table: comment_instructor\n[\n  (instructor_id:bigint, Unique identifier for the instructor. Value examples: ['1', '2'].),\n  (student_id:bigint, Unique identifier for the student. Value examples: ['1', '2'].),\n  (score:bigint, Score given by the student to the instructor. Value examples: ['5', '4'].),\n  (comment_text:text, Textual comment given by the student about the instructor. Value examples: ['John Smith is a great instructor.', 'Jane Doe explains concepts clearly.'].),\n]\n# Table: course\n[\n  (course_id:bigint, The unique identifier for the course.. Value examples: ['1', '2'].),\n  (name:text, The name of the course.. Value examples: ['Introduction to Computer Science', 'Advanced Calculus'].),\n  (department:text, The department offering the course. Eg 'Mathematics', 'Physics'. Value examples: ['Computer Science', 'Mathematics'].),\n  (number:text, The course number/code.. Value examples: ['CS101', 'MATH201'].),\n  (credits:text, The number of credits awarded for completing the course.. Value examples: ['3', '4'].),\n  (advisory_requirement:text, Any advisory requirements for taking the course.. Value examples: ['NULL', 'CS101'].),\n  (enforced_requirement:text, Any enforced requirements for taking the course.. Value examples: ['NULL', 'NULL'].),\n  (description:text, A brief description of the course content.. Value examples: ['This course introduces the basics of computer science.', 'This course covers advanced topics in calculus.'].),\n  (num_semesters:bigint, The number of semesters the course is offered in a year.. Value examples: ['2', '1'].),\n  (num_enrolled:bigint, The total number of students enrolled in the course.. Value examples: ['2', '3'].),\n  (has_discussion:boolean, Indicates whether the course has any discussion sessions or not.. Value examples: ['true', 'false'].),\n  (has_lab:boolean, Indicates whether the course has any lab sessions or not.. Value examples: ['false', 'false'].),\n  (has_projects:boolean, Indicates whether the course has any projects or not.. Value examples: ['true', 'true'].),\n  (has_exams:boolean, Indicates whether the course has any exams or not.. Value examples: ['false', 'true'].),\n  (num_reviews:bigint, The total number of reviews/ratings for the course.. Value examples: ['10', '5'].),\n  (clarity_score:bigint, The overall clarity score of the course as rated by students.. Value examples: ['5', '4'].),\n  (easiness_score:bigint, The overall easiness score of the course as rated by students.. Value examples: ['3', '2'].),\n  (helpfulness_score:bigint, The overall helpfulness score of the course as rated by students.. Value examples: ['4', '3'].),\n]\n# Table: course_offering\n[\n  (offering_id:bigint, Unique identifier for each course offering. Value examples: ['1', '2', '3'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course is offered. Value examples: ['1', '1', '2'].),\n  (section_number:bigint, The section number of the course. Value examples: ['1', '1', '1'].),\n  (start_time:time, The start time of the course. Value examples: ['08:00:00', '10:00:00', '08:00:00'].),\n  (end_time:time, The end time of the course. Value examples: ['10:00:00', '12:00:00', '10:00:00'].),\n  (monday:text, The instructor's name for Monday. Value examples: ['John Smith', 'NULL', 'John Smith'].),\n  (tuesday:text, The instructor's name for Tuesday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (wednesday:text, The instructor's name for Wednesday. Value examples: ['NULL', 'Gilbert Strang', 'NULL'].),\n  (thursday:text, The instructor's name for Thursday. Value examples: ['Jane Doe', 'NULL', 'Jane Doe'].),\n  (friday:text, The instructor's name for Friday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (saturday:text, The instructor's name for Saturday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (sunday:text, The instructor's name for Sunday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (has_final_project:boolean, Indicates whether the course has a final project. Value examples: ['true', 'true', 'false'].),\n  (has_final_exam:boolean, Indicates whether the course has a final exam. Value examples: ['false', 'true', 'true'].),\n  (textbook:text, The name of the textbook used in the course. Value examples: ['Introduction to Computer Science', 'Advanced Calculus', 'Introduction to Physics'].),\n  (class_address:text, The address of the classroom where the course is held. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (allow_audit:text, Indicates whether auditing the course is allowed. Value examples: ['true', 'false', 'true'].),\n]\n# Table: course_prerequisite\n[\n  (pre_course_id:bigint, The ID of the prerequisite course. Value examples: ['1', '2'].),\n  (course_id:bigint, The ID of the course that has the prerequisite. Value examples: ['2', '3'].),\n]\n# Table: course_tags_count\n[\n  (course_id:bigint, The unique identifier for each course.. Value examples: ['1', '2', '3'].),\n  (clear_grading:bigint, Number of students who found the grading criteria clear and easy to understand.. Value examples: ['5', '4', '3'].),\n  (pop_quiz:bigint, Number of pop quizzes given during the course.. Value examples: ['2', '1', '2'].),\n  (group_projects:bigint, Number of group projects assigned during the course.. Value examples: ['3', '2', '1'].),\n  (inspirational:bigint, Number of students who found the course content inspirational.. Value examples: ['4', '3', '2'].),\n  (long_lectures:bigint, Number of students who found the lectures to be too long.. Value examples: ['2', '1', '3'].),\n  (extra_credit:bigint, Number of extra credit opportunities provided during the course.. Value examples: ['1', '2', '1'].),\n  (few_tests:bigint, Number of tests given during the course.. Value examples: ['3', '2', '1'].),\n  (good_feedback:bigint, Number of students who received good feedback from the instructor.. Value examples: ['4', '3', '2'].),\n  (tough_tests:bigint, Number of students who found the tests to be tough.. Value examples: ['2', '1', '3'].),\n  (heavy_papers:bigint, Number of papers assigned during the course.. Value examples: ['1', '2', '1'].),\n  (cares_for_students:bigint, Number of students who felt that the instructor cared for their well-being.. Value examples: ['5', '4', '3'].),\n  (heavy_assignments:bigint, Number of assignments given during the course.. Value examples: ['3', '2', '1'].),\n  (respected:bigint, Number of students who respected the instructor.. Value examples: ['4', '3', '2'].),\n  (participation:bigint, Number of students who participated actively in the course.. Value examples: ['2', '1', '3'].),\n  (heavy_reading:bigint, Number of reading assignments given during the course.. Value examples: ['1', '2', '1'].),\n  (tough_grader:bigint, Number of students who found the instructor to be a tough grader.. Value examples: ['5', '4', '3'].),\n  (hilarious:bigint, Number of students who found the instructor to be hilarious.. Value examples: ['3', '2', '1'].),\n  (would_take_again:bigint, Number of students who would take the course again.. Value examples: ['4', '3', '2'].),\n  (good_lecture:bigint, Number of students who found the lectures to be good.. Value examples: ['2', '1', '3'].),\n  (no_skip:bigint, Number of students who did not skip any classes during the course.. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: instructor\n[\n  (instructor_id:bigint, Unique identifier for each instructor. Value examples: ['1', '2'].),\n  (name:text, Name of the instructor. Value examples: ['John Smith', 'Jane Doe'].),\n  (uniqname:text, Unique name of the instructor used for login and identification purposes. Value examples: ['jsmith', 'jdoe'].),\n]\n# Table: offering_instructor\n[\n  (offering_instructor_id:bigint, Unique identifier for each offering-instructor pair. Value examples: ['1', '2', '3'].),\n  (offering_id:bigint, Foreign key referencing the offering table. Value examples: ['1', '1', '2'].),\n  (instructor_id:bigint, Foreign key referencing the instructor table. Value examples: ['1', '2', '3'].),\n]\n# Table: program\n[\n  (program_id:bigint, Unique identifier for each program. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the program, Eg 'Computer Science', 'Physics'. Value examples: ['Computer Science', 'Mathematics', 'Physics'].),\n  (college:text, Name of the college offering the program. Value examples: ['Engineering', 'Arts and Sciences', 'Arts and Sciences'].),\n  (introduction:text, Introduction to the program. Value examples: ['This program focuses on computer science principles and applications.', 'This program provides a comprehensive study of mathematical concepts and theories.', 'This program explores the fundamental principles of physics and their applications.'].),\n]\n# Table: program_course\n[\n  (program_id:bigint, The ID of the program associated with the course. Value examples: ['1', '1'].),\n  (course_id:bigint, The ID of the course. Value examples: ['1', '4'].),\n  (workload:bigint, The workload of the course in hours. Value examples: ['100', '80'].),\n  (category:text, The category of the course. Can only be 'Core' or 'Elective'.. Value examples: ['Core', 'Elective'].),\n]\n# Table: program_requirement\n[\n  (program_id:bigint, Unique identifier for a program. Value examples: ['1', '2', '3'].),\n  (category:text, Category of the program. Value examples: ['Core', 'Core', 'Core'].),\n  (min_credit:bigint, Minimum number of credits required for the program. Value examples: ['120', '90', '200'].),\n  (additional_req:text, Additional requirements for the program, if any. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: semester\n[\n  (semester_id:bigint, Unique identifier for each semester. Sort by this column to get the right year-semester order.. Value examples: ['1', '2', '3', '4'].),\n  (semester:text, The name or identifier for the semester Can only be 'Fall', 'Spring', or 'Summer'. Value examples: ['Fall', 'Spring', 'Summer', 'Fall'].),\n  (year:bigint, The year in which the semester takes place. Value examples: ['2020', '2021', '2021', '2021'].),\n]\n# Table: student\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '2', '3'].),\n  (lastname:text, Last name of the student. Value examples: ['Smith', 'Doe', 'Johnson'].),\n  (firstname:text, First name of the student. Value examples: ['John', 'Jane', 'David'].),\n  (program_id:bigint, Identifier for the program the student is enrolled in. Value examples: ['1', '1', '2'].),\n  (declare_major:text, Major program the student declared. Value examples: ['Computer Science', 'Computer Science', 'Mathematics'].),\n  (total_credit:bigint, Total number of credits earned by the student. Value examples: ['13', '7', '7'].),\n  (total_gpa:numeric, Cumulative GPA of the student. Value examples: ['3.5', '3.2', '3.6'].),\n  (entered_as:text, Status of the student when they entered the program. e.g. 'Freshman', 'Transfer Student'. Value examples: ['Freshman', 'Freshman', 'Freshman'].),\n  (admit_term:date, Term in which the student was admitted. Format is YYYY-MM-DD. Value examples: ['2018-01-01', '2018-01-01', '2019-01-01'].),\n  (predicted_graduation_semester:date, Semester in which the student is predicted to graduate. Format is YYYY-MM-DD. Value examples: ['2022-05-01', '2022-05-01', '2022-05-01'].),\n  (degree:text, Degree program the student is enrolled in. Can only be 'Bachelor of Science' or 'Bachelor of Arts'.. Value examples: ['Bachelor of Science', 'Bachelor of Science', 'Bachelor of Arts'].),\n  (minor:text, Minor program the student is enrolled in. Value examples: ['NULL', 'NULL', 'Mathematics'].),\n  (internship:text, Internship program the student is enrolled in. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: student_record\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '1', '1'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course was taken. Value examples: ['1', '1', '2'].),\n  (grade:text, The grade received for the course. Value examples: ['A', 'A', 'A'].),\n  (how:text, How the student took the course. Can only be 'in-person' or 'online'.. Value examples: ['in-person', 'in-person', 'in-person'].),\n  (transfer_source:text, If the course was transferred from another institution, the name of that institution. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (earn_credit:text, Whether the student earned credit for the course (e.g. Yes, No). Value examples: ['Yes', 'Yes', 'Yes'].),\n  (repeat_term:text, If the student repeated the course, the semester in which it was repeated. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (test_id:text, Unique identifier for each test taken in the course. Value examples: ['1', '1', '1'].),\n  (offering_id:bigint, Unique identifier for each offering of a course. Value examples: ['1', '2', '3'].),\n]\n\n【Foreign keys】\narea.course_id = course.course_id\ncomment_instructor.instructor_id = instructor.instructor_id\ncomment_instructor.student_id = student.student_id\ncourse.course_id = course_offering.course_id\ncourse.course_id = course_prerequisite.course_id\ncourse.course_id = course_tags_count.course_id\ncourse.course_id = program_course.course_id\ncourse.course_id = student_record.course_id\ncourse_offering.offering_id = offering_instructor.offering_id\ncourse_offering.offering_id = student_record.offering_id\ninstructor.instructor_id = offering_instructor.instructor_id\nprogram.program_id = program_course.program_id\nprogram.program_id = program_requirement.program_id\nprogram.program_id = student.program_id\nstudent.student_id = student_record.student_id\n\n【参考信息】\n\n\n【用户问题】\nWhat is the total number of students enrolled in each course, ordered from highest to lowest?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT course.course_id, course.name, course.number, SUM(course.num_enrolled) AS total_students FROM course GROUP BY course.course_id, course.name, course.number ORDER BY total_students DESC NULLS LAST",
        "role": "assistant"
      }
    ],
    "db_name": "advising",
    "id": 42,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the total number of credits earned by each student, ordered from highest to lowest? Give the student id and the total number of credits.\n\n【数据库schema】\n【DB_ID】 advising\n【Schema】\n# Table: area\n[\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2'].),\n  (area:text, The area of study for each course. Value examples: ['Computer Science', 'Mathematics'].),\n]\n# Table: comment_instructor\n[\n  (instructor_id:bigint, Unique identifier for the instructor. Value examples: ['1', '2'].),\n  (student_id:bigint, Unique identifier for the student. Value examples: ['1', '2'].),\n  (score:bigint, Score given by the student to the instructor. Value examples: ['5', '4'].),\n  (comment_text:text, Textual comment given by the student about the instructor. Value examples: ['John Smith is a great instructor.', 'Jane Doe explains concepts clearly.'].),\n]\n# Table: course\n[\n  (course_id:bigint, The unique identifier for the course.. Value examples: ['1', '2'].),\n  (name:text, The name of the course.. Value examples: ['Introduction to Computer Science', 'Advanced Calculus'].),\n  (department:text, The department offering the course. Eg 'Mathematics', 'Physics'. Value examples: ['Computer Science', 'Mathematics'].),\n  (number:text, The course number/code.. Value examples: ['CS101', 'MATH201'].),\n  (credits:text, The number of credits awarded for completing the course.. Value examples: ['3', '4'].),\n  (advisory_requirement:text, Any advisory requirements for taking the course.. Value examples: ['NULL', 'CS101'].),\n  (enforced_requirement:text, Any enforced requirements for taking the course.. Value examples: ['NULL', 'NULL'].),\n  (description:text, A brief description of the course content.. Value examples: ['This course introduces the basics of computer science.', 'This course covers advanced topics in calculus.'].),\n  (num_semesters:bigint, The number of semesters the course is offered in a year.. Value examples: ['2', '1'].),\n  (num_enrolled:bigint, The total number of students enrolled in the course.. Value examples: ['2', '3'].),\n  (has_discussion:boolean, Indicates whether the course has any discussion sessions or not.. Value examples: ['true', 'false'].),\n  (has_lab:boolean, Indicates whether the course has any lab sessions or not.. Value examples: ['false', 'false'].),\n  (has_projects:boolean, Indicates whether the course has any projects or not.. Value examples: ['true', 'true'].),\n  (has_exams:boolean, Indicates whether the course has any exams or not.. Value examples: ['false', 'true'].),\n  (num_reviews:bigint, The total number of reviews/ratings for the course.. Value examples: ['10', '5'].),\n  (clarity_score:bigint, The overall clarity score of the course as rated by students.. Value examples: ['5', '4'].),\n  (easiness_score:bigint, The overall easiness score of the course as rated by students.. Value examples: ['3', '2'].),\n  (helpfulness_score:bigint, The overall helpfulness score of the course as rated by students.. Value examples: ['4', '3'].),\n]\n# Table: course_offering\n[\n  (offering_id:bigint, Unique identifier for each course offering. Value examples: ['1', '2', '3'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course is offered. Value examples: ['1', '1', '2'].),\n  (section_number:bigint, The section number of the course. Value examples: ['1', '1', '1'].),\n  (start_time:time, The start time of the course. Value examples: ['08:00:00', '10:00:00', '08:00:00'].),\n  (end_time:time, The end time of the course. Value examples: ['10:00:00', '12:00:00', '10:00:00'].),\n  (monday:text, The instructor's name for Monday. Value examples: ['John Smith', 'NULL', 'John Smith'].),\n  (tuesday:text, The instructor's name for Tuesday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (wednesday:text, The instructor's name for Wednesday. Value examples: ['NULL', 'Gilbert Strang', 'NULL'].),\n  (thursday:text, The instructor's name for Thursday. Value examples: ['Jane Doe', 'NULL', 'Jane Doe'].),\n  (friday:text, The instructor's name for Friday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (saturday:text, The instructor's name for Saturday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (sunday:text, The instructor's name for Sunday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (has_final_project:boolean, Indicates whether the course has a final project. Value examples: ['true', 'true', 'false'].),\n  (has_final_exam:boolean, Indicates whether the course has a final exam. Value examples: ['false', 'true', 'true'].),\n  (textbook:text, The name of the textbook used in the course. Value examples: ['Introduction to Computer Science', 'Advanced Calculus', 'Introduction to Physics'].),\n  (class_address:text, The address of the classroom where the course is held. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (allow_audit:text, Indicates whether auditing the course is allowed. Value examples: ['true', 'false', 'true'].),\n]\n# Table: course_prerequisite\n[\n  (pre_course_id:bigint, The ID of the prerequisite course. Value examples: ['1', '2'].),\n  (course_id:bigint, The ID of the course that has the prerequisite. Value examples: ['2', '3'].),\n]\n# Table: course_tags_count\n[\n  (course_id:bigint, The unique identifier for each course.. Value examples: ['1', '2', '3'].),\n  (clear_grading:bigint, Number of students who found the grading criteria clear and easy to understand.. Value examples: ['5', '4', '3'].),\n  (pop_quiz:bigint, Number of pop quizzes given during the course.. Value examples: ['2', '1', '2'].),\n  (group_projects:bigint, Number of group projects assigned during the course.. Value examples: ['3', '2', '1'].),\n  (inspirational:bigint, Number of students who found the course content inspirational.. Value examples: ['4', '3', '2'].),\n  (long_lectures:bigint, Number of students who found the lectures to be too long.. Value examples: ['2', '1', '3'].),\n  (extra_credit:bigint, Number of extra credit opportunities provided during the course.. Value examples: ['1', '2', '1'].),\n  (few_tests:bigint, Number of tests given during the course.. Value examples: ['3', '2', '1'].),\n  (good_feedback:bigint, Number of students who received good feedback from the instructor.. Value examples: ['4', '3', '2'].),\n  (tough_tests:bigint, Number of students who found the tests to be tough.. Value examples: ['2', '1', '3'].),\n  (heavy_papers:bigint, Number of papers assigned during the course.. Value examples: ['1', '2', '1'].),\n  (cares_for_students:bigint, Number of students who felt that the instructor cared for their well-being.. Value examples: ['5', '4', '3'].),\n  (heavy_assignments:bigint, Number of assignments given during the course.. Value examples: ['3', '2', '1'].),\n  (respected:bigint, Number of students who respected the instructor.. Value examples: ['4', '3', '2'].),\n  (participation:bigint, Number of students who participated actively in the course.. Value examples: ['2', '1', '3'].),\n  (heavy_reading:bigint, Number of reading assignments given during the course.. Value examples: ['1', '2', '1'].),\n  (tough_grader:bigint, Number of students who found the instructor to be a tough grader.. Value examples: ['5', '4', '3'].),\n  (hilarious:bigint, Number of students who found the instructor to be hilarious.. Value examples: ['3', '2', '1'].),\n  (would_take_again:bigint, Number of students who would take the course again.. Value examples: ['4', '3', '2'].),\n  (good_lecture:bigint, Number of students who found the lectures to be good.. Value examples: ['2', '1', '3'].),\n  (no_skip:bigint, Number of students who did not skip any classes during the course.. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: instructor\n[\n  (instructor_id:bigint, Unique identifier for each instructor. Value examples: ['1', '2'].),\n  (name:text, Name of the instructor. Value examples: ['John Smith', 'Jane Doe'].),\n  (uniqname:text, Unique name of the instructor used for login and identification purposes. Value examples: ['jsmith', 'jdoe'].),\n]\n# Table: offering_instructor\n[\n  (offering_instructor_id:bigint, Unique identifier for each offering-instructor pair. Value examples: ['1', '2', '3'].),\n  (offering_id:bigint, Foreign key referencing the offering table. Value examples: ['1', '1', '2'].),\n  (instructor_id:bigint, Foreign key referencing the instructor table. Value examples: ['1', '2', '3'].),\n]\n# Table: program\n[\n  (program_id:bigint, Unique identifier for each program. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the program, Eg 'Computer Science', 'Physics'. Value examples: ['Computer Science', 'Mathematics', 'Physics'].),\n  (college:text, Name of the college offering the program. Value examples: ['Engineering', 'Arts and Sciences', 'Arts and Sciences'].),\n  (introduction:text, Introduction to the program. Value examples: ['This program focuses on computer science principles and applications.', 'This program provides a comprehensive study of mathematical concepts and theories.', 'This program explores the fundamental principles of physics and their applications.'].),\n]\n# Table: program_course\n[\n  (program_id:bigint, The ID of the program associated with the course. Value examples: ['1', '1'].),\n  (course_id:bigint, The ID of the course. Value examples: ['1', '4'].),\n  (workload:bigint, The workload of the course in hours. Value examples: ['100', '80'].),\n  (category:text, The category of the course. Can only be 'Core' or 'Elective'.. Value examples: ['Core', 'Elective'].),\n]\n# Table: program_requirement\n[\n  (program_id:bigint, Unique identifier for a program. Value examples: ['1', '2', '3'].),\n  (category:text, Category of the program. Value examples: ['Core', 'Core', 'Core'].),\n  (min_credit:bigint, Minimum number of credits required for the program. Value examples: ['120', '90', '200'].),\n  (additional_req:text, Additional requirements for the program, if any. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: semester\n[\n  (semester_id:bigint, Unique identifier for each semester. Sort by this column to get the right year-semester order.. Value examples: ['1', '2', '3', '4'].),\n  (semester:text, The name or identifier for the semester Can only be 'Fall', 'Spring', or 'Summer'. Value examples: ['Fall', 'Spring', 'Summer', 'Fall'].),\n  (year:bigint, The year in which the semester takes place. Value examples: ['2020', '2021', '2021', '2021'].),\n]\n# Table: student\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '2', '3'].),\n  (lastname:text, Last name of the student. Value examples: ['Smith', 'Doe', 'Johnson'].),\n  (firstname:text, First name of the student. Value examples: ['John', 'Jane', 'David'].),\n  (program_id:bigint, Identifier for the program the student is enrolled in. Value examples: ['1', '1', '2'].),\n  (declare_major:text, Major program the student declared. Value examples: ['Computer Science', 'Computer Science', 'Mathematics'].),\n  (total_credit:bigint, Total number of credits earned by the student. Value examples: ['13', '7', '7'].),\n  (total_gpa:numeric, Cumulative GPA of the student. Value examples: ['3.5', '3.2', '3.6'].),\n  (entered_as:text, Status of the student when they entered the program. e.g. 'Freshman', 'Transfer Student'. Value examples: ['Freshman', 'Freshman', 'Freshman'].),\n  (admit_term:date, Term in which the student was admitted. Format is YYYY-MM-DD. Value examples: ['2018-01-01', '2018-01-01', '2019-01-01'].),\n  (predicted_graduation_semester:date, Semester in which the student is predicted to graduate. Format is YYYY-MM-DD. Value examples: ['2022-05-01', '2022-05-01', '2022-05-01'].),\n  (degree:text, Degree program the student is enrolled in. Can only be 'Bachelor of Science' or 'Bachelor of Arts'.. Value examples: ['Bachelor of Science', 'Bachelor of Science', 'Bachelor of Arts'].),\n  (minor:text, Minor program the student is enrolled in. Value examples: ['NULL', 'NULL', 'Mathematics'].),\n  (internship:text, Internship program the student is enrolled in. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: student_record\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '1', '1'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course was taken. Value examples: ['1', '1', '2'].),\n  (grade:text, The grade received for the course. Value examples: ['A', 'A', 'A'].),\n  (how:text, How the student took the course. Can only be 'in-person' or 'online'.. Value examples: ['in-person', 'in-person', 'in-person'].),\n  (transfer_source:text, If the course was transferred from another institution, the name of that institution. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (earn_credit:text, Whether the student earned credit for the course (e.g. Yes, No). Value examples: ['Yes', 'Yes', 'Yes'].),\n  (repeat_term:text, If the student repeated the course, the semester in which it was repeated. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (test_id:text, Unique identifier for each test taken in the course. Value examples: ['1', '1', '1'].),\n  (offering_id:bigint, Unique identifier for each offering of a course. Value examples: ['1', '2', '3'].),\n]\n\n【Foreign keys】\narea.course_id = course.course_id\ncomment_instructor.instructor_id = instructor.instructor_id\ncomment_instructor.student_id = student.student_id\ncourse.course_id = course_offering.course_id\ncourse.course_id = course_prerequisite.course_id\ncourse.course_id = course_tags_count.course_id\ncourse.course_id = program_course.course_id\ncourse.course_id = student_record.course_id\ncourse_offering.offering_id = offering_instructor.offering_id\ncourse_offering.offering_id = student_record.offering_id\ninstructor.instructor_id = offering_instructor.instructor_id\nprogram.program_id = program_course.program_id\nprogram.program_id = program_requirement.program_id\nprogram.program_id = student.program_id\nstudent.student_id = student_record.student_id\n\n【参考信息】\n\n\n【用户问题】\nWhat is the total number of credits earned by each student, ordered from highest to lowest? Give the student id and the total number of credits.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT student.student_id, student.total_credit FROM student ORDER BY student.total_credit DESC NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "advising",
    "id": 43,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the name of the instructor who has taught the most courses, and how many courses have they taught?\n\n【数据库schema】\n【DB_ID】 advising\n【Schema】\n# Table: area\n[\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2'].),\n  (area:text, The area of study for each course. Value examples: ['Computer Science', 'Mathematics'].),\n]\n# Table: comment_instructor\n[\n  (instructor_id:bigint, Unique identifier for the instructor. Value examples: ['1', '2'].),\n  (student_id:bigint, Unique identifier for the student. Value examples: ['1', '2'].),\n  (score:bigint, Score given by the student to the instructor. Value examples: ['5', '4'].),\n  (comment_text:text, Textual comment given by the student about the instructor. Value examples: ['John Smith is a great instructor.', 'Jane Doe explains concepts clearly.'].),\n]\n# Table: course\n[\n  (course_id:bigint, The unique identifier for the course.. Value examples: ['1', '2'].),\n  (name:text, The name of the course.. Value examples: ['Introduction to Computer Science', 'Advanced Calculus'].),\n  (department:text, The department offering the course. Eg 'Mathematics', 'Physics'. Value examples: ['Computer Science', 'Mathematics'].),\n  (number:text, The course number/code.. Value examples: ['CS101', 'MATH201'].),\n  (credits:text, The number of credits awarded for completing the course.. Value examples: ['3', '4'].),\n  (advisory_requirement:text, Any advisory requirements for taking the course.. Value examples: ['NULL', 'CS101'].),\n  (enforced_requirement:text, Any enforced requirements for taking the course.. Value examples: ['NULL', 'NULL'].),\n  (description:text, A brief description of the course content.. Value examples: ['This course introduces the basics of computer science.', 'This course covers advanced topics in calculus.'].),\n  (num_semesters:bigint, The number of semesters the course is offered in a year.. Value examples: ['2', '1'].),\n  (num_enrolled:bigint, The total number of students enrolled in the course.. Value examples: ['2', '3'].),\n  (has_discussion:boolean, Indicates whether the course has any discussion sessions or not.. Value examples: ['true', 'false'].),\n  (has_lab:boolean, Indicates whether the course has any lab sessions or not.. Value examples: ['false', 'false'].),\n  (has_projects:boolean, Indicates whether the course has any projects or not.. Value examples: ['true', 'true'].),\n  (has_exams:boolean, Indicates whether the course has any exams or not.. Value examples: ['false', 'true'].),\n  (num_reviews:bigint, The total number of reviews/ratings for the course.. Value examples: ['10', '5'].),\n  (clarity_score:bigint, The overall clarity score of the course as rated by students.. Value examples: ['5', '4'].),\n  (easiness_score:bigint, The overall easiness score of the course as rated by students.. Value examples: ['3', '2'].),\n  (helpfulness_score:bigint, The overall helpfulness score of the course as rated by students.. Value examples: ['4', '3'].),\n]\n# Table: course_offering\n[\n  (offering_id:bigint, Unique identifier for each course offering. Value examples: ['1', '2', '3'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course is offered. Value examples: ['1', '1', '2'].),\n  (section_number:bigint, The section number of the course. Value examples: ['1', '1', '1'].),\n  (start_time:time, The start time of the course. Value examples: ['08:00:00', '10:00:00', '08:00:00'].),\n  (end_time:time, The end time of the course. Value examples: ['10:00:00', '12:00:00', '10:00:00'].),\n  (monday:text, The instructor's name for Monday. Value examples: ['John Smith', 'NULL', 'John Smith'].),\n  (tuesday:text, The instructor's name for Tuesday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (wednesday:text, The instructor's name for Wednesday. Value examples: ['NULL', 'Gilbert Strang', 'NULL'].),\n  (thursday:text, The instructor's name for Thursday. Value examples: ['Jane Doe', 'NULL', 'Jane Doe'].),\n  (friday:text, The instructor's name for Friday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (saturday:text, The instructor's name for Saturday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (sunday:text, The instructor's name for Sunday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (has_final_project:boolean, Indicates whether the course has a final project. Value examples: ['true', 'true', 'false'].),\n  (has_final_exam:boolean, Indicates whether the course has a final exam. Value examples: ['false', 'true', 'true'].),\n  (textbook:text, The name of the textbook used in the course. Value examples: ['Introduction to Computer Science', 'Advanced Calculus', 'Introduction to Physics'].),\n  (class_address:text, The address of the classroom where the course is held. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (allow_audit:text, Indicates whether auditing the course is allowed. Value examples: ['true', 'false', 'true'].),\n]\n# Table: course_prerequisite\n[\n  (pre_course_id:bigint, The ID of the prerequisite course. Value examples: ['1', '2'].),\n  (course_id:bigint, The ID of the course that has the prerequisite. Value examples: ['2', '3'].),\n]\n# Table: course_tags_count\n[\n  (course_id:bigint, The unique identifier for each course.. Value examples: ['1', '2', '3'].),\n  (clear_grading:bigint, Number of students who found the grading criteria clear and easy to understand.. Value examples: ['5', '4', '3'].),\n  (pop_quiz:bigint, Number of pop quizzes given during the course.. Value examples: ['2', '1', '2'].),\n  (group_projects:bigint, Number of group projects assigned during the course.. Value examples: ['3', '2', '1'].),\n  (inspirational:bigint, Number of students who found the course content inspirational.. Value examples: ['4', '3', '2'].),\n  (long_lectures:bigint, Number of students who found the lectures to be too long.. Value examples: ['2', '1', '3'].),\n  (extra_credit:bigint, Number of extra credit opportunities provided during the course.. Value examples: ['1', '2', '1'].),\n  (few_tests:bigint, Number of tests given during the course.. Value examples: ['3', '2', '1'].),\n  (good_feedback:bigint, Number of students who received good feedback from the instructor.. Value examples: ['4', '3', '2'].),\n  (tough_tests:bigint, Number of students who found the tests to be tough.. Value examples: ['2', '1', '3'].),\n  (heavy_papers:bigint, Number of papers assigned during the course.. Value examples: ['1', '2', '1'].),\n  (cares_for_students:bigint, Number of students who felt that the instructor cared for their well-being.. Value examples: ['5', '4', '3'].),\n  (heavy_assignments:bigint, Number of assignments given during the course.. Value examples: ['3', '2', '1'].),\n  (respected:bigint, Number of students who respected the instructor.. Value examples: ['4', '3', '2'].),\n  (participation:bigint, Number of students who participated actively in the course.. Value examples: ['2', '1', '3'].),\n  (heavy_reading:bigint, Number of reading assignments given during the course.. Value examples: ['1', '2', '1'].),\n  (tough_grader:bigint, Number of students who found the instructor to be a tough grader.. Value examples: ['5', '4', '3'].),\n  (hilarious:bigint, Number of students who found the instructor to be hilarious.. Value examples: ['3', '2', '1'].),\n  (would_take_again:bigint, Number of students who would take the course again.. Value examples: ['4', '3', '2'].),\n  (good_lecture:bigint, Number of students who found the lectures to be good.. Value examples: ['2', '1', '3'].),\n  (no_skip:bigint, Number of students who did not skip any classes during the course.. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: instructor\n[\n  (instructor_id:bigint, Unique identifier for each instructor. Value examples: ['1', '2'].),\n  (name:text, Name of the instructor. Value examples: ['John Smith', 'Jane Doe'].),\n  (uniqname:text, Unique name of the instructor used for login and identification purposes. Value examples: ['jsmith', 'jdoe'].),\n]\n# Table: offering_instructor\n[\n  (offering_instructor_id:bigint, Unique identifier for each offering-instructor pair. Value examples: ['1', '2', '3'].),\n  (offering_id:bigint, Foreign key referencing the offering table. Value examples: ['1', '1', '2'].),\n  (instructor_id:bigint, Foreign key referencing the instructor table. Value examples: ['1', '2', '3'].),\n]\n# Table: program\n[\n  (program_id:bigint, Unique identifier for each program. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the program, Eg 'Computer Science', 'Physics'. Value examples: ['Computer Science', 'Mathematics', 'Physics'].),\n  (college:text, Name of the college offering the program. Value examples: ['Engineering', 'Arts and Sciences', 'Arts and Sciences'].),\n  (introduction:text, Introduction to the program. Value examples: ['This program focuses on computer science principles and applications.', 'This program provides a comprehensive study of mathematical concepts and theories.', 'This program explores the fundamental principles of physics and their applications.'].),\n]\n# Table: program_course\n[\n  (program_id:bigint, The ID of the program associated with the course. Value examples: ['1', '1'].),\n  (course_id:bigint, The ID of the course. Value examples: ['1', '4'].),\n  (workload:bigint, The workload of the course in hours. Value examples: ['100', '80'].),\n  (category:text, The category of the course. Can only be 'Core' or 'Elective'.. Value examples: ['Core', 'Elective'].),\n]\n# Table: program_requirement\n[\n  (program_id:bigint, Unique identifier for a program. Value examples: ['1', '2', '3'].),\n  (category:text, Category of the program. Value examples: ['Core', 'Core', 'Core'].),\n  (min_credit:bigint, Minimum number of credits required for the program. Value examples: ['120', '90', '200'].),\n  (additional_req:text, Additional requirements for the program, if any. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: semester\n[\n  (semester_id:bigint, Unique identifier for each semester. Sort by this column to get the right year-semester order.. Value examples: ['1', '2', '3', '4'].),\n  (semester:text, The name or identifier for the semester Can only be 'Fall', 'Spring', or 'Summer'. Value examples: ['Fall', 'Spring', 'Summer', 'Fall'].),\n  (year:bigint, The year in which the semester takes place. Value examples: ['2020', '2021', '2021', '2021'].),\n]\n# Table: student\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '2', '3'].),\n  (lastname:text, Last name of the student. Value examples: ['Smith', 'Doe', 'Johnson'].),\n  (firstname:text, First name of the student. Value examples: ['John', 'Jane', 'David'].),\n  (program_id:bigint, Identifier for the program the student is enrolled in. Value examples: ['1', '1', '2'].),\n  (declare_major:text, Major program the student declared. Value examples: ['Computer Science', 'Computer Science', 'Mathematics'].),\n  (total_credit:bigint, Total number of credits earned by the student. Value examples: ['13', '7', '7'].),\n  (total_gpa:numeric, Cumulative GPA of the student. Value examples: ['3.5', '3.2', '3.6'].),\n  (entered_as:text, Status of the student when they entered the program. e.g. 'Freshman', 'Transfer Student'. Value examples: ['Freshman', 'Freshman', 'Freshman'].),\n  (admit_term:date, Term in which the student was admitted. Format is YYYY-MM-DD. Value examples: ['2018-01-01', '2018-01-01', '2019-01-01'].),\n  (predicted_graduation_semester:date, Semester in which the student is predicted to graduate. Format is YYYY-MM-DD. Value examples: ['2022-05-01', '2022-05-01', '2022-05-01'].),\n  (degree:text, Degree program the student is enrolled in. Can only be 'Bachelor of Science' or 'Bachelor of Arts'.. Value examples: ['Bachelor of Science', 'Bachelor of Science', 'Bachelor of Arts'].),\n  (minor:text, Minor program the student is enrolled in. Value examples: ['NULL', 'NULL', 'Mathematics'].),\n  (internship:text, Internship program the student is enrolled in. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: student_record\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '1', '1'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course was taken. Value examples: ['1', '1', '2'].),\n  (grade:text, The grade received for the course. Value examples: ['A', 'A', 'A'].),\n  (how:text, How the student took the course. Can only be 'in-person' or 'online'.. Value examples: ['in-person', 'in-person', 'in-person'].),\n  (transfer_source:text, If the course was transferred from another institution, the name of that institution. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (earn_credit:text, Whether the student earned credit for the course (e.g. Yes, No). Value examples: ['Yes', 'Yes', 'Yes'].),\n  (repeat_term:text, If the student repeated the course, the semester in which it was repeated. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (test_id:text, Unique identifier for each test taken in the course. Value examples: ['1', '1', '1'].),\n  (offering_id:bigint, Unique identifier for each offering of a course. Value examples: ['1', '2', '3'].),\n]\n\n【Foreign keys】\narea.course_id = course.course_id\ncomment_instructor.instructor_id = instructor.instructor_id\ncomment_instructor.student_id = student.student_id\ncourse.course_id = course_offering.course_id\ncourse.course_id = course_prerequisite.course_id\ncourse.course_id = course_tags_count.course_id\ncourse.course_id = program_course.course_id\ncourse.course_id = student_record.course_id\ncourse_offering.offering_id = offering_instructor.offering_id\ncourse_offering.offering_id = student_record.offering_id\ninstructor.instructor_id = offering_instructor.instructor_id\nprogram.program_id = program_course.program_id\nprogram.program_id = program_requirement.program_id\nprogram.program_id = student.program_id\nstudent.student_id = student_record.student_id\n\n【参考信息】\n\n\n【用户问题】\nWhat is the name of the instructor who has taught the most courses, and how many courses have they taught?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT instructor.name, count(offering_instructor.offering_id) AS num_courses FROM offering_instructor JOIN instructor ON offering_instructor.instructor_id = instructor.instructor_id GROUP BY instructor.name ORDER BY num_courses DESC LIMIT 1;",
        "role": "assistant"
      }
    ],
    "db_name": "advising",
    "id": 44,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the ratio of the total number of students enrolled in courses with exams to the total number of students enrolled in courses without exams?\n\n【数据库schema】\n【DB_ID】 advising\n【Schema】\n# Table: area\n[\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2'].),\n  (area:text, The area of study for each course. Value examples: ['Computer Science', 'Mathematics'].),\n]\n# Table: comment_instructor\n[\n  (instructor_id:bigint, Unique identifier for the instructor. Value examples: ['1', '2'].),\n  (student_id:bigint, Unique identifier for the student. Value examples: ['1', '2'].),\n  (score:bigint, Score given by the student to the instructor. Value examples: ['5', '4'].),\n  (comment_text:text, Textual comment given by the student about the instructor. Value examples: ['John Smith is a great instructor.', 'Jane Doe explains concepts clearly.'].),\n]\n# Table: course\n[\n  (course_id:bigint, The unique identifier for the course.. Value examples: ['1', '2'].),\n  (name:text, The name of the course.. Value examples: ['Introduction to Computer Science', 'Advanced Calculus'].),\n  (department:text, The department offering the course. Eg 'Mathematics', 'Physics'. Value examples: ['Computer Science', 'Mathematics'].),\n  (number:text, The course number/code.. Value examples: ['CS101', 'MATH201'].),\n  (credits:text, The number of credits awarded for completing the course.. Value examples: ['3', '4'].),\n  (advisory_requirement:text, Any advisory requirements for taking the course.. Value examples: ['NULL', 'CS101'].),\n  (enforced_requirement:text, Any enforced requirements for taking the course.. Value examples: ['NULL', 'NULL'].),\n  (description:text, A brief description of the course content.. Value examples: ['This course introduces the basics of computer science.', 'This course covers advanced topics in calculus.'].),\n  (num_semesters:bigint, The number of semesters the course is offered in a year.. Value examples: ['2', '1'].),\n  (num_enrolled:bigint, The total number of students enrolled in the course.. Value examples: ['2', '3'].),\n  (has_discussion:boolean, Indicates whether the course has any discussion sessions or not.. Value examples: ['true', 'false'].),\n  (has_lab:boolean, Indicates whether the course has any lab sessions or not.. Value examples: ['false', 'false'].),\n  (has_projects:boolean, Indicates whether the course has any projects or not.. Value examples: ['true', 'true'].),\n  (has_exams:boolean, Indicates whether the course has any exams or not.. Value examples: ['false', 'true'].),\n  (num_reviews:bigint, The total number of reviews/ratings for the course.. Value examples: ['10', '5'].),\n  (clarity_score:bigint, The overall clarity score of the course as rated by students.. Value examples: ['5', '4'].),\n  (easiness_score:bigint, The overall easiness score of the course as rated by students.. Value examples: ['3', '2'].),\n  (helpfulness_score:bigint, The overall helpfulness score of the course as rated by students.. Value examples: ['4', '3'].),\n]\n# Table: course_offering\n[\n  (offering_id:bigint, Unique identifier for each course offering. Value examples: ['1', '2', '3'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course is offered. Value examples: ['1', '1', '2'].),\n  (section_number:bigint, The section number of the course. Value examples: ['1', '1', '1'].),\n  (start_time:time, The start time of the course. Value examples: ['08:00:00', '10:00:00', '08:00:00'].),\n  (end_time:time, The end time of the course. Value examples: ['10:00:00', '12:00:00', '10:00:00'].),\n  (monday:text, The instructor's name for Monday. Value examples: ['John Smith', 'NULL', 'John Smith'].),\n  (tuesday:text, The instructor's name for Tuesday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (wednesday:text, The instructor's name for Wednesday. Value examples: ['NULL', 'Gilbert Strang', 'NULL'].),\n  (thursday:text, The instructor's name for Thursday. Value examples: ['Jane Doe', 'NULL', 'Jane Doe'].),\n  (friday:text, The instructor's name for Friday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (saturday:text, The instructor's name for Saturday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (sunday:text, The instructor's name for Sunday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (has_final_project:boolean, Indicates whether the course has a final project. Value examples: ['true', 'true', 'false'].),\n  (has_final_exam:boolean, Indicates whether the course has a final exam. Value examples: ['false', 'true', 'true'].),\n  (textbook:text, The name of the textbook used in the course. Value examples: ['Introduction to Computer Science', 'Advanced Calculus', 'Introduction to Physics'].),\n  (class_address:text, The address of the classroom where the course is held. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (allow_audit:text, Indicates whether auditing the course is allowed. Value examples: ['true', 'false', 'true'].),\n]\n# Table: course_prerequisite\n[\n  (pre_course_id:bigint, The ID of the prerequisite course. Value examples: ['1', '2'].),\n  (course_id:bigint, The ID of the course that has the prerequisite. Value examples: ['2', '3'].),\n]\n# Table: course_tags_count\n[\n  (course_id:bigint, The unique identifier for each course.. Value examples: ['1', '2', '3'].),\n  (clear_grading:bigint, Number of students who found the grading criteria clear and easy to understand.. Value examples: ['5', '4', '3'].),\n  (pop_quiz:bigint, Number of pop quizzes given during the course.. Value examples: ['2', '1', '2'].),\n  (group_projects:bigint, Number of group projects assigned during the course.. Value examples: ['3', '2', '1'].),\n  (inspirational:bigint, Number of students who found the course content inspirational.. Value examples: ['4', '3', '2'].),\n  (long_lectures:bigint, Number of students who found the lectures to be too long.. Value examples: ['2', '1', '3'].),\n  (extra_credit:bigint, Number of extra credit opportunities provided during the course.. Value examples: ['1', '2', '1'].),\n  (few_tests:bigint, Number of tests given during the course.. Value examples: ['3', '2', '1'].),\n  (good_feedback:bigint, Number of students who received good feedback from the instructor.. Value examples: ['4', '3', '2'].),\n  (tough_tests:bigint, Number of students who found the tests to be tough.. Value examples: ['2', '1', '3'].),\n  (heavy_papers:bigint, Number of papers assigned during the course.. Value examples: ['1', '2', '1'].),\n  (cares_for_students:bigint, Number of students who felt that the instructor cared for their well-being.. Value examples: ['5', '4', '3'].),\n  (heavy_assignments:bigint, Number of assignments given during the course.. Value examples: ['3', '2', '1'].),\n  (respected:bigint, Number of students who respected the instructor.. Value examples: ['4', '3', '2'].),\n  (participation:bigint, Number of students who participated actively in the course.. Value examples: ['2', '1', '3'].),\n  (heavy_reading:bigint, Number of reading assignments given during the course.. Value examples: ['1', '2', '1'].),\n  (tough_grader:bigint, Number of students who found the instructor to be a tough grader.. Value examples: ['5', '4', '3'].),\n  (hilarious:bigint, Number of students who found the instructor to be hilarious.. Value examples: ['3', '2', '1'].),\n  (would_take_again:bigint, Number of students who would take the course again.. Value examples: ['4', '3', '2'].),\n  (good_lecture:bigint, Number of students who found the lectures to be good.. Value examples: ['2', '1', '3'].),\n  (no_skip:bigint, Number of students who did not skip any classes during the course.. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: instructor\n[\n  (instructor_id:bigint, Unique identifier for each instructor. Value examples: ['1', '2'].),\n  (name:text, Name of the instructor. Value examples: ['John Smith', 'Jane Doe'].),\n  (uniqname:text, Unique name of the instructor used for login and identification purposes. Value examples: ['jsmith', 'jdoe'].),\n]\n# Table: offering_instructor\n[\n  (offering_instructor_id:bigint, Unique identifier for each offering-instructor pair. Value examples: ['1', '2', '3'].),\n  (offering_id:bigint, Foreign key referencing the offering table. Value examples: ['1', '1', '2'].),\n  (instructor_id:bigint, Foreign key referencing the instructor table. Value examples: ['1', '2', '3'].),\n]\n# Table: program\n[\n  (program_id:bigint, Unique identifier for each program. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the program, Eg 'Computer Science', 'Physics'. Value examples: ['Computer Science', 'Mathematics', 'Physics'].),\n  (college:text, Name of the college offering the program. Value examples: ['Engineering', 'Arts and Sciences', 'Arts and Sciences'].),\n  (introduction:text, Introduction to the program. Value examples: ['This program focuses on computer science principles and applications.', 'This program provides a comprehensive study of mathematical concepts and theories.', 'This program explores the fundamental principles of physics and their applications.'].),\n]\n# Table: program_course\n[\n  (program_id:bigint, The ID of the program associated with the course. Value examples: ['1', '1'].),\n  (course_id:bigint, The ID of the course. Value examples: ['1', '4'].),\n  (workload:bigint, The workload of the course in hours. Value examples: ['100', '80'].),\n  (category:text, The category of the course. Can only be 'Core' or 'Elective'.. Value examples: ['Core', 'Elective'].),\n]\n# Table: program_requirement\n[\n  (program_id:bigint, Unique identifier for a program. Value examples: ['1', '2', '3'].),\n  (category:text, Category of the program. Value examples: ['Core', 'Core', 'Core'].),\n  (min_credit:bigint, Minimum number of credits required for the program. Value examples: ['120', '90', '200'].),\n  (additional_req:text, Additional requirements for the program, if any. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: semester\n[\n  (semester_id:bigint, Unique identifier for each semester. Sort by this column to get the right year-semester order.. Value examples: ['1', '2', '3', '4'].),\n  (semester:text, The name or identifier for the semester Can only be 'Fall', 'Spring', or 'Summer'. Value examples: ['Fall', 'Spring', 'Summer', 'Fall'].),\n  (year:bigint, The year in which the semester takes place. Value examples: ['2020', '2021', '2021', '2021'].),\n]\n# Table: student\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '2', '3'].),\n  (lastname:text, Last name of the student. Value examples: ['Smith', 'Doe', 'Johnson'].),\n  (firstname:text, First name of the student. Value examples: ['John', 'Jane', 'David'].),\n  (program_id:bigint, Identifier for the program the student is enrolled in. Value examples: ['1', '1', '2'].),\n  (declare_major:text, Major program the student declared. Value examples: ['Computer Science', 'Computer Science', 'Mathematics'].),\n  (total_credit:bigint, Total number of credits earned by the student. Value examples: ['13', '7', '7'].),\n  (total_gpa:numeric, Cumulative GPA of the student. Value examples: ['3.5', '3.2', '3.6'].),\n  (entered_as:text, Status of the student when they entered the program. e.g. 'Freshman', 'Transfer Student'. Value examples: ['Freshman', 'Freshman', 'Freshman'].),\n  (admit_term:date, Term in which the student was admitted. Format is YYYY-MM-DD. Value examples: ['2018-01-01', '2018-01-01', '2019-01-01'].),\n  (predicted_graduation_semester:date, Semester in which the student is predicted to graduate. Format is YYYY-MM-DD. Value examples: ['2022-05-01', '2022-05-01', '2022-05-01'].),\n  (degree:text, Degree program the student is enrolled in. Can only be 'Bachelor of Science' or 'Bachelor of Arts'.. Value examples: ['Bachelor of Science', 'Bachelor of Science', 'Bachelor of Arts'].),\n  (minor:text, Minor program the student is enrolled in. Value examples: ['NULL', 'NULL', 'Mathematics'].),\n  (internship:text, Internship program the student is enrolled in. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: student_record\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '1', '1'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course was taken. Value examples: ['1', '1', '2'].),\n  (grade:text, The grade received for the course. Value examples: ['A', 'A', 'A'].),\n  (how:text, How the student took the course. Can only be 'in-person' or 'online'.. Value examples: ['in-person', 'in-person', 'in-person'].),\n  (transfer_source:text, If the course was transferred from another institution, the name of that institution. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (earn_credit:text, Whether the student earned credit for the course (e.g. Yes, No). Value examples: ['Yes', 'Yes', 'Yes'].),\n  (repeat_term:text, If the student repeated the course, the semester in which it was repeated. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (test_id:text, Unique identifier for each test taken in the course. Value examples: ['1', '1', '1'].),\n  (offering_id:bigint, Unique identifier for each offering of a course. Value examples: ['1', '2', '3'].),\n]\n\n【Foreign keys】\narea.course_id = course.course_id\ncomment_instructor.instructor_id = instructor.instructor_id\ncomment_instructor.student_id = student.student_id\ncourse.course_id = course_offering.course_id\ncourse.course_id = course_prerequisite.course_id\ncourse.course_id = course_tags_count.course_id\ncourse.course_id = program_course.course_id\ncourse.course_id = student_record.course_id\ncourse_offering.offering_id = offering_instructor.offering_id\ncourse_offering.offering_id = student_record.offering_id\ninstructor.instructor_id = offering_instructor.instructor_id\nprogram.program_id = program_course.program_id\nprogram.program_id = program_requirement.program_id\nprogram.program_id = student.program_id\nstudent.student_id = student_record.student_id\n\n【参考信息】\n\n\n【用户问题】\nWhat is the ratio of the total number of students enrolled in courses with exams to the total number of students enrolled in courses without exams?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT SUM(CASE WHEN c.has_exams THEN c.num_enrolled ELSE 0 END)::FLOAT / SUM(CASE WHEN NOT c.has_exams THEN c.num_enrolled ELSE 0 END) AS ratio FROM course c;",
        "role": "assistant"
      }
    ],
    "db_name": "advising",
    "id": 45,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the ratio of the number of students who found the grading criteria clear and easy to understand to the number of students who received good feedback from the instructor for each course id?\n\n【数据库schema】\n【DB_ID】 advising\n【Schema】\n# Table: area\n[\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2'].),\n  (area:text, The area of study for each course. Value examples: ['Computer Science', 'Mathematics'].),\n]\n# Table: comment_instructor\n[\n  (instructor_id:bigint, Unique identifier for the instructor. Value examples: ['1', '2'].),\n  (student_id:bigint, Unique identifier for the student. Value examples: ['1', '2'].),\n  (score:bigint, Score given by the student to the instructor. Value examples: ['5', '4'].),\n  (comment_text:text, Textual comment given by the student about the instructor. Value examples: ['John Smith is a great instructor.', 'Jane Doe explains concepts clearly.'].),\n]\n# Table: course\n[\n  (course_id:bigint, The unique identifier for the course.. Value examples: ['1', '2'].),\n  (name:text, The name of the course.. Value examples: ['Introduction to Computer Science', 'Advanced Calculus'].),\n  (department:text, The department offering the course. Eg 'Mathematics', 'Physics'. Value examples: ['Computer Science', 'Mathematics'].),\n  (number:text, The course number/code.. Value examples: ['CS101', 'MATH201'].),\n  (credits:text, The number of credits awarded for completing the course.. Value examples: ['3', '4'].),\n  (advisory_requirement:text, Any advisory requirements for taking the course.. Value examples: ['NULL', 'CS101'].),\n  (enforced_requirement:text, Any enforced requirements for taking the course.. Value examples: ['NULL', 'NULL'].),\n  (description:text, A brief description of the course content.. Value examples: ['This course introduces the basics of computer science.', 'This course covers advanced topics in calculus.'].),\n  (num_semesters:bigint, The number of semesters the course is offered in a year.. Value examples: ['2', '1'].),\n  (num_enrolled:bigint, The total number of students enrolled in the course.. Value examples: ['2', '3'].),\n  (has_discussion:boolean, Indicates whether the course has any discussion sessions or not.. Value examples: ['true', 'false'].),\n  (has_lab:boolean, Indicates whether the course has any lab sessions or not.. Value examples: ['false', 'false'].),\n  (has_projects:boolean, Indicates whether the course has any projects or not.. Value examples: ['true', 'true'].),\n  (has_exams:boolean, Indicates whether the course has any exams or not.. Value examples: ['false', 'true'].),\n  (num_reviews:bigint, The total number of reviews/ratings for the course.. Value examples: ['10', '5'].),\n  (clarity_score:bigint, The overall clarity score of the course as rated by students.. Value examples: ['5', '4'].),\n  (easiness_score:bigint, The overall easiness score of the course as rated by students.. Value examples: ['3', '2'].),\n  (helpfulness_score:bigint, The overall helpfulness score of the course as rated by students.. Value examples: ['4', '3'].),\n]\n# Table: course_offering\n[\n  (offering_id:bigint, Unique identifier for each course offering. Value examples: ['1', '2', '3'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course is offered. Value examples: ['1', '1', '2'].),\n  (section_number:bigint, The section number of the course. Value examples: ['1', '1', '1'].),\n  (start_time:time, The start time of the course. Value examples: ['08:00:00', '10:00:00', '08:00:00'].),\n  (end_time:time, The end time of the course. Value examples: ['10:00:00', '12:00:00', '10:00:00'].),\n  (monday:text, The instructor's name for Monday. Value examples: ['John Smith', 'NULL', 'John Smith'].),\n  (tuesday:text, The instructor's name for Tuesday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (wednesday:text, The instructor's name for Wednesday. Value examples: ['NULL', 'Gilbert Strang', 'NULL'].),\n  (thursday:text, The instructor's name for Thursday. Value examples: ['Jane Doe', 'NULL', 'Jane Doe'].),\n  (friday:text, The instructor's name for Friday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (saturday:text, The instructor's name for Saturday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (sunday:text, The instructor's name for Sunday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (has_final_project:boolean, Indicates whether the course has a final project. Value examples: ['true', 'true', 'false'].),\n  (has_final_exam:boolean, Indicates whether the course has a final exam. Value examples: ['false', 'true', 'true'].),\n  (textbook:text, The name of the textbook used in the course. Value examples: ['Introduction to Computer Science', 'Advanced Calculus', 'Introduction to Physics'].),\n  (class_address:text, The address of the classroom where the course is held. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (allow_audit:text, Indicates whether auditing the course is allowed. Value examples: ['true', 'false', 'true'].),\n]\n# Table: course_prerequisite\n[\n  (pre_course_id:bigint, The ID of the prerequisite course. Value examples: ['1', '2'].),\n  (course_id:bigint, The ID of the course that has the prerequisite. Value examples: ['2', '3'].),\n]\n# Table: course_tags_count\n[\n  (course_id:bigint, The unique identifier for each course.. Value examples: ['1', '2', '3'].),\n  (clear_grading:bigint, Number of students who found the grading criteria clear and easy to understand.. Value examples: ['5', '4', '3'].),\n  (pop_quiz:bigint, Number of pop quizzes given during the course.. Value examples: ['2', '1', '2'].),\n  (group_projects:bigint, Number of group projects assigned during the course.. Value examples: ['3', '2', '1'].),\n  (inspirational:bigint, Number of students who found the course content inspirational.. Value examples: ['4', '3', '2'].),\n  (long_lectures:bigint, Number of students who found the lectures to be too long.. Value examples: ['2', '1', '3'].),\n  (extra_credit:bigint, Number of extra credit opportunities provided during the course.. Value examples: ['1', '2', '1'].),\n  (few_tests:bigint, Number of tests given during the course.. Value examples: ['3', '2', '1'].),\n  (good_feedback:bigint, Number of students who received good feedback from the instructor.. Value examples: ['4', '3', '2'].),\n  (tough_tests:bigint, Number of students who found the tests to be tough.. Value examples: ['2', '1', '3'].),\n  (heavy_papers:bigint, Number of papers assigned during the course.. Value examples: ['1', '2', '1'].),\n  (cares_for_students:bigint, Number of students who felt that the instructor cared for their well-being.. Value examples: ['5', '4', '3'].),\n  (heavy_assignments:bigint, Number of assignments given during the course.. Value examples: ['3', '2', '1'].),\n  (respected:bigint, Number of students who respected the instructor.. Value examples: ['4', '3', '2'].),\n  (participation:bigint, Number of students who participated actively in the course.. Value examples: ['2', '1', '3'].),\n  (heavy_reading:bigint, Number of reading assignments given during the course.. Value examples: ['1', '2', '1'].),\n  (tough_grader:bigint, Number of students who found the instructor to be a tough grader.. Value examples: ['5', '4', '3'].),\n  (hilarious:bigint, Number of students who found the instructor to be hilarious.. Value examples: ['3', '2', '1'].),\n  (would_take_again:bigint, Number of students who would take the course again.. Value examples: ['4', '3', '2'].),\n  (good_lecture:bigint, Number of students who found the lectures to be good.. Value examples: ['2', '1', '3'].),\n  (no_skip:bigint, Number of students who did not skip any classes during the course.. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: instructor\n[\n  (instructor_id:bigint, Unique identifier for each instructor. Value examples: ['1', '2'].),\n  (name:text, Name of the instructor. Value examples: ['John Smith', 'Jane Doe'].),\n  (uniqname:text, Unique name of the instructor used for login and identification purposes. Value examples: ['jsmith', 'jdoe'].),\n]\n# Table: offering_instructor\n[\n  (offering_instructor_id:bigint, Unique identifier for each offering-instructor pair. Value examples: ['1', '2', '3'].),\n  (offering_id:bigint, Foreign key referencing the offering table. Value examples: ['1', '1', '2'].),\n  (instructor_id:bigint, Foreign key referencing the instructor table. Value examples: ['1', '2', '3'].),\n]\n# Table: program\n[\n  (program_id:bigint, Unique identifier for each program. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the program, Eg 'Computer Science', 'Physics'. Value examples: ['Computer Science', 'Mathematics', 'Physics'].),\n  (college:text, Name of the college offering the program. Value examples: ['Engineering', 'Arts and Sciences', 'Arts and Sciences'].),\n  (introduction:text, Introduction to the program. Value examples: ['This program focuses on computer science principles and applications.', 'This program provides a comprehensive study of mathematical concepts and theories.', 'This program explores the fundamental principles of physics and their applications.'].),\n]\n# Table: program_course\n[\n  (program_id:bigint, The ID of the program associated with the course. Value examples: ['1', '1'].),\n  (course_id:bigint, The ID of the course. Value examples: ['1', '4'].),\n  (workload:bigint, The workload of the course in hours. Value examples: ['100', '80'].),\n  (category:text, The category of the course. Can only be 'Core' or 'Elective'.. Value examples: ['Core', 'Elective'].),\n]\n# Table: program_requirement\n[\n  (program_id:bigint, Unique identifier for a program. Value examples: ['1', '2', '3'].),\n  (category:text, Category of the program. Value examples: ['Core', 'Core', 'Core'].),\n  (min_credit:bigint, Minimum number of credits required for the program. Value examples: ['120', '90', '200'].),\n  (additional_req:text, Additional requirements for the program, if any. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: semester\n[\n  (semester_id:bigint, Unique identifier for each semester. Sort by this column to get the right year-semester order.. Value examples: ['1', '2', '3', '4'].),\n  (semester:text, The name or identifier for the semester Can only be 'Fall', 'Spring', or 'Summer'. Value examples: ['Fall', 'Spring', 'Summer', 'Fall'].),\n  (year:bigint, The year in which the semester takes place. Value examples: ['2020', '2021', '2021', '2021'].),\n]\n# Table: student\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '2', '3'].),\n  (lastname:text, Last name of the student. Value examples: ['Smith', 'Doe', 'Johnson'].),\n  (firstname:text, First name of the student. Value examples: ['John', 'Jane', 'David'].),\n  (program_id:bigint, Identifier for the program the student is enrolled in. Value examples: ['1', '1', '2'].),\n  (declare_major:text, Major program the student declared. Value examples: ['Computer Science', 'Computer Science', 'Mathematics'].),\n  (total_credit:bigint, Total number of credits earned by the student. Value examples: ['13', '7', '7'].),\n  (total_gpa:numeric, Cumulative GPA of the student. Value examples: ['3.5', '3.2', '3.6'].),\n  (entered_as:text, Status of the student when they entered the program. e.g. 'Freshman', 'Transfer Student'. Value examples: ['Freshman', 'Freshman', 'Freshman'].),\n  (admit_term:date, Term in which the student was admitted. Format is YYYY-MM-DD. Value examples: ['2018-01-01', '2018-01-01', '2019-01-01'].),\n  (predicted_graduation_semester:date, Semester in which the student is predicted to graduate. Format is YYYY-MM-DD. Value examples: ['2022-05-01', '2022-05-01', '2022-05-01'].),\n  (degree:text, Degree program the student is enrolled in. Can only be 'Bachelor of Science' or 'Bachelor of Arts'.. Value examples: ['Bachelor of Science', 'Bachelor of Science', 'Bachelor of Arts'].),\n  (minor:text, Minor program the student is enrolled in. Value examples: ['NULL', 'NULL', 'Mathematics'].),\n  (internship:text, Internship program the student is enrolled in. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: student_record\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '1', '1'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course was taken. Value examples: ['1', '1', '2'].),\n  (grade:text, The grade received for the course. Value examples: ['A', 'A', 'A'].),\n  (how:text, How the student took the course. Can only be 'in-person' or 'online'.. Value examples: ['in-person', 'in-person', 'in-person'].),\n  (transfer_source:text, If the course was transferred from another institution, the name of that institution. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (earn_credit:text, Whether the student earned credit for the course (e.g. Yes, No). Value examples: ['Yes', 'Yes', 'Yes'].),\n  (repeat_term:text, If the student repeated the course, the semester in which it was repeated. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (test_id:text, Unique identifier for each test taken in the course. Value examples: ['1', '1', '1'].),\n  (offering_id:bigint, Unique identifier for each offering of a course. Value examples: ['1', '2', '3'].),\n]\n\n【Foreign keys】\narea.course_id = course.course_id\ncomment_instructor.instructor_id = instructor.instructor_id\ncomment_instructor.student_id = student.student_id\ncourse.course_id = course_offering.course_id\ncourse.course_id = course_prerequisite.course_id\ncourse.course_id = course_tags_count.course_id\ncourse.course_id = program_course.course_id\ncourse.course_id = student_record.course_id\ncourse_offering.offering_id = offering_instructor.offering_id\ncourse_offering.offering_id = student_record.offering_id\ninstructor.instructor_id = offering_instructor.instructor_id\nprogram.program_id = program_course.program_id\nprogram.program_id = program_requirement.program_id\nprogram.program_id = student.program_id\nstudent.student_id = student_record.student_id\n\n【参考信息】\n\n\n【用户问题】\nWhat is the ratio of the number of students who found the grading criteria clear and easy to understand to the number of students who received good feedback from the instructor for each course id?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT course_tags_count.course_id, CAST(course_tags_count.clear_grading AS FLOAT) / NULLIF(course_tags_count.good_feedback, 0) AS ratio FROM course_tags_count ORDER BY course_tags_count.course_id NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "advising",
    "id": 46,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the ratio of the number of courses with projects to the number of courses with exams in each semester id?\n\n【数据库schema】\n【DB_ID】 advising\n【Schema】\n# Table: area\n[\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2'].),\n  (area:text, The area of study for each course. Value examples: ['Computer Science', 'Mathematics'].),\n]\n# Table: comment_instructor\n[\n  (instructor_id:bigint, Unique identifier for the instructor. Value examples: ['1', '2'].),\n  (student_id:bigint, Unique identifier for the student. Value examples: ['1', '2'].),\n  (score:bigint, Score given by the student to the instructor. Value examples: ['5', '4'].),\n  (comment_text:text, Textual comment given by the student about the instructor. Value examples: ['John Smith is a great instructor.', 'Jane Doe explains concepts clearly.'].),\n]\n# Table: course\n[\n  (course_id:bigint, The unique identifier for the course.. Value examples: ['1', '2'].),\n  (name:text, The name of the course.. Value examples: ['Introduction to Computer Science', 'Advanced Calculus'].),\n  (department:text, The department offering the course. Eg 'Mathematics', 'Physics'. Value examples: ['Computer Science', 'Mathematics'].),\n  (number:text, The course number/code.. Value examples: ['CS101', 'MATH201'].),\n  (credits:text, The number of credits awarded for completing the course.. Value examples: ['3', '4'].),\n  (advisory_requirement:text, Any advisory requirements for taking the course.. Value examples: ['NULL', 'CS101'].),\n  (enforced_requirement:text, Any enforced requirements for taking the course.. Value examples: ['NULL', 'NULL'].),\n  (description:text, A brief description of the course content.. Value examples: ['This course introduces the basics of computer science.', 'This course covers advanced topics in calculus.'].),\n  (num_semesters:bigint, The number of semesters the course is offered in a year.. Value examples: ['2', '1'].),\n  (num_enrolled:bigint, The total number of students enrolled in the course.. Value examples: ['2', '3'].),\n  (has_discussion:boolean, Indicates whether the course has any discussion sessions or not.. Value examples: ['true', 'false'].),\n  (has_lab:boolean, Indicates whether the course has any lab sessions or not.. Value examples: ['false', 'false'].),\n  (has_projects:boolean, Indicates whether the course has any projects or not.. Value examples: ['true', 'true'].),\n  (has_exams:boolean, Indicates whether the course has any exams or not.. Value examples: ['false', 'true'].),\n  (num_reviews:bigint, The total number of reviews/ratings for the course.. Value examples: ['10', '5'].),\n  (clarity_score:bigint, The overall clarity score of the course as rated by students.. Value examples: ['5', '4'].),\n  (easiness_score:bigint, The overall easiness score of the course as rated by students.. Value examples: ['3', '2'].),\n  (helpfulness_score:bigint, The overall helpfulness score of the course as rated by students.. Value examples: ['4', '3'].),\n]\n# Table: course_offering\n[\n  (offering_id:bigint, Unique identifier for each course offering. Value examples: ['1', '2', '3'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course is offered. Value examples: ['1', '1', '2'].),\n  (section_number:bigint, The section number of the course. Value examples: ['1', '1', '1'].),\n  (start_time:time, The start time of the course. Value examples: ['08:00:00', '10:00:00', '08:00:00'].),\n  (end_time:time, The end time of the course. Value examples: ['10:00:00', '12:00:00', '10:00:00'].),\n  (monday:text, The instructor's name for Monday. Value examples: ['John Smith', 'NULL', 'John Smith'].),\n  (tuesday:text, The instructor's name for Tuesday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (wednesday:text, The instructor's name for Wednesday. Value examples: ['NULL', 'Gilbert Strang', 'NULL'].),\n  (thursday:text, The instructor's name for Thursday. Value examples: ['Jane Doe', 'NULL', 'Jane Doe'].),\n  (friday:text, The instructor's name for Friday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (saturday:text, The instructor's name for Saturday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (sunday:text, The instructor's name for Sunday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (has_final_project:boolean, Indicates whether the course has a final project. Value examples: ['true', 'true', 'false'].),\n  (has_final_exam:boolean, Indicates whether the course has a final exam. Value examples: ['false', 'true', 'true'].),\n  (textbook:text, The name of the textbook used in the course. Value examples: ['Introduction to Computer Science', 'Advanced Calculus', 'Introduction to Physics'].),\n  (class_address:text, The address of the classroom where the course is held. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (allow_audit:text, Indicates whether auditing the course is allowed. Value examples: ['true', 'false', 'true'].),\n]\n# Table: course_prerequisite\n[\n  (pre_course_id:bigint, The ID of the prerequisite course. Value examples: ['1', '2'].),\n  (course_id:bigint, The ID of the course that has the prerequisite. Value examples: ['2', '3'].),\n]\n# Table: course_tags_count\n[\n  (course_id:bigint, The unique identifier for each course.. Value examples: ['1', '2', '3'].),\n  (clear_grading:bigint, Number of students who found the grading criteria clear and easy to understand.. Value examples: ['5', '4', '3'].),\n  (pop_quiz:bigint, Number of pop quizzes given during the course.. Value examples: ['2', '1', '2'].),\n  (group_projects:bigint, Number of group projects assigned during the course.. Value examples: ['3', '2', '1'].),\n  (inspirational:bigint, Number of students who found the course content inspirational.. Value examples: ['4', '3', '2'].),\n  (long_lectures:bigint, Number of students who found the lectures to be too long.. Value examples: ['2', '1', '3'].),\n  (extra_credit:bigint, Number of extra credit opportunities provided during the course.. Value examples: ['1', '2', '1'].),\n  (few_tests:bigint, Number of tests given during the course.. Value examples: ['3', '2', '1'].),\n  (good_feedback:bigint, Number of students who received good feedback from the instructor.. Value examples: ['4', '3', '2'].),\n  (tough_tests:bigint, Number of students who found the tests to be tough.. Value examples: ['2', '1', '3'].),\n  (heavy_papers:bigint, Number of papers assigned during the course.. Value examples: ['1', '2', '1'].),\n  (cares_for_students:bigint, Number of students who felt that the instructor cared for their well-being.. Value examples: ['5', '4', '3'].),\n  (heavy_assignments:bigint, Number of assignments given during the course.. Value examples: ['3', '2', '1'].),\n  (respected:bigint, Number of students who respected the instructor.. Value examples: ['4', '3', '2'].),\n  (participation:bigint, Number of students who participated actively in the course.. Value examples: ['2', '1', '3'].),\n  (heavy_reading:bigint, Number of reading assignments given during the course.. Value examples: ['1', '2', '1'].),\n  (tough_grader:bigint, Number of students who found the instructor to be a tough grader.. Value examples: ['5', '4', '3'].),\n  (hilarious:bigint, Number of students who found the instructor to be hilarious.. Value examples: ['3', '2', '1'].),\n  (would_take_again:bigint, Number of students who would take the course again.. Value examples: ['4', '3', '2'].),\n  (good_lecture:bigint, Number of students who found the lectures to be good.. Value examples: ['2', '1', '3'].),\n  (no_skip:bigint, Number of students who did not skip any classes during the course.. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: instructor\n[\n  (instructor_id:bigint, Unique identifier for each instructor. Value examples: ['1', '2'].),\n  (name:text, Name of the instructor. Value examples: ['John Smith', 'Jane Doe'].),\n  (uniqname:text, Unique name of the instructor used for login and identification purposes. Value examples: ['jsmith', 'jdoe'].),\n]\n# Table: offering_instructor\n[\n  (offering_instructor_id:bigint, Unique identifier for each offering-instructor pair. Value examples: ['1', '2', '3'].),\n  (offering_id:bigint, Foreign key referencing the offering table. Value examples: ['1', '1', '2'].),\n  (instructor_id:bigint, Foreign key referencing the instructor table. Value examples: ['1', '2', '3'].),\n]\n# Table: program\n[\n  (program_id:bigint, Unique identifier for each program. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the program, Eg 'Computer Science', 'Physics'. Value examples: ['Computer Science', 'Mathematics', 'Physics'].),\n  (college:text, Name of the college offering the program. Value examples: ['Engineering', 'Arts and Sciences', 'Arts and Sciences'].),\n  (introduction:text, Introduction to the program. Value examples: ['This program focuses on computer science principles and applications.', 'This program provides a comprehensive study of mathematical concepts and theories.', 'This program explores the fundamental principles of physics and their applications.'].),\n]\n# Table: program_course\n[\n  (program_id:bigint, The ID of the program associated with the course. Value examples: ['1', '1'].),\n  (course_id:bigint, The ID of the course. Value examples: ['1', '4'].),\n  (workload:bigint, The workload of the course in hours. Value examples: ['100', '80'].),\n  (category:text, The category of the course. Can only be 'Core' or 'Elective'.. Value examples: ['Core', 'Elective'].),\n]\n# Table: program_requirement\n[\n  (program_id:bigint, Unique identifier for a program. Value examples: ['1', '2', '3'].),\n  (category:text, Category of the program. Value examples: ['Core', 'Core', 'Core'].),\n  (min_credit:bigint, Minimum number of credits required for the program. Value examples: ['120', '90', '200'].),\n  (additional_req:text, Additional requirements for the program, if any. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: semester\n[\n  (semester_id:bigint, Unique identifier for each semester. Sort by this column to get the right year-semester order.. Value examples: ['1', '2', '3', '4'].),\n  (semester:text, The name or identifier for the semester Can only be 'Fall', 'Spring', or 'Summer'. Value examples: ['Fall', 'Spring', 'Summer', 'Fall'].),\n  (year:bigint, The year in which the semester takes place. Value examples: ['2020', '2021', '2021', '2021'].),\n]\n# Table: student\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '2', '3'].),\n  (lastname:text, Last name of the student. Value examples: ['Smith', 'Doe', 'Johnson'].),\n  (firstname:text, First name of the student. Value examples: ['John', 'Jane', 'David'].),\n  (program_id:bigint, Identifier for the program the student is enrolled in. Value examples: ['1', '1', '2'].),\n  (declare_major:text, Major program the student declared. Value examples: ['Computer Science', 'Computer Science', 'Mathematics'].),\n  (total_credit:bigint, Total number of credits earned by the student. Value examples: ['13', '7', '7'].),\n  (total_gpa:numeric, Cumulative GPA of the student. Value examples: ['3.5', '3.2', '3.6'].),\n  (entered_as:text, Status of the student when they entered the program. e.g. 'Freshman', 'Transfer Student'. Value examples: ['Freshman', 'Freshman', 'Freshman'].),\n  (admit_term:date, Term in which the student was admitted. Format is YYYY-MM-DD. Value examples: ['2018-01-01', '2018-01-01', '2019-01-01'].),\n  (predicted_graduation_semester:date, Semester in which the student is predicted to graduate. Format is YYYY-MM-DD. Value examples: ['2022-05-01', '2022-05-01', '2022-05-01'].),\n  (degree:text, Degree program the student is enrolled in. Can only be 'Bachelor of Science' or 'Bachelor of Arts'.. Value examples: ['Bachelor of Science', 'Bachelor of Science', 'Bachelor of Arts'].),\n  (minor:text, Minor program the student is enrolled in. Value examples: ['NULL', 'NULL', 'Mathematics'].),\n  (internship:text, Internship program the student is enrolled in. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: student_record\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '1', '1'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course was taken. Value examples: ['1', '1', '2'].),\n  (grade:text, The grade received for the course. Value examples: ['A', 'A', 'A'].),\n  (how:text, How the student took the course. Can only be 'in-person' or 'online'.. Value examples: ['in-person', 'in-person', 'in-person'].),\n  (transfer_source:text, If the course was transferred from another institution, the name of that institution. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (earn_credit:text, Whether the student earned credit for the course (e.g. Yes, No). Value examples: ['Yes', 'Yes', 'Yes'].),\n  (repeat_term:text, If the student repeated the course, the semester in which it was repeated. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (test_id:text, Unique identifier for each test taken in the course. Value examples: ['1', '1', '1'].),\n  (offering_id:bigint, Unique identifier for each offering of a course. Value examples: ['1', '2', '3'].),\n]\n\n【Foreign keys】\narea.course_id = course.course_id\ncomment_instructor.instructor_id = instructor.instructor_id\ncomment_instructor.student_id = student.student_id\ncourse.course_id = course_offering.course_id\ncourse.course_id = course_prerequisite.course_id\ncourse.course_id = course_tags_count.course_id\ncourse.course_id = program_course.course_id\ncourse.course_id = student_record.course_id\ncourse_offering.offering_id = offering_instructor.offering_id\ncourse_offering.offering_id = student_record.offering_id\ninstructor.instructor_id = offering_instructor.instructor_id\nprogram.program_id = program_course.program_id\nprogram.program_id = program_requirement.program_id\nprogram.program_id = student.program_id\nstudent.student_id = student_record.student_id\n\n【参考信息】\n\n\n【用户问题】\nWhat is the ratio of the number of courses with projects to the number of courses with exams in each semester id?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT course_offering.semester, CAST(SUM(CASE WHEN course.has_projects THEN 1 ELSE 0 END) AS FLOAT) / NULLIF(SUM(CASE WHEN course.has_exams THEN 1 ELSE 0 END), 0) AS ratio FROM course JOIN course_offering ON course.course_id = course_offering.course_id GROUP BY course_offering.semester ORDER BY course_offering.semester NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "advising",
    "id": 47,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the ratio of helpfulness scores to clarity scores for each course ID?\n\n【数据库schema】\n【DB_ID】 advising\n【Schema】\n# Table: area\n[\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2'].),\n  (area:text, The area of study for each course. Value examples: ['Computer Science', 'Mathematics'].),\n]\n# Table: comment_instructor\n[\n  (instructor_id:bigint, Unique identifier for the instructor. Value examples: ['1', '2'].),\n  (student_id:bigint, Unique identifier for the student. Value examples: ['1', '2'].),\n  (score:bigint, Score given by the student to the instructor. Value examples: ['5', '4'].),\n  (comment_text:text, Textual comment given by the student about the instructor. Value examples: ['John Smith is a great instructor.', 'Jane Doe explains concepts clearly.'].),\n]\n# Table: course\n[\n  (course_id:bigint, The unique identifier for the course.. Value examples: ['1', '2'].),\n  (name:text, The name of the course.. Value examples: ['Introduction to Computer Science', 'Advanced Calculus'].),\n  (department:text, The department offering the course. Eg 'Mathematics', 'Physics'. Value examples: ['Computer Science', 'Mathematics'].),\n  (number:text, The course number/code.. Value examples: ['CS101', 'MATH201'].),\n  (credits:text, The number of credits awarded for completing the course.. Value examples: ['3', '4'].),\n  (advisory_requirement:text, Any advisory requirements for taking the course.. Value examples: ['NULL', 'CS101'].),\n  (enforced_requirement:text, Any enforced requirements for taking the course.. Value examples: ['NULL', 'NULL'].),\n  (description:text, A brief description of the course content.. Value examples: ['This course introduces the basics of computer science.', 'This course covers advanced topics in calculus.'].),\n  (num_semesters:bigint, The number of semesters the course is offered in a year.. Value examples: ['2', '1'].),\n  (num_enrolled:bigint, The total number of students enrolled in the course.. Value examples: ['2', '3'].),\n  (has_discussion:boolean, Indicates whether the course has any discussion sessions or not.. Value examples: ['true', 'false'].),\n  (has_lab:boolean, Indicates whether the course has any lab sessions or not.. Value examples: ['false', 'false'].),\n  (has_projects:boolean, Indicates whether the course has any projects or not.. Value examples: ['true', 'true'].),\n  (has_exams:boolean, Indicates whether the course has any exams or not.. Value examples: ['false', 'true'].),\n  (num_reviews:bigint, The total number of reviews/ratings for the course.. Value examples: ['10', '5'].),\n  (clarity_score:bigint, The overall clarity score of the course as rated by students.. Value examples: ['5', '4'].),\n  (easiness_score:bigint, The overall easiness score of the course as rated by students.. Value examples: ['3', '2'].),\n  (helpfulness_score:bigint, The overall helpfulness score of the course as rated by students.. Value examples: ['4', '3'].),\n]\n# Table: course_offering\n[\n  (offering_id:bigint, Unique identifier for each course offering. Value examples: ['1', '2', '3'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course is offered. Value examples: ['1', '1', '2'].),\n  (section_number:bigint, The section number of the course. Value examples: ['1', '1', '1'].),\n  (start_time:time, The start time of the course. Value examples: ['08:00:00', '10:00:00', '08:00:00'].),\n  (end_time:time, The end time of the course. Value examples: ['10:00:00', '12:00:00', '10:00:00'].),\n  (monday:text, The instructor's name for Monday. Value examples: ['John Smith', 'NULL', 'John Smith'].),\n  (tuesday:text, The instructor's name for Tuesday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (wednesday:text, The instructor's name for Wednesday. Value examples: ['NULL', 'Gilbert Strang', 'NULL'].),\n  (thursday:text, The instructor's name for Thursday. Value examples: ['Jane Doe', 'NULL', 'Jane Doe'].),\n  (friday:text, The instructor's name for Friday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (saturday:text, The instructor's name for Saturday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (sunday:text, The instructor's name for Sunday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (has_final_project:boolean, Indicates whether the course has a final project. Value examples: ['true', 'true', 'false'].),\n  (has_final_exam:boolean, Indicates whether the course has a final exam. Value examples: ['false', 'true', 'true'].),\n  (textbook:text, The name of the textbook used in the course. Value examples: ['Introduction to Computer Science', 'Advanced Calculus', 'Introduction to Physics'].),\n  (class_address:text, The address of the classroom where the course is held. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (allow_audit:text, Indicates whether auditing the course is allowed. Value examples: ['true', 'false', 'true'].),\n]\n# Table: course_prerequisite\n[\n  (pre_course_id:bigint, The ID of the prerequisite course. Value examples: ['1', '2'].),\n  (course_id:bigint, The ID of the course that has the prerequisite. Value examples: ['2', '3'].),\n]\n# Table: course_tags_count\n[\n  (course_id:bigint, The unique identifier for each course.. Value examples: ['1', '2', '3'].),\n  (clear_grading:bigint, Number of students who found the grading criteria clear and easy to understand.. Value examples: ['5', '4', '3'].),\n  (pop_quiz:bigint, Number of pop quizzes given during the course.. Value examples: ['2', '1', '2'].),\n  (group_projects:bigint, Number of group projects assigned during the course.. Value examples: ['3', '2', '1'].),\n  (inspirational:bigint, Number of students who found the course content inspirational.. Value examples: ['4', '3', '2'].),\n  (long_lectures:bigint, Number of students who found the lectures to be too long.. Value examples: ['2', '1', '3'].),\n  (extra_credit:bigint, Number of extra credit opportunities provided during the course.. Value examples: ['1', '2', '1'].),\n  (few_tests:bigint, Number of tests given during the course.. Value examples: ['3', '2', '1'].),\n  (good_feedback:bigint, Number of students who received good feedback from the instructor.. Value examples: ['4', '3', '2'].),\n  (tough_tests:bigint, Number of students who found the tests to be tough.. Value examples: ['2', '1', '3'].),\n  (heavy_papers:bigint, Number of papers assigned during the course.. Value examples: ['1', '2', '1'].),\n  (cares_for_students:bigint, Number of students who felt that the instructor cared for their well-being.. Value examples: ['5', '4', '3'].),\n  (heavy_assignments:bigint, Number of assignments given during the course.. Value examples: ['3', '2', '1'].),\n  (respected:bigint, Number of students who respected the instructor.. Value examples: ['4', '3', '2'].),\n  (participation:bigint, Number of students who participated actively in the course.. Value examples: ['2', '1', '3'].),\n  (heavy_reading:bigint, Number of reading assignments given during the course.. Value examples: ['1', '2', '1'].),\n  (tough_grader:bigint, Number of students who found the instructor to be a tough grader.. Value examples: ['5', '4', '3'].),\n  (hilarious:bigint, Number of students who found the instructor to be hilarious.. Value examples: ['3', '2', '1'].),\n  (would_take_again:bigint, Number of students who would take the course again.. Value examples: ['4', '3', '2'].),\n  (good_lecture:bigint, Number of students who found the lectures to be good.. Value examples: ['2', '1', '3'].),\n  (no_skip:bigint, Number of students who did not skip any classes during the course.. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: instructor\n[\n  (instructor_id:bigint, Unique identifier for each instructor. Value examples: ['1', '2'].),\n  (name:text, Name of the instructor. Value examples: ['John Smith', 'Jane Doe'].),\n  (uniqname:text, Unique name of the instructor used for login and identification purposes. Value examples: ['jsmith', 'jdoe'].),\n]\n# Table: offering_instructor\n[\n  (offering_instructor_id:bigint, Unique identifier for each offering-instructor pair. Value examples: ['1', '2', '3'].),\n  (offering_id:bigint, Foreign key referencing the offering table. Value examples: ['1', '1', '2'].),\n  (instructor_id:bigint, Foreign key referencing the instructor table. Value examples: ['1', '2', '3'].),\n]\n# Table: program\n[\n  (program_id:bigint, Unique identifier for each program. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the program, Eg 'Computer Science', 'Physics'. Value examples: ['Computer Science', 'Mathematics', 'Physics'].),\n  (college:text, Name of the college offering the program. Value examples: ['Engineering', 'Arts and Sciences', 'Arts and Sciences'].),\n  (introduction:text, Introduction to the program. Value examples: ['This program focuses on computer science principles and applications.', 'This program provides a comprehensive study of mathematical concepts and theories.', 'This program explores the fundamental principles of physics and their applications.'].),\n]\n# Table: program_course\n[\n  (program_id:bigint, The ID of the program associated with the course. Value examples: ['1', '1'].),\n  (course_id:bigint, The ID of the course. Value examples: ['1', '4'].),\n  (workload:bigint, The workload of the course in hours. Value examples: ['100', '80'].),\n  (category:text, The category of the course. Can only be 'Core' or 'Elective'.. Value examples: ['Core', 'Elective'].),\n]\n# Table: program_requirement\n[\n  (program_id:bigint, Unique identifier for a program. Value examples: ['1', '2', '3'].),\n  (category:text, Category of the program. Value examples: ['Core', 'Core', 'Core'].),\n  (min_credit:bigint, Minimum number of credits required for the program. Value examples: ['120', '90', '200'].),\n  (additional_req:text, Additional requirements for the program, if any. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: semester\n[\n  (semester_id:bigint, Unique identifier for each semester. Sort by this column to get the right year-semester order.. Value examples: ['1', '2', '3', '4'].),\n  (semester:text, The name or identifier for the semester Can only be 'Fall', 'Spring', or 'Summer'. Value examples: ['Fall', 'Spring', 'Summer', 'Fall'].),\n  (year:bigint, The year in which the semester takes place. Value examples: ['2020', '2021', '2021', '2021'].),\n]\n# Table: student\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '2', '3'].),\n  (lastname:text, Last name of the student. Value examples: ['Smith', 'Doe', 'Johnson'].),\n  (firstname:text, First name of the student. Value examples: ['John', 'Jane', 'David'].),\n  (program_id:bigint, Identifier for the program the student is enrolled in. Value examples: ['1', '1', '2'].),\n  (declare_major:text, Major program the student declared. Value examples: ['Computer Science', 'Computer Science', 'Mathematics'].),\n  (total_credit:bigint, Total number of credits earned by the student. Value examples: ['13', '7', '7'].),\n  (total_gpa:numeric, Cumulative GPA of the student. Value examples: ['3.5', '3.2', '3.6'].),\n  (entered_as:text, Status of the student when they entered the program. e.g. 'Freshman', 'Transfer Student'. Value examples: ['Freshman', 'Freshman', 'Freshman'].),\n  (admit_term:date, Term in which the student was admitted. Format is YYYY-MM-DD. Value examples: ['2018-01-01', '2018-01-01', '2019-01-01'].),\n  (predicted_graduation_semester:date, Semester in which the student is predicted to graduate. Format is YYYY-MM-DD. Value examples: ['2022-05-01', '2022-05-01', '2022-05-01'].),\n  (degree:text, Degree program the student is enrolled in. Can only be 'Bachelor of Science' or 'Bachelor of Arts'.. Value examples: ['Bachelor of Science', 'Bachelor of Science', 'Bachelor of Arts'].),\n  (minor:text, Minor program the student is enrolled in. Value examples: ['NULL', 'NULL', 'Mathematics'].),\n  (internship:text, Internship program the student is enrolled in. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: student_record\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '1', '1'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course was taken. Value examples: ['1', '1', '2'].),\n  (grade:text, The grade received for the course. Value examples: ['A', 'A', 'A'].),\n  (how:text, How the student took the course. Can only be 'in-person' or 'online'.. Value examples: ['in-person', 'in-person', 'in-person'].),\n  (transfer_source:text, If the course was transferred from another institution, the name of that institution. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (earn_credit:text, Whether the student earned credit for the course (e.g. Yes, No). Value examples: ['Yes', 'Yes', 'Yes'].),\n  (repeat_term:text, If the student repeated the course, the semester in which it was repeated. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (test_id:text, Unique identifier for each test taken in the course. Value examples: ['1', '1', '1'].),\n  (offering_id:bigint, Unique identifier for each offering of a course. Value examples: ['1', '2', '3'].),\n]\n\n【Foreign keys】\narea.course_id = course.course_id\ncomment_instructor.instructor_id = instructor.instructor_id\ncomment_instructor.student_id = student.student_id\ncourse.course_id = course_offering.course_id\ncourse.course_id = course_prerequisite.course_id\ncourse.course_id = course_tags_count.course_id\ncourse.course_id = program_course.course_id\ncourse.course_id = student_record.course_id\ncourse_offering.offering_id = offering_instructor.offering_id\ncourse_offering.offering_id = student_record.offering_id\ninstructor.instructor_id = offering_instructor.instructor_id\nprogram.program_id = program_course.program_id\nprogram.program_id = program_requirement.program_id\nprogram.program_id = student.program_id\nstudent.student_id = student_record.student_id\n\n【参考信息】\n\n\n【用户问题】\nWhat is the ratio of helpfulness scores to clarity scores for each course ID?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT course.course_id, CAST(course.helpfulness_score AS FLOAT) / NULLIF(course.clarity_score, 0) AS ratio FROM course;",
        "role": "assistant"
      }
    ],
    "db_name": "advising",
    "id": 48,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow does the ratio of enrolled students to the number of reviews vary across different courses?\n\n【数据库schema】\n【DB_ID】 advising\n【Schema】\n# Table: area\n[\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2'].),\n  (area:text, The area of study for each course. Value examples: ['Computer Science', 'Mathematics'].),\n]\n# Table: comment_instructor\n[\n  (instructor_id:bigint, Unique identifier for the instructor. Value examples: ['1', '2'].),\n  (student_id:bigint, Unique identifier for the student. Value examples: ['1', '2'].),\n  (score:bigint, Score given by the student to the instructor. Value examples: ['5', '4'].),\n  (comment_text:text, Textual comment given by the student about the instructor. Value examples: ['John Smith is a great instructor.', 'Jane Doe explains concepts clearly.'].),\n]\n# Table: course\n[\n  (course_id:bigint, The unique identifier for the course.. Value examples: ['1', '2'].),\n  (name:text, The name of the course.. Value examples: ['Introduction to Computer Science', 'Advanced Calculus'].),\n  (department:text, The department offering the course. Eg 'Mathematics', 'Physics'. Value examples: ['Computer Science', 'Mathematics'].),\n  (number:text, The course number/code.. Value examples: ['CS101', 'MATH201'].),\n  (credits:text, The number of credits awarded for completing the course.. Value examples: ['3', '4'].),\n  (advisory_requirement:text, Any advisory requirements for taking the course.. Value examples: ['NULL', 'CS101'].),\n  (enforced_requirement:text, Any enforced requirements for taking the course.. Value examples: ['NULL', 'NULL'].),\n  (description:text, A brief description of the course content.. Value examples: ['This course introduces the basics of computer science.', 'This course covers advanced topics in calculus.'].),\n  (num_semesters:bigint, The number of semesters the course is offered in a year.. Value examples: ['2', '1'].),\n  (num_enrolled:bigint, The total number of students enrolled in the course.. Value examples: ['2', '3'].),\n  (has_discussion:boolean, Indicates whether the course has any discussion sessions or not.. Value examples: ['true', 'false'].),\n  (has_lab:boolean, Indicates whether the course has any lab sessions or not.. Value examples: ['false', 'false'].),\n  (has_projects:boolean, Indicates whether the course has any projects or not.. Value examples: ['true', 'true'].),\n  (has_exams:boolean, Indicates whether the course has any exams or not.. Value examples: ['false', 'true'].),\n  (num_reviews:bigint, The total number of reviews/ratings for the course.. Value examples: ['10', '5'].),\n  (clarity_score:bigint, The overall clarity score of the course as rated by students.. Value examples: ['5', '4'].),\n  (easiness_score:bigint, The overall easiness score of the course as rated by students.. Value examples: ['3', '2'].),\n  (helpfulness_score:bigint, The overall helpfulness score of the course as rated by students.. Value examples: ['4', '3'].),\n]\n# Table: course_offering\n[\n  (offering_id:bigint, Unique identifier for each course offering. Value examples: ['1', '2', '3'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course is offered. Value examples: ['1', '1', '2'].),\n  (section_number:bigint, The section number of the course. Value examples: ['1', '1', '1'].),\n  (start_time:time, The start time of the course. Value examples: ['08:00:00', '10:00:00', '08:00:00'].),\n  (end_time:time, The end time of the course. Value examples: ['10:00:00', '12:00:00', '10:00:00'].),\n  (monday:text, The instructor's name for Monday. Value examples: ['John Smith', 'NULL', 'John Smith'].),\n  (tuesday:text, The instructor's name for Tuesday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (wednesday:text, The instructor's name for Wednesday. Value examples: ['NULL', 'Gilbert Strang', 'NULL'].),\n  (thursday:text, The instructor's name for Thursday. Value examples: ['Jane Doe', 'NULL', 'Jane Doe'].),\n  (friday:text, The instructor's name for Friday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (saturday:text, The instructor's name for Saturday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (sunday:text, The instructor's name for Sunday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (has_final_project:boolean, Indicates whether the course has a final project. Value examples: ['true', 'true', 'false'].),\n  (has_final_exam:boolean, Indicates whether the course has a final exam. Value examples: ['false', 'true', 'true'].),\n  (textbook:text, The name of the textbook used in the course. Value examples: ['Introduction to Computer Science', 'Advanced Calculus', 'Introduction to Physics'].),\n  (class_address:text, The address of the classroom where the course is held. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (allow_audit:text, Indicates whether auditing the course is allowed. Value examples: ['true', 'false', 'true'].),\n]\n# Table: course_prerequisite\n[\n  (pre_course_id:bigint, The ID of the prerequisite course. Value examples: ['1', '2'].),\n  (course_id:bigint, The ID of the course that has the prerequisite. Value examples: ['2', '3'].),\n]\n# Table: course_tags_count\n[\n  (course_id:bigint, The unique identifier for each course.. Value examples: ['1', '2', '3'].),\n  (clear_grading:bigint, Number of students who found the grading criteria clear and easy to understand.. Value examples: ['5', '4', '3'].),\n  (pop_quiz:bigint, Number of pop quizzes given during the course.. Value examples: ['2', '1', '2'].),\n  (group_projects:bigint, Number of group projects assigned during the course.. Value examples: ['3', '2', '1'].),\n  (inspirational:bigint, Number of students who found the course content inspirational.. Value examples: ['4', '3', '2'].),\n  (long_lectures:bigint, Number of students who found the lectures to be too long.. Value examples: ['2', '1', '3'].),\n  (extra_credit:bigint, Number of extra credit opportunities provided during the course.. Value examples: ['1', '2', '1'].),\n  (few_tests:bigint, Number of tests given during the course.. Value examples: ['3', '2', '1'].),\n  (good_feedback:bigint, Number of students who received good feedback from the instructor.. Value examples: ['4', '3', '2'].),\n  (tough_tests:bigint, Number of students who found the tests to be tough.. Value examples: ['2', '1', '3'].),\n  (heavy_papers:bigint, Number of papers assigned during the course.. Value examples: ['1', '2', '1'].),\n  (cares_for_students:bigint, Number of students who felt that the instructor cared for their well-being.. Value examples: ['5', '4', '3'].),\n  (heavy_assignments:bigint, Number of assignments given during the course.. Value examples: ['3', '2', '1'].),\n  (respected:bigint, Number of students who respected the instructor.. Value examples: ['4', '3', '2'].),\n  (participation:bigint, Number of students who participated actively in the course.. Value examples: ['2', '1', '3'].),\n  (heavy_reading:bigint, Number of reading assignments given during the course.. Value examples: ['1', '2', '1'].),\n  (tough_grader:bigint, Number of students who found the instructor to be a tough grader.. Value examples: ['5', '4', '3'].),\n  (hilarious:bigint, Number of students who found the instructor to be hilarious.. Value examples: ['3', '2', '1'].),\n  (would_take_again:bigint, Number of students who would take the course again.. Value examples: ['4', '3', '2'].),\n  (good_lecture:bigint, Number of students who found the lectures to be good.. Value examples: ['2', '1', '3'].),\n  (no_skip:bigint, Number of students who did not skip any classes during the course.. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: instructor\n[\n  (instructor_id:bigint, Unique identifier for each instructor. Value examples: ['1', '2'].),\n  (name:text, Name of the instructor. Value examples: ['John Smith', 'Jane Doe'].),\n  (uniqname:text, Unique name of the instructor used for login and identification purposes. Value examples: ['jsmith', 'jdoe'].),\n]\n# Table: offering_instructor\n[\n  (offering_instructor_id:bigint, Unique identifier for each offering-instructor pair. Value examples: ['1', '2', '3'].),\n  (offering_id:bigint, Foreign key referencing the offering table. Value examples: ['1', '1', '2'].),\n  (instructor_id:bigint, Foreign key referencing the instructor table. Value examples: ['1', '2', '3'].),\n]\n# Table: program\n[\n  (program_id:bigint, Unique identifier for each program. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the program, Eg 'Computer Science', 'Physics'. Value examples: ['Computer Science', 'Mathematics', 'Physics'].),\n  (college:text, Name of the college offering the program. Value examples: ['Engineering', 'Arts and Sciences', 'Arts and Sciences'].),\n  (introduction:text, Introduction to the program. Value examples: ['This program focuses on computer science principles and applications.', 'This program provides a comprehensive study of mathematical concepts and theories.', 'This program explores the fundamental principles of physics and their applications.'].),\n]\n# Table: program_course\n[\n  (program_id:bigint, The ID of the program associated with the course. Value examples: ['1', '1'].),\n  (course_id:bigint, The ID of the course. Value examples: ['1', '4'].),\n  (workload:bigint, The workload of the course in hours. Value examples: ['100', '80'].),\n  (category:text, The category of the course. Can only be 'Core' or 'Elective'.. Value examples: ['Core', 'Elective'].),\n]\n# Table: program_requirement\n[\n  (program_id:bigint, Unique identifier for a program. Value examples: ['1', '2', '3'].),\n  (category:text, Category of the program. Value examples: ['Core', 'Core', 'Core'].),\n  (min_credit:bigint, Minimum number of credits required for the program. Value examples: ['120', '90', '200'].),\n  (additional_req:text, Additional requirements for the program, if any. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: semester\n[\n  (semester_id:bigint, Unique identifier for each semester. Sort by this column to get the right year-semester order.. Value examples: ['1', '2', '3', '4'].),\n  (semester:text, The name or identifier for the semester Can only be 'Fall', 'Spring', or 'Summer'. Value examples: ['Fall', 'Spring', 'Summer', 'Fall'].),\n  (year:bigint, The year in which the semester takes place. Value examples: ['2020', '2021', '2021', '2021'].),\n]\n# Table: student\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '2', '3'].),\n  (lastname:text, Last name of the student. Value examples: ['Smith', 'Doe', 'Johnson'].),\n  (firstname:text, First name of the student. Value examples: ['John', 'Jane', 'David'].),\n  (program_id:bigint, Identifier for the program the student is enrolled in. Value examples: ['1', '1', '2'].),\n  (declare_major:text, Major program the student declared. Value examples: ['Computer Science', 'Computer Science', 'Mathematics'].),\n  (total_credit:bigint, Total number of credits earned by the student. Value examples: ['13', '7', '7'].),\n  (total_gpa:numeric, Cumulative GPA of the student. Value examples: ['3.5', '3.2', '3.6'].),\n  (entered_as:text, Status of the student when they entered the program. e.g. 'Freshman', 'Transfer Student'. Value examples: ['Freshman', 'Freshman', 'Freshman'].),\n  (admit_term:date, Term in which the student was admitted. Format is YYYY-MM-DD. Value examples: ['2018-01-01', '2018-01-01', '2019-01-01'].),\n  (predicted_graduation_semester:date, Semester in which the student is predicted to graduate. Format is YYYY-MM-DD. Value examples: ['2022-05-01', '2022-05-01', '2022-05-01'].),\n  (degree:text, Degree program the student is enrolled in. Can only be 'Bachelor of Science' or 'Bachelor of Arts'.. Value examples: ['Bachelor of Science', 'Bachelor of Science', 'Bachelor of Arts'].),\n  (minor:text, Minor program the student is enrolled in. Value examples: ['NULL', 'NULL', 'Mathematics'].),\n  (internship:text, Internship program the student is enrolled in. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: student_record\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '1', '1'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course was taken. Value examples: ['1', '1', '2'].),\n  (grade:text, The grade received for the course. Value examples: ['A', 'A', 'A'].),\n  (how:text, How the student took the course. Can only be 'in-person' or 'online'.. Value examples: ['in-person', 'in-person', 'in-person'].),\n  (transfer_source:text, If the course was transferred from another institution, the name of that institution. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (earn_credit:text, Whether the student earned credit for the course (e.g. Yes, No). Value examples: ['Yes', 'Yes', 'Yes'].),\n  (repeat_term:text, If the student repeated the course, the semester in which it was repeated. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (test_id:text, Unique identifier for each test taken in the course. Value examples: ['1', '1', '1'].),\n  (offering_id:bigint, Unique identifier for each offering of a course. Value examples: ['1', '2', '3'].),\n]\n\n【Foreign keys】\narea.course_id = course.course_id\ncomment_instructor.instructor_id = instructor.instructor_id\ncomment_instructor.student_id = student.student_id\ncourse.course_id = course_offering.course_id\ncourse.course_id = course_prerequisite.course_id\ncourse.course_id = course_tags_count.course_id\ncourse.course_id = program_course.course_id\ncourse.course_id = student_record.course_id\ncourse_offering.offering_id = offering_instructor.offering_id\ncourse_offering.offering_id = student_record.offering_id\ninstructor.instructor_id = offering_instructor.instructor_id\nprogram.program_id = program_course.program_id\nprogram.program_id = program_requirement.program_id\nprogram.program_id = student.program_id\nstudent.student_id = student_record.student_id\n\n【参考信息】\n\n\n【用户问题】\nHow does the ratio of enrolled students to the number of reviews vary across different courses?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT course.course_id, course.name, course.number, CAST(course.num_enrolled AS FLOAT) / NULLIF(course.num_reviews, 0) AS student_review_ratio FROM course ORDER BY student_review_ratio NULLS LAST",
        "role": "assistant"
      }
    ],
    "db_name": "advising",
    "id": 49,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich courses have been taken by students in the Computer Science program?\n\n【数据库schema】\n【DB_ID】 advising\n【Schema】\n# Table: area\n[\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2'].),\n  (area:text, The area of study for each course. Value examples: ['Computer Science', 'Mathematics'].),\n]\n# Table: comment_instructor\n[\n  (instructor_id:bigint, Unique identifier for the instructor. Value examples: ['1', '2'].),\n  (student_id:bigint, Unique identifier for the student. Value examples: ['1', '2'].),\n  (score:bigint, Score given by the student to the instructor. Value examples: ['5', '4'].),\n  (comment_text:text, Textual comment given by the student about the instructor. Value examples: ['John Smith is a great instructor.', 'Jane Doe explains concepts clearly.'].),\n]\n# Table: course\n[\n  (course_id:bigint, The unique identifier for the course.. Value examples: ['1', '2'].),\n  (name:text, The name of the course.. Value examples: ['Introduction to Computer Science', 'Advanced Calculus'].),\n  (department:text, The department offering the course. Eg 'Mathematics', 'Physics'. Value examples: ['Computer Science', 'Mathematics'].),\n  (number:text, The course number/code.. Value examples: ['CS101', 'MATH201'].),\n  (credits:text, The number of credits awarded for completing the course.. Value examples: ['3', '4'].),\n  (advisory_requirement:text, Any advisory requirements for taking the course.. Value examples: ['NULL', 'CS101'].),\n  (enforced_requirement:text, Any enforced requirements for taking the course.. Value examples: ['NULL', 'NULL'].),\n  (description:text, A brief description of the course content.. Value examples: ['This course introduces the basics of computer science.', 'This course covers advanced topics in calculus.'].),\n  (num_semesters:bigint, The number of semesters the course is offered in a year.. Value examples: ['2', '1'].),\n  (num_enrolled:bigint, The total number of students enrolled in the course.. Value examples: ['2', '3'].),\n  (has_discussion:boolean, Indicates whether the course has any discussion sessions or not.. Value examples: ['true', 'false'].),\n  (has_lab:boolean, Indicates whether the course has any lab sessions or not.. Value examples: ['false', 'false'].),\n  (has_projects:boolean, Indicates whether the course has any projects or not.. Value examples: ['true', 'true'].),\n  (has_exams:boolean, Indicates whether the course has any exams or not.. Value examples: ['false', 'true'].),\n  (num_reviews:bigint, The total number of reviews/ratings for the course.. Value examples: ['10', '5'].),\n  (clarity_score:bigint, The overall clarity score of the course as rated by students.. Value examples: ['5', '4'].),\n  (easiness_score:bigint, The overall easiness score of the course as rated by students.. Value examples: ['3', '2'].),\n  (helpfulness_score:bigint, The overall helpfulness score of the course as rated by students.. Value examples: ['4', '3'].),\n]\n# Table: course_offering\n[\n  (offering_id:bigint, Unique identifier for each course offering. Value examples: ['1', '2', '3'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course is offered. Value examples: ['1', '1', '2'].),\n  (section_number:bigint, The section number of the course. Value examples: ['1', '1', '1'].),\n  (start_time:time, The start time of the course. Value examples: ['08:00:00', '10:00:00', '08:00:00'].),\n  (end_time:time, The end time of the course. Value examples: ['10:00:00', '12:00:00', '10:00:00'].),\n  (monday:text, The instructor's name for Monday. Value examples: ['John Smith', 'NULL', 'John Smith'].),\n  (tuesday:text, The instructor's name for Tuesday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (wednesday:text, The instructor's name for Wednesday. Value examples: ['NULL', 'Gilbert Strang', 'NULL'].),\n  (thursday:text, The instructor's name for Thursday. Value examples: ['Jane Doe', 'NULL', 'Jane Doe'].),\n  (friday:text, The instructor's name for Friday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (saturday:text, The instructor's name for Saturday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (sunday:text, The instructor's name for Sunday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (has_final_project:boolean, Indicates whether the course has a final project. Value examples: ['true', 'true', 'false'].),\n  (has_final_exam:boolean, Indicates whether the course has a final exam. Value examples: ['false', 'true', 'true'].),\n  (textbook:text, The name of the textbook used in the course. Value examples: ['Introduction to Computer Science', 'Advanced Calculus', 'Introduction to Physics'].),\n  (class_address:text, The address of the classroom where the course is held. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (allow_audit:text, Indicates whether auditing the course is allowed. Value examples: ['true', 'false', 'true'].),\n]\n# Table: course_prerequisite\n[\n  (pre_course_id:bigint, The ID of the prerequisite course. Value examples: ['1', '2'].),\n  (course_id:bigint, The ID of the course that has the prerequisite. Value examples: ['2', '3'].),\n]\n# Table: course_tags_count\n[\n  (course_id:bigint, The unique identifier for each course.. Value examples: ['1', '2', '3'].),\n  (clear_grading:bigint, Number of students who found the grading criteria clear and easy to understand.. Value examples: ['5', '4', '3'].),\n  (pop_quiz:bigint, Number of pop quizzes given during the course.. Value examples: ['2', '1', '2'].),\n  (group_projects:bigint, Number of group projects assigned during the course.. Value examples: ['3', '2', '1'].),\n  (inspirational:bigint, Number of students who found the course content inspirational.. Value examples: ['4', '3', '2'].),\n  (long_lectures:bigint, Number of students who found the lectures to be too long.. Value examples: ['2', '1', '3'].),\n  (extra_credit:bigint, Number of extra credit opportunities provided during the course.. Value examples: ['1', '2', '1'].),\n  (few_tests:bigint, Number of tests given during the course.. Value examples: ['3', '2', '1'].),\n  (good_feedback:bigint, Number of students who received good feedback from the instructor.. Value examples: ['4', '3', '2'].),\n  (tough_tests:bigint, Number of students who found the tests to be tough.. Value examples: ['2', '1', '3'].),\n  (heavy_papers:bigint, Number of papers assigned during the course.. Value examples: ['1', '2', '1'].),\n  (cares_for_students:bigint, Number of students who felt that the instructor cared for their well-being.. Value examples: ['5', '4', '3'].),\n  (heavy_assignments:bigint, Number of assignments given during the course.. Value examples: ['3', '2', '1'].),\n  (respected:bigint, Number of students who respected the instructor.. Value examples: ['4', '3', '2'].),\n  (participation:bigint, Number of students who participated actively in the course.. Value examples: ['2', '1', '3'].),\n  (heavy_reading:bigint, Number of reading assignments given during the course.. Value examples: ['1', '2', '1'].),\n  (tough_grader:bigint, Number of students who found the instructor to be a tough grader.. Value examples: ['5', '4', '3'].),\n  (hilarious:bigint, Number of students who found the instructor to be hilarious.. Value examples: ['3', '2', '1'].),\n  (would_take_again:bigint, Number of students who would take the course again.. Value examples: ['4', '3', '2'].),\n  (good_lecture:bigint, Number of students who found the lectures to be good.. Value examples: ['2', '1', '3'].),\n  (no_skip:bigint, Number of students who did not skip any classes during the course.. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: instructor\n[\n  (instructor_id:bigint, Unique identifier for each instructor. Value examples: ['1', '2'].),\n  (name:text, Name of the instructor. Value examples: ['John Smith', 'Jane Doe'].),\n  (uniqname:text, Unique name of the instructor used for login and identification purposes. Value examples: ['jsmith', 'jdoe'].),\n]\n# Table: offering_instructor\n[\n  (offering_instructor_id:bigint, Unique identifier for each offering-instructor pair. Value examples: ['1', '2', '3'].),\n  (offering_id:bigint, Foreign key referencing the offering table. Value examples: ['1', '1', '2'].),\n  (instructor_id:bigint, Foreign key referencing the instructor table. Value examples: ['1', '2', '3'].),\n]\n# Table: program\n[\n  (program_id:bigint, Unique identifier for each program. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the program, Eg 'Computer Science', 'Physics'. Value examples: ['Computer Science', 'Mathematics', 'Physics'].),\n  (college:text, Name of the college offering the program. Value examples: ['Engineering', 'Arts and Sciences', 'Arts and Sciences'].),\n  (introduction:text, Introduction to the program. Value examples: ['This program focuses on computer science principles and applications.', 'This program provides a comprehensive study of mathematical concepts and theories.', 'This program explores the fundamental principles of physics and their applications.'].),\n]\n# Table: program_course\n[\n  (program_id:bigint, The ID of the program associated with the course. Value examples: ['1', '1'].),\n  (course_id:bigint, The ID of the course. Value examples: ['1', '4'].),\n  (workload:bigint, The workload of the course in hours. Value examples: ['100', '80'].),\n  (category:text, The category of the course. Can only be 'Core' or 'Elective'.. Value examples: ['Core', 'Elective'].),\n]\n# Table: program_requirement\n[\n  (program_id:bigint, Unique identifier for a program. Value examples: ['1', '2', '3'].),\n  (category:text, Category of the program. Value examples: ['Core', 'Core', 'Core'].),\n  (min_credit:bigint, Minimum number of credits required for the program. Value examples: ['120', '90', '200'].),\n  (additional_req:text, Additional requirements for the program, if any. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: semester\n[\n  (semester_id:bigint, Unique identifier for each semester. Sort by this column to get the right year-semester order.. Value examples: ['1', '2', '3', '4'].),\n  (semester:text, The name or identifier for the semester Can only be 'Fall', 'Spring', or 'Summer'. Value examples: ['Fall', 'Spring', 'Summer', 'Fall'].),\n  (year:bigint, The year in which the semester takes place. Value examples: ['2020', '2021', '2021', '2021'].),\n]\n# Table: student\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '2', '3'].),\n  (lastname:text, Last name of the student. Value examples: ['Smith', 'Doe', 'Johnson'].),\n  (firstname:text, First name of the student. Value examples: ['John', 'Jane', 'David'].),\n  (program_id:bigint, Identifier for the program the student is enrolled in. Value examples: ['1', '1', '2'].),\n  (declare_major:text, Major program the student declared. Value examples: ['Computer Science', 'Computer Science', 'Mathematics'].),\n  (total_credit:bigint, Total number of credits earned by the student. Value examples: ['13', '7', '7'].),\n  (total_gpa:numeric, Cumulative GPA of the student. Value examples: ['3.5', '3.2', '3.6'].),\n  (entered_as:text, Status of the student when they entered the program. e.g. 'Freshman', 'Transfer Student'. Value examples: ['Freshman', 'Freshman', 'Freshman'].),\n  (admit_term:date, Term in which the student was admitted. Format is YYYY-MM-DD. Value examples: ['2018-01-01', '2018-01-01', '2019-01-01'].),\n  (predicted_graduation_semester:date, Semester in which the student is predicted to graduate. Format is YYYY-MM-DD. Value examples: ['2022-05-01', '2022-05-01', '2022-05-01'].),\n  (degree:text, Degree program the student is enrolled in. Can only be 'Bachelor of Science' or 'Bachelor of Arts'.. Value examples: ['Bachelor of Science', 'Bachelor of Science', 'Bachelor of Arts'].),\n  (minor:text, Minor program the student is enrolled in. Value examples: ['NULL', 'NULL', 'Mathematics'].),\n  (internship:text, Internship program the student is enrolled in. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: student_record\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '1', '1'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course was taken. Value examples: ['1', '1', '2'].),\n  (grade:text, The grade received for the course. Value examples: ['A', 'A', 'A'].),\n  (how:text, How the student took the course. Can only be 'in-person' or 'online'.. Value examples: ['in-person', 'in-person', 'in-person'].),\n  (transfer_source:text, If the course was transferred from another institution, the name of that institution. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (earn_credit:text, Whether the student earned credit for the course (e.g. Yes, No). Value examples: ['Yes', 'Yes', 'Yes'].),\n  (repeat_term:text, If the student repeated the course, the semester in which it was repeated. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (test_id:text, Unique identifier for each test taken in the course. Value examples: ['1', '1', '1'].),\n  (offering_id:bigint, Unique identifier for each offering of a course. Value examples: ['1', '2', '3'].),\n]\n\n【Foreign keys】\narea.course_id = course.course_id\ncomment_instructor.instructor_id = instructor.instructor_id\ncomment_instructor.student_id = student.student_id\ncourse.course_id = course_offering.course_id\ncourse.course_id = course_prerequisite.course_id\ncourse.course_id = course_tags_count.course_id\ncourse.course_id = program_course.course_id\ncourse.course_id = student_record.course_id\ncourse_offering.offering_id = offering_instructor.offering_id\ncourse_offering.offering_id = student_record.offering_id\ninstructor.instructor_id = offering_instructor.instructor_id\nprogram.program_id = program_course.program_id\nprogram.program_id = program_requirement.program_id\nprogram.program_id = student.program_id\nstudent.student_id = student_record.student_id\n\n【参考信息】\n\n\n【用户问题】\nWhich courses have been taken by students in the Computer Science program?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT DISTINCT course.name, course.course_id, course.number AS course_name FROM student JOIN student_record ON student.student_id = student_record.student_id JOIN program ON student.program_id = program.program_id JOIN course ON student_record.course_id = course.course_id WHERE program.name ILIKE '%Computer Science%'",
        "role": "assistant"
      }
    ],
    "db_name": "advising",
    "id": 50,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich courses have a final project and a final exam?\n\n【数据库schema】\n【DB_ID】 advising\n【Schema】\n# Table: area\n[\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2'].),\n  (area:text, The area of study for each course. Value examples: ['Computer Science', 'Mathematics'].),\n]\n# Table: comment_instructor\n[\n  (instructor_id:bigint, Unique identifier for the instructor. Value examples: ['1', '2'].),\n  (student_id:bigint, Unique identifier for the student. Value examples: ['1', '2'].),\n  (score:bigint, Score given by the student to the instructor. Value examples: ['5', '4'].),\n  (comment_text:text, Textual comment given by the student about the instructor. Value examples: ['John Smith is a great instructor.', 'Jane Doe explains concepts clearly.'].),\n]\n# Table: course\n[\n  (course_id:bigint, The unique identifier for the course.. Value examples: ['1', '2'].),\n  (name:text, The name of the course.. Value examples: ['Introduction to Computer Science', 'Advanced Calculus'].),\n  (department:text, The department offering the course. Eg 'Mathematics', 'Physics'. Value examples: ['Computer Science', 'Mathematics'].),\n  (number:text, The course number/code.. Value examples: ['CS101', 'MATH201'].),\n  (credits:text, The number of credits awarded for completing the course.. Value examples: ['3', '4'].),\n  (advisory_requirement:text, Any advisory requirements for taking the course.. Value examples: ['NULL', 'CS101'].),\n  (enforced_requirement:text, Any enforced requirements for taking the course.. Value examples: ['NULL', 'NULL'].),\n  (description:text, A brief description of the course content.. Value examples: ['This course introduces the basics of computer science.', 'This course covers advanced topics in calculus.'].),\n  (num_semesters:bigint, The number of semesters the course is offered in a year.. Value examples: ['2', '1'].),\n  (num_enrolled:bigint, The total number of students enrolled in the course.. Value examples: ['2', '3'].),\n  (has_discussion:boolean, Indicates whether the course has any discussion sessions or not.. Value examples: ['true', 'false'].),\n  (has_lab:boolean, Indicates whether the course has any lab sessions or not.. Value examples: ['false', 'false'].),\n  (has_projects:boolean, Indicates whether the course has any projects or not.. Value examples: ['true', 'true'].),\n  (has_exams:boolean, Indicates whether the course has any exams or not.. Value examples: ['false', 'true'].),\n  (num_reviews:bigint, The total number of reviews/ratings for the course.. Value examples: ['10', '5'].),\n  (clarity_score:bigint, The overall clarity score of the course as rated by students.. Value examples: ['5', '4'].),\n  (easiness_score:bigint, The overall easiness score of the course as rated by students.. Value examples: ['3', '2'].),\n  (helpfulness_score:bigint, The overall helpfulness score of the course as rated by students.. Value examples: ['4', '3'].),\n]\n# Table: course_offering\n[\n  (offering_id:bigint, Unique identifier for each course offering. Value examples: ['1', '2', '3'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course is offered. Value examples: ['1', '1', '2'].),\n  (section_number:bigint, The section number of the course. Value examples: ['1', '1', '1'].),\n  (start_time:time, The start time of the course. Value examples: ['08:00:00', '10:00:00', '08:00:00'].),\n  (end_time:time, The end time of the course. Value examples: ['10:00:00', '12:00:00', '10:00:00'].),\n  (monday:text, The instructor's name for Monday. Value examples: ['John Smith', 'NULL', 'John Smith'].),\n  (tuesday:text, The instructor's name for Tuesday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (wednesday:text, The instructor's name for Wednesday. Value examples: ['NULL', 'Gilbert Strang', 'NULL'].),\n  (thursday:text, The instructor's name for Thursday. Value examples: ['Jane Doe', 'NULL', 'Jane Doe'].),\n  (friday:text, The instructor's name for Friday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (saturday:text, The instructor's name for Saturday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (sunday:text, The instructor's name for Sunday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (has_final_project:boolean, Indicates whether the course has a final project. Value examples: ['true', 'true', 'false'].),\n  (has_final_exam:boolean, Indicates whether the course has a final exam. Value examples: ['false', 'true', 'true'].),\n  (textbook:text, The name of the textbook used in the course. Value examples: ['Introduction to Computer Science', 'Advanced Calculus', 'Introduction to Physics'].),\n  (class_address:text, The address of the classroom where the course is held. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (allow_audit:text, Indicates whether auditing the course is allowed. Value examples: ['true', 'false', 'true'].),\n]\n# Table: course_prerequisite\n[\n  (pre_course_id:bigint, The ID of the prerequisite course. Value examples: ['1', '2'].),\n  (course_id:bigint, The ID of the course that has the prerequisite. Value examples: ['2', '3'].),\n]\n# Table: course_tags_count\n[\n  (course_id:bigint, The unique identifier for each course.. Value examples: ['1', '2', '3'].),\n  (clear_grading:bigint, Number of students who found the grading criteria clear and easy to understand.. Value examples: ['5', '4', '3'].),\n  (pop_quiz:bigint, Number of pop quizzes given during the course.. Value examples: ['2', '1', '2'].),\n  (group_projects:bigint, Number of group projects assigned during the course.. Value examples: ['3', '2', '1'].),\n  (inspirational:bigint, Number of students who found the course content inspirational.. Value examples: ['4', '3', '2'].),\n  (long_lectures:bigint, Number of students who found the lectures to be too long.. Value examples: ['2', '1', '3'].),\n  (extra_credit:bigint, Number of extra credit opportunities provided during the course.. Value examples: ['1', '2', '1'].),\n  (few_tests:bigint, Number of tests given during the course.. Value examples: ['3', '2', '1'].),\n  (good_feedback:bigint, Number of students who received good feedback from the instructor.. Value examples: ['4', '3', '2'].),\n  (tough_tests:bigint, Number of students who found the tests to be tough.. Value examples: ['2', '1', '3'].),\n  (heavy_papers:bigint, Number of papers assigned during the course.. Value examples: ['1', '2', '1'].),\n  (cares_for_students:bigint, Number of students who felt that the instructor cared for their well-being.. Value examples: ['5', '4', '3'].),\n  (heavy_assignments:bigint, Number of assignments given during the course.. Value examples: ['3', '2', '1'].),\n  (respected:bigint, Number of students who respected the instructor.. Value examples: ['4', '3', '2'].),\n  (participation:bigint, Number of students who participated actively in the course.. Value examples: ['2', '1', '3'].),\n  (heavy_reading:bigint, Number of reading assignments given during the course.. Value examples: ['1', '2', '1'].),\n  (tough_grader:bigint, Number of students who found the instructor to be a tough grader.. Value examples: ['5', '4', '3'].),\n  (hilarious:bigint, Number of students who found the instructor to be hilarious.. Value examples: ['3', '2', '1'].),\n  (would_take_again:bigint, Number of students who would take the course again.. Value examples: ['4', '3', '2'].),\n  (good_lecture:bigint, Number of students who found the lectures to be good.. Value examples: ['2', '1', '3'].),\n  (no_skip:bigint, Number of students who did not skip any classes during the course.. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: instructor\n[\n  (instructor_id:bigint, Unique identifier for each instructor. Value examples: ['1', '2'].),\n  (name:text, Name of the instructor. Value examples: ['John Smith', 'Jane Doe'].),\n  (uniqname:text, Unique name of the instructor used for login and identification purposes. Value examples: ['jsmith', 'jdoe'].),\n]\n# Table: offering_instructor\n[\n  (offering_instructor_id:bigint, Unique identifier for each offering-instructor pair. Value examples: ['1', '2', '3'].),\n  (offering_id:bigint, Foreign key referencing the offering table. Value examples: ['1', '1', '2'].),\n  (instructor_id:bigint, Foreign key referencing the instructor table. Value examples: ['1', '2', '3'].),\n]\n# Table: program\n[\n  (program_id:bigint, Unique identifier for each program. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the program, Eg 'Computer Science', 'Physics'. Value examples: ['Computer Science', 'Mathematics', 'Physics'].),\n  (college:text, Name of the college offering the program. Value examples: ['Engineering', 'Arts and Sciences', 'Arts and Sciences'].),\n  (introduction:text, Introduction to the program. Value examples: ['This program focuses on computer science principles and applications.', 'This program provides a comprehensive study of mathematical concepts and theories.', 'This program explores the fundamental principles of physics and their applications.'].),\n]\n# Table: program_course\n[\n  (program_id:bigint, The ID of the program associated with the course. Value examples: ['1', '1'].),\n  (course_id:bigint, The ID of the course. Value examples: ['1', '4'].),\n  (workload:bigint, The workload of the course in hours. Value examples: ['100', '80'].),\n  (category:text, The category of the course. Can only be 'Core' or 'Elective'.. Value examples: ['Core', 'Elective'].),\n]\n# Table: program_requirement\n[\n  (program_id:bigint, Unique identifier for a program. Value examples: ['1', '2', '3'].),\n  (category:text, Category of the program. Value examples: ['Core', 'Core', 'Core'].),\n  (min_credit:bigint, Minimum number of credits required for the program. Value examples: ['120', '90', '200'].),\n  (additional_req:text, Additional requirements for the program, if any. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: semester\n[\n  (semester_id:bigint, Unique identifier for each semester. Sort by this column to get the right year-semester order.. Value examples: ['1', '2', '3', '4'].),\n  (semester:text, The name or identifier for the semester Can only be 'Fall', 'Spring', or 'Summer'. Value examples: ['Fall', 'Spring', 'Summer', 'Fall'].),\n  (year:bigint, The year in which the semester takes place. Value examples: ['2020', '2021', '2021', '2021'].),\n]\n# Table: student\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '2', '3'].),\n  (lastname:text, Last name of the student. Value examples: ['Smith', 'Doe', 'Johnson'].),\n  (firstname:text, First name of the student. Value examples: ['John', 'Jane', 'David'].),\n  (program_id:bigint, Identifier for the program the student is enrolled in. Value examples: ['1', '1', '2'].),\n  (declare_major:text, Major program the student declared. Value examples: ['Computer Science', 'Computer Science', 'Mathematics'].),\n  (total_credit:bigint, Total number of credits earned by the student. Value examples: ['13', '7', '7'].),\n  (total_gpa:numeric, Cumulative GPA of the student. Value examples: ['3.5', '3.2', '3.6'].),\n  (entered_as:text, Status of the student when they entered the program. e.g. 'Freshman', 'Transfer Student'. Value examples: ['Freshman', 'Freshman', 'Freshman'].),\n  (admit_term:date, Term in which the student was admitted. Format is YYYY-MM-DD. Value examples: ['2018-01-01', '2018-01-01', '2019-01-01'].),\n  (predicted_graduation_semester:date, Semester in which the student is predicted to graduate. Format is YYYY-MM-DD. Value examples: ['2022-05-01', '2022-05-01', '2022-05-01'].),\n  (degree:text, Degree program the student is enrolled in. Can only be 'Bachelor of Science' or 'Bachelor of Arts'.. Value examples: ['Bachelor of Science', 'Bachelor of Science', 'Bachelor of Arts'].),\n  (minor:text, Minor program the student is enrolled in. Value examples: ['NULL', 'NULL', 'Mathematics'].),\n  (internship:text, Internship program the student is enrolled in. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: student_record\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '1', '1'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course was taken. Value examples: ['1', '1', '2'].),\n  (grade:text, The grade received for the course. Value examples: ['A', 'A', 'A'].),\n  (how:text, How the student took the course. Can only be 'in-person' or 'online'.. Value examples: ['in-person', 'in-person', 'in-person'].),\n  (transfer_source:text, If the course was transferred from another institution, the name of that institution. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (earn_credit:text, Whether the student earned credit for the course (e.g. Yes, No). Value examples: ['Yes', 'Yes', 'Yes'].),\n  (repeat_term:text, If the student repeated the course, the semester in which it was repeated. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (test_id:text, Unique identifier for each test taken in the course. Value examples: ['1', '1', '1'].),\n  (offering_id:bigint, Unique identifier for each offering of a course. Value examples: ['1', '2', '3'].),\n]\n\n【Foreign keys】\narea.course_id = course.course_id\ncomment_instructor.instructor_id = instructor.instructor_id\ncomment_instructor.student_id = student.student_id\ncourse.course_id = course_offering.course_id\ncourse.course_id = course_prerequisite.course_id\ncourse.course_id = course_tags_count.course_id\ncourse.course_id = program_course.course_id\ncourse.course_id = student_record.course_id\ncourse_offering.offering_id = offering_instructor.offering_id\ncourse_offering.offering_id = student_record.offering_id\ninstructor.instructor_id = offering_instructor.instructor_id\nprogram.program_id = program_course.program_id\nprogram.program_id = program_requirement.program_id\nprogram.program_id = student.program_id\nstudent.student_id = student_record.student_id\n\n【参考信息】\n\n\n【用户问题】\nWhich courses have a final project and a final exam?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT DISTINCT course.name, course.course_id, course.number FROM course_offering JOIN course ON course_offering.course_id = course.course_id WHERE course_offering.has_final_project = true AND course_offering.has_final_exam = true",
        "role": "assistant"
      }
    ],
    "db_name": "advising",
    "id": 51,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the total number of students who have taken a course with a final project or exam?\n\n【数据库schema】\n【DB_ID】 advising\n【Schema】\n# Table: area\n[\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2'].),\n  (area:text, The area of study for each course. Value examples: ['Computer Science', 'Mathematics'].),\n]\n# Table: comment_instructor\n[\n  (instructor_id:bigint, Unique identifier for the instructor. Value examples: ['1', '2'].),\n  (student_id:bigint, Unique identifier for the student. Value examples: ['1', '2'].),\n  (score:bigint, Score given by the student to the instructor. Value examples: ['5', '4'].),\n  (comment_text:text, Textual comment given by the student about the instructor. Value examples: ['John Smith is a great instructor.', 'Jane Doe explains concepts clearly.'].),\n]\n# Table: course\n[\n  (course_id:bigint, The unique identifier for the course.. Value examples: ['1', '2'].),\n  (name:text, The name of the course.. Value examples: ['Introduction to Computer Science', 'Advanced Calculus'].),\n  (department:text, The department offering the course. Eg 'Mathematics', 'Physics'. Value examples: ['Computer Science', 'Mathematics'].),\n  (number:text, The course number/code.. Value examples: ['CS101', 'MATH201'].),\n  (credits:text, The number of credits awarded for completing the course.. Value examples: ['3', '4'].),\n  (advisory_requirement:text, Any advisory requirements for taking the course.. Value examples: ['NULL', 'CS101'].),\n  (enforced_requirement:text, Any enforced requirements for taking the course.. Value examples: ['NULL', 'NULL'].),\n  (description:text, A brief description of the course content.. Value examples: ['This course introduces the basics of computer science.', 'This course covers advanced topics in calculus.'].),\n  (num_semesters:bigint, The number of semesters the course is offered in a year.. Value examples: ['2', '1'].),\n  (num_enrolled:bigint, The total number of students enrolled in the course.. Value examples: ['2', '3'].),\n  (has_discussion:boolean, Indicates whether the course has any discussion sessions or not.. Value examples: ['true', 'false'].),\n  (has_lab:boolean, Indicates whether the course has any lab sessions or not.. Value examples: ['false', 'false'].),\n  (has_projects:boolean, Indicates whether the course has any projects or not.. Value examples: ['true', 'true'].),\n  (has_exams:boolean, Indicates whether the course has any exams or not.. Value examples: ['false', 'true'].),\n  (num_reviews:bigint, The total number of reviews/ratings for the course.. Value examples: ['10', '5'].),\n  (clarity_score:bigint, The overall clarity score of the course as rated by students.. Value examples: ['5', '4'].),\n  (easiness_score:bigint, The overall easiness score of the course as rated by students.. Value examples: ['3', '2'].),\n  (helpfulness_score:bigint, The overall helpfulness score of the course as rated by students.. Value examples: ['4', '3'].),\n]\n# Table: course_offering\n[\n  (offering_id:bigint, Unique identifier for each course offering. Value examples: ['1', '2', '3'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course is offered. Value examples: ['1', '1', '2'].),\n  (section_number:bigint, The section number of the course. Value examples: ['1', '1', '1'].),\n  (start_time:time, The start time of the course. Value examples: ['08:00:00', '10:00:00', '08:00:00'].),\n  (end_time:time, The end time of the course. Value examples: ['10:00:00', '12:00:00', '10:00:00'].),\n  (monday:text, The instructor's name for Monday. Value examples: ['John Smith', 'NULL', 'John Smith'].),\n  (tuesday:text, The instructor's name for Tuesday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (wednesday:text, The instructor's name for Wednesday. Value examples: ['NULL', 'Gilbert Strang', 'NULL'].),\n  (thursday:text, The instructor's name for Thursday. Value examples: ['Jane Doe', 'NULL', 'Jane Doe'].),\n  (friday:text, The instructor's name for Friday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (saturday:text, The instructor's name for Saturday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (sunday:text, The instructor's name for Sunday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (has_final_project:boolean, Indicates whether the course has a final project. Value examples: ['true', 'true', 'false'].),\n  (has_final_exam:boolean, Indicates whether the course has a final exam. Value examples: ['false', 'true', 'true'].),\n  (textbook:text, The name of the textbook used in the course. Value examples: ['Introduction to Computer Science', 'Advanced Calculus', 'Introduction to Physics'].),\n  (class_address:text, The address of the classroom where the course is held. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (allow_audit:text, Indicates whether auditing the course is allowed. Value examples: ['true', 'false', 'true'].),\n]\n# Table: course_prerequisite\n[\n  (pre_course_id:bigint, The ID of the prerequisite course. Value examples: ['1', '2'].),\n  (course_id:bigint, The ID of the course that has the prerequisite. Value examples: ['2', '3'].),\n]\n# Table: course_tags_count\n[\n  (course_id:bigint, The unique identifier for each course.. Value examples: ['1', '2', '3'].),\n  (clear_grading:bigint, Number of students who found the grading criteria clear and easy to understand.. Value examples: ['5', '4', '3'].),\n  (pop_quiz:bigint, Number of pop quizzes given during the course.. Value examples: ['2', '1', '2'].),\n  (group_projects:bigint, Number of group projects assigned during the course.. Value examples: ['3', '2', '1'].),\n  (inspirational:bigint, Number of students who found the course content inspirational.. Value examples: ['4', '3', '2'].),\n  (long_lectures:bigint, Number of students who found the lectures to be too long.. Value examples: ['2', '1', '3'].),\n  (extra_credit:bigint, Number of extra credit opportunities provided during the course.. Value examples: ['1', '2', '1'].),\n  (few_tests:bigint, Number of tests given during the course.. Value examples: ['3', '2', '1'].),\n  (good_feedback:bigint, Number of students who received good feedback from the instructor.. Value examples: ['4', '3', '2'].),\n  (tough_tests:bigint, Number of students who found the tests to be tough.. Value examples: ['2', '1', '3'].),\n  (heavy_papers:bigint, Number of papers assigned during the course.. Value examples: ['1', '2', '1'].),\n  (cares_for_students:bigint, Number of students who felt that the instructor cared for their well-being.. Value examples: ['5', '4', '3'].),\n  (heavy_assignments:bigint, Number of assignments given during the course.. Value examples: ['3', '2', '1'].),\n  (respected:bigint, Number of students who respected the instructor.. Value examples: ['4', '3', '2'].),\n  (participation:bigint, Number of students who participated actively in the course.. Value examples: ['2', '1', '3'].),\n  (heavy_reading:bigint, Number of reading assignments given during the course.. Value examples: ['1', '2', '1'].),\n  (tough_grader:bigint, Number of students who found the instructor to be a tough grader.. Value examples: ['5', '4', '3'].),\n  (hilarious:bigint, Number of students who found the instructor to be hilarious.. Value examples: ['3', '2', '1'].),\n  (would_take_again:bigint, Number of students who would take the course again.. Value examples: ['4', '3', '2'].),\n  (good_lecture:bigint, Number of students who found the lectures to be good.. Value examples: ['2', '1', '3'].),\n  (no_skip:bigint, Number of students who did not skip any classes during the course.. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: instructor\n[\n  (instructor_id:bigint, Unique identifier for each instructor. Value examples: ['1', '2'].),\n  (name:text, Name of the instructor. Value examples: ['John Smith', 'Jane Doe'].),\n  (uniqname:text, Unique name of the instructor used for login and identification purposes. Value examples: ['jsmith', 'jdoe'].),\n]\n# Table: offering_instructor\n[\n  (offering_instructor_id:bigint, Unique identifier for each offering-instructor pair. Value examples: ['1', '2', '3'].),\n  (offering_id:bigint, Foreign key referencing the offering table. Value examples: ['1', '1', '2'].),\n  (instructor_id:bigint, Foreign key referencing the instructor table. Value examples: ['1', '2', '3'].),\n]\n# Table: program\n[\n  (program_id:bigint, Unique identifier for each program. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the program, Eg 'Computer Science', 'Physics'. Value examples: ['Computer Science', 'Mathematics', 'Physics'].),\n  (college:text, Name of the college offering the program. Value examples: ['Engineering', 'Arts and Sciences', 'Arts and Sciences'].),\n  (introduction:text, Introduction to the program. Value examples: ['This program focuses on computer science principles and applications.', 'This program provides a comprehensive study of mathematical concepts and theories.', 'This program explores the fundamental principles of physics and their applications.'].),\n]\n# Table: program_course\n[\n  (program_id:bigint, The ID of the program associated with the course. Value examples: ['1', '1'].),\n  (course_id:bigint, The ID of the course. Value examples: ['1', '4'].),\n  (workload:bigint, The workload of the course in hours. Value examples: ['100', '80'].),\n  (category:text, The category of the course. Can only be 'Core' or 'Elective'.. Value examples: ['Core', 'Elective'].),\n]\n# Table: program_requirement\n[\n  (program_id:bigint, Unique identifier for a program. Value examples: ['1', '2', '3'].),\n  (category:text, Category of the program. Value examples: ['Core', 'Core', 'Core'].),\n  (min_credit:bigint, Minimum number of credits required for the program. Value examples: ['120', '90', '200'].),\n  (additional_req:text, Additional requirements for the program, if any. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: semester\n[\n  (semester_id:bigint, Unique identifier for each semester. Sort by this column to get the right year-semester order.. Value examples: ['1', '2', '3', '4'].),\n  (semester:text, The name or identifier for the semester Can only be 'Fall', 'Spring', or 'Summer'. Value examples: ['Fall', 'Spring', 'Summer', 'Fall'].),\n  (year:bigint, The year in which the semester takes place. Value examples: ['2020', '2021', '2021', '2021'].),\n]\n# Table: student\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '2', '3'].),\n  (lastname:text, Last name of the student. Value examples: ['Smith', 'Doe', 'Johnson'].),\n  (firstname:text, First name of the student. Value examples: ['John', 'Jane', 'David'].),\n  (program_id:bigint, Identifier for the program the student is enrolled in. Value examples: ['1', '1', '2'].),\n  (declare_major:text, Major program the student declared. Value examples: ['Computer Science', 'Computer Science', 'Mathematics'].),\n  (total_credit:bigint, Total number of credits earned by the student. Value examples: ['13', '7', '7'].),\n  (total_gpa:numeric, Cumulative GPA of the student. Value examples: ['3.5', '3.2', '3.6'].),\n  (entered_as:text, Status of the student when they entered the program. e.g. 'Freshman', 'Transfer Student'. Value examples: ['Freshman', 'Freshman', 'Freshman'].),\n  (admit_term:date, Term in which the student was admitted. Format is YYYY-MM-DD. Value examples: ['2018-01-01', '2018-01-01', '2019-01-01'].),\n  (predicted_graduation_semester:date, Semester in which the student is predicted to graduate. Format is YYYY-MM-DD. Value examples: ['2022-05-01', '2022-05-01', '2022-05-01'].),\n  (degree:text, Degree program the student is enrolled in. Can only be 'Bachelor of Science' or 'Bachelor of Arts'.. Value examples: ['Bachelor of Science', 'Bachelor of Science', 'Bachelor of Arts'].),\n  (minor:text, Minor program the student is enrolled in. Value examples: ['NULL', 'NULL', 'Mathematics'].),\n  (internship:text, Internship program the student is enrolled in. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: student_record\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '1', '1'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course was taken. Value examples: ['1', '1', '2'].),\n  (grade:text, The grade received for the course. Value examples: ['A', 'A', 'A'].),\n  (how:text, How the student took the course. Can only be 'in-person' or 'online'.. Value examples: ['in-person', 'in-person', 'in-person'].),\n  (transfer_source:text, If the course was transferred from another institution, the name of that institution. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (earn_credit:text, Whether the student earned credit for the course (e.g. Yes, No). Value examples: ['Yes', 'Yes', 'Yes'].),\n  (repeat_term:text, If the student repeated the course, the semester in which it was repeated. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (test_id:text, Unique identifier for each test taken in the course. Value examples: ['1', '1', '1'].),\n  (offering_id:bigint, Unique identifier for each offering of a course. Value examples: ['1', '2', '3'].),\n]\n\n【Foreign keys】\narea.course_id = course.course_id\ncomment_instructor.instructor_id = instructor.instructor_id\ncomment_instructor.student_id = student.student_id\ncourse.course_id = course_offering.course_id\ncourse.course_id = course_prerequisite.course_id\ncourse.course_id = course_tags_count.course_id\ncourse.course_id = program_course.course_id\ncourse.course_id = student_record.course_id\ncourse_offering.offering_id = offering_instructor.offering_id\ncourse_offering.offering_id = student_record.offering_id\ninstructor.instructor_id = offering_instructor.instructor_id\nprogram.program_id = program_course.program_id\nprogram.program_id = program_requirement.program_id\nprogram.program_id = student.program_id\nstudent.student_id = student_record.student_id\n\n【参考信息】\n\n\n【用户问题】\nWhat is the total number of students who have taken a course with a final project or exam?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT COUNT(DISTINCT student_record.student_id) AS total_students FROM student_record JOIN course_offering ON student_record.course_id = course_offering.course_id WHERE course_offering.has_final_project = true OR course_offering.has_final_exam = true;",
        "role": "assistant"
      }
    ],
    "db_name": "advising",
    "id": 52,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the total number of credits earned by students in each program?\n\n【数据库schema】\n【DB_ID】 advising\n【Schema】\n# Table: area\n[\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2'].),\n  (area:text, The area of study for each course. Value examples: ['Computer Science', 'Mathematics'].),\n]\n# Table: comment_instructor\n[\n  (instructor_id:bigint, Unique identifier for the instructor. Value examples: ['1', '2'].),\n  (student_id:bigint, Unique identifier for the student. Value examples: ['1', '2'].),\n  (score:bigint, Score given by the student to the instructor. Value examples: ['5', '4'].),\n  (comment_text:text, Textual comment given by the student about the instructor. Value examples: ['John Smith is a great instructor.', 'Jane Doe explains concepts clearly.'].),\n]\n# Table: course\n[\n  (course_id:bigint, The unique identifier for the course.. Value examples: ['1', '2'].),\n  (name:text, The name of the course.. Value examples: ['Introduction to Computer Science', 'Advanced Calculus'].),\n  (department:text, The department offering the course. Eg 'Mathematics', 'Physics'. Value examples: ['Computer Science', 'Mathematics'].),\n  (number:text, The course number/code.. Value examples: ['CS101', 'MATH201'].),\n  (credits:text, The number of credits awarded for completing the course.. Value examples: ['3', '4'].),\n  (advisory_requirement:text, Any advisory requirements for taking the course.. Value examples: ['NULL', 'CS101'].),\n  (enforced_requirement:text, Any enforced requirements for taking the course.. Value examples: ['NULL', 'NULL'].),\n  (description:text, A brief description of the course content.. Value examples: ['This course introduces the basics of computer science.', 'This course covers advanced topics in calculus.'].),\n  (num_semesters:bigint, The number of semesters the course is offered in a year.. Value examples: ['2', '1'].),\n  (num_enrolled:bigint, The total number of students enrolled in the course.. Value examples: ['2', '3'].),\n  (has_discussion:boolean, Indicates whether the course has any discussion sessions or not.. Value examples: ['true', 'false'].),\n  (has_lab:boolean, Indicates whether the course has any lab sessions or not.. Value examples: ['false', 'false'].),\n  (has_projects:boolean, Indicates whether the course has any projects or not.. Value examples: ['true', 'true'].),\n  (has_exams:boolean, Indicates whether the course has any exams or not.. Value examples: ['false', 'true'].),\n  (num_reviews:bigint, The total number of reviews/ratings for the course.. Value examples: ['10', '5'].),\n  (clarity_score:bigint, The overall clarity score of the course as rated by students.. Value examples: ['5', '4'].),\n  (easiness_score:bigint, The overall easiness score of the course as rated by students.. Value examples: ['3', '2'].),\n  (helpfulness_score:bigint, The overall helpfulness score of the course as rated by students.. Value examples: ['4', '3'].),\n]\n# Table: course_offering\n[\n  (offering_id:bigint, Unique identifier for each course offering. Value examples: ['1', '2', '3'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course is offered. Value examples: ['1', '1', '2'].),\n  (section_number:bigint, The section number of the course. Value examples: ['1', '1', '1'].),\n  (start_time:time, The start time of the course. Value examples: ['08:00:00', '10:00:00', '08:00:00'].),\n  (end_time:time, The end time of the course. Value examples: ['10:00:00', '12:00:00', '10:00:00'].),\n  (monday:text, The instructor's name for Monday. Value examples: ['John Smith', 'NULL', 'John Smith'].),\n  (tuesday:text, The instructor's name for Tuesday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (wednesday:text, The instructor's name for Wednesday. Value examples: ['NULL', 'Gilbert Strang', 'NULL'].),\n  (thursday:text, The instructor's name for Thursday. Value examples: ['Jane Doe', 'NULL', 'Jane Doe'].),\n  (friday:text, The instructor's name for Friday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (saturday:text, The instructor's name for Saturday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (sunday:text, The instructor's name for Sunday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (has_final_project:boolean, Indicates whether the course has a final project. Value examples: ['true', 'true', 'false'].),\n  (has_final_exam:boolean, Indicates whether the course has a final exam. Value examples: ['false', 'true', 'true'].),\n  (textbook:text, The name of the textbook used in the course. Value examples: ['Introduction to Computer Science', 'Advanced Calculus', 'Introduction to Physics'].),\n  (class_address:text, The address of the classroom where the course is held. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (allow_audit:text, Indicates whether auditing the course is allowed. Value examples: ['true', 'false', 'true'].),\n]\n# Table: course_prerequisite\n[\n  (pre_course_id:bigint, The ID of the prerequisite course. Value examples: ['1', '2'].),\n  (course_id:bigint, The ID of the course that has the prerequisite. Value examples: ['2', '3'].),\n]\n# Table: course_tags_count\n[\n  (course_id:bigint, The unique identifier for each course.. Value examples: ['1', '2', '3'].),\n  (clear_grading:bigint, Number of students who found the grading criteria clear and easy to understand.. Value examples: ['5', '4', '3'].),\n  (pop_quiz:bigint, Number of pop quizzes given during the course.. Value examples: ['2', '1', '2'].),\n  (group_projects:bigint, Number of group projects assigned during the course.. Value examples: ['3', '2', '1'].),\n  (inspirational:bigint, Number of students who found the course content inspirational.. Value examples: ['4', '3', '2'].),\n  (long_lectures:bigint, Number of students who found the lectures to be too long.. Value examples: ['2', '1', '3'].),\n  (extra_credit:bigint, Number of extra credit opportunities provided during the course.. Value examples: ['1', '2', '1'].),\n  (few_tests:bigint, Number of tests given during the course.. Value examples: ['3', '2', '1'].),\n  (good_feedback:bigint, Number of students who received good feedback from the instructor.. Value examples: ['4', '3', '2'].),\n  (tough_tests:bigint, Number of students who found the tests to be tough.. Value examples: ['2', '1', '3'].),\n  (heavy_papers:bigint, Number of papers assigned during the course.. Value examples: ['1', '2', '1'].),\n  (cares_for_students:bigint, Number of students who felt that the instructor cared for their well-being.. Value examples: ['5', '4', '3'].),\n  (heavy_assignments:bigint, Number of assignments given during the course.. Value examples: ['3', '2', '1'].),\n  (respected:bigint, Number of students who respected the instructor.. Value examples: ['4', '3', '2'].),\n  (participation:bigint, Number of students who participated actively in the course.. Value examples: ['2', '1', '3'].),\n  (heavy_reading:bigint, Number of reading assignments given during the course.. Value examples: ['1', '2', '1'].),\n  (tough_grader:bigint, Number of students who found the instructor to be a tough grader.. Value examples: ['5', '4', '3'].),\n  (hilarious:bigint, Number of students who found the instructor to be hilarious.. Value examples: ['3', '2', '1'].),\n  (would_take_again:bigint, Number of students who would take the course again.. Value examples: ['4', '3', '2'].),\n  (good_lecture:bigint, Number of students who found the lectures to be good.. Value examples: ['2', '1', '3'].),\n  (no_skip:bigint, Number of students who did not skip any classes during the course.. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: instructor\n[\n  (instructor_id:bigint, Unique identifier for each instructor. Value examples: ['1', '2'].),\n  (name:text, Name of the instructor. Value examples: ['John Smith', 'Jane Doe'].),\n  (uniqname:text, Unique name of the instructor used for login and identification purposes. Value examples: ['jsmith', 'jdoe'].),\n]\n# Table: offering_instructor\n[\n  (offering_instructor_id:bigint, Unique identifier for each offering-instructor pair. Value examples: ['1', '2', '3'].),\n  (offering_id:bigint, Foreign key referencing the offering table. Value examples: ['1', '1', '2'].),\n  (instructor_id:bigint, Foreign key referencing the instructor table. Value examples: ['1', '2', '3'].),\n]\n# Table: program\n[\n  (program_id:bigint, Unique identifier for each program. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the program, Eg 'Computer Science', 'Physics'. Value examples: ['Computer Science', 'Mathematics', 'Physics'].),\n  (college:text, Name of the college offering the program. Value examples: ['Engineering', 'Arts and Sciences', 'Arts and Sciences'].),\n  (introduction:text, Introduction to the program. Value examples: ['This program focuses on computer science principles and applications.', 'This program provides a comprehensive study of mathematical concepts and theories.', 'This program explores the fundamental principles of physics and their applications.'].),\n]\n# Table: program_course\n[\n  (program_id:bigint, The ID of the program associated with the course. Value examples: ['1', '1'].),\n  (course_id:bigint, The ID of the course. Value examples: ['1', '4'].),\n  (workload:bigint, The workload of the course in hours. Value examples: ['100', '80'].),\n  (category:text, The category of the course. Can only be 'Core' or 'Elective'.. Value examples: ['Core', 'Elective'].),\n]\n# Table: program_requirement\n[\n  (program_id:bigint, Unique identifier for a program. Value examples: ['1', '2', '3'].),\n  (category:text, Category of the program. Value examples: ['Core', 'Core', 'Core'].),\n  (min_credit:bigint, Minimum number of credits required for the program. Value examples: ['120', '90', '200'].),\n  (additional_req:text, Additional requirements for the program, if any. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: semester\n[\n  (semester_id:bigint, Unique identifier for each semester. Sort by this column to get the right year-semester order.. Value examples: ['1', '2', '3', '4'].),\n  (semester:text, The name or identifier for the semester Can only be 'Fall', 'Spring', or 'Summer'. Value examples: ['Fall', 'Spring', 'Summer', 'Fall'].),\n  (year:bigint, The year in which the semester takes place. Value examples: ['2020', '2021', '2021', '2021'].),\n]\n# Table: student\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '2', '3'].),\n  (lastname:text, Last name of the student. Value examples: ['Smith', 'Doe', 'Johnson'].),\n  (firstname:text, First name of the student. Value examples: ['John', 'Jane', 'David'].),\n  (program_id:bigint, Identifier for the program the student is enrolled in. Value examples: ['1', '1', '2'].),\n  (declare_major:text, Major program the student declared. Value examples: ['Computer Science', 'Computer Science', 'Mathematics'].),\n  (total_credit:bigint, Total number of credits earned by the student. Value examples: ['13', '7', '7'].),\n  (total_gpa:numeric, Cumulative GPA of the student. Value examples: ['3.5', '3.2', '3.6'].),\n  (entered_as:text, Status of the student when they entered the program. e.g. 'Freshman', 'Transfer Student'. Value examples: ['Freshman', 'Freshman', 'Freshman'].),\n  (admit_term:date, Term in which the student was admitted. Format is YYYY-MM-DD. Value examples: ['2018-01-01', '2018-01-01', '2019-01-01'].),\n  (predicted_graduation_semester:date, Semester in which the student is predicted to graduate. Format is YYYY-MM-DD. Value examples: ['2022-05-01', '2022-05-01', '2022-05-01'].),\n  (degree:text, Degree program the student is enrolled in. Can only be 'Bachelor of Science' or 'Bachelor of Arts'.. Value examples: ['Bachelor of Science', 'Bachelor of Science', 'Bachelor of Arts'].),\n  (minor:text, Minor program the student is enrolled in. Value examples: ['NULL', 'NULL', 'Mathematics'].),\n  (internship:text, Internship program the student is enrolled in. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: student_record\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '1', '1'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course was taken. Value examples: ['1', '1', '2'].),\n  (grade:text, The grade received for the course. Value examples: ['A', 'A', 'A'].),\n  (how:text, How the student took the course. Can only be 'in-person' or 'online'.. Value examples: ['in-person', 'in-person', 'in-person'].),\n  (transfer_source:text, If the course was transferred from another institution, the name of that institution. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (earn_credit:text, Whether the student earned credit for the course (e.g. Yes, No). Value examples: ['Yes', 'Yes', 'Yes'].),\n  (repeat_term:text, If the student repeated the course, the semester in which it was repeated. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (test_id:text, Unique identifier for each test taken in the course. Value examples: ['1', '1', '1'].),\n  (offering_id:bigint, Unique identifier for each offering of a course. Value examples: ['1', '2', '3'].),\n]\n\n【Foreign keys】\narea.course_id = course.course_id\ncomment_instructor.instructor_id = instructor.instructor_id\ncomment_instructor.student_id = student.student_id\ncourse.course_id = course_offering.course_id\ncourse.course_id = course_prerequisite.course_id\ncourse.course_id = course_tags_count.course_id\ncourse.course_id = program_course.course_id\ncourse.course_id = student_record.course_id\ncourse_offering.offering_id = offering_instructor.offering_id\ncourse_offering.offering_id = student_record.offering_id\ninstructor.instructor_id = offering_instructor.instructor_id\nprogram.program_id = program_course.program_id\nprogram.program_id = program_requirement.program_id\nprogram.program_id = student.program_id\nstudent.student_id = student_record.student_id\n\n【参考信息】\n\n\n【用户问题】\nWhat is the total number of credits earned by students in each program?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT program.name, program.program_id, SUM(student.total_credit) AS total_credits FROM student JOIN program ON student.program_id = program.program_id GROUP BY program.name, program.program_id",
        "role": "assistant"
      }
    ],
    "db_name": "advising",
    "id": 53,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many students have declared a major in each program?\n\n【数据库schema】\n【DB_ID】 advising\n【Schema】\n# Table: area\n[\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2'].),\n  (area:text, The area of study for each course. Value examples: ['Computer Science', 'Mathematics'].),\n]\n# Table: comment_instructor\n[\n  (instructor_id:bigint, Unique identifier for the instructor. Value examples: ['1', '2'].),\n  (student_id:bigint, Unique identifier for the student. Value examples: ['1', '2'].),\n  (score:bigint, Score given by the student to the instructor. Value examples: ['5', '4'].),\n  (comment_text:text, Textual comment given by the student about the instructor. Value examples: ['John Smith is a great instructor.', 'Jane Doe explains concepts clearly.'].),\n]\n# Table: course\n[\n  (course_id:bigint, The unique identifier for the course.. Value examples: ['1', '2'].),\n  (name:text, The name of the course.. Value examples: ['Introduction to Computer Science', 'Advanced Calculus'].),\n  (department:text, The department offering the course. Eg 'Mathematics', 'Physics'. Value examples: ['Computer Science', 'Mathematics'].),\n  (number:text, The course number/code.. Value examples: ['CS101', 'MATH201'].),\n  (credits:text, The number of credits awarded for completing the course.. Value examples: ['3', '4'].),\n  (advisory_requirement:text, Any advisory requirements for taking the course.. Value examples: ['NULL', 'CS101'].),\n  (enforced_requirement:text, Any enforced requirements for taking the course.. Value examples: ['NULL', 'NULL'].),\n  (description:text, A brief description of the course content.. Value examples: ['This course introduces the basics of computer science.', 'This course covers advanced topics in calculus.'].),\n  (num_semesters:bigint, The number of semesters the course is offered in a year.. Value examples: ['2', '1'].),\n  (num_enrolled:bigint, The total number of students enrolled in the course.. Value examples: ['2', '3'].),\n  (has_discussion:boolean, Indicates whether the course has any discussion sessions or not.. Value examples: ['true', 'false'].),\n  (has_lab:boolean, Indicates whether the course has any lab sessions or not.. Value examples: ['false', 'false'].),\n  (has_projects:boolean, Indicates whether the course has any projects or not.. Value examples: ['true', 'true'].),\n  (has_exams:boolean, Indicates whether the course has any exams or not.. Value examples: ['false', 'true'].),\n  (num_reviews:bigint, The total number of reviews/ratings for the course.. Value examples: ['10', '5'].),\n  (clarity_score:bigint, The overall clarity score of the course as rated by students.. Value examples: ['5', '4'].),\n  (easiness_score:bigint, The overall easiness score of the course as rated by students.. Value examples: ['3', '2'].),\n  (helpfulness_score:bigint, The overall helpfulness score of the course as rated by students.. Value examples: ['4', '3'].),\n]\n# Table: course_offering\n[\n  (offering_id:bigint, Unique identifier for each course offering. Value examples: ['1', '2', '3'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course is offered. Value examples: ['1', '1', '2'].),\n  (section_number:bigint, The section number of the course. Value examples: ['1', '1', '1'].),\n  (start_time:time, The start time of the course. Value examples: ['08:00:00', '10:00:00', '08:00:00'].),\n  (end_time:time, The end time of the course. Value examples: ['10:00:00', '12:00:00', '10:00:00'].),\n  (monday:text, The instructor's name for Monday. Value examples: ['John Smith', 'NULL', 'John Smith'].),\n  (tuesday:text, The instructor's name for Tuesday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (wednesday:text, The instructor's name for Wednesday. Value examples: ['NULL', 'Gilbert Strang', 'NULL'].),\n  (thursday:text, The instructor's name for Thursday. Value examples: ['Jane Doe', 'NULL', 'Jane Doe'].),\n  (friday:text, The instructor's name for Friday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (saturday:text, The instructor's name for Saturday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (sunday:text, The instructor's name for Sunday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (has_final_project:boolean, Indicates whether the course has a final project. Value examples: ['true', 'true', 'false'].),\n  (has_final_exam:boolean, Indicates whether the course has a final exam. Value examples: ['false', 'true', 'true'].),\n  (textbook:text, The name of the textbook used in the course. Value examples: ['Introduction to Computer Science', 'Advanced Calculus', 'Introduction to Physics'].),\n  (class_address:text, The address of the classroom where the course is held. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (allow_audit:text, Indicates whether auditing the course is allowed. Value examples: ['true', 'false', 'true'].),\n]\n# Table: course_prerequisite\n[\n  (pre_course_id:bigint, The ID of the prerequisite course. Value examples: ['1', '2'].),\n  (course_id:bigint, The ID of the course that has the prerequisite. Value examples: ['2', '3'].),\n]\n# Table: course_tags_count\n[\n  (course_id:bigint, The unique identifier for each course.. Value examples: ['1', '2', '3'].),\n  (clear_grading:bigint, Number of students who found the grading criteria clear and easy to understand.. Value examples: ['5', '4', '3'].),\n  (pop_quiz:bigint, Number of pop quizzes given during the course.. Value examples: ['2', '1', '2'].),\n  (group_projects:bigint, Number of group projects assigned during the course.. Value examples: ['3', '2', '1'].),\n  (inspirational:bigint, Number of students who found the course content inspirational.. Value examples: ['4', '3', '2'].),\n  (long_lectures:bigint, Number of students who found the lectures to be too long.. Value examples: ['2', '1', '3'].),\n  (extra_credit:bigint, Number of extra credit opportunities provided during the course.. Value examples: ['1', '2', '1'].),\n  (few_tests:bigint, Number of tests given during the course.. Value examples: ['3', '2', '1'].),\n  (good_feedback:bigint, Number of students who received good feedback from the instructor.. Value examples: ['4', '3', '2'].),\n  (tough_tests:bigint, Number of students who found the tests to be tough.. Value examples: ['2', '1', '3'].),\n  (heavy_papers:bigint, Number of papers assigned during the course.. Value examples: ['1', '2', '1'].),\n  (cares_for_students:bigint, Number of students who felt that the instructor cared for their well-being.. Value examples: ['5', '4', '3'].),\n  (heavy_assignments:bigint, Number of assignments given during the course.. Value examples: ['3', '2', '1'].),\n  (respected:bigint, Number of students who respected the instructor.. Value examples: ['4', '3', '2'].),\n  (participation:bigint, Number of students who participated actively in the course.. Value examples: ['2', '1', '3'].),\n  (heavy_reading:bigint, Number of reading assignments given during the course.. Value examples: ['1', '2', '1'].),\n  (tough_grader:bigint, Number of students who found the instructor to be a tough grader.. Value examples: ['5', '4', '3'].),\n  (hilarious:bigint, Number of students who found the instructor to be hilarious.. Value examples: ['3', '2', '1'].),\n  (would_take_again:bigint, Number of students who would take the course again.. Value examples: ['4', '3', '2'].),\n  (good_lecture:bigint, Number of students who found the lectures to be good.. Value examples: ['2', '1', '3'].),\n  (no_skip:bigint, Number of students who did not skip any classes during the course.. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: instructor\n[\n  (instructor_id:bigint, Unique identifier for each instructor. Value examples: ['1', '2'].),\n  (name:text, Name of the instructor. Value examples: ['John Smith', 'Jane Doe'].),\n  (uniqname:text, Unique name of the instructor used for login and identification purposes. Value examples: ['jsmith', 'jdoe'].),\n]\n# Table: offering_instructor\n[\n  (offering_instructor_id:bigint, Unique identifier for each offering-instructor pair. Value examples: ['1', '2', '3'].),\n  (offering_id:bigint, Foreign key referencing the offering table. Value examples: ['1', '1', '2'].),\n  (instructor_id:bigint, Foreign key referencing the instructor table. Value examples: ['1', '2', '3'].),\n]\n# Table: program\n[\n  (program_id:bigint, Unique identifier for each program. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the program, Eg 'Computer Science', 'Physics'. Value examples: ['Computer Science', 'Mathematics', 'Physics'].),\n  (college:text, Name of the college offering the program. Value examples: ['Engineering', 'Arts and Sciences', 'Arts and Sciences'].),\n  (introduction:text, Introduction to the program. Value examples: ['This program focuses on computer science principles and applications.', 'This program provides a comprehensive study of mathematical concepts and theories.', 'This program explores the fundamental principles of physics and their applications.'].),\n]\n# Table: program_course\n[\n  (program_id:bigint, The ID of the program associated with the course. Value examples: ['1', '1'].),\n  (course_id:bigint, The ID of the course. Value examples: ['1', '4'].),\n  (workload:bigint, The workload of the course in hours. Value examples: ['100', '80'].),\n  (category:text, The category of the course. Can only be 'Core' or 'Elective'.. Value examples: ['Core', 'Elective'].),\n]\n# Table: program_requirement\n[\n  (program_id:bigint, Unique identifier for a program. Value examples: ['1', '2', '3'].),\n  (category:text, Category of the program. Value examples: ['Core', 'Core', 'Core'].),\n  (min_credit:bigint, Minimum number of credits required for the program. Value examples: ['120', '90', '200'].),\n  (additional_req:text, Additional requirements for the program, if any. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: semester\n[\n  (semester_id:bigint, Unique identifier for each semester. Sort by this column to get the right year-semester order.. Value examples: ['1', '2', '3', '4'].),\n  (semester:text, The name or identifier for the semester Can only be 'Fall', 'Spring', or 'Summer'. Value examples: ['Fall', 'Spring', 'Summer', 'Fall'].),\n  (year:bigint, The year in which the semester takes place. Value examples: ['2020', '2021', '2021', '2021'].),\n]\n# Table: student\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '2', '3'].),\n  (lastname:text, Last name of the student. Value examples: ['Smith', 'Doe', 'Johnson'].),\n  (firstname:text, First name of the student. Value examples: ['John', 'Jane', 'David'].),\n  (program_id:bigint, Identifier for the program the student is enrolled in. Value examples: ['1', '1', '2'].),\n  (declare_major:text, Major program the student declared. Value examples: ['Computer Science', 'Computer Science', 'Mathematics'].),\n  (total_credit:bigint, Total number of credits earned by the student. Value examples: ['13', '7', '7'].),\n  (total_gpa:numeric, Cumulative GPA of the student. Value examples: ['3.5', '3.2', '3.6'].),\n  (entered_as:text, Status of the student when they entered the program. e.g. 'Freshman', 'Transfer Student'. Value examples: ['Freshman', 'Freshman', 'Freshman'].),\n  (admit_term:date, Term in which the student was admitted. Format is YYYY-MM-DD. Value examples: ['2018-01-01', '2018-01-01', '2019-01-01'].),\n  (predicted_graduation_semester:date, Semester in which the student is predicted to graduate. Format is YYYY-MM-DD. Value examples: ['2022-05-01', '2022-05-01', '2022-05-01'].),\n  (degree:text, Degree program the student is enrolled in. Can only be 'Bachelor of Science' or 'Bachelor of Arts'.. Value examples: ['Bachelor of Science', 'Bachelor of Science', 'Bachelor of Arts'].),\n  (minor:text, Minor program the student is enrolled in. Value examples: ['NULL', 'NULL', 'Mathematics'].),\n  (internship:text, Internship program the student is enrolled in. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: student_record\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '1', '1'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course was taken. Value examples: ['1', '1', '2'].),\n  (grade:text, The grade received for the course. Value examples: ['A', 'A', 'A'].),\n  (how:text, How the student took the course. Can only be 'in-person' or 'online'.. Value examples: ['in-person', 'in-person', 'in-person'].),\n  (transfer_source:text, If the course was transferred from another institution, the name of that institution. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (earn_credit:text, Whether the student earned credit for the course (e.g. Yes, No). Value examples: ['Yes', 'Yes', 'Yes'].),\n  (repeat_term:text, If the student repeated the course, the semester in which it was repeated. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (test_id:text, Unique identifier for each test taken in the course. Value examples: ['1', '1', '1'].),\n  (offering_id:bigint, Unique identifier for each offering of a course. Value examples: ['1', '2', '3'].),\n]\n\n【Foreign keys】\narea.course_id = course.course_id\ncomment_instructor.instructor_id = instructor.instructor_id\ncomment_instructor.student_id = student.student_id\ncourse.course_id = course_offering.course_id\ncourse.course_id = course_prerequisite.course_id\ncourse.course_id = course_tags_count.course_id\ncourse.course_id = program_course.course_id\ncourse.course_id = student_record.course_id\ncourse_offering.offering_id = offering_instructor.offering_id\ncourse_offering.offering_id = student_record.offering_id\ninstructor.instructor_id = offering_instructor.instructor_id\nprogram.program_id = program_course.program_id\nprogram.program_id = program_requirement.program_id\nprogram.program_id = student.program_id\nstudent.student_id = student_record.student_id\n\n【参考信息】\n\n\n【用户问题】\nHow many students have declared a major in each program?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT program.name, program.program_id, COUNT(student.student_id) AS number_of_students FROM student JOIN program ON student.program_id = program.program_id WHERE student.declare_major IS NOT NULL GROUP BY program.name, program.program_id ORDER BY number_of_students DESC",
        "role": "assistant"
      }
    ],
    "db_name": "advising",
    "id": 54,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich students have declared a minor program? List their firstname and lastname. Order the results by the students' last names.\n\n【数据库schema】\n【DB_ID】 advising\n【Schema】\n# Table: area\n[\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2'].),\n  (area:text, The area of study for each course. Value examples: ['Computer Science', 'Mathematics'].),\n]\n# Table: comment_instructor\n[\n  (instructor_id:bigint, Unique identifier for the instructor. Value examples: ['1', '2'].),\n  (student_id:bigint, Unique identifier for the student. Value examples: ['1', '2'].),\n  (score:bigint, Score given by the student to the instructor. Value examples: ['5', '4'].),\n  (comment_text:text, Textual comment given by the student about the instructor. Value examples: ['John Smith is a great instructor.', 'Jane Doe explains concepts clearly.'].),\n]\n# Table: course\n[\n  (course_id:bigint, The unique identifier for the course.. Value examples: ['1', '2'].),\n  (name:text, The name of the course.. Value examples: ['Introduction to Computer Science', 'Advanced Calculus'].),\n  (department:text, The department offering the course. Eg 'Mathematics', 'Physics'. Value examples: ['Computer Science', 'Mathematics'].),\n  (number:text, The course number/code.. Value examples: ['CS101', 'MATH201'].),\n  (credits:text, The number of credits awarded for completing the course.. Value examples: ['3', '4'].),\n  (advisory_requirement:text, Any advisory requirements for taking the course.. Value examples: ['NULL', 'CS101'].),\n  (enforced_requirement:text, Any enforced requirements for taking the course.. Value examples: ['NULL', 'NULL'].),\n  (description:text, A brief description of the course content.. Value examples: ['This course introduces the basics of computer science.', 'This course covers advanced topics in calculus.'].),\n  (num_semesters:bigint, The number of semesters the course is offered in a year.. Value examples: ['2', '1'].),\n  (num_enrolled:bigint, The total number of students enrolled in the course.. Value examples: ['2', '3'].),\n  (has_discussion:boolean, Indicates whether the course has any discussion sessions or not.. Value examples: ['true', 'false'].),\n  (has_lab:boolean, Indicates whether the course has any lab sessions or not.. Value examples: ['false', 'false'].),\n  (has_projects:boolean, Indicates whether the course has any projects or not.. Value examples: ['true', 'true'].),\n  (has_exams:boolean, Indicates whether the course has any exams or not.. Value examples: ['false', 'true'].),\n  (num_reviews:bigint, The total number of reviews/ratings for the course.. Value examples: ['10', '5'].),\n  (clarity_score:bigint, The overall clarity score of the course as rated by students.. Value examples: ['5', '4'].),\n  (easiness_score:bigint, The overall easiness score of the course as rated by students.. Value examples: ['3', '2'].),\n  (helpfulness_score:bigint, The overall helpfulness score of the course as rated by students.. Value examples: ['4', '3'].),\n]\n# Table: course_offering\n[\n  (offering_id:bigint, Unique identifier for each course offering. Value examples: ['1', '2', '3'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course is offered. Value examples: ['1', '1', '2'].),\n  (section_number:bigint, The section number of the course. Value examples: ['1', '1', '1'].),\n  (start_time:time, The start time of the course. Value examples: ['08:00:00', '10:00:00', '08:00:00'].),\n  (end_time:time, The end time of the course. Value examples: ['10:00:00', '12:00:00', '10:00:00'].),\n  (monday:text, The instructor's name for Monday. Value examples: ['John Smith', 'NULL', 'John Smith'].),\n  (tuesday:text, The instructor's name for Tuesday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (wednesday:text, The instructor's name for Wednesday. Value examples: ['NULL', 'Gilbert Strang', 'NULL'].),\n  (thursday:text, The instructor's name for Thursday. Value examples: ['Jane Doe', 'NULL', 'Jane Doe'].),\n  (friday:text, The instructor's name for Friday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (saturday:text, The instructor's name for Saturday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (sunday:text, The instructor's name for Sunday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (has_final_project:boolean, Indicates whether the course has a final project. Value examples: ['true', 'true', 'false'].),\n  (has_final_exam:boolean, Indicates whether the course has a final exam. Value examples: ['false', 'true', 'true'].),\n  (textbook:text, The name of the textbook used in the course. Value examples: ['Introduction to Computer Science', 'Advanced Calculus', 'Introduction to Physics'].),\n  (class_address:text, The address of the classroom where the course is held. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (allow_audit:text, Indicates whether auditing the course is allowed. Value examples: ['true', 'false', 'true'].),\n]\n# Table: course_prerequisite\n[\n  (pre_course_id:bigint, The ID of the prerequisite course. Value examples: ['1', '2'].),\n  (course_id:bigint, The ID of the course that has the prerequisite. Value examples: ['2', '3'].),\n]\n# Table: course_tags_count\n[\n  (course_id:bigint, The unique identifier for each course.. Value examples: ['1', '2', '3'].),\n  (clear_grading:bigint, Number of students who found the grading criteria clear and easy to understand.. Value examples: ['5', '4', '3'].),\n  (pop_quiz:bigint, Number of pop quizzes given during the course.. Value examples: ['2', '1', '2'].),\n  (group_projects:bigint, Number of group projects assigned during the course.. Value examples: ['3', '2', '1'].),\n  (inspirational:bigint, Number of students who found the course content inspirational.. Value examples: ['4', '3', '2'].),\n  (long_lectures:bigint, Number of students who found the lectures to be too long.. Value examples: ['2', '1', '3'].),\n  (extra_credit:bigint, Number of extra credit opportunities provided during the course.. Value examples: ['1', '2', '1'].),\n  (few_tests:bigint, Number of tests given during the course.. Value examples: ['3', '2', '1'].),\n  (good_feedback:bigint, Number of students who received good feedback from the instructor.. Value examples: ['4', '3', '2'].),\n  (tough_tests:bigint, Number of students who found the tests to be tough.. Value examples: ['2', '1', '3'].),\n  (heavy_papers:bigint, Number of papers assigned during the course.. Value examples: ['1', '2', '1'].),\n  (cares_for_students:bigint, Number of students who felt that the instructor cared for their well-being.. Value examples: ['5', '4', '3'].),\n  (heavy_assignments:bigint, Number of assignments given during the course.. Value examples: ['3', '2', '1'].),\n  (respected:bigint, Number of students who respected the instructor.. Value examples: ['4', '3', '2'].),\n  (participation:bigint, Number of students who participated actively in the course.. Value examples: ['2', '1', '3'].),\n  (heavy_reading:bigint, Number of reading assignments given during the course.. Value examples: ['1', '2', '1'].),\n  (tough_grader:bigint, Number of students who found the instructor to be a tough grader.. Value examples: ['5', '4', '3'].),\n  (hilarious:bigint, Number of students who found the instructor to be hilarious.. Value examples: ['3', '2', '1'].),\n  (would_take_again:bigint, Number of students who would take the course again.. Value examples: ['4', '3', '2'].),\n  (good_lecture:bigint, Number of students who found the lectures to be good.. Value examples: ['2', '1', '3'].),\n  (no_skip:bigint, Number of students who did not skip any classes during the course.. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: instructor\n[\n  (instructor_id:bigint, Unique identifier for each instructor. Value examples: ['1', '2'].),\n  (name:text, Name of the instructor. Value examples: ['John Smith', 'Jane Doe'].),\n  (uniqname:text, Unique name of the instructor used for login and identification purposes. Value examples: ['jsmith', 'jdoe'].),\n]\n# Table: offering_instructor\n[\n  (offering_instructor_id:bigint, Unique identifier for each offering-instructor pair. Value examples: ['1', '2', '3'].),\n  (offering_id:bigint, Foreign key referencing the offering table. Value examples: ['1', '1', '2'].),\n  (instructor_id:bigint, Foreign key referencing the instructor table. Value examples: ['1', '2', '3'].),\n]\n# Table: program\n[\n  (program_id:bigint, Unique identifier for each program. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the program, Eg 'Computer Science', 'Physics'. Value examples: ['Computer Science', 'Mathematics', 'Physics'].),\n  (college:text, Name of the college offering the program. Value examples: ['Engineering', 'Arts and Sciences', 'Arts and Sciences'].),\n  (introduction:text, Introduction to the program. Value examples: ['This program focuses on computer science principles and applications.', 'This program provides a comprehensive study of mathematical concepts and theories.', 'This program explores the fundamental principles of physics and their applications.'].),\n]\n# Table: program_course\n[\n  (program_id:bigint, The ID of the program associated with the course. Value examples: ['1', '1'].),\n  (course_id:bigint, The ID of the course. Value examples: ['1', '4'].),\n  (workload:bigint, The workload of the course in hours. Value examples: ['100', '80'].),\n  (category:text, The category of the course. Can only be 'Core' or 'Elective'.. Value examples: ['Core', 'Elective'].),\n]\n# Table: program_requirement\n[\n  (program_id:bigint, Unique identifier for a program. Value examples: ['1', '2', '3'].),\n  (category:text, Category of the program. Value examples: ['Core', 'Core', 'Core'].),\n  (min_credit:bigint, Minimum number of credits required for the program. Value examples: ['120', '90', '200'].),\n  (additional_req:text, Additional requirements for the program, if any. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: semester\n[\n  (semester_id:bigint, Unique identifier for each semester. Sort by this column to get the right year-semester order.. Value examples: ['1', '2', '3', '4'].),\n  (semester:text, The name or identifier for the semester Can only be 'Fall', 'Spring', or 'Summer'. Value examples: ['Fall', 'Spring', 'Summer', 'Fall'].),\n  (year:bigint, The year in which the semester takes place. Value examples: ['2020', '2021', '2021', '2021'].),\n]\n# Table: student\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '2', '3'].),\n  (lastname:text, Last name of the student. Value examples: ['Smith', 'Doe', 'Johnson'].),\n  (firstname:text, First name of the student. Value examples: ['John', 'Jane', 'David'].),\n  (program_id:bigint, Identifier for the program the student is enrolled in. Value examples: ['1', '1', '2'].),\n  (declare_major:text, Major program the student declared. Value examples: ['Computer Science', 'Computer Science', 'Mathematics'].),\n  (total_credit:bigint, Total number of credits earned by the student. Value examples: ['13', '7', '7'].),\n  (total_gpa:numeric, Cumulative GPA of the student. Value examples: ['3.5', '3.2', '3.6'].),\n  (entered_as:text, Status of the student when they entered the program. e.g. 'Freshman', 'Transfer Student'. Value examples: ['Freshman', 'Freshman', 'Freshman'].),\n  (admit_term:date, Term in which the student was admitted. Format is YYYY-MM-DD. Value examples: ['2018-01-01', '2018-01-01', '2019-01-01'].),\n  (predicted_graduation_semester:date, Semester in which the student is predicted to graduate. Format is YYYY-MM-DD. Value examples: ['2022-05-01', '2022-05-01', '2022-05-01'].),\n  (degree:text, Degree program the student is enrolled in. Can only be 'Bachelor of Science' or 'Bachelor of Arts'.. Value examples: ['Bachelor of Science', 'Bachelor of Science', 'Bachelor of Arts'].),\n  (minor:text, Minor program the student is enrolled in. Value examples: ['NULL', 'NULL', 'Mathematics'].),\n  (internship:text, Internship program the student is enrolled in. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: student_record\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '1', '1'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course was taken. Value examples: ['1', '1', '2'].),\n  (grade:text, The grade received for the course. Value examples: ['A', 'A', 'A'].),\n  (how:text, How the student took the course. Can only be 'in-person' or 'online'.. Value examples: ['in-person', 'in-person', 'in-person'].),\n  (transfer_source:text, If the course was transferred from another institution, the name of that institution. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (earn_credit:text, Whether the student earned credit for the course (e.g. Yes, No). Value examples: ['Yes', 'Yes', 'Yes'].),\n  (repeat_term:text, If the student repeated the course, the semester in which it was repeated. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (test_id:text, Unique identifier for each test taken in the course. Value examples: ['1', '1', '1'].),\n  (offering_id:bigint, Unique identifier for each offering of a course. Value examples: ['1', '2', '3'].),\n]\n\n【Foreign keys】\narea.course_id = course.course_id\ncomment_instructor.instructor_id = instructor.instructor_id\ncomment_instructor.student_id = student.student_id\ncourse.course_id = course_offering.course_id\ncourse.course_id = course_prerequisite.course_id\ncourse.course_id = course_tags_count.course_id\ncourse.course_id = program_course.course_id\ncourse.course_id = student_record.course_id\ncourse_offering.offering_id = offering_instructor.offering_id\ncourse_offering.offering_id = student_record.offering_id\ninstructor.instructor_id = offering_instructor.instructor_id\nprogram.program_id = program_course.program_id\nprogram.program_id = program_requirement.program_id\nprogram.program_id = student.program_id\nstudent.student_id = student_record.student_id\n\n【参考信息】\nstudent.declare_major is null for students who have not declared their major.\nstudent.minor is null for students who have not declared a minor program.\n\n【用户问题】\nWhich students have declared a minor program? List their firstname and lastname. Order the results by the students' last names.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT student.firstname, student.lastname FROM student WHERE student.minor IS NOT NULL ORDER BY student.lastname NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "advising",
    "id": 55,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the average GPA of students in the program mathematics?\n\n【数据库schema】\n【DB_ID】 advising\n【Schema】\n# Table: area\n[\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2'].),\n  (area:text, The area of study for each course. Value examples: ['Computer Science', 'Mathematics'].),\n]\n# Table: comment_instructor\n[\n  (instructor_id:bigint, Unique identifier for the instructor. Value examples: ['1', '2'].),\n  (student_id:bigint, Unique identifier for the student. Value examples: ['1', '2'].),\n  (score:bigint, Score given by the student to the instructor. Value examples: ['5', '4'].),\n  (comment_text:text, Textual comment given by the student about the instructor. Value examples: ['John Smith is a great instructor.', 'Jane Doe explains concepts clearly.'].),\n]\n# Table: course\n[\n  (course_id:bigint, The unique identifier for the course.. Value examples: ['1', '2'].),\n  (name:text, The name of the course.. Value examples: ['Introduction to Computer Science', 'Advanced Calculus'].),\n  (department:text, The department offering the course. Eg 'Mathematics', 'Physics'. Value examples: ['Computer Science', 'Mathematics'].),\n  (number:text, The course number/code.. Value examples: ['CS101', 'MATH201'].),\n  (credits:text, The number of credits awarded for completing the course.. Value examples: ['3', '4'].),\n  (advisory_requirement:text, Any advisory requirements for taking the course.. Value examples: ['NULL', 'CS101'].),\n  (enforced_requirement:text, Any enforced requirements for taking the course.. Value examples: ['NULL', 'NULL'].),\n  (description:text, A brief description of the course content.. Value examples: ['This course introduces the basics of computer science.', 'This course covers advanced topics in calculus.'].),\n  (num_semesters:bigint, The number of semesters the course is offered in a year.. Value examples: ['2', '1'].),\n  (num_enrolled:bigint, The total number of students enrolled in the course.. Value examples: ['2', '3'].),\n  (has_discussion:boolean, Indicates whether the course has any discussion sessions or not.. Value examples: ['true', 'false'].),\n  (has_lab:boolean, Indicates whether the course has any lab sessions or not.. Value examples: ['false', 'false'].),\n  (has_projects:boolean, Indicates whether the course has any projects or not.. Value examples: ['true', 'true'].),\n  (has_exams:boolean, Indicates whether the course has any exams or not.. Value examples: ['false', 'true'].),\n  (num_reviews:bigint, The total number of reviews/ratings for the course.. Value examples: ['10', '5'].),\n  (clarity_score:bigint, The overall clarity score of the course as rated by students.. Value examples: ['5', '4'].),\n  (easiness_score:bigint, The overall easiness score of the course as rated by students.. Value examples: ['3', '2'].),\n  (helpfulness_score:bigint, The overall helpfulness score of the course as rated by students.. Value examples: ['4', '3'].),\n]\n# Table: course_offering\n[\n  (offering_id:bigint, Unique identifier for each course offering. Value examples: ['1', '2', '3'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course is offered. Value examples: ['1', '1', '2'].),\n  (section_number:bigint, The section number of the course. Value examples: ['1', '1', '1'].),\n  (start_time:time, The start time of the course. Value examples: ['08:00:00', '10:00:00', '08:00:00'].),\n  (end_time:time, The end time of the course. Value examples: ['10:00:00', '12:00:00', '10:00:00'].),\n  (monday:text, The instructor's name for Monday. Value examples: ['John Smith', 'NULL', 'John Smith'].),\n  (tuesday:text, The instructor's name for Tuesday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (wednesday:text, The instructor's name for Wednesday. Value examples: ['NULL', 'Gilbert Strang', 'NULL'].),\n  (thursday:text, The instructor's name for Thursday. Value examples: ['Jane Doe', 'NULL', 'Jane Doe'].),\n  (friday:text, The instructor's name for Friday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (saturday:text, The instructor's name for Saturday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (sunday:text, The instructor's name for Sunday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (has_final_project:boolean, Indicates whether the course has a final project. Value examples: ['true', 'true', 'false'].),\n  (has_final_exam:boolean, Indicates whether the course has a final exam. Value examples: ['false', 'true', 'true'].),\n  (textbook:text, The name of the textbook used in the course. Value examples: ['Introduction to Computer Science', 'Advanced Calculus', 'Introduction to Physics'].),\n  (class_address:text, The address of the classroom where the course is held. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (allow_audit:text, Indicates whether auditing the course is allowed. Value examples: ['true', 'false', 'true'].),\n]\n# Table: course_prerequisite\n[\n  (pre_course_id:bigint, The ID of the prerequisite course. Value examples: ['1', '2'].),\n  (course_id:bigint, The ID of the course that has the prerequisite. Value examples: ['2', '3'].),\n]\n# Table: course_tags_count\n[\n  (course_id:bigint, The unique identifier for each course.. Value examples: ['1', '2', '3'].),\n  (clear_grading:bigint, Number of students who found the grading criteria clear and easy to understand.. Value examples: ['5', '4', '3'].),\n  (pop_quiz:bigint, Number of pop quizzes given during the course.. Value examples: ['2', '1', '2'].),\n  (group_projects:bigint, Number of group projects assigned during the course.. Value examples: ['3', '2', '1'].),\n  (inspirational:bigint, Number of students who found the course content inspirational.. Value examples: ['4', '3', '2'].),\n  (long_lectures:bigint, Number of students who found the lectures to be too long.. Value examples: ['2', '1', '3'].),\n  (extra_credit:bigint, Number of extra credit opportunities provided during the course.. Value examples: ['1', '2', '1'].),\n  (few_tests:bigint, Number of tests given during the course.. Value examples: ['3', '2', '1'].),\n  (good_feedback:bigint, Number of students who received good feedback from the instructor.. Value examples: ['4', '3', '2'].),\n  (tough_tests:bigint, Number of students who found the tests to be tough.. Value examples: ['2', '1', '3'].),\n  (heavy_papers:bigint, Number of papers assigned during the course.. Value examples: ['1', '2', '1'].),\n  (cares_for_students:bigint, Number of students who felt that the instructor cared for their well-being.. Value examples: ['5', '4', '3'].),\n  (heavy_assignments:bigint, Number of assignments given during the course.. Value examples: ['3', '2', '1'].),\n  (respected:bigint, Number of students who respected the instructor.. Value examples: ['4', '3', '2'].),\n  (participation:bigint, Number of students who participated actively in the course.. Value examples: ['2', '1', '3'].),\n  (heavy_reading:bigint, Number of reading assignments given during the course.. Value examples: ['1', '2', '1'].),\n  (tough_grader:bigint, Number of students who found the instructor to be a tough grader.. Value examples: ['5', '4', '3'].),\n  (hilarious:bigint, Number of students who found the instructor to be hilarious.. Value examples: ['3', '2', '1'].),\n  (would_take_again:bigint, Number of students who would take the course again.. Value examples: ['4', '3', '2'].),\n  (good_lecture:bigint, Number of students who found the lectures to be good.. Value examples: ['2', '1', '3'].),\n  (no_skip:bigint, Number of students who did not skip any classes during the course.. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: instructor\n[\n  (instructor_id:bigint, Unique identifier for each instructor. Value examples: ['1', '2'].),\n  (name:text, Name of the instructor. Value examples: ['John Smith', 'Jane Doe'].),\n  (uniqname:text, Unique name of the instructor used for login and identification purposes. Value examples: ['jsmith', 'jdoe'].),\n]\n# Table: offering_instructor\n[\n  (offering_instructor_id:bigint, Unique identifier for each offering-instructor pair. Value examples: ['1', '2', '3'].),\n  (offering_id:bigint, Foreign key referencing the offering table. Value examples: ['1', '1', '2'].),\n  (instructor_id:bigint, Foreign key referencing the instructor table. Value examples: ['1', '2', '3'].),\n]\n# Table: program\n[\n  (program_id:bigint, Unique identifier for each program. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the program, Eg 'Computer Science', 'Physics'. Value examples: ['Computer Science', 'Mathematics', 'Physics'].),\n  (college:text, Name of the college offering the program. Value examples: ['Engineering', 'Arts and Sciences', 'Arts and Sciences'].),\n  (introduction:text, Introduction to the program. Value examples: ['This program focuses on computer science principles and applications.', 'This program provides a comprehensive study of mathematical concepts and theories.', 'This program explores the fundamental principles of physics and their applications.'].),\n]\n# Table: program_course\n[\n  (program_id:bigint, The ID of the program associated with the course. Value examples: ['1', '1'].),\n  (course_id:bigint, The ID of the course. Value examples: ['1', '4'].),\n  (workload:bigint, The workload of the course in hours. Value examples: ['100', '80'].),\n  (category:text, The category of the course. Can only be 'Core' or 'Elective'.. Value examples: ['Core', 'Elective'].),\n]\n# Table: program_requirement\n[\n  (program_id:bigint, Unique identifier for a program. Value examples: ['1', '2', '3'].),\n  (category:text, Category of the program. Value examples: ['Core', 'Core', 'Core'].),\n  (min_credit:bigint, Minimum number of credits required for the program. Value examples: ['120', '90', '200'].),\n  (additional_req:text, Additional requirements for the program, if any. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: semester\n[\n  (semester_id:bigint, Unique identifier for each semester. Sort by this column to get the right year-semester order.. Value examples: ['1', '2', '3', '4'].),\n  (semester:text, The name or identifier for the semester Can only be 'Fall', 'Spring', or 'Summer'. Value examples: ['Fall', 'Spring', 'Summer', 'Fall'].),\n  (year:bigint, The year in which the semester takes place. Value examples: ['2020', '2021', '2021', '2021'].),\n]\n# Table: student\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '2', '3'].),\n  (lastname:text, Last name of the student. Value examples: ['Smith', 'Doe', 'Johnson'].),\n  (firstname:text, First name of the student. Value examples: ['John', 'Jane', 'David'].),\n  (program_id:bigint, Identifier for the program the student is enrolled in. Value examples: ['1', '1', '2'].),\n  (declare_major:text, Major program the student declared. Value examples: ['Computer Science', 'Computer Science', 'Mathematics'].),\n  (total_credit:bigint, Total number of credits earned by the student. Value examples: ['13', '7', '7'].),\n  (total_gpa:numeric, Cumulative GPA of the student. Value examples: ['3.5', '3.2', '3.6'].),\n  (entered_as:text, Status of the student when they entered the program. e.g. 'Freshman', 'Transfer Student'. Value examples: ['Freshman', 'Freshman', 'Freshman'].),\n  (admit_term:date, Term in which the student was admitted. Format is YYYY-MM-DD. Value examples: ['2018-01-01', '2018-01-01', '2019-01-01'].),\n  (predicted_graduation_semester:date, Semester in which the student is predicted to graduate. Format is YYYY-MM-DD. Value examples: ['2022-05-01', '2022-05-01', '2022-05-01'].),\n  (degree:text, Degree program the student is enrolled in. Can only be 'Bachelor of Science' or 'Bachelor of Arts'.. Value examples: ['Bachelor of Science', 'Bachelor of Science', 'Bachelor of Arts'].),\n  (minor:text, Minor program the student is enrolled in. Value examples: ['NULL', 'NULL', 'Mathematics'].),\n  (internship:text, Internship program the student is enrolled in. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: student_record\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '1', '1'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course was taken. Value examples: ['1', '1', '2'].),\n  (grade:text, The grade received for the course. Value examples: ['A', 'A', 'A'].),\n  (how:text, How the student took the course. Can only be 'in-person' or 'online'.. Value examples: ['in-person', 'in-person', 'in-person'].),\n  (transfer_source:text, If the course was transferred from another institution, the name of that institution. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (earn_credit:text, Whether the student earned credit for the course (e.g. Yes, No). Value examples: ['Yes', 'Yes', 'Yes'].),\n  (repeat_term:text, If the student repeated the course, the semester in which it was repeated. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (test_id:text, Unique identifier for each test taken in the course. Value examples: ['1', '1', '1'].),\n  (offering_id:bigint, Unique identifier for each offering of a course. Value examples: ['1', '2', '3'].),\n]\n\n【Foreign keys】\narea.course_id = course.course_id\ncomment_instructor.instructor_id = instructor.instructor_id\ncomment_instructor.student_id = student.student_id\ncourse.course_id = course_offering.course_id\ncourse.course_id = course_prerequisite.course_id\ncourse.course_id = course_tags_count.course_id\ncourse.course_id = program_course.course_id\ncourse.course_id = student_record.course_id\ncourse_offering.offering_id = offering_instructor.offering_id\ncourse_offering.offering_id = student_record.offering_id\ninstructor.instructor_id = offering_instructor.instructor_id\nprogram.program_id = program_course.program_id\nprogram.program_id = program_requirement.program_id\nprogram.program_id = student.program_id\nstudent.student_id = student_record.student_id\n\n【参考信息】\nMatch strings case-insensitively\n\n【用户问题】\nWhat is the average GPA of students in the program mathematics?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT AVG(student.total_gpa) FROM student JOIN program ON student.program_id = program.program_id WHERE LOWER(program.name) = 'mathematics';",
        "role": "assistant"
      }
    ],
    "db_name": "advising",
    "id": 56,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the names of all the courses offered by the department of Computer Science?\n\n【数据库schema】\n【DB_ID】 advising\n【Schema】\n# Table: area\n[\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2'].),\n  (area:text, The area of study for each course. Value examples: ['Computer Science', 'Mathematics'].),\n]\n# Table: comment_instructor\n[\n  (instructor_id:bigint, Unique identifier for the instructor. Value examples: ['1', '2'].),\n  (student_id:bigint, Unique identifier for the student. Value examples: ['1', '2'].),\n  (score:bigint, Score given by the student to the instructor. Value examples: ['5', '4'].),\n  (comment_text:text, Textual comment given by the student about the instructor. Value examples: ['John Smith is a great instructor.', 'Jane Doe explains concepts clearly.'].),\n]\n# Table: course\n[\n  (course_id:bigint, The unique identifier for the course.. Value examples: ['1', '2'].),\n  (name:text, The name of the course.. Value examples: ['Introduction to Computer Science', 'Advanced Calculus'].),\n  (department:text, The department offering the course. Eg 'Mathematics', 'Physics'. Value examples: ['Computer Science', 'Mathematics'].),\n  (number:text, The course number/code.. Value examples: ['CS101', 'MATH201'].),\n  (credits:text, The number of credits awarded for completing the course.. Value examples: ['3', '4'].),\n  (advisory_requirement:text, Any advisory requirements for taking the course.. Value examples: ['NULL', 'CS101'].),\n  (enforced_requirement:text, Any enforced requirements for taking the course.. Value examples: ['NULL', 'NULL'].),\n  (description:text, A brief description of the course content.. Value examples: ['This course introduces the basics of computer science.', 'This course covers advanced topics in calculus.'].),\n  (num_semesters:bigint, The number of semesters the course is offered in a year.. Value examples: ['2', '1'].),\n  (num_enrolled:bigint, The total number of students enrolled in the course.. Value examples: ['2', '3'].),\n  (has_discussion:boolean, Indicates whether the course has any discussion sessions or not.. Value examples: ['true', 'false'].),\n  (has_lab:boolean, Indicates whether the course has any lab sessions or not.. Value examples: ['false', 'false'].),\n  (has_projects:boolean, Indicates whether the course has any projects or not.. Value examples: ['true', 'true'].),\n  (has_exams:boolean, Indicates whether the course has any exams or not.. Value examples: ['false', 'true'].),\n  (num_reviews:bigint, The total number of reviews/ratings for the course.. Value examples: ['10', '5'].),\n  (clarity_score:bigint, The overall clarity score of the course as rated by students.. Value examples: ['5', '4'].),\n  (easiness_score:bigint, The overall easiness score of the course as rated by students.. Value examples: ['3', '2'].),\n  (helpfulness_score:bigint, The overall helpfulness score of the course as rated by students.. Value examples: ['4', '3'].),\n]\n# Table: course_offering\n[\n  (offering_id:bigint, Unique identifier for each course offering. Value examples: ['1', '2', '3'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course is offered. Value examples: ['1', '1', '2'].),\n  (section_number:bigint, The section number of the course. Value examples: ['1', '1', '1'].),\n  (start_time:time, The start time of the course. Value examples: ['08:00:00', '10:00:00', '08:00:00'].),\n  (end_time:time, The end time of the course. Value examples: ['10:00:00', '12:00:00', '10:00:00'].),\n  (monday:text, The instructor's name for Monday. Value examples: ['John Smith', 'NULL', 'John Smith'].),\n  (tuesday:text, The instructor's name for Tuesday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (wednesday:text, The instructor's name for Wednesday. Value examples: ['NULL', 'Gilbert Strang', 'NULL'].),\n  (thursday:text, The instructor's name for Thursday. Value examples: ['Jane Doe', 'NULL', 'Jane Doe'].),\n  (friday:text, The instructor's name for Friday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (saturday:text, The instructor's name for Saturday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (sunday:text, The instructor's name for Sunday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (has_final_project:boolean, Indicates whether the course has a final project. Value examples: ['true', 'true', 'false'].),\n  (has_final_exam:boolean, Indicates whether the course has a final exam. Value examples: ['false', 'true', 'true'].),\n  (textbook:text, The name of the textbook used in the course. Value examples: ['Introduction to Computer Science', 'Advanced Calculus', 'Introduction to Physics'].),\n  (class_address:text, The address of the classroom where the course is held. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (allow_audit:text, Indicates whether auditing the course is allowed. Value examples: ['true', 'false', 'true'].),\n]\n# Table: course_prerequisite\n[\n  (pre_course_id:bigint, The ID of the prerequisite course. Value examples: ['1', '2'].),\n  (course_id:bigint, The ID of the course that has the prerequisite. Value examples: ['2', '3'].),\n]\n# Table: course_tags_count\n[\n  (course_id:bigint, The unique identifier for each course.. Value examples: ['1', '2', '3'].),\n  (clear_grading:bigint, Number of students who found the grading criteria clear and easy to understand.. Value examples: ['5', '4', '3'].),\n  (pop_quiz:bigint, Number of pop quizzes given during the course.. Value examples: ['2', '1', '2'].),\n  (group_projects:bigint, Number of group projects assigned during the course.. Value examples: ['3', '2', '1'].),\n  (inspirational:bigint, Number of students who found the course content inspirational.. Value examples: ['4', '3', '2'].),\n  (long_lectures:bigint, Number of students who found the lectures to be too long.. Value examples: ['2', '1', '3'].),\n  (extra_credit:bigint, Number of extra credit opportunities provided during the course.. Value examples: ['1', '2', '1'].),\n  (few_tests:bigint, Number of tests given during the course.. Value examples: ['3', '2', '1'].),\n  (good_feedback:bigint, Number of students who received good feedback from the instructor.. Value examples: ['4', '3', '2'].),\n  (tough_tests:bigint, Number of students who found the tests to be tough.. Value examples: ['2', '1', '3'].),\n  (heavy_papers:bigint, Number of papers assigned during the course.. Value examples: ['1', '2', '1'].),\n  (cares_for_students:bigint, Number of students who felt that the instructor cared for their well-being.. Value examples: ['5', '4', '3'].),\n  (heavy_assignments:bigint, Number of assignments given during the course.. Value examples: ['3', '2', '1'].),\n  (respected:bigint, Number of students who respected the instructor.. Value examples: ['4', '3', '2'].),\n  (participation:bigint, Number of students who participated actively in the course.. Value examples: ['2', '1', '3'].),\n  (heavy_reading:bigint, Number of reading assignments given during the course.. Value examples: ['1', '2', '1'].),\n  (tough_grader:bigint, Number of students who found the instructor to be a tough grader.. Value examples: ['5', '4', '3'].),\n  (hilarious:bigint, Number of students who found the instructor to be hilarious.. Value examples: ['3', '2', '1'].),\n  (would_take_again:bigint, Number of students who would take the course again.. Value examples: ['4', '3', '2'].),\n  (good_lecture:bigint, Number of students who found the lectures to be good.. Value examples: ['2', '1', '3'].),\n  (no_skip:bigint, Number of students who did not skip any classes during the course.. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: instructor\n[\n  (instructor_id:bigint, Unique identifier for each instructor. Value examples: ['1', '2'].),\n  (name:text, Name of the instructor. Value examples: ['John Smith', 'Jane Doe'].),\n  (uniqname:text, Unique name of the instructor used for login and identification purposes. Value examples: ['jsmith', 'jdoe'].),\n]\n# Table: offering_instructor\n[\n  (offering_instructor_id:bigint, Unique identifier for each offering-instructor pair. Value examples: ['1', '2', '3'].),\n  (offering_id:bigint, Foreign key referencing the offering table. Value examples: ['1', '1', '2'].),\n  (instructor_id:bigint, Foreign key referencing the instructor table. Value examples: ['1', '2', '3'].),\n]\n# Table: program\n[\n  (program_id:bigint, Unique identifier for each program. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the program, Eg 'Computer Science', 'Physics'. Value examples: ['Computer Science', 'Mathematics', 'Physics'].),\n  (college:text, Name of the college offering the program. Value examples: ['Engineering', 'Arts and Sciences', 'Arts and Sciences'].),\n  (introduction:text, Introduction to the program. Value examples: ['This program focuses on computer science principles and applications.', 'This program provides a comprehensive study of mathematical concepts and theories.', 'This program explores the fundamental principles of physics and their applications.'].),\n]\n# Table: program_course\n[\n  (program_id:bigint, The ID of the program associated with the course. Value examples: ['1', '1'].),\n  (course_id:bigint, The ID of the course. Value examples: ['1', '4'].),\n  (workload:bigint, The workload of the course in hours. Value examples: ['100', '80'].),\n  (category:text, The category of the course. Can only be 'Core' or 'Elective'.. Value examples: ['Core', 'Elective'].),\n]\n# Table: program_requirement\n[\n  (program_id:bigint, Unique identifier for a program. Value examples: ['1', '2', '3'].),\n  (category:text, Category of the program. Value examples: ['Core', 'Core', 'Core'].),\n  (min_credit:bigint, Minimum number of credits required for the program. Value examples: ['120', '90', '200'].),\n  (additional_req:text, Additional requirements for the program, if any. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: semester\n[\n  (semester_id:bigint, Unique identifier for each semester. Sort by this column to get the right year-semester order.. Value examples: ['1', '2', '3', '4'].),\n  (semester:text, The name or identifier for the semester Can only be 'Fall', 'Spring', or 'Summer'. Value examples: ['Fall', 'Spring', 'Summer', 'Fall'].),\n  (year:bigint, The year in which the semester takes place. Value examples: ['2020', '2021', '2021', '2021'].),\n]\n# Table: student\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '2', '3'].),\n  (lastname:text, Last name of the student. Value examples: ['Smith', 'Doe', 'Johnson'].),\n  (firstname:text, First name of the student. Value examples: ['John', 'Jane', 'David'].),\n  (program_id:bigint, Identifier for the program the student is enrolled in. Value examples: ['1', '1', '2'].),\n  (declare_major:text, Major program the student declared. Value examples: ['Computer Science', 'Computer Science', 'Mathematics'].),\n  (total_credit:bigint, Total number of credits earned by the student. Value examples: ['13', '7', '7'].),\n  (total_gpa:numeric, Cumulative GPA of the student. Value examples: ['3.5', '3.2', '3.6'].),\n  (entered_as:text, Status of the student when they entered the program. e.g. 'Freshman', 'Transfer Student'. Value examples: ['Freshman', 'Freshman', 'Freshman'].),\n  (admit_term:date, Term in which the student was admitted. Format is YYYY-MM-DD. Value examples: ['2018-01-01', '2018-01-01', '2019-01-01'].),\n  (predicted_graduation_semester:date, Semester in which the student is predicted to graduate. Format is YYYY-MM-DD. Value examples: ['2022-05-01', '2022-05-01', '2022-05-01'].),\n  (degree:text, Degree program the student is enrolled in. Can only be 'Bachelor of Science' or 'Bachelor of Arts'.. Value examples: ['Bachelor of Science', 'Bachelor of Science', 'Bachelor of Arts'].),\n  (minor:text, Minor program the student is enrolled in. Value examples: ['NULL', 'NULL', 'Mathematics'].),\n  (internship:text, Internship program the student is enrolled in. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: student_record\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '1', '1'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course was taken. Value examples: ['1', '1', '2'].),\n  (grade:text, The grade received for the course. Value examples: ['A', 'A', 'A'].),\n  (how:text, How the student took the course. Can only be 'in-person' or 'online'.. Value examples: ['in-person', 'in-person', 'in-person'].),\n  (transfer_source:text, If the course was transferred from another institution, the name of that institution. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (earn_credit:text, Whether the student earned credit for the course (e.g. Yes, No). Value examples: ['Yes', 'Yes', 'Yes'].),\n  (repeat_term:text, If the student repeated the course, the semester in which it was repeated. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (test_id:text, Unique identifier for each test taken in the course. Value examples: ['1', '1', '1'].),\n  (offering_id:bigint, Unique identifier for each offering of a course. Value examples: ['1', '2', '3'].),\n]\n\n【Foreign keys】\narea.course_id = course.course_id\ncomment_instructor.instructor_id = instructor.instructor_id\ncomment_instructor.student_id = student.student_id\ncourse.course_id = course_offering.course_id\ncourse.course_id = course_prerequisite.course_id\ncourse.course_id = course_tags_count.course_id\ncourse.course_id = program_course.course_id\ncourse.course_id = student_record.course_id\ncourse_offering.offering_id = offering_instructor.offering_id\ncourse_offering.offering_id = student_record.offering_id\ninstructor.instructor_id = offering_instructor.instructor_id\nprogram.program_id = program_course.program_id\nprogram.program_id = program_requirement.program_id\nprogram.program_id = student.program_id\nstudent.student_id = student_record.student_id\n\n【参考信息】\nFilter strings using ILIKE.\nUse the student_record table for all information relating to students' choices and their course.\n\n【用户问题】\nWhat are the names of all the courses offered by the department of Computer Science?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT course.name FROM course WHERE course.department ILIKE '%Computer Science%' ORDER BY course.name ASC NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "advising",
    "id": 57,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the easiness scores for courses in the \"Computer Science\" department? Show both courses and scores.\n\n【数据库schema】\n【DB_ID】 advising\n【Schema】\n# Table: area\n[\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2'].),\n  (area:text, The area of study for each course. Value examples: ['Computer Science', 'Mathematics'].),\n]\n# Table: comment_instructor\n[\n  (instructor_id:bigint, Unique identifier for the instructor. Value examples: ['1', '2'].),\n  (student_id:bigint, Unique identifier for the student. Value examples: ['1', '2'].),\n  (score:bigint, Score given by the student to the instructor. Value examples: ['5', '4'].),\n  (comment_text:text, Textual comment given by the student about the instructor. Value examples: ['John Smith is a great instructor.', 'Jane Doe explains concepts clearly.'].),\n]\n# Table: course\n[\n  (course_id:bigint, The unique identifier for the course.. Value examples: ['1', '2'].),\n  (name:text, The name of the course.. Value examples: ['Introduction to Computer Science', 'Advanced Calculus'].),\n  (department:text, The department offering the course. Eg 'Mathematics', 'Physics'. Value examples: ['Computer Science', 'Mathematics'].),\n  (number:text, The course number/code.. Value examples: ['CS101', 'MATH201'].),\n  (credits:text, The number of credits awarded for completing the course.. Value examples: ['3', '4'].),\n  (advisory_requirement:text, Any advisory requirements for taking the course.. Value examples: ['NULL', 'CS101'].),\n  (enforced_requirement:text, Any enforced requirements for taking the course.. Value examples: ['NULL', 'NULL'].),\n  (description:text, A brief description of the course content.. Value examples: ['This course introduces the basics of computer science.', 'This course covers advanced topics in calculus.'].),\n  (num_semesters:bigint, The number of semesters the course is offered in a year.. Value examples: ['2', '1'].),\n  (num_enrolled:bigint, The total number of students enrolled in the course.. Value examples: ['2', '3'].),\n  (has_discussion:boolean, Indicates whether the course has any discussion sessions or not.. Value examples: ['true', 'false'].),\n  (has_lab:boolean, Indicates whether the course has any lab sessions or not.. Value examples: ['false', 'false'].),\n  (has_projects:boolean, Indicates whether the course has any projects or not.. Value examples: ['true', 'true'].),\n  (has_exams:boolean, Indicates whether the course has any exams or not.. Value examples: ['false', 'true'].),\n  (num_reviews:bigint, The total number of reviews/ratings for the course.. Value examples: ['10', '5'].),\n  (clarity_score:bigint, The overall clarity score of the course as rated by students.. Value examples: ['5', '4'].),\n  (easiness_score:bigint, The overall easiness score of the course as rated by students.. Value examples: ['3', '2'].),\n  (helpfulness_score:bigint, The overall helpfulness score of the course as rated by students.. Value examples: ['4', '3'].),\n]\n# Table: course_offering\n[\n  (offering_id:bigint, Unique identifier for each course offering. Value examples: ['1', '2', '3'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course is offered. Value examples: ['1', '1', '2'].),\n  (section_number:bigint, The section number of the course. Value examples: ['1', '1', '1'].),\n  (start_time:time, The start time of the course. Value examples: ['08:00:00', '10:00:00', '08:00:00'].),\n  (end_time:time, The end time of the course. Value examples: ['10:00:00', '12:00:00', '10:00:00'].),\n  (monday:text, The instructor's name for Monday. Value examples: ['John Smith', 'NULL', 'John Smith'].),\n  (tuesday:text, The instructor's name for Tuesday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (wednesday:text, The instructor's name for Wednesday. Value examples: ['NULL', 'Gilbert Strang', 'NULL'].),\n  (thursday:text, The instructor's name for Thursday. Value examples: ['Jane Doe', 'NULL', 'Jane Doe'].),\n  (friday:text, The instructor's name for Friday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (saturday:text, The instructor's name for Saturday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (sunday:text, The instructor's name for Sunday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (has_final_project:boolean, Indicates whether the course has a final project. Value examples: ['true', 'true', 'false'].),\n  (has_final_exam:boolean, Indicates whether the course has a final exam. Value examples: ['false', 'true', 'true'].),\n  (textbook:text, The name of the textbook used in the course. Value examples: ['Introduction to Computer Science', 'Advanced Calculus', 'Introduction to Physics'].),\n  (class_address:text, The address of the classroom where the course is held. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (allow_audit:text, Indicates whether auditing the course is allowed. Value examples: ['true', 'false', 'true'].),\n]\n# Table: course_prerequisite\n[\n  (pre_course_id:bigint, The ID of the prerequisite course. Value examples: ['1', '2'].),\n  (course_id:bigint, The ID of the course that has the prerequisite. Value examples: ['2', '3'].),\n]\n# Table: course_tags_count\n[\n  (course_id:bigint, The unique identifier for each course.. Value examples: ['1', '2', '3'].),\n  (clear_grading:bigint, Number of students who found the grading criteria clear and easy to understand.. Value examples: ['5', '4', '3'].),\n  (pop_quiz:bigint, Number of pop quizzes given during the course.. Value examples: ['2', '1', '2'].),\n  (group_projects:bigint, Number of group projects assigned during the course.. Value examples: ['3', '2', '1'].),\n  (inspirational:bigint, Number of students who found the course content inspirational.. Value examples: ['4', '3', '2'].),\n  (long_lectures:bigint, Number of students who found the lectures to be too long.. Value examples: ['2', '1', '3'].),\n  (extra_credit:bigint, Number of extra credit opportunities provided during the course.. Value examples: ['1', '2', '1'].),\n  (few_tests:bigint, Number of tests given during the course.. Value examples: ['3', '2', '1'].),\n  (good_feedback:bigint, Number of students who received good feedback from the instructor.. Value examples: ['4', '3', '2'].),\n  (tough_tests:bigint, Number of students who found the tests to be tough.. Value examples: ['2', '1', '3'].),\n  (heavy_papers:bigint, Number of papers assigned during the course.. Value examples: ['1', '2', '1'].),\n  (cares_for_students:bigint, Number of students who felt that the instructor cared for their well-being.. Value examples: ['5', '4', '3'].),\n  (heavy_assignments:bigint, Number of assignments given during the course.. Value examples: ['3', '2', '1'].),\n  (respected:bigint, Number of students who respected the instructor.. Value examples: ['4', '3', '2'].),\n  (participation:bigint, Number of students who participated actively in the course.. Value examples: ['2', '1', '3'].),\n  (heavy_reading:bigint, Number of reading assignments given during the course.. Value examples: ['1', '2', '1'].),\n  (tough_grader:bigint, Number of students who found the instructor to be a tough grader.. Value examples: ['5', '4', '3'].),\n  (hilarious:bigint, Number of students who found the instructor to be hilarious.. Value examples: ['3', '2', '1'].),\n  (would_take_again:bigint, Number of students who would take the course again.. Value examples: ['4', '3', '2'].),\n  (good_lecture:bigint, Number of students who found the lectures to be good.. Value examples: ['2', '1', '3'].),\n  (no_skip:bigint, Number of students who did not skip any classes during the course.. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: instructor\n[\n  (instructor_id:bigint, Unique identifier for each instructor. Value examples: ['1', '2'].),\n  (name:text, Name of the instructor. Value examples: ['John Smith', 'Jane Doe'].),\n  (uniqname:text, Unique name of the instructor used for login and identification purposes. Value examples: ['jsmith', 'jdoe'].),\n]\n# Table: offering_instructor\n[\n  (offering_instructor_id:bigint, Unique identifier for each offering-instructor pair. Value examples: ['1', '2', '3'].),\n  (offering_id:bigint, Foreign key referencing the offering table. Value examples: ['1', '1', '2'].),\n  (instructor_id:bigint, Foreign key referencing the instructor table. Value examples: ['1', '2', '3'].),\n]\n# Table: program\n[\n  (program_id:bigint, Unique identifier for each program. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the program, Eg 'Computer Science', 'Physics'. Value examples: ['Computer Science', 'Mathematics', 'Physics'].),\n  (college:text, Name of the college offering the program. Value examples: ['Engineering', 'Arts and Sciences', 'Arts and Sciences'].),\n  (introduction:text, Introduction to the program. Value examples: ['This program focuses on computer science principles and applications.', 'This program provides a comprehensive study of mathematical concepts and theories.', 'This program explores the fundamental principles of physics and their applications.'].),\n]\n# Table: program_course\n[\n  (program_id:bigint, The ID of the program associated with the course. Value examples: ['1', '1'].),\n  (course_id:bigint, The ID of the course. Value examples: ['1', '4'].),\n  (workload:bigint, The workload of the course in hours. Value examples: ['100', '80'].),\n  (category:text, The category of the course. Can only be 'Core' or 'Elective'.. Value examples: ['Core', 'Elective'].),\n]\n# Table: program_requirement\n[\n  (program_id:bigint, Unique identifier for a program. Value examples: ['1', '2', '3'].),\n  (category:text, Category of the program. Value examples: ['Core', 'Core', 'Core'].),\n  (min_credit:bigint, Minimum number of credits required for the program. Value examples: ['120', '90', '200'].),\n  (additional_req:text, Additional requirements for the program, if any. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: semester\n[\n  (semester_id:bigint, Unique identifier for each semester. Sort by this column to get the right year-semester order.. Value examples: ['1', '2', '3', '4'].),\n  (semester:text, The name or identifier for the semester Can only be 'Fall', 'Spring', or 'Summer'. Value examples: ['Fall', 'Spring', 'Summer', 'Fall'].),\n  (year:bigint, The year in which the semester takes place. Value examples: ['2020', '2021', '2021', '2021'].),\n]\n# Table: student\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '2', '3'].),\n  (lastname:text, Last name of the student. Value examples: ['Smith', 'Doe', 'Johnson'].),\n  (firstname:text, First name of the student. Value examples: ['John', 'Jane', 'David'].),\n  (program_id:bigint, Identifier for the program the student is enrolled in. Value examples: ['1', '1', '2'].),\n  (declare_major:text, Major program the student declared. Value examples: ['Computer Science', 'Computer Science', 'Mathematics'].),\n  (total_credit:bigint, Total number of credits earned by the student. Value examples: ['13', '7', '7'].),\n  (total_gpa:numeric, Cumulative GPA of the student. Value examples: ['3.5', '3.2', '3.6'].),\n  (entered_as:text, Status of the student when they entered the program. e.g. 'Freshman', 'Transfer Student'. Value examples: ['Freshman', 'Freshman', 'Freshman'].),\n  (admit_term:date, Term in which the student was admitted. Format is YYYY-MM-DD. Value examples: ['2018-01-01', '2018-01-01', '2019-01-01'].),\n  (predicted_graduation_semester:date, Semester in which the student is predicted to graduate. Format is YYYY-MM-DD. Value examples: ['2022-05-01', '2022-05-01', '2022-05-01'].),\n  (degree:text, Degree program the student is enrolled in. Can only be 'Bachelor of Science' or 'Bachelor of Arts'.. Value examples: ['Bachelor of Science', 'Bachelor of Science', 'Bachelor of Arts'].),\n  (minor:text, Minor program the student is enrolled in. Value examples: ['NULL', 'NULL', 'Mathematics'].),\n  (internship:text, Internship program the student is enrolled in. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: student_record\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '1', '1'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course was taken. Value examples: ['1', '1', '2'].),\n  (grade:text, The grade received for the course. Value examples: ['A', 'A', 'A'].),\n  (how:text, How the student took the course. Can only be 'in-person' or 'online'.. Value examples: ['in-person', 'in-person', 'in-person'].),\n  (transfer_source:text, If the course was transferred from another institution, the name of that institution. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (earn_credit:text, Whether the student earned credit for the course (e.g. Yes, No). Value examples: ['Yes', 'Yes', 'Yes'].),\n  (repeat_term:text, If the student repeated the course, the semester in which it was repeated. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (test_id:text, Unique identifier for each test taken in the course. Value examples: ['1', '1', '1'].),\n  (offering_id:bigint, Unique identifier for each offering of a course. Value examples: ['1', '2', '3'].),\n]\n\n【Foreign keys】\narea.course_id = course.course_id\ncomment_instructor.instructor_id = instructor.instructor_id\ncomment_instructor.student_id = student.student_id\ncourse.course_id = course_offering.course_id\ncourse.course_id = course_prerequisite.course_id\ncourse.course_id = course_tags_count.course_id\ncourse.course_id = program_course.course_id\ncourse.course_id = student_record.course_id\ncourse_offering.offering_id = offering_instructor.offering_id\ncourse_offering.offering_id = student_record.offering_id\ninstructor.instructor_id = offering_instructor.instructor_id\nprogram.program_id = program_course.program_id\nprogram.program_id = program_requirement.program_id\nprogram.program_id = student.program_id\nstudent.student_id = student_record.student_id\n\n【参考信息】\nAlways filter names using exact string matching\n\n【用户问题】\nWhat are the easiness scores for courses in the \"Computer Science\" department? Show both courses and scores.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT course.name, course.course_id, course.number, course.easiness_score FROM course WHERE course.department = 'Computer Science'",
        "role": "assistant"
      }
    ],
    "db_name": "advising",
    "id": 58,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nReturn the student IDs who have taken an in-person course and have gotten a grade of A or C.\n\n【数据库schema】\n【DB_ID】 advising\n【Schema】\n# Table: area\n[\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2'].),\n  (area:text, The area of study for each course. Value examples: ['Computer Science', 'Mathematics'].),\n]\n# Table: comment_instructor\n[\n  (instructor_id:bigint, Unique identifier for the instructor. Value examples: ['1', '2'].),\n  (student_id:bigint, Unique identifier for the student. Value examples: ['1', '2'].),\n  (score:bigint, Score given by the student to the instructor. Value examples: ['5', '4'].),\n  (comment_text:text, Textual comment given by the student about the instructor. Value examples: ['John Smith is a great instructor.', 'Jane Doe explains concepts clearly.'].),\n]\n# Table: course\n[\n  (course_id:bigint, The unique identifier for the course.. Value examples: ['1', '2'].),\n  (name:text, The name of the course.. Value examples: ['Introduction to Computer Science', 'Advanced Calculus'].),\n  (department:text, The department offering the course. Eg 'Mathematics', 'Physics'. Value examples: ['Computer Science', 'Mathematics'].),\n  (number:text, The course number/code.. Value examples: ['CS101', 'MATH201'].),\n  (credits:text, The number of credits awarded for completing the course.. Value examples: ['3', '4'].),\n  (advisory_requirement:text, Any advisory requirements for taking the course.. Value examples: ['NULL', 'CS101'].),\n  (enforced_requirement:text, Any enforced requirements for taking the course.. Value examples: ['NULL', 'NULL'].),\n  (description:text, A brief description of the course content.. Value examples: ['This course introduces the basics of computer science.', 'This course covers advanced topics in calculus.'].),\n  (num_semesters:bigint, The number of semesters the course is offered in a year.. Value examples: ['2', '1'].),\n  (num_enrolled:bigint, The total number of students enrolled in the course.. Value examples: ['2', '3'].),\n  (has_discussion:boolean, Indicates whether the course has any discussion sessions or not.. Value examples: ['true', 'false'].),\n  (has_lab:boolean, Indicates whether the course has any lab sessions or not.. Value examples: ['false', 'false'].),\n  (has_projects:boolean, Indicates whether the course has any projects or not.. Value examples: ['true', 'true'].),\n  (has_exams:boolean, Indicates whether the course has any exams or not.. Value examples: ['false', 'true'].),\n  (num_reviews:bigint, The total number of reviews/ratings for the course.. Value examples: ['10', '5'].),\n  (clarity_score:bigint, The overall clarity score of the course as rated by students.. Value examples: ['5', '4'].),\n  (easiness_score:bigint, The overall easiness score of the course as rated by students.. Value examples: ['3', '2'].),\n  (helpfulness_score:bigint, The overall helpfulness score of the course as rated by students.. Value examples: ['4', '3'].),\n]\n# Table: course_offering\n[\n  (offering_id:bigint, Unique identifier for each course offering. Value examples: ['1', '2', '3'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course is offered. Value examples: ['1', '1', '2'].),\n  (section_number:bigint, The section number of the course. Value examples: ['1', '1', '1'].),\n  (start_time:time, The start time of the course. Value examples: ['08:00:00', '10:00:00', '08:00:00'].),\n  (end_time:time, The end time of the course. Value examples: ['10:00:00', '12:00:00', '10:00:00'].),\n  (monday:text, The instructor's name for Monday. Value examples: ['John Smith', 'NULL', 'John Smith'].),\n  (tuesday:text, The instructor's name for Tuesday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (wednesday:text, The instructor's name for Wednesday. Value examples: ['NULL', 'Gilbert Strang', 'NULL'].),\n  (thursday:text, The instructor's name for Thursday. Value examples: ['Jane Doe', 'NULL', 'Jane Doe'].),\n  (friday:text, The instructor's name for Friday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (saturday:text, The instructor's name for Saturday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (sunday:text, The instructor's name for Sunday. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (has_final_project:boolean, Indicates whether the course has a final project. Value examples: ['true', 'true', 'false'].),\n  (has_final_exam:boolean, Indicates whether the course has a final exam. Value examples: ['false', 'true', 'true'].),\n  (textbook:text, The name of the textbook used in the course. Value examples: ['Introduction to Computer Science', 'Advanced Calculus', 'Introduction to Physics'].),\n  (class_address:text, The address of the classroom where the course is held. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (allow_audit:text, Indicates whether auditing the course is allowed. Value examples: ['true', 'false', 'true'].),\n]\n# Table: course_prerequisite\n[\n  (pre_course_id:bigint, The ID of the prerequisite course. Value examples: ['1', '2'].),\n  (course_id:bigint, The ID of the course that has the prerequisite. Value examples: ['2', '3'].),\n]\n# Table: course_tags_count\n[\n  (course_id:bigint, The unique identifier for each course.. Value examples: ['1', '2', '3'].),\n  (clear_grading:bigint, Number of students who found the grading criteria clear and easy to understand.. Value examples: ['5', '4', '3'].),\n  (pop_quiz:bigint, Number of pop quizzes given during the course.. Value examples: ['2', '1', '2'].),\n  (group_projects:bigint, Number of group projects assigned during the course.. Value examples: ['3', '2', '1'].),\n  (inspirational:bigint, Number of students who found the course content inspirational.. Value examples: ['4', '3', '2'].),\n  (long_lectures:bigint, Number of students who found the lectures to be too long.. Value examples: ['2', '1', '3'].),\n  (extra_credit:bigint, Number of extra credit opportunities provided during the course.. Value examples: ['1', '2', '1'].),\n  (few_tests:bigint, Number of tests given during the course.. Value examples: ['3', '2', '1'].),\n  (good_feedback:bigint, Number of students who received good feedback from the instructor.. Value examples: ['4', '3', '2'].),\n  (tough_tests:bigint, Number of students who found the tests to be tough.. Value examples: ['2', '1', '3'].),\n  (heavy_papers:bigint, Number of papers assigned during the course.. Value examples: ['1', '2', '1'].),\n  (cares_for_students:bigint, Number of students who felt that the instructor cared for their well-being.. Value examples: ['5', '4', '3'].),\n  (heavy_assignments:bigint, Number of assignments given during the course.. Value examples: ['3', '2', '1'].),\n  (respected:bigint, Number of students who respected the instructor.. Value examples: ['4', '3', '2'].),\n  (participation:bigint, Number of students who participated actively in the course.. Value examples: ['2', '1', '3'].),\n  (heavy_reading:bigint, Number of reading assignments given during the course.. Value examples: ['1', '2', '1'].),\n  (tough_grader:bigint, Number of students who found the instructor to be a tough grader.. Value examples: ['5', '4', '3'].),\n  (hilarious:bigint, Number of students who found the instructor to be hilarious.. Value examples: ['3', '2', '1'].),\n  (would_take_again:bigint, Number of students who would take the course again.. Value examples: ['4', '3', '2'].),\n  (good_lecture:bigint, Number of students who found the lectures to be good.. Value examples: ['2', '1', '3'].),\n  (no_skip:bigint, Number of students who did not skip any classes during the course.. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: instructor\n[\n  (instructor_id:bigint, Unique identifier for each instructor. Value examples: ['1', '2'].),\n  (name:text, Name of the instructor. Value examples: ['John Smith', 'Jane Doe'].),\n  (uniqname:text, Unique name of the instructor used for login and identification purposes. Value examples: ['jsmith', 'jdoe'].),\n]\n# Table: offering_instructor\n[\n  (offering_instructor_id:bigint, Unique identifier for each offering-instructor pair. Value examples: ['1', '2', '3'].),\n  (offering_id:bigint, Foreign key referencing the offering table. Value examples: ['1', '1', '2'].),\n  (instructor_id:bigint, Foreign key referencing the instructor table. Value examples: ['1', '2', '3'].),\n]\n# Table: program\n[\n  (program_id:bigint, Unique identifier for each program. Value examples: ['1', '2', '3'].),\n  (name:text, Name of the program, Eg 'Computer Science', 'Physics'. Value examples: ['Computer Science', 'Mathematics', 'Physics'].),\n  (college:text, Name of the college offering the program. Value examples: ['Engineering', 'Arts and Sciences', 'Arts and Sciences'].),\n  (introduction:text, Introduction to the program. Value examples: ['This program focuses on computer science principles and applications.', 'This program provides a comprehensive study of mathematical concepts and theories.', 'This program explores the fundamental principles of physics and their applications.'].),\n]\n# Table: program_course\n[\n  (program_id:bigint, The ID of the program associated with the course. Value examples: ['1', '1'].),\n  (course_id:bigint, The ID of the course. Value examples: ['1', '4'].),\n  (workload:bigint, The workload of the course in hours. Value examples: ['100', '80'].),\n  (category:text, The category of the course. Can only be 'Core' or 'Elective'.. Value examples: ['Core', 'Elective'].),\n]\n# Table: program_requirement\n[\n  (program_id:bigint, Unique identifier for a program. Value examples: ['1', '2', '3'].),\n  (category:text, Category of the program. Value examples: ['Core', 'Core', 'Core'].),\n  (min_credit:bigint, Minimum number of credits required for the program. Value examples: ['120', '90', '200'].),\n  (additional_req:text, Additional requirements for the program, if any. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: semester\n[\n  (semester_id:bigint, Unique identifier for each semester. Sort by this column to get the right year-semester order.. Value examples: ['1', '2', '3', '4'].),\n  (semester:text, The name or identifier for the semester Can only be 'Fall', 'Spring', or 'Summer'. Value examples: ['Fall', 'Spring', 'Summer', 'Fall'].),\n  (year:bigint, The year in which the semester takes place. Value examples: ['2020', '2021', '2021', '2021'].),\n]\n# Table: student\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '2', '3'].),\n  (lastname:text, Last name of the student. Value examples: ['Smith', 'Doe', 'Johnson'].),\n  (firstname:text, First name of the student. Value examples: ['John', 'Jane', 'David'].),\n  (program_id:bigint, Identifier for the program the student is enrolled in. Value examples: ['1', '1', '2'].),\n  (declare_major:text, Major program the student declared. Value examples: ['Computer Science', 'Computer Science', 'Mathematics'].),\n  (total_credit:bigint, Total number of credits earned by the student. Value examples: ['13', '7', '7'].),\n  (total_gpa:numeric, Cumulative GPA of the student. Value examples: ['3.5', '3.2', '3.6'].),\n  (entered_as:text, Status of the student when they entered the program. e.g. 'Freshman', 'Transfer Student'. Value examples: ['Freshman', 'Freshman', 'Freshman'].),\n  (admit_term:date, Term in which the student was admitted. Format is YYYY-MM-DD. Value examples: ['2018-01-01', '2018-01-01', '2019-01-01'].),\n  (predicted_graduation_semester:date, Semester in which the student is predicted to graduate. Format is YYYY-MM-DD. Value examples: ['2022-05-01', '2022-05-01', '2022-05-01'].),\n  (degree:text, Degree program the student is enrolled in. Can only be 'Bachelor of Science' or 'Bachelor of Arts'.. Value examples: ['Bachelor of Science', 'Bachelor of Science', 'Bachelor of Arts'].),\n  (minor:text, Minor program the student is enrolled in. Value examples: ['NULL', 'NULL', 'Mathematics'].),\n  (internship:text, Internship program the student is enrolled in. Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: student_record\n[\n  (student_id:bigint, Unique identifier for each student. Value examples: ['1', '1', '1'].),\n  (course_id:bigint, Unique identifier for each course. Value examples: ['1', '2', '3'].),\n  (semester:bigint, The semester ID in which the course was taken. Value examples: ['1', '1', '2'].),\n  (grade:text, The grade received for the course. Value examples: ['A', 'A', 'A'].),\n  (how:text, How the student took the course. Can only be 'in-person' or 'online'.. Value examples: ['in-person', 'in-person', 'in-person'].),\n  (transfer_source:text, If the course was transferred from another institution, the name of that institution. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (earn_credit:text, Whether the student earned credit for the course (e.g. Yes, No). Value examples: ['Yes', 'Yes', 'Yes'].),\n  (repeat_term:text, If the student repeated the course, the semester in which it was repeated. Value examples: ['NULL', 'NULL', 'NULL'].),\n  (test_id:text, Unique identifier for each test taken in the course. Value examples: ['1', '1', '1'].),\n  (offering_id:bigint, Unique identifier for each offering of a course. Value examples: ['1', '2', '3'].),\n]\n\n【Foreign keys】\narea.course_id = course.course_id\ncomment_instructor.instructor_id = instructor.instructor_id\ncomment_instructor.student_id = student.student_id\ncourse.course_id = course_offering.course_id\ncourse.course_id = course_prerequisite.course_id\ncourse.course_id = course_tags_count.course_id\ncourse.course_id = program_course.course_id\ncourse.course_id = student_record.course_id\ncourse_offering.offering_id = offering_instructor.offering_id\ncourse_offering.offering_id = student_record.offering_id\ninstructor.instructor_id = offering_instructor.instructor_id\nprogram.program_id = program_course.program_id\nprogram.program_id = program_requirement.program_id\nprogram.program_id = student.program_id\nstudent.student_id = student_record.student_id\n\n【参考信息】\nAlways filter strings with an exact match.\nWhen asked for specific students or courses, do not return duplicates.\n\n【用户问题】\nReturn the student IDs who have taken an in-person course and have gotten a grade of A or C.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT DISTINCT student_id FROM student_record WHERE student_record.how = 'in-person' AND student_record.grade IN ('A', 'C');",
        "role": "assistant"
      }
    ],
    "db_name": "advising",
    "id": 59,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich flight has the shortest duration between departure and arrival times? Convert to minutes.\n\n【数据库schema】\n【DB_ID】 atis\n【Schema】\n# Table: aircraft\n[\n  (aircraft_code:text, The code assigned to the aircraft by the International Air Transport Association (IATA).. Value examples: ['B747', 'A320'].),\n  (aircraft_description:text, A short description of the aircraft.. Value examples: ['The Boeing 747 is a wide-body airliner.', 'The Airbus A320 is a narrow-body airliner.'].),\n  (manufacturer:text, The name of the manufacturer of the aircraft.. Value examples: ['Boeing', 'Airbus'].),\n  (basic_type:text, The basic type of the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (engines:bigint, The number of engines the aircraft has.. Value examples: ['4', '2'].),\n  (propulsion:text, The type of propulsion used by the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (wide_body:text, Indicates whether the aircraft is a wide body or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'No'].),\n  (wing_span:bigint, The distance between the tips of the aircraft's wings in feet.. Value examples: ['224', '111'].),\n  (length:bigint, The length of the aircraft in feet.. Value examples: ['231', '123'].),\n  (weight:bigint, The weight of the aircraft in pounds.. Value examples: ['987000', '162000'].),\n  (capacity:bigint, The maximum number of passengers the aircraft can carry.. Value examples: ['416', '240'].),\n  (pay_load:bigint, The maximum weight of cargo the aircraft can carry.. Value examples: ['60000', '30000'].),\n  (cruising_speed:bigint, The speed at which the aircraft cruises in miles per hour.. Value examples: ['570', '511'].),\n  (range_miles:bigint, The maximum distance the aircraft can fly in miles.. Value examples: ['8555', '3300'].),\n  (pressurized:text, Indicates whether the aircraft is pressurized or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'Yes'].),\n]\n# Table: airline\n[\n  (airline_code:text, The code assigned to the airline. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (airline_name:text, The name of the airline. Value examples: ['American Airlines', 'United Airlines', 'Delta Air Lines', 'Southwest Airlines'].),\n  (note:text, Any additional notes or comments about the airline. Value examples: ['NULL', 'NULL', 'NULL', 'NULL'].),\n]\n# Table: airport\n[\n  (airport_code:text, The code assigned to the airport.. Value examples: ['JFK', 'LAX', 'ORD', 'DFW'].),\n  (airport_name:text, The name of the airport.. Value examples: ['John F. Kennedy International Airport', 'Los Angeles International Airport', 'O’Hare International Airport', 'Dallas/Fort Worth International Airport'].),\n  (airport_location:text, The location of the airport, eg 'Las Vegas', 'Chicago'. Value examples: ['New York City', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The code assigned to the state where the airport is located.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the airport is located.. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the airport is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n  (minimum_connect_time:bigint, The minimum amount of time required for a connecting flight at the airport.. Value examples: ['23', '20', '24', '40'].),\n]\n# Table: airport_service\n[\n  (city_code:text, The code of the city where the airport is located. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The code of the airport. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (miles_distant:bigint, The distance of the airport from the city in miles. Value examples: ['10', '20', '30', '40'].),\n  (direction:text, The direction of the airport from the city. Either 'North', 'South', 'East', 'West', 'Northeast', 'Northwest', 'Southeast', or 'Southwest'.. Value examples: ['North', 'South', 'East', 'West'].),\n  (minutes_distant:bigint, The distance of the airport from the city in minutes. Value examples: ['20', '40', '60', '80'].),\n]\n# Table: city\n[\n  (city_code:text, The code assigned to the city. Value examples: ['NYC', 'LA', 'CHI', 'DA'].),\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The 2-letter code assigned to the state where the city is located. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the city is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n]\n# Table: class_of_service\n[\n  (booking_class:text, The booking class code for the class of service. Value examples: ['First', 'Business', 'Economy'].),\n  (rank:bigint, The rank of the class of service. Value examples: ['1', '2', '3'].),\n  (class_description:text, A brief description of the class of service. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: code_description\n[\n  (code:text, The code column contains a unique identifier for each record in the table.. Value examples: ['ABC', 'DEF'].),\n  (description:text, The description column contains a textual description of the code.. Value examples: ['Code ABC', 'Code DEF'].),\n]\n# Table: compartment_class\n[\n  (compartment:text, The compartment column contains the name of a compartment. Either 'First', 'Business', or 'Economy'.. Value examples: ['First', 'Business', 'Economy'].),\n  (class_type:text, The class_type column contains the type of a class. Either 'First Class', 'Business Class', or 'Economy Class'.. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: days\n[\n  (days_code:text, A code representing a day of the week. Value examples: ['1', '2'].),\n  (day_name:text, The name of a day of the week. Either 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', or 'Sunday'.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: dual_carrier\n[\n  (main_airline:text, The name of the main airline operating the flight. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (low_flight_number:bigint, The lowest flight number in the range of flights operated by the dual carrier. Value examples: ['1', '11', '21', '31'].),\n  (high_flight_number:bigint, The highest flight number in the range of flights operated by the dual carrier. Value examples: ['10', '20', '30', '40'].),\n  (dual_airline:text, The name of the dual airline operating the flight. Value examples: ['VX', 'DL', 'UA', 'AS'].),\n  (service_name:text, The name of the service provided by the dual carrier on the flight. Value examples: ['Dual Service 1', 'Dual Service 2', 'Dual Service 3', 'Dual Service 4'].),\n]\n# Table: equipment_sequence\n[\n  (aircraft_code_sequence:text, Sequence number for each aircraft code. Value examples: ['1', '2', '3', '4'].),\n  (aircraft_code:text, Code for each aircraft. Value examples: ['B747', 'A320', 'B737', 'A380'].),\n]\n# Table: fare\n[\n  (fare_id:bigint, The unique identifier for this fare. Value examples: ['1', '2'].),\n  (from_airport:text, The 3-letter airport code for the departure location. Value examples: ['ORD', 'ORD'].),\n  (to_airport:text, The 3-letter airport code for the arrival location. Value examples: ['JFK', 'JFK'].),\n  (fare_basis_code:text, The code used to determine the fare's pricing rules. Value examples: ['ABC', 'DEF'].),\n  (fare_airline:text, The airline code associated with this fare. Value examples: ['AA', 'UA'].),\n  (restriction_code:text, Any restrictions or limitations associated with this fare. Value examples: ['NONE', 'NONE'].),\n  (one_direction_cost:bigint, The cost of a one-way trip for this fare. Value examples: ['200', '150'].),\n  (round_trip_cost:bigint, The cost of a round-trip for this fare. Value examples: ['300', '280'].),\n  (round_trip_required:text, Indicates whether a round-trip is required to purchase this fare. Either Yes or No.. Value examples: ['Yes', 'No'].),\n]\n# Table: fare_basis\n[\n  (fare_basis_code:text, The code that identifies the fare basis. Value examples: ['ABC', 'DEF', 'GHI', 'JKL'].),\n  (booking_class:text, The booking class associated with the fare basis. Either 'First', 'Business', or 'Economy'. Value examples: ['First', 'Business', 'Economy', 'First'].),\n  (class_type:text, The class type associated with the fare basis. Either 'First Class', 'Business Class', or 'Economy Class'. Value examples: ['First Class', 'Business Class', 'Economy Class', 'First Class'].),\n  (premium:text, Indicates whether the fare basis is for a premium class. Value examples: ['Yes', 'Yes', 'No', 'Yes'].),\n  (economy:text, Indicates whether the fare basis is for an economy class. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (discounted:text, Indicates whether the fare basis is for a discounted fare. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (night:text, Indicates whether the fare basis is for a night fare. Value examples: ['No', 'No', 'No', 'No'].),\n  (season:text, The season associated with the fare basis. Can only be 'Peak' or 'Regular'. Value examples: ['Regular', 'Regular', 'Regular', 'Regular'].),\n  (basis_days:text, The number of days the fare basis is valid for. Value examples: ['30', '30', '30', '30'].),\n]\n# Table: flight\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['3', '4', '5', '7'].),\n  (flight_days:text, Days of the week the flight operates on. Formatted as comma-delimited 3-letter abbreviations, e.g. `mon,tue,wed` or `tues,thurs`. Value examples: ['wed', 'thu', 'fri', 'sun'].),\n  (from_airport:text, Code assigned to the departure airport. Value examples: ['ORD', 'ORD', 'ORD', 'JFK'].),\n  (to_airport:text, Code assigned to the arrival airport. Value examples: ['JFK', 'JFK', 'LAX', 'ORD'].),\n  (departure_time:bigint, Epoch timestamp for departure time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577858400', '1577865600', '1577880000'].),\n  (arrival_time:bigint, Epoch timestamp for arrival time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577854900', '1577873400', '1577869600', '1577883700'].),\n  (airline_flight:text, Code assigned to the airline flight. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (airline_code:text, Code assigned to the airline. Value examples: ['AA', 'WN', 'AS', 'UA'].),\n  (flight_number:text, Flight number assigned by the airline. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (aircraft_code_sequence:text, Code assigned to the aircraft. Value examples: ['3', '4', '5', '7'].),\n  (meal_code:text, Code assigned to the meal provided during the flight. Value examples: ['DN', 'BS', 'BF', 'DN'].),\n  (stops:bigint, Number of stops during the flight. Value examples: ['0', '1', '0', '0'].),\n  (connections:bigint, Number of connections during the flight. Value examples: ['0', '1', '0', '0'].),\n  (dual_carrier:text, Code assigned to the dual carrier. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (time_elapsed:bigint, Total time elapsed during the flight in seconds. Value examples: ['3700', '15000', '4000', '3700'].),\n]\n# Table: flight_fare\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3', '4'].),\n  (fare_id:bigint, Unique identifier for each fare. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: flight_leg\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3'].),\n  (leg_number:bigint, The sequence number of the leg within the flight. Value examples: ['1', '1', '1'].),\n  (leg_flight:bigint, The flight ID of the leg's corresponding flight. Value examples: ['1', '2', '3'].),\n]\n# Table: flight_stop\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['2', '4'].),\n  (stop_number:bigint, The order of the stop in the flight. Value examples: ['1', '1'].),\n  (stop_days:text, Days of the week on which the flight stops at this airport. Value examples: ['2', '4'].),\n  (stop_airport:text, The 3-letter airport code of the stop. Value examples: ['DFW', 'DEN'].),\n  (arrival_time:bigint, The time at which the flight arrives at this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577847600', '1577862000'].),\n  (arrival_airline:text, The airline code of the arriving flight. Value examples: ['UA', 'WN'].),\n  (arrival_flight_number:text, Flight number of the arriving flight at this stop. Value examples: ['UA456', 'WN012'].),\n  (departure_time:bigint, The time at which the flight departs from this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577865600'].),\n  (departure_airline:text, The airline code of the departing flight. Value examples: ['UA', 'WN'].),\n  (departure_flight_number:text, Flight number of the departing flight from this stop. Value examples: ['UA456', 'WN012'].),\n  (stop_time:bigint, The duration of the stop at this airport. Value examples: ['3600', '3600'].),\n]\n# Table: food_service\n[\n  (meal_code:text, Code assigned to each meal type. Value examples: ['BF', 'LN'].),\n  (meal_number:bigint, Unique identifier for each meal served. Value examples: ['1', '2'].),\n  (compartment:text, The compartment in which the meal is served (e.g. 'First Class', 'Economy'). Value examples: ['First Class', 'First Class'].),\n  (meal_description:text, One of 'Breakfast', 'Lunch', 'Dinner'. Value examples: ['Breakfast', 'Lunch'].),\n]\n# Table: ground_service\n[\n  (city_code:text, The code for the city where the ground service is provided. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The 3-letter code for the airport where the ground service is provided. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (transport_type:text, The type of ground transportation provided. Value examples: ['Taxi', 'Shuttle', 'Bus', 'Car Rental'].),\n  (ground_fare:bigint, The fare charged for ground transportation. Value examples: ['50', '40', '30', '60'].),\n]\n# Table: month\n[\n  (month_number:bigint, A unique number assigned to each month of the year.. Value examples: ['1', '2', '3', '4'].),\n  (month_name:text, The name of the month, e.g. January, February, etc.. Value examples: ['January', 'February', 'March', 'April'].),\n]\n# Table: restriction\n[\n  (restriction_code:text, A code representing the type of restriction, such as blackout dates or minimum stay.. Value examples: ['NONE', 'NONE', 'NONE', 'NONE'].),\n  (advance_purchase:bigint, The number of days in advance the fare must be purchased.. Value examples: ['14', '14', '14', '14'].),\n  (stopovers:text, The number of stopovers allowed for the fare.. Value examples: ['2', '2', '2', '2'].),\n  (saturday_stay_required:text, Indicates whether a Saturday night stay is required for the fare. Either 'Yes' or 'No'.. Value examples: ['No', 'No', 'No', 'No'].),\n  (minimum_stay:bigint, The minimum length of stay required for the fare.. Value examples: ['7', '7', '7', '7'].),\n  (maximum_stay:bigint, The maximum length of stay allowed for the fare.. Value examples: ['30', '30', '30', '30'].),\n  (application:text, The type of fare application. Either 'One Way' or 'Round Trip'.. Value examples: ['One-Way', 'One-Way', 'One-Way', 'One-Way'].),\n  (no_discounts:text, Indicates whether the fare is eligible for discounts or promotions. Either 'Yes' or 'No'.. Value examples: ['Yes', 'Yes', 'Yes', 'Yes'].),\n]\n# Table: state\n[\n  (state_code:text, The 2-letter code assigned to the state. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA'].),\n  (state_name:text, The name of the state. Value examples: ['New York', 'California'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States'].),\n]\n# Table: time_interval\n[\n  (period:text, The period of the time interval, represented as a string. For example, 'daily', 'weekly', 'monthly', etc.. Value examples: ['daily', 'daily', 'daily'].),\n  (begin_time:bigint, The beginning time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577836800', '1577844000', '1577851200'].),\n  (end_time:bigint, The end time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577840400', '1577847600', '1577854800'].),\n]\n# Table: time_zone\n[\n  (time_zone_code:text, A short code that represents the time zone. For example, 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['PST', 'MST'].),\n  (time_zone_name:text, The name of the time zone. Value examples: ['Pacific Standard Time', 'Mountain Standard Time'].),\n  (hours_from_gmt:bigint, The number of hours that the time zone is ahead or behind Greenwich Mean Time (GMT). Value examples: ['-8', '-7'].),\n]\n\n【Foreign keys】\nairline.airline_code = flight.airline_code\nairline.airline_code = flight_stop.departure_airline\nairport.airport_code = fare.from_airport\nairport.airport_code = flight_stop.stop_airport\nairport_service.city_code = ground_service.city_code\nairport.state_code = city.state_code\nairport.state_code = state.state_code\ncity.state_code = state.state_code\nairport_service.city_code = city.city_code\nground_service.city_code = city.city_code\nairport.time_zone_code = time_zone.time_zone_code\ncity.time_zone_code = time_zone.time_zone_code\nflight.flight_id = flight_fare.flight_id\nflight.flight_id = flight_leg.flight_id\nflight.flight_id = flight_stop.flight_id\nflight_fare.flight_id = flight_leg.flight_id\nflight_fare.flight_id = flight_stop.flight_id\nflight_leg.flight_id = flight_stop.flight_id\naircraft.aircraft_code = equipment_sequence.aircraft_code\nflight.aircraft_code_sequence = equipment_sequence.aircraft_code_sequence\nflight.meal_code = food_service.meal_code\n\n【参考信息】\n\n\n【用户问题】\nWhich flight has the shortest duration between departure and arrival times? Convert to minutes.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT flight.flight_number, flight.flight_id, (arrival_time - departure_time) / 60 AS duration_minutes FROM flight ORDER BY duration_minutes LIMIT 1",
        "role": "assistant"
      }
    ],
    "db_name": "atis",
    "id": 60,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat's the average duration between departure and arrival times minus 34 minutes? Convert from UNIX to regular datetime, and return the answer in minutes\n\n【数据库schema】\n【DB_ID】 atis\n【Schema】\n# Table: aircraft\n[\n  (aircraft_code:text, The code assigned to the aircraft by the International Air Transport Association (IATA).. Value examples: ['B747', 'A320'].),\n  (aircraft_description:text, A short description of the aircraft.. Value examples: ['The Boeing 747 is a wide-body airliner.', 'The Airbus A320 is a narrow-body airliner.'].),\n  (manufacturer:text, The name of the manufacturer of the aircraft.. Value examples: ['Boeing', 'Airbus'].),\n  (basic_type:text, The basic type of the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (engines:bigint, The number of engines the aircraft has.. Value examples: ['4', '2'].),\n  (propulsion:text, The type of propulsion used by the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (wide_body:text, Indicates whether the aircraft is a wide body or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'No'].),\n  (wing_span:bigint, The distance between the tips of the aircraft's wings in feet.. Value examples: ['224', '111'].),\n  (length:bigint, The length of the aircraft in feet.. Value examples: ['231', '123'].),\n  (weight:bigint, The weight of the aircraft in pounds.. Value examples: ['987000', '162000'].),\n  (capacity:bigint, The maximum number of passengers the aircraft can carry.. Value examples: ['416', '240'].),\n  (pay_load:bigint, The maximum weight of cargo the aircraft can carry.. Value examples: ['60000', '30000'].),\n  (cruising_speed:bigint, The speed at which the aircraft cruises in miles per hour.. Value examples: ['570', '511'].),\n  (range_miles:bigint, The maximum distance the aircraft can fly in miles.. Value examples: ['8555', '3300'].),\n  (pressurized:text, Indicates whether the aircraft is pressurized or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'Yes'].),\n]\n# Table: airline\n[\n  (airline_code:text, The code assigned to the airline. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (airline_name:text, The name of the airline. Value examples: ['American Airlines', 'United Airlines', 'Delta Air Lines', 'Southwest Airlines'].),\n  (note:text, Any additional notes or comments about the airline. Value examples: ['NULL', 'NULL', 'NULL', 'NULL'].),\n]\n# Table: airport\n[\n  (airport_code:text, The code assigned to the airport.. Value examples: ['JFK', 'LAX', 'ORD', 'DFW'].),\n  (airport_name:text, The name of the airport.. Value examples: ['John F. Kennedy International Airport', 'Los Angeles International Airport', 'O’Hare International Airport', 'Dallas/Fort Worth International Airport'].),\n  (airport_location:text, The location of the airport, eg 'Las Vegas', 'Chicago'. Value examples: ['New York City', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The code assigned to the state where the airport is located.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the airport is located.. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the airport is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n  (minimum_connect_time:bigint, The minimum amount of time required for a connecting flight at the airport.. Value examples: ['23', '20', '24', '40'].),\n]\n# Table: airport_service\n[\n  (city_code:text, The code of the city where the airport is located. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The code of the airport. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (miles_distant:bigint, The distance of the airport from the city in miles. Value examples: ['10', '20', '30', '40'].),\n  (direction:text, The direction of the airport from the city. Either 'North', 'South', 'East', 'West', 'Northeast', 'Northwest', 'Southeast', or 'Southwest'.. Value examples: ['North', 'South', 'East', 'West'].),\n  (minutes_distant:bigint, The distance of the airport from the city in minutes. Value examples: ['20', '40', '60', '80'].),\n]\n# Table: city\n[\n  (city_code:text, The code assigned to the city. Value examples: ['NYC', 'LA', 'CHI', 'DA'].),\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The 2-letter code assigned to the state where the city is located. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the city is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n]\n# Table: class_of_service\n[\n  (booking_class:text, The booking class code for the class of service. Value examples: ['First', 'Business', 'Economy'].),\n  (rank:bigint, The rank of the class of service. Value examples: ['1', '2', '3'].),\n  (class_description:text, A brief description of the class of service. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: code_description\n[\n  (code:text, The code column contains a unique identifier for each record in the table.. Value examples: ['ABC', 'DEF'].),\n  (description:text, The description column contains a textual description of the code.. Value examples: ['Code ABC', 'Code DEF'].),\n]\n# Table: compartment_class\n[\n  (compartment:text, The compartment column contains the name of a compartment. Either 'First', 'Business', or 'Economy'.. Value examples: ['First', 'Business', 'Economy'].),\n  (class_type:text, The class_type column contains the type of a class. Either 'First Class', 'Business Class', or 'Economy Class'.. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: days\n[\n  (days_code:text, A code representing a day of the week. Value examples: ['1', '2'].),\n  (day_name:text, The name of a day of the week. Either 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', or 'Sunday'.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: dual_carrier\n[\n  (main_airline:text, The name of the main airline operating the flight. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (low_flight_number:bigint, The lowest flight number in the range of flights operated by the dual carrier. Value examples: ['1', '11', '21', '31'].),\n  (high_flight_number:bigint, The highest flight number in the range of flights operated by the dual carrier. Value examples: ['10', '20', '30', '40'].),\n  (dual_airline:text, The name of the dual airline operating the flight. Value examples: ['VX', 'DL', 'UA', 'AS'].),\n  (service_name:text, The name of the service provided by the dual carrier on the flight. Value examples: ['Dual Service 1', 'Dual Service 2', 'Dual Service 3', 'Dual Service 4'].),\n]\n# Table: equipment_sequence\n[\n  (aircraft_code_sequence:text, Sequence number for each aircraft code. Value examples: ['1', '2', '3', '4'].),\n  (aircraft_code:text, Code for each aircraft. Value examples: ['B747', 'A320', 'B737', 'A380'].),\n]\n# Table: fare\n[\n  (fare_id:bigint, The unique identifier for this fare. Value examples: ['1', '2'].),\n  (from_airport:text, The 3-letter airport code for the departure location. Value examples: ['ORD', 'ORD'].),\n  (to_airport:text, The 3-letter airport code for the arrival location. Value examples: ['JFK', 'JFK'].),\n  (fare_basis_code:text, The code used to determine the fare's pricing rules. Value examples: ['ABC', 'DEF'].),\n  (fare_airline:text, The airline code associated with this fare. Value examples: ['AA', 'UA'].),\n  (restriction_code:text, Any restrictions or limitations associated with this fare. Value examples: ['NONE', 'NONE'].),\n  (one_direction_cost:bigint, The cost of a one-way trip for this fare. Value examples: ['200', '150'].),\n  (round_trip_cost:bigint, The cost of a round-trip for this fare. Value examples: ['300', '280'].),\n  (round_trip_required:text, Indicates whether a round-trip is required to purchase this fare. Either Yes or No.. Value examples: ['Yes', 'No'].),\n]\n# Table: fare_basis\n[\n  (fare_basis_code:text, The code that identifies the fare basis. Value examples: ['ABC', 'DEF', 'GHI', 'JKL'].),\n  (booking_class:text, The booking class associated with the fare basis. Either 'First', 'Business', or 'Economy'. Value examples: ['First', 'Business', 'Economy', 'First'].),\n  (class_type:text, The class type associated with the fare basis. Either 'First Class', 'Business Class', or 'Economy Class'. Value examples: ['First Class', 'Business Class', 'Economy Class', 'First Class'].),\n  (premium:text, Indicates whether the fare basis is for a premium class. Value examples: ['Yes', 'Yes', 'No', 'Yes'].),\n  (economy:text, Indicates whether the fare basis is for an economy class. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (discounted:text, Indicates whether the fare basis is for a discounted fare. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (night:text, Indicates whether the fare basis is for a night fare. Value examples: ['No', 'No', 'No', 'No'].),\n  (season:text, The season associated with the fare basis. Can only be 'Peak' or 'Regular'. Value examples: ['Regular', 'Regular', 'Regular', 'Regular'].),\n  (basis_days:text, The number of days the fare basis is valid for. Value examples: ['30', '30', '30', '30'].),\n]\n# Table: flight\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['3', '4', '5', '7'].),\n  (flight_days:text, Days of the week the flight operates on. Formatted as comma-delimited 3-letter abbreviations, e.g. `mon,tue,wed` or `tues,thurs`. Value examples: ['wed', 'thu', 'fri', 'sun'].),\n  (from_airport:text, Code assigned to the departure airport. Value examples: ['ORD', 'ORD', 'ORD', 'JFK'].),\n  (to_airport:text, Code assigned to the arrival airport. Value examples: ['JFK', 'JFK', 'LAX', 'ORD'].),\n  (departure_time:bigint, Epoch timestamp for departure time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577858400', '1577865600', '1577880000'].),\n  (arrival_time:bigint, Epoch timestamp for arrival time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577854900', '1577873400', '1577869600', '1577883700'].),\n  (airline_flight:text, Code assigned to the airline flight. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (airline_code:text, Code assigned to the airline. Value examples: ['AA', 'WN', 'AS', 'UA'].),\n  (flight_number:text, Flight number assigned by the airline. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (aircraft_code_sequence:text, Code assigned to the aircraft. Value examples: ['3', '4', '5', '7'].),\n  (meal_code:text, Code assigned to the meal provided during the flight. Value examples: ['DN', 'BS', 'BF', 'DN'].),\n  (stops:bigint, Number of stops during the flight. Value examples: ['0', '1', '0', '0'].),\n  (connections:bigint, Number of connections during the flight. Value examples: ['0', '1', '0', '0'].),\n  (dual_carrier:text, Code assigned to the dual carrier. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (time_elapsed:bigint, Total time elapsed during the flight in seconds. Value examples: ['3700', '15000', '4000', '3700'].),\n]\n# Table: flight_fare\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3', '4'].),\n  (fare_id:bigint, Unique identifier for each fare. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: flight_leg\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3'].),\n  (leg_number:bigint, The sequence number of the leg within the flight. Value examples: ['1', '1', '1'].),\n  (leg_flight:bigint, The flight ID of the leg's corresponding flight. Value examples: ['1', '2', '3'].),\n]\n# Table: flight_stop\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['2', '4'].),\n  (stop_number:bigint, The order of the stop in the flight. Value examples: ['1', '1'].),\n  (stop_days:text, Days of the week on which the flight stops at this airport. Value examples: ['2', '4'].),\n  (stop_airport:text, The 3-letter airport code of the stop. Value examples: ['DFW', 'DEN'].),\n  (arrival_time:bigint, The time at which the flight arrives at this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577847600', '1577862000'].),\n  (arrival_airline:text, The airline code of the arriving flight. Value examples: ['UA', 'WN'].),\n  (arrival_flight_number:text, Flight number of the arriving flight at this stop. Value examples: ['UA456', 'WN012'].),\n  (departure_time:bigint, The time at which the flight departs from this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577865600'].),\n  (departure_airline:text, The airline code of the departing flight. Value examples: ['UA', 'WN'].),\n  (departure_flight_number:text, Flight number of the departing flight from this stop. Value examples: ['UA456', 'WN012'].),\n  (stop_time:bigint, The duration of the stop at this airport. Value examples: ['3600', '3600'].),\n]\n# Table: food_service\n[\n  (meal_code:text, Code assigned to each meal type. Value examples: ['BF', 'LN'].),\n  (meal_number:bigint, Unique identifier for each meal served. Value examples: ['1', '2'].),\n  (compartment:text, The compartment in which the meal is served (e.g. 'First Class', 'Economy'). Value examples: ['First Class', 'First Class'].),\n  (meal_description:text, One of 'Breakfast', 'Lunch', 'Dinner'. Value examples: ['Breakfast', 'Lunch'].),\n]\n# Table: ground_service\n[\n  (city_code:text, The code for the city where the ground service is provided. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The 3-letter code for the airport where the ground service is provided. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (transport_type:text, The type of ground transportation provided. Value examples: ['Taxi', 'Shuttle', 'Bus', 'Car Rental'].),\n  (ground_fare:bigint, The fare charged for ground transportation. Value examples: ['50', '40', '30', '60'].),\n]\n# Table: month\n[\n  (month_number:bigint, A unique number assigned to each month of the year.. Value examples: ['1', '2', '3', '4'].),\n  (month_name:text, The name of the month, e.g. January, February, etc.. Value examples: ['January', 'February', 'March', 'April'].),\n]\n# Table: restriction\n[\n  (restriction_code:text, A code representing the type of restriction, such as blackout dates or minimum stay.. Value examples: ['NONE', 'NONE', 'NONE', 'NONE'].),\n  (advance_purchase:bigint, The number of days in advance the fare must be purchased.. Value examples: ['14', '14', '14', '14'].),\n  (stopovers:text, The number of stopovers allowed for the fare.. Value examples: ['2', '2', '2', '2'].),\n  (saturday_stay_required:text, Indicates whether a Saturday night stay is required for the fare. Either 'Yes' or 'No'.. Value examples: ['No', 'No', 'No', 'No'].),\n  (minimum_stay:bigint, The minimum length of stay required for the fare.. Value examples: ['7', '7', '7', '7'].),\n  (maximum_stay:bigint, The maximum length of stay allowed for the fare.. Value examples: ['30', '30', '30', '30'].),\n  (application:text, The type of fare application. Either 'One Way' or 'Round Trip'.. Value examples: ['One-Way', 'One-Way', 'One-Way', 'One-Way'].),\n  (no_discounts:text, Indicates whether the fare is eligible for discounts or promotions. Either 'Yes' or 'No'.. Value examples: ['Yes', 'Yes', 'Yes', 'Yes'].),\n]\n# Table: state\n[\n  (state_code:text, The 2-letter code assigned to the state. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA'].),\n  (state_name:text, The name of the state. Value examples: ['New York', 'California'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States'].),\n]\n# Table: time_interval\n[\n  (period:text, The period of the time interval, represented as a string. For example, 'daily', 'weekly', 'monthly', etc.. Value examples: ['daily', 'daily', 'daily'].),\n  (begin_time:bigint, The beginning time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577836800', '1577844000', '1577851200'].),\n  (end_time:bigint, The end time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577840400', '1577847600', '1577854800'].),\n]\n# Table: time_zone\n[\n  (time_zone_code:text, A short code that represents the time zone. For example, 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['PST', 'MST'].),\n  (time_zone_name:text, The name of the time zone. Value examples: ['Pacific Standard Time', 'Mountain Standard Time'].),\n  (hours_from_gmt:bigint, The number of hours that the time zone is ahead or behind Greenwich Mean Time (GMT). Value examples: ['-8', '-7'].),\n]\n\n【Foreign keys】\nairline.airline_code = flight.airline_code\nairline.airline_code = flight_stop.departure_airline\nairport.airport_code = fare.from_airport\nairport.airport_code = flight_stop.stop_airport\nairport_service.city_code = ground_service.city_code\nairport.state_code = city.state_code\nairport.state_code = state.state_code\ncity.state_code = state.state_code\nairport_service.city_code = city.city_code\nground_service.city_code = city.city_code\nairport.time_zone_code = time_zone.time_zone_code\ncity.time_zone_code = time_zone.time_zone_code\nflight.flight_id = flight_fare.flight_id\nflight.flight_id = flight_leg.flight_id\nflight.flight_id = flight_stop.flight_id\nflight_fare.flight_id = flight_leg.flight_id\nflight_fare.flight_id = flight_stop.flight_id\nflight_leg.flight_id = flight_stop.flight_id\naircraft.aircraft_code = equipment_sequence.aircraft_code\nflight.aircraft_code_sequence = equipment_sequence.aircraft_code_sequence\nflight.meal_code = food_service.meal_code\n\n【参考信息】\n\n\n【用户问题】\nWhat's the average duration between departure and arrival times minus 34 minutes? Convert from UNIX to regular datetime, and return the answer in minutes\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT avg(to_timestamp(arrival_time) - to_timestamp(departure_time) - interval '34 minutes') AS average_duration FROM flight;SELECT AVG(arrival_time - departure_time)/60 - 34 AS average_duration FROM flight;",
        "role": "assistant"
      }
    ],
    "db_name": "atis",
    "id": 61,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nCount the number of flight departures for each month?\n\n【数据库schema】\n【DB_ID】 atis\n【Schema】\n# Table: aircraft\n[\n  (aircraft_code:text, The code assigned to the aircraft by the International Air Transport Association (IATA).. Value examples: ['B747', 'A320'].),\n  (aircraft_description:text, A short description of the aircraft.. Value examples: ['The Boeing 747 is a wide-body airliner.', 'The Airbus A320 is a narrow-body airliner.'].),\n  (manufacturer:text, The name of the manufacturer of the aircraft.. Value examples: ['Boeing', 'Airbus'].),\n  (basic_type:text, The basic type of the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (engines:bigint, The number of engines the aircraft has.. Value examples: ['4', '2'].),\n  (propulsion:text, The type of propulsion used by the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (wide_body:text, Indicates whether the aircraft is a wide body or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'No'].),\n  (wing_span:bigint, The distance between the tips of the aircraft's wings in feet.. Value examples: ['224', '111'].),\n  (length:bigint, The length of the aircraft in feet.. Value examples: ['231', '123'].),\n  (weight:bigint, The weight of the aircraft in pounds.. Value examples: ['987000', '162000'].),\n  (capacity:bigint, The maximum number of passengers the aircraft can carry.. Value examples: ['416', '240'].),\n  (pay_load:bigint, The maximum weight of cargo the aircraft can carry.. Value examples: ['60000', '30000'].),\n  (cruising_speed:bigint, The speed at which the aircraft cruises in miles per hour.. Value examples: ['570', '511'].),\n  (range_miles:bigint, The maximum distance the aircraft can fly in miles.. Value examples: ['8555', '3300'].),\n  (pressurized:text, Indicates whether the aircraft is pressurized or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'Yes'].),\n]\n# Table: airline\n[\n  (airline_code:text, The code assigned to the airline. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (airline_name:text, The name of the airline. Value examples: ['American Airlines', 'United Airlines', 'Delta Air Lines', 'Southwest Airlines'].),\n  (note:text, Any additional notes or comments about the airline. Value examples: ['NULL', 'NULL', 'NULL', 'NULL'].),\n]\n# Table: airport\n[\n  (airport_code:text, The code assigned to the airport.. Value examples: ['JFK', 'LAX', 'ORD', 'DFW'].),\n  (airport_name:text, The name of the airport.. Value examples: ['John F. Kennedy International Airport', 'Los Angeles International Airport', 'O’Hare International Airport', 'Dallas/Fort Worth International Airport'].),\n  (airport_location:text, The location of the airport, eg 'Las Vegas', 'Chicago'. Value examples: ['New York City', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The code assigned to the state where the airport is located.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the airport is located.. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the airport is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n  (minimum_connect_time:bigint, The minimum amount of time required for a connecting flight at the airport.. Value examples: ['23', '20', '24', '40'].),\n]\n# Table: airport_service\n[\n  (city_code:text, The code of the city where the airport is located. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The code of the airport. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (miles_distant:bigint, The distance of the airport from the city in miles. Value examples: ['10', '20', '30', '40'].),\n  (direction:text, The direction of the airport from the city. Either 'North', 'South', 'East', 'West', 'Northeast', 'Northwest', 'Southeast', or 'Southwest'.. Value examples: ['North', 'South', 'East', 'West'].),\n  (minutes_distant:bigint, The distance of the airport from the city in minutes. Value examples: ['20', '40', '60', '80'].),\n]\n# Table: city\n[\n  (city_code:text, The code assigned to the city. Value examples: ['NYC', 'LA', 'CHI', 'DA'].),\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The 2-letter code assigned to the state where the city is located. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the city is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n]\n# Table: class_of_service\n[\n  (booking_class:text, The booking class code for the class of service. Value examples: ['First', 'Business', 'Economy'].),\n  (rank:bigint, The rank of the class of service. Value examples: ['1', '2', '3'].),\n  (class_description:text, A brief description of the class of service. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: code_description\n[\n  (code:text, The code column contains a unique identifier for each record in the table.. Value examples: ['ABC', 'DEF'].),\n  (description:text, The description column contains a textual description of the code.. Value examples: ['Code ABC', 'Code DEF'].),\n]\n# Table: compartment_class\n[\n  (compartment:text, The compartment column contains the name of a compartment. Either 'First', 'Business', or 'Economy'.. Value examples: ['First', 'Business', 'Economy'].),\n  (class_type:text, The class_type column contains the type of a class. Either 'First Class', 'Business Class', or 'Economy Class'.. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: days\n[\n  (days_code:text, A code representing a day of the week. Value examples: ['1', '2'].),\n  (day_name:text, The name of a day of the week. Either 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', or 'Sunday'.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: dual_carrier\n[\n  (main_airline:text, The name of the main airline operating the flight. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (low_flight_number:bigint, The lowest flight number in the range of flights operated by the dual carrier. Value examples: ['1', '11', '21', '31'].),\n  (high_flight_number:bigint, The highest flight number in the range of flights operated by the dual carrier. Value examples: ['10', '20', '30', '40'].),\n  (dual_airline:text, The name of the dual airline operating the flight. Value examples: ['VX', 'DL', 'UA', 'AS'].),\n  (service_name:text, The name of the service provided by the dual carrier on the flight. Value examples: ['Dual Service 1', 'Dual Service 2', 'Dual Service 3', 'Dual Service 4'].),\n]\n# Table: equipment_sequence\n[\n  (aircraft_code_sequence:text, Sequence number for each aircraft code. Value examples: ['1', '2', '3', '4'].),\n  (aircraft_code:text, Code for each aircraft. Value examples: ['B747', 'A320', 'B737', 'A380'].),\n]\n# Table: fare\n[\n  (fare_id:bigint, The unique identifier for this fare. Value examples: ['1', '2'].),\n  (from_airport:text, The 3-letter airport code for the departure location. Value examples: ['ORD', 'ORD'].),\n  (to_airport:text, The 3-letter airport code for the arrival location. Value examples: ['JFK', 'JFK'].),\n  (fare_basis_code:text, The code used to determine the fare's pricing rules. Value examples: ['ABC', 'DEF'].),\n  (fare_airline:text, The airline code associated with this fare. Value examples: ['AA', 'UA'].),\n  (restriction_code:text, Any restrictions or limitations associated with this fare. Value examples: ['NONE', 'NONE'].),\n  (one_direction_cost:bigint, The cost of a one-way trip for this fare. Value examples: ['200', '150'].),\n  (round_trip_cost:bigint, The cost of a round-trip for this fare. Value examples: ['300', '280'].),\n  (round_trip_required:text, Indicates whether a round-trip is required to purchase this fare. Either Yes or No.. Value examples: ['Yes', 'No'].),\n]\n# Table: fare_basis\n[\n  (fare_basis_code:text, The code that identifies the fare basis. Value examples: ['ABC', 'DEF', 'GHI', 'JKL'].),\n  (booking_class:text, The booking class associated with the fare basis. Either 'First', 'Business', or 'Economy'. Value examples: ['First', 'Business', 'Economy', 'First'].),\n  (class_type:text, The class type associated with the fare basis. Either 'First Class', 'Business Class', or 'Economy Class'. Value examples: ['First Class', 'Business Class', 'Economy Class', 'First Class'].),\n  (premium:text, Indicates whether the fare basis is for a premium class. Value examples: ['Yes', 'Yes', 'No', 'Yes'].),\n  (economy:text, Indicates whether the fare basis is for an economy class. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (discounted:text, Indicates whether the fare basis is for a discounted fare. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (night:text, Indicates whether the fare basis is for a night fare. Value examples: ['No', 'No', 'No', 'No'].),\n  (season:text, The season associated with the fare basis. Can only be 'Peak' or 'Regular'. Value examples: ['Regular', 'Regular', 'Regular', 'Regular'].),\n  (basis_days:text, The number of days the fare basis is valid for. Value examples: ['30', '30', '30', '30'].),\n]\n# Table: flight\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['3', '4', '5', '7'].),\n  (flight_days:text, Days of the week the flight operates on. Formatted as comma-delimited 3-letter abbreviations, e.g. `mon,tue,wed` or `tues,thurs`. Value examples: ['wed', 'thu', 'fri', 'sun'].),\n  (from_airport:text, Code assigned to the departure airport. Value examples: ['ORD', 'ORD', 'ORD', 'JFK'].),\n  (to_airport:text, Code assigned to the arrival airport. Value examples: ['JFK', 'JFK', 'LAX', 'ORD'].),\n  (departure_time:bigint, Epoch timestamp for departure time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577858400', '1577865600', '1577880000'].),\n  (arrival_time:bigint, Epoch timestamp for arrival time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577854900', '1577873400', '1577869600', '1577883700'].),\n  (airline_flight:text, Code assigned to the airline flight. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (airline_code:text, Code assigned to the airline. Value examples: ['AA', 'WN', 'AS', 'UA'].),\n  (flight_number:text, Flight number assigned by the airline. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (aircraft_code_sequence:text, Code assigned to the aircraft. Value examples: ['3', '4', '5', '7'].),\n  (meal_code:text, Code assigned to the meal provided during the flight. Value examples: ['DN', 'BS', 'BF', 'DN'].),\n  (stops:bigint, Number of stops during the flight. Value examples: ['0', '1', '0', '0'].),\n  (connections:bigint, Number of connections during the flight. Value examples: ['0', '1', '0', '0'].),\n  (dual_carrier:text, Code assigned to the dual carrier. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (time_elapsed:bigint, Total time elapsed during the flight in seconds. Value examples: ['3700', '15000', '4000', '3700'].),\n]\n# Table: flight_fare\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3', '4'].),\n  (fare_id:bigint, Unique identifier for each fare. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: flight_leg\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3'].),\n  (leg_number:bigint, The sequence number of the leg within the flight. Value examples: ['1', '1', '1'].),\n  (leg_flight:bigint, The flight ID of the leg's corresponding flight. Value examples: ['1', '2', '3'].),\n]\n# Table: flight_stop\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['2', '4'].),\n  (stop_number:bigint, The order of the stop in the flight. Value examples: ['1', '1'].),\n  (stop_days:text, Days of the week on which the flight stops at this airport. Value examples: ['2', '4'].),\n  (stop_airport:text, The 3-letter airport code of the stop. Value examples: ['DFW', 'DEN'].),\n  (arrival_time:bigint, The time at which the flight arrives at this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577847600', '1577862000'].),\n  (arrival_airline:text, The airline code of the arriving flight. Value examples: ['UA', 'WN'].),\n  (arrival_flight_number:text, Flight number of the arriving flight at this stop. Value examples: ['UA456', 'WN012'].),\n  (departure_time:bigint, The time at which the flight departs from this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577865600'].),\n  (departure_airline:text, The airline code of the departing flight. Value examples: ['UA', 'WN'].),\n  (departure_flight_number:text, Flight number of the departing flight from this stop. Value examples: ['UA456', 'WN012'].),\n  (stop_time:bigint, The duration of the stop at this airport. Value examples: ['3600', '3600'].),\n]\n# Table: food_service\n[\n  (meal_code:text, Code assigned to each meal type. Value examples: ['BF', 'LN'].),\n  (meal_number:bigint, Unique identifier for each meal served. Value examples: ['1', '2'].),\n  (compartment:text, The compartment in which the meal is served (e.g. 'First Class', 'Economy'). Value examples: ['First Class', 'First Class'].),\n  (meal_description:text, One of 'Breakfast', 'Lunch', 'Dinner'. Value examples: ['Breakfast', 'Lunch'].),\n]\n# Table: ground_service\n[\n  (city_code:text, The code for the city where the ground service is provided. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The 3-letter code for the airport where the ground service is provided. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (transport_type:text, The type of ground transportation provided. Value examples: ['Taxi', 'Shuttle', 'Bus', 'Car Rental'].),\n  (ground_fare:bigint, The fare charged for ground transportation. Value examples: ['50', '40', '30', '60'].),\n]\n# Table: month\n[\n  (month_number:bigint, A unique number assigned to each month of the year.. Value examples: ['1', '2', '3', '4'].),\n  (month_name:text, The name of the month, e.g. January, February, etc.. Value examples: ['January', 'February', 'March', 'April'].),\n]\n# Table: restriction\n[\n  (restriction_code:text, A code representing the type of restriction, such as blackout dates or minimum stay.. Value examples: ['NONE', 'NONE', 'NONE', 'NONE'].),\n  (advance_purchase:bigint, The number of days in advance the fare must be purchased.. Value examples: ['14', '14', '14', '14'].),\n  (stopovers:text, The number of stopovers allowed for the fare.. Value examples: ['2', '2', '2', '2'].),\n  (saturday_stay_required:text, Indicates whether a Saturday night stay is required for the fare. Either 'Yes' or 'No'.. Value examples: ['No', 'No', 'No', 'No'].),\n  (minimum_stay:bigint, The minimum length of stay required for the fare.. Value examples: ['7', '7', '7', '7'].),\n  (maximum_stay:bigint, The maximum length of stay allowed for the fare.. Value examples: ['30', '30', '30', '30'].),\n  (application:text, The type of fare application. Either 'One Way' or 'Round Trip'.. Value examples: ['One-Way', 'One-Way', 'One-Way', 'One-Way'].),\n  (no_discounts:text, Indicates whether the fare is eligible for discounts or promotions. Either 'Yes' or 'No'.. Value examples: ['Yes', 'Yes', 'Yes', 'Yes'].),\n]\n# Table: state\n[\n  (state_code:text, The 2-letter code assigned to the state. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA'].),\n  (state_name:text, The name of the state. Value examples: ['New York', 'California'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States'].),\n]\n# Table: time_interval\n[\n  (period:text, The period of the time interval, represented as a string. For example, 'daily', 'weekly', 'monthly', etc.. Value examples: ['daily', 'daily', 'daily'].),\n  (begin_time:bigint, The beginning time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577836800', '1577844000', '1577851200'].),\n  (end_time:bigint, The end time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577840400', '1577847600', '1577854800'].),\n]\n# Table: time_zone\n[\n  (time_zone_code:text, A short code that represents the time zone. For example, 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['PST', 'MST'].),\n  (time_zone_name:text, The name of the time zone. Value examples: ['Pacific Standard Time', 'Mountain Standard Time'].),\n  (hours_from_gmt:bigint, The number of hours that the time zone is ahead or behind Greenwich Mean Time (GMT). Value examples: ['-8', '-7'].),\n]\n\n【Foreign keys】\nairline.airline_code = flight.airline_code\nairline.airline_code = flight_stop.departure_airline\nairport.airport_code = fare.from_airport\nairport.airport_code = flight_stop.stop_airport\nairport_service.city_code = ground_service.city_code\nairport.state_code = city.state_code\nairport.state_code = state.state_code\ncity.state_code = state.state_code\nairport_service.city_code = city.city_code\nground_service.city_code = city.city_code\nairport.time_zone_code = time_zone.time_zone_code\ncity.time_zone_code = time_zone.time_zone_code\nflight.flight_id = flight_fare.flight_id\nflight.flight_id = flight_leg.flight_id\nflight.flight_id = flight_stop.flight_id\nflight_fare.flight_id = flight_leg.flight_id\nflight_fare.flight_id = flight_stop.flight_id\nflight_leg.flight_id = flight_stop.flight_id\naircraft.aircraft_code = equipment_sequence.aircraft_code\nflight.aircraft_code_sequence = equipment_sequence.aircraft_code_sequence\nflight.meal_code = food_service.meal_code\n\n【参考信息】\n\n\n【用户问题】\nCount the number of flight departures for each month?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT month.month_name, count(*) AS departure_count FROM flight JOIN month ON extract(MONTH FROM to_timestamp(flight.departure_time)) = month.month_number GROUP BY month.month_name, month.month_number ORDER BY month.month_number;SELECT date_trunc('month', to_timestamp(flight.departure_time)) AS month, COUNT(*) AS num_departures FROM flight GROUP BY MONTH ORDER BY MONTH;",
        "role": "assistant"
      }
    ],
    "db_name": "atis",
    "id": 62,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat's the earliest flight departure time in the day in HH:MM?\n\n【数据库schema】\n【DB_ID】 atis\n【Schema】\n# Table: aircraft\n[\n  (aircraft_code:text, The code assigned to the aircraft by the International Air Transport Association (IATA).. Value examples: ['B747', 'A320'].),\n  (aircraft_description:text, A short description of the aircraft.. Value examples: ['The Boeing 747 is a wide-body airliner.', 'The Airbus A320 is a narrow-body airliner.'].),\n  (manufacturer:text, The name of the manufacturer of the aircraft.. Value examples: ['Boeing', 'Airbus'].),\n  (basic_type:text, The basic type of the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (engines:bigint, The number of engines the aircraft has.. Value examples: ['4', '2'].),\n  (propulsion:text, The type of propulsion used by the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (wide_body:text, Indicates whether the aircraft is a wide body or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'No'].),\n  (wing_span:bigint, The distance between the tips of the aircraft's wings in feet.. Value examples: ['224', '111'].),\n  (length:bigint, The length of the aircraft in feet.. Value examples: ['231', '123'].),\n  (weight:bigint, The weight of the aircraft in pounds.. Value examples: ['987000', '162000'].),\n  (capacity:bigint, The maximum number of passengers the aircraft can carry.. Value examples: ['416', '240'].),\n  (pay_load:bigint, The maximum weight of cargo the aircraft can carry.. Value examples: ['60000', '30000'].),\n  (cruising_speed:bigint, The speed at which the aircraft cruises in miles per hour.. Value examples: ['570', '511'].),\n  (range_miles:bigint, The maximum distance the aircraft can fly in miles.. Value examples: ['8555', '3300'].),\n  (pressurized:text, Indicates whether the aircraft is pressurized or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'Yes'].),\n]\n# Table: airline\n[\n  (airline_code:text, The code assigned to the airline. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (airline_name:text, The name of the airline. Value examples: ['American Airlines', 'United Airlines', 'Delta Air Lines', 'Southwest Airlines'].),\n  (note:text, Any additional notes or comments about the airline. Value examples: ['NULL', 'NULL', 'NULL', 'NULL'].),\n]\n# Table: airport\n[\n  (airport_code:text, The code assigned to the airport.. Value examples: ['JFK', 'LAX', 'ORD', 'DFW'].),\n  (airport_name:text, The name of the airport.. Value examples: ['John F. Kennedy International Airport', 'Los Angeles International Airport', 'O’Hare International Airport', 'Dallas/Fort Worth International Airport'].),\n  (airport_location:text, The location of the airport, eg 'Las Vegas', 'Chicago'. Value examples: ['New York City', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The code assigned to the state where the airport is located.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the airport is located.. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the airport is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n  (minimum_connect_time:bigint, The minimum amount of time required for a connecting flight at the airport.. Value examples: ['23', '20', '24', '40'].),\n]\n# Table: airport_service\n[\n  (city_code:text, The code of the city where the airport is located. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The code of the airport. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (miles_distant:bigint, The distance of the airport from the city in miles. Value examples: ['10', '20', '30', '40'].),\n  (direction:text, The direction of the airport from the city. Either 'North', 'South', 'East', 'West', 'Northeast', 'Northwest', 'Southeast', or 'Southwest'.. Value examples: ['North', 'South', 'East', 'West'].),\n  (minutes_distant:bigint, The distance of the airport from the city in minutes. Value examples: ['20', '40', '60', '80'].),\n]\n# Table: city\n[\n  (city_code:text, The code assigned to the city. Value examples: ['NYC', 'LA', 'CHI', 'DA'].),\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The 2-letter code assigned to the state where the city is located. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the city is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n]\n# Table: class_of_service\n[\n  (booking_class:text, The booking class code for the class of service. Value examples: ['First', 'Business', 'Economy'].),\n  (rank:bigint, The rank of the class of service. Value examples: ['1', '2', '3'].),\n  (class_description:text, A brief description of the class of service. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: code_description\n[\n  (code:text, The code column contains a unique identifier for each record in the table.. Value examples: ['ABC', 'DEF'].),\n  (description:text, The description column contains a textual description of the code.. Value examples: ['Code ABC', 'Code DEF'].),\n]\n# Table: compartment_class\n[\n  (compartment:text, The compartment column contains the name of a compartment. Either 'First', 'Business', or 'Economy'.. Value examples: ['First', 'Business', 'Economy'].),\n  (class_type:text, The class_type column contains the type of a class. Either 'First Class', 'Business Class', or 'Economy Class'.. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: days\n[\n  (days_code:text, A code representing a day of the week. Value examples: ['1', '2'].),\n  (day_name:text, The name of a day of the week. Either 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', or 'Sunday'.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: dual_carrier\n[\n  (main_airline:text, The name of the main airline operating the flight. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (low_flight_number:bigint, The lowest flight number in the range of flights operated by the dual carrier. Value examples: ['1', '11', '21', '31'].),\n  (high_flight_number:bigint, The highest flight number in the range of flights operated by the dual carrier. Value examples: ['10', '20', '30', '40'].),\n  (dual_airline:text, The name of the dual airline operating the flight. Value examples: ['VX', 'DL', 'UA', 'AS'].),\n  (service_name:text, The name of the service provided by the dual carrier on the flight. Value examples: ['Dual Service 1', 'Dual Service 2', 'Dual Service 3', 'Dual Service 4'].),\n]\n# Table: equipment_sequence\n[\n  (aircraft_code_sequence:text, Sequence number for each aircraft code. Value examples: ['1', '2', '3', '4'].),\n  (aircraft_code:text, Code for each aircraft. Value examples: ['B747', 'A320', 'B737', 'A380'].),\n]\n# Table: fare\n[\n  (fare_id:bigint, The unique identifier for this fare. Value examples: ['1', '2'].),\n  (from_airport:text, The 3-letter airport code for the departure location. Value examples: ['ORD', 'ORD'].),\n  (to_airport:text, The 3-letter airport code for the arrival location. Value examples: ['JFK', 'JFK'].),\n  (fare_basis_code:text, The code used to determine the fare's pricing rules. Value examples: ['ABC', 'DEF'].),\n  (fare_airline:text, The airline code associated with this fare. Value examples: ['AA', 'UA'].),\n  (restriction_code:text, Any restrictions or limitations associated with this fare. Value examples: ['NONE', 'NONE'].),\n  (one_direction_cost:bigint, The cost of a one-way trip for this fare. Value examples: ['200', '150'].),\n  (round_trip_cost:bigint, The cost of a round-trip for this fare. Value examples: ['300', '280'].),\n  (round_trip_required:text, Indicates whether a round-trip is required to purchase this fare. Either Yes or No.. Value examples: ['Yes', 'No'].),\n]\n# Table: fare_basis\n[\n  (fare_basis_code:text, The code that identifies the fare basis. Value examples: ['ABC', 'DEF', 'GHI', 'JKL'].),\n  (booking_class:text, The booking class associated with the fare basis. Either 'First', 'Business', or 'Economy'. Value examples: ['First', 'Business', 'Economy', 'First'].),\n  (class_type:text, The class type associated with the fare basis. Either 'First Class', 'Business Class', or 'Economy Class'. Value examples: ['First Class', 'Business Class', 'Economy Class', 'First Class'].),\n  (premium:text, Indicates whether the fare basis is for a premium class. Value examples: ['Yes', 'Yes', 'No', 'Yes'].),\n  (economy:text, Indicates whether the fare basis is for an economy class. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (discounted:text, Indicates whether the fare basis is for a discounted fare. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (night:text, Indicates whether the fare basis is for a night fare. Value examples: ['No', 'No', 'No', 'No'].),\n  (season:text, The season associated with the fare basis. Can only be 'Peak' or 'Regular'. Value examples: ['Regular', 'Regular', 'Regular', 'Regular'].),\n  (basis_days:text, The number of days the fare basis is valid for. Value examples: ['30', '30', '30', '30'].),\n]\n# Table: flight\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['3', '4', '5', '7'].),\n  (flight_days:text, Days of the week the flight operates on. Formatted as comma-delimited 3-letter abbreviations, e.g. `mon,tue,wed` or `tues,thurs`. Value examples: ['wed', 'thu', 'fri', 'sun'].),\n  (from_airport:text, Code assigned to the departure airport. Value examples: ['ORD', 'ORD', 'ORD', 'JFK'].),\n  (to_airport:text, Code assigned to the arrival airport. Value examples: ['JFK', 'JFK', 'LAX', 'ORD'].),\n  (departure_time:bigint, Epoch timestamp for departure time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577858400', '1577865600', '1577880000'].),\n  (arrival_time:bigint, Epoch timestamp for arrival time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577854900', '1577873400', '1577869600', '1577883700'].),\n  (airline_flight:text, Code assigned to the airline flight. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (airline_code:text, Code assigned to the airline. Value examples: ['AA', 'WN', 'AS', 'UA'].),\n  (flight_number:text, Flight number assigned by the airline. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (aircraft_code_sequence:text, Code assigned to the aircraft. Value examples: ['3', '4', '5', '7'].),\n  (meal_code:text, Code assigned to the meal provided during the flight. Value examples: ['DN', 'BS', 'BF', 'DN'].),\n  (stops:bigint, Number of stops during the flight. Value examples: ['0', '1', '0', '0'].),\n  (connections:bigint, Number of connections during the flight. Value examples: ['0', '1', '0', '0'].),\n  (dual_carrier:text, Code assigned to the dual carrier. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (time_elapsed:bigint, Total time elapsed during the flight in seconds. Value examples: ['3700', '15000', '4000', '3700'].),\n]\n# Table: flight_fare\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3', '4'].),\n  (fare_id:bigint, Unique identifier for each fare. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: flight_leg\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3'].),\n  (leg_number:bigint, The sequence number of the leg within the flight. Value examples: ['1', '1', '1'].),\n  (leg_flight:bigint, The flight ID of the leg's corresponding flight. Value examples: ['1', '2', '3'].),\n]\n# Table: flight_stop\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['2', '4'].),\n  (stop_number:bigint, The order of the stop in the flight. Value examples: ['1', '1'].),\n  (stop_days:text, Days of the week on which the flight stops at this airport. Value examples: ['2', '4'].),\n  (stop_airport:text, The 3-letter airport code of the stop. Value examples: ['DFW', 'DEN'].),\n  (arrival_time:bigint, The time at which the flight arrives at this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577847600', '1577862000'].),\n  (arrival_airline:text, The airline code of the arriving flight. Value examples: ['UA', 'WN'].),\n  (arrival_flight_number:text, Flight number of the arriving flight at this stop. Value examples: ['UA456', 'WN012'].),\n  (departure_time:bigint, The time at which the flight departs from this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577865600'].),\n  (departure_airline:text, The airline code of the departing flight. Value examples: ['UA', 'WN'].),\n  (departure_flight_number:text, Flight number of the departing flight from this stop. Value examples: ['UA456', 'WN012'].),\n  (stop_time:bigint, The duration of the stop at this airport. Value examples: ['3600', '3600'].),\n]\n# Table: food_service\n[\n  (meal_code:text, Code assigned to each meal type. Value examples: ['BF', 'LN'].),\n  (meal_number:bigint, Unique identifier for each meal served. Value examples: ['1', '2'].),\n  (compartment:text, The compartment in which the meal is served (e.g. 'First Class', 'Economy'). Value examples: ['First Class', 'First Class'].),\n  (meal_description:text, One of 'Breakfast', 'Lunch', 'Dinner'. Value examples: ['Breakfast', 'Lunch'].),\n]\n# Table: ground_service\n[\n  (city_code:text, The code for the city where the ground service is provided. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The 3-letter code for the airport where the ground service is provided. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (transport_type:text, The type of ground transportation provided. Value examples: ['Taxi', 'Shuttle', 'Bus', 'Car Rental'].),\n  (ground_fare:bigint, The fare charged for ground transportation. Value examples: ['50', '40', '30', '60'].),\n]\n# Table: month\n[\n  (month_number:bigint, A unique number assigned to each month of the year.. Value examples: ['1', '2', '3', '4'].),\n  (month_name:text, The name of the month, e.g. January, February, etc.. Value examples: ['January', 'February', 'March', 'April'].),\n]\n# Table: restriction\n[\n  (restriction_code:text, A code representing the type of restriction, such as blackout dates or minimum stay.. Value examples: ['NONE', 'NONE', 'NONE', 'NONE'].),\n  (advance_purchase:bigint, The number of days in advance the fare must be purchased.. Value examples: ['14', '14', '14', '14'].),\n  (stopovers:text, The number of stopovers allowed for the fare.. Value examples: ['2', '2', '2', '2'].),\n  (saturday_stay_required:text, Indicates whether a Saturday night stay is required for the fare. Either 'Yes' or 'No'.. Value examples: ['No', 'No', 'No', 'No'].),\n  (minimum_stay:bigint, The minimum length of stay required for the fare.. Value examples: ['7', '7', '7', '7'].),\n  (maximum_stay:bigint, The maximum length of stay allowed for the fare.. Value examples: ['30', '30', '30', '30'].),\n  (application:text, The type of fare application. Either 'One Way' or 'Round Trip'.. Value examples: ['One-Way', 'One-Way', 'One-Way', 'One-Way'].),\n  (no_discounts:text, Indicates whether the fare is eligible for discounts or promotions. Either 'Yes' or 'No'.. Value examples: ['Yes', 'Yes', 'Yes', 'Yes'].),\n]\n# Table: state\n[\n  (state_code:text, The 2-letter code assigned to the state. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA'].),\n  (state_name:text, The name of the state. Value examples: ['New York', 'California'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States'].),\n]\n# Table: time_interval\n[\n  (period:text, The period of the time interval, represented as a string. For example, 'daily', 'weekly', 'monthly', etc.. Value examples: ['daily', 'daily', 'daily'].),\n  (begin_time:bigint, The beginning time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577836800', '1577844000', '1577851200'].),\n  (end_time:bigint, The end time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577840400', '1577847600', '1577854800'].),\n]\n# Table: time_zone\n[\n  (time_zone_code:text, A short code that represents the time zone. For example, 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['PST', 'MST'].),\n  (time_zone_name:text, The name of the time zone. Value examples: ['Pacific Standard Time', 'Mountain Standard Time'].),\n  (hours_from_gmt:bigint, The number of hours that the time zone is ahead or behind Greenwich Mean Time (GMT). Value examples: ['-8', '-7'].),\n]\n\n【Foreign keys】\nairline.airline_code = flight.airline_code\nairline.airline_code = flight_stop.departure_airline\nairport.airport_code = fare.from_airport\nairport.airport_code = flight_stop.stop_airport\nairport_service.city_code = ground_service.city_code\nairport.state_code = city.state_code\nairport.state_code = state.state_code\ncity.state_code = state.state_code\nairport_service.city_code = city.city_code\nground_service.city_code = city.city_code\nairport.time_zone_code = time_zone.time_zone_code\ncity.time_zone_code = time_zone.time_zone_code\nflight.flight_id = flight_fare.flight_id\nflight.flight_id = flight_leg.flight_id\nflight.flight_id = flight_stop.flight_id\nflight_fare.flight_id = flight_leg.flight_id\nflight_fare.flight_id = flight_stop.flight_id\nflight_leg.flight_id = flight_stop.flight_id\naircraft.aircraft_code = equipment_sequence.aircraft_code\nflight.aircraft_code_sequence = equipment_sequence.aircraft_code_sequence\nflight.meal_code = food_service.meal_code\n\n【参考信息】\n\n\n【用户问题】\nWhat's the earliest flight departure time in the day in HH:MM?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT to_char(to_timestamp(departure_time)::TIME, 'HH24:MI') AS earliest_departure_time FROM flight ORDER BY earliest_departure_time LIMIT 1;",
        "role": "assistant"
      }
    ],
    "db_name": "atis",
    "id": 63,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat's the difference in time in days between today and the earliest flight departure?\n\n【数据库schema】\n【DB_ID】 atis\n【Schema】\n# Table: aircraft\n[\n  (aircraft_code:text, The code assigned to the aircraft by the International Air Transport Association (IATA).. Value examples: ['B747', 'A320'].),\n  (aircraft_description:text, A short description of the aircraft.. Value examples: ['The Boeing 747 is a wide-body airliner.', 'The Airbus A320 is a narrow-body airliner.'].),\n  (manufacturer:text, The name of the manufacturer of the aircraft.. Value examples: ['Boeing', 'Airbus'].),\n  (basic_type:text, The basic type of the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (engines:bigint, The number of engines the aircraft has.. Value examples: ['4', '2'].),\n  (propulsion:text, The type of propulsion used by the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (wide_body:text, Indicates whether the aircraft is a wide body or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'No'].),\n  (wing_span:bigint, The distance between the tips of the aircraft's wings in feet.. Value examples: ['224', '111'].),\n  (length:bigint, The length of the aircraft in feet.. Value examples: ['231', '123'].),\n  (weight:bigint, The weight of the aircraft in pounds.. Value examples: ['987000', '162000'].),\n  (capacity:bigint, The maximum number of passengers the aircraft can carry.. Value examples: ['416', '240'].),\n  (pay_load:bigint, The maximum weight of cargo the aircraft can carry.. Value examples: ['60000', '30000'].),\n  (cruising_speed:bigint, The speed at which the aircraft cruises in miles per hour.. Value examples: ['570', '511'].),\n  (range_miles:bigint, The maximum distance the aircraft can fly in miles.. Value examples: ['8555', '3300'].),\n  (pressurized:text, Indicates whether the aircraft is pressurized or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'Yes'].),\n]\n# Table: airline\n[\n  (airline_code:text, The code assigned to the airline. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (airline_name:text, The name of the airline. Value examples: ['American Airlines', 'United Airlines', 'Delta Air Lines', 'Southwest Airlines'].),\n  (note:text, Any additional notes or comments about the airline. Value examples: ['NULL', 'NULL', 'NULL', 'NULL'].),\n]\n# Table: airport\n[\n  (airport_code:text, The code assigned to the airport.. Value examples: ['JFK', 'LAX', 'ORD', 'DFW'].),\n  (airport_name:text, The name of the airport.. Value examples: ['John F. Kennedy International Airport', 'Los Angeles International Airport', 'O’Hare International Airport', 'Dallas/Fort Worth International Airport'].),\n  (airport_location:text, The location of the airport, eg 'Las Vegas', 'Chicago'. Value examples: ['New York City', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The code assigned to the state where the airport is located.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the airport is located.. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the airport is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n  (minimum_connect_time:bigint, The minimum amount of time required for a connecting flight at the airport.. Value examples: ['23', '20', '24', '40'].),\n]\n# Table: airport_service\n[\n  (city_code:text, The code of the city where the airport is located. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The code of the airport. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (miles_distant:bigint, The distance of the airport from the city in miles. Value examples: ['10', '20', '30', '40'].),\n  (direction:text, The direction of the airport from the city. Either 'North', 'South', 'East', 'West', 'Northeast', 'Northwest', 'Southeast', or 'Southwest'.. Value examples: ['North', 'South', 'East', 'West'].),\n  (minutes_distant:bigint, The distance of the airport from the city in minutes. Value examples: ['20', '40', '60', '80'].),\n]\n# Table: city\n[\n  (city_code:text, The code assigned to the city. Value examples: ['NYC', 'LA', 'CHI', 'DA'].),\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The 2-letter code assigned to the state where the city is located. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the city is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n]\n# Table: class_of_service\n[\n  (booking_class:text, The booking class code for the class of service. Value examples: ['First', 'Business', 'Economy'].),\n  (rank:bigint, The rank of the class of service. Value examples: ['1', '2', '3'].),\n  (class_description:text, A brief description of the class of service. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: code_description\n[\n  (code:text, The code column contains a unique identifier for each record in the table.. Value examples: ['ABC', 'DEF'].),\n  (description:text, The description column contains a textual description of the code.. Value examples: ['Code ABC', 'Code DEF'].),\n]\n# Table: compartment_class\n[\n  (compartment:text, The compartment column contains the name of a compartment. Either 'First', 'Business', or 'Economy'.. Value examples: ['First', 'Business', 'Economy'].),\n  (class_type:text, The class_type column contains the type of a class. Either 'First Class', 'Business Class', or 'Economy Class'.. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: days\n[\n  (days_code:text, A code representing a day of the week. Value examples: ['1', '2'].),\n  (day_name:text, The name of a day of the week. Either 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', or 'Sunday'.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: dual_carrier\n[\n  (main_airline:text, The name of the main airline operating the flight. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (low_flight_number:bigint, The lowest flight number in the range of flights operated by the dual carrier. Value examples: ['1', '11', '21', '31'].),\n  (high_flight_number:bigint, The highest flight number in the range of flights operated by the dual carrier. Value examples: ['10', '20', '30', '40'].),\n  (dual_airline:text, The name of the dual airline operating the flight. Value examples: ['VX', 'DL', 'UA', 'AS'].),\n  (service_name:text, The name of the service provided by the dual carrier on the flight. Value examples: ['Dual Service 1', 'Dual Service 2', 'Dual Service 3', 'Dual Service 4'].),\n]\n# Table: equipment_sequence\n[\n  (aircraft_code_sequence:text, Sequence number for each aircraft code. Value examples: ['1', '2', '3', '4'].),\n  (aircraft_code:text, Code for each aircraft. Value examples: ['B747', 'A320', 'B737', 'A380'].),\n]\n# Table: fare\n[\n  (fare_id:bigint, The unique identifier for this fare. Value examples: ['1', '2'].),\n  (from_airport:text, The 3-letter airport code for the departure location. Value examples: ['ORD', 'ORD'].),\n  (to_airport:text, The 3-letter airport code for the arrival location. Value examples: ['JFK', 'JFK'].),\n  (fare_basis_code:text, The code used to determine the fare's pricing rules. Value examples: ['ABC', 'DEF'].),\n  (fare_airline:text, The airline code associated with this fare. Value examples: ['AA', 'UA'].),\n  (restriction_code:text, Any restrictions or limitations associated with this fare. Value examples: ['NONE', 'NONE'].),\n  (one_direction_cost:bigint, The cost of a one-way trip for this fare. Value examples: ['200', '150'].),\n  (round_trip_cost:bigint, The cost of a round-trip for this fare. Value examples: ['300', '280'].),\n  (round_trip_required:text, Indicates whether a round-trip is required to purchase this fare. Either Yes or No.. Value examples: ['Yes', 'No'].),\n]\n# Table: fare_basis\n[\n  (fare_basis_code:text, The code that identifies the fare basis. Value examples: ['ABC', 'DEF', 'GHI', 'JKL'].),\n  (booking_class:text, The booking class associated with the fare basis. Either 'First', 'Business', or 'Economy'. Value examples: ['First', 'Business', 'Economy', 'First'].),\n  (class_type:text, The class type associated with the fare basis. Either 'First Class', 'Business Class', or 'Economy Class'. Value examples: ['First Class', 'Business Class', 'Economy Class', 'First Class'].),\n  (premium:text, Indicates whether the fare basis is for a premium class. Value examples: ['Yes', 'Yes', 'No', 'Yes'].),\n  (economy:text, Indicates whether the fare basis is for an economy class. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (discounted:text, Indicates whether the fare basis is for a discounted fare. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (night:text, Indicates whether the fare basis is for a night fare. Value examples: ['No', 'No', 'No', 'No'].),\n  (season:text, The season associated with the fare basis. Can only be 'Peak' or 'Regular'. Value examples: ['Regular', 'Regular', 'Regular', 'Regular'].),\n  (basis_days:text, The number of days the fare basis is valid for. Value examples: ['30', '30', '30', '30'].),\n]\n# Table: flight\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['3', '4', '5', '7'].),\n  (flight_days:text, Days of the week the flight operates on. Formatted as comma-delimited 3-letter abbreviations, e.g. `mon,tue,wed` or `tues,thurs`. Value examples: ['wed', 'thu', 'fri', 'sun'].),\n  (from_airport:text, Code assigned to the departure airport. Value examples: ['ORD', 'ORD', 'ORD', 'JFK'].),\n  (to_airport:text, Code assigned to the arrival airport. Value examples: ['JFK', 'JFK', 'LAX', 'ORD'].),\n  (departure_time:bigint, Epoch timestamp for departure time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577858400', '1577865600', '1577880000'].),\n  (arrival_time:bigint, Epoch timestamp for arrival time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577854900', '1577873400', '1577869600', '1577883700'].),\n  (airline_flight:text, Code assigned to the airline flight. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (airline_code:text, Code assigned to the airline. Value examples: ['AA', 'WN', 'AS', 'UA'].),\n  (flight_number:text, Flight number assigned by the airline. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (aircraft_code_sequence:text, Code assigned to the aircraft. Value examples: ['3', '4', '5', '7'].),\n  (meal_code:text, Code assigned to the meal provided during the flight. Value examples: ['DN', 'BS', 'BF', 'DN'].),\n  (stops:bigint, Number of stops during the flight. Value examples: ['0', '1', '0', '0'].),\n  (connections:bigint, Number of connections during the flight. Value examples: ['0', '1', '0', '0'].),\n  (dual_carrier:text, Code assigned to the dual carrier. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (time_elapsed:bigint, Total time elapsed during the flight in seconds. Value examples: ['3700', '15000', '4000', '3700'].),\n]\n# Table: flight_fare\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3', '4'].),\n  (fare_id:bigint, Unique identifier for each fare. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: flight_leg\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3'].),\n  (leg_number:bigint, The sequence number of the leg within the flight. Value examples: ['1', '1', '1'].),\n  (leg_flight:bigint, The flight ID of the leg's corresponding flight. Value examples: ['1', '2', '3'].),\n]\n# Table: flight_stop\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['2', '4'].),\n  (stop_number:bigint, The order of the stop in the flight. Value examples: ['1', '1'].),\n  (stop_days:text, Days of the week on which the flight stops at this airport. Value examples: ['2', '4'].),\n  (stop_airport:text, The 3-letter airport code of the stop. Value examples: ['DFW', 'DEN'].),\n  (arrival_time:bigint, The time at which the flight arrives at this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577847600', '1577862000'].),\n  (arrival_airline:text, The airline code of the arriving flight. Value examples: ['UA', 'WN'].),\n  (arrival_flight_number:text, Flight number of the arriving flight at this stop. Value examples: ['UA456', 'WN012'].),\n  (departure_time:bigint, The time at which the flight departs from this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577865600'].),\n  (departure_airline:text, The airline code of the departing flight. Value examples: ['UA', 'WN'].),\n  (departure_flight_number:text, Flight number of the departing flight from this stop. Value examples: ['UA456', 'WN012'].),\n  (stop_time:bigint, The duration of the stop at this airport. Value examples: ['3600', '3600'].),\n]\n# Table: food_service\n[\n  (meal_code:text, Code assigned to each meal type. Value examples: ['BF', 'LN'].),\n  (meal_number:bigint, Unique identifier for each meal served. Value examples: ['1', '2'].),\n  (compartment:text, The compartment in which the meal is served (e.g. 'First Class', 'Economy'). Value examples: ['First Class', 'First Class'].),\n  (meal_description:text, One of 'Breakfast', 'Lunch', 'Dinner'. Value examples: ['Breakfast', 'Lunch'].),\n]\n# Table: ground_service\n[\n  (city_code:text, The code for the city where the ground service is provided. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The 3-letter code for the airport where the ground service is provided. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (transport_type:text, The type of ground transportation provided. Value examples: ['Taxi', 'Shuttle', 'Bus', 'Car Rental'].),\n  (ground_fare:bigint, The fare charged for ground transportation. Value examples: ['50', '40', '30', '60'].),\n]\n# Table: month\n[\n  (month_number:bigint, A unique number assigned to each month of the year.. Value examples: ['1', '2', '3', '4'].),\n  (month_name:text, The name of the month, e.g. January, February, etc.. Value examples: ['January', 'February', 'March', 'April'].),\n]\n# Table: restriction\n[\n  (restriction_code:text, A code representing the type of restriction, such as blackout dates or minimum stay.. Value examples: ['NONE', 'NONE', 'NONE', 'NONE'].),\n  (advance_purchase:bigint, The number of days in advance the fare must be purchased.. Value examples: ['14', '14', '14', '14'].),\n  (stopovers:text, The number of stopovers allowed for the fare.. Value examples: ['2', '2', '2', '2'].),\n  (saturday_stay_required:text, Indicates whether a Saturday night stay is required for the fare. Either 'Yes' or 'No'.. Value examples: ['No', 'No', 'No', 'No'].),\n  (minimum_stay:bigint, The minimum length of stay required for the fare.. Value examples: ['7', '7', '7', '7'].),\n  (maximum_stay:bigint, The maximum length of stay allowed for the fare.. Value examples: ['30', '30', '30', '30'].),\n  (application:text, The type of fare application. Either 'One Way' or 'Round Trip'.. Value examples: ['One-Way', 'One-Way', 'One-Way', 'One-Way'].),\n  (no_discounts:text, Indicates whether the fare is eligible for discounts or promotions. Either 'Yes' or 'No'.. Value examples: ['Yes', 'Yes', 'Yes', 'Yes'].),\n]\n# Table: state\n[\n  (state_code:text, The 2-letter code assigned to the state. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA'].),\n  (state_name:text, The name of the state. Value examples: ['New York', 'California'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States'].),\n]\n# Table: time_interval\n[\n  (period:text, The period of the time interval, represented as a string. For example, 'daily', 'weekly', 'monthly', etc.. Value examples: ['daily', 'daily', 'daily'].),\n  (begin_time:bigint, The beginning time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577836800', '1577844000', '1577851200'].),\n  (end_time:bigint, The end time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577840400', '1577847600', '1577854800'].),\n]\n# Table: time_zone\n[\n  (time_zone_code:text, A short code that represents the time zone. For example, 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['PST', 'MST'].),\n  (time_zone_name:text, The name of the time zone. Value examples: ['Pacific Standard Time', 'Mountain Standard Time'].),\n  (hours_from_gmt:bigint, The number of hours that the time zone is ahead or behind Greenwich Mean Time (GMT). Value examples: ['-8', '-7'].),\n]\n\n【Foreign keys】\nairline.airline_code = flight.airline_code\nairline.airline_code = flight_stop.departure_airline\nairport.airport_code = fare.from_airport\nairport.airport_code = flight_stop.stop_airport\nairport_service.city_code = ground_service.city_code\nairport.state_code = city.state_code\nairport.state_code = state.state_code\ncity.state_code = state.state_code\nairport_service.city_code = city.city_code\nground_service.city_code = city.city_code\nairport.time_zone_code = time_zone.time_zone_code\ncity.time_zone_code = time_zone.time_zone_code\nflight.flight_id = flight_fare.flight_id\nflight.flight_id = flight_leg.flight_id\nflight.flight_id = flight_stop.flight_id\nflight_fare.flight_id = flight_leg.flight_id\nflight_fare.flight_id = flight_stop.flight_id\nflight_leg.flight_id = flight_stop.flight_id\naircraft.aircraft_code = equipment_sequence.aircraft_code\nflight.aircraft_code_sequence = equipment_sequence.aircraft_code_sequence\nflight.meal_code = food_service.meal_code\n\n【参考信息】\n\n\n【用户问题】\nWhat's the difference in time in days between today and the earliest flight departure?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT date_part('day', CURRENT_DATE - to_timestamp(departure_time)) AS difference_in_days FROM flight ORDER BY departure_time LIMIT 1;SELECT (CURRENT_DATE - TO_TIMESTAMP(MIN(f.departure_time))) AS days_difference FROM flight f;",
        "role": "assistant"
      }
    ],
    "db_name": "atis",
    "id": 64,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the total cost of round-trip fares for each airline code?\n\n【数据库schema】\n【DB_ID】 atis\n【Schema】\n# Table: aircraft\n[\n  (aircraft_code:text, The code assigned to the aircraft by the International Air Transport Association (IATA).. Value examples: ['B747', 'A320'].),\n  (aircraft_description:text, A short description of the aircraft.. Value examples: ['The Boeing 747 is a wide-body airliner.', 'The Airbus A320 is a narrow-body airliner.'].),\n  (manufacturer:text, The name of the manufacturer of the aircraft.. Value examples: ['Boeing', 'Airbus'].),\n  (basic_type:text, The basic type of the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (engines:bigint, The number of engines the aircraft has.. Value examples: ['4', '2'].),\n  (propulsion:text, The type of propulsion used by the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (wide_body:text, Indicates whether the aircraft is a wide body or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'No'].),\n  (wing_span:bigint, The distance between the tips of the aircraft's wings in feet.. Value examples: ['224', '111'].),\n  (length:bigint, The length of the aircraft in feet.. Value examples: ['231', '123'].),\n  (weight:bigint, The weight of the aircraft in pounds.. Value examples: ['987000', '162000'].),\n  (capacity:bigint, The maximum number of passengers the aircraft can carry.. Value examples: ['416', '240'].),\n  (pay_load:bigint, The maximum weight of cargo the aircraft can carry.. Value examples: ['60000', '30000'].),\n  (cruising_speed:bigint, The speed at which the aircraft cruises in miles per hour.. Value examples: ['570', '511'].),\n  (range_miles:bigint, The maximum distance the aircraft can fly in miles.. Value examples: ['8555', '3300'].),\n  (pressurized:text, Indicates whether the aircraft is pressurized or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'Yes'].),\n]\n# Table: airline\n[\n  (airline_code:text, The code assigned to the airline. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (airline_name:text, The name of the airline. Value examples: ['American Airlines', 'United Airlines', 'Delta Air Lines', 'Southwest Airlines'].),\n  (note:text, Any additional notes or comments about the airline. Value examples: ['NULL', 'NULL', 'NULL', 'NULL'].),\n]\n# Table: airport\n[\n  (airport_code:text, The code assigned to the airport.. Value examples: ['JFK', 'LAX', 'ORD', 'DFW'].),\n  (airport_name:text, The name of the airport.. Value examples: ['John F. Kennedy International Airport', 'Los Angeles International Airport', 'O’Hare International Airport', 'Dallas/Fort Worth International Airport'].),\n  (airport_location:text, The location of the airport, eg 'Las Vegas', 'Chicago'. Value examples: ['New York City', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The code assigned to the state where the airport is located.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the airport is located.. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the airport is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n  (minimum_connect_time:bigint, The minimum amount of time required for a connecting flight at the airport.. Value examples: ['23', '20', '24', '40'].),\n]\n# Table: airport_service\n[\n  (city_code:text, The code of the city where the airport is located. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The code of the airport. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (miles_distant:bigint, The distance of the airport from the city in miles. Value examples: ['10', '20', '30', '40'].),\n  (direction:text, The direction of the airport from the city. Either 'North', 'South', 'East', 'West', 'Northeast', 'Northwest', 'Southeast', or 'Southwest'.. Value examples: ['North', 'South', 'East', 'West'].),\n  (minutes_distant:bigint, The distance of the airport from the city in minutes. Value examples: ['20', '40', '60', '80'].),\n]\n# Table: city\n[\n  (city_code:text, The code assigned to the city. Value examples: ['NYC', 'LA', 'CHI', 'DA'].),\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The 2-letter code assigned to the state where the city is located. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the city is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n]\n# Table: class_of_service\n[\n  (booking_class:text, The booking class code for the class of service. Value examples: ['First', 'Business', 'Economy'].),\n  (rank:bigint, The rank of the class of service. Value examples: ['1', '2', '3'].),\n  (class_description:text, A brief description of the class of service. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: code_description\n[\n  (code:text, The code column contains a unique identifier for each record in the table.. Value examples: ['ABC', 'DEF'].),\n  (description:text, The description column contains a textual description of the code.. Value examples: ['Code ABC', 'Code DEF'].),\n]\n# Table: compartment_class\n[\n  (compartment:text, The compartment column contains the name of a compartment. Either 'First', 'Business', or 'Economy'.. Value examples: ['First', 'Business', 'Economy'].),\n  (class_type:text, The class_type column contains the type of a class. Either 'First Class', 'Business Class', or 'Economy Class'.. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: days\n[\n  (days_code:text, A code representing a day of the week. Value examples: ['1', '2'].),\n  (day_name:text, The name of a day of the week. Either 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', or 'Sunday'.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: dual_carrier\n[\n  (main_airline:text, The name of the main airline operating the flight. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (low_flight_number:bigint, The lowest flight number in the range of flights operated by the dual carrier. Value examples: ['1', '11', '21', '31'].),\n  (high_flight_number:bigint, The highest flight number in the range of flights operated by the dual carrier. Value examples: ['10', '20', '30', '40'].),\n  (dual_airline:text, The name of the dual airline operating the flight. Value examples: ['VX', 'DL', 'UA', 'AS'].),\n  (service_name:text, The name of the service provided by the dual carrier on the flight. Value examples: ['Dual Service 1', 'Dual Service 2', 'Dual Service 3', 'Dual Service 4'].),\n]\n# Table: equipment_sequence\n[\n  (aircraft_code_sequence:text, Sequence number for each aircraft code. Value examples: ['1', '2', '3', '4'].),\n  (aircraft_code:text, Code for each aircraft. Value examples: ['B747', 'A320', 'B737', 'A380'].),\n]\n# Table: fare\n[\n  (fare_id:bigint, The unique identifier for this fare. Value examples: ['1', '2'].),\n  (from_airport:text, The 3-letter airport code for the departure location. Value examples: ['ORD', 'ORD'].),\n  (to_airport:text, The 3-letter airport code for the arrival location. Value examples: ['JFK', 'JFK'].),\n  (fare_basis_code:text, The code used to determine the fare's pricing rules. Value examples: ['ABC', 'DEF'].),\n  (fare_airline:text, The airline code associated with this fare. Value examples: ['AA', 'UA'].),\n  (restriction_code:text, Any restrictions or limitations associated with this fare. Value examples: ['NONE', 'NONE'].),\n  (one_direction_cost:bigint, The cost of a one-way trip for this fare. Value examples: ['200', '150'].),\n  (round_trip_cost:bigint, The cost of a round-trip for this fare. Value examples: ['300', '280'].),\n  (round_trip_required:text, Indicates whether a round-trip is required to purchase this fare. Either Yes or No.. Value examples: ['Yes', 'No'].),\n]\n# Table: fare_basis\n[\n  (fare_basis_code:text, The code that identifies the fare basis. Value examples: ['ABC', 'DEF', 'GHI', 'JKL'].),\n  (booking_class:text, The booking class associated with the fare basis. Either 'First', 'Business', or 'Economy'. Value examples: ['First', 'Business', 'Economy', 'First'].),\n  (class_type:text, The class type associated with the fare basis. Either 'First Class', 'Business Class', or 'Economy Class'. Value examples: ['First Class', 'Business Class', 'Economy Class', 'First Class'].),\n  (premium:text, Indicates whether the fare basis is for a premium class. Value examples: ['Yes', 'Yes', 'No', 'Yes'].),\n  (economy:text, Indicates whether the fare basis is for an economy class. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (discounted:text, Indicates whether the fare basis is for a discounted fare. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (night:text, Indicates whether the fare basis is for a night fare. Value examples: ['No', 'No', 'No', 'No'].),\n  (season:text, The season associated with the fare basis. Can only be 'Peak' or 'Regular'. Value examples: ['Regular', 'Regular', 'Regular', 'Regular'].),\n  (basis_days:text, The number of days the fare basis is valid for. Value examples: ['30', '30', '30', '30'].),\n]\n# Table: flight\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['3', '4', '5', '7'].),\n  (flight_days:text, Days of the week the flight operates on. Formatted as comma-delimited 3-letter abbreviations, e.g. `mon,tue,wed` or `tues,thurs`. Value examples: ['wed', 'thu', 'fri', 'sun'].),\n  (from_airport:text, Code assigned to the departure airport. Value examples: ['ORD', 'ORD', 'ORD', 'JFK'].),\n  (to_airport:text, Code assigned to the arrival airport. Value examples: ['JFK', 'JFK', 'LAX', 'ORD'].),\n  (departure_time:bigint, Epoch timestamp for departure time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577858400', '1577865600', '1577880000'].),\n  (arrival_time:bigint, Epoch timestamp for arrival time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577854900', '1577873400', '1577869600', '1577883700'].),\n  (airline_flight:text, Code assigned to the airline flight. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (airline_code:text, Code assigned to the airline. Value examples: ['AA', 'WN', 'AS', 'UA'].),\n  (flight_number:text, Flight number assigned by the airline. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (aircraft_code_sequence:text, Code assigned to the aircraft. Value examples: ['3', '4', '5', '7'].),\n  (meal_code:text, Code assigned to the meal provided during the flight. Value examples: ['DN', 'BS', 'BF', 'DN'].),\n  (stops:bigint, Number of stops during the flight. Value examples: ['0', '1', '0', '0'].),\n  (connections:bigint, Number of connections during the flight. Value examples: ['0', '1', '0', '0'].),\n  (dual_carrier:text, Code assigned to the dual carrier. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (time_elapsed:bigint, Total time elapsed during the flight in seconds. Value examples: ['3700', '15000', '4000', '3700'].),\n]\n# Table: flight_fare\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3', '4'].),\n  (fare_id:bigint, Unique identifier for each fare. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: flight_leg\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3'].),\n  (leg_number:bigint, The sequence number of the leg within the flight. Value examples: ['1', '1', '1'].),\n  (leg_flight:bigint, The flight ID of the leg's corresponding flight. Value examples: ['1', '2', '3'].),\n]\n# Table: flight_stop\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['2', '4'].),\n  (stop_number:bigint, The order of the stop in the flight. Value examples: ['1', '1'].),\n  (stop_days:text, Days of the week on which the flight stops at this airport. Value examples: ['2', '4'].),\n  (stop_airport:text, The 3-letter airport code of the stop. Value examples: ['DFW', 'DEN'].),\n  (arrival_time:bigint, The time at which the flight arrives at this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577847600', '1577862000'].),\n  (arrival_airline:text, The airline code of the arriving flight. Value examples: ['UA', 'WN'].),\n  (arrival_flight_number:text, Flight number of the arriving flight at this stop. Value examples: ['UA456', 'WN012'].),\n  (departure_time:bigint, The time at which the flight departs from this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577865600'].),\n  (departure_airline:text, The airline code of the departing flight. Value examples: ['UA', 'WN'].),\n  (departure_flight_number:text, Flight number of the departing flight from this stop. Value examples: ['UA456', 'WN012'].),\n  (stop_time:bigint, The duration of the stop at this airport. Value examples: ['3600', '3600'].),\n]\n# Table: food_service\n[\n  (meal_code:text, Code assigned to each meal type. Value examples: ['BF', 'LN'].),\n  (meal_number:bigint, Unique identifier for each meal served. Value examples: ['1', '2'].),\n  (compartment:text, The compartment in which the meal is served (e.g. 'First Class', 'Economy'). Value examples: ['First Class', 'First Class'].),\n  (meal_description:text, One of 'Breakfast', 'Lunch', 'Dinner'. Value examples: ['Breakfast', 'Lunch'].),\n]\n# Table: ground_service\n[\n  (city_code:text, The code for the city where the ground service is provided. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The 3-letter code for the airport where the ground service is provided. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (transport_type:text, The type of ground transportation provided. Value examples: ['Taxi', 'Shuttle', 'Bus', 'Car Rental'].),\n  (ground_fare:bigint, The fare charged for ground transportation. Value examples: ['50', '40', '30', '60'].),\n]\n# Table: month\n[\n  (month_number:bigint, A unique number assigned to each month of the year.. Value examples: ['1', '2', '3', '4'].),\n  (month_name:text, The name of the month, e.g. January, February, etc.. Value examples: ['January', 'February', 'March', 'April'].),\n]\n# Table: restriction\n[\n  (restriction_code:text, A code representing the type of restriction, such as blackout dates or minimum stay.. Value examples: ['NONE', 'NONE', 'NONE', 'NONE'].),\n  (advance_purchase:bigint, The number of days in advance the fare must be purchased.. Value examples: ['14', '14', '14', '14'].),\n  (stopovers:text, The number of stopovers allowed for the fare.. Value examples: ['2', '2', '2', '2'].),\n  (saturday_stay_required:text, Indicates whether a Saturday night stay is required for the fare. Either 'Yes' or 'No'.. Value examples: ['No', 'No', 'No', 'No'].),\n  (minimum_stay:bigint, The minimum length of stay required for the fare.. Value examples: ['7', '7', '7', '7'].),\n  (maximum_stay:bigint, The maximum length of stay allowed for the fare.. Value examples: ['30', '30', '30', '30'].),\n  (application:text, The type of fare application. Either 'One Way' or 'Round Trip'.. Value examples: ['One-Way', 'One-Way', 'One-Way', 'One-Way'].),\n  (no_discounts:text, Indicates whether the fare is eligible for discounts or promotions. Either 'Yes' or 'No'.. Value examples: ['Yes', 'Yes', 'Yes', 'Yes'].),\n]\n# Table: state\n[\n  (state_code:text, The 2-letter code assigned to the state. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA'].),\n  (state_name:text, The name of the state. Value examples: ['New York', 'California'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States'].),\n]\n# Table: time_interval\n[\n  (period:text, The period of the time interval, represented as a string. For example, 'daily', 'weekly', 'monthly', etc.. Value examples: ['daily', 'daily', 'daily'].),\n  (begin_time:bigint, The beginning time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577836800', '1577844000', '1577851200'].),\n  (end_time:bigint, The end time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577840400', '1577847600', '1577854800'].),\n]\n# Table: time_zone\n[\n  (time_zone_code:text, A short code that represents the time zone. For example, 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['PST', 'MST'].),\n  (time_zone_name:text, The name of the time zone. Value examples: ['Pacific Standard Time', 'Mountain Standard Time'].),\n  (hours_from_gmt:bigint, The number of hours that the time zone is ahead or behind Greenwich Mean Time (GMT). Value examples: ['-8', '-7'].),\n]\n\n【Foreign keys】\nairline.airline_code = flight.airline_code\nairline.airline_code = flight_stop.departure_airline\nairport.airport_code = fare.from_airport\nairport.airport_code = flight_stop.stop_airport\nairport_service.city_code = ground_service.city_code\nairport.state_code = city.state_code\nairport.state_code = state.state_code\ncity.state_code = state.state_code\nairport_service.city_code = city.city_code\nground_service.city_code = city.city_code\nairport.time_zone_code = time_zone.time_zone_code\ncity.time_zone_code = time_zone.time_zone_code\nflight.flight_id = flight_fare.flight_id\nflight.flight_id = flight_leg.flight_id\nflight.flight_id = flight_stop.flight_id\nflight_fare.flight_id = flight_leg.flight_id\nflight_fare.flight_id = flight_stop.flight_id\nflight_leg.flight_id = flight_stop.flight_id\naircraft.aircraft_code = equipment_sequence.aircraft_code\nflight.aircraft_code_sequence = equipment_sequence.aircraft_code_sequence\nflight.meal_code = food_service.meal_code\n\n【参考信息】\n\n\n【用户问题】\nWhat is the total cost of round-trip fares for each airline code?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT fare.fare_airline, SUM(fare.round_trip_cost) AS total_round_trip_cost FROM fare GROUP BY fare.fare_airline ORDER BY total_round_trip_cost DESC;",
        "role": "assistant"
      }
    ],
    "db_name": "atis",
    "id": 65,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the average cost of round-trip fares from Los Angeles (LAX) to Chicago (ORD) for each airline, sorted in descending order by average cost?\n\n【数据库schema】\n【DB_ID】 atis\n【Schema】\n# Table: aircraft\n[\n  (aircraft_code:text, The code assigned to the aircraft by the International Air Transport Association (IATA).. Value examples: ['B747', 'A320'].),\n  (aircraft_description:text, A short description of the aircraft.. Value examples: ['The Boeing 747 is a wide-body airliner.', 'The Airbus A320 is a narrow-body airliner.'].),\n  (manufacturer:text, The name of the manufacturer of the aircraft.. Value examples: ['Boeing', 'Airbus'].),\n  (basic_type:text, The basic type of the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (engines:bigint, The number of engines the aircraft has.. Value examples: ['4', '2'].),\n  (propulsion:text, The type of propulsion used by the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (wide_body:text, Indicates whether the aircraft is a wide body or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'No'].),\n  (wing_span:bigint, The distance between the tips of the aircraft's wings in feet.. Value examples: ['224', '111'].),\n  (length:bigint, The length of the aircraft in feet.. Value examples: ['231', '123'].),\n  (weight:bigint, The weight of the aircraft in pounds.. Value examples: ['987000', '162000'].),\n  (capacity:bigint, The maximum number of passengers the aircraft can carry.. Value examples: ['416', '240'].),\n  (pay_load:bigint, The maximum weight of cargo the aircraft can carry.. Value examples: ['60000', '30000'].),\n  (cruising_speed:bigint, The speed at which the aircraft cruises in miles per hour.. Value examples: ['570', '511'].),\n  (range_miles:bigint, The maximum distance the aircraft can fly in miles.. Value examples: ['8555', '3300'].),\n  (pressurized:text, Indicates whether the aircraft is pressurized or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'Yes'].),\n]\n# Table: airline\n[\n  (airline_code:text, The code assigned to the airline. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (airline_name:text, The name of the airline. Value examples: ['American Airlines', 'United Airlines', 'Delta Air Lines', 'Southwest Airlines'].),\n  (note:text, Any additional notes or comments about the airline. Value examples: ['NULL', 'NULL', 'NULL', 'NULL'].),\n]\n# Table: airport\n[\n  (airport_code:text, The code assigned to the airport.. Value examples: ['JFK', 'LAX', 'ORD', 'DFW'].),\n  (airport_name:text, The name of the airport.. Value examples: ['John F. Kennedy International Airport', 'Los Angeles International Airport', 'O’Hare International Airport', 'Dallas/Fort Worth International Airport'].),\n  (airport_location:text, The location of the airport, eg 'Las Vegas', 'Chicago'. Value examples: ['New York City', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The code assigned to the state where the airport is located.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the airport is located.. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the airport is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n  (minimum_connect_time:bigint, The minimum amount of time required for a connecting flight at the airport.. Value examples: ['23', '20', '24', '40'].),\n]\n# Table: airport_service\n[\n  (city_code:text, The code of the city where the airport is located. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The code of the airport. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (miles_distant:bigint, The distance of the airport from the city in miles. Value examples: ['10', '20', '30', '40'].),\n  (direction:text, The direction of the airport from the city. Either 'North', 'South', 'East', 'West', 'Northeast', 'Northwest', 'Southeast', or 'Southwest'.. Value examples: ['North', 'South', 'East', 'West'].),\n  (minutes_distant:bigint, The distance of the airport from the city in minutes. Value examples: ['20', '40', '60', '80'].),\n]\n# Table: city\n[\n  (city_code:text, The code assigned to the city. Value examples: ['NYC', 'LA', 'CHI', 'DA'].),\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The 2-letter code assigned to the state where the city is located. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the city is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n]\n# Table: class_of_service\n[\n  (booking_class:text, The booking class code for the class of service. Value examples: ['First', 'Business', 'Economy'].),\n  (rank:bigint, The rank of the class of service. Value examples: ['1', '2', '3'].),\n  (class_description:text, A brief description of the class of service. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: code_description\n[\n  (code:text, The code column contains a unique identifier for each record in the table.. Value examples: ['ABC', 'DEF'].),\n  (description:text, The description column contains a textual description of the code.. Value examples: ['Code ABC', 'Code DEF'].),\n]\n# Table: compartment_class\n[\n  (compartment:text, The compartment column contains the name of a compartment. Either 'First', 'Business', or 'Economy'.. Value examples: ['First', 'Business', 'Economy'].),\n  (class_type:text, The class_type column contains the type of a class. Either 'First Class', 'Business Class', or 'Economy Class'.. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: days\n[\n  (days_code:text, A code representing a day of the week. Value examples: ['1', '2'].),\n  (day_name:text, The name of a day of the week. Either 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', or 'Sunday'.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: dual_carrier\n[\n  (main_airline:text, The name of the main airline operating the flight. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (low_flight_number:bigint, The lowest flight number in the range of flights operated by the dual carrier. Value examples: ['1', '11', '21', '31'].),\n  (high_flight_number:bigint, The highest flight number in the range of flights operated by the dual carrier. Value examples: ['10', '20', '30', '40'].),\n  (dual_airline:text, The name of the dual airline operating the flight. Value examples: ['VX', 'DL', 'UA', 'AS'].),\n  (service_name:text, The name of the service provided by the dual carrier on the flight. Value examples: ['Dual Service 1', 'Dual Service 2', 'Dual Service 3', 'Dual Service 4'].),\n]\n# Table: equipment_sequence\n[\n  (aircraft_code_sequence:text, Sequence number for each aircraft code. Value examples: ['1', '2', '3', '4'].),\n  (aircraft_code:text, Code for each aircraft. Value examples: ['B747', 'A320', 'B737', 'A380'].),\n]\n# Table: fare\n[\n  (fare_id:bigint, The unique identifier for this fare. Value examples: ['1', '2'].),\n  (from_airport:text, The 3-letter airport code for the departure location. Value examples: ['ORD', 'ORD'].),\n  (to_airport:text, The 3-letter airport code for the arrival location. Value examples: ['JFK', 'JFK'].),\n  (fare_basis_code:text, The code used to determine the fare's pricing rules. Value examples: ['ABC', 'DEF'].),\n  (fare_airline:text, The airline code associated with this fare. Value examples: ['AA', 'UA'].),\n  (restriction_code:text, Any restrictions or limitations associated with this fare. Value examples: ['NONE', 'NONE'].),\n  (one_direction_cost:bigint, The cost of a one-way trip for this fare. Value examples: ['200', '150'].),\n  (round_trip_cost:bigint, The cost of a round-trip for this fare. Value examples: ['300', '280'].),\n  (round_trip_required:text, Indicates whether a round-trip is required to purchase this fare. Either Yes or No.. Value examples: ['Yes', 'No'].),\n]\n# Table: fare_basis\n[\n  (fare_basis_code:text, The code that identifies the fare basis. Value examples: ['ABC', 'DEF', 'GHI', 'JKL'].),\n  (booking_class:text, The booking class associated with the fare basis. Either 'First', 'Business', or 'Economy'. Value examples: ['First', 'Business', 'Economy', 'First'].),\n  (class_type:text, The class type associated with the fare basis. Either 'First Class', 'Business Class', or 'Economy Class'. Value examples: ['First Class', 'Business Class', 'Economy Class', 'First Class'].),\n  (premium:text, Indicates whether the fare basis is for a premium class. Value examples: ['Yes', 'Yes', 'No', 'Yes'].),\n  (economy:text, Indicates whether the fare basis is for an economy class. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (discounted:text, Indicates whether the fare basis is for a discounted fare. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (night:text, Indicates whether the fare basis is for a night fare. Value examples: ['No', 'No', 'No', 'No'].),\n  (season:text, The season associated with the fare basis. Can only be 'Peak' or 'Regular'. Value examples: ['Regular', 'Regular', 'Regular', 'Regular'].),\n  (basis_days:text, The number of days the fare basis is valid for. Value examples: ['30', '30', '30', '30'].),\n]\n# Table: flight\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['3', '4', '5', '7'].),\n  (flight_days:text, Days of the week the flight operates on. Formatted as comma-delimited 3-letter abbreviations, e.g. `mon,tue,wed` or `tues,thurs`. Value examples: ['wed', 'thu', 'fri', 'sun'].),\n  (from_airport:text, Code assigned to the departure airport. Value examples: ['ORD', 'ORD', 'ORD', 'JFK'].),\n  (to_airport:text, Code assigned to the arrival airport. Value examples: ['JFK', 'JFK', 'LAX', 'ORD'].),\n  (departure_time:bigint, Epoch timestamp for departure time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577858400', '1577865600', '1577880000'].),\n  (arrival_time:bigint, Epoch timestamp for arrival time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577854900', '1577873400', '1577869600', '1577883700'].),\n  (airline_flight:text, Code assigned to the airline flight. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (airline_code:text, Code assigned to the airline. Value examples: ['AA', 'WN', 'AS', 'UA'].),\n  (flight_number:text, Flight number assigned by the airline. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (aircraft_code_sequence:text, Code assigned to the aircraft. Value examples: ['3', '4', '5', '7'].),\n  (meal_code:text, Code assigned to the meal provided during the flight. Value examples: ['DN', 'BS', 'BF', 'DN'].),\n  (stops:bigint, Number of stops during the flight. Value examples: ['0', '1', '0', '0'].),\n  (connections:bigint, Number of connections during the flight. Value examples: ['0', '1', '0', '0'].),\n  (dual_carrier:text, Code assigned to the dual carrier. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (time_elapsed:bigint, Total time elapsed during the flight in seconds. Value examples: ['3700', '15000', '4000', '3700'].),\n]\n# Table: flight_fare\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3', '4'].),\n  (fare_id:bigint, Unique identifier for each fare. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: flight_leg\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3'].),\n  (leg_number:bigint, The sequence number of the leg within the flight. Value examples: ['1', '1', '1'].),\n  (leg_flight:bigint, The flight ID of the leg's corresponding flight. Value examples: ['1', '2', '3'].),\n]\n# Table: flight_stop\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['2', '4'].),\n  (stop_number:bigint, The order of the stop in the flight. Value examples: ['1', '1'].),\n  (stop_days:text, Days of the week on which the flight stops at this airport. Value examples: ['2', '4'].),\n  (stop_airport:text, The 3-letter airport code of the stop. Value examples: ['DFW', 'DEN'].),\n  (arrival_time:bigint, The time at which the flight arrives at this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577847600', '1577862000'].),\n  (arrival_airline:text, The airline code of the arriving flight. Value examples: ['UA', 'WN'].),\n  (arrival_flight_number:text, Flight number of the arriving flight at this stop. Value examples: ['UA456', 'WN012'].),\n  (departure_time:bigint, The time at which the flight departs from this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577865600'].),\n  (departure_airline:text, The airline code of the departing flight. Value examples: ['UA', 'WN'].),\n  (departure_flight_number:text, Flight number of the departing flight from this stop. Value examples: ['UA456', 'WN012'].),\n  (stop_time:bigint, The duration of the stop at this airport. Value examples: ['3600', '3600'].),\n]\n# Table: food_service\n[\n  (meal_code:text, Code assigned to each meal type. Value examples: ['BF', 'LN'].),\n  (meal_number:bigint, Unique identifier for each meal served. Value examples: ['1', '2'].),\n  (compartment:text, The compartment in which the meal is served (e.g. 'First Class', 'Economy'). Value examples: ['First Class', 'First Class'].),\n  (meal_description:text, One of 'Breakfast', 'Lunch', 'Dinner'. Value examples: ['Breakfast', 'Lunch'].),\n]\n# Table: ground_service\n[\n  (city_code:text, The code for the city where the ground service is provided. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The 3-letter code for the airport where the ground service is provided. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (transport_type:text, The type of ground transportation provided. Value examples: ['Taxi', 'Shuttle', 'Bus', 'Car Rental'].),\n  (ground_fare:bigint, The fare charged for ground transportation. Value examples: ['50', '40', '30', '60'].),\n]\n# Table: month\n[\n  (month_number:bigint, A unique number assigned to each month of the year.. Value examples: ['1', '2', '3', '4'].),\n  (month_name:text, The name of the month, e.g. January, February, etc.. Value examples: ['January', 'February', 'March', 'April'].),\n]\n# Table: restriction\n[\n  (restriction_code:text, A code representing the type of restriction, such as blackout dates or minimum stay.. Value examples: ['NONE', 'NONE', 'NONE', 'NONE'].),\n  (advance_purchase:bigint, The number of days in advance the fare must be purchased.. Value examples: ['14', '14', '14', '14'].),\n  (stopovers:text, The number of stopovers allowed for the fare.. Value examples: ['2', '2', '2', '2'].),\n  (saturday_stay_required:text, Indicates whether a Saturday night stay is required for the fare. Either 'Yes' or 'No'.. Value examples: ['No', 'No', 'No', 'No'].),\n  (minimum_stay:bigint, The minimum length of stay required for the fare.. Value examples: ['7', '7', '7', '7'].),\n  (maximum_stay:bigint, The maximum length of stay allowed for the fare.. Value examples: ['30', '30', '30', '30'].),\n  (application:text, The type of fare application. Either 'One Way' or 'Round Trip'.. Value examples: ['One-Way', 'One-Way', 'One-Way', 'One-Way'].),\n  (no_discounts:text, Indicates whether the fare is eligible for discounts or promotions. Either 'Yes' or 'No'.. Value examples: ['Yes', 'Yes', 'Yes', 'Yes'].),\n]\n# Table: state\n[\n  (state_code:text, The 2-letter code assigned to the state. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA'].),\n  (state_name:text, The name of the state. Value examples: ['New York', 'California'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States'].),\n]\n# Table: time_interval\n[\n  (period:text, The period of the time interval, represented as a string. For example, 'daily', 'weekly', 'monthly', etc.. Value examples: ['daily', 'daily', 'daily'].),\n  (begin_time:bigint, The beginning time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577836800', '1577844000', '1577851200'].),\n  (end_time:bigint, The end time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577840400', '1577847600', '1577854800'].),\n]\n# Table: time_zone\n[\n  (time_zone_code:text, A short code that represents the time zone. For example, 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['PST', 'MST'].),\n  (time_zone_name:text, The name of the time zone. Value examples: ['Pacific Standard Time', 'Mountain Standard Time'].),\n  (hours_from_gmt:bigint, The number of hours that the time zone is ahead or behind Greenwich Mean Time (GMT). Value examples: ['-8', '-7'].),\n]\n\n【Foreign keys】\nairline.airline_code = flight.airline_code\nairline.airline_code = flight_stop.departure_airline\nairport.airport_code = fare.from_airport\nairport.airport_code = flight_stop.stop_airport\nairport_service.city_code = ground_service.city_code\nairport.state_code = city.state_code\nairport.state_code = state.state_code\ncity.state_code = state.state_code\nairport_service.city_code = city.city_code\nground_service.city_code = city.city_code\nairport.time_zone_code = time_zone.time_zone_code\ncity.time_zone_code = time_zone.time_zone_code\nflight.flight_id = flight_fare.flight_id\nflight.flight_id = flight_leg.flight_id\nflight.flight_id = flight_stop.flight_id\nflight_fare.flight_id = flight_leg.flight_id\nflight_fare.flight_id = flight_stop.flight_id\nflight_leg.flight_id = flight_stop.flight_id\naircraft.aircraft_code = equipment_sequence.aircraft_code\nflight.aircraft_code_sequence = equipment_sequence.aircraft_code_sequence\nflight.meal_code = food_service.meal_code\n\n【参考信息】\n\n\n【用户问题】\nWhat is the average cost of round-trip fares from Los Angeles (LAX) to Chicago (ORD) for each airline, sorted in descending order by average cost?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT fare.fare_airline, AVG(fare.round_trip_cost) AS average_cost FROM fare WHERE fare.from_airport = 'LAX' AND fare.to_airport = 'ORD' GROUP BY fare.fare_airline ORDER BY average_cost DESC NULLS LAST;SELECT airline.airline_name, AVG(fare.round_trip_cost) AS avg_round_trip_cost FROM fare JOIN airline ON fare.fare_airline = airline.airline_code WHERE fare.from_airport = 'LAX' AND fare.to_airport = 'ORD' GROUP BY airline.airline_name ORDER BY avg_round_trip_cost DESC;",
        "role": "assistant"
      }
    ],
    "db_name": "atis",
    "id": 66,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the average cost of a one-way trip for each airport pair in the fare table?\n\n【数据库schema】\n【DB_ID】 atis\n【Schema】\n# Table: aircraft\n[\n  (aircraft_code:text, The code assigned to the aircraft by the International Air Transport Association (IATA).. Value examples: ['B747', 'A320'].),\n  (aircraft_description:text, A short description of the aircraft.. Value examples: ['The Boeing 747 is a wide-body airliner.', 'The Airbus A320 is a narrow-body airliner.'].),\n  (manufacturer:text, The name of the manufacturer of the aircraft.. Value examples: ['Boeing', 'Airbus'].),\n  (basic_type:text, The basic type of the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (engines:bigint, The number of engines the aircraft has.. Value examples: ['4', '2'].),\n  (propulsion:text, The type of propulsion used by the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (wide_body:text, Indicates whether the aircraft is a wide body or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'No'].),\n  (wing_span:bigint, The distance between the tips of the aircraft's wings in feet.. Value examples: ['224', '111'].),\n  (length:bigint, The length of the aircraft in feet.. Value examples: ['231', '123'].),\n  (weight:bigint, The weight of the aircraft in pounds.. Value examples: ['987000', '162000'].),\n  (capacity:bigint, The maximum number of passengers the aircraft can carry.. Value examples: ['416', '240'].),\n  (pay_load:bigint, The maximum weight of cargo the aircraft can carry.. Value examples: ['60000', '30000'].),\n  (cruising_speed:bigint, The speed at which the aircraft cruises in miles per hour.. Value examples: ['570', '511'].),\n  (range_miles:bigint, The maximum distance the aircraft can fly in miles.. Value examples: ['8555', '3300'].),\n  (pressurized:text, Indicates whether the aircraft is pressurized or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'Yes'].),\n]\n# Table: airline\n[\n  (airline_code:text, The code assigned to the airline. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (airline_name:text, The name of the airline. Value examples: ['American Airlines', 'United Airlines', 'Delta Air Lines', 'Southwest Airlines'].),\n  (note:text, Any additional notes or comments about the airline. Value examples: ['NULL', 'NULL', 'NULL', 'NULL'].),\n]\n# Table: airport\n[\n  (airport_code:text, The code assigned to the airport.. Value examples: ['JFK', 'LAX', 'ORD', 'DFW'].),\n  (airport_name:text, The name of the airport.. Value examples: ['John F. Kennedy International Airport', 'Los Angeles International Airport', 'O’Hare International Airport', 'Dallas/Fort Worth International Airport'].),\n  (airport_location:text, The location of the airport, eg 'Las Vegas', 'Chicago'. Value examples: ['New York City', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The code assigned to the state where the airport is located.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the airport is located.. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the airport is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n  (minimum_connect_time:bigint, The minimum amount of time required for a connecting flight at the airport.. Value examples: ['23', '20', '24', '40'].),\n]\n# Table: airport_service\n[\n  (city_code:text, The code of the city where the airport is located. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The code of the airport. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (miles_distant:bigint, The distance of the airport from the city in miles. Value examples: ['10', '20', '30', '40'].),\n  (direction:text, The direction of the airport from the city. Either 'North', 'South', 'East', 'West', 'Northeast', 'Northwest', 'Southeast', or 'Southwest'.. Value examples: ['North', 'South', 'East', 'West'].),\n  (minutes_distant:bigint, The distance of the airport from the city in minutes. Value examples: ['20', '40', '60', '80'].),\n]\n# Table: city\n[\n  (city_code:text, The code assigned to the city. Value examples: ['NYC', 'LA', 'CHI', 'DA'].),\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The 2-letter code assigned to the state where the city is located. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the city is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n]\n# Table: class_of_service\n[\n  (booking_class:text, The booking class code for the class of service. Value examples: ['First', 'Business', 'Economy'].),\n  (rank:bigint, The rank of the class of service. Value examples: ['1', '2', '3'].),\n  (class_description:text, A brief description of the class of service. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: code_description\n[\n  (code:text, The code column contains a unique identifier for each record in the table.. Value examples: ['ABC', 'DEF'].),\n  (description:text, The description column contains a textual description of the code.. Value examples: ['Code ABC', 'Code DEF'].),\n]\n# Table: compartment_class\n[\n  (compartment:text, The compartment column contains the name of a compartment. Either 'First', 'Business', or 'Economy'.. Value examples: ['First', 'Business', 'Economy'].),\n  (class_type:text, The class_type column contains the type of a class. Either 'First Class', 'Business Class', or 'Economy Class'.. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: days\n[\n  (days_code:text, A code representing a day of the week. Value examples: ['1', '2'].),\n  (day_name:text, The name of a day of the week. Either 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', or 'Sunday'.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: dual_carrier\n[\n  (main_airline:text, The name of the main airline operating the flight. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (low_flight_number:bigint, The lowest flight number in the range of flights operated by the dual carrier. Value examples: ['1', '11', '21', '31'].),\n  (high_flight_number:bigint, The highest flight number in the range of flights operated by the dual carrier. Value examples: ['10', '20', '30', '40'].),\n  (dual_airline:text, The name of the dual airline operating the flight. Value examples: ['VX', 'DL', 'UA', 'AS'].),\n  (service_name:text, The name of the service provided by the dual carrier on the flight. Value examples: ['Dual Service 1', 'Dual Service 2', 'Dual Service 3', 'Dual Service 4'].),\n]\n# Table: equipment_sequence\n[\n  (aircraft_code_sequence:text, Sequence number for each aircraft code. Value examples: ['1', '2', '3', '4'].),\n  (aircraft_code:text, Code for each aircraft. Value examples: ['B747', 'A320', 'B737', 'A380'].),\n]\n# Table: fare\n[\n  (fare_id:bigint, The unique identifier for this fare. Value examples: ['1', '2'].),\n  (from_airport:text, The 3-letter airport code for the departure location. Value examples: ['ORD', 'ORD'].),\n  (to_airport:text, The 3-letter airport code for the arrival location. Value examples: ['JFK', 'JFK'].),\n  (fare_basis_code:text, The code used to determine the fare's pricing rules. Value examples: ['ABC', 'DEF'].),\n  (fare_airline:text, The airline code associated with this fare. Value examples: ['AA', 'UA'].),\n  (restriction_code:text, Any restrictions or limitations associated with this fare. Value examples: ['NONE', 'NONE'].),\n  (one_direction_cost:bigint, The cost of a one-way trip for this fare. Value examples: ['200', '150'].),\n  (round_trip_cost:bigint, The cost of a round-trip for this fare. Value examples: ['300', '280'].),\n  (round_trip_required:text, Indicates whether a round-trip is required to purchase this fare. Either Yes or No.. Value examples: ['Yes', 'No'].),\n]\n# Table: fare_basis\n[\n  (fare_basis_code:text, The code that identifies the fare basis. Value examples: ['ABC', 'DEF', 'GHI', 'JKL'].),\n  (booking_class:text, The booking class associated with the fare basis. Either 'First', 'Business', or 'Economy'. Value examples: ['First', 'Business', 'Economy', 'First'].),\n  (class_type:text, The class type associated with the fare basis. Either 'First Class', 'Business Class', or 'Economy Class'. Value examples: ['First Class', 'Business Class', 'Economy Class', 'First Class'].),\n  (premium:text, Indicates whether the fare basis is for a premium class. Value examples: ['Yes', 'Yes', 'No', 'Yes'].),\n  (economy:text, Indicates whether the fare basis is for an economy class. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (discounted:text, Indicates whether the fare basis is for a discounted fare. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (night:text, Indicates whether the fare basis is for a night fare. Value examples: ['No', 'No', 'No', 'No'].),\n  (season:text, The season associated with the fare basis. Can only be 'Peak' or 'Regular'. Value examples: ['Regular', 'Regular', 'Regular', 'Regular'].),\n  (basis_days:text, The number of days the fare basis is valid for. Value examples: ['30', '30', '30', '30'].),\n]\n# Table: flight\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['3', '4', '5', '7'].),\n  (flight_days:text, Days of the week the flight operates on. Formatted as comma-delimited 3-letter abbreviations, e.g. `mon,tue,wed` or `tues,thurs`. Value examples: ['wed', 'thu', 'fri', 'sun'].),\n  (from_airport:text, Code assigned to the departure airport. Value examples: ['ORD', 'ORD', 'ORD', 'JFK'].),\n  (to_airport:text, Code assigned to the arrival airport. Value examples: ['JFK', 'JFK', 'LAX', 'ORD'].),\n  (departure_time:bigint, Epoch timestamp for departure time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577858400', '1577865600', '1577880000'].),\n  (arrival_time:bigint, Epoch timestamp for arrival time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577854900', '1577873400', '1577869600', '1577883700'].),\n  (airline_flight:text, Code assigned to the airline flight. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (airline_code:text, Code assigned to the airline. Value examples: ['AA', 'WN', 'AS', 'UA'].),\n  (flight_number:text, Flight number assigned by the airline. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (aircraft_code_sequence:text, Code assigned to the aircraft. Value examples: ['3', '4', '5', '7'].),\n  (meal_code:text, Code assigned to the meal provided during the flight. Value examples: ['DN', 'BS', 'BF', 'DN'].),\n  (stops:bigint, Number of stops during the flight. Value examples: ['0', '1', '0', '0'].),\n  (connections:bigint, Number of connections during the flight. Value examples: ['0', '1', '0', '0'].),\n  (dual_carrier:text, Code assigned to the dual carrier. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (time_elapsed:bigint, Total time elapsed during the flight in seconds. Value examples: ['3700', '15000', '4000', '3700'].),\n]\n# Table: flight_fare\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3', '4'].),\n  (fare_id:bigint, Unique identifier for each fare. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: flight_leg\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3'].),\n  (leg_number:bigint, The sequence number of the leg within the flight. Value examples: ['1', '1', '1'].),\n  (leg_flight:bigint, The flight ID of the leg's corresponding flight. Value examples: ['1', '2', '3'].),\n]\n# Table: flight_stop\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['2', '4'].),\n  (stop_number:bigint, The order of the stop in the flight. Value examples: ['1', '1'].),\n  (stop_days:text, Days of the week on which the flight stops at this airport. Value examples: ['2', '4'].),\n  (stop_airport:text, The 3-letter airport code of the stop. Value examples: ['DFW', 'DEN'].),\n  (arrival_time:bigint, The time at which the flight arrives at this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577847600', '1577862000'].),\n  (arrival_airline:text, The airline code of the arriving flight. Value examples: ['UA', 'WN'].),\n  (arrival_flight_number:text, Flight number of the arriving flight at this stop. Value examples: ['UA456', 'WN012'].),\n  (departure_time:bigint, The time at which the flight departs from this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577865600'].),\n  (departure_airline:text, The airline code of the departing flight. Value examples: ['UA', 'WN'].),\n  (departure_flight_number:text, Flight number of the departing flight from this stop. Value examples: ['UA456', 'WN012'].),\n  (stop_time:bigint, The duration of the stop at this airport. Value examples: ['3600', '3600'].),\n]\n# Table: food_service\n[\n  (meal_code:text, Code assigned to each meal type. Value examples: ['BF', 'LN'].),\n  (meal_number:bigint, Unique identifier for each meal served. Value examples: ['1', '2'].),\n  (compartment:text, The compartment in which the meal is served (e.g. 'First Class', 'Economy'). Value examples: ['First Class', 'First Class'].),\n  (meal_description:text, One of 'Breakfast', 'Lunch', 'Dinner'. Value examples: ['Breakfast', 'Lunch'].),\n]\n# Table: ground_service\n[\n  (city_code:text, The code for the city where the ground service is provided. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The 3-letter code for the airport where the ground service is provided. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (transport_type:text, The type of ground transportation provided. Value examples: ['Taxi', 'Shuttle', 'Bus', 'Car Rental'].),\n  (ground_fare:bigint, The fare charged for ground transportation. Value examples: ['50', '40', '30', '60'].),\n]\n# Table: month\n[\n  (month_number:bigint, A unique number assigned to each month of the year.. Value examples: ['1', '2', '3', '4'].),\n  (month_name:text, The name of the month, e.g. January, February, etc.. Value examples: ['January', 'February', 'March', 'April'].),\n]\n# Table: restriction\n[\n  (restriction_code:text, A code representing the type of restriction, such as blackout dates or minimum stay.. Value examples: ['NONE', 'NONE', 'NONE', 'NONE'].),\n  (advance_purchase:bigint, The number of days in advance the fare must be purchased.. Value examples: ['14', '14', '14', '14'].),\n  (stopovers:text, The number of stopovers allowed for the fare.. Value examples: ['2', '2', '2', '2'].),\n  (saturday_stay_required:text, Indicates whether a Saturday night stay is required for the fare. Either 'Yes' or 'No'.. Value examples: ['No', 'No', 'No', 'No'].),\n  (minimum_stay:bigint, The minimum length of stay required for the fare.. Value examples: ['7', '7', '7', '7'].),\n  (maximum_stay:bigint, The maximum length of stay allowed for the fare.. Value examples: ['30', '30', '30', '30'].),\n  (application:text, The type of fare application. Either 'One Way' or 'Round Trip'.. Value examples: ['One-Way', 'One-Way', 'One-Way', 'One-Way'].),\n  (no_discounts:text, Indicates whether the fare is eligible for discounts or promotions. Either 'Yes' or 'No'.. Value examples: ['Yes', 'Yes', 'Yes', 'Yes'].),\n]\n# Table: state\n[\n  (state_code:text, The 2-letter code assigned to the state. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA'].),\n  (state_name:text, The name of the state. Value examples: ['New York', 'California'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States'].),\n]\n# Table: time_interval\n[\n  (period:text, The period of the time interval, represented as a string. For example, 'daily', 'weekly', 'monthly', etc.. Value examples: ['daily', 'daily', 'daily'].),\n  (begin_time:bigint, The beginning time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577836800', '1577844000', '1577851200'].),\n  (end_time:bigint, The end time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577840400', '1577847600', '1577854800'].),\n]\n# Table: time_zone\n[\n  (time_zone_code:text, A short code that represents the time zone. For example, 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['PST', 'MST'].),\n  (time_zone_name:text, The name of the time zone. Value examples: ['Pacific Standard Time', 'Mountain Standard Time'].),\n  (hours_from_gmt:bigint, The number of hours that the time zone is ahead or behind Greenwich Mean Time (GMT). Value examples: ['-8', '-7'].),\n]\n\n【Foreign keys】\nairline.airline_code = flight.airline_code\nairline.airline_code = flight_stop.departure_airline\nairport.airport_code = fare.from_airport\nairport.airport_code = flight_stop.stop_airport\nairport_service.city_code = ground_service.city_code\nairport.state_code = city.state_code\nairport.state_code = state.state_code\ncity.state_code = state.state_code\nairport_service.city_code = city.city_code\nground_service.city_code = city.city_code\nairport.time_zone_code = time_zone.time_zone_code\ncity.time_zone_code = time_zone.time_zone_code\nflight.flight_id = flight_fare.flight_id\nflight.flight_id = flight_leg.flight_id\nflight.flight_id = flight_stop.flight_id\nflight_fare.flight_id = flight_leg.flight_id\nflight_fare.flight_id = flight_stop.flight_id\nflight_leg.flight_id = flight_stop.flight_id\naircraft.aircraft_code = equipment_sequence.aircraft_code\nflight.aircraft_code_sequence = equipment_sequence.aircraft_code_sequence\nflight.meal_code = food_service.meal_code\n\n【参考信息】\n\n\n【用户问题】\nWhat is the average cost of a one-way trip for each airport pair in the fare table?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT f.from_airport, f.to_airport, AVG(f.one_direction_cost) AS average_cost FROM fare f GROUP BY f.from_airport, f.to_airport ORDER BY f.from_airport, f.to_airport NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "atis",
    "id": 67,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many meals are served in each compartment, sorted by the number of meals in descending order?\n\n【数据库schema】\n【DB_ID】 atis\n【Schema】\n# Table: aircraft\n[\n  (aircraft_code:text, The code assigned to the aircraft by the International Air Transport Association (IATA).. Value examples: ['B747', 'A320'].),\n  (aircraft_description:text, A short description of the aircraft.. Value examples: ['The Boeing 747 is a wide-body airliner.', 'The Airbus A320 is a narrow-body airliner.'].),\n  (manufacturer:text, The name of the manufacturer of the aircraft.. Value examples: ['Boeing', 'Airbus'].),\n  (basic_type:text, The basic type of the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (engines:bigint, The number of engines the aircraft has.. Value examples: ['4', '2'].),\n  (propulsion:text, The type of propulsion used by the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (wide_body:text, Indicates whether the aircraft is a wide body or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'No'].),\n  (wing_span:bigint, The distance between the tips of the aircraft's wings in feet.. Value examples: ['224', '111'].),\n  (length:bigint, The length of the aircraft in feet.. Value examples: ['231', '123'].),\n  (weight:bigint, The weight of the aircraft in pounds.. Value examples: ['987000', '162000'].),\n  (capacity:bigint, The maximum number of passengers the aircraft can carry.. Value examples: ['416', '240'].),\n  (pay_load:bigint, The maximum weight of cargo the aircraft can carry.. Value examples: ['60000', '30000'].),\n  (cruising_speed:bigint, The speed at which the aircraft cruises in miles per hour.. Value examples: ['570', '511'].),\n  (range_miles:bigint, The maximum distance the aircraft can fly in miles.. Value examples: ['8555', '3300'].),\n  (pressurized:text, Indicates whether the aircraft is pressurized or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'Yes'].),\n]\n# Table: airline\n[\n  (airline_code:text, The code assigned to the airline. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (airline_name:text, The name of the airline. Value examples: ['American Airlines', 'United Airlines', 'Delta Air Lines', 'Southwest Airlines'].),\n  (note:text, Any additional notes or comments about the airline. Value examples: ['NULL', 'NULL', 'NULL', 'NULL'].),\n]\n# Table: airport\n[\n  (airport_code:text, The code assigned to the airport.. Value examples: ['JFK', 'LAX', 'ORD', 'DFW'].),\n  (airport_name:text, The name of the airport.. Value examples: ['John F. Kennedy International Airport', 'Los Angeles International Airport', 'O’Hare International Airport', 'Dallas/Fort Worth International Airport'].),\n  (airport_location:text, The location of the airport, eg 'Las Vegas', 'Chicago'. Value examples: ['New York City', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The code assigned to the state where the airport is located.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the airport is located.. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the airport is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n  (minimum_connect_time:bigint, The minimum amount of time required for a connecting flight at the airport.. Value examples: ['23', '20', '24', '40'].),\n]\n# Table: airport_service\n[\n  (city_code:text, The code of the city where the airport is located. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The code of the airport. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (miles_distant:bigint, The distance of the airport from the city in miles. Value examples: ['10', '20', '30', '40'].),\n  (direction:text, The direction of the airport from the city. Either 'North', 'South', 'East', 'West', 'Northeast', 'Northwest', 'Southeast', or 'Southwest'.. Value examples: ['North', 'South', 'East', 'West'].),\n  (minutes_distant:bigint, The distance of the airport from the city in minutes. Value examples: ['20', '40', '60', '80'].),\n]\n# Table: city\n[\n  (city_code:text, The code assigned to the city. Value examples: ['NYC', 'LA', 'CHI', 'DA'].),\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The 2-letter code assigned to the state where the city is located. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the city is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n]\n# Table: class_of_service\n[\n  (booking_class:text, The booking class code for the class of service. Value examples: ['First', 'Business', 'Economy'].),\n  (rank:bigint, The rank of the class of service. Value examples: ['1', '2', '3'].),\n  (class_description:text, A brief description of the class of service. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: code_description\n[\n  (code:text, The code column contains a unique identifier for each record in the table.. Value examples: ['ABC', 'DEF'].),\n  (description:text, The description column contains a textual description of the code.. Value examples: ['Code ABC', 'Code DEF'].),\n]\n# Table: compartment_class\n[\n  (compartment:text, The compartment column contains the name of a compartment. Either 'First', 'Business', or 'Economy'.. Value examples: ['First', 'Business', 'Economy'].),\n  (class_type:text, The class_type column contains the type of a class. Either 'First Class', 'Business Class', or 'Economy Class'.. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: days\n[\n  (days_code:text, A code representing a day of the week. Value examples: ['1', '2'].),\n  (day_name:text, The name of a day of the week. Either 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', or 'Sunday'.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: dual_carrier\n[\n  (main_airline:text, The name of the main airline operating the flight. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (low_flight_number:bigint, The lowest flight number in the range of flights operated by the dual carrier. Value examples: ['1', '11', '21', '31'].),\n  (high_flight_number:bigint, The highest flight number in the range of flights operated by the dual carrier. Value examples: ['10', '20', '30', '40'].),\n  (dual_airline:text, The name of the dual airline operating the flight. Value examples: ['VX', 'DL', 'UA', 'AS'].),\n  (service_name:text, The name of the service provided by the dual carrier on the flight. Value examples: ['Dual Service 1', 'Dual Service 2', 'Dual Service 3', 'Dual Service 4'].),\n]\n# Table: equipment_sequence\n[\n  (aircraft_code_sequence:text, Sequence number for each aircraft code. Value examples: ['1', '2', '3', '4'].),\n  (aircraft_code:text, Code for each aircraft. Value examples: ['B747', 'A320', 'B737', 'A380'].),\n]\n# Table: fare\n[\n  (fare_id:bigint, The unique identifier for this fare. Value examples: ['1', '2'].),\n  (from_airport:text, The 3-letter airport code for the departure location. Value examples: ['ORD', 'ORD'].),\n  (to_airport:text, The 3-letter airport code for the arrival location. Value examples: ['JFK', 'JFK'].),\n  (fare_basis_code:text, The code used to determine the fare's pricing rules. Value examples: ['ABC', 'DEF'].),\n  (fare_airline:text, The airline code associated with this fare. Value examples: ['AA', 'UA'].),\n  (restriction_code:text, Any restrictions or limitations associated with this fare. Value examples: ['NONE', 'NONE'].),\n  (one_direction_cost:bigint, The cost of a one-way trip for this fare. Value examples: ['200', '150'].),\n  (round_trip_cost:bigint, The cost of a round-trip for this fare. Value examples: ['300', '280'].),\n  (round_trip_required:text, Indicates whether a round-trip is required to purchase this fare. Either Yes or No.. Value examples: ['Yes', 'No'].),\n]\n# Table: fare_basis\n[\n  (fare_basis_code:text, The code that identifies the fare basis. Value examples: ['ABC', 'DEF', 'GHI', 'JKL'].),\n  (booking_class:text, The booking class associated with the fare basis. Either 'First', 'Business', or 'Economy'. Value examples: ['First', 'Business', 'Economy', 'First'].),\n  (class_type:text, The class type associated with the fare basis. Either 'First Class', 'Business Class', or 'Economy Class'. Value examples: ['First Class', 'Business Class', 'Economy Class', 'First Class'].),\n  (premium:text, Indicates whether the fare basis is for a premium class. Value examples: ['Yes', 'Yes', 'No', 'Yes'].),\n  (economy:text, Indicates whether the fare basis is for an economy class. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (discounted:text, Indicates whether the fare basis is for a discounted fare. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (night:text, Indicates whether the fare basis is for a night fare. Value examples: ['No', 'No', 'No', 'No'].),\n  (season:text, The season associated with the fare basis. Can only be 'Peak' or 'Regular'. Value examples: ['Regular', 'Regular', 'Regular', 'Regular'].),\n  (basis_days:text, The number of days the fare basis is valid for. Value examples: ['30', '30', '30', '30'].),\n]\n# Table: flight\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['3', '4', '5', '7'].),\n  (flight_days:text, Days of the week the flight operates on. Formatted as comma-delimited 3-letter abbreviations, e.g. `mon,tue,wed` or `tues,thurs`. Value examples: ['wed', 'thu', 'fri', 'sun'].),\n  (from_airport:text, Code assigned to the departure airport. Value examples: ['ORD', 'ORD', 'ORD', 'JFK'].),\n  (to_airport:text, Code assigned to the arrival airport. Value examples: ['JFK', 'JFK', 'LAX', 'ORD'].),\n  (departure_time:bigint, Epoch timestamp for departure time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577858400', '1577865600', '1577880000'].),\n  (arrival_time:bigint, Epoch timestamp for arrival time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577854900', '1577873400', '1577869600', '1577883700'].),\n  (airline_flight:text, Code assigned to the airline flight. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (airline_code:text, Code assigned to the airline. Value examples: ['AA', 'WN', 'AS', 'UA'].),\n  (flight_number:text, Flight number assigned by the airline. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (aircraft_code_sequence:text, Code assigned to the aircraft. Value examples: ['3', '4', '5', '7'].),\n  (meal_code:text, Code assigned to the meal provided during the flight. Value examples: ['DN', 'BS', 'BF', 'DN'].),\n  (stops:bigint, Number of stops during the flight. Value examples: ['0', '1', '0', '0'].),\n  (connections:bigint, Number of connections during the flight. Value examples: ['0', '1', '0', '0'].),\n  (dual_carrier:text, Code assigned to the dual carrier. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (time_elapsed:bigint, Total time elapsed during the flight in seconds. Value examples: ['3700', '15000', '4000', '3700'].),\n]\n# Table: flight_fare\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3', '4'].),\n  (fare_id:bigint, Unique identifier for each fare. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: flight_leg\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3'].),\n  (leg_number:bigint, The sequence number of the leg within the flight. Value examples: ['1', '1', '1'].),\n  (leg_flight:bigint, The flight ID of the leg's corresponding flight. Value examples: ['1', '2', '3'].),\n]\n# Table: flight_stop\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['2', '4'].),\n  (stop_number:bigint, The order of the stop in the flight. Value examples: ['1', '1'].),\n  (stop_days:text, Days of the week on which the flight stops at this airport. Value examples: ['2', '4'].),\n  (stop_airport:text, The 3-letter airport code of the stop. Value examples: ['DFW', 'DEN'].),\n  (arrival_time:bigint, The time at which the flight arrives at this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577847600', '1577862000'].),\n  (arrival_airline:text, The airline code of the arriving flight. Value examples: ['UA', 'WN'].),\n  (arrival_flight_number:text, Flight number of the arriving flight at this stop. Value examples: ['UA456', 'WN012'].),\n  (departure_time:bigint, The time at which the flight departs from this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577865600'].),\n  (departure_airline:text, The airline code of the departing flight. Value examples: ['UA', 'WN'].),\n  (departure_flight_number:text, Flight number of the departing flight from this stop. Value examples: ['UA456', 'WN012'].),\n  (stop_time:bigint, The duration of the stop at this airport. Value examples: ['3600', '3600'].),\n]\n# Table: food_service\n[\n  (meal_code:text, Code assigned to each meal type. Value examples: ['BF', 'LN'].),\n  (meal_number:bigint, Unique identifier for each meal served. Value examples: ['1', '2'].),\n  (compartment:text, The compartment in which the meal is served (e.g. 'First Class', 'Economy'). Value examples: ['First Class', 'First Class'].),\n  (meal_description:text, One of 'Breakfast', 'Lunch', 'Dinner'. Value examples: ['Breakfast', 'Lunch'].),\n]\n# Table: ground_service\n[\n  (city_code:text, The code for the city where the ground service is provided. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The 3-letter code for the airport where the ground service is provided. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (transport_type:text, The type of ground transportation provided. Value examples: ['Taxi', 'Shuttle', 'Bus', 'Car Rental'].),\n  (ground_fare:bigint, The fare charged for ground transportation. Value examples: ['50', '40', '30', '60'].),\n]\n# Table: month\n[\n  (month_number:bigint, A unique number assigned to each month of the year.. Value examples: ['1', '2', '3', '4'].),\n  (month_name:text, The name of the month, e.g. January, February, etc.. Value examples: ['January', 'February', 'March', 'April'].),\n]\n# Table: restriction\n[\n  (restriction_code:text, A code representing the type of restriction, such as blackout dates or minimum stay.. Value examples: ['NONE', 'NONE', 'NONE', 'NONE'].),\n  (advance_purchase:bigint, The number of days in advance the fare must be purchased.. Value examples: ['14', '14', '14', '14'].),\n  (stopovers:text, The number of stopovers allowed for the fare.. Value examples: ['2', '2', '2', '2'].),\n  (saturday_stay_required:text, Indicates whether a Saturday night stay is required for the fare. Either 'Yes' or 'No'.. Value examples: ['No', 'No', 'No', 'No'].),\n  (minimum_stay:bigint, The minimum length of stay required for the fare.. Value examples: ['7', '7', '7', '7'].),\n  (maximum_stay:bigint, The maximum length of stay allowed for the fare.. Value examples: ['30', '30', '30', '30'].),\n  (application:text, The type of fare application. Either 'One Way' or 'Round Trip'.. Value examples: ['One-Way', 'One-Way', 'One-Way', 'One-Way'].),\n  (no_discounts:text, Indicates whether the fare is eligible for discounts or promotions. Either 'Yes' or 'No'.. Value examples: ['Yes', 'Yes', 'Yes', 'Yes'].),\n]\n# Table: state\n[\n  (state_code:text, The 2-letter code assigned to the state. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA'].),\n  (state_name:text, The name of the state. Value examples: ['New York', 'California'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States'].),\n]\n# Table: time_interval\n[\n  (period:text, The period of the time interval, represented as a string. For example, 'daily', 'weekly', 'monthly', etc.. Value examples: ['daily', 'daily', 'daily'].),\n  (begin_time:bigint, The beginning time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577836800', '1577844000', '1577851200'].),\n  (end_time:bigint, The end time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577840400', '1577847600', '1577854800'].),\n]\n# Table: time_zone\n[\n  (time_zone_code:text, A short code that represents the time zone. For example, 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['PST', 'MST'].),\n  (time_zone_name:text, The name of the time zone. Value examples: ['Pacific Standard Time', 'Mountain Standard Time'].),\n  (hours_from_gmt:bigint, The number of hours that the time zone is ahead or behind Greenwich Mean Time (GMT). Value examples: ['-8', '-7'].),\n]\n\n【Foreign keys】\nairline.airline_code = flight.airline_code\nairline.airline_code = flight_stop.departure_airline\nairport.airport_code = fare.from_airport\nairport.airport_code = flight_stop.stop_airport\nairport_service.city_code = ground_service.city_code\nairport.state_code = city.state_code\nairport.state_code = state.state_code\ncity.state_code = state.state_code\nairport_service.city_code = city.city_code\nground_service.city_code = city.city_code\nairport.time_zone_code = time_zone.time_zone_code\ncity.time_zone_code = time_zone.time_zone_code\nflight.flight_id = flight_fare.flight_id\nflight.flight_id = flight_leg.flight_id\nflight.flight_id = flight_stop.flight_id\nflight_fare.flight_id = flight_leg.flight_id\nflight_fare.flight_id = flight_stop.flight_id\nflight_leg.flight_id = flight_stop.flight_id\naircraft.aircraft_code = equipment_sequence.aircraft_code\nflight.aircraft_code_sequence = equipment_sequence.aircraft_code_sequence\nflight.meal_code = food_service.meal_code\n\n【参考信息】\n\n\n【用户问题】\nHow many meals are served in each compartment, sorted by the number of meals in descending order?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT food_service.compartment, COUNT(food_service.meal_number) AS number_of_meals FROM food_service GROUP BY food_service.compartment ORDER BY number_of_meals DESC NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "atis",
    "id": 68,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many flights depart from each airport code, excluding departures with connections?\n\n【数据库schema】\n【DB_ID】 atis\n【Schema】\n# Table: aircraft\n[\n  (aircraft_code:text, The code assigned to the aircraft by the International Air Transport Association (IATA).. Value examples: ['B747', 'A320'].),\n  (aircraft_description:text, A short description of the aircraft.. Value examples: ['The Boeing 747 is a wide-body airliner.', 'The Airbus A320 is a narrow-body airliner.'].),\n  (manufacturer:text, The name of the manufacturer of the aircraft.. Value examples: ['Boeing', 'Airbus'].),\n  (basic_type:text, The basic type of the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (engines:bigint, The number of engines the aircraft has.. Value examples: ['4', '2'].),\n  (propulsion:text, The type of propulsion used by the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (wide_body:text, Indicates whether the aircraft is a wide body or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'No'].),\n  (wing_span:bigint, The distance between the tips of the aircraft's wings in feet.. Value examples: ['224', '111'].),\n  (length:bigint, The length of the aircraft in feet.. Value examples: ['231', '123'].),\n  (weight:bigint, The weight of the aircraft in pounds.. Value examples: ['987000', '162000'].),\n  (capacity:bigint, The maximum number of passengers the aircraft can carry.. Value examples: ['416', '240'].),\n  (pay_load:bigint, The maximum weight of cargo the aircraft can carry.. Value examples: ['60000', '30000'].),\n  (cruising_speed:bigint, The speed at which the aircraft cruises in miles per hour.. Value examples: ['570', '511'].),\n  (range_miles:bigint, The maximum distance the aircraft can fly in miles.. Value examples: ['8555', '3300'].),\n  (pressurized:text, Indicates whether the aircraft is pressurized or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'Yes'].),\n]\n# Table: airline\n[\n  (airline_code:text, The code assigned to the airline. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (airline_name:text, The name of the airline. Value examples: ['American Airlines', 'United Airlines', 'Delta Air Lines', 'Southwest Airlines'].),\n  (note:text, Any additional notes or comments about the airline. Value examples: ['NULL', 'NULL', 'NULL', 'NULL'].),\n]\n# Table: airport\n[\n  (airport_code:text, The code assigned to the airport.. Value examples: ['JFK', 'LAX', 'ORD', 'DFW'].),\n  (airport_name:text, The name of the airport.. Value examples: ['John F. Kennedy International Airport', 'Los Angeles International Airport', 'O’Hare International Airport', 'Dallas/Fort Worth International Airport'].),\n  (airport_location:text, The location of the airport, eg 'Las Vegas', 'Chicago'. Value examples: ['New York City', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The code assigned to the state where the airport is located.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the airport is located.. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the airport is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n  (minimum_connect_time:bigint, The minimum amount of time required for a connecting flight at the airport.. Value examples: ['23', '20', '24', '40'].),\n]\n# Table: airport_service\n[\n  (city_code:text, The code of the city where the airport is located. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The code of the airport. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (miles_distant:bigint, The distance of the airport from the city in miles. Value examples: ['10', '20', '30', '40'].),\n  (direction:text, The direction of the airport from the city. Either 'North', 'South', 'East', 'West', 'Northeast', 'Northwest', 'Southeast', or 'Southwest'.. Value examples: ['North', 'South', 'East', 'West'].),\n  (minutes_distant:bigint, The distance of the airport from the city in minutes. Value examples: ['20', '40', '60', '80'].),\n]\n# Table: city\n[\n  (city_code:text, The code assigned to the city. Value examples: ['NYC', 'LA', 'CHI', 'DA'].),\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The 2-letter code assigned to the state where the city is located. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the city is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n]\n# Table: class_of_service\n[\n  (booking_class:text, The booking class code for the class of service. Value examples: ['First', 'Business', 'Economy'].),\n  (rank:bigint, The rank of the class of service. Value examples: ['1', '2', '3'].),\n  (class_description:text, A brief description of the class of service. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: code_description\n[\n  (code:text, The code column contains a unique identifier for each record in the table.. Value examples: ['ABC', 'DEF'].),\n  (description:text, The description column contains a textual description of the code.. Value examples: ['Code ABC', 'Code DEF'].),\n]\n# Table: compartment_class\n[\n  (compartment:text, The compartment column contains the name of a compartment. Either 'First', 'Business', or 'Economy'.. Value examples: ['First', 'Business', 'Economy'].),\n  (class_type:text, The class_type column contains the type of a class. Either 'First Class', 'Business Class', or 'Economy Class'.. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: days\n[\n  (days_code:text, A code representing a day of the week. Value examples: ['1', '2'].),\n  (day_name:text, The name of a day of the week. Either 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', or 'Sunday'.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: dual_carrier\n[\n  (main_airline:text, The name of the main airline operating the flight. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (low_flight_number:bigint, The lowest flight number in the range of flights operated by the dual carrier. Value examples: ['1', '11', '21', '31'].),\n  (high_flight_number:bigint, The highest flight number in the range of flights operated by the dual carrier. Value examples: ['10', '20', '30', '40'].),\n  (dual_airline:text, The name of the dual airline operating the flight. Value examples: ['VX', 'DL', 'UA', 'AS'].),\n  (service_name:text, The name of the service provided by the dual carrier on the flight. Value examples: ['Dual Service 1', 'Dual Service 2', 'Dual Service 3', 'Dual Service 4'].),\n]\n# Table: equipment_sequence\n[\n  (aircraft_code_sequence:text, Sequence number for each aircraft code. Value examples: ['1', '2', '3', '4'].),\n  (aircraft_code:text, Code for each aircraft. Value examples: ['B747', 'A320', 'B737', 'A380'].),\n]\n# Table: fare\n[\n  (fare_id:bigint, The unique identifier for this fare. Value examples: ['1', '2'].),\n  (from_airport:text, The 3-letter airport code for the departure location. Value examples: ['ORD', 'ORD'].),\n  (to_airport:text, The 3-letter airport code for the arrival location. Value examples: ['JFK', 'JFK'].),\n  (fare_basis_code:text, The code used to determine the fare's pricing rules. Value examples: ['ABC', 'DEF'].),\n  (fare_airline:text, The airline code associated with this fare. Value examples: ['AA', 'UA'].),\n  (restriction_code:text, Any restrictions or limitations associated with this fare. Value examples: ['NONE', 'NONE'].),\n  (one_direction_cost:bigint, The cost of a one-way trip for this fare. Value examples: ['200', '150'].),\n  (round_trip_cost:bigint, The cost of a round-trip for this fare. Value examples: ['300', '280'].),\n  (round_trip_required:text, Indicates whether a round-trip is required to purchase this fare. Either Yes or No.. Value examples: ['Yes', 'No'].),\n]\n# Table: fare_basis\n[\n  (fare_basis_code:text, The code that identifies the fare basis. Value examples: ['ABC', 'DEF', 'GHI', 'JKL'].),\n  (booking_class:text, The booking class associated with the fare basis. Either 'First', 'Business', or 'Economy'. Value examples: ['First', 'Business', 'Economy', 'First'].),\n  (class_type:text, The class type associated with the fare basis. Either 'First Class', 'Business Class', or 'Economy Class'. Value examples: ['First Class', 'Business Class', 'Economy Class', 'First Class'].),\n  (premium:text, Indicates whether the fare basis is for a premium class. Value examples: ['Yes', 'Yes', 'No', 'Yes'].),\n  (economy:text, Indicates whether the fare basis is for an economy class. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (discounted:text, Indicates whether the fare basis is for a discounted fare. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (night:text, Indicates whether the fare basis is for a night fare. Value examples: ['No', 'No', 'No', 'No'].),\n  (season:text, The season associated with the fare basis. Can only be 'Peak' or 'Regular'. Value examples: ['Regular', 'Regular', 'Regular', 'Regular'].),\n  (basis_days:text, The number of days the fare basis is valid for. Value examples: ['30', '30', '30', '30'].),\n]\n# Table: flight\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['3', '4', '5', '7'].),\n  (flight_days:text, Days of the week the flight operates on. Formatted as comma-delimited 3-letter abbreviations, e.g. `mon,tue,wed` or `tues,thurs`. Value examples: ['wed', 'thu', 'fri', 'sun'].),\n  (from_airport:text, Code assigned to the departure airport. Value examples: ['ORD', 'ORD', 'ORD', 'JFK'].),\n  (to_airport:text, Code assigned to the arrival airport. Value examples: ['JFK', 'JFK', 'LAX', 'ORD'].),\n  (departure_time:bigint, Epoch timestamp for departure time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577858400', '1577865600', '1577880000'].),\n  (arrival_time:bigint, Epoch timestamp for arrival time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577854900', '1577873400', '1577869600', '1577883700'].),\n  (airline_flight:text, Code assigned to the airline flight. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (airline_code:text, Code assigned to the airline. Value examples: ['AA', 'WN', 'AS', 'UA'].),\n  (flight_number:text, Flight number assigned by the airline. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (aircraft_code_sequence:text, Code assigned to the aircraft. Value examples: ['3', '4', '5', '7'].),\n  (meal_code:text, Code assigned to the meal provided during the flight. Value examples: ['DN', 'BS', 'BF', 'DN'].),\n  (stops:bigint, Number of stops during the flight. Value examples: ['0', '1', '0', '0'].),\n  (connections:bigint, Number of connections during the flight. Value examples: ['0', '1', '0', '0'].),\n  (dual_carrier:text, Code assigned to the dual carrier. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (time_elapsed:bigint, Total time elapsed during the flight in seconds. Value examples: ['3700', '15000', '4000', '3700'].),\n]\n# Table: flight_fare\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3', '4'].),\n  (fare_id:bigint, Unique identifier for each fare. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: flight_leg\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3'].),\n  (leg_number:bigint, The sequence number of the leg within the flight. Value examples: ['1', '1', '1'].),\n  (leg_flight:bigint, The flight ID of the leg's corresponding flight. Value examples: ['1', '2', '3'].),\n]\n# Table: flight_stop\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['2', '4'].),\n  (stop_number:bigint, The order of the stop in the flight. Value examples: ['1', '1'].),\n  (stop_days:text, Days of the week on which the flight stops at this airport. Value examples: ['2', '4'].),\n  (stop_airport:text, The 3-letter airport code of the stop. Value examples: ['DFW', 'DEN'].),\n  (arrival_time:bigint, The time at which the flight arrives at this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577847600', '1577862000'].),\n  (arrival_airline:text, The airline code of the arriving flight. Value examples: ['UA', 'WN'].),\n  (arrival_flight_number:text, Flight number of the arriving flight at this stop. Value examples: ['UA456', 'WN012'].),\n  (departure_time:bigint, The time at which the flight departs from this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577865600'].),\n  (departure_airline:text, The airline code of the departing flight. Value examples: ['UA', 'WN'].),\n  (departure_flight_number:text, Flight number of the departing flight from this stop. Value examples: ['UA456', 'WN012'].),\n  (stop_time:bigint, The duration of the stop at this airport. Value examples: ['3600', '3600'].),\n]\n# Table: food_service\n[\n  (meal_code:text, Code assigned to each meal type. Value examples: ['BF', 'LN'].),\n  (meal_number:bigint, Unique identifier for each meal served. Value examples: ['1', '2'].),\n  (compartment:text, The compartment in which the meal is served (e.g. 'First Class', 'Economy'). Value examples: ['First Class', 'First Class'].),\n  (meal_description:text, One of 'Breakfast', 'Lunch', 'Dinner'. Value examples: ['Breakfast', 'Lunch'].),\n]\n# Table: ground_service\n[\n  (city_code:text, The code for the city where the ground service is provided. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The 3-letter code for the airport where the ground service is provided. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (transport_type:text, The type of ground transportation provided. Value examples: ['Taxi', 'Shuttle', 'Bus', 'Car Rental'].),\n  (ground_fare:bigint, The fare charged for ground transportation. Value examples: ['50', '40', '30', '60'].),\n]\n# Table: month\n[\n  (month_number:bigint, A unique number assigned to each month of the year.. Value examples: ['1', '2', '3', '4'].),\n  (month_name:text, The name of the month, e.g. January, February, etc.. Value examples: ['January', 'February', 'March', 'April'].),\n]\n# Table: restriction\n[\n  (restriction_code:text, A code representing the type of restriction, such as blackout dates or minimum stay.. Value examples: ['NONE', 'NONE', 'NONE', 'NONE'].),\n  (advance_purchase:bigint, The number of days in advance the fare must be purchased.. Value examples: ['14', '14', '14', '14'].),\n  (stopovers:text, The number of stopovers allowed for the fare.. Value examples: ['2', '2', '2', '2'].),\n  (saturday_stay_required:text, Indicates whether a Saturday night stay is required for the fare. Either 'Yes' or 'No'.. Value examples: ['No', 'No', 'No', 'No'].),\n  (minimum_stay:bigint, The minimum length of stay required for the fare.. Value examples: ['7', '7', '7', '7'].),\n  (maximum_stay:bigint, The maximum length of stay allowed for the fare.. Value examples: ['30', '30', '30', '30'].),\n  (application:text, The type of fare application. Either 'One Way' or 'Round Trip'.. Value examples: ['One-Way', 'One-Way', 'One-Way', 'One-Way'].),\n  (no_discounts:text, Indicates whether the fare is eligible for discounts or promotions. Either 'Yes' or 'No'.. Value examples: ['Yes', 'Yes', 'Yes', 'Yes'].),\n]\n# Table: state\n[\n  (state_code:text, The 2-letter code assigned to the state. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA'].),\n  (state_name:text, The name of the state. Value examples: ['New York', 'California'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States'].),\n]\n# Table: time_interval\n[\n  (period:text, The period of the time interval, represented as a string. For example, 'daily', 'weekly', 'monthly', etc.. Value examples: ['daily', 'daily', 'daily'].),\n  (begin_time:bigint, The beginning time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577836800', '1577844000', '1577851200'].),\n  (end_time:bigint, The end time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577840400', '1577847600', '1577854800'].),\n]\n# Table: time_zone\n[\n  (time_zone_code:text, A short code that represents the time zone. For example, 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['PST', 'MST'].),\n  (time_zone_name:text, The name of the time zone. Value examples: ['Pacific Standard Time', 'Mountain Standard Time'].),\n  (hours_from_gmt:bigint, The number of hours that the time zone is ahead or behind Greenwich Mean Time (GMT). Value examples: ['-8', '-7'].),\n]\n\n【Foreign keys】\nairline.airline_code = flight.airline_code\nairline.airline_code = flight_stop.departure_airline\nairport.airport_code = fare.from_airport\nairport.airport_code = flight_stop.stop_airport\nairport_service.city_code = ground_service.city_code\nairport.state_code = city.state_code\nairport.state_code = state.state_code\ncity.state_code = state.state_code\nairport_service.city_code = city.city_code\nground_service.city_code = city.city_code\nairport.time_zone_code = time_zone.time_zone_code\ncity.time_zone_code = time_zone.time_zone_code\nflight.flight_id = flight_fare.flight_id\nflight.flight_id = flight_leg.flight_id\nflight.flight_id = flight_stop.flight_id\nflight_fare.flight_id = flight_leg.flight_id\nflight_fare.flight_id = flight_stop.flight_id\nflight_leg.flight_id = flight_stop.flight_id\naircraft.aircraft_code = equipment_sequence.aircraft_code\nflight.aircraft_code_sequence = equipment_sequence.aircraft_code_sequence\nflight.meal_code = food_service.meal_code\n\n【参考信息】\n\n\n【用户问题】\nHow many flights depart from each airport code, excluding departures with connections?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT airport.airport_code, COUNT(flight.from_airport) AS num_departures FROM airport LEFT JOIN flight ON airport.airport_code = flight.from_airport AND flight.connections=0 GROUP BY airport.airport_code;SELECT airport.airport_code, COUNT(flight.from_airport) AS num_departures FROM airport JOIN flight ON airport.airport_code = flight.from_airport WHERE flight.connections=0 GROUP BY airport.airport_code;",
        "role": "assistant"
      }
    ],
    "db_name": "atis",
    "id": 69,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich flight ids to Chicago (ORD) have the longest duration from departure to arrival, sorted in ascending order?\n\n【数据库schema】\n【DB_ID】 atis\n【Schema】\n# Table: aircraft\n[\n  (aircraft_code:text, The code assigned to the aircraft by the International Air Transport Association (IATA).. Value examples: ['B747', 'A320'].),\n  (aircraft_description:text, A short description of the aircraft.. Value examples: ['The Boeing 747 is a wide-body airliner.', 'The Airbus A320 is a narrow-body airliner.'].),\n  (manufacturer:text, The name of the manufacturer of the aircraft.. Value examples: ['Boeing', 'Airbus'].),\n  (basic_type:text, The basic type of the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (engines:bigint, The number of engines the aircraft has.. Value examples: ['4', '2'].),\n  (propulsion:text, The type of propulsion used by the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (wide_body:text, Indicates whether the aircraft is a wide body or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'No'].),\n  (wing_span:bigint, The distance between the tips of the aircraft's wings in feet.. Value examples: ['224', '111'].),\n  (length:bigint, The length of the aircraft in feet.. Value examples: ['231', '123'].),\n  (weight:bigint, The weight of the aircraft in pounds.. Value examples: ['987000', '162000'].),\n  (capacity:bigint, The maximum number of passengers the aircraft can carry.. Value examples: ['416', '240'].),\n  (pay_load:bigint, The maximum weight of cargo the aircraft can carry.. Value examples: ['60000', '30000'].),\n  (cruising_speed:bigint, The speed at which the aircraft cruises in miles per hour.. Value examples: ['570', '511'].),\n  (range_miles:bigint, The maximum distance the aircraft can fly in miles.. Value examples: ['8555', '3300'].),\n  (pressurized:text, Indicates whether the aircraft is pressurized or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'Yes'].),\n]\n# Table: airline\n[\n  (airline_code:text, The code assigned to the airline. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (airline_name:text, The name of the airline. Value examples: ['American Airlines', 'United Airlines', 'Delta Air Lines', 'Southwest Airlines'].),\n  (note:text, Any additional notes or comments about the airline. Value examples: ['NULL', 'NULL', 'NULL', 'NULL'].),\n]\n# Table: airport\n[\n  (airport_code:text, The code assigned to the airport.. Value examples: ['JFK', 'LAX', 'ORD', 'DFW'].),\n  (airport_name:text, The name of the airport.. Value examples: ['John F. Kennedy International Airport', 'Los Angeles International Airport', 'O’Hare International Airport', 'Dallas/Fort Worth International Airport'].),\n  (airport_location:text, The location of the airport, eg 'Las Vegas', 'Chicago'. Value examples: ['New York City', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The code assigned to the state where the airport is located.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the airport is located.. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the airport is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n  (minimum_connect_time:bigint, The minimum amount of time required for a connecting flight at the airport.. Value examples: ['23', '20', '24', '40'].),\n]\n# Table: airport_service\n[\n  (city_code:text, The code of the city where the airport is located. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The code of the airport. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (miles_distant:bigint, The distance of the airport from the city in miles. Value examples: ['10', '20', '30', '40'].),\n  (direction:text, The direction of the airport from the city. Either 'North', 'South', 'East', 'West', 'Northeast', 'Northwest', 'Southeast', or 'Southwest'.. Value examples: ['North', 'South', 'East', 'West'].),\n  (minutes_distant:bigint, The distance of the airport from the city in minutes. Value examples: ['20', '40', '60', '80'].),\n]\n# Table: city\n[\n  (city_code:text, The code assigned to the city. Value examples: ['NYC', 'LA', 'CHI', 'DA'].),\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The 2-letter code assigned to the state where the city is located. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the city is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n]\n# Table: class_of_service\n[\n  (booking_class:text, The booking class code for the class of service. Value examples: ['First', 'Business', 'Economy'].),\n  (rank:bigint, The rank of the class of service. Value examples: ['1', '2', '3'].),\n  (class_description:text, A brief description of the class of service. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: code_description\n[\n  (code:text, The code column contains a unique identifier for each record in the table.. Value examples: ['ABC', 'DEF'].),\n  (description:text, The description column contains a textual description of the code.. Value examples: ['Code ABC', 'Code DEF'].),\n]\n# Table: compartment_class\n[\n  (compartment:text, The compartment column contains the name of a compartment. Either 'First', 'Business', or 'Economy'.. Value examples: ['First', 'Business', 'Economy'].),\n  (class_type:text, The class_type column contains the type of a class. Either 'First Class', 'Business Class', or 'Economy Class'.. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: days\n[\n  (days_code:text, A code representing a day of the week. Value examples: ['1', '2'].),\n  (day_name:text, The name of a day of the week. Either 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', or 'Sunday'.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: dual_carrier\n[\n  (main_airline:text, The name of the main airline operating the flight. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (low_flight_number:bigint, The lowest flight number in the range of flights operated by the dual carrier. Value examples: ['1', '11', '21', '31'].),\n  (high_flight_number:bigint, The highest flight number in the range of flights operated by the dual carrier. Value examples: ['10', '20', '30', '40'].),\n  (dual_airline:text, The name of the dual airline operating the flight. Value examples: ['VX', 'DL', 'UA', 'AS'].),\n  (service_name:text, The name of the service provided by the dual carrier on the flight. Value examples: ['Dual Service 1', 'Dual Service 2', 'Dual Service 3', 'Dual Service 4'].),\n]\n# Table: equipment_sequence\n[\n  (aircraft_code_sequence:text, Sequence number for each aircraft code. Value examples: ['1', '2', '3', '4'].),\n  (aircraft_code:text, Code for each aircraft. Value examples: ['B747', 'A320', 'B737', 'A380'].),\n]\n# Table: fare\n[\n  (fare_id:bigint, The unique identifier for this fare. Value examples: ['1', '2'].),\n  (from_airport:text, The 3-letter airport code for the departure location. Value examples: ['ORD', 'ORD'].),\n  (to_airport:text, The 3-letter airport code for the arrival location. Value examples: ['JFK', 'JFK'].),\n  (fare_basis_code:text, The code used to determine the fare's pricing rules. Value examples: ['ABC', 'DEF'].),\n  (fare_airline:text, The airline code associated with this fare. Value examples: ['AA', 'UA'].),\n  (restriction_code:text, Any restrictions or limitations associated with this fare. Value examples: ['NONE', 'NONE'].),\n  (one_direction_cost:bigint, The cost of a one-way trip for this fare. Value examples: ['200', '150'].),\n  (round_trip_cost:bigint, The cost of a round-trip for this fare. Value examples: ['300', '280'].),\n  (round_trip_required:text, Indicates whether a round-trip is required to purchase this fare. Either Yes or No.. Value examples: ['Yes', 'No'].),\n]\n# Table: fare_basis\n[\n  (fare_basis_code:text, The code that identifies the fare basis. Value examples: ['ABC', 'DEF', 'GHI', 'JKL'].),\n  (booking_class:text, The booking class associated with the fare basis. Either 'First', 'Business', or 'Economy'. Value examples: ['First', 'Business', 'Economy', 'First'].),\n  (class_type:text, The class type associated with the fare basis. Either 'First Class', 'Business Class', or 'Economy Class'. Value examples: ['First Class', 'Business Class', 'Economy Class', 'First Class'].),\n  (premium:text, Indicates whether the fare basis is for a premium class. Value examples: ['Yes', 'Yes', 'No', 'Yes'].),\n  (economy:text, Indicates whether the fare basis is for an economy class. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (discounted:text, Indicates whether the fare basis is for a discounted fare. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (night:text, Indicates whether the fare basis is for a night fare. Value examples: ['No', 'No', 'No', 'No'].),\n  (season:text, The season associated with the fare basis. Can only be 'Peak' or 'Regular'. Value examples: ['Regular', 'Regular', 'Regular', 'Regular'].),\n  (basis_days:text, The number of days the fare basis is valid for. Value examples: ['30', '30', '30', '30'].),\n]\n# Table: flight\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['3', '4', '5', '7'].),\n  (flight_days:text, Days of the week the flight operates on. Formatted as comma-delimited 3-letter abbreviations, e.g. `mon,tue,wed` or `tues,thurs`. Value examples: ['wed', 'thu', 'fri', 'sun'].),\n  (from_airport:text, Code assigned to the departure airport. Value examples: ['ORD', 'ORD', 'ORD', 'JFK'].),\n  (to_airport:text, Code assigned to the arrival airport. Value examples: ['JFK', 'JFK', 'LAX', 'ORD'].),\n  (departure_time:bigint, Epoch timestamp for departure time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577858400', '1577865600', '1577880000'].),\n  (arrival_time:bigint, Epoch timestamp for arrival time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577854900', '1577873400', '1577869600', '1577883700'].),\n  (airline_flight:text, Code assigned to the airline flight. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (airline_code:text, Code assigned to the airline. Value examples: ['AA', 'WN', 'AS', 'UA'].),\n  (flight_number:text, Flight number assigned by the airline. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (aircraft_code_sequence:text, Code assigned to the aircraft. Value examples: ['3', '4', '5', '7'].),\n  (meal_code:text, Code assigned to the meal provided during the flight. Value examples: ['DN', 'BS', 'BF', 'DN'].),\n  (stops:bigint, Number of stops during the flight. Value examples: ['0', '1', '0', '0'].),\n  (connections:bigint, Number of connections during the flight. Value examples: ['0', '1', '0', '0'].),\n  (dual_carrier:text, Code assigned to the dual carrier. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (time_elapsed:bigint, Total time elapsed during the flight in seconds. Value examples: ['3700', '15000', '4000', '3700'].),\n]\n# Table: flight_fare\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3', '4'].),\n  (fare_id:bigint, Unique identifier for each fare. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: flight_leg\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3'].),\n  (leg_number:bigint, The sequence number of the leg within the flight. Value examples: ['1', '1', '1'].),\n  (leg_flight:bigint, The flight ID of the leg's corresponding flight. Value examples: ['1', '2', '3'].),\n]\n# Table: flight_stop\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['2', '4'].),\n  (stop_number:bigint, The order of the stop in the flight. Value examples: ['1', '1'].),\n  (stop_days:text, Days of the week on which the flight stops at this airport. Value examples: ['2', '4'].),\n  (stop_airport:text, The 3-letter airport code of the stop. Value examples: ['DFW', 'DEN'].),\n  (arrival_time:bigint, The time at which the flight arrives at this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577847600', '1577862000'].),\n  (arrival_airline:text, The airline code of the arriving flight. Value examples: ['UA', 'WN'].),\n  (arrival_flight_number:text, Flight number of the arriving flight at this stop. Value examples: ['UA456', 'WN012'].),\n  (departure_time:bigint, The time at which the flight departs from this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577865600'].),\n  (departure_airline:text, The airline code of the departing flight. Value examples: ['UA', 'WN'].),\n  (departure_flight_number:text, Flight number of the departing flight from this stop. Value examples: ['UA456', 'WN012'].),\n  (stop_time:bigint, The duration of the stop at this airport. Value examples: ['3600', '3600'].),\n]\n# Table: food_service\n[\n  (meal_code:text, Code assigned to each meal type. Value examples: ['BF', 'LN'].),\n  (meal_number:bigint, Unique identifier for each meal served. Value examples: ['1', '2'].),\n  (compartment:text, The compartment in which the meal is served (e.g. 'First Class', 'Economy'). Value examples: ['First Class', 'First Class'].),\n  (meal_description:text, One of 'Breakfast', 'Lunch', 'Dinner'. Value examples: ['Breakfast', 'Lunch'].),\n]\n# Table: ground_service\n[\n  (city_code:text, The code for the city where the ground service is provided. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The 3-letter code for the airport where the ground service is provided. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (transport_type:text, The type of ground transportation provided. Value examples: ['Taxi', 'Shuttle', 'Bus', 'Car Rental'].),\n  (ground_fare:bigint, The fare charged for ground transportation. Value examples: ['50', '40', '30', '60'].),\n]\n# Table: month\n[\n  (month_number:bigint, A unique number assigned to each month of the year.. Value examples: ['1', '2', '3', '4'].),\n  (month_name:text, The name of the month, e.g. January, February, etc.. Value examples: ['January', 'February', 'March', 'April'].),\n]\n# Table: restriction\n[\n  (restriction_code:text, A code representing the type of restriction, such as blackout dates or minimum stay.. Value examples: ['NONE', 'NONE', 'NONE', 'NONE'].),\n  (advance_purchase:bigint, The number of days in advance the fare must be purchased.. Value examples: ['14', '14', '14', '14'].),\n  (stopovers:text, The number of stopovers allowed for the fare.. Value examples: ['2', '2', '2', '2'].),\n  (saturday_stay_required:text, Indicates whether a Saturday night stay is required for the fare. Either 'Yes' or 'No'.. Value examples: ['No', 'No', 'No', 'No'].),\n  (minimum_stay:bigint, The minimum length of stay required for the fare.. Value examples: ['7', '7', '7', '7'].),\n  (maximum_stay:bigint, The maximum length of stay allowed for the fare.. Value examples: ['30', '30', '30', '30'].),\n  (application:text, The type of fare application. Either 'One Way' or 'Round Trip'.. Value examples: ['One-Way', 'One-Way', 'One-Way', 'One-Way'].),\n  (no_discounts:text, Indicates whether the fare is eligible for discounts or promotions. Either 'Yes' or 'No'.. Value examples: ['Yes', 'Yes', 'Yes', 'Yes'].),\n]\n# Table: state\n[\n  (state_code:text, The 2-letter code assigned to the state. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA'].),\n  (state_name:text, The name of the state. Value examples: ['New York', 'California'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States'].),\n]\n# Table: time_interval\n[\n  (period:text, The period of the time interval, represented as a string. For example, 'daily', 'weekly', 'monthly', etc.. Value examples: ['daily', 'daily', 'daily'].),\n  (begin_time:bigint, The beginning time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577836800', '1577844000', '1577851200'].),\n  (end_time:bigint, The end time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577840400', '1577847600', '1577854800'].),\n]\n# Table: time_zone\n[\n  (time_zone_code:text, A short code that represents the time zone. For example, 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['PST', 'MST'].),\n  (time_zone_name:text, The name of the time zone. Value examples: ['Pacific Standard Time', 'Mountain Standard Time'].),\n  (hours_from_gmt:bigint, The number of hours that the time zone is ahead or behind Greenwich Mean Time (GMT). Value examples: ['-8', '-7'].),\n]\n\n【Foreign keys】\nairline.airline_code = flight.airline_code\nairline.airline_code = flight_stop.departure_airline\nairport.airport_code = fare.from_airport\nairport.airport_code = flight_stop.stop_airport\nairport_service.city_code = ground_service.city_code\nairport.state_code = city.state_code\nairport.state_code = state.state_code\ncity.state_code = state.state_code\nairport_service.city_code = city.city_code\nground_service.city_code = city.city_code\nairport.time_zone_code = time_zone.time_zone_code\ncity.time_zone_code = time_zone.time_zone_code\nflight.flight_id = flight_fare.flight_id\nflight.flight_id = flight_leg.flight_id\nflight.flight_id = flight_stop.flight_id\nflight_fare.flight_id = flight_leg.flight_id\nflight_fare.flight_id = flight_stop.flight_id\nflight_leg.flight_id = flight_stop.flight_id\naircraft.aircraft_code = equipment_sequence.aircraft_code\nflight.aircraft_code_sequence = equipment_sequence.aircraft_code_sequence\nflight.meal_code = food_service.meal_code\n\n【参考信息】\n\n\n【用户问题】\nWhich flight ids to Chicago (ORD) have the longest duration from departure to arrival, sorted in ascending order?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT flight.flight_id, (flight.arrival_time - flight.departure_time) AS duration FROM flight WHERE to_airport = 'ORD' ORDER BY duration ASC NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "atis",
    "id": 70,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich airports have the shortest minimum connect time, sorted in ascending order? Show the minimum connect time.\n\n【数据库schema】\n【DB_ID】 atis\n【Schema】\n# Table: aircraft\n[\n  (aircraft_code:text, The code assigned to the aircraft by the International Air Transport Association (IATA).. Value examples: ['B747', 'A320'].),\n  (aircraft_description:text, A short description of the aircraft.. Value examples: ['The Boeing 747 is a wide-body airliner.', 'The Airbus A320 is a narrow-body airliner.'].),\n  (manufacturer:text, The name of the manufacturer of the aircraft.. Value examples: ['Boeing', 'Airbus'].),\n  (basic_type:text, The basic type of the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (engines:bigint, The number of engines the aircraft has.. Value examples: ['4', '2'].),\n  (propulsion:text, The type of propulsion used by the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (wide_body:text, Indicates whether the aircraft is a wide body or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'No'].),\n  (wing_span:bigint, The distance between the tips of the aircraft's wings in feet.. Value examples: ['224', '111'].),\n  (length:bigint, The length of the aircraft in feet.. Value examples: ['231', '123'].),\n  (weight:bigint, The weight of the aircraft in pounds.. Value examples: ['987000', '162000'].),\n  (capacity:bigint, The maximum number of passengers the aircraft can carry.. Value examples: ['416', '240'].),\n  (pay_load:bigint, The maximum weight of cargo the aircraft can carry.. Value examples: ['60000', '30000'].),\n  (cruising_speed:bigint, The speed at which the aircraft cruises in miles per hour.. Value examples: ['570', '511'].),\n  (range_miles:bigint, The maximum distance the aircraft can fly in miles.. Value examples: ['8555', '3300'].),\n  (pressurized:text, Indicates whether the aircraft is pressurized or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'Yes'].),\n]\n# Table: airline\n[\n  (airline_code:text, The code assigned to the airline. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (airline_name:text, The name of the airline. Value examples: ['American Airlines', 'United Airlines', 'Delta Air Lines', 'Southwest Airlines'].),\n  (note:text, Any additional notes or comments about the airline. Value examples: ['NULL', 'NULL', 'NULL', 'NULL'].),\n]\n# Table: airport\n[\n  (airport_code:text, The code assigned to the airport.. Value examples: ['JFK', 'LAX', 'ORD', 'DFW'].),\n  (airport_name:text, The name of the airport.. Value examples: ['John F. Kennedy International Airport', 'Los Angeles International Airport', 'O’Hare International Airport', 'Dallas/Fort Worth International Airport'].),\n  (airport_location:text, The location of the airport, eg 'Las Vegas', 'Chicago'. Value examples: ['New York City', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The code assigned to the state where the airport is located.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the airport is located.. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the airport is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n  (minimum_connect_time:bigint, The minimum amount of time required for a connecting flight at the airport.. Value examples: ['23', '20', '24', '40'].),\n]\n# Table: airport_service\n[\n  (city_code:text, The code of the city where the airport is located. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The code of the airport. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (miles_distant:bigint, The distance of the airport from the city in miles. Value examples: ['10', '20', '30', '40'].),\n  (direction:text, The direction of the airport from the city. Either 'North', 'South', 'East', 'West', 'Northeast', 'Northwest', 'Southeast', or 'Southwest'.. Value examples: ['North', 'South', 'East', 'West'].),\n  (minutes_distant:bigint, The distance of the airport from the city in minutes. Value examples: ['20', '40', '60', '80'].),\n]\n# Table: city\n[\n  (city_code:text, The code assigned to the city. Value examples: ['NYC', 'LA', 'CHI', 'DA'].),\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The 2-letter code assigned to the state where the city is located. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the city is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n]\n# Table: class_of_service\n[\n  (booking_class:text, The booking class code for the class of service. Value examples: ['First', 'Business', 'Economy'].),\n  (rank:bigint, The rank of the class of service. Value examples: ['1', '2', '3'].),\n  (class_description:text, A brief description of the class of service. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: code_description\n[\n  (code:text, The code column contains a unique identifier for each record in the table.. Value examples: ['ABC', 'DEF'].),\n  (description:text, The description column contains a textual description of the code.. Value examples: ['Code ABC', 'Code DEF'].),\n]\n# Table: compartment_class\n[\n  (compartment:text, The compartment column contains the name of a compartment. Either 'First', 'Business', or 'Economy'.. Value examples: ['First', 'Business', 'Economy'].),\n  (class_type:text, The class_type column contains the type of a class. Either 'First Class', 'Business Class', or 'Economy Class'.. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: days\n[\n  (days_code:text, A code representing a day of the week. Value examples: ['1', '2'].),\n  (day_name:text, The name of a day of the week. Either 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', or 'Sunday'.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: dual_carrier\n[\n  (main_airline:text, The name of the main airline operating the flight. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (low_flight_number:bigint, The lowest flight number in the range of flights operated by the dual carrier. Value examples: ['1', '11', '21', '31'].),\n  (high_flight_number:bigint, The highest flight number in the range of flights operated by the dual carrier. Value examples: ['10', '20', '30', '40'].),\n  (dual_airline:text, The name of the dual airline operating the flight. Value examples: ['VX', 'DL', 'UA', 'AS'].),\n  (service_name:text, The name of the service provided by the dual carrier on the flight. Value examples: ['Dual Service 1', 'Dual Service 2', 'Dual Service 3', 'Dual Service 4'].),\n]\n# Table: equipment_sequence\n[\n  (aircraft_code_sequence:text, Sequence number for each aircraft code. Value examples: ['1', '2', '3', '4'].),\n  (aircraft_code:text, Code for each aircraft. Value examples: ['B747', 'A320', 'B737', 'A380'].),\n]\n# Table: fare\n[\n  (fare_id:bigint, The unique identifier for this fare. Value examples: ['1', '2'].),\n  (from_airport:text, The 3-letter airport code for the departure location. Value examples: ['ORD', 'ORD'].),\n  (to_airport:text, The 3-letter airport code for the arrival location. Value examples: ['JFK', 'JFK'].),\n  (fare_basis_code:text, The code used to determine the fare's pricing rules. Value examples: ['ABC', 'DEF'].),\n  (fare_airline:text, The airline code associated with this fare. Value examples: ['AA', 'UA'].),\n  (restriction_code:text, Any restrictions or limitations associated with this fare. Value examples: ['NONE', 'NONE'].),\n  (one_direction_cost:bigint, The cost of a one-way trip for this fare. Value examples: ['200', '150'].),\n  (round_trip_cost:bigint, The cost of a round-trip for this fare. Value examples: ['300', '280'].),\n  (round_trip_required:text, Indicates whether a round-trip is required to purchase this fare. Either Yes or No.. Value examples: ['Yes', 'No'].),\n]\n# Table: fare_basis\n[\n  (fare_basis_code:text, The code that identifies the fare basis. Value examples: ['ABC', 'DEF', 'GHI', 'JKL'].),\n  (booking_class:text, The booking class associated with the fare basis. Either 'First', 'Business', or 'Economy'. Value examples: ['First', 'Business', 'Economy', 'First'].),\n  (class_type:text, The class type associated with the fare basis. Either 'First Class', 'Business Class', or 'Economy Class'. Value examples: ['First Class', 'Business Class', 'Economy Class', 'First Class'].),\n  (premium:text, Indicates whether the fare basis is for a premium class. Value examples: ['Yes', 'Yes', 'No', 'Yes'].),\n  (economy:text, Indicates whether the fare basis is for an economy class. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (discounted:text, Indicates whether the fare basis is for a discounted fare. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (night:text, Indicates whether the fare basis is for a night fare. Value examples: ['No', 'No', 'No', 'No'].),\n  (season:text, The season associated with the fare basis. Can only be 'Peak' or 'Regular'. Value examples: ['Regular', 'Regular', 'Regular', 'Regular'].),\n  (basis_days:text, The number of days the fare basis is valid for. Value examples: ['30', '30', '30', '30'].),\n]\n# Table: flight\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['3', '4', '5', '7'].),\n  (flight_days:text, Days of the week the flight operates on. Formatted as comma-delimited 3-letter abbreviations, e.g. `mon,tue,wed` or `tues,thurs`. Value examples: ['wed', 'thu', 'fri', 'sun'].),\n  (from_airport:text, Code assigned to the departure airport. Value examples: ['ORD', 'ORD', 'ORD', 'JFK'].),\n  (to_airport:text, Code assigned to the arrival airport. Value examples: ['JFK', 'JFK', 'LAX', 'ORD'].),\n  (departure_time:bigint, Epoch timestamp for departure time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577858400', '1577865600', '1577880000'].),\n  (arrival_time:bigint, Epoch timestamp for arrival time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577854900', '1577873400', '1577869600', '1577883700'].),\n  (airline_flight:text, Code assigned to the airline flight. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (airline_code:text, Code assigned to the airline. Value examples: ['AA', 'WN', 'AS', 'UA'].),\n  (flight_number:text, Flight number assigned by the airline. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (aircraft_code_sequence:text, Code assigned to the aircraft. Value examples: ['3', '4', '5', '7'].),\n  (meal_code:text, Code assigned to the meal provided during the flight. Value examples: ['DN', 'BS', 'BF', 'DN'].),\n  (stops:bigint, Number of stops during the flight. Value examples: ['0', '1', '0', '0'].),\n  (connections:bigint, Number of connections during the flight. Value examples: ['0', '1', '0', '0'].),\n  (dual_carrier:text, Code assigned to the dual carrier. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (time_elapsed:bigint, Total time elapsed during the flight in seconds. Value examples: ['3700', '15000', '4000', '3700'].),\n]\n# Table: flight_fare\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3', '4'].),\n  (fare_id:bigint, Unique identifier for each fare. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: flight_leg\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3'].),\n  (leg_number:bigint, The sequence number of the leg within the flight. Value examples: ['1', '1', '1'].),\n  (leg_flight:bigint, The flight ID of the leg's corresponding flight. Value examples: ['1', '2', '3'].),\n]\n# Table: flight_stop\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['2', '4'].),\n  (stop_number:bigint, The order of the stop in the flight. Value examples: ['1', '1'].),\n  (stop_days:text, Days of the week on which the flight stops at this airport. Value examples: ['2', '4'].),\n  (stop_airport:text, The 3-letter airport code of the stop. Value examples: ['DFW', 'DEN'].),\n  (arrival_time:bigint, The time at which the flight arrives at this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577847600', '1577862000'].),\n  (arrival_airline:text, The airline code of the arriving flight. Value examples: ['UA', 'WN'].),\n  (arrival_flight_number:text, Flight number of the arriving flight at this stop. Value examples: ['UA456', 'WN012'].),\n  (departure_time:bigint, The time at which the flight departs from this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577865600'].),\n  (departure_airline:text, The airline code of the departing flight. Value examples: ['UA', 'WN'].),\n  (departure_flight_number:text, Flight number of the departing flight from this stop. Value examples: ['UA456', 'WN012'].),\n  (stop_time:bigint, The duration of the stop at this airport. Value examples: ['3600', '3600'].),\n]\n# Table: food_service\n[\n  (meal_code:text, Code assigned to each meal type. Value examples: ['BF', 'LN'].),\n  (meal_number:bigint, Unique identifier for each meal served. Value examples: ['1', '2'].),\n  (compartment:text, The compartment in which the meal is served (e.g. 'First Class', 'Economy'). Value examples: ['First Class', 'First Class'].),\n  (meal_description:text, One of 'Breakfast', 'Lunch', 'Dinner'. Value examples: ['Breakfast', 'Lunch'].),\n]\n# Table: ground_service\n[\n  (city_code:text, The code for the city where the ground service is provided. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The 3-letter code for the airport where the ground service is provided. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (transport_type:text, The type of ground transportation provided. Value examples: ['Taxi', 'Shuttle', 'Bus', 'Car Rental'].),\n  (ground_fare:bigint, The fare charged for ground transportation. Value examples: ['50', '40', '30', '60'].),\n]\n# Table: month\n[\n  (month_number:bigint, A unique number assigned to each month of the year.. Value examples: ['1', '2', '3', '4'].),\n  (month_name:text, The name of the month, e.g. January, February, etc.. Value examples: ['January', 'February', 'March', 'April'].),\n]\n# Table: restriction\n[\n  (restriction_code:text, A code representing the type of restriction, such as blackout dates or minimum stay.. Value examples: ['NONE', 'NONE', 'NONE', 'NONE'].),\n  (advance_purchase:bigint, The number of days in advance the fare must be purchased.. Value examples: ['14', '14', '14', '14'].),\n  (stopovers:text, The number of stopovers allowed for the fare.. Value examples: ['2', '2', '2', '2'].),\n  (saturday_stay_required:text, Indicates whether a Saturday night stay is required for the fare. Either 'Yes' or 'No'.. Value examples: ['No', 'No', 'No', 'No'].),\n  (minimum_stay:bigint, The minimum length of stay required for the fare.. Value examples: ['7', '7', '7', '7'].),\n  (maximum_stay:bigint, The maximum length of stay allowed for the fare.. Value examples: ['30', '30', '30', '30'].),\n  (application:text, The type of fare application. Either 'One Way' or 'Round Trip'.. Value examples: ['One-Way', 'One-Way', 'One-Way', 'One-Way'].),\n  (no_discounts:text, Indicates whether the fare is eligible for discounts or promotions. Either 'Yes' or 'No'.. Value examples: ['Yes', 'Yes', 'Yes', 'Yes'].),\n]\n# Table: state\n[\n  (state_code:text, The 2-letter code assigned to the state. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA'].),\n  (state_name:text, The name of the state. Value examples: ['New York', 'California'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States'].),\n]\n# Table: time_interval\n[\n  (period:text, The period of the time interval, represented as a string. For example, 'daily', 'weekly', 'monthly', etc.. Value examples: ['daily', 'daily', 'daily'].),\n  (begin_time:bigint, The beginning time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577836800', '1577844000', '1577851200'].),\n  (end_time:bigint, The end time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577840400', '1577847600', '1577854800'].),\n]\n# Table: time_zone\n[\n  (time_zone_code:text, A short code that represents the time zone. For example, 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['PST', 'MST'].),\n  (time_zone_name:text, The name of the time zone. Value examples: ['Pacific Standard Time', 'Mountain Standard Time'].),\n  (hours_from_gmt:bigint, The number of hours that the time zone is ahead or behind Greenwich Mean Time (GMT). Value examples: ['-8', '-7'].),\n]\n\n【Foreign keys】\nairline.airline_code = flight.airline_code\nairline.airline_code = flight_stop.departure_airline\nairport.airport_code = fare.from_airport\nairport.airport_code = flight_stop.stop_airport\nairport_service.city_code = ground_service.city_code\nairport.state_code = city.state_code\nairport.state_code = state.state_code\ncity.state_code = state.state_code\nairport_service.city_code = city.city_code\nground_service.city_code = city.city_code\nairport.time_zone_code = time_zone.time_zone_code\ncity.time_zone_code = time_zone.time_zone_code\nflight.flight_id = flight_fare.flight_id\nflight.flight_id = flight_leg.flight_id\nflight.flight_id = flight_stop.flight_id\nflight_fare.flight_id = flight_leg.flight_id\nflight_fare.flight_id = flight_stop.flight_id\nflight_leg.flight_id = flight_stop.flight_id\naircraft.aircraft_code = equipment_sequence.aircraft_code\nflight.aircraft_code_sequence = equipment_sequence.aircraft_code_sequence\nflight.meal_code = food_service.meal_code\n\n【参考信息】\n\n\n【用户问题】\nWhich airports have the shortest minimum connect time, sorted in ascending order? Show the minimum connect time.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT airport.airport_name, airport.airport_code, airport.minimum_connect_time FROM airport ORDER BY airport.minimum_connect_time ASC NULLS LAST",
        "role": "assistant"
      }
    ],
    "db_name": "atis",
    "id": 71,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich aircraft code can carry the highest weight of cargo that any aircraft can carry?\n\n【数据库schema】\n【DB_ID】 atis\n【Schema】\n# Table: aircraft\n[\n  (aircraft_code:text, The code assigned to the aircraft by the International Air Transport Association (IATA).. Value examples: ['B747', 'A320'].),\n  (aircraft_description:text, A short description of the aircraft.. Value examples: ['The Boeing 747 is a wide-body airliner.', 'The Airbus A320 is a narrow-body airliner.'].),\n  (manufacturer:text, The name of the manufacturer of the aircraft.. Value examples: ['Boeing', 'Airbus'].),\n  (basic_type:text, The basic type of the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (engines:bigint, The number of engines the aircraft has.. Value examples: ['4', '2'].),\n  (propulsion:text, The type of propulsion used by the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (wide_body:text, Indicates whether the aircraft is a wide body or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'No'].),\n  (wing_span:bigint, The distance between the tips of the aircraft's wings in feet.. Value examples: ['224', '111'].),\n  (length:bigint, The length of the aircraft in feet.. Value examples: ['231', '123'].),\n  (weight:bigint, The weight of the aircraft in pounds.. Value examples: ['987000', '162000'].),\n  (capacity:bigint, The maximum number of passengers the aircraft can carry.. Value examples: ['416', '240'].),\n  (pay_load:bigint, The maximum weight of cargo the aircraft can carry.. Value examples: ['60000', '30000'].),\n  (cruising_speed:bigint, The speed at which the aircraft cruises in miles per hour.. Value examples: ['570', '511'].),\n  (range_miles:bigint, The maximum distance the aircraft can fly in miles.. Value examples: ['8555', '3300'].),\n  (pressurized:text, Indicates whether the aircraft is pressurized or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'Yes'].),\n]\n# Table: airline\n[\n  (airline_code:text, The code assigned to the airline. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (airline_name:text, The name of the airline. Value examples: ['American Airlines', 'United Airlines', 'Delta Air Lines', 'Southwest Airlines'].),\n  (note:text, Any additional notes or comments about the airline. Value examples: ['NULL', 'NULL', 'NULL', 'NULL'].),\n]\n# Table: airport\n[\n  (airport_code:text, The code assigned to the airport.. Value examples: ['JFK', 'LAX', 'ORD', 'DFW'].),\n  (airport_name:text, The name of the airport.. Value examples: ['John F. Kennedy International Airport', 'Los Angeles International Airport', 'O’Hare International Airport', 'Dallas/Fort Worth International Airport'].),\n  (airport_location:text, The location of the airport, eg 'Las Vegas', 'Chicago'. Value examples: ['New York City', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The code assigned to the state where the airport is located.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the airport is located.. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the airport is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n  (minimum_connect_time:bigint, The minimum amount of time required for a connecting flight at the airport.. Value examples: ['23', '20', '24', '40'].),\n]\n# Table: airport_service\n[\n  (city_code:text, The code of the city where the airport is located. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The code of the airport. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (miles_distant:bigint, The distance of the airport from the city in miles. Value examples: ['10', '20', '30', '40'].),\n  (direction:text, The direction of the airport from the city. Either 'North', 'South', 'East', 'West', 'Northeast', 'Northwest', 'Southeast', or 'Southwest'.. Value examples: ['North', 'South', 'East', 'West'].),\n  (minutes_distant:bigint, The distance of the airport from the city in minutes. Value examples: ['20', '40', '60', '80'].),\n]\n# Table: city\n[\n  (city_code:text, The code assigned to the city. Value examples: ['NYC', 'LA', 'CHI', 'DA'].),\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The 2-letter code assigned to the state where the city is located. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the city is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n]\n# Table: class_of_service\n[\n  (booking_class:text, The booking class code for the class of service. Value examples: ['First', 'Business', 'Economy'].),\n  (rank:bigint, The rank of the class of service. Value examples: ['1', '2', '3'].),\n  (class_description:text, A brief description of the class of service. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: code_description\n[\n  (code:text, The code column contains a unique identifier for each record in the table.. Value examples: ['ABC', 'DEF'].),\n  (description:text, The description column contains a textual description of the code.. Value examples: ['Code ABC', 'Code DEF'].),\n]\n# Table: compartment_class\n[\n  (compartment:text, The compartment column contains the name of a compartment. Either 'First', 'Business', or 'Economy'.. Value examples: ['First', 'Business', 'Economy'].),\n  (class_type:text, The class_type column contains the type of a class. Either 'First Class', 'Business Class', or 'Economy Class'.. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: days\n[\n  (days_code:text, A code representing a day of the week. Value examples: ['1', '2'].),\n  (day_name:text, The name of a day of the week. Either 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', or 'Sunday'.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: dual_carrier\n[\n  (main_airline:text, The name of the main airline operating the flight. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (low_flight_number:bigint, The lowest flight number in the range of flights operated by the dual carrier. Value examples: ['1', '11', '21', '31'].),\n  (high_flight_number:bigint, The highest flight number in the range of flights operated by the dual carrier. Value examples: ['10', '20', '30', '40'].),\n  (dual_airline:text, The name of the dual airline operating the flight. Value examples: ['VX', 'DL', 'UA', 'AS'].),\n  (service_name:text, The name of the service provided by the dual carrier on the flight. Value examples: ['Dual Service 1', 'Dual Service 2', 'Dual Service 3', 'Dual Service 4'].),\n]\n# Table: equipment_sequence\n[\n  (aircraft_code_sequence:text, Sequence number for each aircraft code. Value examples: ['1', '2', '3', '4'].),\n  (aircraft_code:text, Code for each aircraft. Value examples: ['B747', 'A320', 'B737', 'A380'].),\n]\n# Table: fare\n[\n  (fare_id:bigint, The unique identifier for this fare. Value examples: ['1', '2'].),\n  (from_airport:text, The 3-letter airport code for the departure location. Value examples: ['ORD', 'ORD'].),\n  (to_airport:text, The 3-letter airport code for the arrival location. Value examples: ['JFK', 'JFK'].),\n  (fare_basis_code:text, The code used to determine the fare's pricing rules. Value examples: ['ABC', 'DEF'].),\n  (fare_airline:text, The airline code associated with this fare. Value examples: ['AA', 'UA'].),\n  (restriction_code:text, Any restrictions or limitations associated with this fare. Value examples: ['NONE', 'NONE'].),\n  (one_direction_cost:bigint, The cost of a one-way trip for this fare. Value examples: ['200', '150'].),\n  (round_trip_cost:bigint, The cost of a round-trip for this fare. Value examples: ['300', '280'].),\n  (round_trip_required:text, Indicates whether a round-trip is required to purchase this fare. Either Yes or No.. Value examples: ['Yes', 'No'].),\n]\n# Table: fare_basis\n[\n  (fare_basis_code:text, The code that identifies the fare basis. Value examples: ['ABC', 'DEF', 'GHI', 'JKL'].),\n  (booking_class:text, The booking class associated with the fare basis. Either 'First', 'Business', or 'Economy'. Value examples: ['First', 'Business', 'Economy', 'First'].),\n  (class_type:text, The class type associated with the fare basis. Either 'First Class', 'Business Class', or 'Economy Class'. Value examples: ['First Class', 'Business Class', 'Economy Class', 'First Class'].),\n  (premium:text, Indicates whether the fare basis is for a premium class. Value examples: ['Yes', 'Yes', 'No', 'Yes'].),\n  (economy:text, Indicates whether the fare basis is for an economy class. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (discounted:text, Indicates whether the fare basis is for a discounted fare. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (night:text, Indicates whether the fare basis is for a night fare. Value examples: ['No', 'No', 'No', 'No'].),\n  (season:text, The season associated with the fare basis. Can only be 'Peak' or 'Regular'. Value examples: ['Regular', 'Regular', 'Regular', 'Regular'].),\n  (basis_days:text, The number of days the fare basis is valid for. Value examples: ['30', '30', '30', '30'].),\n]\n# Table: flight\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['3', '4', '5', '7'].),\n  (flight_days:text, Days of the week the flight operates on. Formatted as comma-delimited 3-letter abbreviations, e.g. `mon,tue,wed` or `tues,thurs`. Value examples: ['wed', 'thu', 'fri', 'sun'].),\n  (from_airport:text, Code assigned to the departure airport. Value examples: ['ORD', 'ORD', 'ORD', 'JFK'].),\n  (to_airport:text, Code assigned to the arrival airport. Value examples: ['JFK', 'JFK', 'LAX', 'ORD'].),\n  (departure_time:bigint, Epoch timestamp for departure time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577858400', '1577865600', '1577880000'].),\n  (arrival_time:bigint, Epoch timestamp for arrival time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577854900', '1577873400', '1577869600', '1577883700'].),\n  (airline_flight:text, Code assigned to the airline flight. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (airline_code:text, Code assigned to the airline. Value examples: ['AA', 'WN', 'AS', 'UA'].),\n  (flight_number:text, Flight number assigned by the airline. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (aircraft_code_sequence:text, Code assigned to the aircraft. Value examples: ['3', '4', '5', '7'].),\n  (meal_code:text, Code assigned to the meal provided during the flight. Value examples: ['DN', 'BS', 'BF', 'DN'].),\n  (stops:bigint, Number of stops during the flight. Value examples: ['0', '1', '0', '0'].),\n  (connections:bigint, Number of connections during the flight. Value examples: ['0', '1', '0', '0'].),\n  (dual_carrier:text, Code assigned to the dual carrier. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (time_elapsed:bigint, Total time elapsed during the flight in seconds. Value examples: ['3700', '15000', '4000', '3700'].),\n]\n# Table: flight_fare\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3', '4'].),\n  (fare_id:bigint, Unique identifier for each fare. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: flight_leg\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3'].),\n  (leg_number:bigint, The sequence number of the leg within the flight. Value examples: ['1', '1', '1'].),\n  (leg_flight:bigint, The flight ID of the leg's corresponding flight. Value examples: ['1', '2', '3'].),\n]\n# Table: flight_stop\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['2', '4'].),\n  (stop_number:bigint, The order of the stop in the flight. Value examples: ['1', '1'].),\n  (stop_days:text, Days of the week on which the flight stops at this airport. Value examples: ['2', '4'].),\n  (stop_airport:text, The 3-letter airport code of the stop. Value examples: ['DFW', 'DEN'].),\n  (arrival_time:bigint, The time at which the flight arrives at this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577847600', '1577862000'].),\n  (arrival_airline:text, The airline code of the arriving flight. Value examples: ['UA', 'WN'].),\n  (arrival_flight_number:text, Flight number of the arriving flight at this stop. Value examples: ['UA456', 'WN012'].),\n  (departure_time:bigint, The time at which the flight departs from this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577865600'].),\n  (departure_airline:text, The airline code of the departing flight. Value examples: ['UA', 'WN'].),\n  (departure_flight_number:text, Flight number of the departing flight from this stop. Value examples: ['UA456', 'WN012'].),\n  (stop_time:bigint, The duration of the stop at this airport. Value examples: ['3600', '3600'].),\n]\n# Table: food_service\n[\n  (meal_code:text, Code assigned to each meal type. Value examples: ['BF', 'LN'].),\n  (meal_number:bigint, Unique identifier for each meal served. Value examples: ['1', '2'].),\n  (compartment:text, The compartment in which the meal is served (e.g. 'First Class', 'Economy'). Value examples: ['First Class', 'First Class'].),\n  (meal_description:text, One of 'Breakfast', 'Lunch', 'Dinner'. Value examples: ['Breakfast', 'Lunch'].),\n]\n# Table: ground_service\n[\n  (city_code:text, The code for the city where the ground service is provided. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The 3-letter code for the airport where the ground service is provided. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (transport_type:text, The type of ground transportation provided. Value examples: ['Taxi', 'Shuttle', 'Bus', 'Car Rental'].),\n  (ground_fare:bigint, The fare charged for ground transportation. Value examples: ['50', '40', '30', '60'].),\n]\n# Table: month\n[\n  (month_number:bigint, A unique number assigned to each month of the year.. Value examples: ['1', '2', '3', '4'].),\n  (month_name:text, The name of the month, e.g. January, February, etc.. Value examples: ['January', 'February', 'March', 'April'].),\n]\n# Table: restriction\n[\n  (restriction_code:text, A code representing the type of restriction, such as blackout dates or minimum stay.. Value examples: ['NONE', 'NONE', 'NONE', 'NONE'].),\n  (advance_purchase:bigint, The number of days in advance the fare must be purchased.. Value examples: ['14', '14', '14', '14'].),\n  (stopovers:text, The number of stopovers allowed for the fare.. Value examples: ['2', '2', '2', '2'].),\n  (saturday_stay_required:text, Indicates whether a Saturday night stay is required for the fare. Either 'Yes' or 'No'.. Value examples: ['No', 'No', 'No', 'No'].),\n  (minimum_stay:bigint, The minimum length of stay required for the fare.. Value examples: ['7', '7', '7', '7'].),\n  (maximum_stay:bigint, The maximum length of stay allowed for the fare.. Value examples: ['30', '30', '30', '30'].),\n  (application:text, The type of fare application. Either 'One Way' or 'Round Trip'.. Value examples: ['One-Way', 'One-Way', 'One-Way', 'One-Way'].),\n  (no_discounts:text, Indicates whether the fare is eligible for discounts or promotions. Either 'Yes' or 'No'.. Value examples: ['Yes', 'Yes', 'Yes', 'Yes'].),\n]\n# Table: state\n[\n  (state_code:text, The 2-letter code assigned to the state. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA'].),\n  (state_name:text, The name of the state. Value examples: ['New York', 'California'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States'].),\n]\n# Table: time_interval\n[\n  (period:text, The period of the time interval, represented as a string. For example, 'daily', 'weekly', 'monthly', etc.. Value examples: ['daily', 'daily', 'daily'].),\n  (begin_time:bigint, The beginning time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577836800', '1577844000', '1577851200'].),\n  (end_time:bigint, The end time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577840400', '1577847600', '1577854800'].),\n]\n# Table: time_zone\n[\n  (time_zone_code:text, A short code that represents the time zone. For example, 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['PST', 'MST'].),\n  (time_zone_name:text, The name of the time zone. Value examples: ['Pacific Standard Time', 'Mountain Standard Time'].),\n  (hours_from_gmt:bigint, The number of hours that the time zone is ahead or behind Greenwich Mean Time (GMT). Value examples: ['-8', '-7'].),\n]\n\n【Foreign keys】\nairline.airline_code = flight.airline_code\nairline.airline_code = flight_stop.departure_airline\nairport.airport_code = fare.from_airport\nairport.airport_code = flight_stop.stop_airport\nairport_service.city_code = ground_service.city_code\nairport.state_code = city.state_code\nairport.state_code = state.state_code\ncity.state_code = state.state_code\nairport_service.city_code = city.city_code\nground_service.city_code = city.city_code\nairport.time_zone_code = time_zone.time_zone_code\ncity.time_zone_code = time_zone.time_zone_code\nflight.flight_id = flight_fare.flight_id\nflight.flight_id = flight_leg.flight_id\nflight.flight_id = flight_stop.flight_id\nflight_fare.flight_id = flight_leg.flight_id\nflight_fare.flight_id = flight_stop.flight_id\nflight_leg.flight_id = flight_stop.flight_id\naircraft.aircraft_code = equipment_sequence.aircraft_code\nflight.aircraft_code_sequence = equipment_sequence.aircraft_code_sequence\nflight.meal_code = food_service.meal_code\n\n【参考信息】\n\n\n【用户问题】\nWhich aircraft code can carry the highest weight of cargo that any aircraft can carry?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT aircraft.aircraft_code FROM aircraft ORDER BY pay_load DESC NULLS LAST LIMIT 1;",
        "role": "assistant"
      }
    ],
    "db_name": "atis",
    "id": 72,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the top 2 airlines with the most flights?\n\n【数据库schema】\n【DB_ID】 atis\n【Schema】\n# Table: aircraft\n[\n  (aircraft_code:text, The code assigned to the aircraft by the International Air Transport Association (IATA).. Value examples: ['B747', 'A320'].),\n  (aircraft_description:text, A short description of the aircraft.. Value examples: ['The Boeing 747 is a wide-body airliner.', 'The Airbus A320 is a narrow-body airliner.'].),\n  (manufacturer:text, The name of the manufacturer of the aircraft.. Value examples: ['Boeing', 'Airbus'].),\n  (basic_type:text, The basic type of the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (engines:bigint, The number of engines the aircraft has.. Value examples: ['4', '2'].),\n  (propulsion:text, The type of propulsion used by the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (wide_body:text, Indicates whether the aircraft is a wide body or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'No'].),\n  (wing_span:bigint, The distance between the tips of the aircraft's wings in feet.. Value examples: ['224', '111'].),\n  (length:bigint, The length of the aircraft in feet.. Value examples: ['231', '123'].),\n  (weight:bigint, The weight of the aircraft in pounds.. Value examples: ['987000', '162000'].),\n  (capacity:bigint, The maximum number of passengers the aircraft can carry.. Value examples: ['416', '240'].),\n  (pay_load:bigint, The maximum weight of cargo the aircraft can carry.. Value examples: ['60000', '30000'].),\n  (cruising_speed:bigint, The speed at which the aircraft cruises in miles per hour.. Value examples: ['570', '511'].),\n  (range_miles:bigint, The maximum distance the aircraft can fly in miles.. Value examples: ['8555', '3300'].),\n  (pressurized:text, Indicates whether the aircraft is pressurized or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'Yes'].),\n]\n# Table: airline\n[\n  (airline_code:text, The code assigned to the airline. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (airline_name:text, The name of the airline. Value examples: ['American Airlines', 'United Airlines', 'Delta Air Lines', 'Southwest Airlines'].),\n  (note:text, Any additional notes or comments about the airline. Value examples: ['NULL', 'NULL', 'NULL', 'NULL'].),\n]\n# Table: airport\n[\n  (airport_code:text, The code assigned to the airport.. Value examples: ['JFK', 'LAX', 'ORD', 'DFW'].),\n  (airport_name:text, The name of the airport.. Value examples: ['John F. Kennedy International Airport', 'Los Angeles International Airport', 'O’Hare International Airport', 'Dallas/Fort Worth International Airport'].),\n  (airport_location:text, The location of the airport, eg 'Las Vegas', 'Chicago'. Value examples: ['New York City', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The code assigned to the state where the airport is located.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the airport is located.. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the airport is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n  (minimum_connect_time:bigint, The minimum amount of time required for a connecting flight at the airport.. Value examples: ['23', '20', '24', '40'].),\n]\n# Table: airport_service\n[\n  (city_code:text, The code of the city where the airport is located. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The code of the airport. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (miles_distant:bigint, The distance of the airport from the city in miles. Value examples: ['10', '20', '30', '40'].),\n  (direction:text, The direction of the airport from the city. Either 'North', 'South', 'East', 'West', 'Northeast', 'Northwest', 'Southeast', or 'Southwest'.. Value examples: ['North', 'South', 'East', 'West'].),\n  (minutes_distant:bigint, The distance of the airport from the city in minutes. Value examples: ['20', '40', '60', '80'].),\n]\n# Table: city\n[\n  (city_code:text, The code assigned to the city. Value examples: ['NYC', 'LA', 'CHI', 'DA'].),\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The 2-letter code assigned to the state where the city is located. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the city is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n]\n# Table: class_of_service\n[\n  (booking_class:text, The booking class code for the class of service. Value examples: ['First', 'Business', 'Economy'].),\n  (rank:bigint, The rank of the class of service. Value examples: ['1', '2', '3'].),\n  (class_description:text, A brief description of the class of service. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: code_description\n[\n  (code:text, The code column contains a unique identifier for each record in the table.. Value examples: ['ABC', 'DEF'].),\n  (description:text, The description column contains a textual description of the code.. Value examples: ['Code ABC', 'Code DEF'].),\n]\n# Table: compartment_class\n[\n  (compartment:text, The compartment column contains the name of a compartment. Either 'First', 'Business', or 'Economy'.. Value examples: ['First', 'Business', 'Economy'].),\n  (class_type:text, The class_type column contains the type of a class. Either 'First Class', 'Business Class', or 'Economy Class'.. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: days\n[\n  (days_code:text, A code representing a day of the week. Value examples: ['1', '2'].),\n  (day_name:text, The name of a day of the week. Either 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', or 'Sunday'.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: dual_carrier\n[\n  (main_airline:text, The name of the main airline operating the flight. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (low_flight_number:bigint, The lowest flight number in the range of flights operated by the dual carrier. Value examples: ['1', '11', '21', '31'].),\n  (high_flight_number:bigint, The highest flight number in the range of flights operated by the dual carrier. Value examples: ['10', '20', '30', '40'].),\n  (dual_airline:text, The name of the dual airline operating the flight. Value examples: ['VX', 'DL', 'UA', 'AS'].),\n  (service_name:text, The name of the service provided by the dual carrier on the flight. Value examples: ['Dual Service 1', 'Dual Service 2', 'Dual Service 3', 'Dual Service 4'].),\n]\n# Table: equipment_sequence\n[\n  (aircraft_code_sequence:text, Sequence number for each aircraft code. Value examples: ['1', '2', '3', '4'].),\n  (aircraft_code:text, Code for each aircraft. Value examples: ['B747', 'A320', 'B737', 'A380'].),\n]\n# Table: fare\n[\n  (fare_id:bigint, The unique identifier for this fare. Value examples: ['1', '2'].),\n  (from_airport:text, The 3-letter airport code for the departure location. Value examples: ['ORD', 'ORD'].),\n  (to_airport:text, The 3-letter airport code for the arrival location. Value examples: ['JFK', 'JFK'].),\n  (fare_basis_code:text, The code used to determine the fare's pricing rules. Value examples: ['ABC', 'DEF'].),\n  (fare_airline:text, The airline code associated with this fare. Value examples: ['AA', 'UA'].),\n  (restriction_code:text, Any restrictions or limitations associated with this fare. Value examples: ['NONE', 'NONE'].),\n  (one_direction_cost:bigint, The cost of a one-way trip for this fare. Value examples: ['200', '150'].),\n  (round_trip_cost:bigint, The cost of a round-trip for this fare. Value examples: ['300', '280'].),\n  (round_trip_required:text, Indicates whether a round-trip is required to purchase this fare. Either Yes or No.. Value examples: ['Yes', 'No'].),\n]\n# Table: fare_basis\n[\n  (fare_basis_code:text, The code that identifies the fare basis. Value examples: ['ABC', 'DEF', 'GHI', 'JKL'].),\n  (booking_class:text, The booking class associated with the fare basis. Either 'First', 'Business', or 'Economy'. Value examples: ['First', 'Business', 'Economy', 'First'].),\n  (class_type:text, The class type associated with the fare basis. Either 'First Class', 'Business Class', or 'Economy Class'. Value examples: ['First Class', 'Business Class', 'Economy Class', 'First Class'].),\n  (premium:text, Indicates whether the fare basis is for a premium class. Value examples: ['Yes', 'Yes', 'No', 'Yes'].),\n  (economy:text, Indicates whether the fare basis is for an economy class. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (discounted:text, Indicates whether the fare basis is for a discounted fare. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (night:text, Indicates whether the fare basis is for a night fare. Value examples: ['No', 'No', 'No', 'No'].),\n  (season:text, The season associated with the fare basis. Can only be 'Peak' or 'Regular'. Value examples: ['Regular', 'Regular', 'Regular', 'Regular'].),\n  (basis_days:text, The number of days the fare basis is valid for. Value examples: ['30', '30', '30', '30'].),\n]\n# Table: flight\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['3', '4', '5', '7'].),\n  (flight_days:text, Days of the week the flight operates on. Formatted as comma-delimited 3-letter abbreviations, e.g. `mon,tue,wed` or `tues,thurs`. Value examples: ['wed', 'thu', 'fri', 'sun'].),\n  (from_airport:text, Code assigned to the departure airport. Value examples: ['ORD', 'ORD', 'ORD', 'JFK'].),\n  (to_airport:text, Code assigned to the arrival airport. Value examples: ['JFK', 'JFK', 'LAX', 'ORD'].),\n  (departure_time:bigint, Epoch timestamp for departure time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577858400', '1577865600', '1577880000'].),\n  (arrival_time:bigint, Epoch timestamp for arrival time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577854900', '1577873400', '1577869600', '1577883700'].),\n  (airline_flight:text, Code assigned to the airline flight. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (airline_code:text, Code assigned to the airline. Value examples: ['AA', 'WN', 'AS', 'UA'].),\n  (flight_number:text, Flight number assigned by the airline. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (aircraft_code_sequence:text, Code assigned to the aircraft. Value examples: ['3', '4', '5', '7'].),\n  (meal_code:text, Code assigned to the meal provided during the flight. Value examples: ['DN', 'BS', 'BF', 'DN'].),\n  (stops:bigint, Number of stops during the flight. Value examples: ['0', '1', '0', '0'].),\n  (connections:bigint, Number of connections during the flight. Value examples: ['0', '1', '0', '0'].),\n  (dual_carrier:text, Code assigned to the dual carrier. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (time_elapsed:bigint, Total time elapsed during the flight in seconds. Value examples: ['3700', '15000', '4000', '3700'].),\n]\n# Table: flight_fare\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3', '4'].),\n  (fare_id:bigint, Unique identifier for each fare. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: flight_leg\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3'].),\n  (leg_number:bigint, The sequence number of the leg within the flight. Value examples: ['1', '1', '1'].),\n  (leg_flight:bigint, The flight ID of the leg's corresponding flight. Value examples: ['1', '2', '3'].),\n]\n# Table: flight_stop\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['2', '4'].),\n  (stop_number:bigint, The order of the stop in the flight. Value examples: ['1', '1'].),\n  (stop_days:text, Days of the week on which the flight stops at this airport. Value examples: ['2', '4'].),\n  (stop_airport:text, The 3-letter airport code of the stop. Value examples: ['DFW', 'DEN'].),\n  (arrival_time:bigint, The time at which the flight arrives at this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577847600', '1577862000'].),\n  (arrival_airline:text, The airline code of the arriving flight. Value examples: ['UA', 'WN'].),\n  (arrival_flight_number:text, Flight number of the arriving flight at this stop. Value examples: ['UA456', 'WN012'].),\n  (departure_time:bigint, The time at which the flight departs from this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577865600'].),\n  (departure_airline:text, The airline code of the departing flight. Value examples: ['UA', 'WN'].),\n  (departure_flight_number:text, Flight number of the departing flight from this stop. Value examples: ['UA456', 'WN012'].),\n  (stop_time:bigint, The duration of the stop at this airport. Value examples: ['3600', '3600'].),\n]\n# Table: food_service\n[\n  (meal_code:text, Code assigned to each meal type. Value examples: ['BF', 'LN'].),\n  (meal_number:bigint, Unique identifier for each meal served. Value examples: ['1', '2'].),\n  (compartment:text, The compartment in which the meal is served (e.g. 'First Class', 'Economy'). Value examples: ['First Class', 'First Class'].),\n  (meal_description:text, One of 'Breakfast', 'Lunch', 'Dinner'. Value examples: ['Breakfast', 'Lunch'].),\n]\n# Table: ground_service\n[\n  (city_code:text, The code for the city where the ground service is provided. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The 3-letter code for the airport where the ground service is provided. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (transport_type:text, The type of ground transportation provided. Value examples: ['Taxi', 'Shuttle', 'Bus', 'Car Rental'].),\n  (ground_fare:bigint, The fare charged for ground transportation. Value examples: ['50', '40', '30', '60'].),\n]\n# Table: month\n[\n  (month_number:bigint, A unique number assigned to each month of the year.. Value examples: ['1', '2', '3', '4'].),\n  (month_name:text, The name of the month, e.g. January, February, etc.. Value examples: ['January', 'February', 'March', 'April'].),\n]\n# Table: restriction\n[\n  (restriction_code:text, A code representing the type of restriction, such as blackout dates or minimum stay.. Value examples: ['NONE', 'NONE', 'NONE', 'NONE'].),\n  (advance_purchase:bigint, The number of days in advance the fare must be purchased.. Value examples: ['14', '14', '14', '14'].),\n  (stopovers:text, The number of stopovers allowed for the fare.. Value examples: ['2', '2', '2', '2'].),\n  (saturday_stay_required:text, Indicates whether a Saturday night stay is required for the fare. Either 'Yes' or 'No'.. Value examples: ['No', 'No', 'No', 'No'].),\n  (minimum_stay:bigint, The minimum length of stay required for the fare.. Value examples: ['7', '7', '7', '7'].),\n  (maximum_stay:bigint, The maximum length of stay allowed for the fare.. Value examples: ['30', '30', '30', '30'].),\n  (application:text, The type of fare application. Either 'One Way' or 'Round Trip'.. Value examples: ['One-Way', 'One-Way', 'One-Way', 'One-Way'].),\n  (no_discounts:text, Indicates whether the fare is eligible for discounts or promotions. Either 'Yes' or 'No'.. Value examples: ['Yes', 'Yes', 'Yes', 'Yes'].),\n]\n# Table: state\n[\n  (state_code:text, The 2-letter code assigned to the state. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA'].),\n  (state_name:text, The name of the state. Value examples: ['New York', 'California'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States'].),\n]\n# Table: time_interval\n[\n  (period:text, The period of the time interval, represented as a string. For example, 'daily', 'weekly', 'monthly', etc.. Value examples: ['daily', 'daily', 'daily'].),\n  (begin_time:bigint, The beginning time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577836800', '1577844000', '1577851200'].),\n  (end_time:bigint, The end time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577840400', '1577847600', '1577854800'].),\n]\n# Table: time_zone\n[\n  (time_zone_code:text, A short code that represents the time zone. For example, 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['PST', 'MST'].),\n  (time_zone_name:text, The name of the time zone. Value examples: ['Pacific Standard Time', 'Mountain Standard Time'].),\n  (hours_from_gmt:bigint, The number of hours that the time zone is ahead or behind Greenwich Mean Time (GMT). Value examples: ['-8', '-7'].),\n]\n\n【Foreign keys】\nairline.airline_code = flight.airline_code\nairline.airline_code = flight_stop.departure_airline\nairport.airport_code = fare.from_airport\nairport.airport_code = flight_stop.stop_airport\nairport_service.city_code = ground_service.city_code\nairport.state_code = city.state_code\nairport.state_code = state.state_code\ncity.state_code = state.state_code\nairport_service.city_code = city.city_code\nground_service.city_code = city.city_code\nairport.time_zone_code = time_zone.time_zone_code\ncity.time_zone_code = time_zone.time_zone_code\nflight.flight_id = flight_fare.flight_id\nflight.flight_id = flight_leg.flight_id\nflight.flight_id = flight_stop.flight_id\nflight_fare.flight_id = flight_leg.flight_id\nflight_fare.flight_id = flight_stop.flight_id\nflight_leg.flight_id = flight_stop.flight_id\naircraft.aircraft_code = equipment_sequence.aircraft_code\nflight.aircraft_code_sequence = equipment_sequence.aircraft_code_sequence\nflight.meal_code = food_service.meal_code\n\n【参考信息】\n\n\n【用户问题】\nWhat are the top 2 airlines with the most flights?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT airline.airline_name, airline.airline_code, COUNT(flight.flight_id) AS number_of_flights FROM flight JOIN airline ON flight.airline_code = airline.airline_code GROUP BY airline.airline_name, airline.airline_code ORDER BY number_of_flights DESC NULLS LAST LIMIT 2",
        "role": "assistant"
      }
    ],
    "db_name": "atis",
    "id": 73,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the aircraft codes for all aircraft with a cruising speed of over 200 mph? sort the aircraft codes in ascending order.\n\n【数据库schema】\n【DB_ID】 atis\n【Schema】\n# Table: aircraft\n[\n  (aircraft_code:text, The code assigned to the aircraft by the International Air Transport Association (IATA).. Value examples: ['B747', 'A320'].),\n  (aircraft_description:text, A short description of the aircraft.. Value examples: ['The Boeing 747 is a wide-body airliner.', 'The Airbus A320 is a narrow-body airliner.'].),\n  (manufacturer:text, The name of the manufacturer of the aircraft.. Value examples: ['Boeing', 'Airbus'].),\n  (basic_type:text, The basic type of the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (engines:bigint, The number of engines the aircraft has.. Value examples: ['4', '2'].),\n  (propulsion:text, The type of propulsion used by the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (wide_body:text, Indicates whether the aircraft is a wide body or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'No'].),\n  (wing_span:bigint, The distance between the tips of the aircraft's wings in feet.. Value examples: ['224', '111'].),\n  (length:bigint, The length of the aircraft in feet.. Value examples: ['231', '123'].),\n  (weight:bigint, The weight of the aircraft in pounds.. Value examples: ['987000', '162000'].),\n  (capacity:bigint, The maximum number of passengers the aircraft can carry.. Value examples: ['416', '240'].),\n  (pay_load:bigint, The maximum weight of cargo the aircraft can carry.. Value examples: ['60000', '30000'].),\n  (cruising_speed:bigint, The speed at which the aircraft cruises in miles per hour.. Value examples: ['570', '511'].),\n  (range_miles:bigint, The maximum distance the aircraft can fly in miles.. Value examples: ['8555', '3300'].),\n  (pressurized:text, Indicates whether the aircraft is pressurized or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'Yes'].),\n]\n# Table: airline\n[\n  (airline_code:text, The code assigned to the airline. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (airline_name:text, The name of the airline. Value examples: ['American Airlines', 'United Airlines', 'Delta Air Lines', 'Southwest Airlines'].),\n  (note:text, Any additional notes or comments about the airline. Value examples: ['NULL', 'NULL', 'NULL', 'NULL'].),\n]\n# Table: airport\n[\n  (airport_code:text, The code assigned to the airport.. Value examples: ['JFK', 'LAX', 'ORD', 'DFW'].),\n  (airport_name:text, The name of the airport.. Value examples: ['John F. Kennedy International Airport', 'Los Angeles International Airport', 'O’Hare International Airport', 'Dallas/Fort Worth International Airport'].),\n  (airport_location:text, The location of the airport, eg 'Las Vegas', 'Chicago'. Value examples: ['New York City', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The code assigned to the state where the airport is located.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the airport is located.. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the airport is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n  (minimum_connect_time:bigint, The minimum amount of time required for a connecting flight at the airport.. Value examples: ['23', '20', '24', '40'].),\n]\n# Table: airport_service\n[\n  (city_code:text, The code of the city where the airport is located. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The code of the airport. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (miles_distant:bigint, The distance of the airport from the city in miles. Value examples: ['10', '20', '30', '40'].),\n  (direction:text, The direction of the airport from the city. Either 'North', 'South', 'East', 'West', 'Northeast', 'Northwest', 'Southeast', or 'Southwest'.. Value examples: ['North', 'South', 'East', 'West'].),\n  (minutes_distant:bigint, The distance of the airport from the city in minutes. Value examples: ['20', '40', '60', '80'].),\n]\n# Table: city\n[\n  (city_code:text, The code assigned to the city. Value examples: ['NYC', 'LA', 'CHI', 'DA'].),\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The 2-letter code assigned to the state where the city is located. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the city is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n]\n# Table: class_of_service\n[\n  (booking_class:text, The booking class code for the class of service. Value examples: ['First', 'Business', 'Economy'].),\n  (rank:bigint, The rank of the class of service. Value examples: ['1', '2', '3'].),\n  (class_description:text, A brief description of the class of service. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: code_description\n[\n  (code:text, The code column contains a unique identifier for each record in the table.. Value examples: ['ABC', 'DEF'].),\n  (description:text, The description column contains a textual description of the code.. Value examples: ['Code ABC', 'Code DEF'].),\n]\n# Table: compartment_class\n[\n  (compartment:text, The compartment column contains the name of a compartment. Either 'First', 'Business', or 'Economy'.. Value examples: ['First', 'Business', 'Economy'].),\n  (class_type:text, The class_type column contains the type of a class. Either 'First Class', 'Business Class', or 'Economy Class'.. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: days\n[\n  (days_code:text, A code representing a day of the week. Value examples: ['1', '2'].),\n  (day_name:text, The name of a day of the week. Either 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', or 'Sunday'.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: dual_carrier\n[\n  (main_airline:text, The name of the main airline operating the flight. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (low_flight_number:bigint, The lowest flight number in the range of flights operated by the dual carrier. Value examples: ['1', '11', '21', '31'].),\n  (high_flight_number:bigint, The highest flight number in the range of flights operated by the dual carrier. Value examples: ['10', '20', '30', '40'].),\n  (dual_airline:text, The name of the dual airline operating the flight. Value examples: ['VX', 'DL', 'UA', 'AS'].),\n  (service_name:text, The name of the service provided by the dual carrier on the flight. Value examples: ['Dual Service 1', 'Dual Service 2', 'Dual Service 3', 'Dual Service 4'].),\n]\n# Table: equipment_sequence\n[\n  (aircraft_code_sequence:text, Sequence number for each aircraft code. Value examples: ['1', '2', '3', '4'].),\n  (aircraft_code:text, Code for each aircraft. Value examples: ['B747', 'A320', 'B737', 'A380'].),\n]\n# Table: fare\n[\n  (fare_id:bigint, The unique identifier for this fare. Value examples: ['1', '2'].),\n  (from_airport:text, The 3-letter airport code for the departure location. Value examples: ['ORD', 'ORD'].),\n  (to_airport:text, The 3-letter airport code for the arrival location. Value examples: ['JFK', 'JFK'].),\n  (fare_basis_code:text, The code used to determine the fare's pricing rules. Value examples: ['ABC', 'DEF'].),\n  (fare_airline:text, The airline code associated with this fare. Value examples: ['AA', 'UA'].),\n  (restriction_code:text, Any restrictions or limitations associated with this fare. Value examples: ['NONE', 'NONE'].),\n  (one_direction_cost:bigint, The cost of a one-way trip for this fare. Value examples: ['200', '150'].),\n  (round_trip_cost:bigint, The cost of a round-trip for this fare. Value examples: ['300', '280'].),\n  (round_trip_required:text, Indicates whether a round-trip is required to purchase this fare. Either Yes or No.. Value examples: ['Yes', 'No'].),\n]\n# Table: fare_basis\n[\n  (fare_basis_code:text, The code that identifies the fare basis. Value examples: ['ABC', 'DEF', 'GHI', 'JKL'].),\n  (booking_class:text, The booking class associated with the fare basis. Either 'First', 'Business', or 'Economy'. Value examples: ['First', 'Business', 'Economy', 'First'].),\n  (class_type:text, The class type associated with the fare basis. Either 'First Class', 'Business Class', or 'Economy Class'. Value examples: ['First Class', 'Business Class', 'Economy Class', 'First Class'].),\n  (premium:text, Indicates whether the fare basis is for a premium class. Value examples: ['Yes', 'Yes', 'No', 'Yes'].),\n  (economy:text, Indicates whether the fare basis is for an economy class. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (discounted:text, Indicates whether the fare basis is for a discounted fare. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (night:text, Indicates whether the fare basis is for a night fare. Value examples: ['No', 'No', 'No', 'No'].),\n  (season:text, The season associated with the fare basis. Can only be 'Peak' or 'Regular'. Value examples: ['Regular', 'Regular', 'Regular', 'Regular'].),\n  (basis_days:text, The number of days the fare basis is valid for. Value examples: ['30', '30', '30', '30'].),\n]\n# Table: flight\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['3', '4', '5', '7'].),\n  (flight_days:text, Days of the week the flight operates on. Formatted as comma-delimited 3-letter abbreviations, e.g. `mon,tue,wed` or `tues,thurs`. Value examples: ['wed', 'thu', 'fri', 'sun'].),\n  (from_airport:text, Code assigned to the departure airport. Value examples: ['ORD', 'ORD', 'ORD', 'JFK'].),\n  (to_airport:text, Code assigned to the arrival airport. Value examples: ['JFK', 'JFK', 'LAX', 'ORD'].),\n  (departure_time:bigint, Epoch timestamp for departure time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577858400', '1577865600', '1577880000'].),\n  (arrival_time:bigint, Epoch timestamp for arrival time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577854900', '1577873400', '1577869600', '1577883700'].),\n  (airline_flight:text, Code assigned to the airline flight. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (airline_code:text, Code assigned to the airline. Value examples: ['AA', 'WN', 'AS', 'UA'].),\n  (flight_number:text, Flight number assigned by the airline. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (aircraft_code_sequence:text, Code assigned to the aircraft. Value examples: ['3', '4', '5', '7'].),\n  (meal_code:text, Code assigned to the meal provided during the flight. Value examples: ['DN', 'BS', 'BF', 'DN'].),\n  (stops:bigint, Number of stops during the flight. Value examples: ['0', '1', '0', '0'].),\n  (connections:bigint, Number of connections during the flight. Value examples: ['0', '1', '0', '0'].),\n  (dual_carrier:text, Code assigned to the dual carrier. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (time_elapsed:bigint, Total time elapsed during the flight in seconds. Value examples: ['3700', '15000', '4000', '3700'].),\n]\n# Table: flight_fare\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3', '4'].),\n  (fare_id:bigint, Unique identifier for each fare. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: flight_leg\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3'].),\n  (leg_number:bigint, The sequence number of the leg within the flight. Value examples: ['1', '1', '1'].),\n  (leg_flight:bigint, The flight ID of the leg's corresponding flight. Value examples: ['1', '2', '3'].),\n]\n# Table: flight_stop\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['2', '4'].),\n  (stop_number:bigint, The order of the stop in the flight. Value examples: ['1', '1'].),\n  (stop_days:text, Days of the week on which the flight stops at this airport. Value examples: ['2', '4'].),\n  (stop_airport:text, The 3-letter airport code of the stop. Value examples: ['DFW', 'DEN'].),\n  (arrival_time:bigint, The time at which the flight arrives at this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577847600', '1577862000'].),\n  (arrival_airline:text, The airline code of the arriving flight. Value examples: ['UA', 'WN'].),\n  (arrival_flight_number:text, Flight number of the arriving flight at this stop. Value examples: ['UA456', 'WN012'].),\n  (departure_time:bigint, The time at which the flight departs from this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577865600'].),\n  (departure_airline:text, The airline code of the departing flight. Value examples: ['UA', 'WN'].),\n  (departure_flight_number:text, Flight number of the departing flight from this stop. Value examples: ['UA456', 'WN012'].),\n  (stop_time:bigint, The duration of the stop at this airport. Value examples: ['3600', '3600'].),\n]\n# Table: food_service\n[\n  (meal_code:text, Code assigned to each meal type. Value examples: ['BF', 'LN'].),\n  (meal_number:bigint, Unique identifier for each meal served. Value examples: ['1', '2'].),\n  (compartment:text, The compartment in which the meal is served (e.g. 'First Class', 'Economy'). Value examples: ['First Class', 'First Class'].),\n  (meal_description:text, One of 'Breakfast', 'Lunch', 'Dinner'. Value examples: ['Breakfast', 'Lunch'].),\n]\n# Table: ground_service\n[\n  (city_code:text, The code for the city where the ground service is provided. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The 3-letter code for the airport where the ground service is provided. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (transport_type:text, The type of ground transportation provided. Value examples: ['Taxi', 'Shuttle', 'Bus', 'Car Rental'].),\n  (ground_fare:bigint, The fare charged for ground transportation. Value examples: ['50', '40', '30', '60'].),\n]\n# Table: month\n[\n  (month_number:bigint, A unique number assigned to each month of the year.. Value examples: ['1', '2', '3', '4'].),\n  (month_name:text, The name of the month, e.g. January, February, etc.. Value examples: ['January', 'February', 'March', 'April'].),\n]\n# Table: restriction\n[\n  (restriction_code:text, A code representing the type of restriction, such as blackout dates or minimum stay.. Value examples: ['NONE', 'NONE', 'NONE', 'NONE'].),\n  (advance_purchase:bigint, The number of days in advance the fare must be purchased.. Value examples: ['14', '14', '14', '14'].),\n  (stopovers:text, The number of stopovers allowed for the fare.. Value examples: ['2', '2', '2', '2'].),\n  (saturday_stay_required:text, Indicates whether a Saturday night stay is required for the fare. Either 'Yes' or 'No'.. Value examples: ['No', 'No', 'No', 'No'].),\n  (minimum_stay:bigint, The minimum length of stay required for the fare.. Value examples: ['7', '7', '7', '7'].),\n  (maximum_stay:bigint, The maximum length of stay allowed for the fare.. Value examples: ['30', '30', '30', '30'].),\n  (application:text, The type of fare application. Either 'One Way' or 'Round Trip'.. Value examples: ['One-Way', 'One-Way', 'One-Way', 'One-Way'].),\n  (no_discounts:text, Indicates whether the fare is eligible for discounts or promotions. Either 'Yes' or 'No'.. Value examples: ['Yes', 'Yes', 'Yes', 'Yes'].),\n]\n# Table: state\n[\n  (state_code:text, The 2-letter code assigned to the state. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA'].),\n  (state_name:text, The name of the state. Value examples: ['New York', 'California'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States'].),\n]\n# Table: time_interval\n[\n  (period:text, The period of the time interval, represented as a string. For example, 'daily', 'weekly', 'monthly', etc.. Value examples: ['daily', 'daily', 'daily'].),\n  (begin_time:bigint, The beginning time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577836800', '1577844000', '1577851200'].),\n  (end_time:bigint, The end time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577840400', '1577847600', '1577854800'].),\n]\n# Table: time_zone\n[\n  (time_zone_code:text, A short code that represents the time zone. For example, 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['PST', 'MST'].),\n  (time_zone_name:text, The name of the time zone. Value examples: ['Pacific Standard Time', 'Mountain Standard Time'].),\n  (hours_from_gmt:bigint, The number of hours that the time zone is ahead or behind Greenwich Mean Time (GMT). Value examples: ['-8', '-7'].),\n]\n\n【Foreign keys】\nairline.airline_code = flight.airline_code\nairline.airline_code = flight_stop.departure_airline\nairport.airport_code = fare.from_airport\nairport.airport_code = flight_stop.stop_airport\nairport_service.city_code = ground_service.city_code\nairport.state_code = city.state_code\nairport.state_code = state.state_code\ncity.state_code = state.state_code\nairport_service.city_code = city.city_code\nground_service.city_code = city.city_code\nairport.time_zone_code = time_zone.time_zone_code\ncity.time_zone_code = time_zone.time_zone_code\nflight.flight_id = flight_fare.flight_id\nflight.flight_id = flight_leg.flight_id\nflight.flight_id = flight_stop.flight_id\nflight_fare.flight_id = flight_leg.flight_id\nflight_fare.flight_id = flight_stop.flight_id\nflight_leg.flight_id = flight_stop.flight_id\naircraft.aircraft_code = equipment_sequence.aircraft_code\nflight.aircraft_code_sequence = equipment_sequence.aircraft_code_sequence\nflight.meal_code = food_service.meal_code\n\n【参考信息】\n\n\n【用户问题】\nWhat are the aircraft codes for all aircraft with a cruising speed of over 200 mph? sort the aircraft codes in ascending order.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT aircraft.aircraft_code FROM aircraft WHERE aircraft.cruising_speed > 200 ORDER BY aircraft.aircraft_code ASC NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "atis",
    "id": 74,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nCalculate the ratio of the maximum range to the maximum payload for each aircraft\n\n【数据库schema】\n【DB_ID】 atis\n【Schema】\n# Table: aircraft\n[\n  (aircraft_code:text, The code assigned to the aircraft by the International Air Transport Association (IATA).. Value examples: ['B747', 'A320'].),\n  (aircraft_description:text, A short description of the aircraft.. Value examples: ['The Boeing 747 is a wide-body airliner.', 'The Airbus A320 is a narrow-body airliner.'].),\n  (manufacturer:text, The name of the manufacturer of the aircraft.. Value examples: ['Boeing', 'Airbus'].),\n  (basic_type:text, The basic type of the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (engines:bigint, The number of engines the aircraft has.. Value examples: ['4', '2'].),\n  (propulsion:text, The type of propulsion used by the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (wide_body:text, Indicates whether the aircraft is a wide body or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'No'].),\n  (wing_span:bigint, The distance between the tips of the aircraft's wings in feet.. Value examples: ['224', '111'].),\n  (length:bigint, The length of the aircraft in feet.. Value examples: ['231', '123'].),\n  (weight:bigint, The weight of the aircraft in pounds.. Value examples: ['987000', '162000'].),\n  (capacity:bigint, The maximum number of passengers the aircraft can carry.. Value examples: ['416', '240'].),\n  (pay_load:bigint, The maximum weight of cargo the aircraft can carry.. Value examples: ['60000', '30000'].),\n  (cruising_speed:bigint, The speed at which the aircraft cruises in miles per hour.. Value examples: ['570', '511'].),\n  (range_miles:bigint, The maximum distance the aircraft can fly in miles.. Value examples: ['8555', '3300'].),\n  (pressurized:text, Indicates whether the aircraft is pressurized or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'Yes'].),\n]\n# Table: airline\n[\n  (airline_code:text, The code assigned to the airline. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (airline_name:text, The name of the airline. Value examples: ['American Airlines', 'United Airlines', 'Delta Air Lines', 'Southwest Airlines'].),\n  (note:text, Any additional notes or comments about the airline. Value examples: ['NULL', 'NULL', 'NULL', 'NULL'].),\n]\n# Table: airport\n[\n  (airport_code:text, The code assigned to the airport.. Value examples: ['JFK', 'LAX', 'ORD', 'DFW'].),\n  (airport_name:text, The name of the airport.. Value examples: ['John F. Kennedy International Airport', 'Los Angeles International Airport', 'O’Hare International Airport', 'Dallas/Fort Worth International Airport'].),\n  (airport_location:text, The location of the airport, eg 'Las Vegas', 'Chicago'. Value examples: ['New York City', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The code assigned to the state where the airport is located.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the airport is located.. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the airport is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n  (minimum_connect_time:bigint, The minimum amount of time required for a connecting flight at the airport.. Value examples: ['23', '20', '24', '40'].),\n]\n# Table: airport_service\n[\n  (city_code:text, The code of the city where the airport is located. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The code of the airport. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (miles_distant:bigint, The distance of the airport from the city in miles. Value examples: ['10', '20', '30', '40'].),\n  (direction:text, The direction of the airport from the city. Either 'North', 'South', 'East', 'West', 'Northeast', 'Northwest', 'Southeast', or 'Southwest'.. Value examples: ['North', 'South', 'East', 'West'].),\n  (minutes_distant:bigint, The distance of the airport from the city in minutes. Value examples: ['20', '40', '60', '80'].),\n]\n# Table: city\n[\n  (city_code:text, The code assigned to the city. Value examples: ['NYC', 'LA', 'CHI', 'DA'].),\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The 2-letter code assigned to the state where the city is located. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the city is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n]\n# Table: class_of_service\n[\n  (booking_class:text, The booking class code for the class of service. Value examples: ['First', 'Business', 'Economy'].),\n  (rank:bigint, The rank of the class of service. Value examples: ['1', '2', '3'].),\n  (class_description:text, A brief description of the class of service. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: code_description\n[\n  (code:text, The code column contains a unique identifier for each record in the table.. Value examples: ['ABC', 'DEF'].),\n  (description:text, The description column contains a textual description of the code.. Value examples: ['Code ABC', 'Code DEF'].),\n]\n# Table: compartment_class\n[\n  (compartment:text, The compartment column contains the name of a compartment. Either 'First', 'Business', or 'Economy'.. Value examples: ['First', 'Business', 'Economy'].),\n  (class_type:text, The class_type column contains the type of a class. Either 'First Class', 'Business Class', or 'Economy Class'.. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: days\n[\n  (days_code:text, A code representing a day of the week. Value examples: ['1', '2'].),\n  (day_name:text, The name of a day of the week. Either 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', or 'Sunday'.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: dual_carrier\n[\n  (main_airline:text, The name of the main airline operating the flight. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (low_flight_number:bigint, The lowest flight number in the range of flights operated by the dual carrier. Value examples: ['1', '11', '21', '31'].),\n  (high_flight_number:bigint, The highest flight number in the range of flights operated by the dual carrier. Value examples: ['10', '20', '30', '40'].),\n  (dual_airline:text, The name of the dual airline operating the flight. Value examples: ['VX', 'DL', 'UA', 'AS'].),\n  (service_name:text, The name of the service provided by the dual carrier on the flight. Value examples: ['Dual Service 1', 'Dual Service 2', 'Dual Service 3', 'Dual Service 4'].),\n]\n# Table: equipment_sequence\n[\n  (aircraft_code_sequence:text, Sequence number for each aircraft code. Value examples: ['1', '2', '3', '4'].),\n  (aircraft_code:text, Code for each aircraft. Value examples: ['B747', 'A320', 'B737', 'A380'].),\n]\n# Table: fare\n[\n  (fare_id:bigint, The unique identifier for this fare. Value examples: ['1', '2'].),\n  (from_airport:text, The 3-letter airport code for the departure location. Value examples: ['ORD', 'ORD'].),\n  (to_airport:text, The 3-letter airport code for the arrival location. Value examples: ['JFK', 'JFK'].),\n  (fare_basis_code:text, The code used to determine the fare's pricing rules. Value examples: ['ABC', 'DEF'].),\n  (fare_airline:text, The airline code associated with this fare. Value examples: ['AA', 'UA'].),\n  (restriction_code:text, Any restrictions or limitations associated with this fare. Value examples: ['NONE', 'NONE'].),\n  (one_direction_cost:bigint, The cost of a one-way trip for this fare. Value examples: ['200', '150'].),\n  (round_trip_cost:bigint, The cost of a round-trip for this fare. Value examples: ['300', '280'].),\n  (round_trip_required:text, Indicates whether a round-trip is required to purchase this fare. Either Yes or No.. Value examples: ['Yes', 'No'].),\n]\n# Table: fare_basis\n[\n  (fare_basis_code:text, The code that identifies the fare basis. Value examples: ['ABC', 'DEF', 'GHI', 'JKL'].),\n  (booking_class:text, The booking class associated with the fare basis. Either 'First', 'Business', or 'Economy'. Value examples: ['First', 'Business', 'Economy', 'First'].),\n  (class_type:text, The class type associated with the fare basis. Either 'First Class', 'Business Class', or 'Economy Class'. Value examples: ['First Class', 'Business Class', 'Economy Class', 'First Class'].),\n  (premium:text, Indicates whether the fare basis is for a premium class. Value examples: ['Yes', 'Yes', 'No', 'Yes'].),\n  (economy:text, Indicates whether the fare basis is for an economy class. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (discounted:text, Indicates whether the fare basis is for a discounted fare. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (night:text, Indicates whether the fare basis is for a night fare. Value examples: ['No', 'No', 'No', 'No'].),\n  (season:text, The season associated with the fare basis. Can only be 'Peak' or 'Regular'. Value examples: ['Regular', 'Regular', 'Regular', 'Regular'].),\n  (basis_days:text, The number of days the fare basis is valid for. Value examples: ['30', '30', '30', '30'].),\n]\n# Table: flight\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['3', '4', '5', '7'].),\n  (flight_days:text, Days of the week the flight operates on. Formatted as comma-delimited 3-letter abbreviations, e.g. `mon,tue,wed` or `tues,thurs`. Value examples: ['wed', 'thu', 'fri', 'sun'].),\n  (from_airport:text, Code assigned to the departure airport. Value examples: ['ORD', 'ORD', 'ORD', 'JFK'].),\n  (to_airport:text, Code assigned to the arrival airport. Value examples: ['JFK', 'JFK', 'LAX', 'ORD'].),\n  (departure_time:bigint, Epoch timestamp for departure time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577858400', '1577865600', '1577880000'].),\n  (arrival_time:bigint, Epoch timestamp for arrival time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577854900', '1577873400', '1577869600', '1577883700'].),\n  (airline_flight:text, Code assigned to the airline flight. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (airline_code:text, Code assigned to the airline. Value examples: ['AA', 'WN', 'AS', 'UA'].),\n  (flight_number:text, Flight number assigned by the airline. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (aircraft_code_sequence:text, Code assigned to the aircraft. Value examples: ['3', '4', '5', '7'].),\n  (meal_code:text, Code assigned to the meal provided during the flight. Value examples: ['DN', 'BS', 'BF', 'DN'].),\n  (stops:bigint, Number of stops during the flight. Value examples: ['0', '1', '0', '0'].),\n  (connections:bigint, Number of connections during the flight. Value examples: ['0', '1', '0', '0'].),\n  (dual_carrier:text, Code assigned to the dual carrier. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (time_elapsed:bigint, Total time elapsed during the flight in seconds. Value examples: ['3700', '15000', '4000', '3700'].),\n]\n# Table: flight_fare\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3', '4'].),\n  (fare_id:bigint, Unique identifier for each fare. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: flight_leg\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3'].),\n  (leg_number:bigint, The sequence number of the leg within the flight. Value examples: ['1', '1', '1'].),\n  (leg_flight:bigint, The flight ID of the leg's corresponding flight. Value examples: ['1', '2', '3'].),\n]\n# Table: flight_stop\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['2', '4'].),\n  (stop_number:bigint, The order of the stop in the flight. Value examples: ['1', '1'].),\n  (stop_days:text, Days of the week on which the flight stops at this airport. Value examples: ['2', '4'].),\n  (stop_airport:text, The 3-letter airport code of the stop. Value examples: ['DFW', 'DEN'].),\n  (arrival_time:bigint, The time at which the flight arrives at this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577847600', '1577862000'].),\n  (arrival_airline:text, The airline code of the arriving flight. Value examples: ['UA', 'WN'].),\n  (arrival_flight_number:text, Flight number of the arriving flight at this stop. Value examples: ['UA456', 'WN012'].),\n  (departure_time:bigint, The time at which the flight departs from this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577865600'].),\n  (departure_airline:text, The airline code of the departing flight. Value examples: ['UA', 'WN'].),\n  (departure_flight_number:text, Flight number of the departing flight from this stop. Value examples: ['UA456', 'WN012'].),\n  (stop_time:bigint, The duration of the stop at this airport. Value examples: ['3600', '3600'].),\n]\n# Table: food_service\n[\n  (meal_code:text, Code assigned to each meal type. Value examples: ['BF', 'LN'].),\n  (meal_number:bigint, Unique identifier for each meal served. Value examples: ['1', '2'].),\n  (compartment:text, The compartment in which the meal is served (e.g. 'First Class', 'Economy'). Value examples: ['First Class', 'First Class'].),\n  (meal_description:text, One of 'Breakfast', 'Lunch', 'Dinner'. Value examples: ['Breakfast', 'Lunch'].),\n]\n# Table: ground_service\n[\n  (city_code:text, The code for the city where the ground service is provided. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The 3-letter code for the airport where the ground service is provided. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (transport_type:text, The type of ground transportation provided. Value examples: ['Taxi', 'Shuttle', 'Bus', 'Car Rental'].),\n  (ground_fare:bigint, The fare charged for ground transportation. Value examples: ['50', '40', '30', '60'].),\n]\n# Table: month\n[\n  (month_number:bigint, A unique number assigned to each month of the year.. Value examples: ['1', '2', '3', '4'].),\n  (month_name:text, The name of the month, e.g. January, February, etc.. Value examples: ['January', 'February', 'March', 'April'].),\n]\n# Table: restriction\n[\n  (restriction_code:text, A code representing the type of restriction, such as blackout dates or minimum stay.. Value examples: ['NONE', 'NONE', 'NONE', 'NONE'].),\n  (advance_purchase:bigint, The number of days in advance the fare must be purchased.. Value examples: ['14', '14', '14', '14'].),\n  (stopovers:text, The number of stopovers allowed for the fare.. Value examples: ['2', '2', '2', '2'].),\n  (saturday_stay_required:text, Indicates whether a Saturday night stay is required for the fare. Either 'Yes' or 'No'.. Value examples: ['No', 'No', 'No', 'No'].),\n  (minimum_stay:bigint, The minimum length of stay required for the fare.. Value examples: ['7', '7', '7', '7'].),\n  (maximum_stay:bigint, The maximum length of stay allowed for the fare.. Value examples: ['30', '30', '30', '30'].),\n  (application:text, The type of fare application. Either 'One Way' or 'Round Trip'.. Value examples: ['One-Way', 'One-Way', 'One-Way', 'One-Way'].),\n  (no_discounts:text, Indicates whether the fare is eligible for discounts or promotions. Either 'Yes' or 'No'.. Value examples: ['Yes', 'Yes', 'Yes', 'Yes'].),\n]\n# Table: state\n[\n  (state_code:text, The 2-letter code assigned to the state. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA'].),\n  (state_name:text, The name of the state. Value examples: ['New York', 'California'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States'].),\n]\n# Table: time_interval\n[\n  (period:text, The period of the time interval, represented as a string. For example, 'daily', 'weekly', 'monthly', etc.. Value examples: ['daily', 'daily', 'daily'].),\n  (begin_time:bigint, The beginning time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577836800', '1577844000', '1577851200'].),\n  (end_time:bigint, The end time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577840400', '1577847600', '1577854800'].),\n]\n# Table: time_zone\n[\n  (time_zone_code:text, A short code that represents the time zone. For example, 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['PST', 'MST'].),\n  (time_zone_name:text, The name of the time zone. Value examples: ['Pacific Standard Time', 'Mountain Standard Time'].),\n  (hours_from_gmt:bigint, The number of hours that the time zone is ahead or behind Greenwich Mean Time (GMT). Value examples: ['-8', '-7'].),\n]\n\n【Foreign keys】\nairline.airline_code = flight.airline_code\nairline.airline_code = flight_stop.departure_airline\nairport.airport_code = fare.from_airport\nairport.airport_code = flight_stop.stop_airport\nairport_service.city_code = ground_service.city_code\nairport.state_code = city.state_code\nairport.state_code = state.state_code\ncity.state_code = state.state_code\nairport_service.city_code = city.city_code\nground_service.city_code = city.city_code\nairport.time_zone_code = time_zone.time_zone_code\ncity.time_zone_code = time_zone.time_zone_code\nflight.flight_id = flight_fare.flight_id\nflight.flight_id = flight_leg.flight_id\nflight.flight_id = flight_stop.flight_id\nflight_fare.flight_id = flight_leg.flight_id\nflight_fare.flight_id = flight_stop.flight_id\nflight_leg.flight_id = flight_stop.flight_id\naircraft.aircraft_code = equipment_sequence.aircraft_code\nflight.aircraft_code_sequence = equipment_sequence.aircraft_code_sequence\nflight.meal_code = food_service.meal_code\n\n【参考信息】\n\n\n【用户问题】\nCalculate the ratio of the maximum range to the maximum payload for each aircraft\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT aircraft.range_miles::float / NULLIF(aircraft.pay_load, 0) AS range_to_payload_ratio FROM aircraft;",
        "role": "assistant"
      }
    ],
    "db_name": "atis",
    "id": 75,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the ratio of one-way trip costs to round-trip costs for each fare?\n\n【数据库schema】\n【DB_ID】 atis\n【Schema】\n# Table: aircraft\n[\n  (aircraft_code:text, The code assigned to the aircraft by the International Air Transport Association (IATA).. Value examples: ['B747', 'A320'].),\n  (aircraft_description:text, A short description of the aircraft.. Value examples: ['The Boeing 747 is a wide-body airliner.', 'The Airbus A320 is a narrow-body airliner.'].),\n  (manufacturer:text, The name of the manufacturer of the aircraft.. Value examples: ['Boeing', 'Airbus'].),\n  (basic_type:text, The basic type of the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (engines:bigint, The number of engines the aircraft has.. Value examples: ['4', '2'].),\n  (propulsion:text, The type of propulsion used by the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (wide_body:text, Indicates whether the aircraft is a wide body or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'No'].),\n  (wing_span:bigint, The distance between the tips of the aircraft's wings in feet.. Value examples: ['224', '111'].),\n  (length:bigint, The length of the aircraft in feet.. Value examples: ['231', '123'].),\n  (weight:bigint, The weight of the aircraft in pounds.. Value examples: ['987000', '162000'].),\n  (capacity:bigint, The maximum number of passengers the aircraft can carry.. Value examples: ['416', '240'].),\n  (pay_load:bigint, The maximum weight of cargo the aircraft can carry.. Value examples: ['60000', '30000'].),\n  (cruising_speed:bigint, The speed at which the aircraft cruises in miles per hour.. Value examples: ['570', '511'].),\n  (range_miles:bigint, The maximum distance the aircraft can fly in miles.. Value examples: ['8555', '3300'].),\n  (pressurized:text, Indicates whether the aircraft is pressurized or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'Yes'].),\n]\n# Table: airline\n[\n  (airline_code:text, The code assigned to the airline. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (airline_name:text, The name of the airline. Value examples: ['American Airlines', 'United Airlines', 'Delta Air Lines', 'Southwest Airlines'].),\n  (note:text, Any additional notes or comments about the airline. Value examples: ['NULL', 'NULL', 'NULL', 'NULL'].),\n]\n# Table: airport\n[\n  (airport_code:text, The code assigned to the airport.. Value examples: ['JFK', 'LAX', 'ORD', 'DFW'].),\n  (airport_name:text, The name of the airport.. Value examples: ['John F. Kennedy International Airport', 'Los Angeles International Airport', 'O’Hare International Airport', 'Dallas/Fort Worth International Airport'].),\n  (airport_location:text, The location of the airport, eg 'Las Vegas', 'Chicago'. Value examples: ['New York City', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The code assigned to the state where the airport is located.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the airport is located.. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the airport is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n  (minimum_connect_time:bigint, The minimum amount of time required for a connecting flight at the airport.. Value examples: ['23', '20', '24', '40'].),\n]\n# Table: airport_service\n[\n  (city_code:text, The code of the city where the airport is located. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The code of the airport. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (miles_distant:bigint, The distance of the airport from the city in miles. Value examples: ['10', '20', '30', '40'].),\n  (direction:text, The direction of the airport from the city. Either 'North', 'South', 'East', 'West', 'Northeast', 'Northwest', 'Southeast', or 'Southwest'.. Value examples: ['North', 'South', 'East', 'West'].),\n  (minutes_distant:bigint, The distance of the airport from the city in minutes. Value examples: ['20', '40', '60', '80'].),\n]\n# Table: city\n[\n  (city_code:text, The code assigned to the city. Value examples: ['NYC', 'LA', 'CHI', 'DA'].),\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The 2-letter code assigned to the state where the city is located. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the city is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n]\n# Table: class_of_service\n[\n  (booking_class:text, The booking class code for the class of service. Value examples: ['First', 'Business', 'Economy'].),\n  (rank:bigint, The rank of the class of service. Value examples: ['1', '2', '3'].),\n  (class_description:text, A brief description of the class of service. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: code_description\n[\n  (code:text, The code column contains a unique identifier for each record in the table.. Value examples: ['ABC', 'DEF'].),\n  (description:text, The description column contains a textual description of the code.. Value examples: ['Code ABC', 'Code DEF'].),\n]\n# Table: compartment_class\n[\n  (compartment:text, The compartment column contains the name of a compartment. Either 'First', 'Business', or 'Economy'.. Value examples: ['First', 'Business', 'Economy'].),\n  (class_type:text, The class_type column contains the type of a class. Either 'First Class', 'Business Class', or 'Economy Class'.. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: days\n[\n  (days_code:text, A code representing a day of the week. Value examples: ['1', '2'].),\n  (day_name:text, The name of a day of the week. Either 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', or 'Sunday'.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: dual_carrier\n[\n  (main_airline:text, The name of the main airline operating the flight. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (low_flight_number:bigint, The lowest flight number in the range of flights operated by the dual carrier. Value examples: ['1', '11', '21', '31'].),\n  (high_flight_number:bigint, The highest flight number in the range of flights operated by the dual carrier. Value examples: ['10', '20', '30', '40'].),\n  (dual_airline:text, The name of the dual airline operating the flight. Value examples: ['VX', 'DL', 'UA', 'AS'].),\n  (service_name:text, The name of the service provided by the dual carrier on the flight. Value examples: ['Dual Service 1', 'Dual Service 2', 'Dual Service 3', 'Dual Service 4'].),\n]\n# Table: equipment_sequence\n[\n  (aircraft_code_sequence:text, Sequence number for each aircraft code. Value examples: ['1', '2', '3', '4'].),\n  (aircraft_code:text, Code for each aircraft. Value examples: ['B747', 'A320', 'B737', 'A380'].),\n]\n# Table: fare\n[\n  (fare_id:bigint, The unique identifier for this fare. Value examples: ['1', '2'].),\n  (from_airport:text, The 3-letter airport code for the departure location. Value examples: ['ORD', 'ORD'].),\n  (to_airport:text, The 3-letter airport code for the arrival location. Value examples: ['JFK', 'JFK'].),\n  (fare_basis_code:text, The code used to determine the fare's pricing rules. Value examples: ['ABC', 'DEF'].),\n  (fare_airline:text, The airline code associated with this fare. Value examples: ['AA', 'UA'].),\n  (restriction_code:text, Any restrictions or limitations associated with this fare. Value examples: ['NONE', 'NONE'].),\n  (one_direction_cost:bigint, The cost of a one-way trip for this fare. Value examples: ['200', '150'].),\n  (round_trip_cost:bigint, The cost of a round-trip for this fare. Value examples: ['300', '280'].),\n  (round_trip_required:text, Indicates whether a round-trip is required to purchase this fare. Either Yes or No.. Value examples: ['Yes', 'No'].),\n]\n# Table: fare_basis\n[\n  (fare_basis_code:text, The code that identifies the fare basis. Value examples: ['ABC', 'DEF', 'GHI', 'JKL'].),\n  (booking_class:text, The booking class associated with the fare basis. Either 'First', 'Business', or 'Economy'. Value examples: ['First', 'Business', 'Economy', 'First'].),\n  (class_type:text, The class type associated with the fare basis. Either 'First Class', 'Business Class', or 'Economy Class'. Value examples: ['First Class', 'Business Class', 'Economy Class', 'First Class'].),\n  (premium:text, Indicates whether the fare basis is for a premium class. Value examples: ['Yes', 'Yes', 'No', 'Yes'].),\n  (economy:text, Indicates whether the fare basis is for an economy class. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (discounted:text, Indicates whether the fare basis is for a discounted fare. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (night:text, Indicates whether the fare basis is for a night fare. Value examples: ['No', 'No', 'No', 'No'].),\n  (season:text, The season associated with the fare basis. Can only be 'Peak' or 'Regular'. Value examples: ['Regular', 'Regular', 'Regular', 'Regular'].),\n  (basis_days:text, The number of days the fare basis is valid for. Value examples: ['30', '30', '30', '30'].),\n]\n# Table: flight\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['3', '4', '5', '7'].),\n  (flight_days:text, Days of the week the flight operates on. Formatted as comma-delimited 3-letter abbreviations, e.g. `mon,tue,wed` or `tues,thurs`. Value examples: ['wed', 'thu', 'fri', 'sun'].),\n  (from_airport:text, Code assigned to the departure airport. Value examples: ['ORD', 'ORD', 'ORD', 'JFK'].),\n  (to_airport:text, Code assigned to the arrival airport. Value examples: ['JFK', 'JFK', 'LAX', 'ORD'].),\n  (departure_time:bigint, Epoch timestamp for departure time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577858400', '1577865600', '1577880000'].),\n  (arrival_time:bigint, Epoch timestamp for arrival time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577854900', '1577873400', '1577869600', '1577883700'].),\n  (airline_flight:text, Code assigned to the airline flight. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (airline_code:text, Code assigned to the airline. Value examples: ['AA', 'WN', 'AS', 'UA'].),\n  (flight_number:text, Flight number assigned by the airline. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (aircraft_code_sequence:text, Code assigned to the aircraft. Value examples: ['3', '4', '5', '7'].),\n  (meal_code:text, Code assigned to the meal provided during the flight. Value examples: ['DN', 'BS', 'BF', 'DN'].),\n  (stops:bigint, Number of stops during the flight. Value examples: ['0', '1', '0', '0'].),\n  (connections:bigint, Number of connections during the flight. Value examples: ['0', '1', '0', '0'].),\n  (dual_carrier:text, Code assigned to the dual carrier. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (time_elapsed:bigint, Total time elapsed during the flight in seconds. Value examples: ['3700', '15000', '4000', '3700'].),\n]\n# Table: flight_fare\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3', '4'].),\n  (fare_id:bigint, Unique identifier for each fare. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: flight_leg\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3'].),\n  (leg_number:bigint, The sequence number of the leg within the flight. Value examples: ['1', '1', '1'].),\n  (leg_flight:bigint, The flight ID of the leg's corresponding flight. Value examples: ['1', '2', '3'].),\n]\n# Table: flight_stop\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['2', '4'].),\n  (stop_number:bigint, The order of the stop in the flight. Value examples: ['1', '1'].),\n  (stop_days:text, Days of the week on which the flight stops at this airport. Value examples: ['2', '4'].),\n  (stop_airport:text, The 3-letter airport code of the stop. Value examples: ['DFW', 'DEN'].),\n  (arrival_time:bigint, The time at which the flight arrives at this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577847600', '1577862000'].),\n  (arrival_airline:text, The airline code of the arriving flight. Value examples: ['UA', 'WN'].),\n  (arrival_flight_number:text, Flight number of the arriving flight at this stop. Value examples: ['UA456', 'WN012'].),\n  (departure_time:bigint, The time at which the flight departs from this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577865600'].),\n  (departure_airline:text, The airline code of the departing flight. Value examples: ['UA', 'WN'].),\n  (departure_flight_number:text, Flight number of the departing flight from this stop. Value examples: ['UA456', 'WN012'].),\n  (stop_time:bigint, The duration of the stop at this airport. Value examples: ['3600', '3600'].),\n]\n# Table: food_service\n[\n  (meal_code:text, Code assigned to each meal type. Value examples: ['BF', 'LN'].),\n  (meal_number:bigint, Unique identifier for each meal served. Value examples: ['1', '2'].),\n  (compartment:text, The compartment in which the meal is served (e.g. 'First Class', 'Economy'). Value examples: ['First Class', 'First Class'].),\n  (meal_description:text, One of 'Breakfast', 'Lunch', 'Dinner'. Value examples: ['Breakfast', 'Lunch'].),\n]\n# Table: ground_service\n[\n  (city_code:text, The code for the city where the ground service is provided. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The 3-letter code for the airport where the ground service is provided. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (transport_type:text, The type of ground transportation provided. Value examples: ['Taxi', 'Shuttle', 'Bus', 'Car Rental'].),\n  (ground_fare:bigint, The fare charged for ground transportation. Value examples: ['50', '40', '30', '60'].),\n]\n# Table: month\n[\n  (month_number:bigint, A unique number assigned to each month of the year.. Value examples: ['1', '2', '3', '4'].),\n  (month_name:text, The name of the month, e.g. January, February, etc.. Value examples: ['January', 'February', 'March', 'April'].),\n]\n# Table: restriction\n[\n  (restriction_code:text, A code representing the type of restriction, such as blackout dates or minimum stay.. Value examples: ['NONE', 'NONE', 'NONE', 'NONE'].),\n  (advance_purchase:bigint, The number of days in advance the fare must be purchased.. Value examples: ['14', '14', '14', '14'].),\n  (stopovers:text, The number of stopovers allowed for the fare.. Value examples: ['2', '2', '2', '2'].),\n  (saturday_stay_required:text, Indicates whether a Saturday night stay is required for the fare. Either 'Yes' or 'No'.. Value examples: ['No', 'No', 'No', 'No'].),\n  (minimum_stay:bigint, The minimum length of stay required for the fare.. Value examples: ['7', '7', '7', '7'].),\n  (maximum_stay:bigint, The maximum length of stay allowed for the fare.. Value examples: ['30', '30', '30', '30'].),\n  (application:text, The type of fare application. Either 'One Way' or 'Round Trip'.. Value examples: ['One-Way', 'One-Way', 'One-Way', 'One-Way'].),\n  (no_discounts:text, Indicates whether the fare is eligible for discounts or promotions. Either 'Yes' or 'No'.. Value examples: ['Yes', 'Yes', 'Yes', 'Yes'].),\n]\n# Table: state\n[\n  (state_code:text, The 2-letter code assigned to the state. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA'].),\n  (state_name:text, The name of the state. Value examples: ['New York', 'California'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States'].),\n]\n# Table: time_interval\n[\n  (period:text, The period of the time interval, represented as a string. For example, 'daily', 'weekly', 'monthly', etc.. Value examples: ['daily', 'daily', 'daily'].),\n  (begin_time:bigint, The beginning time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577836800', '1577844000', '1577851200'].),\n  (end_time:bigint, The end time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577840400', '1577847600', '1577854800'].),\n]\n# Table: time_zone\n[\n  (time_zone_code:text, A short code that represents the time zone. For example, 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['PST', 'MST'].),\n  (time_zone_name:text, The name of the time zone. Value examples: ['Pacific Standard Time', 'Mountain Standard Time'].),\n  (hours_from_gmt:bigint, The number of hours that the time zone is ahead or behind Greenwich Mean Time (GMT). Value examples: ['-8', '-7'].),\n]\n\n【Foreign keys】\nairline.airline_code = flight.airline_code\nairline.airline_code = flight_stop.departure_airline\nairport.airport_code = fare.from_airport\nairport.airport_code = flight_stop.stop_airport\nairport_service.city_code = ground_service.city_code\nairport.state_code = city.state_code\nairport.state_code = state.state_code\ncity.state_code = state.state_code\nairport_service.city_code = city.city_code\nground_service.city_code = city.city_code\nairport.time_zone_code = time_zone.time_zone_code\ncity.time_zone_code = time_zone.time_zone_code\nflight.flight_id = flight_fare.flight_id\nflight.flight_id = flight_leg.flight_id\nflight.flight_id = flight_stop.flight_id\nflight_fare.flight_id = flight_leg.flight_id\nflight_fare.flight_id = flight_stop.flight_id\nflight_leg.flight_id = flight_stop.flight_id\naircraft.aircraft_code = equipment_sequence.aircraft_code\nflight.aircraft_code_sequence = equipment_sequence.aircraft_code_sequence\nflight.meal_code = food_service.meal_code\n\n【参考信息】\n\n\n【用户问题】\nWhat is the ratio of one-way trip costs to round-trip costs for each fare?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT fare.fare_id, fare.one_direction_cost::float / NULLIF(fare.round_trip_cost, 0) AS cost_ratio FROM fare ORDER BY cost_ratio;",
        "role": "assistant"
      }
    ],
    "db_name": "atis",
    "id": 76,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the ratio of aircraft capacity to its range in miles for each aircraft code?\n\n【数据库schema】\n【DB_ID】 atis\n【Schema】\n# Table: aircraft\n[\n  (aircraft_code:text, The code assigned to the aircraft by the International Air Transport Association (IATA).. Value examples: ['B747', 'A320'].),\n  (aircraft_description:text, A short description of the aircraft.. Value examples: ['The Boeing 747 is a wide-body airliner.', 'The Airbus A320 is a narrow-body airliner.'].),\n  (manufacturer:text, The name of the manufacturer of the aircraft.. Value examples: ['Boeing', 'Airbus'].),\n  (basic_type:text, The basic type of the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (engines:bigint, The number of engines the aircraft has.. Value examples: ['4', '2'].),\n  (propulsion:text, The type of propulsion used by the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (wide_body:text, Indicates whether the aircraft is a wide body or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'No'].),\n  (wing_span:bigint, The distance between the tips of the aircraft's wings in feet.. Value examples: ['224', '111'].),\n  (length:bigint, The length of the aircraft in feet.. Value examples: ['231', '123'].),\n  (weight:bigint, The weight of the aircraft in pounds.. Value examples: ['987000', '162000'].),\n  (capacity:bigint, The maximum number of passengers the aircraft can carry.. Value examples: ['416', '240'].),\n  (pay_load:bigint, The maximum weight of cargo the aircraft can carry.. Value examples: ['60000', '30000'].),\n  (cruising_speed:bigint, The speed at which the aircraft cruises in miles per hour.. Value examples: ['570', '511'].),\n  (range_miles:bigint, The maximum distance the aircraft can fly in miles.. Value examples: ['8555', '3300'].),\n  (pressurized:text, Indicates whether the aircraft is pressurized or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'Yes'].),\n]\n# Table: airline\n[\n  (airline_code:text, The code assigned to the airline. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (airline_name:text, The name of the airline. Value examples: ['American Airlines', 'United Airlines', 'Delta Air Lines', 'Southwest Airlines'].),\n  (note:text, Any additional notes or comments about the airline. Value examples: ['NULL', 'NULL', 'NULL', 'NULL'].),\n]\n# Table: airport\n[\n  (airport_code:text, The code assigned to the airport.. Value examples: ['JFK', 'LAX', 'ORD', 'DFW'].),\n  (airport_name:text, The name of the airport.. Value examples: ['John F. Kennedy International Airport', 'Los Angeles International Airport', 'O’Hare International Airport', 'Dallas/Fort Worth International Airport'].),\n  (airport_location:text, The location of the airport, eg 'Las Vegas', 'Chicago'. Value examples: ['New York City', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The code assigned to the state where the airport is located.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the airport is located.. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the airport is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n  (minimum_connect_time:bigint, The minimum amount of time required for a connecting flight at the airport.. Value examples: ['23', '20', '24', '40'].),\n]\n# Table: airport_service\n[\n  (city_code:text, The code of the city where the airport is located. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The code of the airport. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (miles_distant:bigint, The distance of the airport from the city in miles. Value examples: ['10', '20', '30', '40'].),\n  (direction:text, The direction of the airport from the city. Either 'North', 'South', 'East', 'West', 'Northeast', 'Northwest', 'Southeast', or 'Southwest'.. Value examples: ['North', 'South', 'East', 'West'].),\n  (minutes_distant:bigint, The distance of the airport from the city in minutes. Value examples: ['20', '40', '60', '80'].),\n]\n# Table: city\n[\n  (city_code:text, The code assigned to the city. Value examples: ['NYC', 'LA', 'CHI', 'DA'].),\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The 2-letter code assigned to the state where the city is located. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the city is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n]\n# Table: class_of_service\n[\n  (booking_class:text, The booking class code for the class of service. Value examples: ['First', 'Business', 'Economy'].),\n  (rank:bigint, The rank of the class of service. Value examples: ['1', '2', '3'].),\n  (class_description:text, A brief description of the class of service. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: code_description\n[\n  (code:text, The code column contains a unique identifier for each record in the table.. Value examples: ['ABC', 'DEF'].),\n  (description:text, The description column contains a textual description of the code.. Value examples: ['Code ABC', 'Code DEF'].),\n]\n# Table: compartment_class\n[\n  (compartment:text, The compartment column contains the name of a compartment. Either 'First', 'Business', or 'Economy'.. Value examples: ['First', 'Business', 'Economy'].),\n  (class_type:text, The class_type column contains the type of a class. Either 'First Class', 'Business Class', or 'Economy Class'.. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: days\n[\n  (days_code:text, A code representing a day of the week. Value examples: ['1', '2'].),\n  (day_name:text, The name of a day of the week. Either 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', or 'Sunday'.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: dual_carrier\n[\n  (main_airline:text, The name of the main airline operating the flight. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (low_flight_number:bigint, The lowest flight number in the range of flights operated by the dual carrier. Value examples: ['1', '11', '21', '31'].),\n  (high_flight_number:bigint, The highest flight number in the range of flights operated by the dual carrier. Value examples: ['10', '20', '30', '40'].),\n  (dual_airline:text, The name of the dual airline operating the flight. Value examples: ['VX', 'DL', 'UA', 'AS'].),\n  (service_name:text, The name of the service provided by the dual carrier on the flight. Value examples: ['Dual Service 1', 'Dual Service 2', 'Dual Service 3', 'Dual Service 4'].),\n]\n# Table: equipment_sequence\n[\n  (aircraft_code_sequence:text, Sequence number for each aircraft code. Value examples: ['1', '2', '3', '4'].),\n  (aircraft_code:text, Code for each aircraft. Value examples: ['B747', 'A320', 'B737', 'A380'].),\n]\n# Table: fare\n[\n  (fare_id:bigint, The unique identifier for this fare. Value examples: ['1', '2'].),\n  (from_airport:text, The 3-letter airport code for the departure location. Value examples: ['ORD', 'ORD'].),\n  (to_airport:text, The 3-letter airport code for the arrival location. Value examples: ['JFK', 'JFK'].),\n  (fare_basis_code:text, The code used to determine the fare's pricing rules. Value examples: ['ABC', 'DEF'].),\n  (fare_airline:text, The airline code associated with this fare. Value examples: ['AA', 'UA'].),\n  (restriction_code:text, Any restrictions or limitations associated with this fare. Value examples: ['NONE', 'NONE'].),\n  (one_direction_cost:bigint, The cost of a one-way trip for this fare. Value examples: ['200', '150'].),\n  (round_trip_cost:bigint, The cost of a round-trip for this fare. Value examples: ['300', '280'].),\n  (round_trip_required:text, Indicates whether a round-trip is required to purchase this fare. Either Yes or No.. Value examples: ['Yes', 'No'].),\n]\n# Table: fare_basis\n[\n  (fare_basis_code:text, The code that identifies the fare basis. Value examples: ['ABC', 'DEF', 'GHI', 'JKL'].),\n  (booking_class:text, The booking class associated with the fare basis. Either 'First', 'Business', or 'Economy'. Value examples: ['First', 'Business', 'Economy', 'First'].),\n  (class_type:text, The class type associated with the fare basis. Either 'First Class', 'Business Class', or 'Economy Class'. Value examples: ['First Class', 'Business Class', 'Economy Class', 'First Class'].),\n  (premium:text, Indicates whether the fare basis is for a premium class. Value examples: ['Yes', 'Yes', 'No', 'Yes'].),\n  (economy:text, Indicates whether the fare basis is for an economy class. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (discounted:text, Indicates whether the fare basis is for a discounted fare. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (night:text, Indicates whether the fare basis is for a night fare. Value examples: ['No', 'No', 'No', 'No'].),\n  (season:text, The season associated with the fare basis. Can only be 'Peak' or 'Regular'. Value examples: ['Regular', 'Regular', 'Regular', 'Regular'].),\n  (basis_days:text, The number of days the fare basis is valid for. Value examples: ['30', '30', '30', '30'].),\n]\n# Table: flight\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['3', '4', '5', '7'].),\n  (flight_days:text, Days of the week the flight operates on. Formatted as comma-delimited 3-letter abbreviations, e.g. `mon,tue,wed` or `tues,thurs`. Value examples: ['wed', 'thu', 'fri', 'sun'].),\n  (from_airport:text, Code assigned to the departure airport. Value examples: ['ORD', 'ORD', 'ORD', 'JFK'].),\n  (to_airport:text, Code assigned to the arrival airport. Value examples: ['JFK', 'JFK', 'LAX', 'ORD'].),\n  (departure_time:bigint, Epoch timestamp for departure time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577858400', '1577865600', '1577880000'].),\n  (arrival_time:bigint, Epoch timestamp for arrival time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577854900', '1577873400', '1577869600', '1577883700'].),\n  (airline_flight:text, Code assigned to the airline flight. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (airline_code:text, Code assigned to the airline. Value examples: ['AA', 'WN', 'AS', 'UA'].),\n  (flight_number:text, Flight number assigned by the airline. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (aircraft_code_sequence:text, Code assigned to the aircraft. Value examples: ['3', '4', '5', '7'].),\n  (meal_code:text, Code assigned to the meal provided during the flight. Value examples: ['DN', 'BS', 'BF', 'DN'].),\n  (stops:bigint, Number of stops during the flight. Value examples: ['0', '1', '0', '0'].),\n  (connections:bigint, Number of connections during the flight. Value examples: ['0', '1', '0', '0'].),\n  (dual_carrier:text, Code assigned to the dual carrier. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (time_elapsed:bigint, Total time elapsed during the flight in seconds. Value examples: ['3700', '15000', '4000', '3700'].),\n]\n# Table: flight_fare\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3', '4'].),\n  (fare_id:bigint, Unique identifier for each fare. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: flight_leg\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3'].),\n  (leg_number:bigint, The sequence number of the leg within the flight. Value examples: ['1', '1', '1'].),\n  (leg_flight:bigint, The flight ID of the leg's corresponding flight. Value examples: ['1', '2', '3'].),\n]\n# Table: flight_stop\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['2', '4'].),\n  (stop_number:bigint, The order of the stop in the flight. Value examples: ['1', '1'].),\n  (stop_days:text, Days of the week on which the flight stops at this airport. Value examples: ['2', '4'].),\n  (stop_airport:text, The 3-letter airport code of the stop. Value examples: ['DFW', 'DEN'].),\n  (arrival_time:bigint, The time at which the flight arrives at this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577847600', '1577862000'].),\n  (arrival_airline:text, The airline code of the arriving flight. Value examples: ['UA', 'WN'].),\n  (arrival_flight_number:text, Flight number of the arriving flight at this stop. Value examples: ['UA456', 'WN012'].),\n  (departure_time:bigint, The time at which the flight departs from this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577865600'].),\n  (departure_airline:text, The airline code of the departing flight. Value examples: ['UA', 'WN'].),\n  (departure_flight_number:text, Flight number of the departing flight from this stop. Value examples: ['UA456', 'WN012'].),\n  (stop_time:bigint, The duration of the stop at this airport. Value examples: ['3600', '3600'].),\n]\n# Table: food_service\n[\n  (meal_code:text, Code assigned to each meal type. Value examples: ['BF', 'LN'].),\n  (meal_number:bigint, Unique identifier for each meal served. Value examples: ['1', '2'].),\n  (compartment:text, The compartment in which the meal is served (e.g. 'First Class', 'Economy'). Value examples: ['First Class', 'First Class'].),\n  (meal_description:text, One of 'Breakfast', 'Lunch', 'Dinner'. Value examples: ['Breakfast', 'Lunch'].),\n]\n# Table: ground_service\n[\n  (city_code:text, The code for the city where the ground service is provided. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The 3-letter code for the airport where the ground service is provided. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (transport_type:text, The type of ground transportation provided. Value examples: ['Taxi', 'Shuttle', 'Bus', 'Car Rental'].),\n  (ground_fare:bigint, The fare charged for ground transportation. Value examples: ['50', '40', '30', '60'].),\n]\n# Table: month\n[\n  (month_number:bigint, A unique number assigned to each month of the year.. Value examples: ['1', '2', '3', '4'].),\n  (month_name:text, The name of the month, e.g. January, February, etc.. Value examples: ['January', 'February', 'March', 'April'].),\n]\n# Table: restriction\n[\n  (restriction_code:text, A code representing the type of restriction, such as blackout dates or minimum stay.. Value examples: ['NONE', 'NONE', 'NONE', 'NONE'].),\n  (advance_purchase:bigint, The number of days in advance the fare must be purchased.. Value examples: ['14', '14', '14', '14'].),\n  (stopovers:text, The number of stopovers allowed for the fare.. Value examples: ['2', '2', '2', '2'].),\n  (saturday_stay_required:text, Indicates whether a Saturday night stay is required for the fare. Either 'Yes' or 'No'.. Value examples: ['No', 'No', 'No', 'No'].),\n  (minimum_stay:bigint, The minimum length of stay required for the fare.. Value examples: ['7', '7', '7', '7'].),\n  (maximum_stay:bigint, The maximum length of stay allowed for the fare.. Value examples: ['30', '30', '30', '30'].),\n  (application:text, The type of fare application. Either 'One Way' or 'Round Trip'.. Value examples: ['One-Way', 'One-Way', 'One-Way', 'One-Way'].),\n  (no_discounts:text, Indicates whether the fare is eligible for discounts or promotions. Either 'Yes' or 'No'.. Value examples: ['Yes', 'Yes', 'Yes', 'Yes'].),\n]\n# Table: state\n[\n  (state_code:text, The 2-letter code assigned to the state. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA'].),\n  (state_name:text, The name of the state. Value examples: ['New York', 'California'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States'].),\n]\n# Table: time_interval\n[\n  (period:text, The period of the time interval, represented as a string. For example, 'daily', 'weekly', 'monthly', etc.. Value examples: ['daily', 'daily', 'daily'].),\n  (begin_time:bigint, The beginning time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577836800', '1577844000', '1577851200'].),\n  (end_time:bigint, The end time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577840400', '1577847600', '1577854800'].),\n]\n# Table: time_zone\n[\n  (time_zone_code:text, A short code that represents the time zone. For example, 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['PST', 'MST'].),\n  (time_zone_name:text, The name of the time zone. Value examples: ['Pacific Standard Time', 'Mountain Standard Time'].),\n  (hours_from_gmt:bigint, The number of hours that the time zone is ahead or behind Greenwich Mean Time (GMT). Value examples: ['-8', '-7'].),\n]\n\n【Foreign keys】\nairline.airline_code = flight.airline_code\nairline.airline_code = flight_stop.departure_airline\nairport.airport_code = fare.from_airport\nairport.airport_code = flight_stop.stop_airport\nairport_service.city_code = ground_service.city_code\nairport.state_code = city.state_code\nairport.state_code = state.state_code\ncity.state_code = state.state_code\nairport_service.city_code = city.city_code\nground_service.city_code = city.city_code\nairport.time_zone_code = time_zone.time_zone_code\ncity.time_zone_code = time_zone.time_zone_code\nflight.flight_id = flight_fare.flight_id\nflight.flight_id = flight_leg.flight_id\nflight.flight_id = flight_stop.flight_id\nflight_fare.flight_id = flight_leg.flight_id\nflight_fare.flight_id = flight_stop.flight_id\nflight_leg.flight_id = flight_stop.flight_id\naircraft.aircraft_code = equipment_sequence.aircraft_code\nflight.aircraft_code_sequence = equipment_sequence.aircraft_code_sequence\nflight.meal_code = food_service.meal_code\n\n【参考信息】\n\n\n【用户问题】\nWhat is the ratio of aircraft capacity to its range in miles for each aircraft code?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT aircraft.aircraft_code, CAST(aircraft.capacity AS FLOAT) / NULLIF(aircraft.range_miles, 0) AS capacity_range_ratio FROM aircraft;",
        "role": "assistant"
      }
    ],
    "db_name": "atis",
    "id": 77,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the proportion of flights with stops out of all flights for each airline code?\n\n【数据库schema】\n【DB_ID】 atis\n【Schema】\n# Table: aircraft\n[\n  (aircraft_code:text, The code assigned to the aircraft by the International Air Transport Association (IATA).. Value examples: ['B747', 'A320'].),\n  (aircraft_description:text, A short description of the aircraft.. Value examples: ['The Boeing 747 is a wide-body airliner.', 'The Airbus A320 is a narrow-body airliner.'].),\n  (manufacturer:text, The name of the manufacturer of the aircraft.. Value examples: ['Boeing', 'Airbus'].),\n  (basic_type:text, The basic type of the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (engines:bigint, The number of engines the aircraft has.. Value examples: ['4', '2'].),\n  (propulsion:text, The type of propulsion used by the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (wide_body:text, Indicates whether the aircraft is a wide body or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'No'].),\n  (wing_span:bigint, The distance between the tips of the aircraft's wings in feet.. Value examples: ['224', '111'].),\n  (length:bigint, The length of the aircraft in feet.. Value examples: ['231', '123'].),\n  (weight:bigint, The weight of the aircraft in pounds.. Value examples: ['987000', '162000'].),\n  (capacity:bigint, The maximum number of passengers the aircraft can carry.. Value examples: ['416', '240'].),\n  (pay_load:bigint, The maximum weight of cargo the aircraft can carry.. Value examples: ['60000', '30000'].),\n  (cruising_speed:bigint, The speed at which the aircraft cruises in miles per hour.. Value examples: ['570', '511'].),\n  (range_miles:bigint, The maximum distance the aircraft can fly in miles.. Value examples: ['8555', '3300'].),\n  (pressurized:text, Indicates whether the aircraft is pressurized or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'Yes'].),\n]\n# Table: airline\n[\n  (airline_code:text, The code assigned to the airline. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (airline_name:text, The name of the airline. Value examples: ['American Airlines', 'United Airlines', 'Delta Air Lines', 'Southwest Airlines'].),\n  (note:text, Any additional notes or comments about the airline. Value examples: ['NULL', 'NULL', 'NULL', 'NULL'].),\n]\n# Table: airport\n[\n  (airport_code:text, The code assigned to the airport.. Value examples: ['JFK', 'LAX', 'ORD', 'DFW'].),\n  (airport_name:text, The name of the airport.. Value examples: ['John F. Kennedy International Airport', 'Los Angeles International Airport', 'O’Hare International Airport', 'Dallas/Fort Worth International Airport'].),\n  (airport_location:text, The location of the airport, eg 'Las Vegas', 'Chicago'. Value examples: ['New York City', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The code assigned to the state where the airport is located.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the airport is located.. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the airport is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n  (minimum_connect_time:bigint, The minimum amount of time required for a connecting flight at the airport.. Value examples: ['23', '20', '24', '40'].),\n]\n# Table: airport_service\n[\n  (city_code:text, The code of the city where the airport is located. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The code of the airport. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (miles_distant:bigint, The distance of the airport from the city in miles. Value examples: ['10', '20', '30', '40'].),\n  (direction:text, The direction of the airport from the city. Either 'North', 'South', 'East', 'West', 'Northeast', 'Northwest', 'Southeast', or 'Southwest'.. Value examples: ['North', 'South', 'East', 'West'].),\n  (minutes_distant:bigint, The distance of the airport from the city in minutes. Value examples: ['20', '40', '60', '80'].),\n]\n# Table: city\n[\n  (city_code:text, The code assigned to the city. Value examples: ['NYC', 'LA', 'CHI', 'DA'].),\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The 2-letter code assigned to the state where the city is located. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the city is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n]\n# Table: class_of_service\n[\n  (booking_class:text, The booking class code for the class of service. Value examples: ['First', 'Business', 'Economy'].),\n  (rank:bigint, The rank of the class of service. Value examples: ['1', '2', '3'].),\n  (class_description:text, A brief description of the class of service. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: code_description\n[\n  (code:text, The code column contains a unique identifier for each record in the table.. Value examples: ['ABC', 'DEF'].),\n  (description:text, The description column contains a textual description of the code.. Value examples: ['Code ABC', 'Code DEF'].),\n]\n# Table: compartment_class\n[\n  (compartment:text, The compartment column contains the name of a compartment. Either 'First', 'Business', or 'Economy'.. Value examples: ['First', 'Business', 'Economy'].),\n  (class_type:text, The class_type column contains the type of a class. Either 'First Class', 'Business Class', or 'Economy Class'.. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: days\n[\n  (days_code:text, A code representing a day of the week. Value examples: ['1', '2'].),\n  (day_name:text, The name of a day of the week. Either 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', or 'Sunday'.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: dual_carrier\n[\n  (main_airline:text, The name of the main airline operating the flight. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (low_flight_number:bigint, The lowest flight number in the range of flights operated by the dual carrier. Value examples: ['1', '11', '21', '31'].),\n  (high_flight_number:bigint, The highest flight number in the range of flights operated by the dual carrier. Value examples: ['10', '20', '30', '40'].),\n  (dual_airline:text, The name of the dual airline operating the flight. Value examples: ['VX', 'DL', 'UA', 'AS'].),\n  (service_name:text, The name of the service provided by the dual carrier on the flight. Value examples: ['Dual Service 1', 'Dual Service 2', 'Dual Service 3', 'Dual Service 4'].),\n]\n# Table: equipment_sequence\n[\n  (aircraft_code_sequence:text, Sequence number for each aircraft code. Value examples: ['1', '2', '3', '4'].),\n  (aircraft_code:text, Code for each aircraft. Value examples: ['B747', 'A320', 'B737', 'A380'].),\n]\n# Table: fare\n[\n  (fare_id:bigint, The unique identifier for this fare. Value examples: ['1', '2'].),\n  (from_airport:text, The 3-letter airport code for the departure location. Value examples: ['ORD', 'ORD'].),\n  (to_airport:text, The 3-letter airport code for the arrival location. Value examples: ['JFK', 'JFK'].),\n  (fare_basis_code:text, The code used to determine the fare's pricing rules. Value examples: ['ABC', 'DEF'].),\n  (fare_airline:text, The airline code associated with this fare. Value examples: ['AA', 'UA'].),\n  (restriction_code:text, Any restrictions or limitations associated with this fare. Value examples: ['NONE', 'NONE'].),\n  (one_direction_cost:bigint, The cost of a one-way trip for this fare. Value examples: ['200', '150'].),\n  (round_trip_cost:bigint, The cost of a round-trip for this fare. Value examples: ['300', '280'].),\n  (round_trip_required:text, Indicates whether a round-trip is required to purchase this fare. Either Yes or No.. Value examples: ['Yes', 'No'].),\n]\n# Table: fare_basis\n[\n  (fare_basis_code:text, The code that identifies the fare basis. Value examples: ['ABC', 'DEF', 'GHI', 'JKL'].),\n  (booking_class:text, The booking class associated with the fare basis. Either 'First', 'Business', or 'Economy'. Value examples: ['First', 'Business', 'Economy', 'First'].),\n  (class_type:text, The class type associated with the fare basis. Either 'First Class', 'Business Class', or 'Economy Class'. Value examples: ['First Class', 'Business Class', 'Economy Class', 'First Class'].),\n  (premium:text, Indicates whether the fare basis is for a premium class. Value examples: ['Yes', 'Yes', 'No', 'Yes'].),\n  (economy:text, Indicates whether the fare basis is for an economy class. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (discounted:text, Indicates whether the fare basis is for a discounted fare. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (night:text, Indicates whether the fare basis is for a night fare. Value examples: ['No', 'No', 'No', 'No'].),\n  (season:text, The season associated with the fare basis. Can only be 'Peak' or 'Regular'. Value examples: ['Regular', 'Regular', 'Regular', 'Regular'].),\n  (basis_days:text, The number of days the fare basis is valid for. Value examples: ['30', '30', '30', '30'].),\n]\n# Table: flight\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['3', '4', '5', '7'].),\n  (flight_days:text, Days of the week the flight operates on. Formatted as comma-delimited 3-letter abbreviations, e.g. `mon,tue,wed` or `tues,thurs`. Value examples: ['wed', 'thu', 'fri', 'sun'].),\n  (from_airport:text, Code assigned to the departure airport. Value examples: ['ORD', 'ORD', 'ORD', 'JFK'].),\n  (to_airport:text, Code assigned to the arrival airport. Value examples: ['JFK', 'JFK', 'LAX', 'ORD'].),\n  (departure_time:bigint, Epoch timestamp for departure time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577858400', '1577865600', '1577880000'].),\n  (arrival_time:bigint, Epoch timestamp for arrival time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577854900', '1577873400', '1577869600', '1577883700'].),\n  (airline_flight:text, Code assigned to the airline flight. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (airline_code:text, Code assigned to the airline. Value examples: ['AA', 'WN', 'AS', 'UA'].),\n  (flight_number:text, Flight number assigned by the airline. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (aircraft_code_sequence:text, Code assigned to the aircraft. Value examples: ['3', '4', '5', '7'].),\n  (meal_code:text, Code assigned to the meal provided during the flight. Value examples: ['DN', 'BS', 'BF', 'DN'].),\n  (stops:bigint, Number of stops during the flight. Value examples: ['0', '1', '0', '0'].),\n  (connections:bigint, Number of connections during the flight. Value examples: ['0', '1', '0', '0'].),\n  (dual_carrier:text, Code assigned to the dual carrier. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (time_elapsed:bigint, Total time elapsed during the flight in seconds. Value examples: ['3700', '15000', '4000', '3700'].),\n]\n# Table: flight_fare\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3', '4'].),\n  (fare_id:bigint, Unique identifier for each fare. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: flight_leg\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3'].),\n  (leg_number:bigint, The sequence number of the leg within the flight. Value examples: ['1', '1', '1'].),\n  (leg_flight:bigint, The flight ID of the leg's corresponding flight. Value examples: ['1', '2', '3'].),\n]\n# Table: flight_stop\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['2', '4'].),\n  (stop_number:bigint, The order of the stop in the flight. Value examples: ['1', '1'].),\n  (stop_days:text, Days of the week on which the flight stops at this airport. Value examples: ['2', '4'].),\n  (stop_airport:text, The 3-letter airport code of the stop. Value examples: ['DFW', 'DEN'].),\n  (arrival_time:bigint, The time at which the flight arrives at this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577847600', '1577862000'].),\n  (arrival_airline:text, The airline code of the arriving flight. Value examples: ['UA', 'WN'].),\n  (arrival_flight_number:text, Flight number of the arriving flight at this stop. Value examples: ['UA456', 'WN012'].),\n  (departure_time:bigint, The time at which the flight departs from this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577865600'].),\n  (departure_airline:text, The airline code of the departing flight. Value examples: ['UA', 'WN'].),\n  (departure_flight_number:text, Flight number of the departing flight from this stop. Value examples: ['UA456', 'WN012'].),\n  (stop_time:bigint, The duration of the stop at this airport. Value examples: ['3600', '3600'].),\n]\n# Table: food_service\n[\n  (meal_code:text, Code assigned to each meal type. Value examples: ['BF', 'LN'].),\n  (meal_number:bigint, Unique identifier for each meal served. Value examples: ['1', '2'].),\n  (compartment:text, The compartment in which the meal is served (e.g. 'First Class', 'Economy'). Value examples: ['First Class', 'First Class'].),\n  (meal_description:text, One of 'Breakfast', 'Lunch', 'Dinner'. Value examples: ['Breakfast', 'Lunch'].),\n]\n# Table: ground_service\n[\n  (city_code:text, The code for the city where the ground service is provided. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The 3-letter code for the airport where the ground service is provided. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (transport_type:text, The type of ground transportation provided. Value examples: ['Taxi', 'Shuttle', 'Bus', 'Car Rental'].),\n  (ground_fare:bigint, The fare charged for ground transportation. Value examples: ['50', '40', '30', '60'].),\n]\n# Table: month\n[\n  (month_number:bigint, A unique number assigned to each month of the year.. Value examples: ['1', '2', '3', '4'].),\n  (month_name:text, The name of the month, e.g. January, February, etc.. Value examples: ['January', 'February', 'March', 'April'].),\n]\n# Table: restriction\n[\n  (restriction_code:text, A code representing the type of restriction, such as blackout dates or minimum stay.. Value examples: ['NONE', 'NONE', 'NONE', 'NONE'].),\n  (advance_purchase:bigint, The number of days in advance the fare must be purchased.. Value examples: ['14', '14', '14', '14'].),\n  (stopovers:text, The number of stopovers allowed for the fare.. Value examples: ['2', '2', '2', '2'].),\n  (saturday_stay_required:text, Indicates whether a Saturday night stay is required for the fare. Either 'Yes' or 'No'.. Value examples: ['No', 'No', 'No', 'No'].),\n  (minimum_stay:bigint, The minimum length of stay required for the fare.. Value examples: ['7', '7', '7', '7'].),\n  (maximum_stay:bigint, The maximum length of stay allowed for the fare.. Value examples: ['30', '30', '30', '30'].),\n  (application:text, The type of fare application. Either 'One Way' or 'Round Trip'.. Value examples: ['One-Way', 'One-Way', 'One-Way', 'One-Way'].),\n  (no_discounts:text, Indicates whether the fare is eligible for discounts or promotions. Either 'Yes' or 'No'.. Value examples: ['Yes', 'Yes', 'Yes', 'Yes'].),\n]\n# Table: state\n[\n  (state_code:text, The 2-letter code assigned to the state. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA'].),\n  (state_name:text, The name of the state. Value examples: ['New York', 'California'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States'].),\n]\n# Table: time_interval\n[\n  (period:text, The period of the time interval, represented as a string. For example, 'daily', 'weekly', 'monthly', etc.. Value examples: ['daily', 'daily', 'daily'].),\n  (begin_time:bigint, The beginning time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577836800', '1577844000', '1577851200'].),\n  (end_time:bigint, The end time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577840400', '1577847600', '1577854800'].),\n]\n# Table: time_zone\n[\n  (time_zone_code:text, A short code that represents the time zone. For example, 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['PST', 'MST'].),\n  (time_zone_name:text, The name of the time zone. Value examples: ['Pacific Standard Time', 'Mountain Standard Time'].),\n  (hours_from_gmt:bigint, The number of hours that the time zone is ahead or behind Greenwich Mean Time (GMT). Value examples: ['-8', '-7'].),\n]\n\n【Foreign keys】\nairline.airline_code = flight.airline_code\nairline.airline_code = flight_stop.departure_airline\nairport.airport_code = fare.from_airport\nairport.airport_code = flight_stop.stop_airport\nairport_service.city_code = ground_service.city_code\nairport.state_code = city.state_code\nairport.state_code = state.state_code\ncity.state_code = state.state_code\nairport_service.city_code = city.city_code\nground_service.city_code = city.city_code\nairport.time_zone_code = time_zone.time_zone_code\ncity.time_zone_code = time_zone.time_zone_code\nflight.flight_id = flight_fare.flight_id\nflight.flight_id = flight_leg.flight_id\nflight.flight_id = flight_stop.flight_id\nflight_fare.flight_id = flight_leg.flight_id\nflight_fare.flight_id = flight_stop.flight_id\nflight_leg.flight_id = flight_stop.flight_id\naircraft.aircraft_code = equipment_sequence.aircraft_code\nflight.aircraft_code_sequence = equipment_sequence.aircraft_code_sequence\nflight.meal_code = food_service.meal_code\n\n【参考信息】\n\n\n【用户问题】\nWhat is the proportion of flights with stops out of all flights for each airline code?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT flight.airline_code, CAST(SUM(CASE WHEN flight.stops > 0 THEN 1 ELSE 0 END) AS FLOAT) / NULLIF(COUNT(*), 0) AS ratio FROM flight GROUP BY flight.airline_code;",
        "role": "assistant"
      }
    ],
    "db_name": "atis",
    "id": 78,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow does the average ratio of the cruising speed to the payload of an aircraft vary across different aircraft manufacturers?\n\n【数据库schema】\n【DB_ID】 atis\n【Schema】\n# Table: aircraft\n[\n  (aircraft_code:text, The code assigned to the aircraft by the International Air Transport Association (IATA).. Value examples: ['B747', 'A320'].),\n  (aircraft_description:text, A short description of the aircraft.. Value examples: ['The Boeing 747 is a wide-body airliner.', 'The Airbus A320 is a narrow-body airliner.'].),\n  (manufacturer:text, The name of the manufacturer of the aircraft.. Value examples: ['Boeing', 'Airbus'].),\n  (basic_type:text, The basic type of the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (engines:bigint, The number of engines the aircraft has.. Value examples: ['4', '2'].),\n  (propulsion:text, The type of propulsion used by the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (wide_body:text, Indicates whether the aircraft is a wide body or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'No'].),\n  (wing_span:bigint, The distance between the tips of the aircraft's wings in feet.. Value examples: ['224', '111'].),\n  (length:bigint, The length of the aircraft in feet.. Value examples: ['231', '123'].),\n  (weight:bigint, The weight of the aircraft in pounds.. Value examples: ['987000', '162000'].),\n  (capacity:bigint, The maximum number of passengers the aircraft can carry.. Value examples: ['416', '240'].),\n  (pay_load:bigint, The maximum weight of cargo the aircraft can carry.. Value examples: ['60000', '30000'].),\n  (cruising_speed:bigint, The speed at which the aircraft cruises in miles per hour.. Value examples: ['570', '511'].),\n  (range_miles:bigint, The maximum distance the aircraft can fly in miles.. Value examples: ['8555', '3300'].),\n  (pressurized:text, Indicates whether the aircraft is pressurized or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'Yes'].),\n]\n# Table: airline\n[\n  (airline_code:text, The code assigned to the airline. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (airline_name:text, The name of the airline. Value examples: ['American Airlines', 'United Airlines', 'Delta Air Lines', 'Southwest Airlines'].),\n  (note:text, Any additional notes or comments about the airline. Value examples: ['NULL', 'NULL', 'NULL', 'NULL'].),\n]\n# Table: airport\n[\n  (airport_code:text, The code assigned to the airport.. Value examples: ['JFK', 'LAX', 'ORD', 'DFW'].),\n  (airport_name:text, The name of the airport.. Value examples: ['John F. Kennedy International Airport', 'Los Angeles International Airport', 'O’Hare International Airport', 'Dallas/Fort Worth International Airport'].),\n  (airport_location:text, The location of the airport, eg 'Las Vegas', 'Chicago'. Value examples: ['New York City', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The code assigned to the state where the airport is located.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the airport is located.. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the airport is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n  (minimum_connect_time:bigint, The minimum amount of time required for a connecting flight at the airport.. Value examples: ['23', '20', '24', '40'].),\n]\n# Table: airport_service\n[\n  (city_code:text, The code of the city where the airport is located. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The code of the airport. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (miles_distant:bigint, The distance of the airport from the city in miles. Value examples: ['10', '20', '30', '40'].),\n  (direction:text, The direction of the airport from the city. Either 'North', 'South', 'East', 'West', 'Northeast', 'Northwest', 'Southeast', or 'Southwest'.. Value examples: ['North', 'South', 'East', 'West'].),\n  (minutes_distant:bigint, The distance of the airport from the city in minutes. Value examples: ['20', '40', '60', '80'].),\n]\n# Table: city\n[\n  (city_code:text, The code assigned to the city. Value examples: ['NYC', 'LA', 'CHI', 'DA'].),\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The 2-letter code assigned to the state where the city is located. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the city is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n]\n# Table: class_of_service\n[\n  (booking_class:text, The booking class code for the class of service. Value examples: ['First', 'Business', 'Economy'].),\n  (rank:bigint, The rank of the class of service. Value examples: ['1', '2', '3'].),\n  (class_description:text, A brief description of the class of service. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: code_description\n[\n  (code:text, The code column contains a unique identifier for each record in the table.. Value examples: ['ABC', 'DEF'].),\n  (description:text, The description column contains a textual description of the code.. Value examples: ['Code ABC', 'Code DEF'].),\n]\n# Table: compartment_class\n[\n  (compartment:text, The compartment column contains the name of a compartment. Either 'First', 'Business', or 'Economy'.. Value examples: ['First', 'Business', 'Economy'].),\n  (class_type:text, The class_type column contains the type of a class. Either 'First Class', 'Business Class', or 'Economy Class'.. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: days\n[\n  (days_code:text, A code representing a day of the week. Value examples: ['1', '2'].),\n  (day_name:text, The name of a day of the week. Either 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', or 'Sunday'.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: dual_carrier\n[\n  (main_airline:text, The name of the main airline operating the flight. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (low_flight_number:bigint, The lowest flight number in the range of flights operated by the dual carrier. Value examples: ['1', '11', '21', '31'].),\n  (high_flight_number:bigint, The highest flight number in the range of flights operated by the dual carrier. Value examples: ['10', '20', '30', '40'].),\n  (dual_airline:text, The name of the dual airline operating the flight. Value examples: ['VX', 'DL', 'UA', 'AS'].),\n  (service_name:text, The name of the service provided by the dual carrier on the flight. Value examples: ['Dual Service 1', 'Dual Service 2', 'Dual Service 3', 'Dual Service 4'].),\n]\n# Table: equipment_sequence\n[\n  (aircraft_code_sequence:text, Sequence number for each aircraft code. Value examples: ['1', '2', '3', '4'].),\n  (aircraft_code:text, Code for each aircraft. Value examples: ['B747', 'A320', 'B737', 'A380'].),\n]\n# Table: fare\n[\n  (fare_id:bigint, The unique identifier for this fare. Value examples: ['1', '2'].),\n  (from_airport:text, The 3-letter airport code for the departure location. Value examples: ['ORD', 'ORD'].),\n  (to_airport:text, The 3-letter airport code for the arrival location. Value examples: ['JFK', 'JFK'].),\n  (fare_basis_code:text, The code used to determine the fare's pricing rules. Value examples: ['ABC', 'DEF'].),\n  (fare_airline:text, The airline code associated with this fare. Value examples: ['AA', 'UA'].),\n  (restriction_code:text, Any restrictions or limitations associated with this fare. Value examples: ['NONE', 'NONE'].),\n  (one_direction_cost:bigint, The cost of a one-way trip for this fare. Value examples: ['200', '150'].),\n  (round_trip_cost:bigint, The cost of a round-trip for this fare. Value examples: ['300', '280'].),\n  (round_trip_required:text, Indicates whether a round-trip is required to purchase this fare. Either Yes or No.. Value examples: ['Yes', 'No'].),\n]\n# Table: fare_basis\n[\n  (fare_basis_code:text, The code that identifies the fare basis. Value examples: ['ABC', 'DEF', 'GHI', 'JKL'].),\n  (booking_class:text, The booking class associated with the fare basis. Either 'First', 'Business', or 'Economy'. Value examples: ['First', 'Business', 'Economy', 'First'].),\n  (class_type:text, The class type associated with the fare basis. Either 'First Class', 'Business Class', or 'Economy Class'. Value examples: ['First Class', 'Business Class', 'Economy Class', 'First Class'].),\n  (premium:text, Indicates whether the fare basis is for a premium class. Value examples: ['Yes', 'Yes', 'No', 'Yes'].),\n  (economy:text, Indicates whether the fare basis is for an economy class. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (discounted:text, Indicates whether the fare basis is for a discounted fare. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (night:text, Indicates whether the fare basis is for a night fare. Value examples: ['No', 'No', 'No', 'No'].),\n  (season:text, The season associated with the fare basis. Can only be 'Peak' or 'Regular'. Value examples: ['Regular', 'Regular', 'Regular', 'Regular'].),\n  (basis_days:text, The number of days the fare basis is valid for. Value examples: ['30', '30', '30', '30'].),\n]\n# Table: flight\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['3', '4', '5', '7'].),\n  (flight_days:text, Days of the week the flight operates on. Formatted as comma-delimited 3-letter abbreviations, e.g. `mon,tue,wed` or `tues,thurs`. Value examples: ['wed', 'thu', 'fri', 'sun'].),\n  (from_airport:text, Code assigned to the departure airport. Value examples: ['ORD', 'ORD', 'ORD', 'JFK'].),\n  (to_airport:text, Code assigned to the arrival airport. Value examples: ['JFK', 'JFK', 'LAX', 'ORD'].),\n  (departure_time:bigint, Epoch timestamp for departure time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577858400', '1577865600', '1577880000'].),\n  (arrival_time:bigint, Epoch timestamp for arrival time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577854900', '1577873400', '1577869600', '1577883700'].),\n  (airline_flight:text, Code assigned to the airline flight. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (airline_code:text, Code assigned to the airline. Value examples: ['AA', 'WN', 'AS', 'UA'].),\n  (flight_number:text, Flight number assigned by the airline. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (aircraft_code_sequence:text, Code assigned to the aircraft. Value examples: ['3', '4', '5', '7'].),\n  (meal_code:text, Code assigned to the meal provided during the flight. Value examples: ['DN', 'BS', 'BF', 'DN'].),\n  (stops:bigint, Number of stops during the flight. Value examples: ['0', '1', '0', '0'].),\n  (connections:bigint, Number of connections during the flight. Value examples: ['0', '1', '0', '0'].),\n  (dual_carrier:text, Code assigned to the dual carrier. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (time_elapsed:bigint, Total time elapsed during the flight in seconds. Value examples: ['3700', '15000', '4000', '3700'].),\n]\n# Table: flight_fare\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3', '4'].),\n  (fare_id:bigint, Unique identifier for each fare. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: flight_leg\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3'].),\n  (leg_number:bigint, The sequence number of the leg within the flight. Value examples: ['1', '1', '1'].),\n  (leg_flight:bigint, The flight ID of the leg's corresponding flight. Value examples: ['1', '2', '3'].),\n]\n# Table: flight_stop\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['2', '4'].),\n  (stop_number:bigint, The order of the stop in the flight. Value examples: ['1', '1'].),\n  (stop_days:text, Days of the week on which the flight stops at this airport. Value examples: ['2', '4'].),\n  (stop_airport:text, The 3-letter airport code of the stop. Value examples: ['DFW', 'DEN'].),\n  (arrival_time:bigint, The time at which the flight arrives at this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577847600', '1577862000'].),\n  (arrival_airline:text, The airline code of the arriving flight. Value examples: ['UA', 'WN'].),\n  (arrival_flight_number:text, Flight number of the arriving flight at this stop. Value examples: ['UA456', 'WN012'].),\n  (departure_time:bigint, The time at which the flight departs from this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577865600'].),\n  (departure_airline:text, The airline code of the departing flight. Value examples: ['UA', 'WN'].),\n  (departure_flight_number:text, Flight number of the departing flight from this stop. Value examples: ['UA456', 'WN012'].),\n  (stop_time:bigint, The duration of the stop at this airport. Value examples: ['3600', '3600'].),\n]\n# Table: food_service\n[\n  (meal_code:text, Code assigned to each meal type. Value examples: ['BF', 'LN'].),\n  (meal_number:bigint, Unique identifier for each meal served. Value examples: ['1', '2'].),\n  (compartment:text, The compartment in which the meal is served (e.g. 'First Class', 'Economy'). Value examples: ['First Class', 'First Class'].),\n  (meal_description:text, One of 'Breakfast', 'Lunch', 'Dinner'. Value examples: ['Breakfast', 'Lunch'].),\n]\n# Table: ground_service\n[\n  (city_code:text, The code for the city where the ground service is provided. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The 3-letter code for the airport where the ground service is provided. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (transport_type:text, The type of ground transportation provided. Value examples: ['Taxi', 'Shuttle', 'Bus', 'Car Rental'].),\n  (ground_fare:bigint, The fare charged for ground transportation. Value examples: ['50', '40', '30', '60'].),\n]\n# Table: month\n[\n  (month_number:bigint, A unique number assigned to each month of the year.. Value examples: ['1', '2', '3', '4'].),\n  (month_name:text, The name of the month, e.g. January, February, etc.. Value examples: ['January', 'February', 'March', 'April'].),\n]\n# Table: restriction\n[\n  (restriction_code:text, A code representing the type of restriction, such as blackout dates or minimum stay.. Value examples: ['NONE', 'NONE', 'NONE', 'NONE'].),\n  (advance_purchase:bigint, The number of days in advance the fare must be purchased.. Value examples: ['14', '14', '14', '14'].),\n  (stopovers:text, The number of stopovers allowed for the fare.. Value examples: ['2', '2', '2', '2'].),\n  (saturday_stay_required:text, Indicates whether a Saturday night stay is required for the fare. Either 'Yes' or 'No'.. Value examples: ['No', 'No', 'No', 'No'].),\n  (minimum_stay:bigint, The minimum length of stay required for the fare.. Value examples: ['7', '7', '7', '7'].),\n  (maximum_stay:bigint, The maximum length of stay allowed for the fare.. Value examples: ['30', '30', '30', '30'].),\n  (application:text, The type of fare application. Either 'One Way' or 'Round Trip'.. Value examples: ['One-Way', 'One-Way', 'One-Way', 'One-Way'].),\n  (no_discounts:text, Indicates whether the fare is eligible for discounts or promotions. Either 'Yes' or 'No'.. Value examples: ['Yes', 'Yes', 'Yes', 'Yes'].),\n]\n# Table: state\n[\n  (state_code:text, The 2-letter code assigned to the state. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA'].),\n  (state_name:text, The name of the state. Value examples: ['New York', 'California'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States'].),\n]\n# Table: time_interval\n[\n  (period:text, The period of the time interval, represented as a string. For example, 'daily', 'weekly', 'monthly', etc.. Value examples: ['daily', 'daily', 'daily'].),\n  (begin_time:bigint, The beginning time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577836800', '1577844000', '1577851200'].),\n  (end_time:bigint, The end time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577840400', '1577847600', '1577854800'].),\n]\n# Table: time_zone\n[\n  (time_zone_code:text, A short code that represents the time zone. For example, 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['PST', 'MST'].),\n  (time_zone_name:text, The name of the time zone. Value examples: ['Pacific Standard Time', 'Mountain Standard Time'].),\n  (hours_from_gmt:bigint, The number of hours that the time zone is ahead or behind Greenwich Mean Time (GMT). Value examples: ['-8', '-7'].),\n]\n\n【Foreign keys】\nairline.airline_code = flight.airline_code\nairline.airline_code = flight_stop.departure_airline\nairport.airport_code = fare.from_airport\nairport.airport_code = flight_stop.stop_airport\nairport_service.city_code = ground_service.city_code\nairport.state_code = city.state_code\nairport.state_code = state.state_code\ncity.state_code = state.state_code\nairport_service.city_code = city.city_code\nground_service.city_code = city.city_code\nairport.time_zone_code = time_zone.time_zone_code\ncity.time_zone_code = time_zone.time_zone_code\nflight.flight_id = flight_fare.flight_id\nflight.flight_id = flight_leg.flight_id\nflight.flight_id = flight_stop.flight_id\nflight_fare.flight_id = flight_leg.flight_id\nflight_fare.flight_id = flight_stop.flight_id\nflight_leg.flight_id = flight_stop.flight_id\naircraft.aircraft_code = equipment_sequence.aircraft_code\nflight.aircraft_code_sequence = equipment_sequence.aircraft_code_sequence\nflight.meal_code = food_service.meal_code\n\n【参考信息】\n\n\n【用户问题】\nHow does the average ratio of the cruising speed to the payload of an aircraft vary across different aircraft manufacturers?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT aircraft.manufacturer, AVG(CAST(aircraft.cruising_speed AS FLOAT) / NULLIF(aircraft.pay_load, 0)) AS speed_payload_ratio FROM aircraft GROUP BY aircraft.manufacturer ORDER BY speed_payload_ratio DESC NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "atis",
    "id": 79,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich flights serve meals in first class? Give me the flight id and meal description.\n\n【数据库schema】\n【DB_ID】 atis\n【Schema】\n# Table: aircraft\n[\n  (aircraft_code:text, The code assigned to the aircraft by the International Air Transport Association (IATA).. Value examples: ['B747', 'A320'].),\n  (aircraft_description:text, A short description of the aircraft.. Value examples: ['The Boeing 747 is a wide-body airliner.', 'The Airbus A320 is a narrow-body airliner.'].),\n  (manufacturer:text, The name of the manufacturer of the aircraft.. Value examples: ['Boeing', 'Airbus'].),\n  (basic_type:text, The basic type of the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (engines:bigint, The number of engines the aircraft has.. Value examples: ['4', '2'].),\n  (propulsion:text, The type of propulsion used by the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (wide_body:text, Indicates whether the aircraft is a wide body or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'No'].),\n  (wing_span:bigint, The distance between the tips of the aircraft's wings in feet.. Value examples: ['224', '111'].),\n  (length:bigint, The length of the aircraft in feet.. Value examples: ['231', '123'].),\n  (weight:bigint, The weight of the aircraft in pounds.. Value examples: ['987000', '162000'].),\n  (capacity:bigint, The maximum number of passengers the aircraft can carry.. Value examples: ['416', '240'].),\n  (pay_load:bigint, The maximum weight of cargo the aircraft can carry.. Value examples: ['60000', '30000'].),\n  (cruising_speed:bigint, The speed at which the aircraft cruises in miles per hour.. Value examples: ['570', '511'].),\n  (range_miles:bigint, The maximum distance the aircraft can fly in miles.. Value examples: ['8555', '3300'].),\n  (pressurized:text, Indicates whether the aircraft is pressurized or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'Yes'].),\n]\n# Table: airline\n[\n  (airline_code:text, The code assigned to the airline. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (airline_name:text, The name of the airline. Value examples: ['American Airlines', 'United Airlines', 'Delta Air Lines', 'Southwest Airlines'].),\n  (note:text, Any additional notes or comments about the airline. Value examples: ['NULL', 'NULL', 'NULL', 'NULL'].),\n]\n# Table: airport\n[\n  (airport_code:text, The code assigned to the airport.. Value examples: ['JFK', 'LAX', 'ORD', 'DFW'].),\n  (airport_name:text, The name of the airport.. Value examples: ['John F. Kennedy International Airport', 'Los Angeles International Airport', 'O’Hare International Airport', 'Dallas/Fort Worth International Airport'].),\n  (airport_location:text, The location of the airport, eg 'Las Vegas', 'Chicago'. Value examples: ['New York City', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The code assigned to the state where the airport is located.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the airport is located.. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the airport is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n  (minimum_connect_time:bigint, The minimum amount of time required for a connecting flight at the airport.. Value examples: ['23', '20', '24', '40'].),\n]\n# Table: airport_service\n[\n  (city_code:text, The code of the city where the airport is located. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The code of the airport. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (miles_distant:bigint, The distance of the airport from the city in miles. Value examples: ['10', '20', '30', '40'].),\n  (direction:text, The direction of the airport from the city. Either 'North', 'South', 'East', 'West', 'Northeast', 'Northwest', 'Southeast', or 'Southwest'.. Value examples: ['North', 'South', 'East', 'West'].),\n  (minutes_distant:bigint, The distance of the airport from the city in minutes. Value examples: ['20', '40', '60', '80'].),\n]\n# Table: city\n[\n  (city_code:text, The code assigned to the city. Value examples: ['NYC', 'LA', 'CHI', 'DA'].),\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The 2-letter code assigned to the state where the city is located. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the city is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n]\n# Table: class_of_service\n[\n  (booking_class:text, The booking class code for the class of service. Value examples: ['First', 'Business', 'Economy'].),\n  (rank:bigint, The rank of the class of service. Value examples: ['1', '2', '3'].),\n  (class_description:text, A brief description of the class of service. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: code_description\n[\n  (code:text, The code column contains a unique identifier for each record in the table.. Value examples: ['ABC', 'DEF'].),\n  (description:text, The description column contains a textual description of the code.. Value examples: ['Code ABC', 'Code DEF'].),\n]\n# Table: compartment_class\n[\n  (compartment:text, The compartment column contains the name of a compartment. Either 'First', 'Business', or 'Economy'.. Value examples: ['First', 'Business', 'Economy'].),\n  (class_type:text, The class_type column contains the type of a class. Either 'First Class', 'Business Class', or 'Economy Class'.. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: days\n[\n  (days_code:text, A code representing a day of the week. Value examples: ['1', '2'].),\n  (day_name:text, The name of a day of the week. Either 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', or 'Sunday'.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: dual_carrier\n[\n  (main_airline:text, The name of the main airline operating the flight. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (low_flight_number:bigint, The lowest flight number in the range of flights operated by the dual carrier. Value examples: ['1', '11', '21', '31'].),\n  (high_flight_number:bigint, The highest flight number in the range of flights operated by the dual carrier. Value examples: ['10', '20', '30', '40'].),\n  (dual_airline:text, The name of the dual airline operating the flight. Value examples: ['VX', 'DL', 'UA', 'AS'].),\n  (service_name:text, The name of the service provided by the dual carrier on the flight. Value examples: ['Dual Service 1', 'Dual Service 2', 'Dual Service 3', 'Dual Service 4'].),\n]\n# Table: equipment_sequence\n[\n  (aircraft_code_sequence:text, Sequence number for each aircraft code. Value examples: ['1', '2', '3', '4'].),\n  (aircraft_code:text, Code for each aircraft. Value examples: ['B747', 'A320', 'B737', 'A380'].),\n]\n# Table: fare\n[\n  (fare_id:bigint, The unique identifier for this fare. Value examples: ['1', '2'].),\n  (from_airport:text, The 3-letter airport code for the departure location. Value examples: ['ORD', 'ORD'].),\n  (to_airport:text, The 3-letter airport code for the arrival location. Value examples: ['JFK', 'JFK'].),\n  (fare_basis_code:text, The code used to determine the fare's pricing rules. Value examples: ['ABC', 'DEF'].),\n  (fare_airline:text, The airline code associated with this fare. Value examples: ['AA', 'UA'].),\n  (restriction_code:text, Any restrictions or limitations associated with this fare. Value examples: ['NONE', 'NONE'].),\n  (one_direction_cost:bigint, The cost of a one-way trip for this fare. Value examples: ['200', '150'].),\n  (round_trip_cost:bigint, The cost of a round-trip for this fare. Value examples: ['300', '280'].),\n  (round_trip_required:text, Indicates whether a round-trip is required to purchase this fare. Either Yes or No.. Value examples: ['Yes', 'No'].),\n]\n# Table: fare_basis\n[\n  (fare_basis_code:text, The code that identifies the fare basis. Value examples: ['ABC', 'DEF', 'GHI', 'JKL'].),\n  (booking_class:text, The booking class associated with the fare basis. Either 'First', 'Business', or 'Economy'. Value examples: ['First', 'Business', 'Economy', 'First'].),\n  (class_type:text, The class type associated with the fare basis. Either 'First Class', 'Business Class', or 'Economy Class'. Value examples: ['First Class', 'Business Class', 'Economy Class', 'First Class'].),\n  (premium:text, Indicates whether the fare basis is for a premium class. Value examples: ['Yes', 'Yes', 'No', 'Yes'].),\n  (economy:text, Indicates whether the fare basis is for an economy class. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (discounted:text, Indicates whether the fare basis is for a discounted fare. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (night:text, Indicates whether the fare basis is for a night fare. Value examples: ['No', 'No', 'No', 'No'].),\n  (season:text, The season associated with the fare basis. Can only be 'Peak' or 'Regular'. Value examples: ['Regular', 'Regular', 'Regular', 'Regular'].),\n  (basis_days:text, The number of days the fare basis is valid for. Value examples: ['30', '30', '30', '30'].),\n]\n# Table: flight\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['3', '4', '5', '7'].),\n  (flight_days:text, Days of the week the flight operates on. Formatted as comma-delimited 3-letter abbreviations, e.g. `mon,tue,wed` or `tues,thurs`. Value examples: ['wed', 'thu', 'fri', 'sun'].),\n  (from_airport:text, Code assigned to the departure airport. Value examples: ['ORD', 'ORD', 'ORD', 'JFK'].),\n  (to_airport:text, Code assigned to the arrival airport. Value examples: ['JFK', 'JFK', 'LAX', 'ORD'].),\n  (departure_time:bigint, Epoch timestamp for departure time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577858400', '1577865600', '1577880000'].),\n  (arrival_time:bigint, Epoch timestamp for arrival time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577854900', '1577873400', '1577869600', '1577883700'].),\n  (airline_flight:text, Code assigned to the airline flight. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (airline_code:text, Code assigned to the airline. Value examples: ['AA', 'WN', 'AS', 'UA'].),\n  (flight_number:text, Flight number assigned by the airline. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (aircraft_code_sequence:text, Code assigned to the aircraft. Value examples: ['3', '4', '5', '7'].),\n  (meal_code:text, Code assigned to the meal provided during the flight. Value examples: ['DN', 'BS', 'BF', 'DN'].),\n  (stops:bigint, Number of stops during the flight. Value examples: ['0', '1', '0', '0'].),\n  (connections:bigint, Number of connections during the flight. Value examples: ['0', '1', '0', '0'].),\n  (dual_carrier:text, Code assigned to the dual carrier. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (time_elapsed:bigint, Total time elapsed during the flight in seconds. Value examples: ['3700', '15000', '4000', '3700'].),\n]\n# Table: flight_fare\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3', '4'].),\n  (fare_id:bigint, Unique identifier for each fare. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: flight_leg\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3'].),\n  (leg_number:bigint, The sequence number of the leg within the flight. Value examples: ['1', '1', '1'].),\n  (leg_flight:bigint, The flight ID of the leg's corresponding flight. Value examples: ['1', '2', '3'].),\n]\n# Table: flight_stop\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['2', '4'].),\n  (stop_number:bigint, The order of the stop in the flight. Value examples: ['1', '1'].),\n  (stop_days:text, Days of the week on which the flight stops at this airport. Value examples: ['2', '4'].),\n  (stop_airport:text, The 3-letter airport code of the stop. Value examples: ['DFW', 'DEN'].),\n  (arrival_time:bigint, The time at which the flight arrives at this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577847600', '1577862000'].),\n  (arrival_airline:text, The airline code of the arriving flight. Value examples: ['UA', 'WN'].),\n  (arrival_flight_number:text, Flight number of the arriving flight at this stop. Value examples: ['UA456', 'WN012'].),\n  (departure_time:bigint, The time at which the flight departs from this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577865600'].),\n  (departure_airline:text, The airline code of the departing flight. Value examples: ['UA', 'WN'].),\n  (departure_flight_number:text, Flight number of the departing flight from this stop. Value examples: ['UA456', 'WN012'].),\n  (stop_time:bigint, The duration of the stop at this airport. Value examples: ['3600', '3600'].),\n]\n# Table: food_service\n[\n  (meal_code:text, Code assigned to each meal type. Value examples: ['BF', 'LN'].),\n  (meal_number:bigint, Unique identifier for each meal served. Value examples: ['1', '2'].),\n  (compartment:text, The compartment in which the meal is served (e.g. 'First Class', 'Economy'). Value examples: ['First Class', 'First Class'].),\n  (meal_description:text, One of 'Breakfast', 'Lunch', 'Dinner'. Value examples: ['Breakfast', 'Lunch'].),\n]\n# Table: ground_service\n[\n  (city_code:text, The code for the city where the ground service is provided. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The 3-letter code for the airport where the ground service is provided. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (transport_type:text, The type of ground transportation provided. Value examples: ['Taxi', 'Shuttle', 'Bus', 'Car Rental'].),\n  (ground_fare:bigint, The fare charged for ground transportation. Value examples: ['50', '40', '30', '60'].),\n]\n# Table: month\n[\n  (month_number:bigint, A unique number assigned to each month of the year.. Value examples: ['1', '2', '3', '4'].),\n  (month_name:text, The name of the month, e.g. January, February, etc.. Value examples: ['January', 'February', 'March', 'April'].),\n]\n# Table: restriction\n[\n  (restriction_code:text, A code representing the type of restriction, such as blackout dates or minimum stay.. Value examples: ['NONE', 'NONE', 'NONE', 'NONE'].),\n  (advance_purchase:bigint, The number of days in advance the fare must be purchased.. Value examples: ['14', '14', '14', '14'].),\n  (stopovers:text, The number of stopovers allowed for the fare.. Value examples: ['2', '2', '2', '2'].),\n  (saturday_stay_required:text, Indicates whether a Saturday night stay is required for the fare. Either 'Yes' or 'No'.. Value examples: ['No', 'No', 'No', 'No'].),\n  (minimum_stay:bigint, The minimum length of stay required for the fare.. Value examples: ['7', '7', '7', '7'].),\n  (maximum_stay:bigint, The maximum length of stay allowed for the fare.. Value examples: ['30', '30', '30', '30'].),\n  (application:text, The type of fare application. Either 'One Way' or 'Round Trip'.. Value examples: ['One-Way', 'One-Way', 'One-Way', 'One-Way'].),\n  (no_discounts:text, Indicates whether the fare is eligible for discounts or promotions. Either 'Yes' or 'No'.. Value examples: ['Yes', 'Yes', 'Yes', 'Yes'].),\n]\n# Table: state\n[\n  (state_code:text, The 2-letter code assigned to the state. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA'].),\n  (state_name:text, The name of the state. Value examples: ['New York', 'California'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States'].),\n]\n# Table: time_interval\n[\n  (period:text, The period of the time interval, represented as a string. For example, 'daily', 'weekly', 'monthly', etc.. Value examples: ['daily', 'daily', 'daily'].),\n  (begin_time:bigint, The beginning time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577836800', '1577844000', '1577851200'].),\n  (end_time:bigint, The end time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577840400', '1577847600', '1577854800'].),\n]\n# Table: time_zone\n[\n  (time_zone_code:text, A short code that represents the time zone. For example, 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['PST', 'MST'].),\n  (time_zone_name:text, The name of the time zone. Value examples: ['Pacific Standard Time', 'Mountain Standard Time'].),\n  (hours_from_gmt:bigint, The number of hours that the time zone is ahead or behind Greenwich Mean Time (GMT). Value examples: ['-8', '-7'].),\n]\n\n【Foreign keys】\nairline.airline_code = flight.airline_code\nairline.airline_code = flight_stop.departure_airline\nairport.airport_code = fare.from_airport\nairport.airport_code = flight_stop.stop_airport\nairport_service.city_code = ground_service.city_code\nairport.state_code = city.state_code\nairport.state_code = state.state_code\ncity.state_code = state.state_code\nairport_service.city_code = city.city_code\nground_service.city_code = city.city_code\nairport.time_zone_code = time_zone.time_zone_code\ncity.time_zone_code = time_zone.time_zone_code\nflight.flight_id = flight_fare.flight_id\nflight.flight_id = flight_leg.flight_id\nflight.flight_id = flight_stop.flight_id\nflight_fare.flight_id = flight_leg.flight_id\nflight_fare.flight_id = flight_stop.flight_id\nflight_leg.flight_id = flight_stop.flight_id\naircraft.aircraft_code = equipment_sequence.aircraft_code\nflight.aircraft_code_sequence = equipment_sequence.aircraft_code_sequence\nflight.meal_code = food_service.meal_code\n\n【参考信息】\n\n\n【用户问题】\nWhich flights serve meals in first class? Give me the flight id and meal description.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT flight.flight_id, food_service.meal_description FROM flight JOIN food_service ON flight.meal_code = food_service.meal_code WHERE LOWER(food_service.compartment) LIKE '%first class%';",
        "role": "assistant"
      }
    ],
    "db_name": "atis",
    "id": 80,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich airlines offer flights with a stopover in Dallas?\n\n【数据库schema】\n【DB_ID】 atis\n【Schema】\n# Table: aircraft\n[\n  (aircraft_code:text, The code assigned to the aircraft by the International Air Transport Association (IATA).. Value examples: ['B747', 'A320'].),\n  (aircraft_description:text, A short description of the aircraft.. Value examples: ['The Boeing 747 is a wide-body airliner.', 'The Airbus A320 is a narrow-body airliner.'].),\n  (manufacturer:text, The name of the manufacturer of the aircraft.. Value examples: ['Boeing', 'Airbus'].),\n  (basic_type:text, The basic type of the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (engines:bigint, The number of engines the aircraft has.. Value examples: ['4', '2'].),\n  (propulsion:text, The type of propulsion used by the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (wide_body:text, Indicates whether the aircraft is a wide body or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'No'].),\n  (wing_span:bigint, The distance between the tips of the aircraft's wings in feet.. Value examples: ['224', '111'].),\n  (length:bigint, The length of the aircraft in feet.. Value examples: ['231', '123'].),\n  (weight:bigint, The weight of the aircraft in pounds.. Value examples: ['987000', '162000'].),\n  (capacity:bigint, The maximum number of passengers the aircraft can carry.. Value examples: ['416', '240'].),\n  (pay_load:bigint, The maximum weight of cargo the aircraft can carry.. Value examples: ['60000', '30000'].),\n  (cruising_speed:bigint, The speed at which the aircraft cruises in miles per hour.. Value examples: ['570', '511'].),\n  (range_miles:bigint, The maximum distance the aircraft can fly in miles.. Value examples: ['8555', '3300'].),\n  (pressurized:text, Indicates whether the aircraft is pressurized or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'Yes'].),\n]\n# Table: airline\n[\n  (airline_code:text, The code assigned to the airline. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (airline_name:text, The name of the airline. Value examples: ['American Airlines', 'United Airlines', 'Delta Air Lines', 'Southwest Airlines'].),\n  (note:text, Any additional notes or comments about the airline. Value examples: ['NULL', 'NULL', 'NULL', 'NULL'].),\n]\n# Table: airport\n[\n  (airport_code:text, The code assigned to the airport.. Value examples: ['JFK', 'LAX', 'ORD', 'DFW'].),\n  (airport_name:text, The name of the airport.. Value examples: ['John F. Kennedy International Airport', 'Los Angeles International Airport', 'O’Hare International Airport', 'Dallas/Fort Worth International Airport'].),\n  (airport_location:text, The location of the airport, eg 'Las Vegas', 'Chicago'. Value examples: ['New York City', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The code assigned to the state where the airport is located.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the airport is located.. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the airport is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n  (minimum_connect_time:bigint, The minimum amount of time required for a connecting flight at the airport.. Value examples: ['23', '20', '24', '40'].),\n]\n# Table: airport_service\n[\n  (city_code:text, The code of the city where the airport is located. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The code of the airport. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (miles_distant:bigint, The distance of the airport from the city in miles. Value examples: ['10', '20', '30', '40'].),\n  (direction:text, The direction of the airport from the city. Either 'North', 'South', 'East', 'West', 'Northeast', 'Northwest', 'Southeast', or 'Southwest'.. Value examples: ['North', 'South', 'East', 'West'].),\n  (minutes_distant:bigint, The distance of the airport from the city in minutes. Value examples: ['20', '40', '60', '80'].),\n]\n# Table: city\n[\n  (city_code:text, The code assigned to the city. Value examples: ['NYC', 'LA', 'CHI', 'DA'].),\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The 2-letter code assigned to the state where the city is located. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the city is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n]\n# Table: class_of_service\n[\n  (booking_class:text, The booking class code for the class of service. Value examples: ['First', 'Business', 'Economy'].),\n  (rank:bigint, The rank of the class of service. Value examples: ['1', '2', '3'].),\n  (class_description:text, A brief description of the class of service. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: code_description\n[\n  (code:text, The code column contains a unique identifier for each record in the table.. Value examples: ['ABC', 'DEF'].),\n  (description:text, The description column contains a textual description of the code.. Value examples: ['Code ABC', 'Code DEF'].),\n]\n# Table: compartment_class\n[\n  (compartment:text, The compartment column contains the name of a compartment. Either 'First', 'Business', or 'Economy'.. Value examples: ['First', 'Business', 'Economy'].),\n  (class_type:text, The class_type column contains the type of a class. Either 'First Class', 'Business Class', or 'Economy Class'.. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: days\n[\n  (days_code:text, A code representing a day of the week. Value examples: ['1', '2'].),\n  (day_name:text, The name of a day of the week. Either 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', or 'Sunday'.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: dual_carrier\n[\n  (main_airline:text, The name of the main airline operating the flight. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (low_flight_number:bigint, The lowest flight number in the range of flights operated by the dual carrier. Value examples: ['1', '11', '21', '31'].),\n  (high_flight_number:bigint, The highest flight number in the range of flights operated by the dual carrier. Value examples: ['10', '20', '30', '40'].),\n  (dual_airline:text, The name of the dual airline operating the flight. Value examples: ['VX', 'DL', 'UA', 'AS'].),\n  (service_name:text, The name of the service provided by the dual carrier on the flight. Value examples: ['Dual Service 1', 'Dual Service 2', 'Dual Service 3', 'Dual Service 4'].),\n]\n# Table: equipment_sequence\n[\n  (aircraft_code_sequence:text, Sequence number for each aircraft code. Value examples: ['1', '2', '3', '4'].),\n  (aircraft_code:text, Code for each aircraft. Value examples: ['B747', 'A320', 'B737', 'A380'].),\n]\n# Table: fare\n[\n  (fare_id:bigint, The unique identifier for this fare. Value examples: ['1', '2'].),\n  (from_airport:text, The 3-letter airport code for the departure location. Value examples: ['ORD', 'ORD'].),\n  (to_airport:text, The 3-letter airport code for the arrival location. Value examples: ['JFK', 'JFK'].),\n  (fare_basis_code:text, The code used to determine the fare's pricing rules. Value examples: ['ABC', 'DEF'].),\n  (fare_airline:text, The airline code associated with this fare. Value examples: ['AA', 'UA'].),\n  (restriction_code:text, Any restrictions or limitations associated with this fare. Value examples: ['NONE', 'NONE'].),\n  (one_direction_cost:bigint, The cost of a one-way trip for this fare. Value examples: ['200', '150'].),\n  (round_trip_cost:bigint, The cost of a round-trip for this fare. Value examples: ['300', '280'].),\n  (round_trip_required:text, Indicates whether a round-trip is required to purchase this fare. Either Yes or No.. Value examples: ['Yes', 'No'].),\n]\n# Table: fare_basis\n[\n  (fare_basis_code:text, The code that identifies the fare basis. Value examples: ['ABC', 'DEF', 'GHI', 'JKL'].),\n  (booking_class:text, The booking class associated with the fare basis. Either 'First', 'Business', or 'Economy'. Value examples: ['First', 'Business', 'Economy', 'First'].),\n  (class_type:text, The class type associated with the fare basis. Either 'First Class', 'Business Class', or 'Economy Class'. Value examples: ['First Class', 'Business Class', 'Economy Class', 'First Class'].),\n  (premium:text, Indicates whether the fare basis is for a premium class. Value examples: ['Yes', 'Yes', 'No', 'Yes'].),\n  (economy:text, Indicates whether the fare basis is for an economy class. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (discounted:text, Indicates whether the fare basis is for a discounted fare. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (night:text, Indicates whether the fare basis is for a night fare. Value examples: ['No', 'No', 'No', 'No'].),\n  (season:text, The season associated with the fare basis. Can only be 'Peak' or 'Regular'. Value examples: ['Regular', 'Regular', 'Regular', 'Regular'].),\n  (basis_days:text, The number of days the fare basis is valid for. Value examples: ['30', '30', '30', '30'].),\n]\n# Table: flight\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['3', '4', '5', '7'].),\n  (flight_days:text, Days of the week the flight operates on. Formatted as comma-delimited 3-letter abbreviations, e.g. `mon,tue,wed` or `tues,thurs`. Value examples: ['wed', 'thu', 'fri', 'sun'].),\n  (from_airport:text, Code assigned to the departure airport. Value examples: ['ORD', 'ORD', 'ORD', 'JFK'].),\n  (to_airport:text, Code assigned to the arrival airport. Value examples: ['JFK', 'JFK', 'LAX', 'ORD'].),\n  (departure_time:bigint, Epoch timestamp for departure time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577858400', '1577865600', '1577880000'].),\n  (arrival_time:bigint, Epoch timestamp for arrival time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577854900', '1577873400', '1577869600', '1577883700'].),\n  (airline_flight:text, Code assigned to the airline flight. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (airline_code:text, Code assigned to the airline. Value examples: ['AA', 'WN', 'AS', 'UA'].),\n  (flight_number:text, Flight number assigned by the airline. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (aircraft_code_sequence:text, Code assigned to the aircraft. Value examples: ['3', '4', '5', '7'].),\n  (meal_code:text, Code assigned to the meal provided during the flight. Value examples: ['DN', 'BS', 'BF', 'DN'].),\n  (stops:bigint, Number of stops during the flight. Value examples: ['0', '1', '0', '0'].),\n  (connections:bigint, Number of connections during the flight. Value examples: ['0', '1', '0', '0'].),\n  (dual_carrier:text, Code assigned to the dual carrier. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (time_elapsed:bigint, Total time elapsed during the flight in seconds. Value examples: ['3700', '15000', '4000', '3700'].),\n]\n# Table: flight_fare\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3', '4'].),\n  (fare_id:bigint, Unique identifier for each fare. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: flight_leg\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3'].),\n  (leg_number:bigint, The sequence number of the leg within the flight. Value examples: ['1', '1', '1'].),\n  (leg_flight:bigint, The flight ID of the leg's corresponding flight. Value examples: ['1', '2', '3'].),\n]\n# Table: flight_stop\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['2', '4'].),\n  (stop_number:bigint, The order of the stop in the flight. Value examples: ['1', '1'].),\n  (stop_days:text, Days of the week on which the flight stops at this airport. Value examples: ['2', '4'].),\n  (stop_airport:text, The 3-letter airport code of the stop. Value examples: ['DFW', 'DEN'].),\n  (arrival_time:bigint, The time at which the flight arrives at this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577847600', '1577862000'].),\n  (arrival_airline:text, The airline code of the arriving flight. Value examples: ['UA', 'WN'].),\n  (arrival_flight_number:text, Flight number of the arriving flight at this stop. Value examples: ['UA456', 'WN012'].),\n  (departure_time:bigint, The time at which the flight departs from this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577865600'].),\n  (departure_airline:text, The airline code of the departing flight. Value examples: ['UA', 'WN'].),\n  (departure_flight_number:text, Flight number of the departing flight from this stop. Value examples: ['UA456', 'WN012'].),\n  (stop_time:bigint, The duration of the stop at this airport. Value examples: ['3600', '3600'].),\n]\n# Table: food_service\n[\n  (meal_code:text, Code assigned to each meal type. Value examples: ['BF', 'LN'].),\n  (meal_number:bigint, Unique identifier for each meal served. Value examples: ['1', '2'].),\n  (compartment:text, The compartment in which the meal is served (e.g. 'First Class', 'Economy'). Value examples: ['First Class', 'First Class'].),\n  (meal_description:text, One of 'Breakfast', 'Lunch', 'Dinner'. Value examples: ['Breakfast', 'Lunch'].),\n]\n# Table: ground_service\n[\n  (city_code:text, The code for the city where the ground service is provided. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The 3-letter code for the airport where the ground service is provided. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (transport_type:text, The type of ground transportation provided. Value examples: ['Taxi', 'Shuttle', 'Bus', 'Car Rental'].),\n  (ground_fare:bigint, The fare charged for ground transportation. Value examples: ['50', '40', '30', '60'].),\n]\n# Table: month\n[\n  (month_number:bigint, A unique number assigned to each month of the year.. Value examples: ['1', '2', '3', '4'].),\n  (month_name:text, The name of the month, e.g. January, February, etc.. Value examples: ['January', 'February', 'March', 'April'].),\n]\n# Table: restriction\n[\n  (restriction_code:text, A code representing the type of restriction, such as blackout dates or minimum stay.. Value examples: ['NONE', 'NONE', 'NONE', 'NONE'].),\n  (advance_purchase:bigint, The number of days in advance the fare must be purchased.. Value examples: ['14', '14', '14', '14'].),\n  (stopovers:text, The number of stopovers allowed for the fare.. Value examples: ['2', '2', '2', '2'].),\n  (saturday_stay_required:text, Indicates whether a Saturday night stay is required for the fare. Either 'Yes' or 'No'.. Value examples: ['No', 'No', 'No', 'No'].),\n  (minimum_stay:bigint, The minimum length of stay required for the fare.. Value examples: ['7', '7', '7', '7'].),\n  (maximum_stay:bigint, The maximum length of stay allowed for the fare.. Value examples: ['30', '30', '30', '30'].),\n  (application:text, The type of fare application. Either 'One Way' or 'Round Trip'.. Value examples: ['One-Way', 'One-Way', 'One-Way', 'One-Way'].),\n  (no_discounts:text, Indicates whether the fare is eligible for discounts or promotions. Either 'Yes' or 'No'.. Value examples: ['Yes', 'Yes', 'Yes', 'Yes'].),\n]\n# Table: state\n[\n  (state_code:text, The 2-letter code assigned to the state. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA'].),\n  (state_name:text, The name of the state. Value examples: ['New York', 'California'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States'].),\n]\n# Table: time_interval\n[\n  (period:text, The period of the time interval, represented as a string. For example, 'daily', 'weekly', 'monthly', etc.. Value examples: ['daily', 'daily', 'daily'].),\n  (begin_time:bigint, The beginning time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577836800', '1577844000', '1577851200'].),\n  (end_time:bigint, The end time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577840400', '1577847600', '1577854800'].),\n]\n# Table: time_zone\n[\n  (time_zone_code:text, A short code that represents the time zone. For example, 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['PST', 'MST'].),\n  (time_zone_name:text, The name of the time zone. Value examples: ['Pacific Standard Time', 'Mountain Standard Time'].),\n  (hours_from_gmt:bigint, The number of hours that the time zone is ahead or behind Greenwich Mean Time (GMT). Value examples: ['-8', '-7'].),\n]\n\n【Foreign keys】\nairline.airline_code = flight.airline_code\nairline.airline_code = flight_stop.departure_airline\nairport.airport_code = fare.from_airport\nairport.airport_code = flight_stop.stop_airport\nairport_service.city_code = ground_service.city_code\nairport.state_code = city.state_code\nairport.state_code = state.state_code\ncity.state_code = state.state_code\nairport_service.city_code = city.city_code\nground_service.city_code = city.city_code\nairport.time_zone_code = time_zone.time_zone_code\ncity.time_zone_code = time_zone.time_zone_code\nflight.flight_id = flight_fare.flight_id\nflight.flight_id = flight_leg.flight_id\nflight.flight_id = flight_stop.flight_id\nflight_fare.flight_id = flight_leg.flight_id\nflight_fare.flight_id = flight_stop.flight_id\nflight_leg.flight_id = flight_stop.flight_id\naircraft.aircraft_code = equipment_sequence.aircraft_code\nflight.aircraft_code_sequence = equipment_sequence.aircraft_code_sequence\nflight.meal_code = food_service.meal_code\n\n【参考信息】\n\n\n【用户问题】\nWhich airlines offer flights with a stopover in Dallas?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT DISTINCT airline.airline_name, airline.airline_code FROM flight_stop JOIN airport ON flight_stop.stop_airport = airport.airport_code JOIN flight ON flight_stop.flight_id = flight.flight_id JOIN airline ON flight.airline_code = airline.airline_code WHERE airport.airport_location ILIKE '%Dallas%'",
        "role": "assistant"
      }
    ],
    "db_name": "atis",
    "id": 81,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich airlines offer flights from LAX to ORD?\n\n【数据库schema】\n【DB_ID】 atis\n【Schema】\n# Table: aircraft\n[\n  (aircraft_code:text, The code assigned to the aircraft by the International Air Transport Association (IATA).. Value examples: ['B747', 'A320'].),\n  (aircraft_description:text, A short description of the aircraft.. Value examples: ['The Boeing 747 is a wide-body airliner.', 'The Airbus A320 is a narrow-body airliner.'].),\n  (manufacturer:text, The name of the manufacturer of the aircraft.. Value examples: ['Boeing', 'Airbus'].),\n  (basic_type:text, The basic type of the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (engines:bigint, The number of engines the aircraft has.. Value examples: ['4', '2'].),\n  (propulsion:text, The type of propulsion used by the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (wide_body:text, Indicates whether the aircraft is a wide body or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'No'].),\n  (wing_span:bigint, The distance between the tips of the aircraft's wings in feet.. Value examples: ['224', '111'].),\n  (length:bigint, The length of the aircraft in feet.. Value examples: ['231', '123'].),\n  (weight:bigint, The weight of the aircraft in pounds.. Value examples: ['987000', '162000'].),\n  (capacity:bigint, The maximum number of passengers the aircraft can carry.. Value examples: ['416', '240'].),\n  (pay_load:bigint, The maximum weight of cargo the aircraft can carry.. Value examples: ['60000', '30000'].),\n  (cruising_speed:bigint, The speed at which the aircraft cruises in miles per hour.. Value examples: ['570', '511'].),\n  (range_miles:bigint, The maximum distance the aircraft can fly in miles.. Value examples: ['8555', '3300'].),\n  (pressurized:text, Indicates whether the aircraft is pressurized or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'Yes'].),\n]\n# Table: airline\n[\n  (airline_code:text, The code assigned to the airline. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (airline_name:text, The name of the airline. Value examples: ['American Airlines', 'United Airlines', 'Delta Air Lines', 'Southwest Airlines'].),\n  (note:text, Any additional notes or comments about the airline. Value examples: ['NULL', 'NULL', 'NULL', 'NULL'].),\n]\n# Table: airport\n[\n  (airport_code:text, The code assigned to the airport.. Value examples: ['JFK', 'LAX', 'ORD', 'DFW'].),\n  (airport_name:text, The name of the airport.. Value examples: ['John F. Kennedy International Airport', 'Los Angeles International Airport', 'O’Hare International Airport', 'Dallas/Fort Worth International Airport'].),\n  (airport_location:text, The location of the airport, eg 'Las Vegas', 'Chicago'. Value examples: ['New York City', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The code assigned to the state where the airport is located.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the airport is located.. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the airport is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n  (minimum_connect_time:bigint, The minimum amount of time required for a connecting flight at the airport.. Value examples: ['23', '20', '24', '40'].),\n]\n# Table: airport_service\n[\n  (city_code:text, The code of the city where the airport is located. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The code of the airport. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (miles_distant:bigint, The distance of the airport from the city in miles. Value examples: ['10', '20', '30', '40'].),\n  (direction:text, The direction of the airport from the city. Either 'North', 'South', 'East', 'West', 'Northeast', 'Northwest', 'Southeast', or 'Southwest'.. Value examples: ['North', 'South', 'East', 'West'].),\n  (minutes_distant:bigint, The distance of the airport from the city in minutes. Value examples: ['20', '40', '60', '80'].),\n]\n# Table: city\n[\n  (city_code:text, The code assigned to the city. Value examples: ['NYC', 'LA', 'CHI', 'DA'].),\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The 2-letter code assigned to the state where the city is located. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the city is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n]\n# Table: class_of_service\n[\n  (booking_class:text, The booking class code for the class of service. Value examples: ['First', 'Business', 'Economy'].),\n  (rank:bigint, The rank of the class of service. Value examples: ['1', '2', '3'].),\n  (class_description:text, A brief description of the class of service. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: code_description\n[\n  (code:text, The code column contains a unique identifier for each record in the table.. Value examples: ['ABC', 'DEF'].),\n  (description:text, The description column contains a textual description of the code.. Value examples: ['Code ABC', 'Code DEF'].),\n]\n# Table: compartment_class\n[\n  (compartment:text, The compartment column contains the name of a compartment. Either 'First', 'Business', or 'Economy'.. Value examples: ['First', 'Business', 'Economy'].),\n  (class_type:text, The class_type column contains the type of a class. Either 'First Class', 'Business Class', or 'Economy Class'.. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: days\n[\n  (days_code:text, A code representing a day of the week. Value examples: ['1', '2'].),\n  (day_name:text, The name of a day of the week. Either 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', or 'Sunday'.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: dual_carrier\n[\n  (main_airline:text, The name of the main airline operating the flight. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (low_flight_number:bigint, The lowest flight number in the range of flights operated by the dual carrier. Value examples: ['1', '11', '21', '31'].),\n  (high_flight_number:bigint, The highest flight number in the range of flights operated by the dual carrier. Value examples: ['10', '20', '30', '40'].),\n  (dual_airline:text, The name of the dual airline operating the flight. Value examples: ['VX', 'DL', 'UA', 'AS'].),\n  (service_name:text, The name of the service provided by the dual carrier on the flight. Value examples: ['Dual Service 1', 'Dual Service 2', 'Dual Service 3', 'Dual Service 4'].),\n]\n# Table: equipment_sequence\n[\n  (aircraft_code_sequence:text, Sequence number for each aircraft code. Value examples: ['1', '2', '3', '4'].),\n  (aircraft_code:text, Code for each aircraft. Value examples: ['B747', 'A320', 'B737', 'A380'].),\n]\n# Table: fare\n[\n  (fare_id:bigint, The unique identifier for this fare. Value examples: ['1', '2'].),\n  (from_airport:text, The 3-letter airport code for the departure location. Value examples: ['ORD', 'ORD'].),\n  (to_airport:text, The 3-letter airport code for the arrival location. Value examples: ['JFK', 'JFK'].),\n  (fare_basis_code:text, The code used to determine the fare's pricing rules. Value examples: ['ABC', 'DEF'].),\n  (fare_airline:text, The airline code associated with this fare. Value examples: ['AA', 'UA'].),\n  (restriction_code:text, Any restrictions or limitations associated with this fare. Value examples: ['NONE', 'NONE'].),\n  (one_direction_cost:bigint, The cost of a one-way trip for this fare. Value examples: ['200', '150'].),\n  (round_trip_cost:bigint, The cost of a round-trip for this fare. Value examples: ['300', '280'].),\n  (round_trip_required:text, Indicates whether a round-trip is required to purchase this fare. Either Yes or No.. Value examples: ['Yes', 'No'].),\n]\n# Table: fare_basis\n[\n  (fare_basis_code:text, The code that identifies the fare basis. Value examples: ['ABC', 'DEF', 'GHI', 'JKL'].),\n  (booking_class:text, The booking class associated with the fare basis. Either 'First', 'Business', or 'Economy'. Value examples: ['First', 'Business', 'Economy', 'First'].),\n  (class_type:text, The class type associated with the fare basis. Either 'First Class', 'Business Class', or 'Economy Class'. Value examples: ['First Class', 'Business Class', 'Economy Class', 'First Class'].),\n  (premium:text, Indicates whether the fare basis is for a premium class. Value examples: ['Yes', 'Yes', 'No', 'Yes'].),\n  (economy:text, Indicates whether the fare basis is for an economy class. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (discounted:text, Indicates whether the fare basis is for a discounted fare. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (night:text, Indicates whether the fare basis is for a night fare. Value examples: ['No', 'No', 'No', 'No'].),\n  (season:text, The season associated with the fare basis. Can only be 'Peak' or 'Regular'. Value examples: ['Regular', 'Regular', 'Regular', 'Regular'].),\n  (basis_days:text, The number of days the fare basis is valid for. Value examples: ['30', '30', '30', '30'].),\n]\n# Table: flight\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['3', '4', '5', '7'].),\n  (flight_days:text, Days of the week the flight operates on. Formatted as comma-delimited 3-letter abbreviations, e.g. `mon,tue,wed` or `tues,thurs`. Value examples: ['wed', 'thu', 'fri', 'sun'].),\n  (from_airport:text, Code assigned to the departure airport. Value examples: ['ORD', 'ORD', 'ORD', 'JFK'].),\n  (to_airport:text, Code assigned to the arrival airport. Value examples: ['JFK', 'JFK', 'LAX', 'ORD'].),\n  (departure_time:bigint, Epoch timestamp for departure time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577858400', '1577865600', '1577880000'].),\n  (arrival_time:bigint, Epoch timestamp for arrival time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577854900', '1577873400', '1577869600', '1577883700'].),\n  (airline_flight:text, Code assigned to the airline flight. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (airline_code:text, Code assigned to the airline. Value examples: ['AA', 'WN', 'AS', 'UA'].),\n  (flight_number:text, Flight number assigned by the airline. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (aircraft_code_sequence:text, Code assigned to the aircraft. Value examples: ['3', '4', '5', '7'].),\n  (meal_code:text, Code assigned to the meal provided during the flight. Value examples: ['DN', 'BS', 'BF', 'DN'].),\n  (stops:bigint, Number of stops during the flight. Value examples: ['0', '1', '0', '0'].),\n  (connections:bigint, Number of connections during the flight. Value examples: ['0', '1', '0', '0'].),\n  (dual_carrier:text, Code assigned to the dual carrier. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (time_elapsed:bigint, Total time elapsed during the flight in seconds. Value examples: ['3700', '15000', '4000', '3700'].),\n]\n# Table: flight_fare\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3', '4'].),\n  (fare_id:bigint, Unique identifier for each fare. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: flight_leg\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3'].),\n  (leg_number:bigint, The sequence number of the leg within the flight. Value examples: ['1', '1', '1'].),\n  (leg_flight:bigint, The flight ID of the leg's corresponding flight. Value examples: ['1', '2', '3'].),\n]\n# Table: flight_stop\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['2', '4'].),\n  (stop_number:bigint, The order of the stop in the flight. Value examples: ['1', '1'].),\n  (stop_days:text, Days of the week on which the flight stops at this airport. Value examples: ['2', '4'].),\n  (stop_airport:text, The 3-letter airport code of the stop. Value examples: ['DFW', 'DEN'].),\n  (arrival_time:bigint, The time at which the flight arrives at this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577847600', '1577862000'].),\n  (arrival_airline:text, The airline code of the arriving flight. Value examples: ['UA', 'WN'].),\n  (arrival_flight_number:text, Flight number of the arriving flight at this stop. Value examples: ['UA456', 'WN012'].),\n  (departure_time:bigint, The time at which the flight departs from this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577865600'].),\n  (departure_airline:text, The airline code of the departing flight. Value examples: ['UA', 'WN'].),\n  (departure_flight_number:text, Flight number of the departing flight from this stop. Value examples: ['UA456', 'WN012'].),\n  (stop_time:bigint, The duration of the stop at this airport. Value examples: ['3600', '3600'].),\n]\n# Table: food_service\n[\n  (meal_code:text, Code assigned to each meal type. Value examples: ['BF', 'LN'].),\n  (meal_number:bigint, Unique identifier for each meal served. Value examples: ['1', '2'].),\n  (compartment:text, The compartment in which the meal is served (e.g. 'First Class', 'Economy'). Value examples: ['First Class', 'First Class'].),\n  (meal_description:text, One of 'Breakfast', 'Lunch', 'Dinner'. Value examples: ['Breakfast', 'Lunch'].),\n]\n# Table: ground_service\n[\n  (city_code:text, The code for the city where the ground service is provided. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The 3-letter code for the airport where the ground service is provided. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (transport_type:text, The type of ground transportation provided. Value examples: ['Taxi', 'Shuttle', 'Bus', 'Car Rental'].),\n  (ground_fare:bigint, The fare charged for ground transportation. Value examples: ['50', '40', '30', '60'].),\n]\n# Table: month\n[\n  (month_number:bigint, A unique number assigned to each month of the year.. Value examples: ['1', '2', '3', '4'].),\n  (month_name:text, The name of the month, e.g. January, February, etc.. Value examples: ['January', 'February', 'March', 'April'].),\n]\n# Table: restriction\n[\n  (restriction_code:text, A code representing the type of restriction, such as blackout dates or minimum stay.. Value examples: ['NONE', 'NONE', 'NONE', 'NONE'].),\n  (advance_purchase:bigint, The number of days in advance the fare must be purchased.. Value examples: ['14', '14', '14', '14'].),\n  (stopovers:text, The number of stopovers allowed for the fare.. Value examples: ['2', '2', '2', '2'].),\n  (saturday_stay_required:text, Indicates whether a Saturday night stay is required for the fare. Either 'Yes' or 'No'.. Value examples: ['No', 'No', 'No', 'No'].),\n  (minimum_stay:bigint, The minimum length of stay required for the fare.. Value examples: ['7', '7', '7', '7'].),\n  (maximum_stay:bigint, The maximum length of stay allowed for the fare.. Value examples: ['30', '30', '30', '30'].),\n  (application:text, The type of fare application. Either 'One Way' or 'Round Trip'.. Value examples: ['One-Way', 'One-Way', 'One-Way', 'One-Way'].),\n  (no_discounts:text, Indicates whether the fare is eligible for discounts or promotions. Either 'Yes' or 'No'.. Value examples: ['Yes', 'Yes', 'Yes', 'Yes'].),\n]\n# Table: state\n[\n  (state_code:text, The 2-letter code assigned to the state. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA'].),\n  (state_name:text, The name of the state. Value examples: ['New York', 'California'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States'].),\n]\n# Table: time_interval\n[\n  (period:text, The period of the time interval, represented as a string. For example, 'daily', 'weekly', 'monthly', etc.. Value examples: ['daily', 'daily', 'daily'].),\n  (begin_time:bigint, The beginning time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577836800', '1577844000', '1577851200'].),\n  (end_time:bigint, The end time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577840400', '1577847600', '1577854800'].),\n]\n# Table: time_zone\n[\n  (time_zone_code:text, A short code that represents the time zone. For example, 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['PST', 'MST'].),\n  (time_zone_name:text, The name of the time zone. Value examples: ['Pacific Standard Time', 'Mountain Standard Time'].),\n  (hours_from_gmt:bigint, The number of hours that the time zone is ahead or behind Greenwich Mean Time (GMT). Value examples: ['-8', '-7'].),\n]\n\n【Foreign keys】\nairline.airline_code = flight.airline_code\nairline.airline_code = flight_stop.departure_airline\nairport.airport_code = fare.from_airport\nairport.airport_code = flight_stop.stop_airport\nairport_service.city_code = ground_service.city_code\nairport.state_code = city.state_code\nairport.state_code = state.state_code\ncity.state_code = state.state_code\nairport_service.city_code = city.city_code\nground_service.city_code = city.city_code\nairport.time_zone_code = time_zone.time_zone_code\ncity.time_zone_code = time_zone.time_zone_code\nflight.flight_id = flight_fare.flight_id\nflight.flight_id = flight_leg.flight_id\nflight.flight_id = flight_stop.flight_id\nflight_fare.flight_id = flight_leg.flight_id\nflight_fare.flight_id = flight_stop.flight_id\nflight_leg.flight_id = flight_stop.flight_id\naircraft.aircraft_code = equipment_sequence.aircraft_code\nflight.aircraft_code_sequence = equipment_sequence.aircraft_code_sequence\nflight.meal_code = food_service.meal_code\n\n【参考信息】\n\n\n【用户问题】\nWhich airlines offer flights from LAX to ORD?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT DISTINCT airline.airline_name, airline.airline_code FROM flight JOIN airline ON flight.airline_code = airline.airline_code WHERE flight.from_airport = 'LAX' AND flight.to_airport = 'ORD'",
        "role": "assistant"
      }
    ],
    "db_name": "atis",
    "id": 82,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich airlines offer flights from Chicago (ORD) to New York (JFK), and how many stops do they have, sorted by number of stops in ascending order?\n\n【数据库schema】\n【DB_ID】 atis\n【Schema】\n# Table: aircraft\n[\n  (aircraft_code:text, The code assigned to the aircraft by the International Air Transport Association (IATA).. Value examples: ['B747', 'A320'].),\n  (aircraft_description:text, A short description of the aircraft.. Value examples: ['The Boeing 747 is a wide-body airliner.', 'The Airbus A320 is a narrow-body airliner.'].),\n  (manufacturer:text, The name of the manufacturer of the aircraft.. Value examples: ['Boeing', 'Airbus'].),\n  (basic_type:text, The basic type of the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (engines:bigint, The number of engines the aircraft has.. Value examples: ['4', '2'].),\n  (propulsion:text, The type of propulsion used by the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (wide_body:text, Indicates whether the aircraft is a wide body or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'No'].),\n  (wing_span:bigint, The distance between the tips of the aircraft's wings in feet.. Value examples: ['224', '111'].),\n  (length:bigint, The length of the aircraft in feet.. Value examples: ['231', '123'].),\n  (weight:bigint, The weight of the aircraft in pounds.. Value examples: ['987000', '162000'].),\n  (capacity:bigint, The maximum number of passengers the aircraft can carry.. Value examples: ['416', '240'].),\n  (pay_load:bigint, The maximum weight of cargo the aircraft can carry.. Value examples: ['60000', '30000'].),\n  (cruising_speed:bigint, The speed at which the aircraft cruises in miles per hour.. Value examples: ['570', '511'].),\n  (range_miles:bigint, The maximum distance the aircraft can fly in miles.. Value examples: ['8555', '3300'].),\n  (pressurized:text, Indicates whether the aircraft is pressurized or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'Yes'].),\n]\n# Table: airline\n[\n  (airline_code:text, The code assigned to the airline. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (airline_name:text, The name of the airline. Value examples: ['American Airlines', 'United Airlines', 'Delta Air Lines', 'Southwest Airlines'].),\n  (note:text, Any additional notes or comments about the airline. Value examples: ['NULL', 'NULL', 'NULL', 'NULL'].),\n]\n# Table: airport\n[\n  (airport_code:text, The code assigned to the airport.. Value examples: ['JFK', 'LAX', 'ORD', 'DFW'].),\n  (airport_name:text, The name of the airport.. Value examples: ['John F. Kennedy International Airport', 'Los Angeles International Airport', 'O’Hare International Airport', 'Dallas/Fort Worth International Airport'].),\n  (airport_location:text, The location of the airport, eg 'Las Vegas', 'Chicago'. Value examples: ['New York City', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The code assigned to the state where the airport is located.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the airport is located.. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the airport is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n  (minimum_connect_time:bigint, The minimum amount of time required for a connecting flight at the airport.. Value examples: ['23', '20', '24', '40'].),\n]\n# Table: airport_service\n[\n  (city_code:text, The code of the city where the airport is located. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The code of the airport. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (miles_distant:bigint, The distance of the airport from the city in miles. Value examples: ['10', '20', '30', '40'].),\n  (direction:text, The direction of the airport from the city. Either 'North', 'South', 'East', 'West', 'Northeast', 'Northwest', 'Southeast', or 'Southwest'.. Value examples: ['North', 'South', 'East', 'West'].),\n  (minutes_distant:bigint, The distance of the airport from the city in minutes. Value examples: ['20', '40', '60', '80'].),\n]\n# Table: city\n[\n  (city_code:text, The code assigned to the city. Value examples: ['NYC', 'LA', 'CHI', 'DA'].),\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The 2-letter code assigned to the state where the city is located. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the city is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n]\n# Table: class_of_service\n[\n  (booking_class:text, The booking class code for the class of service. Value examples: ['First', 'Business', 'Economy'].),\n  (rank:bigint, The rank of the class of service. Value examples: ['1', '2', '3'].),\n  (class_description:text, A brief description of the class of service. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: code_description\n[\n  (code:text, The code column contains a unique identifier for each record in the table.. Value examples: ['ABC', 'DEF'].),\n  (description:text, The description column contains a textual description of the code.. Value examples: ['Code ABC', 'Code DEF'].),\n]\n# Table: compartment_class\n[\n  (compartment:text, The compartment column contains the name of a compartment. Either 'First', 'Business', or 'Economy'.. Value examples: ['First', 'Business', 'Economy'].),\n  (class_type:text, The class_type column contains the type of a class. Either 'First Class', 'Business Class', or 'Economy Class'.. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: days\n[\n  (days_code:text, A code representing a day of the week. Value examples: ['1', '2'].),\n  (day_name:text, The name of a day of the week. Either 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', or 'Sunday'.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: dual_carrier\n[\n  (main_airline:text, The name of the main airline operating the flight. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (low_flight_number:bigint, The lowest flight number in the range of flights operated by the dual carrier. Value examples: ['1', '11', '21', '31'].),\n  (high_flight_number:bigint, The highest flight number in the range of flights operated by the dual carrier. Value examples: ['10', '20', '30', '40'].),\n  (dual_airline:text, The name of the dual airline operating the flight. Value examples: ['VX', 'DL', 'UA', 'AS'].),\n  (service_name:text, The name of the service provided by the dual carrier on the flight. Value examples: ['Dual Service 1', 'Dual Service 2', 'Dual Service 3', 'Dual Service 4'].),\n]\n# Table: equipment_sequence\n[\n  (aircraft_code_sequence:text, Sequence number for each aircraft code. Value examples: ['1', '2', '3', '4'].),\n  (aircraft_code:text, Code for each aircraft. Value examples: ['B747', 'A320', 'B737', 'A380'].),\n]\n# Table: fare\n[\n  (fare_id:bigint, The unique identifier for this fare. Value examples: ['1', '2'].),\n  (from_airport:text, The 3-letter airport code for the departure location. Value examples: ['ORD', 'ORD'].),\n  (to_airport:text, The 3-letter airport code for the arrival location. Value examples: ['JFK', 'JFK'].),\n  (fare_basis_code:text, The code used to determine the fare's pricing rules. Value examples: ['ABC', 'DEF'].),\n  (fare_airline:text, The airline code associated with this fare. Value examples: ['AA', 'UA'].),\n  (restriction_code:text, Any restrictions or limitations associated with this fare. Value examples: ['NONE', 'NONE'].),\n  (one_direction_cost:bigint, The cost of a one-way trip for this fare. Value examples: ['200', '150'].),\n  (round_trip_cost:bigint, The cost of a round-trip for this fare. Value examples: ['300', '280'].),\n  (round_trip_required:text, Indicates whether a round-trip is required to purchase this fare. Either Yes or No.. Value examples: ['Yes', 'No'].),\n]\n# Table: fare_basis\n[\n  (fare_basis_code:text, The code that identifies the fare basis. Value examples: ['ABC', 'DEF', 'GHI', 'JKL'].),\n  (booking_class:text, The booking class associated with the fare basis. Either 'First', 'Business', or 'Economy'. Value examples: ['First', 'Business', 'Economy', 'First'].),\n  (class_type:text, The class type associated with the fare basis. Either 'First Class', 'Business Class', or 'Economy Class'. Value examples: ['First Class', 'Business Class', 'Economy Class', 'First Class'].),\n  (premium:text, Indicates whether the fare basis is for a premium class. Value examples: ['Yes', 'Yes', 'No', 'Yes'].),\n  (economy:text, Indicates whether the fare basis is for an economy class. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (discounted:text, Indicates whether the fare basis is for a discounted fare. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (night:text, Indicates whether the fare basis is for a night fare. Value examples: ['No', 'No', 'No', 'No'].),\n  (season:text, The season associated with the fare basis. Can only be 'Peak' or 'Regular'. Value examples: ['Regular', 'Regular', 'Regular', 'Regular'].),\n  (basis_days:text, The number of days the fare basis is valid for. Value examples: ['30', '30', '30', '30'].),\n]\n# Table: flight\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['3', '4', '5', '7'].),\n  (flight_days:text, Days of the week the flight operates on. Formatted as comma-delimited 3-letter abbreviations, e.g. `mon,tue,wed` or `tues,thurs`. Value examples: ['wed', 'thu', 'fri', 'sun'].),\n  (from_airport:text, Code assigned to the departure airport. Value examples: ['ORD', 'ORD', 'ORD', 'JFK'].),\n  (to_airport:text, Code assigned to the arrival airport. Value examples: ['JFK', 'JFK', 'LAX', 'ORD'].),\n  (departure_time:bigint, Epoch timestamp for departure time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577858400', '1577865600', '1577880000'].),\n  (arrival_time:bigint, Epoch timestamp for arrival time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577854900', '1577873400', '1577869600', '1577883700'].),\n  (airline_flight:text, Code assigned to the airline flight. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (airline_code:text, Code assigned to the airline. Value examples: ['AA', 'WN', 'AS', 'UA'].),\n  (flight_number:text, Flight number assigned by the airline. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (aircraft_code_sequence:text, Code assigned to the aircraft. Value examples: ['3', '4', '5', '7'].),\n  (meal_code:text, Code assigned to the meal provided during the flight. Value examples: ['DN', 'BS', 'BF', 'DN'].),\n  (stops:bigint, Number of stops during the flight. Value examples: ['0', '1', '0', '0'].),\n  (connections:bigint, Number of connections during the flight. Value examples: ['0', '1', '0', '0'].),\n  (dual_carrier:text, Code assigned to the dual carrier. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (time_elapsed:bigint, Total time elapsed during the flight in seconds. Value examples: ['3700', '15000', '4000', '3700'].),\n]\n# Table: flight_fare\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3', '4'].),\n  (fare_id:bigint, Unique identifier for each fare. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: flight_leg\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3'].),\n  (leg_number:bigint, The sequence number of the leg within the flight. Value examples: ['1', '1', '1'].),\n  (leg_flight:bigint, The flight ID of the leg's corresponding flight. Value examples: ['1', '2', '3'].),\n]\n# Table: flight_stop\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['2', '4'].),\n  (stop_number:bigint, The order of the stop in the flight. Value examples: ['1', '1'].),\n  (stop_days:text, Days of the week on which the flight stops at this airport. Value examples: ['2', '4'].),\n  (stop_airport:text, The 3-letter airport code of the stop. Value examples: ['DFW', 'DEN'].),\n  (arrival_time:bigint, The time at which the flight arrives at this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577847600', '1577862000'].),\n  (arrival_airline:text, The airline code of the arriving flight. Value examples: ['UA', 'WN'].),\n  (arrival_flight_number:text, Flight number of the arriving flight at this stop. Value examples: ['UA456', 'WN012'].),\n  (departure_time:bigint, The time at which the flight departs from this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577865600'].),\n  (departure_airline:text, The airline code of the departing flight. Value examples: ['UA', 'WN'].),\n  (departure_flight_number:text, Flight number of the departing flight from this stop. Value examples: ['UA456', 'WN012'].),\n  (stop_time:bigint, The duration of the stop at this airport. Value examples: ['3600', '3600'].),\n]\n# Table: food_service\n[\n  (meal_code:text, Code assigned to each meal type. Value examples: ['BF', 'LN'].),\n  (meal_number:bigint, Unique identifier for each meal served. Value examples: ['1', '2'].),\n  (compartment:text, The compartment in which the meal is served (e.g. 'First Class', 'Economy'). Value examples: ['First Class', 'First Class'].),\n  (meal_description:text, One of 'Breakfast', 'Lunch', 'Dinner'. Value examples: ['Breakfast', 'Lunch'].),\n]\n# Table: ground_service\n[\n  (city_code:text, The code for the city where the ground service is provided. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The 3-letter code for the airport where the ground service is provided. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (transport_type:text, The type of ground transportation provided. Value examples: ['Taxi', 'Shuttle', 'Bus', 'Car Rental'].),\n  (ground_fare:bigint, The fare charged for ground transportation. Value examples: ['50', '40', '30', '60'].),\n]\n# Table: month\n[\n  (month_number:bigint, A unique number assigned to each month of the year.. Value examples: ['1', '2', '3', '4'].),\n  (month_name:text, The name of the month, e.g. January, February, etc.. Value examples: ['January', 'February', 'March', 'April'].),\n]\n# Table: restriction\n[\n  (restriction_code:text, A code representing the type of restriction, such as blackout dates or minimum stay.. Value examples: ['NONE', 'NONE', 'NONE', 'NONE'].),\n  (advance_purchase:bigint, The number of days in advance the fare must be purchased.. Value examples: ['14', '14', '14', '14'].),\n  (stopovers:text, The number of stopovers allowed for the fare.. Value examples: ['2', '2', '2', '2'].),\n  (saturday_stay_required:text, Indicates whether a Saturday night stay is required for the fare. Either 'Yes' or 'No'.. Value examples: ['No', 'No', 'No', 'No'].),\n  (minimum_stay:bigint, The minimum length of stay required for the fare.. Value examples: ['7', '7', '7', '7'].),\n  (maximum_stay:bigint, The maximum length of stay allowed for the fare.. Value examples: ['30', '30', '30', '30'].),\n  (application:text, The type of fare application. Either 'One Way' or 'Round Trip'.. Value examples: ['One-Way', 'One-Way', 'One-Way', 'One-Way'].),\n  (no_discounts:text, Indicates whether the fare is eligible for discounts or promotions. Either 'Yes' or 'No'.. Value examples: ['Yes', 'Yes', 'Yes', 'Yes'].),\n]\n# Table: state\n[\n  (state_code:text, The 2-letter code assigned to the state. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA'].),\n  (state_name:text, The name of the state. Value examples: ['New York', 'California'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States'].),\n]\n# Table: time_interval\n[\n  (period:text, The period of the time interval, represented as a string. For example, 'daily', 'weekly', 'monthly', etc.. Value examples: ['daily', 'daily', 'daily'].),\n  (begin_time:bigint, The beginning time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577836800', '1577844000', '1577851200'].),\n  (end_time:bigint, The end time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577840400', '1577847600', '1577854800'].),\n]\n# Table: time_zone\n[\n  (time_zone_code:text, A short code that represents the time zone. For example, 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['PST', 'MST'].),\n  (time_zone_name:text, The name of the time zone. Value examples: ['Pacific Standard Time', 'Mountain Standard Time'].),\n  (hours_from_gmt:bigint, The number of hours that the time zone is ahead or behind Greenwich Mean Time (GMT). Value examples: ['-8', '-7'].),\n]\n\n【Foreign keys】\nairline.airline_code = flight.airline_code\nairline.airline_code = flight_stop.departure_airline\nairport.airport_code = fare.from_airport\nairport.airport_code = flight_stop.stop_airport\nairport_service.city_code = ground_service.city_code\nairport.state_code = city.state_code\nairport.state_code = state.state_code\ncity.state_code = state.state_code\nairport_service.city_code = city.city_code\nground_service.city_code = city.city_code\nairport.time_zone_code = time_zone.time_zone_code\ncity.time_zone_code = time_zone.time_zone_code\nflight.flight_id = flight_fare.flight_id\nflight.flight_id = flight_leg.flight_id\nflight.flight_id = flight_stop.flight_id\nflight_fare.flight_id = flight_leg.flight_id\nflight_fare.flight_id = flight_stop.flight_id\nflight_leg.flight_id = flight_stop.flight_id\naircraft.aircraft_code = equipment_sequence.aircraft_code\nflight.aircraft_code_sequence = equipment_sequence.aircraft_code_sequence\nflight.meal_code = food_service.meal_code\n\n【参考信息】\n\n\n【用户问题】\nWhich airlines offer flights from Chicago (ORD) to New York (JFK), and how many stops do they have, sorted by number of stops in ascending order?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT airline.airline_name, airline.airline_code, flight.stops FROM flight JOIN airline ON flight.airline_code = airline.airline_code WHERE flight.from_airport = 'ORD' AND flight.to_airport = 'JFK' ORDER BY flight.stops NULLS LAST",
        "role": "assistant"
      }
    ],
    "db_name": "atis",
    "id": 83,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich airlines do not have any flights that either depart from/arrive at JFK, or have one or more stops?\n\n【数据库schema】\n【DB_ID】 atis\n【Schema】\n# Table: aircraft\n[\n  (aircraft_code:text, The code assigned to the aircraft by the International Air Transport Association (IATA).. Value examples: ['B747', 'A320'].),\n  (aircraft_description:text, A short description of the aircraft.. Value examples: ['The Boeing 747 is a wide-body airliner.', 'The Airbus A320 is a narrow-body airliner.'].),\n  (manufacturer:text, The name of the manufacturer of the aircraft.. Value examples: ['Boeing', 'Airbus'].),\n  (basic_type:text, The basic type of the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (engines:bigint, The number of engines the aircraft has.. Value examples: ['4', '2'].),\n  (propulsion:text, The type of propulsion used by the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (wide_body:text, Indicates whether the aircraft is a wide body or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'No'].),\n  (wing_span:bigint, The distance between the tips of the aircraft's wings in feet.. Value examples: ['224', '111'].),\n  (length:bigint, The length of the aircraft in feet.. Value examples: ['231', '123'].),\n  (weight:bigint, The weight of the aircraft in pounds.. Value examples: ['987000', '162000'].),\n  (capacity:bigint, The maximum number of passengers the aircraft can carry.. Value examples: ['416', '240'].),\n  (pay_load:bigint, The maximum weight of cargo the aircraft can carry.. Value examples: ['60000', '30000'].),\n  (cruising_speed:bigint, The speed at which the aircraft cruises in miles per hour.. Value examples: ['570', '511'].),\n  (range_miles:bigint, The maximum distance the aircraft can fly in miles.. Value examples: ['8555', '3300'].),\n  (pressurized:text, Indicates whether the aircraft is pressurized or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'Yes'].),\n]\n# Table: airline\n[\n  (airline_code:text, The code assigned to the airline. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (airline_name:text, The name of the airline. Value examples: ['American Airlines', 'United Airlines', 'Delta Air Lines', 'Southwest Airlines'].),\n  (note:text, Any additional notes or comments about the airline. Value examples: ['NULL', 'NULL', 'NULL', 'NULL'].),\n]\n# Table: airport\n[\n  (airport_code:text, The code assigned to the airport.. Value examples: ['JFK', 'LAX', 'ORD', 'DFW'].),\n  (airport_name:text, The name of the airport.. Value examples: ['John F. Kennedy International Airport', 'Los Angeles International Airport', 'O’Hare International Airport', 'Dallas/Fort Worth International Airport'].),\n  (airport_location:text, The location of the airport, eg 'Las Vegas', 'Chicago'. Value examples: ['New York City', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The code assigned to the state where the airport is located.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the airport is located.. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the airport is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n  (minimum_connect_time:bigint, The minimum amount of time required for a connecting flight at the airport.. Value examples: ['23', '20', '24', '40'].),\n]\n# Table: airport_service\n[\n  (city_code:text, The code of the city where the airport is located. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The code of the airport. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (miles_distant:bigint, The distance of the airport from the city in miles. Value examples: ['10', '20', '30', '40'].),\n  (direction:text, The direction of the airport from the city. Either 'North', 'South', 'East', 'West', 'Northeast', 'Northwest', 'Southeast', or 'Southwest'.. Value examples: ['North', 'South', 'East', 'West'].),\n  (minutes_distant:bigint, The distance of the airport from the city in minutes. Value examples: ['20', '40', '60', '80'].),\n]\n# Table: city\n[\n  (city_code:text, The code assigned to the city. Value examples: ['NYC', 'LA', 'CHI', 'DA'].),\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The 2-letter code assigned to the state where the city is located. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the city is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n]\n# Table: class_of_service\n[\n  (booking_class:text, The booking class code for the class of service. Value examples: ['First', 'Business', 'Economy'].),\n  (rank:bigint, The rank of the class of service. Value examples: ['1', '2', '3'].),\n  (class_description:text, A brief description of the class of service. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: code_description\n[\n  (code:text, The code column contains a unique identifier for each record in the table.. Value examples: ['ABC', 'DEF'].),\n  (description:text, The description column contains a textual description of the code.. Value examples: ['Code ABC', 'Code DEF'].),\n]\n# Table: compartment_class\n[\n  (compartment:text, The compartment column contains the name of a compartment. Either 'First', 'Business', or 'Economy'.. Value examples: ['First', 'Business', 'Economy'].),\n  (class_type:text, The class_type column contains the type of a class. Either 'First Class', 'Business Class', or 'Economy Class'.. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: days\n[\n  (days_code:text, A code representing a day of the week. Value examples: ['1', '2'].),\n  (day_name:text, The name of a day of the week. Either 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', or 'Sunday'.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: dual_carrier\n[\n  (main_airline:text, The name of the main airline operating the flight. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (low_flight_number:bigint, The lowest flight number in the range of flights operated by the dual carrier. Value examples: ['1', '11', '21', '31'].),\n  (high_flight_number:bigint, The highest flight number in the range of flights operated by the dual carrier. Value examples: ['10', '20', '30', '40'].),\n  (dual_airline:text, The name of the dual airline operating the flight. Value examples: ['VX', 'DL', 'UA', 'AS'].),\n  (service_name:text, The name of the service provided by the dual carrier on the flight. Value examples: ['Dual Service 1', 'Dual Service 2', 'Dual Service 3', 'Dual Service 4'].),\n]\n# Table: equipment_sequence\n[\n  (aircraft_code_sequence:text, Sequence number for each aircraft code. Value examples: ['1', '2', '3', '4'].),\n  (aircraft_code:text, Code for each aircraft. Value examples: ['B747', 'A320', 'B737', 'A380'].),\n]\n# Table: fare\n[\n  (fare_id:bigint, The unique identifier for this fare. Value examples: ['1', '2'].),\n  (from_airport:text, The 3-letter airport code for the departure location. Value examples: ['ORD', 'ORD'].),\n  (to_airport:text, The 3-letter airport code for the arrival location. Value examples: ['JFK', 'JFK'].),\n  (fare_basis_code:text, The code used to determine the fare's pricing rules. Value examples: ['ABC', 'DEF'].),\n  (fare_airline:text, The airline code associated with this fare. Value examples: ['AA', 'UA'].),\n  (restriction_code:text, Any restrictions or limitations associated with this fare. Value examples: ['NONE', 'NONE'].),\n  (one_direction_cost:bigint, The cost of a one-way trip for this fare. Value examples: ['200', '150'].),\n  (round_trip_cost:bigint, The cost of a round-trip for this fare. Value examples: ['300', '280'].),\n  (round_trip_required:text, Indicates whether a round-trip is required to purchase this fare. Either Yes or No.. Value examples: ['Yes', 'No'].),\n]\n# Table: fare_basis\n[\n  (fare_basis_code:text, The code that identifies the fare basis. Value examples: ['ABC', 'DEF', 'GHI', 'JKL'].),\n  (booking_class:text, The booking class associated with the fare basis. Either 'First', 'Business', or 'Economy'. Value examples: ['First', 'Business', 'Economy', 'First'].),\n  (class_type:text, The class type associated with the fare basis. Either 'First Class', 'Business Class', or 'Economy Class'. Value examples: ['First Class', 'Business Class', 'Economy Class', 'First Class'].),\n  (premium:text, Indicates whether the fare basis is for a premium class. Value examples: ['Yes', 'Yes', 'No', 'Yes'].),\n  (economy:text, Indicates whether the fare basis is for an economy class. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (discounted:text, Indicates whether the fare basis is for a discounted fare. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (night:text, Indicates whether the fare basis is for a night fare. Value examples: ['No', 'No', 'No', 'No'].),\n  (season:text, The season associated with the fare basis. Can only be 'Peak' or 'Regular'. Value examples: ['Regular', 'Regular', 'Regular', 'Regular'].),\n  (basis_days:text, The number of days the fare basis is valid for. Value examples: ['30', '30', '30', '30'].),\n]\n# Table: flight\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['3', '4', '5', '7'].),\n  (flight_days:text, Days of the week the flight operates on. Formatted as comma-delimited 3-letter abbreviations, e.g. `mon,tue,wed` or `tues,thurs`. Value examples: ['wed', 'thu', 'fri', 'sun'].),\n  (from_airport:text, Code assigned to the departure airport. Value examples: ['ORD', 'ORD', 'ORD', 'JFK'].),\n  (to_airport:text, Code assigned to the arrival airport. Value examples: ['JFK', 'JFK', 'LAX', 'ORD'].),\n  (departure_time:bigint, Epoch timestamp for departure time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577858400', '1577865600', '1577880000'].),\n  (arrival_time:bigint, Epoch timestamp for arrival time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577854900', '1577873400', '1577869600', '1577883700'].),\n  (airline_flight:text, Code assigned to the airline flight. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (airline_code:text, Code assigned to the airline. Value examples: ['AA', 'WN', 'AS', 'UA'].),\n  (flight_number:text, Flight number assigned by the airline. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (aircraft_code_sequence:text, Code assigned to the aircraft. Value examples: ['3', '4', '5', '7'].),\n  (meal_code:text, Code assigned to the meal provided during the flight. Value examples: ['DN', 'BS', 'BF', 'DN'].),\n  (stops:bigint, Number of stops during the flight. Value examples: ['0', '1', '0', '0'].),\n  (connections:bigint, Number of connections during the flight. Value examples: ['0', '1', '0', '0'].),\n  (dual_carrier:text, Code assigned to the dual carrier. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (time_elapsed:bigint, Total time elapsed during the flight in seconds. Value examples: ['3700', '15000', '4000', '3700'].),\n]\n# Table: flight_fare\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3', '4'].),\n  (fare_id:bigint, Unique identifier for each fare. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: flight_leg\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3'].),\n  (leg_number:bigint, The sequence number of the leg within the flight. Value examples: ['1', '1', '1'].),\n  (leg_flight:bigint, The flight ID of the leg's corresponding flight. Value examples: ['1', '2', '3'].),\n]\n# Table: flight_stop\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['2', '4'].),\n  (stop_number:bigint, The order of the stop in the flight. Value examples: ['1', '1'].),\n  (stop_days:text, Days of the week on which the flight stops at this airport. Value examples: ['2', '4'].),\n  (stop_airport:text, The 3-letter airport code of the stop. Value examples: ['DFW', 'DEN'].),\n  (arrival_time:bigint, The time at which the flight arrives at this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577847600', '1577862000'].),\n  (arrival_airline:text, The airline code of the arriving flight. Value examples: ['UA', 'WN'].),\n  (arrival_flight_number:text, Flight number of the arriving flight at this stop. Value examples: ['UA456', 'WN012'].),\n  (departure_time:bigint, The time at which the flight departs from this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577865600'].),\n  (departure_airline:text, The airline code of the departing flight. Value examples: ['UA', 'WN'].),\n  (departure_flight_number:text, Flight number of the departing flight from this stop. Value examples: ['UA456', 'WN012'].),\n  (stop_time:bigint, The duration of the stop at this airport. Value examples: ['3600', '3600'].),\n]\n# Table: food_service\n[\n  (meal_code:text, Code assigned to each meal type. Value examples: ['BF', 'LN'].),\n  (meal_number:bigint, Unique identifier for each meal served. Value examples: ['1', '2'].),\n  (compartment:text, The compartment in which the meal is served (e.g. 'First Class', 'Economy'). Value examples: ['First Class', 'First Class'].),\n  (meal_description:text, One of 'Breakfast', 'Lunch', 'Dinner'. Value examples: ['Breakfast', 'Lunch'].),\n]\n# Table: ground_service\n[\n  (city_code:text, The code for the city where the ground service is provided. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The 3-letter code for the airport where the ground service is provided. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (transport_type:text, The type of ground transportation provided. Value examples: ['Taxi', 'Shuttle', 'Bus', 'Car Rental'].),\n  (ground_fare:bigint, The fare charged for ground transportation. Value examples: ['50', '40', '30', '60'].),\n]\n# Table: month\n[\n  (month_number:bigint, A unique number assigned to each month of the year.. Value examples: ['1', '2', '3', '4'].),\n  (month_name:text, The name of the month, e.g. January, February, etc.. Value examples: ['January', 'February', 'March', 'April'].),\n]\n# Table: restriction\n[\n  (restriction_code:text, A code representing the type of restriction, such as blackout dates or minimum stay.. Value examples: ['NONE', 'NONE', 'NONE', 'NONE'].),\n  (advance_purchase:bigint, The number of days in advance the fare must be purchased.. Value examples: ['14', '14', '14', '14'].),\n  (stopovers:text, The number of stopovers allowed for the fare.. Value examples: ['2', '2', '2', '2'].),\n  (saturday_stay_required:text, Indicates whether a Saturday night stay is required for the fare. Either 'Yes' or 'No'.. Value examples: ['No', 'No', 'No', 'No'].),\n  (minimum_stay:bigint, The minimum length of stay required for the fare.. Value examples: ['7', '7', '7', '7'].),\n  (maximum_stay:bigint, The maximum length of stay allowed for the fare.. Value examples: ['30', '30', '30', '30'].),\n  (application:text, The type of fare application. Either 'One Way' or 'Round Trip'.. Value examples: ['One-Way', 'One-Way', 'One-Way', 'One-Way'].),\n  (no_discounts:text, Indicates whether the fare is eligible for discounts or promotions. Either 'Yes' or 'No'.. Value examples: ['Yes', 'Yes', 'Yes', 'Yes'].),\n]\n# Table: state\n[\n  (state_code:text, The 2-letter code assigned to the state. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA'].),\n  (state_name:text, The name of the state. Value examples: ['New York', 'California'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States'].),\n]\n# Table: time_interval\n[\n  (period:text, The period of the time interval, represented as a string. For example, 'daily', 'weekly', 'monthly', etc.. Value examples: ['daily', 'daily', 'daily'].),\n  (begin_time:bigint, The beginning time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577836800', '1577844000', '1577851200'].),\n  (end_time:bigint, The end time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577840400', '1577847600', '1577854800'].),\n]\n# Table: time_zone\n[\n  (time_zone_code:text, A short code that represents the time zone. For example, 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['PST', 'MST'].),\n  (time_zone_name:text, The name of the time zone. Value examples: ['Pacific Standard Time', 'Mountain Standard Time'].),\n  (hours_from_gmt:bigint, The number of hours that the time zone is ahead or behind Greenwich Mean Time (GMT). Value examples: ['-8', '-7'].),\n]\n\n【Foreign keys】\nairline.airline_code = flight.airline_code\nairline.airline_code = flight_stop.departure_airline\nairport.airport_code = fare.from_airport\nairport.airport_code = flight_stop.stop_airport\nairport_service.city_code = ground_service.city_code\nairport.state_code = city.state_code\nairport.state_code = state.state_code\ncity.state_code = state.state_code\nairport_service.city_code = city.city_code\nground_service.city_code = city.city_code\nairport.time_zone_code = time_zone.time_zone_code\ncity.time_zone_code = time_zone.time_zone_code\nflight.flight_id = flight_fare.flight_id\nflight.flight_id = flight_leg.flight_id\nflight.flight_id = flight_stop.flight_id\nflight_fare.flight_id = flight_leg.flight_id\nflight_fare.flight_id = flight_stop.flight_id\nflight_leg.flight_id = flight_stop.flight_id\naircraft.aircraft_code = equipment_sequence.aircraft_code\nflight.aircraft_code_sequence = equipment_sequence.aircraft_code_sequence\nflight.meal_code = food_service.meal_code\n\n【参考信息】\n\n\n【用户问题】\nWhich airlines do not have any flights that either depart from/arrive at JFK, or have one or more stops?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT DISTINCT airline.airline_name, airline.airline_code FROM airline WHERE airline.airline_code NOT IN (SELECT flight.airline_code FROM flight WHERE flight.from_airport = 'JFK' OR flight.to_airport = 'JFK' OR flight.stops > 0)",
        "role": "assistant"
      }
    ],
    "db_name": "atis",
    "id": 84,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich state code is Orlando International Airport in?\n\n【数据库schema】\n【DB_ID】 atis\n【Schema】\n# Table: aircraft\n[\n  (aircraft_code:text, The code assigned to the aircraft by the International Air Transport Association (IATA).. Value examples: ['B747', 'A320'].),\n  (aircraft_description:text, A short description of the aircraft.. Value examples: ['The Boeing 747 is a wide-body airliner.', 'The Airbus A320 is a narrow-body airliner.'].),\n  (manufacturer:text, The name of the manufacturer of the aircraft.. Value examples: ['Boeing', 'Airbus'].),\n  (basic_type:text, The basic type of the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (engines:bigint, The number of engines the aircraft has.. Value examples: ['4', '2'].),\n  (propulsion:text, The type of propulsion used by the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (wide_body:text, Indicates whether the aircraft is a wide body or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'No'].),\n  (wing_span:bigint, The distance between the tips of the aircraft's wings in feet.. Value examples: ['224', '111'].),\n  (length:bigint, The length of the aircraft in feet.. Value examples: ['231', '123'].),\n  (weight:bigint, The weight of the aircraft in pounds.. Value examples: ['987000', '162000'].),\n  (capacity:bigint, The maximum number of passengers the aircraft can carry.. Value examples: ['416', '240'].),\n  (pay_load:bigint, The maximum weight of cargo the aircraft can carry.. Value examples: ['60000', '30000'].),\n  (cruising_speed:bigint, The speed at which the aircraft cruises in miles per hour.. Value examples: ['570', '511'].),\n  (range_miles:bigint, The maximum distance the aircraft can fly in miles.. Value examples: ['8555', '3300'].),\n  (pressurized:text, Indicates whether the aircraft is pressurized or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'Yes'].),\n]\n# Table: airline\n[\n  (airline_code:text, The code assigned to the airline. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (airline_name:text, The name of the airline. Value examples: ['American Airlines', 'United Airlines', 'Delta Air Lines', 'Southwest Airlines'].),\n  (note:text, Any additional notes or comments about the airline. Value examples: ['NULL', 'NULL', 'NULL', 'NULL'].),\n]\n# Table: airport\n[\n  (airport_code:text, The code assigned to the airport.. Value examples: ['JFK', 'LAX', 'ORD', 'DFW'].),\n  (airport_name:text, The name of the airport.. Value examples: ['John F. Kennedy International Airport', 'Los Angeles International Airport', 'O’Hare International Airport', 'Dallas/Fort Worth International Airport'].),\n  (airport_location:text, The location of the airport, eg 'Las Vegas', 'Chicago'. Value examples: ['New York City', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The code assigned to the state where the airport is located.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the airport is located.. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the airport is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n  (minimum_connect_time:bigint, The minimum amount of time required for a connecting flight at the airport.. Value examples: ['23', '20', '24', '40'].),\n]\n# Table: airport_service\n[\n  (city_code:text, The code of the city where the airport is located. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The code of the airport. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (miles_distant:bigint, The distance of the airport from the city in miles. Value examples: ['10', '20', '30', '40'].),\n  (direction:text, The direction of the airport from the city. Either 'North', 'South', 'East', 'West', 'Northeast', 'Northwest', 'Southeast', or 'Southwest'.. Value examples: ['North', 'South', 'East', 'West'].),\n  (minutes_distant:bigint, The distance of the airport from the city in minutes. Value examples: ['20', '40', '60', '80'].),\n]\n# Table: city\n[\n  (city_code:text, The code assigned to the city. Value examples: ['NYC', 'LA', 'CHI', 'DA'].),\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The 2-letter code assigned to the state where the city is located. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the city is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n]\n# Table: class_of_service\n[\n  (booking_class:text, The booking class code for the class of service. Value examples: ['First', 'Business', 'Economy'].),\n  (rank:bigint, The rank of the class of service. Value examples: ['1', '2', '3'].),\n  (class_description:text, A brief description of the class of service. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: code_description\n[\n  (code:text, The code column contains a unique identifier for each record in the table.. Value examples: ['ABC', 'DEF'].),\n  (description:text, The description column contains a textual description of the code.. Value examples: ['Code ABC', 'Code DEF'].),\n]\n# Table: compartment_class\n[\n  (compartment:text, The compartment column contains the name of a compartment. Either 'First', 'Business', or 'Economy'.. Value examples: ['First', 'Business', 'Economy'].),\n  (class_type:text, The class_type column contains the type of a class. Either 'First Class', 'Business Class', or 'Economy Class'.. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: days\n[\n  (days_code:text, A code representing a day of the week. Value examples: ['1', '2'].),\n  (day_name:text, The name of a day of the week. Either 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', or 'Sunday'.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: dual_carrier\n[\n  (main_airline:text, The name of the main airline operating the flight. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (low_flight_number:bigint, The lowest flight number in the range of flights operated by the dual carrier. Value examples: ['1', '11', '21', '31'].),\n  (high_flight_number:bigint, The highest flight number in the range of flights operated by the dual carrier. Value examples: ['10', '20', '30', '40'].),\n  (dual_airline:text, The name of the dual airline operating the flight. Value examples: ['VX', 'DL', 'UA', 'AS'].),\n  (service_name:text, The name of the service provided by the dual carrier on the flight. Value examples: ['Dual Service 1', 'Dual Service 2', 'Dual Service 3', 'Dual Service 4'].),\n]\n# Table: equipment_sequence\n[\n  (aircraft_code_sequence:text, Sequence number for each aircraft code. Value examples: ['1', '2', '3', '4'].),\n  (aircraft_code:text, Code for each aircraft. Value examples: ['B747', 'A320', 'B737', 'A380'].),\n]\n# Table: fare\n[\n  (fare_id:bigint, The unique identifier for this fare. Value examples: ['1', '2'].),\n  (from_airport:text, The 3-letter airport code for the departure location. Value examples: ['ORD', 'ORD'].),\n  (to_airport:text, The 3-letter airport code for the arrival location. Value examples: ['JFK', 'JFK'].),\n  (fare_basis_code:text, The code used to determine the fare's pricing rules. Value examples: ['ABC', 'DEF'].),\n  (fare_airline:text, The airline code associated with this fare. Value examples: ['AA', 'UA'].),\n  (restriction_code:text, Any restrictions or limitations associated with this fare. Value examples: ['NONE', 'NONE'].),\n  (one_direction_cost:bigint, The cost of a one-way trip for this fare. Value examples: ['200', '150'].),\n  (round_trip_cost:bigint, The cost of a round-trip for this fare. Value examples: ['300', '280'].),\n  (round_trip_required:text, Indicates whether a round-trip is required to purchase this fare. Either Yes or No.. Value examples: ['Yes', 'No'].),\n]\n# Table: fare_basis\n[\n  (fare_basis_code:text, The code that identifies the fare basis. Value examples: ['ABC', 'DEF', 'GHI', 'JKL'].),\n  (booking_class:text, The booking class associated with the fare basis. Either 'First', 'Business', or 'Economy'. Value examples: ['First', 'Business', 'Economy', 'First'].),\n  (class_type:text, The class type associated with the fare basis. Either 'First Class', 'Business Class', or 'Economy Class'. Value examples: ['First Class', 'Business Class', 'Economy Class', 'First Class'].),\n  (premium:text, Indicates whether the fare basis is for a premium class. Value examples: ['Yes', 'Yes', 'No', 'Yes'].),\n  (economy:text, Indicates whether the fare basis is for an economy class. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (discounted:text, Indicates whether the fare basis is for a discounted fare. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (night:text, Indicates whether the fare basis is for a night fare. Value examples: ['No', 'No', 'No', 'No'].),\n  (season:text, The season associated with the fare basis. Can only be 'Peak' or 'Regular'. Value examples: ['Regular', 'Regular', 'Regular', 'Regular'].),\n  (basis_days:text, The number of days the fare basis is valid for. Value examples: ['30', '30', '30', '30'].),\n]\n# Table: flight\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['3', '4', '5', '7'].),\n  (flight_days:text, Days of the week the flight operates on. Formatted as comma-delimited 3-letter abbreviations, e.g. `mon,tue,wed` or `tues,thurs`. Value examples: ['wed', 'thu', 'fri', 'sun'].),\n  (from_airport:text, Code assigned to the departure airport. Value examples: ['ORD', 'ORD', 'ORD', 'JFK'].),\n  (to_airport:text, Code assigned to the arrival airport. Value examples: ['JFK', 'JFK', 'LAX', 'ORD'].),\n  (departure_time:bigint, Epoch timestamp for departure time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577858400', '1577865600', '1577880000'].),\n  (arrival_time:bigint, Epoch timestamp for arrival time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577854900', '1577873400', '1577869600', '1577883700'].),\n  (airline_flight:text, Code assigned to the airline flight. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (airline_code:text, Code assigned to the airline. Value examples: ['AA', 'WN', 'AS', 'UA'].),\n  (flight_number:text, Flight number assigned by the airline. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (aircraft_code_sequence:text, Code assigned to the aircraft. Value examples: ['3', '4', '5', '7'].),\n  (meal_code:text, Code assigned to the meal provided during the flight. Value examples: ['DN', 'BS', 'BF', 'DN'].),\n  (stops:bigint, Number of stops during the flight. Value examples: ['0', '1', '0', '0'].),\n  (connections:bigint, Number of connections during the flight. Value examples: ['0', '1', '0', '0'].),\n  (dual_carrier:text, Code assigned to the dual carrier. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (time_elapsed:bigint, Total time elapsed during the flight in seconds. Value examples: ['3700', '15000', '4000', '3700'].),\n]\n# Table: flight_fare\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3', '4'].),\n  (fare_id:bigint, Unique identifier for each fare. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: flight_leg\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3'].),\n  (leg_number:bigint, The sequence number of the leg within the flight. Value examples: ['1', '1', '1'].),\n  (leg_flight:bigint, The flight ID of the leg's corresponding flight. Value examples: ['1', '2', '3'].),\n]\n# Table: flight_stop\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['2', '4'].),\n  (stop_number:bigint, The order of the stop in the flight. Value examples: ['1', '1'].),\n  (stop_days:text, Days of the week on which the flight stops at this airport. Value examples: ['2', '4'].),\n  (stop_airport:text, The 3-letter airport code of the stop. Value examples: ['DFW', 'DEN'].),\n  (arrival_time:bigint, The time at which the flight arrives at this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577847600', '1577862000'].),\n  (arrival_airline:text, The airline code of the arriving flight. Value examples: ['UA', 'WN'].),\n  (arrival_flight_number:text, Flight number of the arriving flight at this stop. Value examples: ['UA456', 'WN012'].),\n  (departure_time:bigint, The time at which the flight departs from this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577865600'].),\n  (departure_airline:text, The airline code of the departing flight. Value examples: ['UA', 'WN'].),\n  (departure_flight_number:text, Flight number of the departing flight from this stop. Value examples: ['UA456', 'WN012'].),\n  (stop_time:bigint, The duration of the stop at this airport. Value examples: ['3600', '3600'].),\n]\n# Table: food_service\n[\n  (meal_code:text, Code assigned to each meal type. Value examples: ['BF', 'LN'].),\n  (meal_number:bigint, Unique identifier for each meal served. Value examples: ['1', '2'].),\n  (compartment:text, The compartment in which the meal is served (e.g. 'First Class', 'Economy'). Value examples: ['First Class', 'First Class'].),\n  (meal_description:text, One of 'Breakfast', 'Lunch', 'Dinner'. Value examples: ['Breakfast', 'Lunch'].),\n]\n# Table: ground_service\n[\n  (city_code:text, The code for the city where the ground service is provided. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The 3-letter code for the airport where the ground service is provided. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (transport_type:text, The type of ground transportation provided. Value examples: ['Taxi', 'Shuttle', 'Bus', 'Car Rental'].),\n  (ground_fare:bigint, The fare charged for ground transportation. Value examples: ['50', '40', '30', '60'].),\n]\n# Table: month\n[\n  (month_number:bigint, A unique number assigned to each month of the year.. Value examples: ['1', '2', '3', '4'].),\n  (month_name:text, The name of the month, e.g. January, February, etc.. Value examples: ['January', 'February', 'March', 'April'].),\n]\n# Table: restriction\n[\n  (restriction_code:text, A code representing the type of restriction, such as blackout dates or minimum stay.. Value examples: ['NONE', 'NONE', 'NONE', 'NONE'].),\n  (advance_purchase:bigint, The number of days in advance the fare must be purchased.. Value examples: ['14', '14', '14', '14'].),\n  (stopovers:text, The number of stopovers allowed for the fare.. Value examples: ['2', '2', '2', '2'].),\n  (saturday_stay_required:text, Indicates whether a Saturday night stay is required for the fare. Either 'Yes' or 'No'.. Value examples: ['No', 'No', 'No', 'No'].),\n  (minimum_stay:bigint, The minimum length of stay required for the fare.. Value examples: ['7', '7', '7', '7'].),\n  (maximum_stay:bigint, The maximum length of stay allowed for the fare.. Value examples: ['30', '30', '30', '30'].),\n  (application:text, The type of fare application. Either 'One Way' or 'Round Trip'.. Value examples: ['One-Way', 'One-Way', 'One-Way', 'One-Way'].),\n  (no_discounts:text, Indicates whether the fare is eligible for discounts or promotions. Either 'Yes' or 'No'.. Value examples: ['Yes', 'Yes', 'Yes', 'Yes'].),\n]\n# Table: state\n[\n  (state_code:text, The 2-letter code assigned to the state. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA'].),\n  (state_name:text, The name of the state. Value examples: ['New York', 'California'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States'].),\n]\n# Table: time_interval\n[\n  (period:text, The period of the time interval, represented as a string. For example, 'daily', 'weekly', 'monthly', etc.. Value examples: ['daily', 'daily', 'daily'].),\n  (begin_time:bigint, The beginning time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577836800', '1577844000', '1577851200'].),\n  (end_time:bigint, The end time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577840400', '1577847600', '1577854800'].),\n]\n# Table: time_zone\n[\n  (time_zone_code:text, A short code that represents the time zone. For example, 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['PST', 'MST'].),\n  (time_zone_name:text, The name of the time zone. Value examples: ['Pacific Standard Time', 'Mountain Standard Time'].),\n  (hours_from_gmt:bigint, The number of hours that the time zone is ahead or behind Greenwich Mean Time (GMT). Value examples: ['-8', '-7'].),\n]\n\n【Foreign keys】\nairline.airline_code = flight.airline_code\nairline.airline_code = flight_stop.departure_airline\nairport.airport_code = fare.from_airport\nairport.airport_code = flight_stop.stop_airport\nairport_service.city_code = ground_service.city_code\nairport.state_code = city.state_code\nairport.state_code = state.state_code\ncity.state_code = state.state_code\nairport_service.city_code = city.city_code\nground_service.city_code = city.city_code\nairport.time_zone_code = time_zone.time_zone_code\ncity.time_zone_code = time_zone.time_zone_code\nflight.flight_id = flight_fare.flight_id\nflight.flight_id = flight_leg.flight_id\nflight.flight_id = flight_stop.flight_id\nflight_fare.flight_id = flight_leg.flight_id\nflight_fare.flight_id = flight_stop.flight_id\nflight_leg.flight_id = flight_stop.flight_id\naircraft.aircraft_code = equipment_sequence.aircraft_code\nflight.aircraft_code_sequence = equipment_sequence.aircraft_code_sequence\nflight.meal_code = food_service.meal_code\n\n【参考信息】\nFilter airport, city, country names using ILIKE.\nFilter state code (eg NY), airport codes (eg JFK) using case-insensitive matches.\nIf multiple flight days are requested, use ILIKE and wildcards for each of the days separately, since they are not necessarily ordered.\n\n【用户问题】\nWhich state code is Orlando International Airport in?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT state_code FROM airport WHERE airport_name ILIKE '%Orlando International Airport%';",
        "role": "assistant"
      }
    ],
    "db_name": "atis",
    "id": 85,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich flights operate on Mondays and Wednesdays? Give me the relevant flight numbers\n\n【数据库schema】\n【DB_ID】 atis\n【Schema】\n# Table: aircraft\n[\n  (aircraft_code:text, The code assigned to the aircraft by the International Air Transport Association (IATA).. Value examples: ['B747', 'A320'].),\n  (aircraft_description:text, A short description of the aircraft.. Value examples: ['The Boeing 747 is a wide-body airliner.', 'The Airbus A320 is a narrow-body airliner.'].),\n  (manufacturer:text, The name of the manufacturer of the aircraft.. Value examples: ['Boeing', 'Airbus'].),\n  (basic_type:text, The basic type of the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (engines:bigint, The number of engines the aircraft has.. Value examples: ['4', '2'].),\n  (propulsion:text, The type of propulsion used by the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (wide_body:text, Indicates whether the aircraft is a wide body or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'No'].),\n  (wing_span:bigint, The distance between the tips of the aircraft's wings in feet.. Value examples: ['224', '111'].),\n  (length:bigint, The length of the aircraft in feet.. Value examples: ['231', '123'].),\n  (weight:bigint, The weight of the aircraft in pounds.. Value examples: ['987000', '162000'].),\n  (capacity:bigint, The maximum number of passengers the aircraft can carry.. Value examples: ['416', '240'].),\n  (pay_load:bigint, The maximum weight of cargo the aircraft can carry.. Value examples: ['60000', '30000'].),\n  (cruising_speed:bigint, The speed at which the aircraft cruises in miles per hour.. Value examples: ['570', '511'].),\n  (range_miles:bigint, The maximum distance the aircraft can fly in miles.. Value examples: ['8555', '3300'].),\n  (pressurized:text, Indicates whether the aircraft is pressurized or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'Yes'].),\n]\n# Table: airline\n[\n  (airline_code:text, The code assigned to the airline. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (airline_name:text, The name of the airline. Value examples: ['American Airlines', 'United Airlines', 'Delta Air Lines', 'Southwest Airlines'].),\n  (note:text, Any additional notes or comments about the airline. Value examples: ['NULL', 'NULL', 'NULL', 'NULL'].),\n]\n# Table: airport\n[\n  (airport_code:text, The code assigned to the airport.. Value examples: ['JFK', 'LAX', 'ORD', 'DFW'].),\n  (airport_name:text, The name of the airport.. Value examples: ['John F. Kennedy International Airport', 'Los Angeles International Airport', 'O’Hare International Airport', 'Dallas/Fort Worth International Airport'].),\n  (airport_location:text, The location of the airport, eg 'Las Vegas', 'Chicago'. Value examples: ['New York City', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The code assigned to the state where the airport is located.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the airport is located.. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the airport is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n  (minimum_connect_time:bigint, The minimum amount of time required for a connecting flight at the airport.. Value examples: ['23', '20', '24', '40'].),\n]\n# Table: airport_service\n[\n  (city_code:text, The code of the city where the airport is located. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The code of the airport. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (miles_distant:bigint, The distance of the airport from the city in miles. Value examples: ['10', '20', '30', '40'].),\n  (direction:text, The direction of the airport from the city. Either 'North', 'South', 'East', 'West', 'Northeast', 'Northwest', 'Southeast', or 'Southwest'.. Value examples: ['North', 'South', 'East', 'West'].),\n  (minutes_distant:bigint, The distance of the airport from the city in minutes. Value examples: ['20', '40', '60', '80'].),\n]\n# Table: city\n[\n  (city_code:text, The code assigned to the city. Value examples: ['NYC', 'LA', 'CHI', 'DA'].),\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The 2-letter code assigned to the state where the city is located. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the city is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n]\n# Table: class_of_service\n[\n  (booking_class:text, The booking class code for the class of service. Value examples: ['First', 'Business', 'Economy'].),\n  (rank:bigint, The rank of the class of service. Value examples: ['1', '2', '3'].),\n  (class_description:text, A brief description of the class of service. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: code_description\n[\n  (code:text, The code column contains a unique identifier for each record in the table.. Value examples: ['ABC', 'DEF'].),\n  (description:text, The description column contains a textual description of the code.. Value examples: ['Code ABC', 'Code DEF'].),\n]\n# Table: compartment_class\n[\n  (compartment:text, The compartment column contains the name of a compartment. Either 'First', 'Business', or 'Economy'.. Value examples: ['First', 'Business', 'Economy'].),\n  (class_type:text, The class_type column contains the type of a class. Either 'First Class', 'Business Class', or 'Economy Class'.. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: days\n[\n  (days_code:text, A code representing a day of the week. Value examples: ['1', '2'].),\n  (day_name:text, The name of a day of the week. Either 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', or 'Sunday'.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: dual_carrier\n[\n  (main_airline:text, The name of the main airline operating the flight. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (low_flight_number:bigint, The lowest flight number in the range of flights operated by the dual carrier. Value examples: ['1', '11', '21', '31'].),\n  (high_flight_number:bigint, The highest flight number in the range of flights operated by the dual carrier. Value examples: ['10', '20', '30', '40'].),\n  (dual_airline:text, The name of the dual airline operating the flight. Value examples: ['VX', 'DL', 'UA', 'AS'].),\n  (service_name:text, The name of the service provided by the dual carrier on the flight. Value examples: ['Dual Service 1', 'Dual Service 2', 'Dual Service 3', 'Dual Service 4'].),\n]\n# Table: equipment_sequence\n[\n  (aircraft_code_sequence:text, Sequence number for each aircraft code. Value examples: ['1', '2', '3', '4'].),\n  (aircraft_code:text, Code for each aircraft. Value examples: ['B747', 'A320', 'B737', 'A380'].),\n]\n# Table: fare\n[\n  (fare_id:bigint, The unique identifier for this fare. Value examples: ['1', '2'].),\n  (from_airport:text, The 3-letter airport code for the departure location. Value examples: ['ORD', 'ORD'].),\n  (to_airport:text, The 3-letter airport code for the arrival location. Value examples: ['JFK', 'JFK'].),\n  (fare_basis_code:text, The code used to determine the fare's pricing rules. Value examples: ['ABC', 'DEF'].),\n  (fare_airline:text, The airline code associated with this fare. Value examples: ['AA', 'UA'].),\n  (restriction_code:text, Any restrictions or limitations associated with this fare. Value examples: ['NONE', 'NONE'].),\n  (one_direction_cost:bigint, The cost of a one-way trip for this fare. Value examples: ['200', '150'].),\n  (round_trip_cost:bigint, The cost of a round-trip for this fare. Value examples: ['300', '280'].),\n  (round_trip_required:text, Indicates whether a round-trip is required to purchase this fare. Either Yes or No.. Value examples: ['Yes', 'No'].),\n]\n# Table: fare_basis\n[\n  (fare_basis_code:text, The code that identifies the fare basis. Value examples: ['ABC', 'DEF', 'GHI', 'JKL'].),\n  (booking_class:text, The booking class associated with the fare basis. Either 'First', 'Business', or 'Economy'. Value examples: ['First', 'Business', 'Economy', 'First'].),\n  (class_type:text, The class type associated with the fare basis. Either 'First Class', 'Business Class', or 'Economy Class'. Value examples: ['First Class', 'Business Class', 'Economy Class', 'First Class'].),\n  (premium:text, Indicates whether the fare basis is for a premium class. Value examples: ['Yes', 'Yes', 'No', 'Yes'].),\n  (economy:text, Indicates whether the fare basis is for an economy class. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (discounted:text, Indicates whether the fare basis is for a discounted fare. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (night:text, Indicates whether the fare basis is for a night fare. Value examples: ['No', 'No', 'No', 'No'].),\n  (season:text, The season associated with the fare basis. Can only be 'Peak' or 'Regular'. Value examples: ['Regular', 'Regular', 'Regular', 'Regular'].),\n  (basis_days:text, The number of days the fare basis is valid for. Value examples: ['30', '30', '30', '30'].),\n]\n# Table: flight\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['3', '4', '5', '7'].),\n  (flight_days:text, Days of the week the flight operates on. Formatted as comma-delimited 3-letter abbreviations, e.g. `mon,tue,wed` or `tues,thurs`. Value examples: ['wed', 'thu', 'fri', 'sun'].),\n  (from_airport:text, Code assigned to the departure airport. Value examples: ['ORD', 'ORD', 'ORD', 'JFK'].),\n  (to_airport:text, Code assigned to the arrival airport. Value examples: ['JFK', 'JFK', 'LAX', 'ORD'].),\n  (departure_time:bigint, Epoch timestamp for departure time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577858400', '1577865600', '1577880000'].),\n  (arrival_time:bigint, Epoch timestamp for arrival time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577854900', '1577873400', '1577869600', '1577883700'].),\n  (airline_flight:text, Code assigned to the airline flight. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (airline_code:text, Code assigned to the airline. Value examples: ['AA', 'WN', 'AS', 'UA'].),\n  (flight_number:text, Flight number assigned by the airline. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (aircraft_code_sequence:text, Code assigned to the aircraft. Value examples: ['3', '4', '5', '7'].),\n  (meal_code:text, Code assigned to the meal provided during the flight. Value examples: ['DN', 'BS', 'BF', 'DN'].),\n  (stops:bigint, Number of stops during the flight. Value examples: ['0', '1', '0', '0'].),\n  (connections:bigint, Number of connections during the flight. Value examples: ['0', '1', '0', '0'].),\n  (dual_carrier:text, Code assigned to the dual carrier. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (time_elapsed:bigint, Total time elapsed during the flight in seconds. Value examples: ['3700', '15000', '4000', '3700'].),\n]\n# Table: flight_fare\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3', '4'].),\n  (fare_id:bigint, Unique identifier for each fare. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: flight_leg\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3'].),\n  (leg_number:bigint, The sequence number of the leg within the flight. Value examples: ['1', '1', '1'].),\n  (leg_flight:bigint, The flight ID of the leg's corresponding flight. Value examples: ['1', '2', '3'].),\n]\n# Table: flight_stop\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['2', '4'].),\n  (stop_number:bigint, The order of the stop in the flight. Value examples: ['1', '1'].),\n  (stop_days:text, Days of the week on which the flight stops at this airport. Value examples: ['2', '4'].),\n  (stop_airport:text, The 3-letter airport code of the stop. Value examples: ['DFW', 'DEN'].),\n  (arrival_time:bigint, The time at which the flight arrives at this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577847600', '1577862000'].),\n  (arrival_airline:text, The airline code of the arriving flight. Value examples: ['UA', 'WN'].),\n  (arrival_flight_number:text, Flight number of the arriving flight at this stop. Value examples: ['UA456', 'WN012'].),\n  (departure_time:bigint, The time at which the flight departs from this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577865600'].),\n  (departure_airline:text, The airline code of the departing flight. Value examples: ['UA', 'WN'].),\n  (departure_flight_number:text, Flight number of the departing flight from this stop. Value examples: ['UA456', 'WN012'].),\n  (stop_time:bigint, The duration of the stop at this airport. Value examples: ['3600', '3600'].),\n]\n# Table: food_service\n[\n  (meal_code:text, Code assigned to each meal type. Value examples: ['BF', 'LN'].),\n  (meal_number:bigint, Unique identifier for each meal served. Value examples: ['1', '2'].),\n  (compartment:text, The compartment in which the meal is served (e.g. 'First Class', 'Economy'). Value examples: ['First Class', 'First Class'].),\n  (meal_description:text, One of 'Breakfast', 'Lunch', 'Dinner'. Value examples: ['Breakfast', 'Lunch'].),\n]\n# Table: ground_service\n[\n  (city_code:text, The code for the city where the ground service is provided. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The 3-letter code for the airport where the ground service is provided. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (transport_type:text, The type of ground transportation provided. Value examples: ['Taxi', 'Shuttle', 'Bus', 'Car Rental'].),\n  (ground_fare:bigint, The fare charged for ground transportation. Value examples: ['50', '40', '30', '60'].),\n]\n# Table: month\n[\n  (month_number:bigint, A unique number assigned to each month of the year.. Value examples: ['1', '2', '3', '4'].),\n  (month_name:text, The name of the month, e.g. January, February, etc.. Value examples: ['January', 'February', 'March', 'April'].),\n]\n# Table: restriction\n[\n  (restriction_code:text, A code representing the type of restriction, such as blackout dates or minimum stay.. Value examples: ['NONE', 'NONE', 'NONE', 'NONE'].),\n  (advance_purchase:bigint, The number of days in advance the fare must be purchased.. Value examples: ['14', '14', '14', '14'].),\n  (stopovers:text, The number of stopovers allowed for the fare.. Value examples: ['2', '2', '2', '2'].),\n  (saturday_stay_required:text, Indicates whether a Saturday night stay is required for the fare. Either 'Yes' or 'No'.. Value examples: ['No', 'No', 'No', 'No'].),\n  (minimum_stay:bigint, The minimum length of stay required for the fare.. Value examples: ['7', '7', '7', '7'].),\n  (maximum_stay:bigint, The maximum length of stay allowed for the fare.. Value examples: ['30', '30', '30', '30'].),\n  (application:text, The type of fare application. Either 'One Way' or 'Round Trip'.. Value examples: ['One-Way', 'One-Way', 'One-Way', 'One-Way'].),\n  (no_discounts:text, Indicates whether the fare is eligible for discounts or promotions. Either 'Yes' or 'No'.. Value examples: ['Yes', 'Yes', 'Yes', 'Yes'].),\n]\n# Table: state\n[\n  (state_code:text, The 2-letter code assigned to the state. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA'].),\n  (state_name:text, The name of the state. Value examples: ['New York', 'California'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States'].),\n]\n# Table: time_interval\n[\n  (period:text, The period of the time interval, represented as a string. For example, 'daily', 'weekly', 'monthly', etc.. Value examples: ['daily', 'daily', 'daily'].),\n  (begin_time:bigint, The beginning time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577836800', '1577844000', '1577851200'].),\n  (end_time:bigint, The end time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577840400', '1577847600', '1577854800'].),\n]\n# Table: time_zone\n[\n  (time_zone_code:text, A short code that represents the time zone. For example, 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['PST', 'MST'].),\n  (time_zone_name:text, The name of the time zone. Value examples: ['Pacific Standard Time', 'Mountain Standard Time'].),\n  (hours_from_gmt:bigint, The number of hours that the time zone is ahead or behind Greenwich Mean Time (GMT). Value examples: ['-8', '-7'].),\n]\n\n【Foreign keys】\nairline.airline_code = flight.airline_code\nairline.airline_code = flight_stop.departure_airline\nairport.airport_code = fare.from_airport\nairport.airport_code = flight_stop.stop_airport\nairport_service.city_code = ground_service.city_code\nairport.state_code = city.state_code\nairport.state_code = state.state_code\ncity.state_code = state.state_code\nairport_service.city_code = city.city_code\nground_service.city_code = city.city_code\nairport.time_zone_code = time_zone.time_zone_code\ncity.time_zone_code = time_zone.time_zone_code\nflight.flight_id = flight_fare.flight_id\nflight.flight_id = flight_leg.flight_id\nflight.flight_id = flight_stop.flight_id\nflight_fare.flight_id = flight_leg.flight_id\nflight_fare.flight_id = flight_stop.flight_id\nflight_leg.flight_id = flight_stop.flight_id\naircraft.aircraft_code = equipment_sequence.aircraft_code\nflight.aircraft_code_sequence = equipment_sequence.aircraft_code_sequence\nflight.meal_code = food_service.meal_code\n\n【参考信息】\nFilter airport, city, country names using ILIKE.\nFilter state code (eg NY), airport codes (eg JFK) using case-insensitive matches.\nIf multiple flight days are requested, use ILIKE for each of the days separately, since they are not necessarily ordered.\n\n【用户问题】\nWhich flights operate on Mondays and Wednesdays? Give me the relevant flight numbers\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT flight.flight_number, flight.flight_id FROM flight WHERE LOWER(flight.flight_days) LIKE '%mon%' AND LOWER(flight.flight_days) LIKE '%wed%'",
        "role": "assistant"
      }
    ],
    "db_name": "atis",
    "id": 86,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the total cost of all round-trip fares from New York (JFK) to Los Angeles?\n\n【数据库schema】\n【DB_ID】 atis\n【Schema】\n# Table: aircraft\n[\n  (aircraft_code:text, The code assigned to the aircraft by the International Air Transport Association (IATA).. Value examples: ['B747', 'A320'].),\n  (aircraft_description:text, A short description of the aircraft.. Value examples: ['The Boeing 747 is a wide-body airliner.', 'The Airbus A320 is a narrow-body airliner.'].),\n  (manufacturer:text, The name of the manufacturer of the aircraft.. Value examples: ['Boeing', 'Airbus'].),\n  (basic_type:text, The basic type of the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (engines:bigint, The number of engines the aircraft has.. Value examples: ['4', '2'].),\n  (propulsion:text, The type of propulsion used by the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (wide_body:text, Indicates whether the aircraft is a wide body or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'No'].),\n  (wing_span:bigint, The distance between the tips of the aircraft's wings in feet.. Value examples: ['224', '111'].),\n  (length:bigint, The length of the aircraft in feet.. Value examples: ['231', '123'].),\n  (weight:bigint, The weight of the aircraft in pounds.. Value examples: ['987000', '162000'].),\n  (capacity:bigint, The maximum number of passengers the aircraft can carry.. Value examples: ['416', '240'].),\n  (pay_load:bigint, The maximum weight of cargo the aircraft can carry.. Value examples: ['60000', '30000'].),\n  (cruising_speed:bigint, The speed at which the aircraft cruises in miles per hour.. Value examples: ['570', '511'].),\n  (range_miles:bigint, The maximum distance the aircraft can fly in miles.. Value examples: ['8555', '3300'].),\n  (pressurized:text, Indicates whether the aircraft is pressurized or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'Yes'].),\n]\n# Table: airline\n[\n  (airline_code:text, The code assigned to the airline. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (airline_name:text, The name of the airline. Value examples: ['American Airlines', 'United Airlines', 'Delta Air Lines', 'Southwest Airlines'].),\n  (note:text, Any additional notes or comments about the airline. Value examples: ['NULL', 'NULL', 'NULL', 'NULL'].),\n]\n# Table: airport\n[\n  (airport_code:text, The code assigned to the airport.. Value examples: ['JFK', 'LAX', 'ORD', 'DFW'].),\n  (airport_name:text, The name of the airport.. Value examples: ['John F. Kennedy International Airport', 'Los Angeles International Airport', 'O’Hare International Airport', 'Dallas/Fort Worth International Airport'].),\n  (airport_location:text, The location of the airport, eg 'Las Vegas', 'Chicago'. Value examples: ['New York City', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The code assigned to the state where the airport is located.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the airport is located.. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the airport is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n  (minimum_connect_time:bigint, The minimum amount of time required for a connecting flight at the airport.. Value examples: ['23', '20', '24', '40'].),\n]\n# Table: airport_service\n[\n  (city_code:text, The code of the city where the airport is located. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The code of the airport. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (miles_distant:bigint, The distance of the airport from the city in miles. Value examples: ['10', '20', '30', '40'].),\n  (direction:text, The direction of the airport from the city. Either 'North', 'South', 'East', 'West', 'Northeast', 'Northwest', 'Southeast', or 'Southwest'.. Value examples: ['North', 'South', 'East', 'West'].),\n  (minutes_distant:bigint, The distance of the airport from the city in minutes. Value examples: ['20', '40', '60', '80'].),\n]\n# Table: city\n[\n  (city_code:text, The code assigned to the city. Value examples: ['NYC', 'LA', 'CHI', 'DA'].),\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The 2-letter code assigned to the state where the city is located. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the city is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n]\n# Table: class_of_service\n[\n  (booking_class:text, The booking class code for the class of service. Value examples: ['First', 'Business', 'Economy'].),\n  (rank:bigint, The rank of the class of service. Value examples: ['1', '2', '3'].),\n  (class_description:text, A brief description of the class of service. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: code_description\n[\n  (code:text, The code column contains a unique identifier for each record in the table.. Value examples: ['ABC', 'DEF'].),\n  (description:text, The description column contains a textual description of the code.. Value examples: ['Code ABC', 'Code DEF'].),\n]\n# Table: compartment_class\n[\n  (compartment:text, The compartment column contains the name of a compartment. Either 'First', 'Business', or 'Economy'.. Value examples: ['First', 'Business', 'Economy'].),\n  (class_type:text, The class_type column contains the type of a class. Either 'First Class', 'Business Class', or 'Economy Class'.. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: days\n[\n  (days_code:text, A code representing a day of the week. Value examples: ['1', '2'].),\n  (day_name:text, The name of a day of the week. Either 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', or 'Sunday'.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: dual_carrier\n[\n  (main_airline:text, The name of the main airline operating the flight. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (low_flight_number:bigint, The lowest flight number in the range of flights operated by the dual carrier. Value examples: ['1', '11', '21', '31'].),\n  (high_flight_number:bigint, The highest flight number in the range of flights operated by the dual carrier. Value examples: ['10', '20', '30', '40'].),\n  (dual_airline:text, The name of the dual airline operating the flight. Value examples: ['VX', 'DL', 'UA', 'AS'].),\n  (service_name:text, The name of the service provided by the dual carrier on the flight. Value examples: ['Dual Service 1', 'Dual Service 2', 'Dual Service 3', 'Dual Service 4'].),\n]\n# Table: equipment_sequence\n[\n  (aircraft_code_sequence:text, Sequence number for each aircraft code. Value examples: ['1', '2', '3', '4'].),\n  (aircraft_code:text, Code for each aircraft. Value examples: ['B747', 'A320', 'B737', 'A380'].),\n]\n# Table: fare\n[\n  (fare_id:bigint, The unique identifier for this fare. Value examples: ['1', '2'].),\n  (from_airport:text, The 3-letter airport code for the departure location. Value examples: ['ORD', 'ORD'].),\n  (to_airport:text, The 3-letter airport code for the arrival location. Value examples: ['JFK', 'JFK'].),\n  (fare_basis_code:text, The code used to determine the fare's pricing rules. Value examples: ['ABC', 'DEF'].),\n  (fare_airline:text, The airline code associated with this fare. Value examples: ['AA', 'UA'].),\n  (restriction_code:text, Any restrictions or limitations associated with this fare. Value examples: ['NONE', 'NONE'].),\n  (one_direction_cost:bigint, The cost of a one-way trip for this fare. Value examples: ['200', '150'].),\n  (round_trip_cost:bigint, The cost of a round-trip for this fare. Value examples: ['300', '280'].),\n  (round_trip_required:text, Indicates whether a round-trip is required to purchase this fare. Either Yes or No.. Value examples: ['Yes', 'No'].),\n]\n# Table: fare_basis\n[\n  (fare_basis_code:text, The code that identifies the fare basis. Value examples: ['ABC', 'DEF', 'GHI', 'JKL'].),\n  (booking_class:text, The booking class associated with the fare basis. Either 'First', 'Business', or 'Economy'. Value examples: ['First', 'Business', 'Economy', 'First'].),\n  (class_type:text, The class type associated with the fare basis. Either 'First Class', 'Business Class', or 'Economy Class'. Value examples: ['First Class', 'Business Class', 'Economy Class', 'First Class'].),\n  (premium:text, Indicates whether the fare basis is for a premium class. Value examples: ['Yes', 'Yes', 'No', 'Yes'].),\n  (economy:text, Indicates whether the fare basis is for an economy class. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (discounted:text, Indicates whether the fare basis is for a discounted fare. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (night:text, Indicates whether the fare basis is for a night fare. Value examples: ['No', 'No', 'No', 'No'].),\n  (season:text, The season associated with the fare basis. Can only be 'Peak' or 'Regular'. Value examples: ['Regular', 'Regular', 'Regular', 'Regular'].),\n  (basis_days:text, The number of days the fare basis is valid for. Value examples: ['30', '30', '30', '30'].),\n]\n# Table: flight\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['3', '4', '5', '7'].),\n  (flight_days:text, Days of the week the flight operates on. Formatted as comma-delimited 3-letter abbreviations, e.g. `mon,tue,wed` or `tues,thurs`. Value examples: ['wed', 'thu', 'fri', 'sun'].),\n  (from_airport:text, Code assigned to the departure airport. Value examples: ['ORD', 'ORD', 'ORD', 'JFK'].),\n  (to_airport:text, Code assigned to the arrival airport. Value examples: ['JFK', 'JFK', 'LAX', 'ORD'].),\n  (departure_time:bigint, Epoch timestamp for departure time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577858400', '1577865600', '1577880000'].),\n  (arrival_time:bigint, Epoch timestamp for arrival time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577854900', '1577873400', '1577869600', '1577883700'].),\n  (airline_flight:text, Code assigned to the airline flight. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (airline_code:text, Code assigned to the airline. Value examples: ['AA', 'WN', 'AS', 'UA'].),\n  (flight_number:text, Flight number assigned by the airline. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (aircraft_code_sequence:text, Code assigned to the aircraft. Value examples: ['3', '4', '5', '7'].),\n  (meal_code:text, Code assigned to the meal provided during the flight. Value examples: ['DN', 'BS', 'BF', 'DN'].),\n  (stops:bigint, Number of stops during the flight. Value examples: ['0', '1', '0', '0'].),\n  (connections:bigint, Number of connections during the flight. Value examples: ['0', '1', '0', '0'].),\n  (dual_carrier:text, Code assigned to the dual carrier. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (time_elapsed:bigint, Total time elapsed during the flight in seconds. Value examples: ['3700', '15000', '4000', '3700'].),\n]\n# Table: flight_fare\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3', '4'].),\n  (fare_id:bigint, Unique identifier for each fare. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: flight_leg\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3'].),\n  (leg_number:bigint, The sequence number of the leg within the flight. Value examples: ['1', '1', '1'].),\n  (leg_flight:bigint, The flight ID of the leg's corresponding flight. Value examples: ['1', '2', '3'].),\n]\n# Table: flight_stop\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['2', '4'].),\n  (stop_number:bigint, The order of the stop in the flight. Value examples: ['1', '1'].),\n  (stop_days:text, Days of the week on which the flight stops at this airport. Value examples: ['2', '4'].),\n  (stop_airport:text, The 3-letter airport code of the stop. Value examples: ['DFW', 'DEN'].),\n  (arrival_time:bigint, The time at which the flight arrives at this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577847600', '1577862000'].),\n  (arrival_airline:text, The airline code of the arriving flight. Value examples: ['UA', 'WN'].),\n  (arrival_flight_number:text, Flight number of the arriving flight at this stop. Value examples: ['UA456', 'WN012'].),\n  (departure_time:bigint, The time at which the flight departs from this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577865600'].),\n  (departure_airline:text, The airline code of the departing flight. Value examples: ['UA', 'WN'].),\n  (departure_flight_number:text, Flight number of the departing flight from this stop. Value examples: ['UA456', 'WN012'].),\n  (stop_time:bigint, The duration of the stop at this airport. Value examples: ['3600', '3600'].),\n]\n# Table: food_service\n[\n  (meal_code:text, Code assigned to each meal type. Value examples: ['BF', 'LN'].),\n  (meal_number:bigint, Unique identifier for each meal served. Value examples: ['1', '2'].),\n  (compartment:text, The compartment in which the meal is served (e.g. 'First Class', 'Economy'). Value examples: ['First Class', 'First Class'].),\n  (meal_description:text, One of 'Breakfast', 'Lunch', 'Dinner'. Value examples: ['Breakfast', 'Lunch'].),\n]\n# Table: ground_service\n[\n  (city_code:text, The code for the city where the ground service is provided. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The 3-letter code for the airport where the ground service is provided. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (transport_type:text, The type of ground transportation provided. Value examples: ['Taxi', 'Shuttle', 'Bus', 'Car Rental'].),\n  (ground_fare:bigint, The fare charged for ground transportation. Value examples: ['50', '40', '30', '60'].),\n]\n# Table: month\n[\n  (month_number:bigint, A unique number assigned to each month of the year.. Value examples: ['1', '2', '3', '4'].),\n  (month_name:text, The name of the month, e.g. January, February, etc.. Value examples: ['January', 'February', 'March', 'April'].),\n]\n# Table: restriction\n[\n  (restriction_code:text, A code representing the type of restriction, such as blackout dates or minimum stay.. Value examples: ['NONE', 'NONE', 'NONE', 'NONE'].),\n  (advance_purchase:bigint, The number of days in advance the fare must be purchased.. Value examples: ['14', '14', '14', '14'].),\n  (stopovers:text, The number of stopovers allowed for the fare.. Value examples: ['2', '2', '2', '2'].),\n  (saturday_stay_required:text, Indicates whether a Saturday night stay is required for the fare. Either 'Yes' or 'No'.. Value examples: ['No', 'No', 'No', 'No'].),\n  (minimum_stay:bigint, The minimum length of stay required for the fare.. Value examples: ['7', '7', '7', '7'].),\n  (maximum_stay:bigint, The maximum length of stay allowed for the fare.. Value examples: ['30', '30', '30', '30'].),\n  (application:text, The type of fare application. Either 'One Way' or 'Round Trip'.. Value examples: ['One-Way', 'One-Way', 'One-Way', 'One-Way'].),\n  (no_discounts:text, Indicates whether the fare is eligible for discounts or promotions. Either 'Yes' or 'No'.. Value examples: ['Yes', 'Yes', 'Yes', 'Yes'].),\n]\n# Table: state\n[\n  (state_code:text, The 2-letter code assigned to the state. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA'].),\n  (state_name:text, The name of the state. Value examples: ['New York', 'California'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States'].),\n]\n# Table: time_interval\n[\n  (period:text, The period of the time interval, represented as a string. For example, 'daily', 'weekly', 'monthly', etc.. Value examples: ['daily', 'daily', 'daily'].),\n  (begin_time:bigint, The beginning time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577836800', '1577844000', '1577851200'].),\n  (end_time:bigint, The end time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577840400', '1577847600', '1577854800'].),\n]\n# Table: time_zone\n[\n  (time_zone_code:text, A short code that represents the time zone. For example, 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['PST', 'MST'].),\n  (time_zone_name:text, The name of the time zone. Value examples: ['Pacific Standard Time', 'Mountain Standard Time'].),\n  (hours_from_gmt:bigint, The number of hours that the time zone is ahead or behind Greenwich Mean Time (GMT). Value examples: ['-8', '-7'].),\n]\n\n【Foreign keys】\nairline.airline_code = flight.airline_code\nairline.airline_code = flight_stop.departure_airline\nairport.airport_code = fare.from_airport\nairport.airport_code = flight_stop.stop_airport\nairport_service.city_code = ground_service.city_code\nairport.state_code = city.state_code\nairport.state_code = state.state_code\ncity.state_code = state.state_code\nairport_service.city_code = city.city_code\nground_service.city_code = city.city_code\nairport.time_zone_code = time_zone.time_zone_code\ncity.time_zone_code = time_zone.time_zone_code\nflight.flight_id = flight_fare.flight_id\nflight.flight_id = flight_leg.flight_id\nflight.flight_id = flight_stop.flight_id\nflight_fare.flight_id = flight_leg.flight_id\nflight_fare.flight_id = flight_stop.flight_id\nflight_leg.flight_id = flight_stop.flight_id\naircraft.aircraft_code = equipment_sequence.aircraft_code\nflight.aircraft_code_sequence = equipment_sequence.aircraft_code_sequence\nflight.meal_code = food_service.meal_code\n\n【参考信息】\nFilter airport, city, country names using ILIKE.\nFilter state code (eg NY), airport codes (eg JFK) using case-insensitive matches.\nfare.round_trip_required is not needed when getting the round trip cost.\n\n【用户问题】\nWhat is the total cost of all round-trip fares from New York (JFK) to Los Angeles?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT SUM(fare.round_trip_cost) AS total_round_trip_cost FROM fare WHERE fare.from_airport = 'JFK' AND fare.to_airport = 'LAX';",
        "role": "assistant"
      }
    ],
    "db_name": "atis",
    "id": 87,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the minimum amount of time required for a connecting flight at JFK Airport?\n\n【数据库schema】\n【DB_ID】 atis\n【Schema】\n# Table: aircraft\n[\n  (aircraft_code:text, The code assigned to the aircraft by the International Air Transport Association (IATA).. Value examples: ['B747', 'A320'].),\n  (aircraft_description:text, A short description of the aircraft.. Value examples: ['The Boeing 747 is a wide-body airliner.', 'The Airbus A320 is a narrow-body airliner.'].),\n  (manufacturer:text, The name of the manufacturer of the aircraft.. Value examples: ['Boeing', 'Airbus'].),\n  (basic_type:text, The basic type of the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (engines:bigint, The number of engines the aircraft has.. Value examples: ['4', '2'].),\n  (propulsion:text, The type of propulsion used by the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (wide_body:text, Indicates whether the aircraft is a wide body or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'No'].),\n  (wing_span:bigint, The distance between the tips of the aircraft's wings in feet.. Value examples: ['224', '111'].),\n  (length:bigint, The length of the aircraft in feet.. Value examples: ['231', '123'].),\n  (weight:bigint, The weight of the aircraft in pounds.. Value examples: ['987000', '162000'].),\n  (capacity:bigint, The maximum number of passengers the aircraft can carry.. Value examples: ['416', '240'].),\n  (pay_load:bigint, The maximum weight of cargo the aircraft can carry.. Value examples: ['60000', '30000'].),\n  (cruising_speed:bigint, The speed at which the aircraft cruises in miles per hour.. Value examples: ['570', '511'].),\n  (range_miles:bigint, The maximum distance the aircraft can fly in miles.. Value examples: ['8555', '3300'].),\n  (pressurized:text, Indicates whether the aircraft is pressurized or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'Yes'].),\n]\n# Table: airline\n[\n  (airline_code:text, The code assigned to the airline. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (airline_name:text, The name of the airline. Value examples: ['American Airlines', 'United Airlines', 'Delta Air Lines', 'Southwest Airlines'].),\n  (note:text, Any additional notes or comments about the airline. Value examples: ['NULL', 'NULL', 'NULL', 'NULL'].),\n]\n# Table: airport\n[\n  (airport_code:text, The code assigned to the airport.. Value examples: ['JFK', 'LAX', 'ORD', 'DFW'].),\n  (airport_name:text, The name of the airport.. Value examples: ['John F. Kennedy International Airport', 'Los Angeles International Airport', 'O’Hare International Airport', 'Dallas/Fort Worth International Airport'].),\n  (airport_location:text, The location of the airport, eg 'Las Vegas', 'Chicago'. Value examples: ['New York City', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The code assigned to the state where the airport is located.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the airport is located.. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the airport is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n  (minimum_connect_time:bigint, The minimum amount of time required for a connecting flight at the airport.. Value examples: ['23', '20', '24', '40'].),\n]\n# Table: airport_service\n[\n  (city_code:text, The code of the city where the airport is located. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The code of the airport. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (miles_distant:bigint, The distance of the airport from the city in miles. Value examples: ['10', '20', '30', '40'].),\n  (direction:text, The direction of the airport from the city. Either 'North', 'South', 'East', 'West', 'Northeast', 'Northwest', 'Southeast', or 'Southwest'.. Value examples: ['North', 'South', 'East', 'West'].),\n  (minutes_distant:bigint, The distance of the airport from the city in minutes. Value examples: ['20', '40', '60', '80'].),\n]\n# Table: city\n[\n  (city_code:text, The code assigned to the city. Value examples: ['NYC', 'LA', 'CHI', 'DA'].),\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The 2-letter code assigned to the state where the city is located. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the city is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n]\n# Table: class_of_service\n[\n  (booking_class:text, The booking class code for the class of service. Value examples: ['First', 'Business', 'Economy'].),\n  (rank:bigint, The rank of the class of service. Value examples: ['1', '2', '3'].),\n  (class_description:text, A brief description of the class of service. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: code_description\n[\n  (code:text, The code column contains a unique identifier for each record in the table.. Value examples: ['ABC', 'DEF'].),\n  (description:text, The description column contains a textual description of the code.. Value examples: ['Code ABC', 'Code DEF'].),\n]\n# Table: compartment_class\n[\n  (compartment:text, The compartment column contains the name of a compartment. Either 'First', 'Business', or 'Economy'.. Value examples: ['First', 'Business', 'Economy'].),\n  (class_type:text, The class_type column contains the type of a class. Either 'First Class', 'Business Class', or 'Economy Class'.. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: days\n[\n  (days_code:text, A code representing a day of the week. Value examples: ['1', '2'].),\n  (day_name:text, The name of a day of the week. Either 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', or 'Sunday'.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: dual_carrier\n[\n  (main_airline:text, The name of the main airline operating the flight. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (low_flight_number:bigint, The lowest flight number in the range of flights operated by the dual carrier. Value examples: ['1', '11', '21', '31'].),\n  (high_flight_number:bigint, The highest flight number in the range of flights operated by the dual carrier. Value examples: ['10', '20', '30', '40'].),\n  (dual_airline:text, The name of the dual airline operating the flight. Value examples: ['VX', 'DL', 'UA', 'AS'].),\n  (service_name:text, The name of the service provided by the dual carrier on the flight. Value examples: ['Dual Service 1', 'Dual Service 2', 'Dual Service 3', 'Dual Service 4'].),\n]\n# Table: equipment_sequence\n[\n  (aircraft_code_sequence:text, Sequence number for each aircraft code. Value examples: ['1', '2', '3', '4'].),\n  (aircraft_code:text, Code for each aircraft. Value examples: ['B747', 'A320', 'B737', 'A380'].),\n]\n# Table: fare\n[\n  (fare_id:bigint, The unique identifier for this fare. Value examples: ['1', '2'].),\n  (from_airport:text, The 3-letter airport code for the departure location. Value examples: ['ORD', 'ORD'].),\n  (to_airport:text, The 3-letter airport code for the arrival location. Value examples: ['JFK', 'JFK'].),\n  (fare_basis_code:text, The code used to determine the fare's pricing rules. Value examples: ['ABC', 'DEF'].),\n  (fare_airline:text, The airline code associated with this fare. Value examples: ['AA', 'UA'].),\n  (restriction_code:text, Any restrictions or limitations associated with this fare. Value examples: ['NONE', 'NONE'].),\n  (one_direction_cost:bigint, The cost of a one-way trip for this fare. Value examples: ['200', '150'].),\n  (round_trip_cost:bigint, The cost of a round-trip for this fare. Value examples: ['300', '280'].),\n  (round_trip_required:text, Indicates whether a round-trip is required to purchase this fare. Either Yes or No.. Value examples: ['Yes', 'No'].),\n]\n# Table: fare_basis\n[\n  (fare_basis_code:text, The code that identifies the fare basis. Value examples: ['ABC', 'DEF', 'GHI', 'JKL'].),\n  (booking_class:text, The booking class associated with the fare basis. Either 'First', 'Business', or 'Economy'. Value examples: ['First', 'Business', 'Economy', 'First'].),\n  (class_type:text, The class type associated with the fare basis. Either 'First Class', 'Business Class', or 'Economy Class'. Value examples: ['First Class', 'Business Class', 'Economy Class', 'First Class'].),\n  (premium:text, Indicates whether the fare basis is for a premium class. Value examples: ['Yes', 'Yes', 'No', 'Yes'].),\n  (economy:text, Indicates whether the fare basis is for an economy class. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (discounted:text, Indicates whether the fare basis is for a discounted fare. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (night:text, Indicates whether the fare basis is for a night fare. Value examples: ['No', 'No', 'No', 'No'].),\n  (season:text, The season associated with the fare basis. Can only be 'Peak' or 'Regular'. Value examples: ['Regular', 'Regular', 'Regular', 'Regular'].),\n  (basis_days:text, The number of days the fare basis is valid for. Value examples: ['30', '30', '30', '30'].),\n]\n# Table: flight\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['3', '4', '5', '7'].),\n  (flight_days:text, Days of the week the flight operates on. Formatted as comma-delimited 3-letter abbreviations, e.g. `mon,tue,wed` or `tues,thurs`. Value examples: ['wed', 'thu', 'fri', 'sun'].),\n  (from_airport:text, Code assigned to the departure airport. Value examples: ['ORD', 'ORD', 'ORD', 'JFK'].),\n  (to_airport:text, Code assigned to the arrival airport. Value examples: ['JFK', 'JFK', 'LAX', 'ORD'].),\n  (departure_time:bigint, Epoch timestamp for departure time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577858400', '1577865600', '1577880000'].),\n  (arrival_time:bigint, Epoch timestamp for arrival time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577854900', '1577873400', '1577869600', '1577883700'].),\n  (airline_flight:text, Code assigned to the airline flight. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (airline_code:text, Code assigned to the airline. Value examples: ['AA', 'WN', 'AS', 'UA'].),\n  (flight_number:text, Flight number assigned by the airline. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (aircraft_code_sequence:text, Code assigned to the aircraft. Value examples: ['3', '4', '5', '7'].),\n  (meal_code:text, Code assigned to the meal provided during the flight. Value examples: ['DN', 'BS', 'BF', 'DN'].),\n  (stops:bigint, Number of stops during the flight. Value examples: ['0', '1', '0', '0'].),\n  (connections:bigint, Number of connections during the flight. Value examples: ['0', '1', '0', '0'].),\n  (dual_carrier:text, Code assigned to the dual carrier. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (time_elapsed:bigint, Total time elapsed during the flight in seconds. Value examples: ['3700', '15000', '4000', '3700'].),\n]\n# Table: flight_fare\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3', '4'].),\n  (fare_id:bigint, Unique identifier for each fare. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: flight_leg\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3'].),\n  (leg_number:bigint, The sequence number of the leg within the flight. Value examples: ['1', '1', '1'].),\n  (leg_flight:bigint, The flight ID of the leg's corresponding flight. Value examples: ['1', '2', '3'].),\n]\n# Table: flight_stop\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['2', '4'].),\n  (stop_number:bigint, The order of the stop in the flight. Value examples: ['1', '1'].),\n  (stop_days:text, Days of the week on which the flight stops at this airport. Value examples: ['2', '4'].),\n  (stop_airport:text, The 3-letter airport code of the stop. Value examples: ['DFW', 'DEN'].),\n  (arrival_time:bigint, The time at which the flight arrives at this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577847600', '1577862000'].),\n  (arrival_airline:text, The airline code of the arriving flight. Value examples: ['UA', 'WN'].),\n  (arrival_flight_number:text, Flight number of the arriving flight at this stop. Value examples: ['UA456', 'WN012'].),\n  (departure_time:bigint, The time at which the flight departs from this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577865600'].),\n  (departure_airline:text, The airline code of the departing flight. Value examples: ['UA', 'WN'].),\n  (departure_flight_number:text, Flight number of the departing flight from this stop. Value examples: ['UA456', 'WN012'].),\n  (stop_time:bigint, The duration of the stop at this airport. Value examples: ['3600', '3600'].),\n]\n# Table: food_service\n[\n  (meal_code:text, Code assigned to each meal type. Value examples: ['BF', 'LN'].),\n  (meal_number:bigint, Unique identifier for each meal served. Value examples: ['1', '2'].),\n  (compartment:text, The compartment in which the meal is served (e.g. 'First Class', 'Economy'). Value examples: ['First Class', 'First Class'].),\n  (meal_description:text, One of 'Breakfast', 'Lunch', 'Dinner'. Value examples: ['Breakfast', 'Lunch'].),\n]\n# Table: ground_service\n[\n  (city_code:text, The code for the city where the ground service is provided. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The 3-letter code for the airport where the ground service is provided. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (transport_type:text, The type of ground transportation provided. Value examples: ['Taxi', 'Shuttle', 'Bus', 'Car Rental'].),\n  (ground_fare:bigint, The fare charged for ground transportation. Value examples: ['50', '40', '30', '60'].),\n]\n# Table: month\n[\n  (month_number:bigint, A unique number assigned to each month of the year.. Value examples: ['1', '2', '3', '4'].),\n  (month_name:text, The name of the month, e.g. January, February, etc.. Value examples: ['January', 'February', 'March', 'April'].),\n]\n# Table: restriction\n[\n  (restriction_code:text, A code representing the type of restriction, such as blackout dates or minimum stay.. Value examples: ['NONE', 'NONE', 'NONE', 'NONE'].),\n  (advance_purchase:bigint, The number of days in advance the fare must be purchased.. Value examples: ['14', '14', '14', '14'].),\n  (stopovers:text, The number of stopovers allowed for the fare.. Value examples: ['2', '2', '2', '2'].),\n  (saturday_stay_required:text, Indicates whether a Saturday night stay is required for the fare. Either 'Yes' or 'No'.. Value examples: ['No', 'No', 'No', 'No'].),\n  (minimum_stay:bigint, The minimum length of stay required for the fare.. Value examples: ['7', '7', '7', '7'].),\n  (maximum_stay:bigint, The maximum length of stay allowed for the fare.. Value examples: ['30', '30', '30', '30'].),\n  (application:text, The type of fare application. Either 'One Way' or 'Round Trip'.. Value examples: ['One-Way', 'One-Way', 'One-Way', 'One-Way'].),\n  (no_discounts:text, Indicates whether the fare is eligible for discounts or promotions. Either 'Yes' or 'No'.. Value examples: ['Yes', 'Yes', 'Yes', 'Yes'].),\n]\n# Table: state\n[\n  (state_code:text, The 2-letter code assigned to the state. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA'].),\n  (state_name:text, The name of the state. Value examples: ['New York', 'California'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States'].),\n]\n# Table: time_interval\n[\n  (period:text, The period of the time interval, represented as a string. For example, 'daily', 'weekly', 'monthly', etc.. Value examples: ['daily', 'daily', 'daily'].),\n  (begin_time:bigint, The beginning time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577836800', '1577844000', '1577851200'].),\n  (end_time:bigint, The end time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577840400', '1577847600', '1577854800'].),\n]\n# Table: time_zone\n[\n  (time_zone_code:text, A short code that represents the time zone. For example, 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['PST', 'MST'].),\n  (time_zone_name:text, The name of the time zone. Value examples: ['Pacific Standard Time', 'Mountain Standard Time'].),\n  (hours_from_gmt:bigint, The number of hours that the time zone is ahead or behind Greenwich Mean Time (GMT). Value examples: ['-8', '-7'].),\n]\n\n【Foreign keys】\nairline.airline_code = flight.airline_code\nairline.airline_code = flight_stop.departure_airline\nairport.airport_code = fare.from_airport\nairport.airport_code = flight_stop.stop_airport\nairport_service.city_code = ground_service.city_code\nairport.state_code = city.state_code\nairport.state_code = state.state_code\ncity.state_code = state.state_code\nairport_service.city_code = city.city_code\nground_service.city_code = city.city_code\nairport.time_zone_code = time_zone.time_zone_code\ncity.time_zone_code = time_zone.time_zone_code\nflight.flight_id = flight_fare.flight_id\nflight.flight_id = flight_leg.flight_id\nflight.flight_id = flight_stop.flight_id\nflight_fare.flight_id = flight_leg.flight_id\nflight_fare.flight_id = flight_stop.flight_id\nflight_leg.flight_id = flight_stop.flight_id\naircraft.aircraft_code = equipment_sequence.aircraft_code\nflight.aircraft_code_sequence = equipment_sequence.aircraft_code_sequence\nflight.meal_code = food_service.meal_code\n\n【参考信息】\nFilter airport, city, country names using ILIKE.\nFilter state code (eg NY) and airport codes (eg JFK) using upper-case matches.\n\n【用户问题】\nWhat is the minimum amount of time required for a connecting flight at JFK Airport?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT minimum_connect_time FROM airport WHERE airport_code = 'JFK';",
        "role": "assistant"
      }
    ],
    "db_name": "atis",
    "id": 88,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many flights require a round-trip to purchase the fare?\n\n【数据库schema】\n【DB_ID】 atis\n【Schema】\n# Table: aircraft\n[\n  (aircraft_code:text, The code assigned to the aircraft by the International Air Transport Association (IATA).. Value examples: ['B747', 'A320'].),\n  (aircraft_description:text, A short description of the aircraft.. Value examples: ['The Boeing 747 is a wide-body airliner.', 'The Airbus A320 is a narrow-body airliner.'].),\n  (manufacturer:text, The name of the manufacturer of the aircraft.. Value examples: ['Boeing', 'Airbus'].),\n  (basic_type:text, The basic type of the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (engines:bigint, The number of engines the aircraft has.. Value examples: ['4', '2'].),\n  (propulsion:text, The type of propulsion used by the aircraft. Only 'Jet' is a possible value.. Value examples: ['Jet', 'Jet'].),\n  (wide_body:text, Indicates whether the aircraft is a wide body or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'No'].),\n  (wing_span:bigint, The distance between the tips of the aircraft's wings in feet.. Value examples: ['224', '111'].),\n  (length:bigint, The length of the aircraft in feet.. Value examples: ['231', '123'].),\n  (weight:bigint, The weight of the aircraft in pounds.. Value examples: ['987000', '162000'].),\n  (capacity:bigint, The maximum number of passengers the aircraft can carry.. Value examples: ['416', '240'].),\n  (pay_load:bigint, The maximum weight of cargo the aircraft can carry.. Value examples: ['60000', '30000'].),\n  (cruising_speed:bigint, The speed at which the aircraft cruises in miles per hour.. Value examples: ['570', '511'].),\n  (range_miles:bigint, The maximum distance the aircraft can fly in miles.. Value examples: ['8555', '3300'].),\n  (pressurized:text, Indicates whether the aircraft is pressurized or not. Possible values are 'Yes' and 'No'.. Value examples: ['Yes', 'Yes'].),\n]\n# Table: airline\n[\n  (airline_code:text, The code assigned to the airline. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (airline_name:text, The name of the airline. Value examples: ['American Airlines', 'United Airlines', 'Delta Air Lines', 'Southwest Airlines'].),\n  (note:text, Any additional notes or comments about the airline. Value examples: ['NULL', 'NULL', 'NULL', 'NULL'].),\n]\n# Table: airport\n[\n  (airport_code:text, The code assigned to the airport.. Value examples: ['JFK', 'LAX', 'ORD', 'DFW'].),\n  (airport_name:text, The name of the airport.. Value examples: ['John F. Kennedy International Airport', 'Los Angeles International Airport', 'O’Hare International Airport', 'Dallas/Fort Worth International Airport'].),\n  (airport_location:text, The location of the airport, eg 'Las Vegas', 'Chicago'. Value examples: ['New York City', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The code assigned to the state where the airport is located.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the airport is located.. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the airport is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n  (minimum_connect_time:bigint, The minimum amount of time required for a connecting flight at the airport.. Value examples: ['23', '20', '24', '40'].),\n]\n# Table: airport_service\n[\n  (city_code:text, The code of the city where the airport is located. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The code of the airport. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (miles_distant:bigint, The distance of the airport from the city in miles. Value examples: ['10', '20', '30', '40'].),\n  (direction:text, The direction of the airport from the city. Either 'North', 'South', 'East', 'West', 'Northeast', 'Northwest', 'Southeast', or 'Southwest'.. Value examples: ['North', 'South', 'East', 'West'].),\n  (minutes_distant:bigint, The distance of the airport from the city in minutes. Value examples: ['20', '40', '60', '80'].),\n]\n# Table: city\n[\n  (city_code:text, The code assigned to the city. Value examples: ['NYC', 'LA', 'CHI', 'DA'].),\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Dallas'].),\n  (state_code:text, The 2-letter code assigned to the state where the city is located. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA', 'IL', 'TX'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (time_zone_code:text, The code assigned to the time zone where the city is located. Either 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['EST', 'PST', 'CST', 'CST'].),\n]\n# Table: class_of_service\n[\n  (booking_class:text, The booking class code for the class of service. Value examples: ['First', 'Business', 'Economy'].),\n  (rank:bigint, The rank of the class of service. Value examples: ['1', '2', '3'].),\n  (class_description:text, A brief description of the class of service. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: code_description\n[\n  (code:text, The code column contains a unique identifier for each record in the table.. Value examples: ['ABC', 'DEF'].),\n  (description:text, The description column contains a textual description of the code.. Value examples: ['Code ABC', 'Code DEF'].),\n]\n# Table: compartment_class\n[\n  (compartment:text, The compartment column contains the name of a compartment. Either 'First', 'Business', or 'Economy'.. Value examples: ['First', 'Business', 'Economy'].),\n  (class_type:text, The class_type column contains the type of a class. Either 'First Class', 'Business Class', or 'Economy Class'.. Value examples: ['First Class', 'Business Class', 'Economy Class'].),\n]\n# Table: days\n[\n  (days_code:text, A code representing a day of the week. Value examples: ['1', '2'].),\n  (day_name:text, The name of a day of the week. Either 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', or 'Sunday'.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: dual_carrier\n[\n  (main_airline:text, The name of the main airline operating the flight. Value examples: ['AA', 'UA', 'DL', 'WN'].),\n  (low_flight_number:bigint, The lowest flight number in the range of flights operated by the dual carrier. Value examples: ['1', '11', '21', '31'].),\n  (high_flight_number:bigint, The highest flight number in the range of flights operated by the dual carrier. Value examples: ['10', '20', '30', '40'].),\n  (dual_airline:text, The name of the dual airline operating the flight. Value examples: ['VX', 'DL', 'UA', 'AS'].),\n  (service_name:text, The name of the service provided by the dual carrier on the flight. Value examples: ['Dual Service 1', 'Dual Service 2', 'Dual Service 3', 'Dual Service 4'].),\n]\n# Table: equipment_sequence\n[\n  (aircraft_code_sequence:text, Sequence number for each aircraft code. Value examples: ['1', '2', '3', '4'].),\n  (aircraft_code:text, Code for each aircraft. Value examples: ['B747', 'A320', 'B737', 'A380'].),\n]\n# Table: fare\n[\n  (fare_id:bigint, The unique identifier for this fare. Value examples: ['1', '2'].),\n  (from_airport:text, The 3-letter airport code for the departure location. Value examples: ['ORD', 'ORD'].),\n  (to_airport:text, The 3-letter airport code for the arrival location. Value examples: ['JFK', 'JFK'].),\n  (fare_basis_code:text, The code used to determine the fare's pricing rules. Value examples: ['ABC', 'DEF'].),\n  (fare_airline:text, The airline code associated with this fare. Value examples: ['AA', 'UA'].),\n  (restriction_code:text, Any restrictions or limitations associated with this fare. Value examples: ['NONE', 'NONE'].),\n  (one_direction_cost:bigint, The cost of a one-way trip for this fare. Value examples: ['200', '150'].),\n  (round_trip_cost:bigint, The cost of a round-trip for this fare. Value examples: ['300', '280'].),\n  (round_trip_required:text, Indicates whether a round-trip is required to purchase this fare. Either Yes or No.. Value examples: ['Yes', 'No'].),\n]\n# Table: fare_basis\n[\n  (fare_basis_code:text, The code that identifies the fare basis. Value examples: ['ABC', 'DEF', 'GHI', 'JKL'].),\n  (booking_class:text, The booking class associated with the fare basis. Either 'First', 'Business', or 'Economy'. Value examples: ['First', 'Business', 'Economy', 'First'].),\n  (class_type:text, The class type associated with the fare basis. Either 'First Class', 'Business Class', or 'Economy Class'. Value examples: ['First Class', 'Business Class', 'Economy Class', 'First Class'].),\n  (premium:text, Indicates whether the fare basis is for a premium class. Value examples: ['Yes', 'Yes', 'No', 'Yes'].),\n  (economy:text, Indicates whether the fare basis is for an economy class. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (discounted:text, Indicates whether the fare basis is for a discounted fare. Value examples: ['No', 'No', 'Yes', 'No'].),\n  (night:text, Indicates whether the fare basis is for a night fare. Value examples: ['No', 'No', 'No', 'No'].),\n  (season:text, The season associated with the fare basis. Can only be 'Peak' or 'Regular'. Value examples: ['Regular', 'Regular', 'Regular', 'Regular'].),\n  (basis_days:text, The number of days the fare basis is valid for. Value examples: ['30', '30', '30', '30'].),\n]\n# Table: flight\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['3', '4', '5', '7'].),\n  (flight_days:text, Days of the week the flight operates on. Formatted as comma-delimited 3-letter abbreviations, e.g. `mon,tue,wed` or `tues,thurs`. Value examples: ['wed', 'thu', 'fri', 'sun'].),\n  (from_airport:text, Code assigned to the departure airport. Value examples: ['ORD', 'ORD', 'ORD', 'JFK'].),\n  (to_airport:text, Code assigned to the arrival airport. Value examples: ['JFK', 'JFK', 'LAX', 'ORD'].),\n  (departure_time:bigint, Epoch timestamp for departure time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577858400', '1577865600', '1577880000'].),\n  (arrival_time:bigint, Epoch timestamp for arrival time. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577854900', '1577873400', '1577869600', '1577883700'].),\n  (airline_flight:text, Code assigned to the airline flight. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (airline_code:text, Code assigned to the airline. Value examples: ['AA', 'WN', 'AS', 'UA'].),\n  (flight_number:text, Flight number assigned by the airline. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (aircraft_code_sequence:text, Code assigned to the aircraft. Value examples: ['3', '4', '5', '7'].),\n  (meal_code:text, Code assigned to the meal provided during the flight. Value examples: ['DN', 'BS', 'BF', 'DN'].),\n  (stops:bigint, Number of stops during the flight. Value examples: ['0', '1', '0', '0'].),\n  (connections:bigint, Number of connections during the flight. Value examples: ['0', '1', '0', '0'].),\n  (dual_carrier:text, Code assigned to the dual carrier. Value examples: ['AA789', 'WN012', 'AS345', 'UA457'].),\n  (time_elapsed:bigint, Total time elapsed during the flight in seconds. Value examples: ['3700', '15000', '4000', '3700'].),\n]\n# Table: flight_fare\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3', '4'].),\n  (fare_id:bigint, Unique identifier for each fare. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: flight_leg\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['1', '2', '3'].),\n  (leg_number:bigint, The sequence number of the leg within the flight. Value examples: ['1', '1', '1'].),\n  (leg_flight:bigint, The flight ID of the leg's corresponding flight. Value examples: ['1', '2', '3'].),\n]\n# Table: flight_stop\n[\n  (flight_id:bigint, Unique identifier for each flight. Value examples: ['2', '4'].),\n  (stop_number:bigint, The order of the stop in the flight. Value examples: ['1', '1'].),\n  (stop_days:text, Days of the week on which the flight stops at this airport. Value examples: ['2', '4'].),\n  (stop_airport:text, The 3-letter airport code of the stop. Value examples: ['DFW', 'DEN'].),\n  (arrival_time:bigint, The time at which the flight arrives at this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577847600', '1577862000'].),\n  (arrival_airline:text, The airline code of the arriving flight. Value examples: ['UA', 'WN'].),\n  (arrival_flight_number:text, Flight number of the arriving flight at this stop. Value examples: ['UA456', 'WN012'].),\n  (departure_time:bigint, The time at which the flight departs from this stop. This is in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577851200', '1577865600'].),\n  (departure_airline:text, The airline code of the departing flight. Value examples: ['UA', 'WN'].),\n  (departure_flight_number:text, Flight number of the departing flight from this stop. Value examples: ['UA456', 'WN012'].),\n  (stop_time:bigint, The duration of the stop at this airport. Value examples: ['3600', '3600'].),\n]\n# Table: food_service\n[\n  (meal_code:text, Code assigned to each meal type. Value examples: ['BF', 'LN'].),\n  (meal_number:bigint, Unique identifier for each meal served. Value examples: ['1', '2'].),\n  (compartment:text, The compartment in which the meal is served (e.g. 'First Class', 'Economy'). Value examples: ['First Class', 'First Class'].),\n  (meal_description:text, One of 'Breakfast', 'Lunch', 'Dinner'. Value examples: ['Breakfast', 'Lunch'].),\n]\n# Table: ground_service\n[\n  (city_code:text, The code for the city where the ground service is provided. Value examples: ['NYC', 'NYC', 'NYC', 'NYC'].),\n  (airport_code:text, The 3-letter code for the airport where the ground service is provided. Value examples: ['JFK', 'JFK', 'JFK', 'JFK'].),\n  (transport_type:text, The type of ground transportation provided. Value examples: ['Taxi', 'Shuttle', 'Bus', 'Car Rental'].),\n  (ground_fare:bigint, The fare charged for ground transportation. Value examples: ['50', '40', '30', '60'].),\n]\n# Table: month\n[\n  (month_number:bigint, A unique number assigned to each month of the year.. Value examples: ['1', '2', '3', '4'].),\n  (month_name:text, The name of the month, e.g. January, February, etc.. Value examples: ['January', 'February', 'March', 'April'].),\n]\n# Table: restriction\n[\n  (restriction_code:text, A code representing the type of restriction, such as blackout dates or minimum stay.. Value examples: ['NONE', 'NONE', 'NONE', 'NONE'].),\n  (advance_purchase:bigint, The number of days in advance the fare must be purchased.. Value examples: ['14', '14', '14', '14'].),\n  (stopovers:text, The number of stopovers allowed for the fare.. Value examples: ['2', '2', '2', '2'].),\n  (saturday_stay_required:text, Indicates whether a Saturday night stay is required for the fare. Either 'Yes' or 'No'.. Value examples: ['No', 'No', 'No', 'No'].),\n  (minimum_stay:bigint, The minimum length of stay required for the fare.. Value examples: ['7', '7', '7', '7'].),\n  (maximum_stay:bigint, The maximum length of stay allowed for the fare.. Value examples: ['30', '30', '30', '30'].),\n  (application:text, The type of fare application. Either 'One Way' or 'Round Trip'.. Value examples: ['One-Way', 'One-Way', 'One-Way', 'One-Way'].),\n  (no_discounts:text, Indicates whether the fare is eligible for discounts or promotions. Either 'Yes' or 'No'.. Value examples: ['Yes', 'Yes', 'Yes', 'Yes'].),\n]\n# Table: state\n[\n  (state_code:text, The 2-letter code assigned to the state. E.g. 'NY', 'CA', etc.. Value examples: ['NY', 'CA'].),\n  (state_name:text, The name of the state. Value examples: ['New York', 'California'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States'].),\n]\n# Table: time_interval\n[\n  (period:text, The period of the time interval, represented as a string. For example, 'daily', 'weekly', 'monthly', etc.. Value examples: ['daily', 'daily', 'daily'].),\n  (begin_time:bigint, The beginning time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577836800', '1577844000', '1577851200'].),\n  (end_time:bigint, The end time of the time interval in Unix timestamp format. Always convert to regular date time format.. Value examples: ['1577840400', '1577847600', '1577854800'].),\n]\n# Table: time_zone\n[\n  (time_zone_code:text, A short code that represents the time zone. For example, 'EST', 'CST', 'MST', or 'PST'.. Value examples: ['PST', 'MST'].),\n  (time_zone_name:text, The name of the time zone. Value examples: ['Pacific Standard Time', 'Mountain Standard Time'].),\n  (hours_from_gmt:bigint, The number of hours that the time zone is ahead or behind Greenwich Mean Time (GMT). Value examples: ['-8', '-7'].),\n]\n\n【Foreign keys】\nairline.airline_code = flight.airline_code\nairline.airline_code = flight_stop.departure_airline\nairport.airport_code = fare.from_airport\nairport.airport_code = flight_stop.stop_airport\nairport_service.city_code = ground_service.city_code\nairport.state_code = city.state_code\nairport.state_code = state.state_code\ncity.state_code = state.state_code\nairport_service.city_code = city.city_code\nground_service.city_code = city.city_code\nairport.time_zone_code = time_zone.time_zone_code\ncity.time_zone_code = time_zone.time_zone_code\nflight.flight_id = flight_fare.flight_id\nflight.flight_id = flight_leg.flight_id\nflight.flight_id = flight_stop.flight_id\nflight_fare.flight_id = flight_leg.flight_id\nflight_fare.flight_id = flight_stop.flight_id\nflight_leg.flight_id = flight_stop.flight_id\naircraft.aircraft_code = equipment_sequence.aircraft_code\nflight.aircraft_code_sequence = equipment_sequence.aircraft_code_sequence\nflight.meal_code = food_service.meal_code\n\n【参考信息】\nFilter airport, city, country names using ILIKE.\nFilter state code (eg NY) and airport codes (eg JFK) using upper-case matches.\n\n【用户问题】\nHow many flights require a round-trip to purchase the fare?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT COUNT(DISTINCT flight_fare.flight_id) FROM flight_fare JOIN fare ON flight_fare.fare_id = fare.fare_id WHERE fare.round_trip_required = 'Yes';",
        "role": "assistant"
      }
    ],
    "db_name": "atis",
    "id": 89,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the total population in cities by country?\n\n【数据库schema】\n【DB_ID】 geography\n【Schema】\n# Table: border_info\n[\n  (state_name:text, The name of the state that shares a border with another state or country.. Value examples: ['California', 'California', 'California', 'Texas'].),\n  (border:text, The name of the state that shares a border with the state specified in the state_name column.. Value examples: ['Nevada', 'Arizona', 'Oregon', 'Louisiana'].),\n]\n# Table: city\n[\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Houston'].),\n  (population:bigint, The population of the city. Value examples: ['1000000', '5000000', '1500000', '2000000'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the city is located. Value examples: ['New York', 'California', 'Illinois', 'Texas'].),\n]\n# Table: highlow\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas'].),\n  (highest_elevation:text, The highest elevation point in the state in meters above sea level. Value examples: ['4421', '2667'].),\n  (lowest_point:text, The lowest elevation point in the state. Value examples: ['Death Valley', 'Gulf of Mexico'].),\n  (highest_point:text, The highest point in the state. If unknown, use 'Unnamed location'.. Value examples: ['Mount Whitney', 'Guadalupe Peak'].),\n  (lowest_elevation:text, The lowest point in the state in meters above sea level. Value examples: ['-86', '0'].),\n]\n# Table: lake\n[\n  (lake_name:text, The name of the lake. Value examples: ['Lake Superior', 'Lake Michigan', 'Lake Huron'].),\n  (area:double, The area of the lake in square kilometers. Value examples: ['1000', '500', '300'].),\n  (country_name:text, The name of the country where the lake is located. Value examples: ['United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the lake is located (if applicable). Value examples: ['Michigan', 'Michigan', 'Michigan'].),\n]\n# Table: mountain\n[\n  (mountain_name:text, The name of the mountain. Value examples: ['Mount Everest', 'K2', 'Kangchenjunga'].),\n  (mountain_altitude:bigint, The altitude of the mountain in meters. Value examples: ['10000', '5000', '3000'].),\n  (country_name:text, The name of the country where the mountain is located. Value examples: ['Nepal', 'Pakistan', 'Nepal'].),\n  (state_name:text, The name of the state or province where the mountain is located (if applicable). Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: river\n[\n  (river_name:text, The name of the river. Names exclude the word 'river' e.g. 'Mississippi' instead of 'Mississippi River'.),\n  (length:bigint, The length of the river in meters.),\n  (country_name:text, The name of the country the river flows through.),\n  (traverse:text, The cities or landmarks the river passes through. Comma delimited and in title case, eg `New York,Albany,Boston`.),\n]\n# Table: state\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas', 'Florida', 'New York'].),\n  (population:bigint, The population of the state. Value examples: ['100000', '50000', '150000', '200000'].),\n  (area:double, The area of the state in square kilometers. Value examples: ['10000', '5000', '15000', '20000'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (capital:text, The name of the capital city of the state. Value examples: ['Sacramento', 'Austin', 'Tallahassee', 'Albany'].),\n  (density:double, The population density of the state in people per square kilometer. Value examples: ['1000', '1000', '1000', '1000'].),\n]\n\n【Foreign keys】\nborder_info.state_name = city.state_name\nborder_info.state_name = lake.state_name\nborder_info.state_name = state.state_name\nborder_info.state_name = highlow.state_name\nborder_info.state_name = mountain.state_name\ncity.country_name = lake.country_name\ncity.country_name = river.country_name\ncity.country_name = state.country_name\ncity.country_name = mountain.country_name\ncity.state_name = highlow.state_name\nhighlow.state_name = lake.state_name\nhighlow.state_name = state.state_name\nhighlow.state_name = mountain.state_name\nlake.country_name = river.country_name\nlake.country_name = state.country_name\nlake.country_name = mountain.country_name\nriver.country_name = state.country_name\nriver.country_name = mountain.country_name\nstate.country_name = mountain.country_name\n\n【参考信息】\n\n\n【用户问题】\nWhat is the total population in cities by country?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT city.country_name, SUM(city.population) AS total_population FROM city GROUP BY city.country_name ORDER BY total_population DESC NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "geography",
    "id": 90,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the average length of rivers in each country?\n\n【数据库schema】\n【DB_ID】 geography\n【Schema】\n# Table: border_info\n[\n  (state_name:text, The name of the state that shares a border with another state or country.. Value examples: ['California', 'California', 'California', 'Texas'].),\n  (border:text, The name of the state that shares a border with the state specified in the state_name column.. Value examples: ['Nevada', 'Arizona', 'Oregon', 'Louisiana'].),\n]\n# Table: city\n[\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Houston'].),\n  (population:bigint, The population of the city. Value examples: ['1000000', '5000000', '1500000', '2000000'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the city is located. Value examples: ['New York', 'California', 'Illinois', 'Texas'].),\n]\n# Table: highlow\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas'].),\n  (highest_elevation:text, The highest elevation point in the state in meters above sea level. Value examples: ['4421', '2667'].),\n  (lowest_point:text, The lowest elevation point in the state. Value examples: ['Death Valley', 'Gulf of Mexico'].),\n  (highest_point:text, The highest point in the state. If unknown, use 'Unnamed location'.. Value examples: ['Mount Whitney', 'Guadalupe Peak'].),\n  (lowest_elevation:text, The lowest point in the state in meters above sea level. Value examples: ['-86', '0'].),\n]\n# Table: lake\n[\n  (lake_name:text, The name of the lake. Value examples: ['Lake Superior', 'Lake Michigan', 'Lake Huron'].),\n  (area:double, The area of the lake in square kilometers. Value examples: ['1000', '500', '300'].),\n  (country_name:text, The name of the country where the lake is located. Value examples: ['United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the lake is located (if applicable). Value examples: ['Michigan', 'Michigan', 'Michigan'].),\n]\n# Table: mountain\n[\n  (mountain_name:text, The name of the mountain. Value examples: ['Mount Everest', 'K2', 'Kangchenjunga'].),\n  (mountain_altitude:bigint, The altitude of the mountain in meters. Value examples: ['10000', '5000', '3000'].),\n  (country_name:text, The name of the country where the mountain is located. Value examples: ['Nepal', 'Pakistan', 'Nepal'].),\n  (state_name:text, The name of the state or province where the mountain is located (if applicable). Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: river\n[\n  (river_name:text, The name of the river. Names exclude the word 'river' e.g. 'Mississippi' instead of 'Mississippi River'.),\n  (length:bigint, The length of the river in meters.),\n  (country_name:text, The name of the country the river flows through.),\n  (traverse:text, The cities or landmarks the river passes through. Comma delimited and in title case, eg `New York,Albany,Boston`.),\n]\n# Table: state\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas', 'Florida', 'New York'].),\n  (population:bigint, The population of the state. Value examples: ['100000', '50000', '150000', '200000'].),\n  (area:double, The area of the state in square kilometers. Value examples: ['10000', '5000', '15000', '20000'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (capital:text, The name of the capital city of the state. Value examples: ['Sacramento', 'Austin', 'Tallahassee', 'Albany'].),\n  (density:double, The population density of the state in people per square kilometer. Value examples: ['1000', '1000', '1000', '1000'].),\n]\n\n【Foreign keys】\nborder_info.state_name = city.state_name\nborder_info.state_name = lake.state_name\nborder_info.state_name = state.state_name\nborder_info.state_name = highlow.state_name\nborder_info.state_name = mountain.state_name\ncity.country_name = lake.country_name\ncity.country_name = river.country_name\ncity.country_name = state.country_name\ncity.country_name = mountain.country_name\ncity.state_name = highlow.state_name\nhighlow.state_name = lake.state_name\nhighlow.state_name = state.state_name\nhighlow.state_name = mountain.state_name\nlake.country_name = river.country_name\nlake.country_name = state.country_name\nlake.country_name = mountain.country_name\nriver.country_name = state.country_name\nriver.country_name = mountain.country_name\nstate.country_name = mountain.country_name\n\n【参考信息】\n\n\n【用户问题】\nWhat is the average length of rivers in each country?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT river.country_name, AVG(river.length) AS average_length FROM river GROUP BY river.country_name ORDER BY average_length DESC NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "geography",
    "id": 91,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many rivers flow through each country?\n\n【数据库schema】\n【DB_ID】 geography\n【Schema】\n# Table: border_info\n[\n  (state_name:text, The name of the state that shares a border with another state or country.. Value examples: ['California', 'California', 'California', 'Texas'].),\n  (border:text, The name of the state that shares a border with the state specified in the state_name column.. Value examples: ['Nevada', 'Arizona', 'Oregon', 'Louisiana'].),\n]\n# Table: city\n[\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Houston'].),\n  (population:bigint, The population of the city. Value examples: ['1000000', '5000000', '1500000', '2000000'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the city is located. Value examples: ['New York', 'California', 'Illinois', 'Texas'].),\n]\n# Table: highlow\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas'].),\n  (highest_elevation:text, The highest elevation point in the state in meters above sea level. Value examples: ['4421', '2667'].),\n  (lowest_point:text, The lowest elevation point in the state. Value examples: ['Death Valley', 'Gulf of Mexico'].),\n  (highest_point:text, The highest point in the state. If unknown, use 'Unnamed location'.. Value examples: ['Mount Whitney', 'Guadalupe Peak'].),\n  (lowest_elevation:text, The lowest point in the state in meters above sea level. Value examples: ['-86', '0'].),\n]\n# Table: lake\n[\n  (lake_name:text, The name of the lake. Value examples: ['Lake Superior', 'Lake Michigan', 'Lake Huron'].),\n  (area:double, The area of the lake in square kilometers. Value examples: ['1000', '500', '300'].),\n  (country_name:text, The name of the country where the lake is located. Value examples: ['United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the lake is located (if applicable). Value examples: ['Michigan', 'Michigan', 'Michigan'].),\n]\n# Table: mountain\n[\n  (mountain_name:text, The name of the mountain. Value examples: ['Mount Everest', 'K2', 'Kangchenjunga'].),\n  (mountain_altitude:bigint, The altitude of the mountain in meters. Value examples: ['10000', '5000', '3000'].),\n  (country_name:text, The name of the country where the mountain is located. Value examples: ['Nepal', 'Pakistan', 'Nepal'].),\n  (state_name:text, The name of the state or province where the mountain is located (if applicable). Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: river\n[\n  (river_name:text, The name of the river. Names exclude the word 'river' e.g. 'Mississippi' instead of 'Mississippi River'.),\n  (length:bigint, The length of the river in meters.),\n  (country_name:text, The name of the country the river flows through.),\n  (traverse:text, The cities or landmarks the river passes through. Comma delimited and in title case, eg `New York,Albany,Boston`.),\n]\n# Table: state\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas', 'Florida', 'New York'].),\n  (population:bigint, The population of the state. Value examples: ['100000', '50000', '150000', '200000'].),\n  (area:double, The area of the state in square kilometers. Value examples: ['10000', '5000', '15000', '20000'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (capital:text, The name of the capital city of the state. Value examples: ['Sacramento', 'Austin', 'Tallahassee', 'Albany'].),\n  (density:double, The population density of the state in people per square kilometer. Value examples: ['1000', '1000', '1000', '1000'].),\n]\n\n【Foreign keys】\nborder_info.state_name = city.state_name\nborder_info.state_name = lake.state_name\nborder_info.state_name = state.state_name\nborder_info.state_name = highlow.state_name\nborder_info.state_name = mountain.state_name\ncity.country_name = lake.country_name\ncity.country_name = river.country_name\ncity.country_name = state.country_name\ncity.country_name = mountain.country_name\ncity.state_name = highlow.state_name\nhighlow.state_name = lake.state_name\nhighlow.state_name = state.state_name\nhighlow.state_name = mountain.state_name\nlake.country_name = river.country_name\nlake.country_name = state.country_name\nlake.country_name = mountain.country_name\nriver.country_name = state.country_name\nriver.country_name = mountain.country_name\nstate.country_name = mountain.country_name\n\n【参考信息】\n\n\n【用户问题】\nHow many rivers flow through each country?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT river.country_name, COUNT(DISTINCT river.river_name) AS number_of_rivers FROM river GROUP BY river.country_name ORDER BY number_of_rivers DESC;",
        "role": "assistant"
      }
    ],
    "db_name": "geography",
    "id": 92,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many mountains are there in each country?\n\n【数据库schema】\n【DB_ID】 geography\n【Schema】\n# Table: border_info\n[\n  (state_name:text, The name of the state that shares a border with another state or country.. Value examples: ['California', 'California', 'California', 'Texas'].),\n  (border:text, The name of the state that shares a border with the state specified in the state_name column.. Value examples: ['Nevada', 'Arizona', 'Oregon', 'Louisiana'].),\n]\n# Table: city\n[\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Houston'].),\n  (population:bigint, The population of the city. Value examples: ['1000000', '5000000', '1500000', '2000000'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the city is located. Value examples: ['New York', 'California', 'Illinois', 'Texas'].),\n]\n# Table: highlow\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas'].),\n  (highest_elevation:text, The highest elevation point in the state in meters above sea level. Value examples: ['4421', '2667'].),\n  (lowest_point:text, The lowest elevation point in the state. Value examples: ['Death Valley', 'Gulf of Mexico'].),\n  (highest_point:text, The highest point in the state. If unknown, use 'Unnamed location'.. Value examples: ['Mount Whitney', 'Guadalupe Peak'].),\n  (lowest_elevation:text, The lowest point in the state in meters above sea level. Value examples: ['-86', '0'].),\n]\n# Table: lake\n[\n  (lake_name:text, The name of the lake. Value examples: ['Lake Superior', 'Lake Michigan', 'Lake Huron'].),\n  (area:double, The area of the lake in square kilometers. Value examples: ['1000', '500', '300'].),\n  (country_name:text, The name of the country where the lake is located. Value examples: ['United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the lake is located (if applicable). Value examples: ['Michigan', 'Michigan', 'Michigan'].),\n]\n# Table: mountain\n[\n  (mountain_name:text, The name of the mountain. Value examples: ['Mount Everest', 'K2', 'Kangchenjunga'].),\n  (mountain_altitude:bigint, The altitude of the mountain in meters. Value examples: ['10000', '5000', '3000'].),\n  (country_name:text, The name of the country where the mountain is located. Value examples: ['Nepal', 'Pakistan', 'Nepal'].),\n  (state_name:text, The name of the state or province where the mountain is located (if applicable). Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: river\n[\n  (river_name:text, The name of the river. Names exclude the word 'river' e.g. 'Mississippi' instead of 'Mississippi River'.),\n  (length:bigint, The length of the river in meters.),\n  (country_name:text, The name of the country the river flows through.),\n  (traverse:text, The cities or landmarks the river passes through. Comma delimited and in title case, eg `New York,Albany,Boston`.),\n]\n# Table: state\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas', 'Florida', 'New York'].),\n  (population:bigint, The population of the state. Value examples: ['100000', '50000', '150000', '200000'].),\n  (area:double, The area of the state in square kilometers. Value examples: ['10000', '5000', '15000', '20000'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (capital:text, The name of the capital city of the state. Value examples: ['Sacramento', 'Austin', 'Tallahassee', 'Albany'].),\n  (density:double, The population density of the state in people per square kilometer. Value examples: ['1000', '1000', '1000', '1000'].),\n]\n\n【Foreign keys】\nborder_info.state_name = city.state_name\nborder_info.state_name = lake.state_name\nborder_info.state_name = state.state_name\nborder_info.state_name = highlow.state_name\nborder_info.state_name = mountain.state_name\ncity.country_name = lake.country_name\ncity.country_name = river.country_name\ncity.country_name = state.country_name\ncity.country_name = mountain.country_name\ncity.state_name = highlow.state_name\nhighlow.state_name = lake.state_name\nhighlow.state_name = state.state_name\nhighlow.state_name = mountain.state_name\nlake.country_name = river.country_name\nlake.country_name = state.country_name\nlake.country_name = mountain.country_name\nriver.country_name = state.country_name\nriver.country_name = mountain.country_name\nstate.country_name = mountain.country_name\n\n【参考信息】\n\n\n【用户问题】\nHow many mountains are there in each country?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT mountain.country_name, COUNT(mountain.mountain_name) AS number_of_mountains FROM mountain GROUP BY mountain.country_name ORDER BY number_of_mountains DESC;",
        "role": "assistant"
      }
    ],
    "db_name": "geography",
    "id": 93,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many lakes are there in each state?\n\n【数据库schema】\n【DB_ID】 geography\n【Schema】\n# Table: border_info\n[\n  (state_name:text, The name of the state that shares a border with another state or country.. Value examples: ['California', 'California', 'California', 'Texas'].),\n  (border:text, The name of the state that shares a border with the state specified in the state_name column.. Value examples: ['Nevada', 'Arizona', 'Oregon', 'Louisiana'].),\n]\n# Table: city\n[\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Houston'].),\n  (population:bigint, The population of the city. Value examples: ['1000000', '5000000', '1500000', '2000000'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the city is located. Value examples: ['New York', 'California', 'Illinois', 'Texas'].),\n]\n# Table: highlow\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas'].),\n  (highest_elevation:text, The highest elevation point in the state in meters above sea level. Value examples: ['4421', '2667'].),\n  (lowest_point:text, The lowest elevation point in the state. Value examples: ['Death Valley', 'Gulf of Mexico'].),\n  (highest_point:text, The highest point in the state. If unknown, use 'Unnamed location'.. Value examples: ['Mount Whitney', 'Guadalupe Peak'].),\n  (lowest_elevation:text, The lowest point in the state in meters above sea level. Value examples: ['-86', '0'].),\n]\n# Table: lake\n[\n  (lake_name:text, The name of the lake. Value examples: ['Lake Superior', 'Lake Michigan', 'Lake Huron'].),\n  (area:double, The area of the lake in square kilometers. Value examples: ['1000', '500', '300'].),\n  (country_name:text, The name of the country where the lake is located. Value examples: ['United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the lake is located (if applicable). Value examples: ['Michigan', 'Michigan', 'Michigan'].),\n]\n# Table: mountain\n[\n  (mountain_name:text, The name of the mountain. Value examples: ['Mount Everest', 'K2', 'Kangchenjunga'].),\n  (mountain_altitude:bigint, The altitude of the mountain in meters. Value examples: ['10000', '5000', '3000'].),\n  (country_name:text, The name of the country where the mountain is located. Value examples: ['Nepal', 'Pakistan', 'Nepal'].),\n  (state_name:text, The name of the state or province where the mountain is located (if applicable). Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: river\n[\n  (river_name:text, The name of the river. Names exclude the word 'river' e.g. 'Mississippi' instead of 'Mississippi River'.),\n  (length:bigint, The length of the river in meters.),\n  (country_name:text, The name of the country the river flows through.),\n  (traverse:text, The cities or landmarks the river passes through. Comma delimited and in title case, eg `New York,Albany,Boston`.),\n]\n# Table: state\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas', 'Florida', 'New York'].),\n  (population:bigint, The population of the state. Value examples: ['100000', '50000', '150000', '200000'].),\n  (area:double, The area of the state in square kilometers. Value examples: ['10000', '5000', '15000', '20000'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (capital:text, The name of the capital city of the state. Value examples: ['Sacramento', 'Austin', 'Tallahassee', 'Albany'].),\n  (density:double, The population density of the state in people per square kilometer. Value examples: ['1000', '1000', '1000', '1000'].),\n]\n\n【Foreign keys】\nborder_info.state_name = city.state_name\nborder_info.state_name = lake.state_name\nborder_info.state_name = state.state_name\nborder_info.state_name = highlow.state_name\nborder_info.state_name = mountain.state_name\ncity.country_name = lake.country_name\ncity.country_name = river.country_name\ncity.country_name = state.country_name\ncity.country_name = mountain.country_name\ncity.state_name = highlow.state_name\nhighlow.state_name = lake.state_name\nhighlow.state_name = state.state_name\nhighlow.state_name = mountain.state_name\nlake.country_name = river.country_name\nlake.country_name = state.country_name\nlake.country_name = mountain.country_name\nriver.country_name = state.country_name\nriver.country_name = mountain.country_name\nstate.country_name = mountain.country_name\n\n【参考信息】\n\n\n【用户问题】\nHow many lakes are there in each state?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT lake.state_name, COUNT(lake.lake_name) AS lake_count FROM lake GROUP BY lake.state_name ORDER BY lake_count DESC;",
        "role": "assistant"
      }
    ],
    "db_name": "geography",
    "id": 94,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich states have the highest population density in people per square kilometer, ordered from highest to lowest?\n\n【数据库schema】\n【DB_ID】 geography\n【Schema】\n# Table: border_info\n[\n  (state_name:text, The name of the state that shares a border with another state or country.. Value examples: ['California', 'California', 'California', 'Texas'].),\n  (border:text, The name of the state that shares a border with the state specified in the state_name column.. Value examples: ['Nevada', 'Arizona', 'Oregon', 'Louisiana'].),\n]\n# Table: city\n[\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Houston'].),\n  (population:bigint, The population of the city. Value examples: ['1000000', '5000000', '1500000', '2000000'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the city is located. Value examples: ['New York', 'California', 'Illinois', 'Texas'].),\n]\n# Table: highlow\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas'].),\n  (highest_elevation:text, The highest elevation point in the state in meters above sea level. Value examples: ['4421', '2667'].),\n  (lowest_point:text, The lowest elevation point in the state. Value examples: ['Death Valley', 'Gulf of Mexico'].),\n  (highest_point:text, The highest point in the state. If unknown, use 'Unnamed location'.. Value examples: ['Mount Whitney', 'Guadalupe Peak'].),\n  (lowest_elevation:text, The lowest point in the state in meters above sea level. Value examples: ['-86', '0'].),\n]\n# Table: lake\n[\n  (lake_name:text, The name of the lake. Value examples: ['Lake Superior', 'Lake Michigan', 'Lake Huron'].),\n  (area:double, The area of the lake in square kilometers. Value examples: ['1000', '500', '300'].),\n  (country_name:text, The name of the country where the lake is located. Value examples: ['United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the lake is located (if applicable). Value examples: ['Michigan', 'Michigan', 'Michigan'].),\n]\n# Table: mountain\n[\n  (mountain_name:text, The name of the mountain. Value examples: ['Mount Everest', 'K2', 'Kangchenjunga'].),\n  (mountain_altitude:bigint, The altitude of the mountain in meters. Value examples: ['10000', '5000', '3000'].),\n  (country_name:text, The name of the country where the mountain is located. Value examples: ['Nepal', 'Pakistan', 'Nepal'].),\n  (state_name:text, The name of the state or province where the mountain is located (if applicable). Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: river\n[\n  (river_name:text, The name of the river. Names exclude the word 'river' e.g. 'Mississippi' instead of 'Mississippi River'.),\n  (length:bigint, The length of the river in meters.),\n  (country_name:text, The name of the country the river flows through.),\n  (traverse:text, The cities or landmarks the river passes through. Comma delimited and in title case, eg `New York,Albany,Boston`.),\n]\n# Table: state\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas', 'Florida', 'New York'].),\n  (population:bigint, The population of the state. Value examples: ['100000', '50000', '150000', '200000'].),\n  (area:double, The area of the state in square kilometers. Value examples: ['10000', '5000', '15000', '20000'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (capital:text, The name of the capital city of the state. Value examples: ['Sacramento', 'Austin', 'Tallahassee', 'Albany'].),\n  (density:double, The population density of the state in people per square kilometer. Value examples: ['1000', '1000', '1000', '1000'].),\n]\n\n【Foreign keys】\nborder_info.state_name = city.state_name\nborder_info.state_name = lake.state_name\nborder_info.state_name = state.state_name\nborder_info.state_name = highlow.state_name\nborder_info.state_name = mountain.state_name\ncity.country_name = lake.country_name\ncity.country_name = river.country_name\ncity.country_name = state.country_name\ncity.country_name = mountain.country_name\ncity.state_name = highlow.state_name\nhighlow.state_name = lake.state_name\nhighlow.state_name = state.state_name\nhighlow.state_name = mountain.state_name\nlake.country_name = river.country_name\nlake.country_name = state.country_name\nlake.country_name = mountain.country_name\nriver.country_name = state.country_name\nriver.country_name = mountain.country_name\nstate.country_name = mountain.country_name\n\n【参考信息】\n\n\n【用户问题】\nWhich states have the highest population density in people per square kilometer, ordered from highest to lowest?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT state.state_name, state.density FROM state ORDER BY state.density DESC NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "geography",
    "id": 95,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich lakes have the largest areas in square kilometers, ordered from largest to smallest?\n\n【数据库schema】\n【DB_ID】 geography\n【Schema】\n# Table: border_info\n[\n  (state_name:text, The name of the state that shares a border with another state or country.. Value examples: ['California', 'California', 'California', 'Texas'].),\n  (border:text, The name of the state that shares a border with the state specified in the state_name column.. Value examples: ['Nevada', 'Arizona', 'Oregon', 'Louisiana'].),\n]\n# Table: city\n[\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Houston'].),\n  (population:bigint, The population of the city. Value examples: ['1000000', '5000000', '1500000', '2000000'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the city is located. Value examples: ['New York', 'California', 'Illinois', 'Texas'].),\n]\n# Table: highlow\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas'].),\n  (highest_elevation:text, The highest elevation point in the state in meters above sea level. Value examples: ['4421', '2667'].),\n  (lowest_point:text, The lowest elevation point in the state. Value examples: ['Death Valley', 'Gulf of Mexico'].),\n  (highest_point:text, The highest point in the state. If unknown, use 'Unnamed location'.. Value examples: ['Mount Whitney', 'Guadalupe Peak'].),\n  (lowest_elevation:text, The lowest point in the state in meters above sea level. Value examples: ['-86', '0'].),\n]\n# Table: lake\n[\n  (lake_name:text, The name of the lake. Value examples: ['Lake Superior', 'Lake Michigan', 'Lake Huron'].),\n  (area:double, The area of the lake in square kilometers. Value examples: ['1000', '500', '300'].),\n  (country_name:text, The name of the country where the lake is located. Value examples: ['United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the lake is located (if applicable). Value examples: ['Michigan', 'Michigan', 'Michigan'].),\n]\n# Table: mountain\n[\n  (mountain_name:text, The name of the mountain. Value examples: ['Mount Everest', 'K2', 'Kangchenjunga'].),\n  (mountain_altitude:bigint, The altitude of the mountain in meters. Value examples: ['10000', '5000', '3000'].),\n  (country_name:text, The name of the country where the mountain is located. Value examples: ['Nepal', 'Pakistan', 'Nepal'].),\n  (state_name:text, The name of the state or province where the mountain is located (if applicable). Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: river\n[\n  (river_name:text, The name of the river. Names exclude the word 'river' e.g. 'Mississippi' instead of 'Mississippi River'.),\n  (length:bigint, The length of the river in meters.),\n  (country_name:text, The name of the country the river flows through.),\n  (traverse:text, The cities or landmarks the river passes through. Comma delimited and in title case, eg `New York,Albany,Boston`.),\n]\n# Table: state\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas', 'Florida', 'New York'].),\n  (population:bigint, The population of the state. Value examples: ['100000', '50000', '150000', '200000'].),\n  (area:double, The area of the state in square kilometers. Value examples: ['10000', '5000', '15000', '20000'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (capital:text, The name of the capital city of the state. Value examples: ['Sacramento', 'Austin', 'Tallahassee', 'Albany'].),\n  (density:double, The population density of the state in people per square kilometer. Value examples: ['1000', '1000', '1000', '1000'].),\n]\n\n【Foreign keys】\nborder_info.state_name = city.state_name\nborder_info.state_name = lake.state_name\nborder_info.state_name = state.state_name\nborder_info.state_name = highlow.state_name\nborder_info.state_name = mountain.state_name\ncity.country_name = lake.country_name\ncity.country_name = river.country_name\ncity.country_name = state.country_name\ncity.country_name = mountain.country_name\ncity.state_name = highlow.state_name\nhighlow.state_name = lake.state_name\nhighlow.state_name = state.state_name\nhighlow.state_name = mountain.state_name\nlake.country_name = river.country_name\nlake.country_name = state.country_name\nlake.country_name = mountain.country_name\nriver.country_name = state.country_name\nriver.country_name = mountain.country_name\nstate.country_name = mountain.country_name\n\n【参考信息】\n\n\n【用户问题】\nWhich lakes have the largest areas in square kilometers, ordered from largest to smallest?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT lake.lake_name, lake.area FROM lake ORDER BY lake.area DESC NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "geography",
    "id": 96,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the top 5 cities with the highest population? Give both city names and the population.\n\n【数据库schema】\n【DB_ID】 geography\n【Schema】\n# Table: border_info\n[\n  (state_name:text, The name of the state that shares a border with another state or country.. Value examples: ['California', 'California', 'California', 'Texas'].),\n  (border:text, The name of the state that shares a border with the state specified in the state_name column.. Value examples: ['Nevada', 'Arizona', 'Oregon', 'Louisiana'].),\n]\n# Table: city\n[\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Houston'].),\n  (population:bigint, The population of the city. Value examples: ['1000000', '5000000', '1500000', '2000000'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the city is located. Value examples: ['New York', 'California', 'Illinois', 'Texas'].),\n]\n# Table: highlow\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas'].),\n  (highest_elevation:text, The highest elevation point in the state in meters above sea level. Value examples: ['4421', '2667'].),\n  (lowest_point:text, The lowest elevation point in the state. Value examples: ['Death Valley', 'Gulf of Mexico'].),\n  (highest_point:text, The highest point in the state. If unknown, use 'Unnamed location'.. Value examples: ['Mount Whitney', 'Guadalupe Peak'].),\n  (lowest_elevation:text, The lowest point in the state in meters above sea level. Value examples: ['-86', '0'].),\n]\n# Table: lake\n[\n  (lake_name:text, The name of the lake. Value examples: ['Lake Superior', 'Lake Michigan', 'Lake Huron'].),\n  (area:double, The area of the lake in square kilometers. Value examples: ['1000', '500', '300'].),\n  (country_name:text, The name of the country where the lake is located. Value examples: ['United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the lake is located (if applicable). Value examples: ['Michigan', 'Michigan', 'Michigan'].),\n]\n# Table: mountain\n[\n  (mountain_name:text, The name of the mountain. Value examples: ['Mount Everest', 'K2', 'Kangchenjunga'].),\n  (mountain_altitude:bigint, The altitude of the mountain in meters. Value examples: ['10000', '5000', '3000'].),\n  (country_name:text, The name of the country where the mountain is located. Value examples: ['Nepal', 'Pakistan', 'Nepal'].),\n  (state_name:text, The name of the state or province where the mountain is located (if applicable). Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: river\n[\n  (river_name:text, The name of the river. Names exclude the word 'river' e.g. 'Mississippi' instead of 'Mississippi River'.),\n  (length:bigint, The length of the river in meters.),\n  (country_name:text, The name of the country the river flows through.),\n  (traverse:text, The cities or landmarks the river passes through. Comma delimited and in title case, eg `New York,Albany,Boston`.),\n]\n# Table: state\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas', 'Florida', 'New York'].),\n  (population:bigint, The population of the state. Value examples: ['100000', '50000', '150000', '200000'].),\n  (area:double, The area of the state in square kilometers. Value examples: ['10000', '5000', '15000', '20000'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (capital:text, The name of the capital city of the state. Value examples: ['Sacramento', 'Austin', 'Tallahassee', 'Albany'].),\n  (density:double, The population density of the state in people per square kilometer. Value examples: ['1000', '1000', '1000', '1000'].),\n]\n\n【Foreign keys】\nborder_info.state_name = city.state_name\nborder_info.state_name = lake.state_name\nborder_info.state_name = state.state_name\nborder_info.state_name = highlow.state_name\nborder_info.state_name = mountain.state_name\ncity.country_name = lake.country_name\ncity.country_name = river.country_name\ncity.country_name = state.country_name\ncity.country_name = mountain.country_name\ncity.state_name = highlow.state_name\nhighlow.state_name = lake.state_name\nhighlow.state_name = state.state_name\nhighlow.state_name = mountain.state_name\nlake.country_name = river.country_name\nlake.country_name = state.country_name\nlake.country_name = mountain.country_name\nriver.country_name = state.country_name\nriver.country_name = mountain.country_name\nstate.country_name = mountain.country_name\n\n【参考信息】\n\n\n【用户问题】\nWhat are the top 5 cities with the highest population? Give both city names and the population.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT city.city_name, city.population FROM city ORDER BY city.population DESC NULLS LAST LIMIT 5;",
        "role": "assistant"
      }
    ],
    "db_name": "geography",
    "id": 97,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the longest rivers in meters, ordered from longest to shortest?\n\n【数据库schema】\n【DB_ID】 geography\n【Schema】\n# Table: border_info\n[\n  (state_name:text, The name of the state that shares a border with another state or country.. Value examples: ['California', 'California', 'California', 'Texas'].),\n  (border:text, The name of the state that shares a border with the state specified in the state_name column.. Value examples: ['Nevada', 'Arizona', 'Oregon', 'Louisiana'].),\n]\n# Table: city\n[\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Houston'].),\n  (population:bigint, The population of the city. Value examples: ['1000000', '5000000', '1500000', '2000000'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the city is located. Value examples: ['New York', 'California', 'Illinois', 'Texas'].),\n]\n# Table: highlow\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas'].),\n  (highest_elevation:text, The highest elevation point in the state in meters above sea level. Value examples: ['4421', '2667'].),\n  (lowest_point:text, The lowest elevation point in the state. Value examples: ['Death Valley', 'Gulf of Mexico'].),\n  (highest_point:text, The highest point in the state. If unknown, use 'Unnamed location'.. Value examples: ['Mount Whitney', 'Guadalupe Peak'].),\n  (lowest_elevation:text, The lowest point in the state in meters above sea level. Value examples: ['-86', '0'].),\n]\n# Table: lake\n[\n  (lake_name:text, The name of the lake. Value examples: ['Lake Superior', 'Lake Michigan', 'Lake Huron'].),\n  (area:double, The area of the lake in square kilometers. Value examples: ['1000', '500', '300'].),\n  (country_name:text, The name of the country where the lake is located. Value examples: ['United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the lake is located (if applicable). Value examples: ['Michigan', 'Michigan', 'Michigan'].),\n]\n# Table: mountain\n[\n  (mountain_name:text, The name of the mountain. Value examples: ['Mount Everest', 'K2', 'Kangchenjunga'].),\n  (mountain_altitude:bigint, The altitude of the mountain in meters. Value examples: ['10000', '5000', '3000'].),\n  (country_name:text, The name of the country where the mountain is located. Value examples: ['Nepal', 'Pakistan', 'Nepal'].),\n  (state_name:text, The name of the state or province where the mountain is located (if applicable). Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: river\n[\n  (river_name:text, The name of the river. Names exclude the word 'river' e.g. 'Mississippi' instead of 'Mississippi River'.),\n  (length:bigint, The length of the river in meters.),\n  (country_name:text, The name of the country the river flows through.),\n  (traverse:text, The cities or landmarks the river passes through. Comma delimited and in title case, eg `New York,Albany,Boston`.),\n]\n# Table: state\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas', 'Florida', 'New York'].),\n  (population:bigint, The population of the state. Value examples: ['100000', '50000', '150000', '200000'].),\n  (area:double, The area of the state in square kilometers. Value examples: ['10000', '5000', '15000', '20000'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (capital:text, The name of the capital city of the state. Value examples: ['Sacramento', 'Austin', 'Tallahassee', 'Albany'].),\n  (density:double, The population density of the state in people per square kilometer. Value examples: ['1000', '1000', '1000', '1000'].),\n]\n\n【Foreign keys】\nborder_info.state_name = city.state_name\nborder_info.state_name = lake.state_name\nborder_info.state_name = state.state_name\nborder_info.state_name = highlow.state_name\nborder_info.state_name = mountain.state_name\ncity.country_name = lake.country_name\ncity.country_name = river.country_name\ncity.country_name = state.country_name\ncity.country_name = mountain.country_name\ncity.state_name = highlow.state_name\nhighlow.state_name = lake.state_name\nhighlow.state_name = state.state_name\nhighlow.state_name = mountain.state_name\nlake.country_name = river.country_name\nlake.country_name = state.country_name\nlake.country_name = mountain.country_name\nriver.country_name = state.country_name\nriver.country_name = mountain.country_name\nstate.country_name = mountain.country_name\n\n【参考信息】\n\n\n【用户问题】\nWhat are the longest rivers in meters, ordered from longest to shortest?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT river.river_name, river.length FROM river ORDER BY river.length DESC NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "geography",
    "id": 98,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the highest mountains in meters, ordered from highest to lowest altitude?\n\n【数据库schema】\n【DB_ID】 geography\n【Schema】\n# Table: border_info\n[\n  (state_name:text, The name of the state that shares a border with another state or country.. Value examples: ['California', 'California', 'California', 'Texas'].),\n  (border:text, The name of the state that shares a border with the state specified in the state_name column.. Value examples: ['Nevada', 'Arizona', 'Oregon', 'Louisiana'].),\n]\n# Table: city\n[\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Houston'].),\n  (population:bigint, The population of the city. Value examples: ['1000000', '5000000', '1500000', '2000000'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the city is located. Value examples: ['New York', 'California', 'Illinois', 'Texas'].),\n]\n# Table: highlow\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas'].),\n  (highest_elevation:text, The highest elevation point in the state in meters above sea level. Value examples: ['4421', '2667'].),\n  (lowest_point:text, The lowest elevation point in the state. Value examples: ['Death Valley', 'Gulf of Mexico'].),\n  (highest_point:text, The highest point in the state. If unknown, use 'Unnamed location'.. Value examples: ['Mount Whitney', 'Guadalupe Peak'].),\n  (lowest_elevation:text, The lowest point in the state in meters above sea level. Value examples: ['-86', '0'].),\n]\n# Table: lake\n[\n  (lake_name:text, The name of the lake. Value examples: ['Lake Superior', 'Lake Michigan', 'Lake Huron'].),\n  (area:double, The area of the lake in square kilometers. Value examples: ['1000', '500', '300'].),\n  (country_name:text, The name of the country where the lake is located. Value examples: ['United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the lake is located (if applicable). Value examples: ['Michigan', 'Michigan', 'Michigan'].),\n]\n# Table: mountain\n[\n  (mountain_name:text, The name of the mountain. Value examples: ['Mount Everest', 'K2', 'Kangchenjunga'].),\n  (mountain_altitude:bigint, The altitude of the mountain in meters. Value examples: ['10000', '5000', '3000'].),\n  (country_name:text, The name of the country where the mountain is located. Value examples: ['Nepal', 'Pakistan', 'Nepal'].),\n  (state_name:text, The name of the state or province where the mountain is located (if applicable). Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: river\n[\n  (river_name:text, The name of the river. Names exclude the word 'river' e.g. 'Mississippi' instead of 'Mississippi River'.),\n  (length:bigint, The length of the river in meters.),\n  (country_name:text, The name of the country the river flows through.),\n  (traverse:text, The cities or landmarks the river passes through. Comma delimited and in title case, eg `New York,Albany,Boston`.),\n]\n# Table: state\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas', 'Florida', 'New York'].),\n  (population:bigint, The population of the state. Value examples: ['100000', '50000', '150000', '200000'].),\n  (area:double, The area of the state in square kilometers. Value examples: ['10000', '5000', '15000', '20000'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (capital:text, The name of the capital city of the state. Value examples: ['Sacramento', 'Austin', 'Tallahassee', 'Albany'].),\n  (density:double, The population density of the state in people per square kilometer. Value examples: ['1000', '1000', '1000', '1000'].),\n]\n\n【Foreign keys】\nborder_info.state_name = city.state_name\nborder_info.state_name = lake.state_name\nborder_info.state_name = state.state_name\nborder_info.state_name = highlow.state_name\nborder_info.state_name = mountain.state_name\ncity.country_name = lake.country_name\ncity.country_name = river.country_name\ncity.country_name = state.country_name\ncity.country_name = mountain.country_name\ncity.state_name = highlow.state_name\nhighlow.state_name = lake.state_name\nhighlow.state_name = state.state_name\nhighlow.state_name = mountain.state_name\nlake.country_name = river.country_name\nlake.country_name = state.country_name\nlake.country_name = mountain.country_name\nriver.country_name = state.country_name\nriver.country_name = mountain.country_name\nstate.country_name = mountain.country_name\n\n【参考信息】\n\n\n【用户问题】\nWhat are the highest mountains in meters, ordered from highest to lowest altitude?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT mountain.mountain_name, mountain.mountain_altitude FROM mountain ORDER BY mountain.mountain_altitude DESC NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "geography",
    "id": 99,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the ratio of the population of the United States to the population of California?\n\n【数据库schema】\n【DB_ID】 geography\n【Schema】\n# Table: border_info\n[\n  (state_name:text, The name of the state that shares a border with another state or country.. Value examples: ['California', 'California', 'California', 'Texas'].),\n  (border:text, The name of the state that shares a border with the state specified in the state_name column.. Value examples: ['Nevada', 'Arizona', 'Oregon', 'Louisiana'].),\n]\n# Table: city\n[\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Houston'].),\n  (population:bigint, The population of the city. Value examples: ['1000000', '5000000', '1500000', '2000000'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the city is located. Value examples: ['New York', 'California', 'Illinois', 'Texas'].),\n]\n# Table: highlow\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas'].),\n  (highest_elevation:text, The highest elevation point in the state in meters above sea level. Value examples: ['4421', '2667'].),\n  (lowest_point:text, The lowest elevation point in the state. Value examples: ['Death Valley', 'Gulf of Mexico'].),\n  (highest_point:text, The highest point in the state. If unknown, use 'Unnamed location'.. Value examples: ['Mount Whitney', 'Guadalupe Peak'].),\n  (lowest_elevation:text, The lowest point in the state in meters above sea level. Value examples: ['-86', '0'].),\n]\n# Table: lake\n[\n  (lake_name:text, The name of the lake. Value examples: ['Lake Superior', 'Lake Michigan', 'Lake Huron'].),\n  (area:double, The area of the lake in square kilometers. Value examples: ['1000', '500', '300'].),\n  (country_name:text, The name of the country where the lake is located. Value examples: ['United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the lake is located (if applicable). Value examples: ['Michigan', 'Michigan', 'Michigan'].),\n]\n# Table: mountain\n[\n  (mountain_name:text, The name of the mountain. Value examples: ['Mount Everest', 'K2', 'Kangchenjunga'].),\n  (mountain_altitude:bigint, The altitude of the mountain in meters. Value examples: ['10000', '5000', '3000'].),\n  (country_name:text, The name of the country where the mountain is located. Value examples: ['Nepal', 'Pakistan', 'Nepal'].),\n  (state_name:text, The name of the state or province where the mountain is located (if applicable). Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: river\n[\n  (river_name:text, The name of the river. Names exclude the word 'river' e.g. 'Mississippi' instead of 'Mississippi River'.),\n  (length:bigint, The length of the river in meters.),\n  (country_name:text, The name of the country the river flows through.),\n  (traverse:text, The cities or landmarks the river passes through. Comma delimited and in title case, eg `New York,Albany,Boston`.),\n]\n# Table: state\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas', 'Florida', 'New York'].),\n  (population:bigint, The population of the state. Value examples: ['100000', '50000', '150000', '200000'].),\n  (area:double, The area of the state in square kilometers. Value examples: ['10000', '5000', '15000', '20000'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (capital:text, The name of the capital city of the state. Value examples: ['Sacramento', 'Austin', 'Tallahassee', 'Albany'].),\n  (density:double, The population density of the state in people per square kilometer. Value examples: ['1000', '1000', '1000', '1000'].),\n]\n\n【Foreign keys】\nborder_info.state_name = city.state_name\nborder_info.state_name = lake.state_name\nborder_info.state_name = state.state_name\nborder_info.state_name = highlow.state_name\nborder_info.state_name = mountain.state_name\ncity.country_name = lake.country_name\ncity.country_name = river.country_name\ncity.country_name = state.country_name\ncity.country_name = mountain.country_name\ncity.state_name = highlow.state_name\nhighlow.state_name = lake.state_name\nhighlow.state_name = state.state_name\nhighlow.state_name = mountain.state_name\nlake.country_name = river.country_name\nlake.country_name = state.country_name\nlake.country_name = mountain.country_name\nriver.country_name = state.country_name\nriver.country_name = mountain.country_name\nstate.country_name = mountain.country_name\n\n【参考信息】\n\n\n【用户问题】\nWhat is the ratio of the population of the United States to the population of California?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT CAST(SUM(NULLIF(state.population, 0)) FILTER (WHERE LOWER(state.country_name) LIKE '%united states%') AS FLOAT) / CAST(SUM(NULLIF(state.population, 0)) FILTER (WHERE LOWER(state.state_name) LIKE '%california%') AS FLOAT) AS population_ratio FROM state;",
        "role": "assistant"
      }
    ],
    "db_name": "geography",
    "id": 100,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the ratio of the length of the Mississippi River to the length of the Rhine River?\n\n【数据库schema】\n【DB_ID】 geography\n【Schema】\n# Table: border_info\n[\n  (state_name:text, The name of the state that shares a border with another state or country.. Value examples: ['California', 'California', 'California', 'Texas'].),\n  (border:text, The name of the state that shares a border with the state specified in the state_name column.. Value examples: ['Nevada', 'Arizona', 'Oregon', 'Louisiana'].),\n]\n# Table: city\n[\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Houston'].),\n  (population:bigint, The population of the city. Value examples: ['1000000', '5000000', '1500000', '2000000'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the city is located. Value examples: ['New York', 'California', 'Illinois', 'Texas'].),\n]\n# Table: highlow\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas'].),\n  (highest_elevation:text, The highest elevation point in the state in meters above sea level. Value examples: ['4421', '2667'].),\n  (lowest_point:text, The lowest elevation point in the state. Value examples: ['Death Valley', 'Gulf of Mexico'].),\n  (highest_point:text, The highest point in the state. If unknown, use 'Unnamed location'.. Value examples: ['Mount Whitney', 'Guadalupe Peak'].),\n  (lowest_elevation:text, The lowest point in the state in meters above sea level. Value examples: ['-86', '0'].),\n]\n# Table: lake\n[\n  (lake_name:text, The name of the lake. Value examples: ['Lake Superior', 'Lake Michigan', 'Lake Huron'].),\n  (area:double, The area of the lake in square kilometers. Value examples: ['1000', '500', '300'].),\n  (country_name:text, The name of the country where the lake is located. Value examples: ['United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the lake is located (if applicable). Value examples: ['Michigan', 'Michigan', 'Michigan'].),\n]\n# Table: mountain\n[\n  (mountain_name:text, The name of the mountain. Value examples: ['Mount Everest', 'K2', 'Kangchenjunga'].),\n  (mountain_altitude:bigint, The altitude of the mountain in meters. Value examples: ['10000', '5000', '3000'].),\n  (country_name:text, The name of the country where the mountain is located. Value examples: ['Nepal', 'Pakistan', 'Nepal'].),\n  (state_name:text, The name of the state or province where the mountain is located (if applicable). Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: river\n[\n  (river_name:text, The name of the river. Names exclude the word 'river' e.g. 'Mississippi' instead of 'Mississippi River'.),\n  (length:bigint, The length of the river in meters.),\n  (country_name:text, The name of the country the river flows through.),\n  (traverse:text, The cities or landmarks the river passes through. Comma delimited and in title case, eg `New York,Albany,Boston`.),\n]\n# Table: state\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas', 'Florida', 'New York'].),\n  (population:bigint, The population of the state. Value examples: ['100000', '50000', '150000', '200000'].),\n  (area:double, The area of the state in square kilometers. Value examples: ['10000', '5000', '15000', '20000'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (capital:text, The name of the capital city of the state. Value examples: ['Sacramento', 'Austin', 'Tallahassee', 'Albany'].),\n  (density:double, The population density of the state in people per square kilometer. Value examples: ['1000', '1000', '1000', '1000'].),\n]\n\n【Foreign keys】\nborder_info.state_name = city.state_name\nborder_info.state_name = lake.state_name\nborder_info.state_name = state.state_name\nborder_info.state_name = highlow.state_name\nborder_info.state_name = mountain.state_name\ncity.country_name = lake.country_name\ncity.country_name = river.country_name\ncity.country_name = state.country_name\ncity.country_name = mountain.country_name\ncity.state_name = highlow.state_name\nhighlow.state_name = lake.state_name\nhighlow.state_name = state.state_name\nhighlow.state_name = mountain.state_name\nlake.country_name = river.country_name\nlake.country_name = state.country_name\nlake.country_name = mountain.country_name\nriver.country_name = state.country_name\nriver.country_name = mountain.country_name\nstate.country_name = mountain.country_name\n\n【参考信息】\n\n\n【用户问题】\nWhat is the ratio of the length of the Mississippi River to the length of the Rhine River?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT CAST((SELECT length FROM river WHERE LOWER(river_name) LIKE '%mississippi%') AS FLOAT) / NULLIF((SELECT length FROM river WHERE LOWER(river_name) LIKE '%rhine%'), 0) AS ratio ;",
        "role": "assistant"
      }
    ],
    "db_name": "geography",
    "id": 101,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the ratio of the altitude of 'Mount Everest' to the altitude of 'Dhaulagiri'? Match strings exactly\n\n【数据库schema】\n【DB_ID】 geography\n【Schema】\n# Table: border_info\n[\n  (state_name:text, The name of the state that shares a border with another state or country.. Value examples: ['California', 'California', 'California', 'Texas'].),\n  (border:text, The name of the state that shares a border with the state specified in the state_name column.. Value examples: ['Nevada', 'Arizona', 'Oregon', 'Louisiana'].),\n]\n# Table: city\n[\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Houston'].),\n  (population:bigint, The population of the city. Value examples: ['1000000', '5000000', '1500000', '2000000'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the city is located. Value examples: ['New York', 'California', 'Illinois', 'Texas'].),\n]\n# Table: highlow\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas'].),\n  (highest_elevation:text, The highest elevation point in the state in meters above sea level. Value examples: ['4421', '2667'].),\n  (lowest_point:text, The lowest elevation point in the state. Value examples: ['Death Valley', 'Gulf of Mexico'].),\n  (highest_point:text, The highest point in the state. If unknown, use 'Unnamed location'.. Value examples: ['Mount Whitney', 'Guadalupe Peak'].),\n  (lowest_elevation:text, The lowest point in the state in meters above sea level. Value examples: ['-86', '0'].),\n]\n# Table: lake\n[\n  (lake_name:text, The name of the lake. Value examples: ['Lake Superior', 'Lake Michigan', 'Lake Huron'].),\n  (area:double, The area of the lake in square kilometers. Value examples: ['1000', '500', '300'].),\n  (country_name:text, The name of the country where the lake is located. Value examples: ['United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the lake is located (if applicable). Value examples: ['Michigan', 'Michigan', 'Michigan'].),\n]\n# Table: mountain\n[\n  (mountain_name:text, The name of the mountain. Value examples: ['Mount Everest', 'K2', 'Kangchenjunga'].),\n  (mountain_altitude:bigint, The altitude of the mountain in meters. Value examples: ['10000', '5000', '3000'].),\n  (country_name:text, The name of the country where the mountain is located. Value examples: ['Nepal', 'Pakistan', 'Nepal'].),\n  (state_name:text, The name of the state or province where the mountain is located (if applicable). Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: river\n[\n  (river_name:text, The name of the river. Names exclude the word 'river' e.g. 'Mississippi' instead of 'Mississippi River'.),\n  (length:bigint, The length of the river in meters.),\n  (country_name:text, The name of the country the river flows through.),\n  (traverse:text, The cities or landmarks the river passes through. Comma delimited and in title case, eg `New York,Albany,Boston`.),\n]\n# Table: state\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas', 'Florida', 'New York'].),\n  (population:bigint, The population of the state. Value examples: ['100000', '50000', '150000', '200000'].),\n  (area:double, The area of the state in square kilometers. Value examples: ['10000', '5000', '15000', '20000'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (capital:text, The name of the capital city of the state. Value examples: ['Sacramento', 'Austin', 'Tallahassee', 'Albany'].),\n  (density:double, The population density of the state in people per square kilometer. Value examples: ['1000', '1000', '1000', '1000'].),\n]\n\n【Foreign keys】\nborder_info.state_name = city.state_name\nborder_info.state_name = lake.state_name\nborder_info.state_name = state.state_name\nborder_info.state_name = highlow.state_name\nborder_info.state_name = mountain.state_name\ncity.country_name = lake.country_name\ncity.country_name = river.country_name\ncity.country_name = state.country_name\ncity.country_name = mountain.country_name\ncity.state_name = highlow.state_name\nhighlow.state_name = lake.state_name\nhighlow.state_name = state.state_name\nhighlow.state_name = mountain.state_name\nlake.country_name = river.country_name\nlake.country_name = state.country_name\nlake.country_name = mountain.country_name\nriver.country_name = state.country_name\nriver.country_name = mountain.country_name\nstate.country_name = mountain.country_name\n\n【参考信息】\n\n\n【用户问题】\nWhat is the ratio of the altitude of 'Mount Everest' to the altitude of 'Dhaulagiri'? Match strings exactly\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT (CAST(everest.mountain_altitude AS FLOAT) / NULLIF(dhaulagiri.mountain_altitude, 0)) AS altitude_ratio FROM (SELECT mountain_altitude FROM mountain WHERE mountain_name = 'Mount Everest') AS everest, (SELECT mountain_altitude FROM mountain WHERE mountain_name = 'Dhaulagiri') AS dhaulagiri;",
        "role": "assistant"
      }
    ],
    "db_name": "geography",
    "id": 102,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow does the population of each city vary in relation to the population of its corresponding state? Return the city name, and the proportion of each city's population relative to the state.\n\n【数据库schema】\n【DB_ID】 geography\n【Schema】\n# Table: border_info\n[\n  (state_name:text, The name of the state that shares a border with another state or country.. Value examples: ['California', 'California', 'California', 'Texas'].),\n  (border:text, The name of the state that shares a border with the state specified in the state_name column.. Value examples: ['Nevada', 'Arizona', 'Oregon', 'Louisiana'].),\n]\n# Table: city\n[\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Houston'].),\n  (population:bigint, The population of the city. Value examples: ['1000000', '5000000', '1500000', '2000000'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the city is located. Value examples: ['New York', 'California', 'Illinois', 'Texas'].),\n]\n# Table: highlow\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas'].),\n  (highest_elevation:text, The highest elevation point in the state in meters above sea level. Value examples: ['4421', '2667'].),\n  (lowest_point:text, The lowest elevation point in the state. Value examples: ['Death Valley', 'Gulf of Mexico'].),\n  (highest_point:text, The highest point in the state. If unknown, use 'Unnamed location'.. Value examples: ['Mount Whitney', 'Guadalupe Peak'].),\n  (lowest_elevation:text, The lowest point in the state in meters above sea level. Value examples: ['-86', '0'].),\n]\n# Table: lake\n[\n  (lake_name:text, The name of the lake. Value examples: ['Lake Superior', 'Lake Michigan', 'Lake Huron'].),\n  (area:double, The area of the lake in square kilometers. Value examples: ['1000', '500', '300'].),\n  (country_name:text, The name of the country where the lake is located. Value examples: ['United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the lake is located (if applicable). Value examples: ['Michigan', 'Michigan', 'Michigan'].),\n]\n# Table: mountain\n[\n  (mountain_name:text, The name of the mountain. Value examples: ['Mount Everest', 'K2', 'Kangchenjunga'].),\n  (mountain_altitude:bigint, The altitude of the mountain in meters. Value examples: ['10000', '5000', '3000'].),\n  (country_name:text, The name of the country where the mountain is located. Value examples: ['Nepal', 'Pakistan', 'Nepal'].),\n  (state_name:text, The name of the state or province where the mountain is located (if applicable). Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: river\n[\n  (river_name:text, The name of the river. Names exclude the word 'river' e.g. 'Mississippi' instead of 'Mississippi River'.),\n  (length:bigint, The length of the river in meters.),\n  (country_name:text, The name of the country the river flows through.),\n  (traverse:text, The cities or landmarks the river passes through. Comma delimited and in title case, eg `New York,Albany,Boston`.),\n]\n# Table: state\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas', 'Florida', 'New York'].),\n  (population:bigint, The population of the state. Value examples: ['100000', '50000', '150000', '200000'].),\n  (area:double, The area of the state in square kilometers. Value examples: ['10000', '5000', '15000', '20000'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (capital:text, The name of the capital city of the state. Value examples: ['Sacramento', 'Austin', 'Tallahassee', 'Albany'].),\n  (density:double, The population density of the state in people per square kilometer. Value examples: ['1000', '1000', '1000', '1000'].),\n]\n\n【Foreign keys】\nborder_info.state_name = city.state_name\nborder_info.state_name = lake.state_name\nborder_info.state_name = state.state_name\nborder_info.state_name = highlow.state_name\nborder_info.state_name = mountain.state_name\ncity.country_name = lake.country_name\ncity.country_name = river.country_name\ncity.country_name = state.country_name\ncity.country_name = mountain.country_name\ncity.state_name = highlow.state_name\nhighlow.state_name = lake.state_name\nhighlow.state_name = state.state_name\nhighlow.state_name = mountain.state_name\nlake.country_name = river.country_name\nlake.country_name = state.country_name\nlake.country_name = mountain.country_name\nriver.country_name = state.country_name\nriver.country_name = mountain.country_name\nstate.country_name = mountain.country_name\n\n【参考信息】\n\n\n【用户问题】\nHow does the population of each city vary in relation to the population of its corresponding state? Return the city name, and the proportion of each city's population relative to the state.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT city.city_name, CAST(city.population AS float) / NULLIF(state.population, 0) AS population_ratio FROM city JOIN state ON city.state_name = state.state_name ORDER BY population_ratio DESC NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "geography",
    "id": 103,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nGet the ratio of population per area for each state\n\n【数据库schema】\n【DB_ID】 geography\n【Schema】\n# Table: border_info\n[\n  (state_name:text, The name of the state that shares a border with another state or country.. Value examples: ['California', 'California', 'California', 'Texas'].),\n  (border:text, The name of the state that shares a border with the state specified in the state_name column.. Value examples: ['Nevada', 'Arizona', 'Oregon', 'Louisiana'].),\n]\n# Table: city\n[\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Houston'].),\n  (population:bigint, The population of the city. Value examples: ['1000000', '5000000', '1500000', '2000000'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the city is located. Value examples: ['New York', 'California', 'Illinois', 'Texas'].),\n]\n# Table: highlow\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas'].),\n  (highest_elevation:text, The highest elevation point in the state in meters above sea level. Value examples: ['4421', '2667'].),\n  (lowest_point:text, The lowest elevation point in the state. Value examples: ['Death Valley', 'Gulf of Mexico'].),\n  (highest_point:text, The highest point in the state. If unknown, use 'Unnamed location'.. Value examples: ['Mount Whitney', 'Guadalupe Peak'].),\n  (lowest_elevation:text, The lowest point in the state in meters above sea level. Value examples: ['-86', '0'].),\n]\n# Table: lake\n[\n  (lake_name:text, The name of the lake. Value examples: ['Lake Superior', 'Lake Michigan', 'Lake Huron'].),\n  (area:double, The area of the lake in square kilometers. Value examples: ['1000', '500', '300'].),\n  (country_name:text, The name of the country where the lake is located. Value examples: ['United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the lake is located (if applicable). Value examples: ['Michigan', 'Michigan', 'Michigan'].),\n]\n# Table: mountain\n[\n  (mountain_name:text, The name of the mountain. Value examples: ['Mount Everest', 'K2', 'Kangchenjunga'].),\n  (mountain_altitude:bigint, The altitude of the mountain in meters. Value examples: ['10000', '5000', '3000'].),\n  (country_name:text, The name of the country where the mountain is located. Value examples: ['Nepal', 'Pakistan', 'Nepal'].),\n  (state_name:text, The name of the state or province where the mountain is located (if applicable). Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: river\n[\n  (river_name:text, The name of the river. Names exclude the word 'river' e.g. 'Mississippi' instead of 'Mississippi River'.),\n  (length:bigint, The length of the river in meters.),\n  (country_name:text, The name of the country the river flows through.),\n  (traverse:text, The cities or landmarks the river passes through. Comma delimited and in title case, eg `New York,Albany,Boston`.),\n]\n# Table: state\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas', 'Florida', 'New York'].),\n  (population:bigint, The population of the state. Value examples: ['100000', '50000', '150000', '200000'].),\n  (area:double, The area of the state in square kilometers. Value examples: ['10000', '5000', '15000', '20000'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (capital:text, The name of the capital city of the state. Value examples: ['Sacramento', 'Austin', 'Tallahassee', 'Albany'].),\n  (density:double, The population density of the state in people per square kilometer. Value examples: ['1000', '1000', '1000', '1000'].),\n]\n\n【Foreign keys】\nborder_info.state_name = city.state_name\nborder_info.state_name = lake.state_name\nborder_info.state_name = state.state_name\nborder_info.state_name = highlow.state_name\nborder_info.state_name = mountain.state_name\ncity.country_name = lake.country_name\ncity.country_name = river.country_name\ncity.country_name = state.country_name\ncity.country_name = mountain.country_name\ncity.state_name = highlow.state_name\nhighlow.state_name = lake.state_name\nhighlow.state_name = state.state_name\nhighlow.state_name = mountain.state_name\nlake.country_name = river.country_name\nlake.country_name = state.country_name\nlake.country_name = mountain.country_name\nriver.country_name = state.country_name\nriver.country_name = mountain.country_name\nstate.country_name = mountain.country_name\n\n【参考信息】\n\n\n【用户问题】\nGet the ratio of population per area for each state\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT state_name, population / NULLIF(area, 0) AS population_density FROM state;",
        "role": "assistant"
      }
    ],
    "db_name": "geography",
    "id": 104,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich countries have both lakes and rivers?\n\n【数据库schema】\n【DB_ID】 geography\n【Schema】\n# Table: border_info\n[\n  (state_name:text, The name of the state that shares a border with another state or country.. Value examples: ['California', 'California', 'California', 'Texas'].),\n  (border:text, The name of the state that shares a border with the state specified in the state_name column.. Value examples: ['Nevada', 'Arizona', 'Oregon', 'Louisiana'].),\n]\n# Table: city\n[\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Houston'].),\n  (population:bigint, The population of the city. Value examples: ['1000000', '5000000', '1500000', '2000000'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the city is located. Value examples: ['New York', 'California', 'Illinois', 'Texas'].),\n]\n# Table: highlow\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas'].),\n  (highest_elevation:text, The highest elevation point in the state in meters above sea level. Value examples: ['4421', '2667'].),\n  (lowest_point:text, The lowest elevation point in the state. Value examples: ['Death Valley', 'Gulf of Mexico'].),\n  (highest_point:text, The highest point in the state. If unknown, use 'Unnamed location'.. Value examples: ['Mount Whitney', 'Guadalupe Peak'].),\n  (lowest_elevation:text, The lowest point in the state in meters above sea level. Value examples: ['-86', '0'].),\n]\n# Table: lake\n[\n  (lake_name:text, The name of the lake. Value examples: ['Lake Superior', 'Lake Michigan', 'Lake Huron'].),\n  (area:double, The area of the lake in square kilometers. Value examples: ['1000', '500', '300'].),\n  (country_name:text, The name of the country where the lake is located. Value examples: ['United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the lake is located (if applicable). Value examples: ['Michigan', 'Michigan', 'Michigan'].),\n]\n# Table: mountain\n[\n  (mountain_name:text, The name of the mountain. Value examples: ['Mount Everest', 'K2', 'Kangchenjunga'].),\n  (mountain_altitude:bigint, The altitude of the mountain in meters. Value examples: ['10000', '5000', '3000'].),\n  (country_name:text, The name of the country where the mountain is located. Value examples: ['Nepal', 'Pakistan', 'Nepal'].),\n  (state_name:text, The name of the state or province where the mountain is located (if applicable). Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: river\n[\n  (river_name:text, The name of the river. Names exclude the word 'river' e.g. 'Mississippi' instead of 'Mississippi River'.),\n  (length:bigint, The length of the river in meters.),\n  (country_name:text, The name of the country the river flows through.),\n  (traverse:text, The cities or landmarks the river passes through. Comma delimited and in title case, eg `New York,Albany,Boston`.),\n]\n# Table: state\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas', 'Florida', 'New York'].),\n  (population:bigint, The population of the state. Value examples: ['100000', '50000', '150000', '200000'].),\n  (area:double, The area of the state in square kilometers. Value examples: ['10000', '5000', '15000', '20000'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (capital:text, The name of the capital city of the state. Value examples: ['Sacramento', 'Austin', 'Tallahassee', 'Albany'].),\n  (density:double, The population density of the state in people per square kilometer. Value examples: ['1000', '1000', '1000', '1000'].),\n]\n\n【Foreign keys】\nborder_info.state_name = city.state_name\nborder_info.state_name = lake.state_name\nborder_info.state_name = state.state_name\nborder_info.state_name = highlow.state_name\nborder_info.state_name = mountain.state_name\ncity.country_name = lake.country_name\ncity.country_name = river.country_name\ncity.country_name = state.country_name\ncity.country_name = mountain.country_name\ncity.state_name = highlow.state_name\nhighlow.state_name = lake.state_name\nhighlow.state_name = state.state_name\nhighlow.state_name = mountain.state_name\nlake.country_name = river.country_name\nlake.country_name = state.country_name\nlake.country_name = mountain.country_name\nriver.country_name = state.country_name\nriver.country_name = mountain.country_name\nstate.country_name = mountain.country_name\n\n【参考信息】\n\n\n【用户问题】\nWhich countries have both lakes and rivers?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT DISTINCT lake.country_name FROM public.lake JOIN public.river ON lake.country_name = river.country_name;",
        "role": "assistant"
      }
    ],
    "db_name": "geography",
    "id": 105,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich states border the state where lake ontario is?\n\n【数据库schema】\n【DB_ID】 geography\n【Schema】\n# Table: border_info\n[\n  (state_name:text, The name of the state that shares a border with another state or country.. Value examples: ['California', 'California', 'California', 'Texas'].),\n  (border:text, The name of the state that shares a border with the state specified in the state_name column.. Value examples: ['Nevada', 'Arizona', 'Oregon', 'Louisiana'].),\n]\n# Table: city\n[\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Houston'].),\n  (population:bigint, The population of the city. Value examples: ['1000000', '5000000', '1500000', '2000000'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the city is located. Value examples: ['New York', 'California', 'Illinois', 'Texas'].),\n]\n# Table: highlow\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas'].),\n  (highest_elevation:text, The highest elevation point in the state in meters above sea level. Value examples: ['4421', '2667'].),\n  (lowest_point:text, The lowest elevation point in the state. Value examples: ['Death Valley', 'Gulf of Mexico'].),\n  (highest_point:text, The highest point in the state. If unknown, use 'Unnamed location'.. Value examples: ['Mount Whitney', 'Guadalupe Peak'].),\n  (lowest_elevation:text, The lowest point in the state in meters above sea level. Value examples: ['-86', '0'].),\n]\n# Table: lake\n[\n  (lake_name:text, The name of the lake. Value examples: ['Lake Superior', 'Lake Michigan', 'Lake Huron'].),\n  (area:double, The area of the lake in square kilometers. Value examples: ['1000', '500', '300'].),\n  (country_name:text, The name of the country where the lake is located. Value examples: ['United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the lake is located (if applicable). Value examples: ['Michigan', 'Michigan', 'Michigan'].),\n]\n# Table: mountain\n[\n  (mountain_name:text, The name of the mountain. Value examples: ['Mount Everest', 'K2', 'Kangchenjunga'].),\n  (mountain_altitude:bigint, The altitude of the mountain in meters. Value examples: ['10000', '5000', '3000'].),\n  (country_name:text, The name of the country where the mountain is located. Value examples: ['Nepal', 'Pakistan', 'Nepal'].),\n  (state_name:text, The name of the state or province where the mountain is located (if applicable). Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: river\n[\n  (river_name:text, The name of the river. Names exclude the word 'river' e.g. 'Mississippi' instead of 'Mississippi River'.),\n  (length:bigint, The length of the river in meters.),\n  (country_name:text, The name of the country the river flows through.),\n  (traverse:text, The cities or landmarks the river passes through. Comma delimited and in title case, eg `New York,Albany,Boston`.),\n]\n# Table: state\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas', 'Florida', 'New York'].),\n  (population:bigint, The population of the state. Value examples: ['100000', '50000', '150000', '200000'].),\n  (area:double, The area of the state in square kilometers. Value examples: ['10000', '5000', '15000', '20000'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (capital:text, The name of the capital city of the state. Value examples: ['Sacramento', 'Austin', 'Tallahassee', 'Albany'].),\n  (density:double, The population density of the state in people per square kilometer. Value examples: ['1000', '1000', '1000', '1000'].),\n]\n\n【Foreign keys】\nborder_info.state_name = city.state_name\nborder_info.state_name = lake.state_name\nborder_info.state_name = state.state_name\nborder_info.state_name = highlow.state_name\nborder_info.state_name = mountain.state_name\ncity.country_name = lake.country_name\ncity.country_name = river.country_name\ncity.country_name = state.country_name\ncity.country_name = mountain.country_name\ncity.state_name = highlow.state_name\nhighlow.state_name = lake.state_name\nhighlow.state_name = state.state_name\nhighlow.state_name = mountain.state_name\nlake.country_name = river.country_name\nlake.country_name = state.country_name\nlake.country_name = mountain.country_name\nriver.country_name = state.country_name\nriver.country_name = mountain.country_name\nstate.country_name = mountain.country_name\n\n【参考信息】\n\n\n【用户问题】\nWhich states border the state where lake ontario is?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT border_info.border FROM border_info JOIN lake ON border_info.state_name = lake.state_name WHERE lake.lake_name ilike '%Ontario%';",
        "role": "assistant"
      }
    ],
    "db_name": "geography",
    "id": 106,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich lakes have a name that starts with \"Lake\"? They should be located in states with an area greater than 1000 square kilometers.\n\n【数据库schema】\n【DB_ID】 geography\n【Schema】\n# Table: border_info\n[\n  (state_name:text, The name of the state that shares a border with another state or country.. Value examples: ['California', 'California', 'California', 'Texas'].),\n  (border:text, The name of the state that shares a border with the state specified in the state_name column.. Value examples: ['Nevada', 'Arizona', 'Oregon', 'Louisiana'].),\n]\n# Table: city\n[\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Houston'].),\n  (population:bigint, The population of the city. Value examples: ['1000000', '5000000', '1500000', '2000000'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the city is located. Value examples: ['New York', 'California', 'Illinois', 'Texas'].),\n]\n# Table: highlow\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas'].),\n  (highest_elevation:text, The highest elevation point in the state in meters above sea level. Value examples: ['4421', '2667'].),\n  (lowest_point:text, The lowest elevation point in the state. Value examples: ['Death Valley', 'Gulf of Mexico'].),\n  (highest_point:text, The highest point in the state. If unknown, use 'Unnamed location'.. Value examples: ['Mount Whitney', 'Guadalupe Peak'].),\n  (lowest_elevation:text, The lowest point in the state in meters above sea level. Value examples: ['-86', '0'].),\n]\n# Table: lake\n[\n  (lake_name:text, The name of the lake. Value examples: ['Lake Superior', 'Lake Michigan', 'Lake Huron'].),\n  (area:double, The area of the lake in square kilometers. Value examples: ['1000', '500', '300'].),\n  (country_name:text, The name of the country where the lake is located. Value examples: ['United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the lake is located (if applicable). Value examples: ['Michigan', 'Michigan', 'Michigan'].),\n]\n# Table: mountain\n[\n  (mountain_name:text, The name of the mountain. Value examples: ['Mount Everest', 'K2', 'Kangchenjunga'].),\n  (mountain_altitude:bigint, The altitude of the mountain in meters. Value examples: ['10000', '5000', '3000'].),\n  (country_name:text, The name of the country where the mountain is located. Value examples: ['Nepal', 'Pakistan', 'Nepal'].),\n  (state_name:text, The name of the state or province where the mountain is located (if applicable). Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: river\n[\n  (river_name:text, The name of the river. Names exclude the word 'river' e.g. 'Mississippi' instead of 'Mississippi River'.),\n  (length:bigint, The length of the river in meters.),\n  (country_name:text, The name of the country the river flows through.),\n  (traverse:text, The cities or landmarks the river passes through. Comma delimited and in title case, eg `New York,Albany,Boston`.),\n]\n# Table: state\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas', 'Florida', 'New York'].),\n  (population:bigint, The population of the state. Value examples: ['100000', '50000', '150000', '200000'].),\n  (area:double, The area of the state in square kilometers. Value examples: ['10000', '5000', '15000', '20000'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (capital:text, The name of the capital city of the state. Value examples: ['Sacramento', 'Austin', 'Tallahassee', 'Albany'].),\n  (density:double, The population density of the state in people per square kilometer. Value examples: ['1000', '1000', '1000', '1000'].),\n]\n\n【Foreign keys】\nborder_info.state_name = city.state_name\nborder_info.state_name = lake.state_name\nborder_info.state_name = state.state_name\nborder_info.state_name = highlow.state_name\nborder_info.state_name = mountain.state_name\ncity.country_name = lake.country_name\ncity.country_name = river.country_name\ncity.country_name = state.country_name\ncity.country_name = mountain.country_name\ncity.state_name = highlow.state_name\nhighlow.state_name = lake.state_name\nhighlow.state_name = state.state_name\nhighlow.state_name = mountain.state_name\nlake.country_name = river.country_name\nlake.country_name = state.country_name\nlake.country_name = mountain.country_name\nriver.country_name = state.country_name\nriver.country_name = mountain.country_name\nstate.country_name = mountain.country_name\n\n【参考信息】\n\n\n【用户问题】\nWhich lakes have a name that starts with \"Lake\"? They should be located in states with an area greater than 1000 square kilometers.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT lake.lake_name FROM lake JOIN state ON lake.state_name = state.state_name WHERE state.area > 1000 AND lake.lake_name ilike 'Lake%' ORDER BY lake.lake_name NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "geography",
    "id": 107,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the highest point in each state and what is the population density of that state?\n\n【数据库schema】\n【DB_ID】 geography\n【Schema】\n# Table: border_info\n[\n  (state_name:text, The name of the state that shares a border with another state or country.. Value examples: ['California', 'California', 'California', 'Texas'].),\n  (border:text, The name of the state that shares a border with the state specified in the state_name column.. Value examples: ['Nevada', 'Arizona', 'Oregon', 'Louisiana'].),\n]\n# Table: city\n[\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Houston'].),\n  (population:bigint, The population of the city. Value examples: ['1000000', '5000000', '1500000', '2000000'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the city is located. Value examples: ['New York', 'California', 'Illinois', 'Texas'].),\n]\n# Table: highlow\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas'].),\n  (highest_elevation:text, The highest elevation point in the state in meters above sea level. Value examples: ['4421', '2667'].),\n  (lowest_point:text, The lowest elevation point in the state. Value examples: ['Death Valley', 'Gulf of Mexico'].),\n  (highest_point:text, The highest point in the state. If unknown, use 'Unnamed location'.. Value examples: ['Mount Whitney', 'Guadalupe Peak'].),\n  (lowest_elevation:text, The lowest point in the state in meters above sea level. Value examples: ['-86', '0'].),\n]\n# Table: lake\n[\n  (lake_name:text, The name of the lake. Value examples: ['Lake Superior', 'Lake Michigan', 'Lake Huron'].),\n  (area:double, The area of the lake in square kilometers. Value examples: ['1000', '500', '300'].),\n  (country_name:text, The name of the country where the lake is located. Value examples: ['United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the lake is located (if applicable). Value examples: ['Michigan', 'Michigan', 'Michigan'].),\n]\n# Table: mountain\n[\n  (mountain_name:text, The name of the mountain. Value examples: ['Mount Everest', 'K2', 'Kangchenjunga'].),\n  (mountain_altitude:bigint, The altitude of the mountain in meters. Value examples: ['10000', '5000', '3000'].),\n  (country_name:text, The name of the country where the mountain is located. Value examples: ['Nepal', 'Pakistan', 'Nepal'].),\n  (state_name:text, The name of the state or province where the mountain is located (if applicable). Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: river\n[\n  (river_name:text, The name of the river. Names exclude the word 'river' e.g. 'Mississippi' instead of 'Mississippi River'.),\n  (length:bigint, The length of the river in meters.),\n  (country_name:text, The name of the country the river flows through.),\n  (traverse:text, The cities or landmarks the river passes through. Comma delimited and in title case, eg `New York,Albany,Boston`.),\n]\n# Table: state\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas', 'Florida', 'New York'].),\n  (population:bigint, The population of the state. Value examples: ['100000', '50000', '150000', '200000'].),\n  (area:double, The area of the state in square kilometers. Value examples: ['10000', '5000', '15000', '20000'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (capital:text, The name of the capital city of the state. Value examples: ['Sacramento', 'Austin', 'Tallahassee', 'Albany'].),\n  (density:double, The population density of the state in people per square kilometer. Value examples: ['1000', '1000', '1000', '1000'].),\n]\n\n【Foreign keys】\nborder_info.state_name = city.state_name\nborder_info.state_name = lake.state_name\nborder_info.state_name = state.state_name\nborder_info.state_name = highlow.state_name\nborder_info.state_name = mountain.state_name\ncity.country_name = lake.country_name\ncity.country_name = river.country_name\ncity.country_name = state.country_name\ncity.country_name = mountain.country_name\ncity.state_name = highlow.state_name\nhighlow.state_name = lake.state_name\nhighlow.state_name = state.state_name\nhighlow.state_name = mountain.state_name\nlake.country_name = river.country_name\nlake.country_name = state.country_name\nlake.country_name = mountain.country_name\nriver.country_name = state.country_name\nriver.country_name = mountain.country_name\nstate.country_name = mountain.country_name\n\n【参考信息】\n\n\n【用户问题】\nWhat is the highest point in each state and what is the population density of that state?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT highlow.state_name, highlow.highest_point, state.density FROM highlow JOIN state ON highlow.state_name = state.state_name;",
        "role": "assistant"
      }
    ],
    "db_name": "geography",
    "id": 108,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the average length of rivers per country in countries with a lake?\n\n【数据库schema】\n【DB_ID】 geography\n【Schema】\n# Table: border_info\n[\n  (state_name:text, The name of the state that shares a border with another state or country.. Value examples: ['California', 'California', 'California', 'Texas'].),\n  (border:text, The name of the state that shares a border with the state specified in the state_name column.. Value examples: ['Nevada', 'Arizona', 'Oregon', 'Louisiana'].),\n]\n# Table: city\n[\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Houston'].),\n  (population:bigint, The population of the city. Value examples: ['1000000', '5000000', '1500000', '2000000'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the city is located. Value examples: ['New York', 'California', 'Illinois', 'Texas'].),\n]\n# Table: highlow\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas'].),\n  (highest_elevation:text, The highest elevation point in the state in meters above sea level. Value examples: ['4421', '2667'].),\n  (lowest_point:text, The lowest elevation point in the state. Value examples: ['Death Valley', 'Gulf of Mexico'].),\n  (highest_point:text, The highest point in the state. If unknown, use 'Unnamed location'.. Value examples: ['Mount Whitney', 'Guadalupe Peak'].),\n  (lowest_elevation:text, The lowest point in the state in meters above sea level. Value examples: ['-86', '0'].),\n]\n# Table: lake\n[\n  (lake_name:text, The name of the lake. Value examples: ['Lake Superior', 'Lake Michigan', 'Lake Huron'].),\n  (area:double, The area of the lake in square kilometers. Value examples: ['1000', '500', '300'].),\n  (country_name:text, The name of the country where the lake is located. Value examples: ['United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the lake is located (if applicable). Value examples: ['Michigan', 'Michigan', 'Michigan'].),\n]\n# Table: mountain\n[\n  (mountain_name:text, The name of the mountain. Value examples: ['Mount Everest', 'K2', 'Kangchenjunga'].),\n  (mountain_altitude:bigint, The altitude of the mountain in meters. Value examples: ['10000', '5000', '3000'].),\n  (country_name:text, The name of the country where the mountain is located. Value examples: ['Nepal', 'Pakistan', 'Nepal'].),\n  (state_name:text, The name of the state or province where the mountain is located (if applicable). Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: river\n[\n  (river_name:text, The name of the river. Names exclude the word 'river' e.g. 'Mississippi' instead of 'Mississippi River'.),\n  (length:bigint, The length of the river in meters.),\n  (country_name:text, The name of the country the river flows through.),\n  (traverse:text, The cities or landmarks the river passes through. Comma delimited and in title case, eg `New York,Albany,Boston`.),\n]\n# Table: state\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas', 'Florida', 'New York'].),\n  (population:bigint, The population of the state. Value examples: ['100000', '50000', '150000', '200000'].),\n  (area:double, The area of the state in square kilometers. Value examples: ['10000', '5000', '15000', '20000'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (capital:text, The name of the capital city of the state. Value examples: ['Sacramento', 'Austin', 'Tallahassee', 'Albany'].),\n  (density:double, The population density of the state in people per square kilometer. Value examples: ['1000', '1000', '1000', '1000'].),\n]\n\n【Foreign keys】\nborder_info.state_name = city.state_name\nborder_info.state_name = lake.state_name\nborder_info.state_name = state.state_name\nborder_info.state_name = highlow.state_name\nborder_info.state_name = mountain.state_name\ncity.country_name = lake.country_name\ncity.country_name = river.country_name\ncity.country_name = state.country_name\ncity.country_name = mountain.country_name\ncity.state_name = highlow.state_name\nhighlow.state_name = lake.state_name\nhighlow.state_name = state.state_name\nhighlow.state_name = mountain.state_name\nlake.country_name = river.country_name\nlake.country_name = state.country_name\nlake.country_name = mountain.country_name\nriver.country_name = state.country_name\nriver.country_name = mountain.country_name\nstate.country_name = mountain.country_name\n\n【参考信息】\n\n\n【用户问题】\nWhat is the average length of rivers per country in countries with a lake?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT l.country_name, AVG(r.length) AS average_length FROM river r JOIN lake l ON r.country_name = l.country_name GROUP BY 1;",
        "role": "assistant"
      }
    ],
    "db_name": "geography",
    "id": 109,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich states have fewer than a hundred thousand people?\n\n【数据库schema】\n【DB_ID】 geography\n【Schema】\n# Table: border_info\n[\n  (state_name:text, The name of the state that shares a border with another state or country.. Value examples: ['California', 'California', 'California', 'Texas'].),\n  (border:text, The name of the state that shares a border with the state specified in the state_name column.. Value examples: ['Nevada', 'Arizona', 'Oregon', 'Louisiana'].),\n]\n# Table: city\n[\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Houston'].),\n  (population:bigint, The population of the city. Value examples: ['1000000', '5000000', '1500000', '2000000'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the city is located. Value examples: ['New York', 'California', 'Illinois', 'Texas'].),\n]\n# Table: highlow\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas'].),\n  (highest_elevation:text, The highest elevation point in the state in meters above sea level. Value examples: ['4421', '2667'].),\n  (lowest_point:text, The lowest elevation point in the state. Value examples: ['Death Valley', 'Gulf of Mexico'].),\n  (highest_point:text, The highest point in the state. If unknown, use 'Unnamed location'.. Value examples: ['Mount Whitney', 'Guadalupe Peak'].),\n  (lowest_elevation:text, The lowest point in the state in meters above sea level. Value examples: ['-86', '0'].),\n]\n# Table: lake\n[\n  (lake_name:text, The name of the lake. Value examples: ['Lake Superior', 'Lake Michigan', 'Lake Huron'].),\n  (area:double, The area of the lake in square kilometers. Value examples: ['1000', '500', '300'].),\n  (country_name:text, The name of the country where the lake is located. Value examples: ['United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the lake is located (if applicable). Value examples: ['Michigan', 'Michigan', 'Michigan'].),\n]\n# Table: mountain\n[\n  (mountain_name:text, The name of the mountain. Value examples: ['Mount Everest', 'K2', 'Kangchenjunga'].),\n  (mountain_altitude:bigint, The altitude of the mountain in meters. Value examples: ['10000', '5000', '3000'].),\n  (country_name:text, The name of the country where the mountain is located. Value examples: ['Nepal', 'Pakistan', 'Nepal'].),\n  (state_name:text, The name of the state or province where the mountain is located (if applicable). Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: river\n[\n  (river_name:text, The name of the river. Names exclude the word 'river' e.g. 'Mississippi' instead of 'Mississippi River'.),\n  (length:bigint, The length of the river in meters.),\n  (country_name:text, The name of the country the river flows through.),\n  (traverse:text, The cities or landmarks the river passes through. Comma delimited and in title case, eg `New York,Albany,Boston`.),\n]\n# Table: state\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas', 'Florida', 'New York'].),\n  (population:bigint, The population of the state. Value examples: ['100000', '50000', '150000', '200000'].),\n  (area:double, The area of the state in square kilometers. Value examples: ['10000', '5000', '15000', '20000'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (capital:text, The name of the capital city of the state. Value examples: ['Sacramento', 'Austin', 'Tallahassee', 'Albany'].),\n  (density:double, The population density of the state in people per square kilometer. Value examples: ['1000', '1000', '1000', '1000'].),\n]\n\n【Foreign keys】\nborder_info.state_name = city.state_name\nborder_info.state_name = lake.state_name\nborder_info.state_name = state.state_name\nborder_info.state_name = highlow.state_name\nborder_info.state_name = mountain.state_name\ncity.country_name = lake.country_name\ncity.country_name = river.country_name\ncity.country_name = state.country_name\ncity.country_name = mountain.country_name\ncity.state_name = highlow.state_name\nhighlow.state_name = lake.state_name\nhighlow.state_name = state.state_name\nhighlow.state_name = mountain.state_name\nlake.country_name = river.country_name\nlake.country_name = state.country_name\nlake.country_name = mountain.country_name\nriver.country_name = state.country_name\nriver.country_name = mountain.country_name\nstate.country_name = mountain.country_name\n\n【参考信息】\nAlways filter names using ILIKE\n\n【用户问题】\nWhich states have fewer than a hundred thousand people?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT state_name FROM state WHERE population < 100000;",
        "role": "assistant"
      }
    ],
    "db_name": "geography",
    "id": 110,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich rivers traverse at least 3 cities/landmarks?\n\n【数据库schema】\n【DB_ID】 geography\n【Schema】\n# Table: border_info\n[\n  (state_name:text, The name of the state that shares a border with another state or country.. Value examples: ['California', 'California', 'California', 'Texas'].),\n  (border:text, The name of the state that shares a border with the state specified in the state_name column.. Value examples: ['Nevada', 'Arizona', 'Oregon', 'Louisiana'].),\n]\n# Table: city\n[\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Houston'].),\n  (population:bigint, The population of the city. Value examples: ['1000000', '5000000', '1500000', '2000000'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the city is located. Value examples: ['New York', 'California', 'Illinois', 'Texas'].),\n]\n# Table: highlow\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas'].),\n  (highest_elevation:text, The highest elevation point in the state in meters above sea level. Value examples: ['4421', '2667'].),\n  (lowest_point:text, The lowest elevation point in the state. Value examples: ['Death Valley', 'Gulf of Mexico'].),\n  (highest_point:text, The highest point in the state. If unknown, use 'Unnamed location'.. Value examples: ['Mount Whitney', 'Guadalupe Peak'].),\n  (lowest_elevation:text, The lowest point in the state in meters above sea level. Value examples: ['-86', '0'].),\n]\n# Table: lake\n[\n  (lake_name:text, The name of the lake. Value examples: ['Lake Superior', 'Lake Michigan', 'Lake Huron'].),\n  (area:double, The area of the lake in square kilometers. Value examples: ['1000', '500', '300'].),\n  (country_name:text, The name of the country where the lake is located. Value examples: ['United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the lake is located (if applicable). Value examples: ['Michigan', 'Michigan', 'Michigan'].),\n]\n# Table: mountain\n[\n  (mountain_name:text, The name of the mountain. Value examples: ['Mount Everest', 'K2', 'Kangchenjunga'].),\n  (mountain_altitude:bigint, The altitude of the mountain in meters. Value examples: ['10000', '5000', '3000'].),\n  (country_name:text, The name of the country where the mountain is located. Value examples: ['Nepal', 'Pakistan', 'Nepal'].),\n  (state_name:text, The name of the state or province where the mountain is located (if applicable). Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: river\n[\n  (river_name:text, The name of the river. Names exclude the word 'river' e.g. 'Mississippi' instead of 'Mississippi River'.),\n  (length:bigint, The length of the river in meters.),\n  (country_name:text, The name of the country the river flows through.),\n  (traverse:text, The cities or landmarks the river passes through. Comma delimited and in title case, eg `New York,Albany,Boston`.),\n]\n# Table: state\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas', 'Florida', 'New York'].),\n  (population:bigint, The population of the state. Value examples: ['100000', '50000', '150000', '200000'].),\n  (area:double, The area of the state in square kilometers. Value examples: ['10000', '5000', '15000', '20000'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (capital:text, The name of the capital city of the state. Value examples: ['Sacramento', 'Austin', 'Tallahassee', 'Albany'].),\n  (density:double, The population density of the state in people per square kilometer. Value examples: ['1000', '1000', '1000', '1000'].),\n]\n\n【Foreign keys】\nborder_info.state_name = city.state_name\nborder_info.state_name = lake.state_name\nborder_info.state_name = state.state_name\nborder_info.state_name = highlow.state_name\nborder_info.state_name = mountain.state_name\ncity.country_name = lake.country_name\ncity.country_name = river.country_name\ncity.country_name = state.country_name\ncity.country_name = mountain.country_name\ncity.state_name = highlow.state_name\nhighlow.state_name = lake.state_name\nhighlow.state_name = state.state_name\nhighlow.state_name = mountain.state_name\nlake.country_name = river.country_name\nlake.country_name = state.country_name\nlake.country_name = mountain.country_name\nriver.country_name = state.country_name\nriver.country_name = mountain.country_name\nstate.country_name = mountain.country_name\n\n【参考信息】\nAlways filter names using ILIKE\n\n【用户问题】\nWhich rivers traverse at least 3 cities/landmarks?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT river_name FROM river WHERE traverse LIKE '%,%,%';",
        "role": "assistant"
      }
    ],
    "db_name": "geography",
    "id": 111,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the names and areas of the lakes in Michigan?\n\n【数据库schema】\n【DB_ID】 geography\n【Schema】\n# Table: border_info\n[\n  (state_name:text, The name of the state that shares a border with another state or country.. Value examples: ['California', 'California', 'California', 'Texas'].),\n  (border:text, The name of the state that shares a border with the state specified in the state_name column.. Value examples: ['Nevada', 'Arizona', 'Oregon', 'Louisiana'].),\n]\n# Table: city\n[\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Houston'].),\n  (population:bigint, The population of the city. Value examples: ['1000000', '5000000', '1500000', '2000000'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the city is located. Value examples: ['New York', 'California', 'Illinois', 'Texas'].),\n]\n# Table: highlow\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas'].),\n  (highest_elevation:text, The highest elevation point in the state in meters above sea level. Value examples: ['4421', '2667'].),\n  (lowest_point:text, The lowest elevation point in the state. Value examples: ['Death Valley', 'Gulf of Mexico'].),\n  (highest_point:text, The highest point in the state. If unknown, use 'Unnamed location'.. Value examples: ['Mount Whitney', 'Guadalupe Peak'].),\n  (lowest_elevation:text, The lowest point in the state in meters above sea level. Value examples: ['-86', '0'].),\n]\n# Table: lake\n[\n  (lake_name:text, The name of the lake. Value examples: ['Lake Superior', 'Lake Michigan', 'Lake Huron'].),\n  (area:double, The area of the lake in square kilometers. Value examples: ['1000', '500', '300'].),\n  (country_name:text, The name of the country where the lake is located. Value examples: ['United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the lake is located (if applicable). Value examples: ['Michigan', 'Michigan', 'Michigan'].),\n]\n# Table: mountain\n[\n  (mountain_name:text, The name of the mountain. Value examples: ['Mount Everest', 'K2', 'Kangchenjunga'].),\n  (mountain_altitude:bigint, The altitude of the mountain in meters. Value examples: ['10000', '5000', '3000'].),\n  (country_name:text, The name of the country where the mountain is located. Value examples: ['Nepal', 'Pakistan', 'Nepal'].),\n  (state_name:text, The name of the state or province where the mountain is located (if applicable). Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: river\n[\n  (river_name:text, The name of the river. Names exclude the word 'river' e.g. 'Mississippi' instead of 'Mississippi River'.),\n  (length:bigint, The length of the river in meters.),\n  (country_name:text, The name of the country the river flows through.),\n  (traverse:text, The cities or landmarks the river passes through. Comma delimited and in title case, eg `New York,Albany,Boston`.),\n]\n# Table: state\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas', 'Florida', 'New York'].),\n  (population:bigint, The population of the state. Value examples: ['100000', '50000', '150000', '200000'].),\n  (area:double, The area of the state in square kilometers. Value examples: ['10000', '5000', '15000', '20000'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (capital:text, The name of the capital city of the state. Value examples: ['Sacramento', 'Austin', 'Tallahassee', 'Albany'].),\n  (density:double, The population density of the state in people per square kilometer. Value examples: ['1000', '1000', '1000', '1000'].),\n]\n\n【Foreign keys】\nborder_info.state_name = city.state_name\nborder_info.state_name = lake.state_name\nborder_info.state_name = state.state_name\nborder_info.state_name = highlow.state_name\nborder_info.state_name = mountain.state_name\ncity.country_name = lake.country_name\ncity.country_name = river.country_name\ncity.country_name = state.country_name\ncity.country_name = mountain.country_name\ncity.state_name = highlow.state_name\nhighlow.state_name = lake.state_name\nhighlow.state_name = state.state_name\nhighlow.state_name = mountain.state_name\nlake.country_name = river.country_name\nlake.country_name = state.country_name\nlake.country_name = mountain.country_name\nriver.country_name = state.country_name\nriver.country_name = mountain.country_name\nstate.country_name = mountain.country_name\n\n【参考信息】\nAlways filter names using ILIKE\n\n【用户问题】\nWhat are the names and areas of the lakes in Michigan?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT lake_name, area FROM lake WHERE state_name ILIKE '%Michigan%';",
        "role": "assistant"
      }
    ],
    "db_name": "geography",
    "id": 112,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the names and altitudes of the mountains in Nepal?\n\n【数据库schema】\n【DB_ID】 geography\n【Schema】\n# Table: border_info\n[\n  (state_name:text, The name of the state that shares a border with another state or country.. Value examples: ['California', 'California', 'California', 'Texas'].),\n  (border:text, The name of the state that shares a border with the state specified in the state_name column.. Value examples: ['Nevada', 'Arizona', 'Oregon', 'Louisiana'].),\n]\n# Table: city\n[\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Houston'].),\n  (population:bigint, The population of the city. Value examples: ['1000000', '5000000', '1500000', '2000000'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the city is located. Value examples: ['New York', 'California', 'Illinois', 'Texas'].),\n]\n# Table: highlow\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas'].),\n  (highest_elevation:text, The highest elevation point in the state in meters above sea level. Value examples: ['4421', '2667'].),\n  (lowest_point:text, The lowest elevation point in the state. Value examples: ['Death Valley', 'Gulf of Mexico'].),\n  (highest_point:text, The highest point in the state. If unknown, use 'Unnamed location'.. Value examples: ['Mount Whitney', 'Guadalupe Peak'].),\n  (lowest_elevation:text, The lowest point in the state in meters above sea level. Value examples: ['-86', '0'].),\n]\n# Table: lake\n[\n  (lake_name:text, The name of the lake. Value examples: ['Lake Superior', 'Lake Michigan', 'Lake Huron'].),\n  (area:double, The area of the lake in square kilometers. Value examples: ['1000', '500', '300'].),\n  (country_name:text, The name of the country where the lake is located. Value examples: ['United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the lake is located (if applicable). Value examples: ['Michigan', 'Michigan', 'Michigan'].),\n]\n# Table: mountain\n[\n  (mountain_name:text, The name of the mountain. Value examples: ['Mount Everest', 'K2', 'Kangchenjunga'].),\n  (mountain_altitude:bigint, The altitude of the mountain in meters. Value examples: ['10000', '5000', '3000'].),\n  (country_name:text, The name of the country where the mountain is located. Value examples: ['Nepal', 'Pakistan', 'Nepal'].),\n  (state_name:text, The name of the state or province where the mountain is located (if applicable). Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: river\n[\n  (river_name:text, The name of the river. Names exclude the word 'river' e.g. 'Mississippi' instead of 'Mississippi River'.),\n  (length:bigint, The length of the river in meters.),\n  (country_name:text, The name of the country the river flows through.),\n  (traverse:text, The cities or landmarks the river passes through. Comma delimited and in title case, eg `New York,Albany,Boston`.),\n]\n# Table: state\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas', 'Florida', 'New York'].),\n  (population:bigint, The population of the state. Value examples: ['100000', '50000', '150000', '200000'].),\n  (area:double, The area of the state in square kilometers. Value examples: ['10000', '5000', '15000', '20000'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (capital:text, The name of the capital city of the state. Value examples: ['Sacramento', 'Austin', 'Tallahassee', 'Albany'].),\n  (density:double, The population density of the state in people per square kilometer. Value examples: ['1000', '1000', '1000', '1000'].),\n]\n\n【Foreign keys】\nborder_info.state_name = city.state_name\nborder_info.state_name = lake.state_name\nborder_info.state_name = state.state_name\nborder_info.state_name = highlow.state_name\nborder_info.state_name = mountain.state_name\ncity.country_name = lake.country_name\ncity.country_name = river.country_name\ncity.country_name = state.country_name\ncity.country_name = mountain.country_name\ncity.state_name = highlow.state_name\nhighlow.state_name = lake.state_name\nhighlow.state_name = state.state_name\nhighlow.state_name = mountain.state_name\nlake.country_name = river.country_name\nlake.country_name = state.country_name\nlake.country_name = mountain.country_name\nriver.country_name = state.country_name\nriver.country_name = mountain.country_name\nstate.country_name = mountain.country_name\n\n【参考信息】\nAlways filter names using ILIKE\n\n【用户问题】\nWhat are the names and altitudes of the mountains in Nepal?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT mountain_name, mountain_altitude FROM mountain WHERE country_name ILIKE '%Nepal%';",
        "role": "assistant"
      }
    ],
    "db_name": "geography",
    "id": 113,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nGet the cities in the United States and their population\n\n【数据库schema】\n【DB_ID】 geography\n【Schema】\n# Table: border_info\n[\n  (state_name:text, The name of the state that shares a border with another state or country.. Value examples: ['California', 'California', 'California', 'Texas'].),\n  (border:text, The name of the state that shares a border with the state specified in the state_name column.. Value examples: ['Nevada', 'Arizona', 'Oregon', 'Louisiana'].),\n]\n# Table: city\n[\n  (city_name:text, The name of the city. Value examples: ['New York', 'Los Angeles', 'Chicago', 'Houston'].),\n  (population:bigint, The population of the city. Value examples: ['1000000', '5000000', '1500000', '2000000'].),\n  (country_name:text, The name of the country where the city is located. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the city is located. Value examples: ['New York', 'California', 'Illinois', 'Texas'].),\n]\n# Table: highlow\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas'].),\n  (highest_elevation:text, The highest elevation point in the state in meters above sea level. Value examples: ['4421', '2667'].),\n  (lowest_point:text, The lowest elevation point in the state. Value examples: ['Death Valley', 'Gulf of Mexico'].),\n  (highest_point:text, The highest point in the state. If unknown, use 'Unnamed location'.. Value examples: ['Mount Whitney', 'Guadalupe Peak'].),\n  (lowest_elevation:text, The lowest point in the state in meters above sea level. Value examples: ['-86', '0'].),\n]\n# Table: lake\n[\n  (lake_name:text, The name of the lake. Value examples: ['Lake Superior', 'Lake Michigan', 'Lake Huron'].),\n  (area:double, The area of the lake in square kilometers. Value examples: ['1000', '500', '300'].),\n  (country_name:text, The name of the country where the lake is located. Value examples: ['United States', 'United States', 'United States'].),\n  (state_name:text, The name of the state where the lake is located (if applicable). Value examples: ['Michigan', 'Michigan', 'Michigan'].),\n]\n# Table: mountain\n[\n  (mountain_name:text, The name of the mountain. Value examples: ['Mount Everest', 'K2', 'Kangchenjunga'].),\n  (mountain_altitude:bigint, The altitude of the mountain in meters. Value examples: ['10000', '5000', '3000'].),\n  (country_name:text, The name of the country where the mountain is located. Value examples: ['Nepal', 'Pakistan', 'Nepal'].),\n  (state_name:text, The name of the state or province where the mountain is located (if applicable). Value examples: ['NULL', 'NULL', 'NULL'].),\n]\n# Table: river\n[\n  (river_name:text, The name of the river. Names exclude the word 'river' e.g. 'Mississippi' instead of 'Mississippi River'.),\n  (length:bigint, The length of the river in meters.),\n  (country_name:text, The name of the country the river flows through.),\n  (traverse:text, The cities or landmarks the river passes through. Comma delimited and in title case, eg `New York,Albany,Boston`.),\n]\n# Table: state\n[\n  (state_name:text, The name of the state. Value examples: ['California', 'Texas', 'Florida', 'New York'].),\n  (population:bigint, The population of the state. Value examples: ['100000', '50000', '150000', '200000'].),\n  (area:double, The area of the state in square kilometers. Value examples: ['10000', '5000', '15000', '20000'].),\n  (country_name:text, The name of the country the state belongs to. Value examples: ['United States', 'United States', 'United States', 'United States'].),\n  (capital:text, The name of the capital city of the state. Value examples: ['Sacramento', 'Austin', 'Tallahassee', 'Albany'].),\n  (density:double, The population density of the state in people per square kilometer. Value examples: ['1000', '1000', '1000', '1000'].),\n]\n\n【Foreign keys】\nborder_info.state_name = city.state_name\nborder_info.state_name = lake.state_name\nborder_info.state_name = state.state_name\nborder_info.state_name = highlow.state_name\nborder_info.state_name = mountain.state_name\ncity.country_name = lake.country_name\ncity.country_name = river.country_name\ncity.country_name = state.country_name\ncity.country_name = mountain.country_name\ncity.state_name = highlow.state_name\nhighlow.state_name = lake.state_name\nhighlow.state_name = state.state_name\nhighlow.state_name = mountain.state_name\nlake.country_name = river.country_name\nlake.country_name = state.country_name\nlake.country_name = mountain.country_name\nriver.country_name = state.country_name\nriver.country_name = mountain.country_name\nstate.country_name = mountain.country_name\n\n【参考信息】\nAlways filter names using ILIKE\n\n【用户问题】\nGet the cities in the United States and their population\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT city_name, population FROM city WHERE country_name ILIKE '%United States%';",
        "role": "assistant"
      }
    ],
    "db_name": "geography",
    "id": 114,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the total number of restaurants serving each type of food?\n\n【数据库schema】\n【DB_ID】 restaurants\n【Schema】\n# Table: geographic\n[\n  (city_name:text, The name of the city. Value examples: ['Los Angeles', 'New York'].),\n  (county:text, The name of the county. Value examples: ['Los Angeles', 'New York'].),\n  (region:text, The name of the region. Value examples: ['California', 'New York'].),\n]\n# Table: location\n[\n  (restaurant_id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2'].),\n  (house_number:bigint, The number assigned to the building where the restaurant is located. Value examples: ['123', '456'].),\n  (street_name:text, The name of the street where the restaurant is located. Value examples: ['Main St', 'Maple Ave'].),\n  (city_name:text, The name of the city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles'].),\n]\n# Table: restaurant\n[\n  (id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2', '3'].),\n  (name:text, The name of the restaurant. Value examples: ['The Pasta House', 'The Burger Joint', 'The Sushi Bar'].),\n  (food_type:text, The type of food served at the restaurant. Value examples: ['Italian', 'American', 'Japanese'].),\n  (city_name:text, The city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles', 'Los Angeles'].),\n  (rating:real, The rating of the restaurant on a scale of 0 to 5. Value examples: ['4.5', '3.8', '4.2'].),\n]\n\n【Foreign keys】\ngeographic.city_name = location.city_name\ngeographic.city_name = restaurant.city_name\nlocation.restaurant_id = restaurant.id\n\n【参考信息】\n\n\n【用户问题】\nWhat is the total number of restaurants serving each type of food?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT restaurant.food_type, COUNT(DISTINCT restaurant.id) AS total_number_of_restaurants FROM restaurant GROUP BY restaurant.food_type;",
        "role": "assistant"
      }
    ],
    "db_name": "restaurants",
    "id": 115,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the total count of restaurants in each city?\n\n【数据库schema】\n【DB_ID】 restaurants\n【Schema】\n# Table: geographic\n[\n  (city_name:text, The name of the city. Value examples: ['Los Angeles', 'New York'].),\n  (county:text, The name of the county. Value examples: ['Los Angeles', 'New York'].),\n  (region:text, The name of the region. Value examples: ['California', 'New York'].),\n]\n# Table: location\n[\n  (restaurant_id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2'].),\n  (house_number:bigint, The number assigned to the building where the restaurant is located. Value examples: ['123', '456'].),\n  (street_name:text, The name of the street where the restaurant is located. Value examples: ['Main St', 'Maple Ave'].),\n  (city_name:text, The name of the city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles'].),\n]\n# Table: restaurant\n[\n  (id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2', '3'].),\n  (name:text, The name of the restaurant. Value examples: ['The Pasta House', 'The Burger Joint', 'The Sushi Bar'].),\n  (food_type:text, The type of food served at the restaurant. Value examples: ['Italian', 'American', 'Japanese'].),\n  (city_name:text, The city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles', 'Los Angeles'].),\n  (rating:real, The rating of the restaurant on a scale of 0 to 5. Value examples: ['4.5', '3.8', '4.2'].),\n]\n\n【Foreign keys】\ngeographic.city_name = location.city_name\ngeographic.city_name = restaurant.city_name\nlocation.restaurant_id = restaurant.id\n\n【参考信息】\n\n\n【用户问题】\nWhat is the total count of restaurants in each city?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT location.city_name, COUNT(DISTINCT location.restaurant_id) AS total_count FROM LOCATION GROUP BY location.city_name;",
        "role": "assistant"
      }
    ],
    "db_name": "restaurants",
    "id": 116,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the average rating of restaurants serving each type of food?\n\n【数据库schema】\n【DB_ID】 restaurants\n【Schema】\n# Table: geographic\n[\n  (city_name:text, The name of the city. Value examples: ['Los Angeles', 'New York'].),\n  (county:text, The name of the county. Value examples: ['Los Angeles', 'New York'].),\n  (region:text, The name of the region. Value examples: ['California', 'New York'].),\n]\n# Table: location\n[\n  (restaurant_id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2'].),\n  (house_number:bigint, The number assigned to the building where the restaurant is located. Value examples: ['123', '456'].),\n  (street_name:text, The name of the street where the restaurant is located. Value examples: ['Main St', 'Maple Ave'].),\n  (city_name:text, The name of the city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles'].),\n]\n# Table: restaurant\n[\n  (id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2', '3'].),\n  (name:text, The name of the restaurant. Value examples: ['The Pasta House', 'The Burger Joint', 'The Sushi Bar'].),\n  (food_type:text, The type of food served at the restaurant. Value examples: ['Italian', 'American', 'Japanese'].),\n  (city_name:text, The city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles', 'Los Angeles'].),\n  (rating:real, The rating of the restaurant on a scale of 0 to 5. Value examples: ['4.5', '3.8', '4.2'].),\n]\n\n【Foreign keys】\ngeographic.city_name = location.city_name\ngeographic.city_name = restaurant.city_name\nlocation.restaurant_id = restaurant.id\n\n【参考信息】\n\n\n【用户问题】\nWhat is the average rating of restaurants serving each type of food?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT restaurant.food_type, AVG(restaurant.rating) AS average_rating FROM restaurant GROUP BY restaurant.food_type ORDER BY average_rating DESC NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "restaurants",
    "id": 117,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many restaurants serve Italian food in each city?\n\n【数据库schema】\n【DB_ID】 restaurants\n【Schema】\n# Table: geographic\n[\n  (city_name:text, The name of the city. Value examples: ['Los Angeles', 'New York'].),\n  (county:text, The name of the county. Value examples: ['Los Angeles', 'New York'].),\n  (region:text, The name of the region. Value examples: ['California', 'New York'].),\n]\n# Table: location\n[\n  (restaurant_id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2'].),\n  (house_number:bigint, The number assigned to the building where the restaurant is located. Value examples: ['123', '456'].),\n  (street_name:text, The name of the street where the restaurant is located. Value examples: ['Main St', 'Maple Ave'].),\n  (city_name:text, The name of the city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles'].),\n]\n# Table: restaurant\n[\n  (id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2', '3'].),\n  (name:text, The name of the restaurant. Value examples: ['The Pasta House', 'The Burger Joint', 'The Sushi Bar'].),\n  (food_type:text, The type of food served at the restaurant. Value examples: ['Italian', 'American', 'Japanese'].),\n  (city_name:text, The city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles', 'Los Angeles'].),\n  (rating:real, The rating of the restaurant on a scale of 0 to 5. Value examples: ['4.5', '3.8', '4.2'].),\n]\n\n【Foreign keys】\ngeographic.city_name = location.city_name\ngeographic.city_name = restaurant.city_name\nlocation.restaurant_id = restaurant.id\n\n【参考信息】\n\n\n【用户问题】\nHow many restaurants serve Italian food in each city?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT restaurant.city_name, COUNT(*) AS number_of_restaurants FROM restaurant WHERE restaurant.food_type ILIKE '%Italian%' GROUP BY restaurant.city_name ORDER BY number_of_restaurants DESC NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "restaurants",
    "id": 118,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many restaurants are there in each city? Order the results by the number of restaurants in descending order.\n\n【数据库schema】\n【DB_ID】 restaurants\n【Schema】\n# Table: geographic\n[\n  (city_name:text, The name of the city. Value examples: ['Los Angeles', 'New York'].),\n  (county:text, The name of the county. Value examples: ['Los Angeles', 'New York'].),\n  (region:text, The name of the region. Value examples: ['California', 'New York'].),\n]\n# Table: location\n[\n  (restaurant_id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2'].),\n  (house_number:bigint, The number assigned to the building where the restaurant is located. Value examples: ['123', '456'].),\n  (street_name:text, The name of the street where the restaurant is located. Value examples: ['Main St', 'Maple Ave'].),\n  (city_name:text, The name of the city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles'].),\n]\n# Table: restaurant\n[\n  (id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2', '3'].),\n  (name:text, The name of the restaurant. Value examples: ['The Pasta House', 'The Burger Joint', 'The Sushi Bar'].),\n  (food_type:text, The type of food served at the restaurant. Value examples: ['Italian', 'American', 'Japanese'].),\n  (city_name:text, The city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles', 'Los Angeles'].),\n  (rating:real, The rating of the restaurant on a scale of 0 to 5. Value examples: ['4.5', '3.8', '4.2'].),\n]\n\n【Foreign keys】\ngeographic.city_name = location.city_name\ngeographic.city_name = restaurant.city_name\nlocation.restaurant_id = restaurant.id\n\n【参考信息】\n\n\n【用户问题】\nHow many restaurants are there in each city? Order the results by the number of restaurants in descending order.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT location.city_name, COUNT(DISTINCT location.restaurant_id) AS number_of_restaurants FROM LOCATION GROUP BY location.city_name ORDER BY number_of_restaurants DESC NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "restaurants",
    "id": 119,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich street has the most number of restaurants?\n\n【数据库schema】\n【DB_ID】 restaurants\n【Schema】\n# Table: geographic\n[\n  (city_name:text, The name of the city. Value examples: ['Los Angeles', 'New York'].),\n  (county:text, The name of the county. Value examples: ['Los Angeles', 'New York'].),\n  (region:text, The name of the region. Value examples: ['California', 'New York'].),\n]\n# Table: location\n[\n  (restaurant_id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2'].),\n  (house_number:bigint, The number assigned to the building where the restaurant is located. Value examples: ['123', '456'].),\n  (street_name:text, The name of the street where the restaurant is located. Value examples: ['Main St', 'Maple Ave'].),\n  (city_name:text, The name of the city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles'].),\n]\n# Table: restaurant\n[\n  (id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2', '3'].),\n  (name:text, The name of the restaurant. Value examples: ['The Pasta House', 'The Burger Joint', 'The Sushi Bar'].),\n  (food_type:text, The type of food served at the restaurant. Value examples: ['Italian', 'American', 'Japanese'].),\n  (city_name:text, The city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles', 'Los Angeles'].),\n  (rating:real, The rating of the restaurant on a scale of 0 to 5. Value examples: ['4.5', '3.8', '4.2'].),\n]\n\n【Foreign keys】\ngeographic.city_name = location.city_name\ngeographic.city_name = restaurant.city_name\nlocation.restaurant_id = restaurant.id\n\n【参考信息】\n\n\n【用户问题】\nWhich street has the most number of restaurants?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT street_name FROM location GROUP BY street_name ORDER BY COUNT(restaurant_id) DESC LIMIT 1;",
        "role": "assistant"
      }
    ],
    "db_name": "restaurants",
    "id": 120,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich restaurants serve Italian cuisine or are located in New York? Order the results by the restaurant name.\n\n【数据库schema】\n【DB_ID】 restaurants\n【Schema】\n# Table: geographic\n[\n  (city_name:text, The name of the city. Value examples: ['Los Angeles', 'New York'].),\n  (county:text, The name of the county. Value examples: ['Los Angeles', 'New York'].),\n  (region:text, The name of the region. Value examples: ['California', 'New York'].),\n]\n# Table: location\n[\n  (restaurant_id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2'].),\n  (house_number:bigint, The number assigned to the building where the restaurant is located. Value examples: ['123', '456'].),\n  (street_name:text, The name of the street where the restaurant is located. Value examples: ['Main St', 'Maple Ave'].),\n  (city_name:text, The name of the city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles'].),\n]\n# Table: restaurant\n[\n  (id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2', '3'].),\n  (name:text, The name of the restaurant. Value examples: ['The Pasta House', 'The Burger Joint', 'The Sushi Bar'].),\n  (food_type:text, The type of food served at the restaurant. Value examples: ['Italian', 'American', 'Japanese'].),\n  (city_name:text, The city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles', 'Los Angeles'].),\n  (rating:real, The rating of the restaurant on a scale of 0 to 5. Value examples: ['4.5', '3.8', '4.2'].),\n]\n\n【Foreign keys】\ngeographic.city_name = location.city_name\ngeographic.city_name = restaurant.city_name\nlocation.restaurant_id = restaurant.id\n\n【参考信息】\n\n\n【用户问题】\nWhich restaurants serve Italian cuisine or are located in New York? Order the results by the restaurant name.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT name FROM restaurant WHERE food_type ILIKE '%Italian%' OR city_name ILIKE '%New York%' ORDER BY name NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "restaurants",
    "id": 121,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the average rating of restaurants in each region? Order the results by the region name.\n\n【数据库schema】\n【DB_ID】 restaurants\n【Schema】\n# Table: geographic\n[\n  (city_name:text, The name of the city. Value examples: ['Los Angeles', 'New York'].),\n  (county:text, The name of the county. Value examples: ['Los Angeles', 'New York'].),\n  (region:text, The name of the region. Value examples: ['California', 'New York'].),\n]\n# Table: location\n[\n  (restaurant_id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2'].),\n  (house_number:bigint, The number assigned to the building where the restaurant is located. Value examples: ['123', '456'].),\n  (street_name:text, The name of the street where the restaurant is located. Value examples: ['Main St', 'Maple Ave'].),\n  (city_name:text, The name of the city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles'].),\n]\n# Table: restaurant\n[\n  (id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2', '3'].),\n  (name:text, The name of the restaurant. Value examples: ['The Pasta House', 'The Burger Joint', 'The Sushi Bar'].),\n  (food_type:text, The type of food served at the restaurant. Value examples: ['Italian', 'American', 'Japanese'].),\n  (city_name:text, The city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles', 'Los Angeles'].),\n  (rating:real, The rating of the restaurant on a scale of 0 to 5. Value examples: ['4.5', '3.8', '4.2'].),\n]\n\n【Foreign keys】\ngeographic.city_name = location.city_name\ngeographic.city_name = restaurant.city_name\nlocation.restaurant_id = restaurant.id\n\n【参考信息】\n\n\n【用户问题】\nWhat is the average rating of restaurants in each region? Order the results by the region name.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT geographic.region, AVG(restaurant.rating) AS average_rating FROM restaurant JOIN geographic ON restaurant.city_name = geographic.city_name GROUP BY geographic.region ORDER BY geographic.region NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "restaurants",
    "id": 122,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the names of the top 3 restaurants with the highest ratings?\n\n【数据库schema】\n【DB_ID】 restaurants\n【Schema】\n# Table: geographic\n[\n  (city_name:text, The name of the city. Value examples: ['Los Angeles', 'New York'].),\n  (county:text, The name of the county. Value examples: ['Los Angeles', 'New York'].),\n  (region:text, The name of the region. Value examples: ['California', 'New York'].),\n]\n# Table: location\n[\n  (restaurant_id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2'].),\n  (house_number:bigint, The number assigned to the building where the restaurant is located. Value examples: ['123', '456'].),\n  (street_name:text, The name of the street where the restaurant is located. Value examples: ['Main St', 'Maple Ave'].),\n  (city_name:text, The name of the city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles'].),\n]\n# Table: restaurant\n[\n  (id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2', '3'].),\n  (name:text, The name of the restaurant. Value examples: ['The Pasta House', 'The Burger Joint', 'The Sushi Bar'].),\n  (food_type:text, The type of food served at the restaurant. Value examples: ['Italian', 'American', 'Japanese'].),\n  (city_name:text, The city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles', 'Los Angeles'].),\n  (rating:real, The rating of the restaurant on a scale of 0 to 5. Value examples: ['4.5', '3.8', '4.2'].),\n]\n\n【Foreign keys】\ngeographic.city_name = location.city_name\ngeographic.city_name = restaurant.city_name\nlocation.restaurant_id = restaurant.id\n\n【参考信息】\n\n\n【用户问题】\nWhat are the names of the top 3 restaurants with the highest ratings?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT restaurant.name FROM restaurant ORDER BY restaurant.rating DESC NULLS LAST LIMIT 3;",
        "role": "assistant"
      }
    ],
    "db_name": "restaurants",
    "id": 123,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nList the restaurants starting from the best ratings to the lowest\n\n【数据库schema】\n【DB_ID】 restaurants\n【Schema】\n# Table: geographic\n[\n  (city_name:text, The name of the city. Value examples: ['Los Angeles', 'New York'].),\n  (county:text, The name of the county. Value examples: ['Los Angeles', 'New York'].),\n  (region:text, The name of the region. Value examples: ['California', 'New York'].),\n]\n# Table: location\n[\n  (restaurant_id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2'].),\n  (house_number:bigint, The number assigned to the building where the restaurant is located. Value examples: ['123', '456'].),\n  (street_name:text, The name of the street where the restaurant is located. Value examples: ['Main St', 'Maple Ave'].),\n  (city_name:text, The name of the city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles'].),\n]\n# Table: restaurant\n[\n  (id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2', '3'].),\n  (name:text, The name of the restaurant. Value examples: ['The Pasta House', 'The Burger Joint', 'The Sushi Bar'].),\n  (food_type:text, The type of food served at the restaurant. Value examples: ['Italian', 'American', 'Japanese'].),\n  (city_name:text, The city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles', 'Los Angeles'].),\n  (rating:real, The rating of the restaurant on a scale of 0 to 5. Value examples: ['4.5', '3.8', '4.2'].),\n]\n\n【Foreign keys】\ngeographic.city_name = location.city_name\ngeographic.city_name = restaurant.city_name\nlocation.restaurant_id = restaurant.id\n\n【参考信息】\n\n\n【用户问题】\nList the restaurants starting from the best ratings to the lowest\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT name, id, rating FROM restaurant ORDER BY rating DESC",
        "role": "assistant"
      }
    ],
    "db_name": "restaurants",
    "id": 124,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the ratio of restaurants with rating > 4.5 to the total number of restaurants in the database.\n\n【数据库schema】\n【DB_ID】 restaurants\n【Schema】\n# Table: geographic\n[\n  (city_name:text, The name of the city. Value examples: ['Los Angeles', 'New York'].),\n  (county:text, The name of the county. Value examples: ['Los Angeles', 'New York'].),\n  (region:text, The name of the region. Value examples: ['California', 'New York'].),\n]\n# Table: location\n[\n  (restaurant_id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2'].),\n  (house_number:bigint, The number assigned to the building where the restaurant is located. Value examples: ['123', '456'].),\n  (street_name:text, The name of the street where the restaurant is located. Value examples: ['Main St', 'Maple Ave'].),\n  (city_name:text, The name of the city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles'].),\n]\n# Table: restaurant\n[\n  (id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2', '3'].),\n  (name:text, The name of the restaurant. Value examples: ['The Pasta House', 'The Burger Joint', 'The Sushi Bar'].),\n  (food_type:text, The type of food served at the restaurant. Value examples: ['Italian', 'American', 'Japanese'].),\n  (city_name:text, The city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles', 'Los Angeles'].),\n  (rating:real, The rating of the restaurant on a scale of 0 to 5. Value examples: ['4.5', '3.8', '4.2'].),\n]\n\n【Foreign keys】\ngeographic.city_name = location.city_name\ngeographic.city_name = restaurant.city_name\nlocation.restaurant_id = restaurant.id\n\n【参考信息】\n\n\n【用户问题】\nWhat is the ratio of restaurants with rating > 4.5 to the total number of restaurants in the database.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT COUNT(*)::float / NULLIF((SELECT COUNT(*) FROM restaurant), 0) AS rating_ratio FROM restaurant WHERE rating > 4.5;",
        "role": "assistant"
      }
    ],
    "db_name": "restaurants",
    "id": 125,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the ratio of restaurants with a rating above 4.0 to restaurants with a rating below 4.0 overall?\n\n【数据库schema】\n【DB_ID】 restaurants\n【Schema】\n# Table: geographic\n[\n  (city_name:text, The name of the city. Value examples: ['Los Angeles', 'New York'].),\n  (county:text, The name of the county. Value examples: ['Los Angeles', 'New York'].),\n  (region:text, The name of the region. Value examples: ['California', 'New York'].),\n]\n# Table: location\n[\n  (restaurant_id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2'].),\n  (house_number:bigint, The number assigned to the building where the restaurant is located. Value examples: ['123', '456'].),\n  (street_name:text, The name of the street where the restaurant is located. Value examples: ['Main St', 'Maple Ave'].),\n  (city_name:text, The name of the city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles'].),\n]\n# Table: restaurant\n[\n  (id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2', '3'].),\n  (name:text, The name of the restaurant. Value examples: ['The Pasta House', 'The Burger Joint', 'The Sushi Bar'].),\n  (food_type:text, The type of food served at the restaurant. Value examples: ['Italian', 'American', 'Japanese'].),\n  (city_name:text, The city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles', 'Los Angeles'].),\n  (rating:real, The rating of the restaurant on a scale of 0 to 5. Value examples: ['4.5', '3.8', '4.2'].),\n]\n\n【Foreign keys】\ngeographic.city_name = location.city_name\ngeographic.city_name = restaurant.city_name\nlocation.restaurant_id = restaurant.id\n\n【参考信息】\n\n\n【用户问题】\nWhat is the ratio of restaurants with a rating above 4.0 to restaurants with a rating below 4.0 overall?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT CAST(SUM(CASE WHEN restaurant.rating > 4.0 THEN 1 ELSE 0 END) AS FLOAT) / NULLIF(SUM(CASE WHEN restaurant.rating < 4.0 THEN 1 ELSE 0 END), 0) AS ratio FROM restaurant;",
        "role": "assistant"
      }
    ],
    "db_name": "restaurants",
    "id": 126,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the ratio of restaurants with a rating above 4 to restaurants with a rating below 4 in New York?\n\n【数据库schema】\n【DB_ID】 restaurants\n【Schema】\n# Table: geographic\n[\n  (city_name:text, The name of the city. Value examples: ['Los Angeles', 'New York'].),\n  (county:text, The name of the county. Value examples: ['Los Angeles', 'New York'].),\n  (region:text, The name of the region. Value examples: ['California', 'New York'].),\n]\n# Table: location\n[\n  (restaurant_id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2'].),\n  (house_number:bigint, The number assigned to the building where the restaurant is located. Value examples: ['123', '456'].),\n  (street_name:text, The name of the street where the restaurant is located. Value examples: ['Main St', 'Maple Ave'].),\n  (city_name:text, The name of the city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles'].),\n]\n# Table: restaurant\n[\n  (id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2', '3'].),\n  (name:text, The name of the restaurant. Value examples: ['The Pasta House', 'The Burger Joint', 'The Sushi Bar'].),\n  (food_type:text, The type of food served at the restaurant. Value examples: ['Italian', 'American', 'Japanese'].),\n  (city_name:text, The city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles', 'Los Angeles'].),\n  (rating:real, The rating of the restaurant on a scale of 0 to 5. Value examples: ['4.5', '3.8', '4.2'].),\n]\n\n【Foreign keys】\ngeographic.city_name = location.city_name\ngeographic.city_name = restaurant.city_name\nlocation.restaurant_id = restaurant.id\n\n【参考信息】\n\n\n【用户问题】\nWhat is the ratio of restaurants with a rating above 4 to restaurants with a rating below 4 in New York?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT CAST(COUNT(CASE WHEN rating > 4 THEN 1 END) AS FLOAT) / NULLIF(COUNT(CASE WHEN rating < 4 THEN 1 END), 0) AS ratio FROM restaurant WHERE city_name ILIKE 'New York';",
        "role": "assistant"
      }
    ],
    "db_name": "restaurants",
    "id": 127,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the ratio of restaurants serving vegan food to restaurants serving non-vegan food in San Francisco? Match food_type case insensitively\n\n【数据库schema】\n【DB_ID】 restaurants\n【Schema】\n# Table: geographic\n[\n  (city_name:text, The name of the city. Value examples: ['Los Angeles', 'New York'].),\n  (county:text, The name of the county. Value examples: ['Los Angeles', 'New York'].),\n  (region:text, The name of the region. Value examples: ['California', 'New York'].),\n]\n# Table: location\n[\n  (restaurant_id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2'].),\n  (house_number:bigint, The number assigned to the building where the restaurant is located. Value examples: ['123', '456'].),\n  (street_name:text, The name of the street where the restaurant is located. Value examples: ['Main St', 'Maple Ave'].),\n  (city_name:text, The name of the city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles'].),\n]\n# Table: restaurant\n[\n  (id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2', '3'].),\n  (name:text, The name of the restaurant. Value examples: ['The Pasta House', 'The Burger Joint', 'The Sushi Bar'].),\n  (food_type:text, The type of food served at the restaurant. Value examples: ['Italian', 'American', 'Japanese'].),\n  (city_name:text, The city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles', 'Los Angeles'].),\n  (rating:real, The rating of the restaurant on a scale of 0 to 5. Value examples: ['4.5', '3.8', '4.2'].),\n]\n\n【Foreign keys】\ngeographic.city_name = location.city_name\ngeographic.city_name = restaurant.city_name\nlocation.restaurant_id = restaurant.id\n\n【参考信息】\n\n\n【用户问题】\nWhat is the ratio of restaurants serving vegan food to restaurants serving non-vegan food in San Francisco? Match food_type case insensitively\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT CAST(SUM(CASE WHEN LOWER(restaurant.food_type) LIKE '%vegan%' THEN 1 ELSE 0 END) AS FLOAT) / NULLIF(SUM(CASE WHEN LOWER(restaurant.food_type) NOT LIKE '%vegan%' THEN 1 ELSE 0 END), 0) AS ratio FROM restaurant WHERE LOWER(restaurant.city_name) ILIKE '%san francisco%';",
        "role": "assistant"
      }
    ],
    "db_name": "restaurants",
    "id": 128,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the ratio of Italian restaurants out of all restaurants in Los Angeles?\n\n【数据库schema】\n【DB_ID】 restaurants\n【Schema】\n# Table: geographic\n[\n  (city_name:text, The name of the city. Value examples: ['Los Angeles', 'New York'].),\n  (county:text, The name of the county. Value examples: ['Los Angeles', 'New York'].),\n  (region:text, The name of the region. Value examples: ['California', 'New York'].),\n]\n# Table: location\n[\n  (restaurant_id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2'].),\n  (house_number:bigint, The number assigned to the building where the restaurant is located. Value examples: ['123', '456'].),\n  (street_name:text, The name of the street where the restaurant is located. Value examples: ['Main St', 'Maple Ave'].),\n  (city_name:text, The name of the city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles'].),\n]\n# Table: restaurant\n[\n  (id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2', '3'].),\n  (name:text, The name of the restaurant. Value examples: ['The Pasta House', 'The Burger Joint', 'The Sushi Bar'].),\n  (food_type:text, The type of food served at the restaurant. Value examples: ['Italian', 'American', 'Japanese'].),\n  (city_name:text, The city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles', 'Los Angeles'].),\n  (rating:real, The rating of the restaurant on a scale of 0 to 5. Value examples: ['4.5', '3.8', '4.2'].),\n]\n\n【Foreign keys】\ngeographic.city_name = location.city_name\ngeographic.city_name = restaurant.city_name\nlocation.restaurant_id = restaurant.id\n\n【参考信息】\n\n\n【用户问题】\nWhat is the ratio of Italian restaurants out of all restaurants in Los Angeles?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT CAST(COUNT(CASE WHEN food_type ILIKE '%Italian%' THEN 1 END) AS FLOAT) / NULLIF(COUNT(food_type), 0) AS ratio FROM restaurant WHERE city_name ILIKE '%Los Angeles%';",
        "role": "assistant"
      }
    ],
    "db_name": "restaurants",
    "id": 129,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich restaurants have the same name in each city, and what is the count?\n\n【数据库schema】\n【DB_ID】 restaurants\n【Schema】\n# Table: geographic\n[\n  (city_name:text, The name of the city. Value examples: ['Los Angeles', 'New York'].),\n  (county:text, The name of the county. Value examples: ['Los Angeles', 'New York'].),\n  (region:text, The name of the region. Value examples: ['California', 'New York'].),\n]\n# Table: location\n[\n  (restaurant_id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2'].),\n  (house_number:bigint, The number assigned to the building where the restaurant is located. Value examples: ['123', '456'].),\n  (street_name:text, The name of the street where the restaurant is located. Value examples: ['Main St', 'Maple Ave'].),\n  (city_name:text, The name of the city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles'].),\n]\n# Table: restaurant\n[\n  (id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2', '3'].),\n  (name:text, The name of the restaurant. Value examples: ['The Pasta House', 'The Burger Joint', 'The Sushi Bar'].),\n  (food_type:text, The type of food served at the restaurant. Value examples: ['Italian', 'American', 'Japanese'].),\n  (city_name:text, The city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles', 'Los Angeles'].),\n  (rating:real, The rating of the restaurant on a scale of 0 to 5. Value examples: ['4.5', '3.8', '4.2'].),\n]\n\n【Foreign keys】\ngeographic.city_name = location.city_name\ngeographic.city_name = restaurant.city_name\nlocation.restaurant_id = restaurant.id\n\n【参考信息】\n\n\n【用户问题】\nWhich restaurants have the same name in each city, and what is the count?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT r.city_name, r.name, COUNT(r.id) AS restaurant_count FROM restaurant r GROUP BY r.city_name, r.name HAVING COUNT(r.id) > 1",
        "role": "assistant"
      }
    ],
    "db_name": "restaurants",
    "id": 130,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the average rating of restaurants that serve Mexican food in each city?\n\n【数据库schema】\n【DB_ID】 restaurants\n【Schema】\n# Table: geographic\n[\n  (city_name:text, The name of the city. Value examples: ['Los Angeles', 'New York'].),\n  (county:text, The name of the county. Value examples: ['Los Angeles', 'New York'].),\n  (region:text, The name of the region. Value examples: ['California', 'New York'].),\n]\n# Table: location\n[\n  (restaurant_id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2'].),\n  (house_number:bigint, The number assigned to the building where the restaurant is located. Value examples: ['123', '456'].),\n  (street_name:text, The name of the street where the restaurant is located. Value examples: ['Main St', 'Maple Ave'].),\n  (city_name:text, The name of the city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles'].),\n]\n# Table: restaurant\n[\n  (id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2', '3'].),\n  (name:text, The name of the restaurant. Value examples: ['The Pasta House', 'The Burger Joint', 'The Sushi Bar'].),\n  (food_type:text, The type of food served at the restaurant. Value examples: ['Italian', 'American', 'Japanese'].),\n  (city_name:text, The city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles', 'Los Angeles'].),\n  (rating:real, The rating of the restaurant on a scale of 0 to 5. Value examples: ['4.5', '3.8', '4.2'].),\n]\n\n【Foreign keys】\ngeographic.city_name = location.city_name\ngeographic.city_name = restaurant.city_name\nlocation.restaurant_id = restaurant.id\n\n【参考信息】\n\n\n【用户问题】\nWhat is the average rating of restaurants that serve Mexican food in each city?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT location.city_name, AVG(restaurant.rating) AS average_rating FROM restaurant JOIN LOCATION ON restaurant.id = location.restaurant_id WHERE LOWER(restaurant.food_type) LIKE '%mexican%' GROUP BY location.city_name;",
        "role": "assistant"
      }
    ],
    "db_name": "restaurants",
    "id": 131,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the average rating of restaurants in each region?\n\n【数据库schema】\n【DB_ID】 restaurants\n【Schema】\n# Table: geographic\n[\n  (city_name:text, The name of the city. Value examples: ['Los Angeles', 'New York'].),\n  (county:text, The name of the county. Value examples: ['Los Angeles', 'New York'].),\n  (region:text, The name of the region. Value examples: ['California', 'New York'].),\n]\n# Table: location\n[\n  (restaurant_id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2'].),\n  (house_number:bigint, The number assigned to the building where the restaurant is located. Value examples: ['123', '456'].),\n  (street_name:text, The name of the street where the restaurant is located. Value examples: ['Main St', 'Maple Ave'].),\n  (city_name:text, The name of the city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles'].),\n]\n# Table: restaurant\n[\n  (id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2', '3'].),\n  (name:text, The name of the restaurant. Value examples: ['The Pasta House', 'The Burger Joint', 'The Sushi Bar'].),\n  (food_type:text, The type of food served at the restaurant. Value examples: ['Italian', 'American', 'Japanese'].),\n  (city_name:text, The city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles', 'Los Angeles'].),\n  (rating:real, The rating of the restaurant on a scale of 0 to 5. Value examples: ['4.5', '3.8', '4.2'].),\n]\n\n【Foreign keys】\ngeographic.city_name = location.city_name\ngeographic.city_name = restaurant.city_name\nlocation.restaurant_id = restaurant.id\n\n【参考信息】\n\n\n【用户问题】\nWhat is the average rating of restaurants in each region?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT geographic.region, AVG(restaurant.rating) AS average_rating FROM geographic JOIN restaurant ON geographic.city_name=restaurant.city_name GROUP BY 1;",
        "role": "assistant"
      }
    ],
    "db_name": "restaurants",
    "id": 132,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many restaurants serve Italian food in each region?\n\n【数据库schema】\n【DB_ID】 restaurants\n【Schema】\n# Table: geographic\n[\n  (city_name:text, The name of the city. Value examples: ['Los Angeles', 'New York'].),\n  (county:text, The name of the county. Value examples: ['Los Angeles', 'New York'].),\n  (region:text, The name of the region. Value examples: ['California', 'New York'].),\n]\n# Table: location\n[\n  (restaurant_id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2'].),\n  (house_number:bigint, The number assigned to the building where the restaurant is located. Value examples: ['123', '456'].),\n  (street_name:text, The name of the street where the restaurant is located. Value examples: ['Main St', 'Maple Ave'].),\n  (city_name:text, The name of the city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles'].),\n]\n# Table: restaurant\n[\n  (id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2', '3'].),\n  (name:text, The name of the restaurant. Value examples: ['The Pasta House', 'The Burger Joint', 'The Sushi Bar'].),\n  (food_type:text, The type of food served at the restaurant. Value examples: ['Italian', 'American', 'Japanese'].),\n  (city_name:text, The city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles', 'Los Angeles'].),\n  (rating:real, The rating of the restaurant on a scale of 0 to 5. Value examples: ['4.5', '3.8', '4.2'].),\n]\n\n【Foreign keys】\ngeographic.city_name = location.city_name\ngeographic.city_name = restaurant.city_name\nlocation.restaurant_id = restaurant.id\n\n【参考信息】\n\n\n【用户问题】\nHow many restaurants serve Italian food in each region?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT geographic.region, COUNT(restaurant.id) AS number_of_restaurants FROM restaurant JOIN geographic ON restaurant.city_name = geographic.city_name WHERE LOWER(restaurant.food_type) LIKE '%italian%' GROUP BY geographic.region ORDER BY number_of_restaurants DESC NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "restaurants",
    "id": 133,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many restaurants are there in each region?\n\n【数据库schema】\n【DB_ID】 restaurants\n【Schema】\n# Table: geographic\n[\n  (city_name:text, The name of the city. Value examples: ['Los Angeles', 'New York'].),\n  (county:text, The name of the county. Value examples: ['Los Angeles', 'New York'].),\n  (region:text, The name of the region. Value examples: ['California', 'New York'].),\n]\n# Table: location\n[\n  (restaurant_id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2'].),\n  (house_number:bigint, The number assigned to the building where the restaurant is located. Value examples: ['123', '456'].),\n  (street_name:text, The name of the street where the restaurant is located. Value examples: ['Main St', 'Maple Ave'].),\n  (city_name:text, The name of the city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles'].),\n]\n# Table: restaurant\n[\n  (id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2', '3'].),\n  (name:text, The name of the restaurant. Value examples: ['The Pasta House', 'The Burger Joint', 'The Sushi Bar'].),\n  (food_type:text, The type of food served at the restaurant. Value examples: ['Italian', 'American', 'Japanese'].),\n  (city_name:text, The city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles', 'Los Angeles'].),\n  (rating:real, The rating of the restaurant on a scale of 0 to 5. Value examples: ['4.5', '3.8', '4.2'].),\n]\n\n【Foreign keys】\ngeographic.city_name = location.city_name\ngeographic.city_name = restaurant.city_name\nlocation.restaurant_id = restaurant.id\n\n【参考信息】\n\n\n【用户问题】\nHow many restaurants are there in each region?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT geographic.region, COUNT(DISTINCT restaurant.id) AS number_of_restaurants FROM geographic JOIN restaurant ON geographic.city_name = restaurant.city_name GROUP BY geographic.region ORDER BY number_of_restaurants DESC;SELECT geographic.region, COUNT(DISTINCT restaurant.id) AS number_of_restaurants FROM geographic LEFT JOIN restaurant ON geographic.city_name = restaurant.city_name GROUP BY geographic.region ORDER BY number_of_restaurants DESC;",
        "role": "assistant"
      }
    ],
    "db_name": "restaurants",
    "id": 134,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich city has the highest-rated restaurant?\n\n【数据库schema】\n【DB_ID】 restaurants\n【Schema】\n# Table: geographic\n[\n  (city_name:text, The name of the city. Value examples: ['Los Angeles', 'New York'].),\n  (county:text, The name of the county. Value examples: ['Los Angeles', 'New York'].),\n  (region:text, The name of the region. Value examples: ['California', 'New York'].),\n]\n# Table: location\n[\n  (restaurant_id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2'].),\n  (house_number:bigint, The number assigned to the building where the restaurant is located. Value examples: ['123', '456'].),\n  (street_name:text, The name of the street where the restaurant is located. Value examples: ['Main St', 'Maple Ave'].),\n  (city_name:text, The name of the city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles'].),\n]\n# Table: restaurant\n[\n  (id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2', '3'].),\n  (name:text, The name of the restaurant. Value examples: ['The Pasta House', 'The Burger Joint', 'The Sushi Bar'].),\n  (food_type:text, The type of food served at the restaurant. Value examples: ['Italian', 'American', 'Japanese'].),\n  (city_name:text, The city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles', 'Los Angeles'].),\n  (rating:real, The rating of the restaurant on a scale of 0 to 5. Value examples: ['4.5', '3.8', '4.2'].),\n]\n\n【Foreign keys】\ngeographic.city_name = location.city_name\ngeographic.city_name = restaurant.city_name\nlocation.restaurant_id = restaurant.id\n\n【参考信息】\nMatch city_name and food_type case-insensitively. Match with ILIKE and percent sign for substring matching for all other string matches.\n\n【用户问题】\nWhich city has the highest-rated restaurant?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT DISTINCT restaurant.city_name FROM restaurant WHERE rating=(SELECT MAX(rating) FROM restaurant);",
        "role": "assistant"
      }
    ],
    "db_name": "restaurants",
    "id": 135,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat's the name and rating of all the restaurants that have a rating greater than 4 and are located in the city of New York?\n\n【数据库schema】\n【DB_ID】 restaurants\n【Schema】\n# Table: geographic\n[\n  (city_name:text, The name of the city. Value examples: ['Los Angeles', 'New York'].),\n  (county:text, The name of the county. Value examples: ['Los Angeles', 'New York'].),\n  (region:text, The name of the region. Value examples: ['California', 'New York'].),\n]\n# Table: location\n[\n  (restaurant_id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2'].),\n  (house_number:bigint, The number assigned to the building where the restaurant is located. Value examples: ['123', '456'].),\n  (street_name:text, The name of the street where the restaurant is located. Value examples: ['Main St', 'Maple Ave'].),\n  (city_name:text, The name of the city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles'].),\n]\n# Table: restaurant\n[\n  (id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2', '3'].),\n  (name:text, The name of the restaurant. Value examples: ['The Pasta House', 'The Burger Joint', 'The Sushi Bar'].),\n  (food_type:text, The type of food served at the restaurant. Value examples: ['Italian', 'American', 'Japanese'].),\n  (city_name:text, The city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles', 'Los Angeles'].),\n  (rating:real, The rating of the restaurant on a scale of 0 to 5. Value examples: ['4.5', '3.8', '4.2'].),\n]\n\n【Foreign keys】\ngeographic.city_name = location.city_name\ngeographic.city_name = restaurant.city_name\nlocation.restaurant_id = restaurant.id\n\n【参考信息】\nMatch city_name and food_type case-insensitively. Match with ILIKE and percent sign for substring matching for all other string matches.\n\n【用户问题】\nWhat's the name and rating of all the restaurants that have a rating greater than 4 and are located in the city of New York?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT restaurant.name, restaurant.rating FROM restaurant WHERE restaurant.rating > 4 AND restaurant.city_name ILIKE '%New York%';",
        "role": "assistant"
      }
    ],
    "db_name": "restaurants",
    "id": 136,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat's the name and food type of all the restaurants located on Market St in San Francisco?\n\n【数据库schema】\n【DB_ID】 restaurants\n【Schema】\n# Table: geographic\n[\n  (city_name:text, The name of the city. Value examples: ['Los Angeles', 'New York'].),\n  (county:text, The name of the county. Value examples: ['Los Angeles', 'New York'].),\n  (region:text, The name of the region. Value examples: ['California', 'New York'].),\n]\n# Table: location\n[\n  (restaurant_id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2'].),\n  (house_number:bigint, The number assigned to the building where the restaurant is located. Value examples: ['123', '456'].),\n  (street_name:text, The name of the street where the restaurant is located. Value examples: ['Main St', 'Maple Ave'].),\n  (city_name:text, The name of the city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles'].),\n]\n# Table: restaurant\n[\n  (id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2', '3'].),\n  (name:text, The name of the restaurant. Value examples: ['The Pasta House', 'The Burger Joint', 'The Sushi Bar'].),\n  (food_type:text, The type of food served at the restaurant. Value examples: ['Italian', 'American', 'Japanese'].),\n  (city_name:text, The city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles', 'Los Angeles'].),\n  (rating:real, The rating of the restaurant on a scale of 0 to 5. Value examples: ['4.5', '3.8', '4.2'].),\n]\n\n【Foreign keys】\ngeographic.city_name = location.city_name\ngeographic.city_name = restaurant.city_name\nlocation.restaurant_id = restaurant.id\n\n【参考信息】\nMatch city_name and food_type case-insensitively. Match with ILIKE and percent sign for substring matching for all other string matches.\n\n【用户问题】\nWhat's the name and food type of all the restaurants located on Market St in San Francisco?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT restaurant.name, restaurant.food_type FROM restaurant JOIN LOCATION ON restaurant.id = location.restaurant_id WHERE location.street_name ILIKE '%Market St%' AND location.city_name ILIKE '%San Francisco%';",
        "role": "assistant"
      }
    ],
    "db_name": "restaurants",
    "id": 137,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the names of the restaurants that serve Italian food?\n\n【数据库schema】\n【DB_ID】 restaurants\n【Schema】\n# Table: geographic\n[\n  (city_name:text, The name of the city. Value examples: ['Los Angeles', 'New York'].),\n  (county:text, The name of the county. Value examples: ['Los Angeles', 'New York'].),\n  (region:text, The name of the region. Value examples: ['California', 'New York'].),\n]\n# Table: location\n[\n  (restaurant_id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2'].),\n  (house_number:bigint, The number assigned to the building where the restaurant is located. Value examples: ['123', '456'].),\n  (street_name:text, The name of the street where the restaurant is located. Value examples: ['Main St', 'Maple Ave'].),\n  (city_name:text, The name of the city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles'].),\n]\n# Table: restaurant\n[\n  (id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2', '3'].),\n  (name:text, The name of the restaurant. Value examples: ['The Pasta House', 'The Burger Joint', 'The Sushi Bar'].),\n  (food_type:text, The type of food served at the restaurant. Value examples: ['Italian', 'American', 'Japanese'].),\n  (city_name:text, The city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles', 'Los Angeles'].),\n  (rating:real, The rating of the restaurant on a scale of 0 to 5. Value examples: ['4.5', '3.8', '4.2'].),\n]\n\n【Foreign keys】\ngeographic.city_name = location.city_name\ngeographic.city_name = restaurant.city_name\nlocation.restaurant_id = restaurant.id\n\n【参考信息】\nMatch city_name and food_type case-insensitively. Match with ILIKE and percent sign for substring matching for all other string matches.\n\n【用户问题】\nWhat are the names of the restaurants that serve Italian food?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT restaurant.name FROM restaurant WHERE LOWER(restaurant.food_type) ILIKE '%italian%';",
        "role": "assistant"
      }
    ],
    "db_name": "restaurants",
    "id": 138,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the names of the restaurants in Los Angeles that have a rating higher than 4?\n\n【数据库schema】\n【DB_ID】 restaurants\n【Schema】\n# Table: geographic\n[\n  (city_name:text, The name of the city. Value examples: ['Los Angeles', 'New York'].),\n  (county:text, The name of the county. Value examples: ['Los Angeles', 'New York'].),\n  (region:text, The name of the region. Value examples: ['California', 'New York'].),\n]\n# Table: location\n[\n  (restaurant_id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2'].),\n  (house_number:bigint, The number assigned to the building where the restaurant is located. Value examples: ['123', '456'].),\n  (street_name:text, The name of the street where the restaurant is located. Value examples: ['Main St', 'Maple Ave'].),\n  (city_name:text, The name of the city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles'].),\n]\n# Table: restaurant\n[\n  (id:bigint, Unique identifier for each restaurant. Value examples: ['1', '2', '3'].),\n  (name:text, The name of the restaurant. Value examples: ['The Pasta House', 'The Burger Joint', 'The Sushi Bar'].),\n  (food_type:text, The type of food served at the restaurant. Value examples: ['Italian', 'American', 'Japanese'].),\n  (city_name:text, The city where the restaurant is located. Value examples: ['Los Angeles', 'Los Angeles', 'Los Angeles'].),\n  (rating:real, The rating of the restaurant on a scale of 0 to 5. Value examples: ['4.5', '3.8', '4.2'].),\n]\n\n【Foreign keys】\ngeographic.city_name = location.city_name\ngeographic.city_name = restaurant.city_name\nlocation.restaurant_id = restaurant.id\n\n【参考信息】\nMatch city_name and food_type case-insensitively. Match with ILIKE and percent sign for substring matching for all other string matches.\n\n【用户问题】\nWhat are the names of the restaurants in Los Angeles that have a rating higher than 4?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT DISTINCT restaurant.name FROM restaurant WHERE restaurant.city_name ILIKE '%Los Angeles%' AND restaurant.rating > 4 ORDER BY restaurant.name NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "restaurants",
    "id": 139,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many authors have written a paper that was published 1 year or longer before today's date?\n\n【数据库schema】\n【DB_ID】 scholar\n【Schema】\n# Table: author\n[\n  (authorid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3', '4'].),\n  (authorname:text, Name of the author. Value examples: ['John Smith', 'Emily Johnson', 'Michael Brown', 'Sarah Davis'].),\n]\n# Table: cite\n[\n  (citingpaperid:bigint, The ID of the paper that is doing the citing.. Value examples: ['1', '2', '3', '4'].),\n  (citedpaperid:bigint, The ID of the paper that is being cited.. Value examples: ['2', '3', '4', '5'].),\n]\n# Table: dataset\n[\n  (datasetid:bigint, Unique identifier for each dataset in the table. Value examples: ['1', '2', '3', '4'].),\n  (datasetname:text, Name of the dataset. Value examples: ['COVID-19 Research', 'Machine Learning Datasets', 'Climate Change Data', 'Social Media Analysis'].),\n]\n# Table: field\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: journal\n[\n  (journalid:bigint, Unique identifier for each journal entry. Value examples: ['1', '2'].),\n  (journalname:text, Name or title of the journal. Value examples: ['Nature', 'Science'].),\n]\n# Table: keyphrase\n[\n  (keyphraseid:bigint, Unique identifier for each keyphrase. Value examples: ['1', '2', '3'].),\n  (keyphrasename:text, The actual keyphrase text. Value examples: ['Machine Learning', 'Climate Change', 'Social Media'].),\n]\n# Table: paper\n[\n  (paperid:bigint, The unique ID of the paper.. Value examples: ['1', '2'].),\n  (title:text, The title of the paper, enclosed in double quotes if it contains commas.. Value examples: ['A Study on Machine Learning Algorithms', 'The Effects of Climate Change on Agriculture'].),\n  (venueid:bigint, The ID of the venue where the paper was published.. Value examples: ['1', '1'].),\n  (year:bigint, The year the paper was published.. Value examples: ['2020', '2020'].),\n  (numciting:bigint, The number of papers that this paper cites.. Value examples: ['2', '1'].),\n  (numcitedby:bigint, The number of papers that cite this paper.. Value examples: ['2', '2'].),\n  (journalid:bigint, The ID of the journal where the paper was published.. Value examples: ['3', '1'].),\n]\n# Table: paperdataset\n[\n  (paperid:bigint, Unique identifier for each paper in the dataset. Value examples: ['1', '2', '3'].),\n  (datasetid:bigint, Unique identifier for each dataset that the paper belongs to. Value examples: ['2', '3', '4'].),\n]\n# Table: paperfield\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3'].),\n  (paperid:bigint, Unique identifier for each paper in the table. Value examples: ['1', '2', '3'].),\n]\n# Table: paperkeyphrase\n[\n  (paperid:bigint, The ID of the paper associated with the keyphrase.. Value examples: ['1', '2', '3', '3'].),\n  (keyphraseid:bigint, The ID of the keyphrase associated with the paper.. Value examples: ['1', '2', '3', '5'].),\n]\n# Table: venue\n[\n  (venueid:bigint, Unique identifier for each venue. Value examples: ['1', '2', '3'].),\n  (venuename:text, Name of the venue. Value examples: ['Conference on Machine Learning', 'International Journal of Climate Change', 'Social Media Analysis Workshop'].),\n]\n# Table: writes\n[\n  (paperid:bigint, The unique identifier for a paper in the writes table.. Value examples: ['1', '2', '3', '4'].),\n  (authorid:bigint, The unique identifier for an author in the writes table.. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.authorid = writes.authorid\ncite.citingpaperid = paper.paperid\ncite.citingpaperid = paperdataset.paperid\ncite.citingpaperid = paperfield.paperid\ncite.citingpaperid = paperkeyphrase.paperid\ncite.citingpaperid = writes.paperid\ndataset.datasetid = paperdataset.datasetid\nfield.fieldid = paperfield.fieldid\njournal.journalid = paper.journalid\nkeyphrase.keyphraseid = paperkeyphrase.keyphraseid\npaper.paperid = paperdataset.paperid\npaper.paperid = paperfield.paperid\npaper.paperid = paperkeyphrase.paperid\npaper.paperid = writes.paperid\npaper.venueid = venue.venueid\npaperfield.paperid = paperkeyphrase.paperid\npaperfield.paperid = writes.paperid\npaperkeyphrase.paperid = writes.paperid\n\n【参考信息】\n\n\n【用户问题】\nHow many authors have written a paper that was published 1 year or longer before today's date?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT count(DISTINCT w.authorid) AS num_authors FROM paper p JOIN writes w ON p.paperid = w.paperid WHERE p.year < extract(YEAR FROM CURRENT_DATE - interval '1 year');",
        "role": "assistant"
      }
    ],
    "db_name": "scholar",
    "id": 140,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many keyphrases are associated with papers published between 2020 and 2035?\n\n【数据库schema】\n【DB_ID】 scholar\n【Schema】\n# Table: author\n[\n  (authorid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3', '4'].),\n  (authorname:text, Name of the author. Value examples: ['John Smith', 'Emily Johnson', 'Michael Brown', 'Sarah Davis'].),\n]\n# Table: cite\n[\n  (citingpaperid:bigint, The ID of the paper that is doing the citing.. Value examples: ['1', '2', '3', '4'].),\n  (citedpaperid:bigint, The ID of the paper that is being cited.. Value examples: ['2', '3', '4', '5'].),\n]\n# Table: dataset\n[\n  (datasetid:bigint, Unique identifier for each dataset in the table. Value examples: ['1', '2', '3', '4'].),\n  (datasetname:text, Name of the dataset. Value examples: ['COVID-19 Research', 'Machine Learning Datasets', 'Climate Change Data', 'Social Media Analysis'].),\n]\n# Table: field\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: journal\n[\n  (journalid:bigint, Unique identifier for each journal entry. Value examples: ['1', '2'].),\n  (journalname:text, Name or title of the journal. Value examples: ['Nature', 'Science'].),\n]\n# Table: keyphrase\n[\n  (keyphraseid:bigint, Unique identifier for each keyphrase. Value examples: ['1', '2', '3'].),\n  (keyphrasename:text, The actual keyphrase text. Value examples: ['Machine Learning', 'Climate Change', 'Social Media'].),\n]\n# Table: paper\n[\n  (paperid:bigint, The unique ID of the paper.. Value examples: ['1', '2'].),\n  (title:text, The title of the paper, enclosed in double quotes if it contains commas.. Value examples: ['A Study on Machine Learning Algorithms', 'The Effects of Climate Change on Agriculture'].),\n  (venueid:bigint, The ID of the venue where the paper was published.. Value examples: ['1', '1'].),\n  (year:bigint, The year the paper was published.. Value examples: ['2020', '2020'].),\n  (numciting:bigint, The number of papers that this paper cites.. Value examples: ['2', '1'].),\n  (numcitedby:bigint, The number of papers that cite this paper.. Value examples: ['2', '2'].),\n  (journalid:bigint, The ID of the journal where the paper was published.. Value examples: ['3', '1'].),\n]\n# Table: paperdataset\n[\n  (paperid:bigint, Unique identifier for each paper in the dataset. Value examples: ['1', '2', '3'].),\n  (datasetid:bigint, Unique identifier for each dataset that the paper belongs to. Value examples: ['2', '3', '4'].),\n]\n# Table: paperfield\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3'].),\n  (paperid:bigint, Unique identifier for each paper in the table. Value examples: ['1', '2', '3'].),\n]\n# Table: paperkeyphrase\n[\n  (paperid:bigint, The ID of the paper associated with the keyphrase.. Value examples: ['1', '2', '3', '3'].),\n  (keyphraseid:bigint, The ID of the keyphrase associated with the paper.. Value examples: ['1', '2', '3', '5'].),\n]\n# Table: venue\n[\n  (venueid:bigint, Unique identifier for each venue. Value examples: ['1', '2', '3'].),\n  (venuename:text, Name of the venue. Value examples: ['Conference on Machine Learning', 'International Journal of Climate Change', 'Social Media Analysis Workshop'].),\n]\n# Table: writes\n[\n  (paperid:bigint, The unique identifier for a paper in the writes table.. Value examples: ['1', '2', '3', '4'].),\n  (authorid:bigint, The unique identifier for an author in the writes table.. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.authorid = writes.authorid\ncite.citingpaperid = paper.paperid\ncite.citingpaperid = paperdataset.paperid\ncite.citingpaperid = paperfield.paperid\ncite.citingpaperid = paperkeyphrase.paperid\ncite.citingpaperid = writes.paperid\ndataset.datasetid = paperdataset.datasetid\nfield.fieldid = paperfield.fieldid\njournal.journalid = paper.journalid\nkeyphrase.keyphraseid = paperkeyphrase.keyphraseid\npaper.paperid = paperdataset.paperid\npaper.paperid = paperfield.paperid\npaper.paperid = paperkeyphrase.paperid\npaper.paperid = writes.paperid\npaper.venueid = venue.venueid\npaperfield.paperid = paperkeyphrase.paperid\npaperfield.paperid = writes.paperid\npaperkeyphrase.paperid = writes.paperid\n\n【参考信息】\n\n\n【用户问题】\nHow many keyphrases are associated with papers published between 2020 and 2035?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT count(DISTINCT pk.keyphraseid) AS num_keyphrases FROM paper p JOIN paperkeyphrase pk ON p.paperid = pk.paperid WHERE p.year >= 2020 AND p.year <= 2035 ;",
        "role": "assistant"
      }
    ],
    "db_name": "scholar",
    "id": 141,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat's the number of papers published per year excluding those published in the year that is 6 years before 2025?\n\n【数据库schema】\n【DB_ID】 scholar\n【Schema】\n# Table: author\n[\n  (authorid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3', '4'].),\n  (authorname:text, Name of the author. Value examples: ['John Smith', 'Emily Johnson', 'Michael Brown', 'Sarah Davis'].),\n]\n# Table: cite\n[\n  (citingpaperid:bigint, The ID of the paper that is doing the citing.. Value examples: ['1', '2', '3', '4'].),\n  (citedpaperid:bigint, The ID of the paper that is being cited.. Value examples: ['2', '3', '4', '5'].),\n]\n# Table: dataset\n[\n  (datasetid:bigint, Unique identifier for each dataset in the table. Value examples: ['1', '2', '3', '4'].),\n  (datasetname:text, Name of the dataset. Value examples: ['COVID-19 Research', 'Machine Learning Datasets', 'Climate Change Data', 'Social Media Analysis'].),\n]\n# Table: field\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: journal\n[\n  (journalid:bigint, Unique identifier for each journal entry. Value examples: ['1', '2'].),\n  (journalname:text, Name or title of the journal. Value examples: ['Nature', 'Science'].),\n]\n# Table: keyphrase\n[\n  (keyphraseid:bigint, Unique identifier for each keyphrase. Value examples: ['1', '2', '3'].),\n  (keyphrasename:text, The actual keyphrase text. Value examples: ['Machine Learning', 'Climate Change', 'Social Media'].),\n]\n# Table: paper\n[\n  (paperid:bigint, The unique ID of the paper.. Value examples: ['1', '2'].),\n  (title:text, The title of the paper, enclosed in double quotes if it contains commas.. Value examples: ['A Study on Machine Learning Algorithms', 'The Effects of Climate Change on Agriculture'].),\n  (venueid:bigint, The ID of the venue where the paper was published.. Value examples: ['1', '1'].),\n  (year:bigint, The year the paper was published.. Value examples: ['2020', '2020'].),\n  (numciting:bigint, The number of papers that this paper cites.. Value examples: ['2', '1'].),\n  (numcitedby:bigint, The number of papers that cite this paper.. Value examples: ['2', '2'].),\n  (journalid:bigint, The ID of the journal where the paper was published.. Value examples: ['3', '1'].),\n]\n# Table: paperdataset\n[\n  (paperid:bigint, Unique identifier for each paper in the dataset. Value examples: ['1', '2', '3'].),\n  (datasetid:bigint, Unique identifier for each dataset that the paper belongs to. Value examples: ['2', '3', '4'].),\n]\n# Table: paperfield\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3'].),\n  (paperid:bigint, Unique identifier for each paper in the table. Value examples: ['1', '2', '3'].),\n]\n# Table: paperkeyphrase\n[\n  (paperid:bigint, The ID of the paper associated with the keyphrase.. Value examples: ['1', '2', '3', '3'].),\n  (keyphraseid:bigint, The ID of the keyphrase associated with the paper.. Value examples: ['1', '2', '3', '5'].),\n]\n# Table: venue\n[\n  (venueid:bigint, Unique identifier for each venue. Value examples: ['1', '2', '3'].),\n  (venuename:text, Name of the venue. Value examples: ['Conference on Machine Learning', 'International Journal of Climate Change', 'Social Media Analysis Workshop'].),\n]\n# Table: writes\n[\n  (paperid:bigint, The unique identifier for a paper in the writes table.. Value examples: ['1', '2', '3', '4'].),\n  (authorid:bigint, The unique identifier for an author in the writes table.. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.authorid = writes.authorid\ncite.citingpaperid = paper.paperid\ncite.citingpaperid = paperdataset.paperid\ncite.citingpaperid = paperfield.paperid\ncite.citingpaperid = paperkeyphrase.paperid\ncite.citingpaperid = writes.paperid\ndataset.datasetid = paperdataset.datasetid\nfield.fieldid = paperfield.fieldid\njournal.journalid = paper.journalid\nkeyphrase.keyphraseid = paperkeyphrase.keyphraseid\npaper.paperid = paperdataset.paperid\npaper.paperid = paperfield.paperid\npaper.paperid = paperkeyphrase.paperid\npaper.paperid = writes.paperid\npaper.venueid = venue.venueid\npaperfield.paperid = paperkeyphrase.paperid\npaperfield.paperid = writes.paperid\npaperkeyphrase.paperid = writes.paperid\n\n【参考信息】\n\n\n【用户问题】\nWhat's the number of papers published per year excluding those published in the year that is 6 years before 2025?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT YEAR, count(*) AS num_papers FROM paper WHERE YEAR != 2025 - 6 GROUP BY YEAR ORDER BY YEAR;",
        "role": "assistant"
      }
    ],
    "db_name": "scholar",
    "id": 142,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nGive me the total number of papers published in the first 12 months of 2019.\n\n【数据库schema】\n【DB_ID】 scholar\n【Schema】\n# Table: author\n[\n  (authorid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3', '4'].),\n  (authorname:text, Name of the author. Value examples: ['John Smith', 'Emily Johnson', 'Michael Brown', 'Sarah Davis'].),\n]\n# Table: cite\n[\n  (citingpaperid:bigint, The ID of the paper that is doing the citing.. Value examples: ['1', '2', '3', '4'].),\n  (citedpaperid:bigint, The ID of the paper that is being cited.. Value examples: ['2', '3', '4', '5'].),\n]\n# Table: dataset\n[\n  (datasetid:bigint, Unique identifier for each dataset in the table. Value examples: ['1', '2', '3', '4'].),\n  (datasetname:text, Name of the dataset. Value examples: ['COVID-19 Research', 'Machine Learning Datasets', 'Climate Change Data', 'Social Media Analysis'].),\n]\n# Table: field\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: journal\n[\n  (journalid:bigint, Unique identifier for each journal entry. Value examples: ['1', '2'].),\n  (journalname:text, Name or title of the journal. Value examples: ['Nature', 'Science'].),\n]\n# Table: keyphrase\n[\n  (keyphraseid:bigint, Unique identifier for each keyphrase. Value examples: ['1', '2', '3'].),\n  (keyphrasename:text, The actual keyphrase text. Value examples: ['Machine Learning', 'Climate Change', 'Social Media'].),\n]\n# Table: paper\n[\n  (paperid:bigint, The unique ID of the paper.. Value examples: ['1', '2'].),\n  (title:text, The title of the paper, enclosed in double quotes if it contains commas.. Value examples: ['A Study on Machine Learning Algorithms', 'The Effects of Climate Change on Agriculture'].),\n  (venueid:bigint, The ID of the venue where the paper was published.. Value examples: ['1', '1'].),\n  (year:bigint, The year the paper was published.. Value examples: ['2020', '2020'].),\n  (numciting:bigint, The number of papers that this paper cites.. Value examples: ['2', '1'].),\n  (numcitedby:bigint, The number of papers that cite this paper.. Value examples: ['2', '2'].),\n  (journalid:bigint, The ID of the journal where the paper was published.. Value examples: ['3', '1'].),\n]\n# Table: paperdataset\n[\n  (paperid:bigint, Unique identifier for each paper in the dataset. Value examples: ['1', '2', '3'].),\n  (datasetid:bigint, Unique identifier for each dataset that the paper belongs to. Value examples: ['2', '3', '4'].),\n]\n# Table: paperfield\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3'].),\n  (paperid:bigint, Unique identifier for each paper in the table. Value examples: ['1', '2', '3'].),\n]\n# Table: paperkeyphrase\n[\n  (paperid:bigint, The ID of the paper associated with the keyphrase.. Value examples: ['1', '2', '3', '3'].),\n  (keyphraseid:bigint, The ID of the keyphrase associated with the paper.. Value examples: ['1', '2', '3', '5'].),\n]\n# Table: venue\n[\n  (venueid:bigint, Unique identifier for each venue. Value examples: ['1', '2', '3'].),\n  (venuename:text, Name of the venue. Value examples: ['Conference on Machine Learning', 'International Journal of Climate Change', 'Social Media Analysis Workshop'].),\n]\n# Table: writes\n[\n  (paperid:bigint, The unique identifier for a paper in the writes table.. Value examples: ['1', '2', '3', '4'].),\n  (authorid:bigint, The unique identifier for an author in the writes table.. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.authorid = writes.authorid\ncite.citingpaperid = paper.paperid\ncite.citingpaperid = paperdataset.paperid\ncite.citingpaperid = paperfield.paperid\ncite.citingpaperid = paperkeyphrase.paperid\ncite.citingpaperid = writes.paperid\ndataset.datasetid = paperdataset.datasetid\nfield.fieldid = paperfield.fieldid\njournal.journalid = paper.journalid\nkeyphrase.keyphraseid = paperkeyphrase.keyphraseid\npaper.paperid = paperdataset.paperid\npaper.paperid = paperfield.paperid\npaper.paperid = paperkeyphrase.paperid\npaper.paperid = writes.paperid\npaper.venueid = venue.venueid\npaperfield.paperid = paperkeyphrase.paperid\npaperfield.paperid = writes.paperid\npaperkeyphrase.paperid = writes.paperid\n\n【参考信息】\n\n\n【用户问题】\nGive me the total number of papers published in the first 12 months of 2019.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT count(*) AS total_papers FROM paper WHERE YEAR = 2019;",
        "role": "assistant"
      }
    ],
    "db_name": "scholar",
    "id": 143,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nOn average, how many papers per month were published in the whole of 2020?\n\n【数据库schema】\n【DB_ID】 scholar\n【Schema】\n# Table: author\n[\n  (authorid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3', '4'].),\n  (authorname:text, Name of the author. Value examples: ['John Smith', 'Emily Johnson', 'Michael Brown', 'Sarah Davis'].),\n]\n# Table: cite\n[\n  (citingpaperid:bigint, The ID of the paper that is doing the citing.. Value examples: ['1', '2', '3', '4'].),\n  (citedpaperid:bigint, The ID of the paper that is being cited.. Value examples: ['2', '3', '4', '5'].),\n]\n# Table: dataset\n[\n  (datasetid:bigint, Unique identifier for each dataset in the table. Value examples: ['1', '2', '3', '4'].),\n  (datasetname:text, Name of the dataset. Value examples: ['COVID-19 Research', 'Machine Learning Datasets', 'Climate Change Data', 'Social Media Analysis'].),\n]\n# Table: field\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: journal\n[\n  (journalid:bigint, Unique identifier for each journal entry. Value examples: ['1', '2'].),\n  (journalname:text, Name or title of the journal. Value examples: ['Nature', 'Science'].),\n]\n# Table: keyphrase\n[\n  (keyphraseid:bigint, Unique identifier for each keyphrase. Value examples: ['1', '2', '3'].),\n  (keyphrasename:text, The actual keyphrase text. Value examples: ['Machine Learning', 'Climate Change', 'Social Media'].),\n]\n# Table: paper\n[\n  (paperid:bigint, The unique ID of the paper.. Value examples: ['1', '2'].),\n  (title:text, The title of the paper, enclosed in double quotes if it contains commas.. Value examples: ['A Study on Machine Learning Algorithms', 'The Effects of Climate Change on Agriculture'].),\n  (venueid:bigint, The ID of the venue where the paper was published.. Value examples: ['1', '1'].),\n  (year:bigint, The year the paper was published.. Value examples: ['2020', '2020'].),\n  (numciting:bigint, The number of papers that this paper cites.. Value examples: ['2', '1'].),\n  (numcitedby:bigint, The number of papers that cite this paper.. Value examples: ['2', '2'].),\n  (journalid:bigint, The ID of the journal where the paper was published.. Value examples: ['3', '1'].),\n]\n# Table: paperdataset\n[\n  (paperid:bigint, Unique identifier for each paper in the dataset. Value examples: ['1', '2', '3'].),\n  (datasetid:bigint, Unique identifier for each dataset that the paper belongs to. Value examples: ['2', '3', '4'].),\n]\n# Table: paperfield\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3'].),\n  (paperid:bigint, Unique identifier for each paper in the table. Value examples: ['1', '2', '3'].),\n]\n# Table: paperkeyphrase\n[\n  (paperid:bigint, The ID of the paper associated with the keyphrase.. Value examples: ['1', '2', '3', '3'].),\n  (keyphraseid:bigint, The ID of the keyphrase associated with the paper.. Value examples: ['1', '2', '3', '5'].),\n]\n# Table: venue\n[\n  (venueid:bigint, Unique identifier for each venue. Value examples: ['1', '2', '3'].),\n  (venuename:text, Name of the venue. Value examples: ['Conference on Machine Learning', 'International Journal of Climate Change', 'Social Media Analysis Workshop'].),\n]\n# Table: writes\n[\n  (paperid:bigint, The unique identifier for a paper in the writes table.. Value examples: ['1', '2', '3', '4'].),\n  (authorid:bigint, The unique identifier for an author in the writes table.. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.authorid = writes.authorid\ncite.citingpaperid = paper.paperid\ncite.citingpaperid = paperdataset.paperid\ncite.citingpaperid = paperfield.paperid\ncite.citingpaperid = paperkeyphrase.paperid\ncite.citingpaperid = writes.paperid\ndataset.datasetid = paperdataset.datasetid\nfield.fieldid = paperfield.fieldid\njournal.journalid = paper.journalid\nkeyphrase.keyphraseid = paperkeyphrase.keyphraseid\npaper.paperid = paperdataset.paperid\npaper.paperid = paperfield.paperid\npaper.paperid = paperkeyphrase.paperid\npaper.paperid = writes.paperid\npaper.venueid = venue.venueid\npaperfield.paperid = paperkeyphrase.paperid\npaperfield.paperid = writes.paperid\npaperkeyphrase.paperid = writes.paperid\n\n【参考信息】\n\n\n【用户问题】\nOn average, how many papers per month were published in the whole of 2020?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT cast(count(*) AS float)/ 12 AS average_papers_per_month FROM paper WHERE YEAR = 2020;",
        "role": "assistant"
      }
    ],
    "db_name": "scholar",
    "id": 144,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the total number of papers published per year?\n\n【数据库schema】\n【DB_ID】 scholar\n【Schema】\n# Table: author\n[\n  (authorid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3', '4'].),\n  (authorname:text, Name of the author. Value examples: ['John Smith', 'Emily Johnson', 'Michael Brown', 'Sarah Davis'].),\n]\n# Table: cite\n[\n  (citingpaperid:bigint, The ID of the paper that is doing the citing.. Value examples: ['1', '2', '3', '4'].),\n  (citedpaperid:bigint, The ID of the paper that is being cited.. Value examples: ['2', '3', '4', '5'].),\n]\n# Table: dataset\n[\n  (datasetid:bigint, Unique identifier for each dataset in the table. Value examples: ['1', '2', '3', '4'].),\n  (datasetname:text, Name of the dataset. Value examples: ['COVID-19 Research', 'Machine Learning Datasets', 'Climate Change Data', 'Social Media Analysis'].),\n]\n# Table: field\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: journal\n[\n  (journalid:bigint, Unique identifier for each journal entry. Value examples: ['1', '2'].),\n  (journalname:text, Name or title of the journal. Value examples: ['Nature', 'Science'].),\n]\n# Table: keyphrase\n[\n  (keyphraseid:bigint, Unique identifier for each keyphrase. Value examples: ['1', '2', '3'].),\n  (keyphrasename:text, The actual keyphrase text. Value examples: ['Machine Learning', 'Climate Change', 'Social Media'].),\n]\n# Table: paper\n[\n  (paperid:bigint, The unique ID of the paper.. Value examples: ['1', '2'].),\n  (title:text, The title of the paper, enclosed in double quotes if it contains commas.. Value examples: ['A Study on Machine Learning Algorithms', 'The Effects of Climate Change on Agriculture'].),\n  (venueid:bigint, The ID of the venue where the paper was published.. Value examples: ['1', '1'].),\n  (year:bigint, The year the paper was published.. Value examples: ['2020', '2020'].),\n  (numciting:bigint, The number of papers that this paper cites.. Value examples: ['2', '1'].),\n  (numcitedby:bigint, The number of papers that cite this paper.. Value examples: ['2', '2'].),\n  (journalid:bigint, The ID of the journal where the paper was published.. Value examples: ['3', '1'].),\n]\n# Table: paperdataset\n[\n  (paperid:bigint, Unique identifier for each paper in the dataset. Value examples: ['1', '2', '3'].),\n  (datasetid:bigint, Unique identifier for each dataset that the paper belongs to. Value examples: ['2', '3', '4'].),\n]\n# Table: paperfield\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3'].),\n  (paperid:bigint, Unique identifier for each paper in the table. Value examples: ['1', '2', '3'].),\n]\n# Table: paperkeyphrase\n[\n  (paperid:bigint, The ID of the paper associated with the keyphrase.. Value examples: ['1', '2', '3', '3'].),\n  (keyphraseid:bigint, The ID of the keyphrase associated with the paper.. Value examples: ['1', '2', '3', '5'].),\n]\n# Table: venue\n[\n  (venueid:bigint, Unique identifier for each venue. Value examples: ['1', '2', '3'].),\n  (venuename:text, Name of the venue. Value examples: ['Conference on Machine Learning', 'International Journal of Climate Change', 'Social Media Analysis Workshop'].),\n]\n# Table: writes\n[\n  (paperid:bigint, The unique identifier for a paper in the writes table.. Value examples: ['1', '2', '3', '4'].),\n  (authorid:bigint, The unique identifier for an author in the writes table.. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.authorid = writes.authorid\ncite.citingpaperid = paper.paperid\ncite.citingpaperid = paperdataset.paperid\ncite.citingpaperid = paperfield.paperid\ncite.citingpaperid = paperkeyphrase.paperid\ncite.citingpaperid = writes.paperid\ndataset.datasetid = paperdataset.datasetid\nfield.fieldid = paperfield.fieldid\njournal.journalid = paper.journalid\nkeyphrase.keyphraseid = paperkeyphrase.keyphraseid\npaper.paperid = paperdataset.paperid\npaper.paperid = paperfield.paperid\npaper.paperid = paperkeyphrase.paperid\npaper.paperid = writes.paperid\npaper.venueid = venue.venueid\npaperfield.paperid = paperkeyphrase.paperid\npaperfield.paperid = writes.paperid\npaperkeyphrase.paperid = writes.paperid\n\n【参考信息】\n\n\n【用户问题】\nWhat is the total number of papers published per year?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT paper.year, COUNT(paper.paperid) AS total_papers FROM paper GROUP BY paper.year ORDER BY paper.year NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "scholar",
    "id": 145,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the total number of papers published in each year?\n\n【数据库schema】\n【DB_ID】 scholar\n【Schema】\n# Table: author\n[\n  (authorid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3', '4'].),\n  (authorname:text, Name of the author. Value examples: ['John Smith', 'Emily Johnson', 'Michael Brown', 'Sarah Davis'].),\n]\n# Table: cite\n[\n  (citingpaperid:bigint, The ID of the paper that is doing the citing.. Value examples: ['1', '2', '3', '4'].),\n  (citedpaperid:bigint, The ID of the paper that is being cited.. Value examples: ['2', '3', '4', '5'].),\n]\n# Table: dataset\n[\n  (datasetid:bigint, Unique identifier for each dataset in the table. Value examples: ['1', '2', '3', '4'].),\n  (datasetname:text, Name of the dataset. Value examples: ['COVID-19 Research', 'Machine Learning Datasets', 'Climate Change Data', 'Social Media Analysis'].),\n]\n# Table: field\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: journal\n[\n  (journalid:bigint, Unique identifier for each journal entry. Value examples: ['1', '2'].),\n  (journalname:text, Name or title of the journal. Value examples: ['Nature', 'Science'].),\n]\n# Table: keyphrase\n[\n  (keyphraseid:bigint, Unique identifier for each keyphrase. Value examples: ['1', '2', '3'].),\n  (keyphrasename:text, The actual keyphrase text. Value examples: ['Machine Learning', 'Climate Change', 'Social Media'].),\n]\n# Table: paper\n[\n  (paperid:bigint, The unique ID of the paper.. Value examples: ['1', '2'].),\n  (title:text, The title of the paper, enclosed in double quotes if it contains commas.. Value examples: ['A Study on Machine Learning Algorithms', 'The Effects of Climate Change on Agriculture'].),\n  (venueid:bigint, The ID of the venue where the paper was published.. Value examples: ['1', '1'].),\n  (year:bigint, The year the paper was published.. Value examples: ['2020', '2020'].),\n  (numciting:bigint, The number of papers that this paper cites.. Value examples: ['2', '1'].),\n  (numcitedby:bigint, The number of papers that cite this paper.. Value examples: ['2', '2'].),\n  (journalid:bigint, The ID of the journal where the paper was published.. Value examples: ['3', '1'].),\n]\n# Table: paperdataset\n[\n  (paperid:bigint, Unique identifier for each paper in the dataset. Value examples: ['1', '2', '3'].),\n  (datasetid:bigint, Unique identifier for each dataset that the paper belongs to. Value examples: ['2', '3', '4'].),\n]\n# Table: paperfield\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3'].),\n  (paperid:bigint, Unique identifier for each paper in the table. Value examples: ['1', '2', '3'].),\n]\n# Table: paperkeyphrase\n[\n  (paperid:bigint, The ID of the paper associated with the keyphrase.. Value examples: ['1', '2', '3', '3'].),\n  (keyphraseid:bigint, The ID of the keyphrase associated with the paper.. Value examples: ['1', '2', '3', '5'].),\n]\n# Table: venue\n[\n  (venueid:bigint, Unique identifier for each venue. Value examples: ['1', '2', '3'].),\n  (venuename:text, Name of the venue. Value examples: ['Conference on Machine Learning', 'International Journal of Climate Change', 'Social Media Analysis Workshop'].),\n]\n# Table: writes\n[\n  (paperid:bigint, The unique identifier for a paper in the writes table.. Value examples: ['1', '2', '3', '4'].),\n  (authorid:bigint, The unique identifier for an author in the writes table.. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.authorid = writes.authorid\ncite.citingpaperid = paper.paperid\ncite.citingpaperid = paperdataset.paperid\ncite.citingpaperid = paperfield.paperid\ncite.citingpaperid = paperkeyphrase.paperid\ncite.citingpaperid = writes.paperid\ndataset.datasetid = paperdataset.datasetid\nfield.fieldid = paperfield.fieldid\njournal.journalid = paper.journalid\nkeyphrase.keyphraseid = paperkeyphrase.keyphraseid\npaper.paperid = paperdataset.paperid\npaper.paperid = paperfield.paperid\npaper.paperid = paperkeyphrase.paperid\npaper.paperid = writes.paperid\npaper.venueid = venue.venueid\npaperfield.paperid = paperkeyphrase.paperid\npaperfield.paperid = writes.paperid\npaperkeyphrase.paperid = writes.paperid\n\n【参考信息】\n\n\n【用户问题】\nWhat is the total number of papers published in each year?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT paper.year, COUNT(paper.paperid) AS total_papers FROM paper GROUP BY paper.year ORDER BY paper.year;",
        "role": "assistant"
      }
    ],
    "db_name": "scholar",
    "id": 146,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the total number of papers associated with each dataset?\n\n【数据库schema】\n【DB_ID】 scholar\n【Schema】\n# Table: author\n[\n  (authorid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3', '4'].),\n  (authorname:text, Name of the author. Value examples: ['John Smith', 'Emily Johnson', 'Michael Brown', 'Sarah Davis'].),\n]\n# Table: cite\n[\n  (citingpaperid:bigint, The ID of the paper that is doing the citing.. Value examples: ['1', '2', '3', '4'].),\n  (citedpaperid:bigint, The ID of the paper that is being cited.. Value examples: ['2', '3', '4', '5'].),\n]\n# Table: dataset\n[\n  (datasetid:bigint, Unique identifier for each dataset in the table. Value examples: ['1', '2', '3', '4'].),\n  (datasetname:text, Name of the dataset. Value examples: ['COVID-19 Research', 'Machine Learning Datasets', 'Climate Change Data', 'Social Media Analysis'].),\n]\n# Table: field\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: journal\n[\n  (journalid:bigint, Unique identifier for each journal entry. Value examples: ['1', '2'].),\n  (journalname:text, Name or title of the journal. Value examples: ['Nature', 'Science'].),\n]\n# Table: keyphrase\n[\n  (keyphraseid:bigint, Unique identifier for each keyphrase. Value examples: ['1', '2', '3'].),\n  (keyphrasename:text, The actual keyphrase text. Value examples: ['Machine Learning', 'Climate Change', 'Social Media'].),\n]\n# Table: paper\n[\n  (paperid:bigint, The unique ID of the paper.. Value examples: ['1', '2'].),\n  (title:text, The title of the paper, enclosed in double quotes if it contains commas.. Value examples: ['A Study on Machine Learning Algorithms', 'The Effects of Climate Change on Agriculture'].),\n  (venueid:bigint, The ID of the venue where the paper was published.. Value examples: ['1', '1'].),\n  (year:bigint, The year the paper was published.. Value examples: ['2020', '2020'].),\n  (numciting:bigint, The number of papers that this paper cites.. Value examples: ['2', '1'].),\n  (numcitedby:bigint, The number of papers that cite this paper.. Value examples: ['2', '2'].),\n  (journalid:bigint, The ID of the journal where the paper was published.. Value examples: ['3', '1'].),\n]\n# Table: paperdataset\n[\n  (paperid:bigint, Unique identifier for each paper in the dataset. Value examples: ['1', '2', '3'].),\n  (datasetid:bigint, Unique identifier for each dataset that the paper belongs to. Value examples: ['2', '3', '4'].),\n]\n# Table: paperfield\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3'].),\n  (paperid:bigint, Unique identifier for each paper in the table. Value examples: ['1', '2', '3'].),\n]\n# Table: paperkeyphrase\n[\n  (paperid:bigint, The ID of the paper associated with the keyphrase.. Value examples: ['1', '2', '3', '3'].),\n  (keyphraseid:bigint, The ID of the keyphrase associated with the paper.. Value examples: ['1', '2', '3', '5'].),\n]\n# Table: venue\n[\n  (venueid:bigint, Unique identifier for each venue. Value examples: ['1', '2', '3'].),\n  (venuename:text, Name of the venue. Value examples: ['Conference on Machine Learning', 'International Journal of Climate Change', 'Social Media Analysis Workshop'].),\n]\n# Table: writes\n[\n  (paperid:bigint, The unique identifier for a paper in the writes table.. Value examples: ['1', '2', '3', '4'].),\n  (authorid:bigint, The unique identifier for an author in the writes table.. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.authorid = writes.authorid\ncite.citingpaperid = paper.paperid\ncite.citingpaperid = paperdataset.paperid\ncite.citingpaperid = paperfield.paperid\ncite.citingpaperid = paperkeyphrase.paperid\ncite.citingpaperid = writes.paperid\ndataset.datasetid = paperdataset.datasetid\nfield.fieldid = paperfield.fieldid\njournal.journalid = paper.journalid\nkeyphrase.keyphraseid = paperkeyphrase.keyphraseid\npaper.paperid = paperdataset.paperid\npaper.paperid = paperfield.paperid\npaper.paperid = paperkeyphrase.paperid\npaper.paperid = writes.paperid\npaper.venueid = venue.venueid\npaperfield.paperid = paperkeyphrase.paperid\npaperfield.paperid = writes.paperid\npaperkeyphrase.paperid = writes.paperid\n\n【参考信息】\n\n\n【用户问题】\nWhat is the total number of papers associated with each dataset?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT paperdataset.datasetid, COUNT(DISTINCT paperdataset.paperid) AS total_papers FROM paperdataset GROUP BY paperdataset.datasetid;SELECT dataset.datasetname, COUNT(paperdataset.paperid) AS total_papers FROM paperdataset JOIN dataset ON paperdataset.datasetid = dataset.datasetid GROUP BY dataset.datasetname;",
        "role": "assistant"
      }
    ],
    "db_name": "scholar",
    "id": 147,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many keyphrases are associated with each paper?\n\n【数据库schema】\n【DB_ID】 scholar\n【Schema】\n# Table: author\n[\n  (authorid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3', '4'].),\n  (authorname:text, Name of the author. Value examples: ['John Smith', 'Emily Johnson', 'Michael Brown', 'Sarah Davis'].),\n]\n# Table: cite\n[\n  (citingpaperid:bigint, The ID of the paper that is doing the citing.. Value examples: ['1', '2', '3', '4'].),\n  (citedpaperid:bigint, The ID of the paper that is being cited.. Value examples: ['2', '3', '4', '5'].),\n]\n# Table: dataset\n[\n  (datasetid:bigint, Unique identifier for each dataset in the table. Value examples: ['1', '2', '3', '4'].),\n  (datasetname:text, Name of the dataset. Value examples: ['COVID-19 Research', 'Machine Learning Datasets', 'Climate Change Data', 'Social Media Analysis'].),\n]\n# Table: field\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: journal\n[\n  (journalid:bigint, Unique identifier for each journal entry. Value examples: ['1', '2'].),\n  (journalname:text, Name or title of the journal. Value examples: ['Nature', 'Science'].),\n]\n# Table: keyphrase\n[\n  (keyphraseid:bigint, Unique identifier for each keyphrase. Value examples: ['1', '2', '3'].),\n  (keyphrasename:text, The actual keyphrase text. Value examples: ['Machine Learning', 'Climate Change', 'Social Media'].),\n]\n# Table: paper\n[\n  (paperid:bigint, The unique ID of the paper.. Value examples: ['1', '2'].),\n  (title:text, The title of the paper, enclosed in double quotes if it contains commas.. Value examples: ['A Study on Machine Learning Algorithms', 'The Effects of Climate Change on Agriculture'].),\n  (venueid:bigint, The ID of the venue where the paper was published.. Value examples: ['1', '1'].),\n  (year:bigint, The year the paper was published.. Value examples: ['2020', '2020'].),\n  (numciting:bigint, The number of papers that this paper cites.. Value examples: ['2', '1'].),\n  (numcitedby:bigint, The number of papers that cite this paper.. Value examples: ['2', '2'].),\n  (journalid:bigint, The ID of the journal where the paper was published.. Value examples: ['3', '1'].),\n]\n# Table: paperdataset\n[\n  (paperid:bigint, Unique identifier for each paper in the dataset. Value examples: ['1', '2', '3'].),\n  (datasetid:bigint, Unique identifier for each dataset that the paper belongs to. Value examples: ['2', '3', '4'].),\n]\n# Table: paperfield\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3'].),\n  (paperid:bigint, Unique identifier for each paper in the table. Value examples: ['1', '2', '3'].),\n]\n# Table: paperkeyphrase\n[\n  (paperid:bigint, The ID of the paper associated with the keyphrase.. Value examples: ['1', '2', '3', '3'].),\n  (keyphraseid:bigint, The ID of the keyphrase associated with the paper.. Value examples: ['1', '2', '3', '5'].),\n]\n# Table: venue\n[\n  (venueid:bigint, Unique identifier for each venue. Value examples: ['1', '2', '3'].),\n  (venuename:text, Name of the venue. Value examples: ['Conference on Machine Learning', 'International Journal of Climate Change', 'Social Media Analysis Workshop'].),\n]\n# Table: writes\n[\n  (paperid:bigint, The unique identifier for a paper in the writes table.. Value examples: ['1', '2', '3', '4'].),\n  (authorid:bigint, The unique identifier for an author in the writes table.. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.authorid = writes.authorid\ncite.citingpaperid = paper.paperid\ncite.citingpaperid = paperdataset.paperid\ncite.citingpaperid = paperfield.paperid\ncite.citingpaperid = paperkeyphrase.paperid\ncite.citingpaperid = writes.paperid\ndataset.datasetid = paperdataset.datasetid\nfield.fieldid = paperfield.fieldid\njournal.journalid = paper.journalid\nkeyphrase.keyphraseid = paperkeyphrase.keyphraseid\npaper.paperid = paperdataset.paperid\npaper.paperid = paperfield.paperid\npaper.paperid = paperkeyphrase.paperid\npaper.paperid = writes.paperid\npaper.venueid = venue.venueid\npaperfield.paperid = paperkeyphrase.paperid\npaperfield.paperid = writes.paperid\npaperkeyphrase.paperid = writes.paperid\n\n【参考信息】\n\n\n【用户问题】\nHow many keyphrases are associated with each paper?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT paperkeyphrase.paperid, COUNT(paperkeyphrase.keyphraseid) AS keyphrase_count FROM paperkeyphrase GROUP BY paperkeyphrase.paperid ORDER BY keyphrase_count DESC NULLS LAST;SELECT p.title, COUNT(pk.keyphraseid) AS num_keyphrases FROM paper p JOIN paperkeyphrase pk ON p.paperid = pk.paperid GROUP BY p.title ORDER BY num_keyphrases DESC NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "scholar",
    "id": 148,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many authors have published more than 2 papers?\n\n【数据库schema】\n【DB_ID】 scholar\n【Schema】\n# Table: author\n[\n  (authorid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3', '4'].),\n  (authorname:text, Name of the author. Value examples: ['John Smith', 'Emily Johnson', 'Michael Brown', 'Sarah Davis'].),\n]\n# Table: cite\n[\n  (citingpaperid:bigint, The ID of the paper that is doing the citing.. Value examples: ['1', '2', '3', '4'].),\n  (citedpaperid:bigint, The ID of the paper that is being cited.. Value examples: ['2', '3', '4', '5'].),\n]\n# Table: dataset\n[\n  (datasetid:bigint, Unique identifier for each dataset in the table. Value examples: ['1', '2', '3', '4'].),\n  (datasetname:text, Name of the dataset. Value examples: ['COVID-19 Research', 'Machine Learning Datasets', 'Climate Change Data', 'Social Media Analysis'].),\n]\n# Table: field\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: journal\n[\n  (journalid:bigint, Unique identifier for each journal entry. Value examples: ['1', '2'].),\n  (journalname:text, Name or title of the journal. Value examples: ['Nature', 'Science'].),\n]\n# Table: keyphrase\n[\n  (keyphraseid:bigint, Unique identifier for each keyphrase. Value examples: ['1', '2', '3'].),\n  (keyphrasename:text, The actual keyphrase text. Value examples: ['Machine Learning', 'Climate Change', 'Social Media'].),\n]\n# Table: paper\n[\n  (paperid:bigint, The unique ID of the paper.. Value examples: ['1', '2'].),\n  (title:text, The title of the paper, enclosed in double quotes if it contains commas.. Value examples: ['A Study on Machine Learning Algorithms', 'The Effects of Climate Change on Agriculture'].),\n  (venueid:bigint, The ID of the venue where the paper was published.. Value examples: ['1', '1'].),\n  (year:bigint, The year the paper was published.. Value examples: ['2020', '2020'].),\n  (numciting:bigint, The number of papers that this paper cites.. Value examples: ['2', '1'].),\n  (numcitedby:bigint, The number of papers that cite this paper.. Value examples: ['2', '2'].),\n  (journalid:bigint, The ID of the journal where the paper was published.. Value examples: ['3', '1'].),\n]\n# Table: paperdataset\n[\n  (paperid:bigint, Unique identifier for each paper in the dataset. Value examples: ['1', '2', '3'].),\n  (datasetid:bigint, Unique identifier for each dataset that the paper belongs to. Value examples: ['2', '3', '4'].),\n]\n# Table: paperfield\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3'].),\n  (paperid:bigint, Unique identifier for each paper in the table. Value examples: ['1', '2', '3'].),\n]\n# Table: paperkeyphrase\n[\n  (paperid:bigint, The ID of the paper associated with the keyphrase.. Value examples: ['1', '2', '3', '3'].),\n  (keyphraseid:bigint, The ID of the keyphrase associated with the paper.. Value examples: ['1', '2', '3', '5'].),\n]\n# Table: venue\n[\n  (venueid:bigint, Unique identifier for each venue. Value examples: ['1', '2', '3'].),\n  (venuename:text, Name of the venue. Value examples: ['Conference on Machine Learning', 'International Journal of Climate Change', 'Social Media Analysis Workshop'].),\n]\n# Table: writes\n[\n  (paperid:bigint, The unique identifier for a paper in the writes table.. Value examples: ['1', '2', '3', '4'].),\n  (authorid:bigint, The unique identifier for an author in the writes table.. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.authorid = writes.authorid\ncite.citingpaperid = paper.paperid\ncite.citingpaperid = paperdataset.paperid\ncite.citingpaperid = paperfield.paperid\ncite.citingpaperid = paperkeyphrase.paperid\ncite.citingpaperid = writes.paperid\ndataset.datasetid = paperdataset.datasetid\nfield.fieldid = paperfield.fieldid\njournal.journalid = paper.journalid\nkeyphrase.keyphraseid = paperkeyphrase.keyphraseid\npaper.paperid = paperdataset.paperid\npaper.paperid = paperfield.paperid\npaper.paperid = paperkeyphrase.paperid\npaper.paperid = writes.paperid\npaper.venueid = venue.venueid\npaperfield.paperid = paperkeyphrase.paperid\npaperfield.paperid = writes.paperid\npaperkeyphrase.paperid = writes.paperid\n\n【参考信息】\n\n\n【用户问题】\nHow many authors have published more than 2 papers?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT COUNT(*) AS number_of_authors FROM (SELECT writes.authorid FROM writes GROUP BY writes.authorid HAVING COUNT(writes.paperid) > 2) AS subquery;",
        "role": "assistant"
      }
    ],
    "db_name": "scholar",
    "id": 149,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich papers have the highest number of authors, ordered by the number of authors in descending order?\n\n【数据库schema】\n【DB_ID】 scholar\n【Schema】\n# Table: author\n[\n  (authorid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3', '4'].),\n  (authorname:text, Name of the author. Value examples: ['John Smith', 'Emily Johnson', 'Michael Brown', 'Sarah Davis'].),\n]\n# Table: cite\n[\n  (citingpaperid:bigint, The ID of the paper that is doing the citing.. Value examples: ['1', '2', '3', '4'].),\n  (citedpaperid:bigint, The ID of the paper that is being cited.. Value examples: ['2', '3', '4', '5'].),\n]\n# Table: dataset\n[\n  (datasetid:bigint, Unique identifier for each dataset in the table. Value examples: ['1', '2', '3', '4'].),\n  (datasetname:text, Name of the dataset. Value examples: ['COVID-19 Research', 'Machine Learning Datasets', 'Climate Change Data', 'Social Media Analysis'].),\n]\n# Table: field\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: journal\n[\n  (journalid:bigint, Unique identifier for each journal entry. Value examples: ['1', '2'].),\n  (journalname:text, Name or title of the journal. Value examples: ['Nature', 'Science'].),\n]\n# Table: keyphrase\n[\n  (keyphraseid:bigint, Unique identifier for each keyphrase. Value examples: ['1', '2', '3'].),\n  (keyphrasename:text, The actual keyphrase text. Value examples: ['Machine Learning', 'Climate Change', 'Social Media'].),\n]\n# Table: paper\n[\n  (paperid:bigint, The unique ID of the paper.. Value examples: ['1', '2'].),\n  (title:text, The title of the paper, enclosed in double quotes if it contains commas.. Value examples: ['A Study on Machine Learning Algorithms', 'The Effects of Climate Change on Agriculture'].),\n  (venueid:bigint, The ID of the venue where the paper was published.. Value examples: ['1', '1'].),\n  (year:bigint, The year the paper was published.. Value examples: ['2020', '2020'].),\n  (numciting:bigint, The number of papers that this paper cites.. Value examples: ['2', '1'].),\n  (numcitedby:bigint, The number of papers that cite this paper.. Value examples: ['2', '2'].),\n  (journalid:bigint, The ID of the journal where the paper was published.. Value examples: ['3', '1'].),\n]\n# Table: paperdataset\n[\n  (paperid:bigint, Unique identifier for each paper in the dataset. Value examples: ['1', '2', '3'].),\n  (datasetid:bigint, Unique identifier for each dataset that the paper belongs to. Value examples: ['2', '3', '4'].),\n]\n# Table: paperfield\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3'].),\n  (paperid:bigint, Unique identifier for each paper in the table. Value examples: ['1', '2', '3'].),\n]\n# Table: paperkeyphrase\n[\n  (paperid:bigint, The ID of the paper associated with the keyphrase.. Value examples: ['1', '2', '3', '3'].),\n  (keyphraseid:bigint, The ID of the keyphrase associated with the paper.. Value examples: ['1', '2', '3', '5'].),\n]\n# Table: venue\n[\n  (venueid:bigint, Unique identifier for each venue. Value examples: ['1', '2', '3'].),\n  (venuename:text, Name of the venue. Value examples: ['Conference on Machine Learning', 'International Journal of Climate Change', 'Social Media Analysis Workshop'].),\n]\n# Table: writes\n[\n  (paperid:bigint, The unique identifier for a paper in the writes table.. Value examples: ['1', '2', '3', '4'].),\n  (authorid:bigint, The unique identifier for an author in the writes table.. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.authorid = writes.authorid\ncite.citingpaperid = paper.paperid\ncite.citingpaperid = paperdataset.paperid\ncite.citingpaperid = paperfield.paperid\ncite.citingpaperid = paperkeyphrase.paperid\ncite.citingpaperid = writes.paperid\ndataset.datasetid = paperdataset.datasetid\nfield.fieldid = paperfield.fieldid\njournal.journalid = paper.journalid\nkeyphrase.keyphraseid = paperkeyphrase.keyphraseid\npaper.paperid = paperdataset.paperid\npaper.paperid = paperfield.paperid\npaper.paperid = paperkeyphrase.paperid\npaper.paperid = writes.paperid\npaper.venueid = venue.venueid\npaperfield.paperid = paperkeyphrase.paperid\npaperfield.paperid = writes.paperid\npaperkeyphrase.paperid = writes.paperid\n\n【参考信息】\n\n\n【用户问题】\nWhich papers have the highest number of authors, ordered by the number of authors in descending order?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT writes.paperid, COUNT(writes.authorid) AS num_authors FROM writes GROUP BY writes.paperid ORDER BY num_authors DESC NULLS LAST;SELECT paper.title, COUNT(DISTINCT writes.authorid) AS num_authors FROM paper JOIN writes ON paper.paperid = writes.paperid GROUP BY paper.title ORDER BY num_authors DESC;",
        "role": "assistant"
      }
    ],
    "db_name": "scholar",
    "id": 150,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the total number of keyphrases associated with each paper, ordered by the paper ID in ascending order?\n\n【数据库schema】\n【DB_ID】 scholar\n【Schema】\n# Table: author\n[\n  (authorid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3', '4'].),\n  (authorname:text, Name of the author. Value examples: ['John Smith', 'Emily Johnson', 'Michael Brown', 'Sarah Davis'].),\n]\n# Table: cite\n[\n  (citingpaperid:bigint, The ID of the paper that is doing the citing.. Value examples: ['1', '2', '3', '4'].),\n  (citedpaperid:bigint, The ID of the paper that is being cited.. Value examples: ['2', '3', '4', '5'].),\n]\n# Table: dataset\n[\n  (datasetid:bigint, Unique identifier for each dataset in the table. Value examples: ['1', '2', '3', '4'].),\n  (datasetname:text, Name of the dataset. Value examples: ['COVID-19 Research', 'Machine Learning Datasets', 'Climate Change Data', 'Social Media Analysis'].),\n]\n# Table: field\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: journal\n[\n  (journalid:bigint, Unique identifier for each journal entry. Value examples: ['1', '2'].),\n  (journalname:text, Name or title of the journal. Value examples: ['Nature', 'Science'].),\n]\n# Table: keyphrase\n[\n  (keyphraseid:bigint, Unique identifier for each keyphrase. Value examples: ['1', '2', '3'].),\n  (keyphrasename:text, The actual keyphrase text. Value examples: ['Machine Learning', 'Climate Change', 'Social Media'].),\n]\n# Table: paper\n[\n  (paperid:bigint, The unique ID of the paper.. Value examples: ['1', '2'].),\n  (title:text, The title of the paper, enclosed in double quotes if it contains commas.. Value examples: ['A Study on Machine Learning Algorithms', 'The Effects of Climate Change on Agriculture'].),\n  (venueid:bigint, The ID of the venue where the paper was published.. Value examples: ['1', '1'].),\n  (year:bigint, The year the paper was published.. Value examples: ['2020', '2020'].),\n  (numciting:bigint, The number of papers that this paper cites.. Value examples: ['2', '1'].),\n  (numcitedby:bigint, The number of papers that cite this paper.. Value examples: ['2', '2'].),\n  (journalid:bigint, The ID of the journal where the paper was published.. Value examples: ['3', '1'].),\n]\n# Table: paperdataset\n[\n  (paperid:bigint, Unique identifier for each paper in the dataset. Value examples: ['1', '2', '3'].),\n  (datasetid:bigint, Unique identifier for each dataset that the paper belongs to. Value examples: ['2', '3', '4'].),\n]\n# Table: paperfield\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3'].),\n  (paperid:bigint, Unique identifier for each paper in the table. Value examples: ['1', '2', '3'].),\n]\n# Table: paperkeyphrase\n[\n  (paperid:bigint, The ID of the paper associated with the keyphrase.. Value examples: ['1', '2', '3', '3'].),\n  (keyphraseid:bigint, The ID of the keyphrase associated with the paper.. Value examples: ['1', '2', '3', '5'].),\n]\n# Table: venue\n[\n  (venueid:bigint, Unique identifier for each venue. Value examples: ['1', '2', '3'].),\n  (venuename:text, Name of the venue. Value examples: ['Conference on Machine Learning', 'International Journal of Climate Change', 'Social Media Analysis Workshop'].),\n]\n# Table: writes\n[\n  (paperid:bigint, The unique identifier for a paper in the writes table.. Value examples: ['1', '2', '3', '4'].),\n  (authorid:bigint, The unique identifier for an author in the writes table.. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.authorid = writes.authorid\ncite.citingpaperid = paper.paperid\ncite.citingpaperid = paperdataset.paperid\ncite.citingpaperid = paperfield.paperid\ncite.citingpaperid = paperkeyphrase.paperid\ncite.citingpaperid = writes.paperid\ndataset.datasetid = paperdataset.datasetid\nfield.fieldid = paperfield.fieldid\njournal.journalid = paper.journalid\nkeyphrase.keyphraseid = paperkeyphrase.keyphraseid\npaper.paperid = paperdataset.paperid\npaper.paperid = paperfield.paperid\npaper.paperid = paperkeyphrase.paperid\npaper.paperid = writes.paperid\npaper.venueid = venue.venueid\npaperfield.paperid = paperkeyphrase.paperid\npaperfield.paperid = writes.paperid\npaperkeyphrase.paperid = writes.paperid\n\n【参考信息】\n\n\n【用户问题】\nWhat is the total number of keyphrases associated with each paper, ordered by the paper ID in ascending order?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT paperkeyphrase.paperid, COUNT(paperkeyphrase.keyphraseid) AS total_keyphrases FROM paperkeyphrase GROUP BY paperkeyphrase.paperid ORDER BY paperkeyphrase.paperid ASC NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "scholar",
    "id": 151,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the titles of the papers published in the year 2020, ordered alphabetically?\n\n【数据库schema】\n【DB_ID】 scholar\n【Schema】\n# Table: author\n[\n  (authorid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3', '4'].),\n  (authorname:text, Name of the author. Value examples: ['John Smith', 'Emily Johnson', 'Michael Brown', 'Sarah Davis'].),\n]\n# Table: cite\n[\n  (citingpaperid:bigint, The ID of the paper that is doing the citing.. Value examples: ['1', '2', '3', '4'].),\n  (citedpaperid:bigint, The ID of the paper that is being cited.. Value examples: ['2', '3', '4', '5'].),\n]\n# Table: dataset\n[\n  (datasetid:bigint, Unique identifier for each dataset in the table. Value examples: ['1', '2', '3', '4'].),\n  (datasetname:text, Name of the dataset. Value examples: ['COVID-19 Research', 'Machine Learning Datasets', 'Climate Change Data', 'Social Media Analysis'].),\n]\n# Table: field\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: journal\n[\n  (journalid:bigint, Unique identifier for each journal entry. Value examples: ['1', '2'].),\n  (journalname:text, Name or title of the journal. Value examples: ['Nature', 'Science'].),\n]\n# Table: keyphrase\n[\n  (keyphraseid:bigint, Unique identifier for each keyphrase. Value examples: ['1', '2', '3'].),\n  (keyphrasename:text, The actual keyphrase text. Value examples: ['Machine Learning', 'Climate Change', 'Social Media'].),\n]\n# Table: paper\n[\n  (paperid:bigint, The unique ID of the paper.. Value examples: ['1', '2'].),\n  (title:text, The title of the paper, enclosed in double quotes if it contains commas.. Value examples: ['A Study on Machine Learning Algorithms', 'The Effects of Climate Change on Agriculture'].),\n  (venueid:bigint, The ID of the venue where the paper was published.. Value examples: ['1', '1'].),\n  (year:bigint, The year the paper was published.. Value examples: ['2020', '2020'].),\n  (numciting:bigint, The number of papers that this paper cites.. Value examples: ['2', '1'].),\n  (numcitedby:bigint, The number of papers that cite this paper.. Value examples: ['2', '2'].),\n  (journalid:bigint, The ID of the journal where the paper was published.. Value examples: ['3', '1'].),\n]\n# Table: paperdataset\n[\n  (paperid:bigint, Unique identifier for each paper in the dataset. Value examples: ['1', '2', '3'].),\n  (datasetid:bigint, Unique identifier for each dataset that the paper belongs to. Value examples: ['2', '3', '4'].),\n]\n# Table: paperfield\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3'].),\n  (paperid:bigint, Unique identifier for each paper in the table. Value examples: ['1', '2', '3'].),\n]\n# Table: paperkeyphrase\n[\n  (paperid:bigint, The ID of the paper associated with the keyphrase.. Value examples: ['1', '2', '3', '3'].),\n  (keyphraseid:bigint, The ID of the keyphrase associated with the paper.. Value examples: ['1', '2', '3', '5'].),\n]\n# Table: venue\n[\n  (venueid:bigint, Unique identifier for each venue. Value examples: ['1', '2', '3'].),\n  (venuename:text, Name of the venue. Value examples: ['Conference on Machine Learning', 'International Journal of Climate Change', 'Social Media Analysis Workshop'].),\n]\n# Table: writes\n[\n  (paperid:bigint, The unique identifier for a paper in the writes table.. Value examples: ['1', '2', '3', '4'].),\n  (authorid:bigint, The unique identifier for an author in the writes table.. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.authorid = writes.authorid\ncite.citingpaperid = paper.paperid\ncite.citingpaperid = paperdataset.paperid\ncite.citingpaperid = paperfield.paperid\ncite.citingpaperid = paperkeyphrase.paperid\ncite.citingpaperid = writes.paperid\ndataset.datasetid = paperdataset.datasetid\nfield.fieldid = paperfield.fieldid\njournal.journalid = paper.journalid\nkeyphrase.keyphraseid = paperkeyphrase.keyphraseid\npaper.paperid = paperdataset.paperid\npaper.paperid = paperfield.paperid\npaper.paperid = paperkeyphrase.paperid\npaper.paperid = writes.paperid\npaper.venueid = venue.venueid\npaperfield.paperid = paperkeyphrase.paperid\npaperfield.paperid = writes.paperid\npaperkeyphrase.paperid = writes.paperid\n\n【参考信息】\n\n\n【用户问题】\nWhat are the titles of the papers published in the year 2020, ordered alphabetically?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT paper.title FROM paper WHERE paper.year = 2020 ORDER BY paper.title ASC NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "scholar",
    "id": 152,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the names of the journals in the database, ordered by the length of the journal name from shortest to longest?\n\n【数据库schema】\n【DB_ID】 scholar\n【Schema】\n# Table: author\n[\n  (authorid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3', '4'].),\n  (authorname:text, Name of the author. Value examples: ['John Smith', 'Emily Johnson', 'Michael Brown', 'Sarah Davis'].),\n]\n# Table: cite\n[\n  (citingpaperid:bigint, The ID of the paper that is doing the citing.. Value examples: ['1', '2', '3', '4'].),\n  (citedpaperid:bigint, The ID of the paper that is being cited.. Value examples: ['2', '3', '4', '5'].),\n]\n# Table: dataset\n[\n  (datasetid:bigint, Unique identifier for each dataset in the table. Value examples: ['1', '2', '3', '4'].),\n  (datasetname:text, Name of the dataset. Value examples: ['COVID-19 Research', 'Machine Learning Datasets', 'Climate Change Data', 'Social Media Analysis'].),\n]\n# Table: field\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: journal\n[\n  (journalid:bigint, Unique identifier for each journal entry. Value examples: ['1', '2'].),\n  (journalname:text, Name or title of the journal. Value examples: ['Nature', 'Science'].),\n]\n# Table: keyphrase\n[\n  (keyphraseid:bigint, Unique identifier for each keyphrase. Value examples: ['1', '2', '3'].),\n  (keyphrasename:text, The actual keyphrase text. Value examples: ['Machine Learning', 'Climate Change', 'Social Media'].),\n]\n# Table: paper\n[\n  (paperid:bigint, The unique ID of the paper.. Value examples: ['1', '2'].),\n  (title:text, The title of the paper, enclosed in double quotes if it contains commas.. Value examples: ['A Study on Machine Learning Algorithms', 'The Effects of Climate Change on Agriculture'].),\n  (venueid:bigint, The ID of the venue where the paper was published.. Value examples: ['1', '1'].),\n  (year:bigint, The year the paper was published.. Value examples: ['2020', '2020'].),\n  (numciting:bigint, The number of papers that this paper cites.. Value examples: ['2', '1'].),\n  (numcitedby:bigint, The number of papers that cite this paper.. Value examples: ['2', '2'].),\n  (journalid:bigint, The ID of the journal where the paper was published.. Value examples: ['3', '1'].),\n]\n# Table: paperdataset\n[\n  (paperid:bigint, Unique identifier for each paper in the dataset. Value examples: ['1', '2', '3'].),\n  (datasetid:bigint, Unique identifier for each dataset that the paper belongs to. Value examples: ['2', '3', '4'].),\n]\n# Table: paperfield\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3'].),\n  (paperid:bigint, Unique identifier for each paper in the table. Value examples: ['1', '2', '3'].),\n]\n# Table: paperkeyphrase\n[\n  (paperid:bigint, The ID of the paper associated with the keyphrase.. Value examples: ['1', '2', '3', '3'].),\n  (keyphraseid:bigint, The ID of the keyphrase associated with the paper.. Value examples: ['1', '2', '3', '5'].),\n]\n# Table: venue\n[\n  (venueid:bigint, Unique identifier for each venue. Value examples: ['1', '2', '3'].),\n  (venuename:text, Name of the venue. Value examples: ['Conference on Machine Learning', 'International Journal of Climate Change', 'Social Media Analysis Workshop'].),\n]\n# Table: writes\n[\n  (paperid:bigint, The unique identifier for a paper in the writes table.. Value examples: ['1', '2', '3', '4'].),\n  (authorid:bigint, The unique identifier for an author in the writes table.. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.authorid = writes.authorid\ncite.citingpaperid = paper.paperid\ncite.citingpaperid = paperdataset.paperid\ncite.citingpaperid = paperfield.paperid\ncite.citingpaperid = paperkeyphrase.paperid\ncite.citingpaperid = writes.paperid\ndataset.datasetid = paperdataset.datasetid\nfield.fieldid = paperfield.fieldid\njournal.journalid = paper.journalid\nkeyphrase.keyphraseid = paperkeyphrase.keyphraseid\npaper.paperid = paperdataset.paperid\npaper.paperid = paperfield.paperid\npaper.paperid = paperkeyphrase.paperid\npaper.paperid = writes.paperid\npaper.venueid = venue.venueid\npaperfield.paperid = paperkeyphrase.paperid\npaperfield.paperid = writes.paperid\npaperkeyphrase.paperid = writes.paperid\n\n【参考信息】\n\n\n【用户问题】\nWhat are the names of the journals in the database, ordered by the length of the journal name from shortest to longest?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT journal.journalname FROM journal ORDER BY LENGTH(journal.journalname) ASC NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "scholar",
    "id": 153,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nFor each paper that cites other papers, how many other papers does it cite? Sort by the number of papers cited in descending order\n\n【数据库schema】\n【DB_ID】 scholar\n【Schema】\n# Table: author\n[\n  (authorid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3', '4'].),\n  (authorname:text, Name of the author. Value examples: ['John Smith', 'Emily Johnson', 'Michael Brown', 'Sarah Davis'].),\n]\n# Table: cite\n[\n  (citingpaperid:bigint, The ID of the paper that is doing the citing.. Value examples: ['1', '2', '3', '4'].),\n  (citedpaperid:bigint, The ID of the paper that is being cited.. Value examples: ['2', '3', '4', '5'].),\n]\n# Table: dataset\n[\n  (datasetid:bigint, Unique identifier for each dataset in the table. Value examples: ['1', '2', '3', '4'].),\n  (datasetname:text, Name of the dataset. Value examples: ['COVID-19 Research', 'Machine Learning Datasets', 'Climate Change Data', 'Social Media Analysis'].),\n]\n# Table: field\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: journal\n[\n  (journalid:bigint, Unique identifier for each journal entry. Value examples: ['1', '2'].),\n  (journalname:text, Name or title of the journal. Value examples: ['Nature', 'Science'].),\n]\n# Table: keyphrase\n[\n  (keyphraseid:bigint, Unique identifier for each keyphrase. Value examples: ['1', '2', '3'].),\n  (keyphrasename:text, The actual keyphrase text. Value examples: ['Machine Learning', 'Climate Change', 'Social Media'].),\n]\n# Table: paper\n[\n  (paperid:bigint, The unique ID of the paper.. Value examples: ['1', '2'].),\n  (title:text, The title of the paper, enclosed in double quotes if it contains commas.. Value examples: ['A Study on Machine Learning Algorithms', 'The Effects of Climate Change on Agriculture'].),\n  (venueid:bigint, The ID of the venue where the paper was published.. Value examples: ['1', '1'].),\n  (year:bigint, The year the paper was published.. Value examples: ['2020', '2020'].),\n  (numciting:bigint, The number of papers that this paper cites.. Value examples: ['2', '1'].),\n  (numcitedby:bigint, The number of papers that cite this paper.. Value examples: ['2', '2'].),\n  (journalid:bigint, The ID of the journal where the paper was published.. Value examples: ['3', '1'].),\n]\n# Table: paperdataset\n[\n  (paperid:bigint, Unique identifier for each paper in the dataset. Value examples: ['1', '2', '3'].),\n  (datasetid:bigint, Unique identifier for each dataset that the paper belongs to. Value examples: ['2', '3', '4'].),\n]\n# Table: paperfield\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3'].),\n  (paperid:bigint, Unique identifier for each paper in the table. Value examples: ['1', '2', '3'].),\n]\n# Table: paperkeyphrase\n[\n  (paperid:bigint, The ID of the paper associated with the keyphrase.. Value examples: ['1', '2', '3', '3'].),\n  (keyphraseid:bigint, The ID of the keyphrase associated with the paper.. Value examples: ['1', '2', '3', '5'].),\n]\n# Table: venue\n[\n  (venueid:bigint, Unique identifier for each venue. Value examples: ['1', '2', '3'].),\n  (venuename:text, Name of the venue. Value examples: ['Conference on Machine Learning', 'International Journal of Climate Change', 'Social Media Analysis Workshop'].),\n]\n# Table: writes\n[\n  (paperid:bigint, The unique identifier for a paper in the writes table.. Value examples: ['1', '2', '3', '4'].),\n  (authorid:bigint, The unique identifier for an author in the writes table.. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.authorid = writes.authorid\ncite.citingpaperid = paper.paperid\ncite.citingpaperid = paperdataset.paperid\ncite.citingpaperid = paperfield.paperid\ncite.citingpaperid = paperkeyphrase.paperid\ncite.citingpaperid = writes.paperid\ndataset.datasetid = paperdataset.datasetid\nfield.fieldid = paperfield.fieldid\njournal.journalid = paper.journalid\nkeyphrase.keyphraseid = paperkeyphrase.keyphraseid\npaper.paperid = paperdataset.paperid\npaper.paperid = paperfield.paperid\npaper.paperid = paperkeyphrase.paperid\npaper.paperid = writes.paperid\npaper.venueid = venue.venueid\npaperfield.paperid = paperkeyphrase.paperid\npaperfield.paperid = writes.paperid\npaperkeyphrase.paperid = writes.paperid\n\n【参考信息】\n\n\n【用户问题】\nFor each paper that cites other papers, how many other papers does it cite? Sort by the number of papers cited in descending order\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT cite.citingpaperid, COUNT(*) AS citation_count FROM cite GROUP BY cite.citingpaperid ORDER BY citation_count DESC NULLS LAST;SELECT p.paperid, p.numciting FROM paper p WHERE p.numciting > 0 ORDER BY p.numciting DESC;SELECT p.title, COUNT(c.citedpaperid) AS num_cited_papers FROM paper p JOIN cite c ON p.paperid = c.citingpaperid GROUP BY p.title ORDER BY num_cited_papers DESC;",
        "role": "assistant"
      }
    ],
    "db_name": "scholar",
    "id": 154,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the ratio of papers that have more than 1 keyphrases to papers that have 1 keyphrase?\n\n【数据库schema】\n【DB_ID】 scholar\n【Schema】\n# Table: author\n[\n  (authorid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3', '4'].),\n  (authorname:text, Name of the author. Value examples: ['John Smith', 'Emily Johnson', 'Michael Brown', 'Sarah Davis'].),\n]\n# Table: cite\n[\n  (citingpaperid:bigint, The ID of the paper that is doing the citing.. Value examples: ['1', '2', '3', '4'].),\n  (citedpaperid:bigint, The ID of the paper that is being cited.. Value examples: ['2', '3', '4', '5'].),\n]\n# Table: dataset\n[\n  (datasetid:bigint, Unique identifier for each dataset in the table. Value examples: ['1', '2', '3', '4'].),\n  (datasetname:text, Name of the dataset. Value examples: ['COVID-19 Research', 'Machine Learning Datasets', 'Climate Change Data', 'Social Media Analysis'].),\n]\n# Table: field\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: journal\n[\n  (journalid:bigint, Unique identifier for each journal entry. Value examples: ['1', '2'].),\n  (journalname:text, Name or title of the journal. Value examples: ['Nature', 'Science'].),\n]\n# Table: keyphrase\n[\n  (keyphraseid:bigint, Unique identifier for each keyphrase. Value examples: ['1', '2', '3'].),\n  (keyphrasename:text, The actual keyphrase text. Value examples: ['Machine Learning', 'Climate Change', 'Social Media'].),\n]\n# Table: paper\n[\n  (paperid:bigint, The unique ID of the paper.. Value examples: ['1', '2'].),\n  (title:text, The title of the paper, enclosed in double quotes if it contains commas.. Value examples: ['A Study on Machine Learning Algorithms', 'The Effects of Climate Change on Agriculture'].),\n  (venueid:bigint, The ID of the venue where the paper was published.. Value examples: ['1', '1'].),\n  (year:bigint, The year the paper was published.. Value examples: ['2020', '2020'].),\n  (numciting:bigint, The number of papers that this paper cites.. Value examples: ['2', '1'].),\n  (numcitedby:bigint, The number of papers that cite this paper.. Value examples: ['2', '2'].),\n  (journalid:bigint, The ID of the journal where the paper was published.. Value examples: ['3', '1'].),\n]\n# Table: paperdataset\n[\n  (paperid:bigint, Unique identifier for each paper in the dataset. Value examples: ['1', '2', '3'].),\n  (datasetid:bigint, Unique identifier for each dataset that the paper belongs to. Value examples: ['2', '3', '4'].),\n]\n# Table: paperfield\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3'].),\n  (paperid:bigint, Unique identifier for each paper in the table. Value examples: ['1', '2', '3'].),\n]\n# Table: paperkeyphrase\n[\n  (paperid:bigint, The ID of the paper associated with the keyphrase.. Value examples: ['1', '2', '3', '3'].),\n  (keyphraseid:bigint, The ID of the keyphrase associated with the paper.. Value examples: ['1', '2', '3', '5'].),\n]\n# Table: venue\n[\n  (venueid:bigint, Unique identifier for each venue. Value examples: ['1', '2', '3'].),\n  (venuename:text, Name of the venue. Value examples: ['Conference on Machine Learning', 'International Journal of Climate Change', 'Social Media Analysis Workshop'].),\n]\n# Table: writes\n[\n  (paperid:bigint, The unique identifier for a paper in the writes table.. Value examples: ['1', '2', '3', '4'].),\n  (authorid:bigint, The unique identifier for an author in the writes table.. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.authorid = writes.authorid\ncite.citingpaperid = paper.paperid\ncite.citingpaperid = paperdataset.paperid\ncite.citingpaperid = paperfield.paperid\ncite.citingpaperid = paperkeyphrase.paperid\ncite.citingpaperid = writes.paperid\ndataset.datasetid = paperdataset.datasetid\nfield.fieldid = paperfield.fieldid\njournal.journalid = paper.journalid\nkeyphrase.keyphraseid = paperkeyphrase.keyphraseid\npaper.paperid = paperdataset.paperid\npaper.paperid = paperfield.paperid\npaper.paperid = paperkeyphrase.paperid\npaper.paperid = writes.paperid\npaper.venueid = venue.venueid\npaperfield.paperid = paperkeyphrase.paperid\npaperfield.paperid = writes.paperid\npaperkeyphrase.paperid = writes.paperid\n\n【参考信息】\n\n\n【用户问题】\nWhat is the ratio of papers that have more than 1 keyphrases to papers that have 1 keyphrase?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT CAST(COUNT(DISTINCT CASE WHEN keyphrase_count > 1 THEN subquery.paperid END) AS FLOAT) / NULLIF(COUNT(DISTINCT CASE WHEN keyphrase_count =1 THEN subquery.paperid END), 0) AS ratio FROM (SELECT paperkeyphrase.paperid, COUNT(paperkeyphrase.keyphraseid) AS keyphrase_count FROM paperkeyphrase GROUP BY paperkeyphrase.paperid) AS subquery;",
        "role": "assistant"
      }
    ],
    "db_name": "scholar",
    "id": 155,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the ratio of papers that have been cited by 2 or more papers to papers that have been cited by less than 2 papers?\n\n【数据库schema】\n【DB_ID】 scholar\n【Schema】\n# Table: author\n[\n  (authorid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3', '4'].),\n  (authorname:text, Name of the author. Value examples: ['John Smith', 'Emily Johnson', 'Michael Brown', 'Sarah Davis'].),\n]\n# Table: cite\n[\n  (citingpaperid:bigint, The ID of the paper that is doing the citing.. Value examples: ['1', '2', '3', '4'].),\n  (citedpaperid:bigint, The ID of the paper that is being cited.. Value examples: ['2', '3', '4', '5'].),\n]\n# Table: dataset\n[\n  (datasetid:bigint, Unique identifier for each dataset in the table. Value examples: ['1', '2', '3', '4'].),\n  (datasetname:text, Name of the dataset. Value examples: ['COVID-19 Research', 'Machine Learning Datasets', 'Climate Change Data', 'Social Media Analysis'].),\n]\n# Table: field\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: journal\n[\n  (journalid:bigint, Unique identifier for each journal entry. Value examples: ['1', '2'].),\n  (journalname:text, Name or title of the journal. Value examples: ['Nature', 'Science'].),\n]\n# Table: keyphrase\n[\n  (keyphraseid:bigint, Unique identifier for each keyphrase. Value examples: ['1', '2', '3'].),\n  (keyphrasename:text, The actual keyphrase text. Value examples: ['Machine Learning', 'Climate Change', 'Social Media'].),\n]\n# Table: paper\n[\n  (paperid:bigint, The unique ID of the paper.. Value examples: ['1', '2'].),\n  (title:text, The title of the paper, enclosed in double quotes if it contains commas.. Value examples: ['A Study on Machine Learning Algorithms', 'The Effects of Climate Change on Agriculture'].),\n  (venueid:bigint, The ID of the venue where the paper was published.. Value examples: ['1', '1'].),\n  (year:bigint, The year the paper was published.. Value examples: ['2020', '2020'].),\n  (numciting:bigint, The number of papers that this paper cites.. Value examples: ['2', '1'].),\n  (numcitedby:bigint, The number of papers that cite this paper.. Value examples: ['2', '2'].),\n  (journalid:bigint, The ID of the journal where the paper was published.. Value examples: ['3', '1'].),\n]\n# Table: paperdataset\n[\n  (paperid:bigint, Unique identifier for each paper in the dataset. Value examples: ['1', '2', '3'].),\n  (datasetid:bigint, Unique identifier for each dataset that the paper belongs to. Value examples: ['2', '3', '4'].),\n]\n# Table: paperfield\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3'].),\n  (paperid:bigint, Unique identifier for each paper in the table. Value examples: ['1', '2', '3'].),\n]\n# Table: paperkeyphrase\n[\n  (paperid:bigint, The ID of the paper associated with the keyphrase.. Value examples: ['1', '2', '3', '3'].),\n  (keyphraseid:bigint, The ID of the keyphrase associated with the paper.. Value examples: ['1', '2', '3', '5'].),\n]\n# Table: venue\n[\n  (venueid:bigint, Unique identifier for each venue. Value examples: ['1', '2', '3'].),\n  (venuename:text, Name of the venue. Value examples: ['Conference on Machine Learning', 'International Journal of Climate Change', 'Social Media Analysis Workshop'].),\n]\n# Table: writes\n[\n  (paperid:bigint, The unique identifier for a paper in the writes table.. Value examples: ['1', '2', '3', '4'].),\n  (authorid:bigint, The unique identifier for an author in the writes table.. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.authorid = writes.authorid\ncite.citingpaperid = paper.paperid\ncite.citingpaperid = paperdataset.paperid\ncite.citingpaperid = paperfield.paperid\ncite.citingpaperid = paperkeyphrase.paperid\ncite.citingpaperid = writes.paperid\ndataset.datasetid = paperdataset.datasetid\nfield.fieldid = paperfield.fieldid\njournal.journalid = paper.journalid\nkeyphrase.keyphraseid = paperkeyphrase.keyphraseid\npaper.paperid = paperdataset.paperid\npaper.paperid = paperfield.paperid\npaper.paperid = paperkeyphrase.paperid\npaper.paperid = writes.paperid\npaper.venueid = venue.venueid\npaperfield.paperid = paperkeyphrase.paperid\npaperfield.paperid = writes.paperid\npaperkeyphrase.paperid = writes.paperid\n\n【参考信息】\n\n\n【用户问题】\nWhat is the ratio of papers that have been cited by 2 or more papers to papers that have been cited by less than 2 papers?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT CAST(COUNT(CASE WHEN paper.numcitedby > 1 THEN 1 END) AS FLOAT) / NULLIF(COUNT(CASE WHEN paper.numcitedby < 2 THEN 1 END), 0) AS ratio FROM paper;",
        "role": "assistant"
      }
    ],
    "db_name": "scholar",
    "id": 156,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the ratio of papers published in the year 2020 to the total number of papers in the database?\n\n【数据库schema】\n【DB_ID】 scholar\n【Schema】\n# Table: author\n[\n  (authorid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3', '4'].),\n  (authorname:text, Name of the author. Value examples: ['John Smith', 'Emily Johnson', 'Michael Brown', 'Sarah Davis'].),\n]\n# Table: cite\n[\n  (citingpaperid:bigint, The ID of the paper that is doing the citing.. Value examples: ['1', '2', '3', '4'].),\n  (citedpaperid:bigint, The ID of the paper that is being cited.. Value examples: ['2', '3', '4', '5'].),\n]\n# Table: dataset\n[\n  (datasetid:bigint, Unique identifier for each dataset in the table. Value examples: ['1', '2', '3', '4'].),\n  (datasetname:text, Name of the dataset. Value examples: ['COVID-19 Research', 'Machine Learning Datasets', 'Climate Change Data', 'Social Media Analysis'].),\n]\n# Table: field\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: journal\n[\n  (journalid:bigint, Unique identifier for each journal entry. Value examples: ['1', '2'].),\n  (journalname:text, Name or title of the journal. Value examples: ['Nature', 'Science'].),\n]\n# Table: keyphrase\n[\n  (keyphraseid:bigint, Unique identifier for each keyphrase. Value examples: ['1', '2', '3'].),\n  (keyphrasename:text, The actual keyphrase text. Value examples: ['Machine Learning', 'Climate Change', 'Social Media'].),\n]\n# Table: paper\n[\n  (paperid:bigint, The unique ID of the paper.. Value examples: ['1', '2'].),\n  (title:text, The title of the paper, enclosed in double quotes if it contains commas.. Value examples: ['A Study on Machine Learning Algorithms', 'The Effects of Climate Change on Agriculture'].),\n  (venueid:bigint, The ID of the venue where the paper was published.. Value examples: ['1', '1'].),\n  (year:bigint, The year the paper was published.. Value examples: ['2020', '2020'].),\n  (numciting:bigint, The number of papers that this paper cites.. Value examples: ['2', '1'].),\n  (numcitedby:bigint, The number of papers that cite this paper.. Value examples: ['2', '2'].),\n  (journalid:bigint, The ID of the journal where the paper was published.. Value examples: ['3', '1'].),\n]\n# Table: paperdataset\n[\n  (paperid:bigint, Unique identifier for each paper in the dataset. Value examples: ['1', '2', '3'].),\n  (datasetid:bigint, Unique identifier for each dataset that the paper belongs to. Value examples: ['2', '3', '4'].),\n]\n# Table: paperfield\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3'].),\n  (paperid:bigint, Unique identifier for each paper in the table. Value examples: ['1', '2', '3'].),\n]\n# Table: paperkeyphrase\n[\n  (paperid:bigint, The ID of the paper associated with the keyphrase.. Value examples: ['1', '2', '3', '3'].),\n  (keyphraseid:bigint, The ID of the keyphrase associated with the paper.. Value examples: ['1', '2', '3', '5'].),\n]\n# Table: venue\n[\n  (venueid:bigint, Unique identifier for each venue. Value examples: ['1', '2', '3'].),\n  (venuename:text, Name of the venue. Value examples: ['Conference on Machine Learning', 'International Journal of Climate Change', 'Social Media Analysis Workshop'].),\n]\n# Table: writes\n[\n  (paperid:bigint, The unique identifier for a paper in the writes table.. Value examples: ['1', '2', '3', '4'].),\n  (authorid:bigint, The unique identifier for an author in the writes table.. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.authorid = writes.authorid\ncite.citingpaperid = paper.paperid\ncite.citingpaperid = paperdataset.paperid\ncite.citingpaperid = paperfield.paperid\ncite.citingpaperid = paperkeyphrase.paperid\ncite.citingpaperid = writes.paperid\ndataset.datasetid = paperdataset.datasetid\nfield.fieldid = paperfield.fieldid\njournal.journalid = paper.journalid\nkeyphrase.keyphraseid = paperkeyphrase.keyphraseid\npaper.paperid = paperdataset.paperid\npaper.paperid = paperfield.paperid\npaper.paperid = paperkeyphrase.paperid\npaper.paperid = writes.paperid\npaper.venueid = venue.venueid\npaperfield.paperid = paperkeyphrase.paperid\npaperfield.paperid = writes.paperid\npaperkeyphrase.paperid = writes.paperid\n\n【参考信息】\n\n\n【用户问题】\nWhat is the ratio of papers published in the year 2020 to the total number of papers in the database?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT CAST(COUNT(CASE WHEN paper.year = 2020 THEN 1 END) AS FLOAT) / NULLIF(COUNT(paper.paperid), 0) AS ratio FROM paper;",
        "role": "assistant"
      }
    ],
    "db_name": "scholar",
    "id": 157,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the ratio of authors who have written 3 or more papers to authors who have written less than 3 papers?\n\n【数据库schema】\n【DB_ID】 scholar\n【Schema】\n# Table: author\n[\n  (authorid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3', '4'].),\n  (authorname:text, Name of the author. Value examples: ['John Smith', 'Emily Johnson', 'Michael Brown', 'Sarah Davis'].),\n]\n# Table: cite\n[\n  (citingpaperid:bigint, The ID of the paper that is doing the citing.. Value examples: ['1', '2', '3', '4'].),\n  (citedpaperid:bigint, The ID of the paper that is being cited.. Value examples: ['2', '3', '4', '5'].),\n]\n# Table: dataset\n[\n  (datasetid:bigint, Unique identifier for each dataset in the table. Value examples: ['1', '2', '3', '4'].),\n  (datasetname:text, Name of the dataset. Value examples: ['COVID-19 Research', 'Machine Learning Datasets', 'Climate Change Data', 'Social Media Analysis'].),\n]\n# Table: field\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: journal\n[\n  (journalid:bigint, Unique identifier for each journal entry. Value examples: ['1', '2'].),\n  (journalname:text, Name or title of the journal. Value examples: ['Nature', 'Science'].),\n]\n# Table: keyphrase\n[\n  (keyphraseid:bigint, Unique identifier for each keyphrase. Value examples: ['1', '2', '3'].),\n  (keyphrasename:text, The actual keyphrase text. Value examples: ['Machine Learning', 'Climate Change', 'Social Media'].),\n]\n# Table: paper\n[\n  (paperid:bigint, The unique ID of the paper.. Value examples: ['1', '2'].),\n  (title:text, The title of the paper, enclosed in double quotes if it contains commas.. Value examples: ['A Study on Machine Learning Algorithms', 'The Effects of Climate Change on Agriculture'].),\n  (venueid:bigint, The ID of the venue where the paper was published.. Value examples: ['1', '1'].),\n  (year:bigint, The year the paper was published.. Value examples: ['2020', '2020'].),\n  (numciting:bigint, The number of papers that this paper cites.. Value examples: ['2', '1'].),\n  (numcitedby:bigint, The number of papers that cite this paper.. Value examples: ['2', '2'].),\n  (journalid:bigint, The ID of the journal where the paper was published.. Value examples: ['3', '1'].),\n]\n# Table: paperdataset\n[\n  (paperid:bigint, Unique identifier for each paper in the dataset. Value examples: ['1', '2', '3'].),\n  (datasetid:bigint, Unique identifier for each dataset that the paper belongs to. Value examples: ['2', '3', '4'].),\n]\n# Table: paperfield\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3'].),\n  (paperid:bigint, Unique identifier for each paper in the table. Value examples: ['1', '2', '3'].),\n]\n# Table: paperkeyphrase\n[\n  (paperid:bigint, The ID of the paper associated with the keyphrase.. Value examples: ['1', '2', '3', '3'].),\n  (keyphraseid:bigint, The ID of the keyphrase associated with the paper.. Value examples: ['1', '2', '3', '5'].),\n]\n# Table: venue\n[\n  (venueid:bigint, Unique identifier for each venue. Value examples: ['1', '2', '3'].),\n  (venuename:text, Name of the venue. Value examples: ['Conference on Machine Learning', 'International Journal of Climate Change', 'Social Media Analysis Workshop'].),\n]\n# Table: writes\n[\n  (paperid:bigint, The unique identifier for a paper in the writes table.. Value examples: ['1', '2', '3', '4'].),\n  (authorid:bigint, The unique identifier for an author in the writes table.. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.authorid = writes.authorid\ncite.citingpaperid = paper.paperid\ncite.citingpaperid = paperdataset.paperid\ncite.citingpaperid = paperfield.paperid\ncite.citingpaperid = paperkeyphrase.paperid\ncite.citingpaperid = writes.paperid\ndataset.datasetid = paperdataset.datasetid\nfield.fieldid = paperfield.fieldid\njournal.journalid = paper.journalid\nkeyphrase.keyphraseid = paperkeyphrase.keyphraseid\npaper.paperid = paperdataset.paperid\npaper.paperid = paperfield.paperid\npaper.paperid = paperkeyphrase.paperid\npaper.paperid = writes.paperid\npaper.venueid = venue.venueid\npaperfield.paperid = paperkeyphrase.paperid\npaperfield.paperid = writes.paperid\npaperkeyphrase.paperid = writes.paperid\n\n【参考信息】\n\n\n【用户问题】\nWhat is the ratio of authors who have written 3 or more papers to authors who have written less than 3 papers?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT CAST(COUNT(DISTINCT CASE WHEN paper_count >= 3 THEN subquery.authorid END) AS FLOAT) / NULLIF(COUNT(DISTINCT CASE WHEN paper_count < 3 THEN subquery.authorid END), 0) AS ratio FROM (SELECT writes.authorid, COUNT(writes.paperid) AS paper_count FROM writes GROUP BY writes.authorid) AS subquery;",
        "role": "assistant"
      }
    ],
    "db_name": "scholar",
    "id": 158,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the proportion of papers that belong to more than 1 dataset to papers that belong to1 dataset?\n\n【数据库schema】\n【DB_ID】 scholar\n【Schema】\n# Table: author\n[\n  (authorid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3', '4'].),\n  (authorname:text, Name of the author. Value examples: ['John Smith', 'Emily Johnson', 'Michael Brown', 'Sarah Davis'].),\n]\n# Table: cite\n[\n  (citingpaperid:bigint, The ID of the paper that is doing the citing.. Value examples: ['1', '2', '3', '4'].),\n  (citedpaperid:bigint, The ID of the paper that is being cited.. Value examples: ['2', '3', '4', '5'].),\n]\n# Table: dataset\n[\n  (datasetid:bigint, Unique identifier for each dataset in the table. Value examples: ['1', '2', '3', '4'].),\n  (datasetname:text, Name of the dataset. Value examples: ['COVID-19 Research', 'Machine Learning Datasets', 'Climate Change Data', 'Social Media Analysis'].),\n]\n# Table: field\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: journal\n[\n  (journalid:bigint, Unique identifier for each journal entry. Value examples: ['1', '2'].),\n  (journalname:text, Name or title of the journal. Value examples: ['Nature', 'Science'].),\n]\n# Table: keyphrase\n[\n  (keyphraseid:bigint, Unique identifier for each keyphrase. Value examples: ['1', '2', '3'].),\n  (keyphrasename:text, The actual keyphrase text. Value examples: ['Machine Learning', 'Climate Change', 'Social Media'].),\n]\n# Table: paper\n[\n  (paperid:bigint, The unique ID of the paper.. Value examples: ['1', '2'].),\n  (title:text, The title of the paper, enclosed in double quotes if it contains commas.. Value examples: ['A Study on Machine Learning Algorithms', 'The Effects of Climate Change on Agriculture'].),\n  (venueid:bigint, The ID of the venue where the paper was published.. Value examples: ['1', '1'].),\n  (year:bigint, The year the paper was published.. Value examples: ['2020', '2020'].),\n  (numciting:bigint, The number of papers that this paper cites.. Value examples: ['2', '1'].),\n  (numcitedby:bigint, The number of papers that cite this paper.. Value examples: ['2', '2'].),\n  (journalid:bigint, The ID of the journal where the paper was published.. Value examples: ['3', '1'].),\n]\n# Table: paperdataset\n[\n  (paperid:bigint, Unique identifier for each paper in the dataset. Value examples: ['1', '2', '3'].),\n  (datasetid:bigint, Unique identifier for each dataset that the paper belongs to. Value examples: ['2', '3', '4'].),\n]\n# Table: paperfield\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3'].),\n  (paperid:bigint, Unique identifier for each paper in the table. Value examples: ['1', '2', '3'].),\n]\n# Table: paperkeyphrase\n[\n  (paperid:bigint, The ID of the paper associated with the keyphrase.. Value examples: ['1', '2', '3', '3'].),\n  (keyphraseid:bigint, The ID of the keyphrase associated with the paper.. Value examples: ['1', '2', '3', '5'].),\n]\n# Table: venue\n[\n  (venueid:bigint, Unique identifier for each venue. Value examples: ['1', '2', '3'].),\n  (venuename:text, Name of the venue. Value examples: ['Conference on Machine Learning', 'International Journal of Climate Change', 'Social Media Analysis Workshop'].),\n]\n# Table: writes\n[\n  (paperid:bigint, The unique identifier for a paper in the writes table.. Value examples: ['1', '2', '3', '4'].),\n  (authorid:bigint, The unique identifier for an author in the writes table.. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.authorid = writes.authorid\ncite.citingpaperid = paper.paperid\ncite.citingpaperid = paperdataset.paperid\ncite.citingpaperid = paperfield.paperid\ncite.citingpaperid = paperkeyphrase.paperid\ncite.citingpaperid = writes.paperid\ndataset.datasetid = paperdataset.datasetid\nfield.fieldid = paperfield.fieldid\njournal.journalid = paper.journalid\nkeyphrase.keyphraseid = paperkeyphrase.keyphraseid\npaper.paperid = paperdataset.paperid\npaper.paperid = paperfield.paperid\npaper.paperid = paperkeyphrase.paperid\npaper.paperid = writes.paperid\npaper.venueid = venue.venueid\npaperfield.paperid = paperkeyphrase.paperid\npaperfield.paperid = writes.paperid\npaperkeyphrase.paperid = writes.paperid\n\n【参考信息】\n\n\n【用户问题】\nWhat is the proportion of papers that belong to more than 1 dataset to papers that belong to1 dataset?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT CAST(COUNT(CASE WHEN dataset_count > 1 THEN 1 END) AS FLOAT) / NULLIF(COUNT(CASE WHEN dataset_count = 1 THEN 1 END), 0) AS ratio FROM (SELECT paperdataset.paperid, COUNT(paperdataset.datasetid) AS dataset_count FROM paperdataset GROUP BY paperdataset.paperid) AS subquery;",
        "role": "assistant"
      }
    ],
    "db_name": "scholar",
    "id": 159,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich papers are associated with the keyphrase \"Machine Learning\"?\n\n【数据库schema】\n【DB_ID】 scholar\n【Schema】\n# Table: author\n[\n  (authorid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3', '4'].),\n  (authorname:text, Name of the author. Value examples: ['John Smith', 'Emily Johnson', 'Michael Brown', 'Sarah Davis'].),\n]\n# Table: cite\n[\n  (citingpaperid:bigint, The ID of the paper that is doing the citing.. Value examples: ['1', '2', '3', '4'].),\n  (citedpaperid:bigint, The ID of the paper that is being cited.. Value examples: ['2', '3', '4', '5'].),\n]\n# Table: dataset\n[\n  (datasetid:bigint, Unique identifier for each dataset in the table. Value examples: ['1', '2', '3', '4'].),\n  (datasetname:text, Name of the dataset. Value examples: ['COVID-19 Research', 'Machine Learning Datasets', 'Climate Change Data', 'Social Media Analysis'].),\n]\n# Table: field\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: journal\n[\n  (journalid:bigint, Unique identifier for each journal entry. Value examples: ['1', '2'].),\n  (journalname:text, Name or title of the journal. Value examples: ['Nature', 'Science'].),\n]\n# Table: keyphrase\n[\n  (keyphraseid:bigint, Unique identifier for each keyphrase. Value examples: ['1', '2', '3'].),\n  (keyphrasename:text, The actual keyphrase text. Value examples: ['Machine Learning', 'Climate Change', 'Social Media'].),\n]\n# Table: paper\n[\n  (paperid:bigint, The unique ID of the paper.. Value examples: ['1', '2'].),\n  (title:text, The title of the paper, enclosed in double quotes if it contains commas.. Value examples: ['A Study on Machine Learning Algorithms', 'The Effects of Climate Change on Agriculture'].),\n  (venueid:bigint, The ID of the venue where the paper was published.. Value examples: ['1', '1'].),\n  (year:bigint, The year the paper was published.. Value examples: ['2020', '2020'].),\n  (numciting:bigint, The number of papers that this paper cites.. Value examples: ['2', '1'].),\n  (numcitedby:bigint, The number of papers that cite this paper.. Value examples: ['2', '2'].),\n  (journalid:bigint, The ID of the journal where the paper was published.. Value examples: ['3', '1'].),\n]\n# Table: paperdataset\n[\n  (paperid:bigint, Unique identifier for each paper in the dataset. Value examples: ['1', '2', '3'].),\n  (datasetid:bigint, Unique identifier for each dataset that the paper belongs to. Value examples: ['2', '3', '4'].),\n]\n# Table: paperfield\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3'].),\n  (paperid:bigint, Unique identifier for each paper in the table. Value examples: ['1', '2', '3'].),\n]\n# Table: paperkeyphrase\n[\n  (paperid:bigint, The ID of the paper associated with the keyphrase.. Value examples: ['1', '2', '3', '3'].),\n  (keyphraseid:bigint, The ID of the keyphrase associated with the paper.. Value examples: ['1', '2', '3', '5'].),\n]\n# Table: venue\n[\n  (venueid:bigint, Unique identifier for each venue. Value examples: ['1', '2', '3'].),\n  (venuename:text, Name of the venue. Value examples: ['Conference on Machine Learning', 'International Journal of Climate Change', 'Social Media Analysis Workshop'].),\n]\n# Table: writes\n[\n  (paperid:bigint, The unique identifier for a paper in the writes table.. Value examples: ['1', '2', '3', '4'].),\n  (authorid:bigint, The unique identifier for an author in the writes table.. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.authorid = writes.authorid\ncite.citingpaperid = paper.paperid\ncite.citingpaperid = paperdataset.paperid\ncite.citingpaperid = paperfield.paperid\ncite.citingpaperid = paperkeyphrase.paperid\ncite.citingpaperid = writes.paperid\ndataset.datasetid = paperdataset.datasetid\nfield.fieldid = paperfield.fieldid\njournal.journalid = paper.journalid\nkeyphrase.keyphraseid = paperkeyphrase.keyphraseid\npaper.paperid = paperdataset.paperid\npaper.paperid = paperfield.paperid\npaper.paperid = paperkeyphrase.paperid\npaper.paperid = writes.paperid\npaper.venueid = venue.venueid\npaperfield.paperid = paperkeyphrase.paperid\npaperfield.paperid = writes.paperid\npaperkeyphrase.paperid = writes.paperid\n\n【参考信息】\n\n\n【用户问题】\nWhich papers are associated with the keyphrase \"Machine Learning\"?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT paper.title, paper.paperid FROM paper JOIN paperkeyphrase ON paper.paperid = paperkeyphrase.paperid JOIN keyphrase ON paperkeyphrase.keyphraseid = keyphrase.keyphraseid WHERE keyphrase.keyphrasename ILIKE '%Machine Learning%'",
        "role": "assistant"
      }
    ],
    "db_name": "scholar",
    "id": 160,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich authors have published the most papers, ordered by the number of papers they have published in descending order?\n\n【数据库schema】\n【DB_ID】 scholar\n【Schema】\n# Table: author\n[\n  (authorid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3', '4'].),\n  (authorname:text, Name of the author. Value examples: ['John Smith', 'Emily Johnson', 'Michael Brown', 'Sarah Davis'].),\n]\n# Table: cite\n[\n  (citingpaperid:bigint, The ID of the paper that is doing the citing.. Value examples: ['1', '2', '3', '4'].),\n  (citedpaperid:bigint, The ID of the paper that is being cited.. Value examples: ['2', '3', '4', '5'].),\n]\n# Table: dataset\n[\n  (datasetid:bigint, Unique identifier for each dataset in the table. Value examples: ['1', '2', '3', '4'].),\n  (datasetname:text, Name of the dataset. Value examples: ['COVID-19 Research', 'Machine Learning Datasets', 'Climate Change Data', 'Social Media Analysis'].),\n]\n# Table: field\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: journal\n[\n  (journalid:bigint, Unique identifier for each journal entry. Value examples: ['1', '2'].),\n  (journalname:text, Name or title of the journal. Value examples: ['Nature', 'Science'].),\n]\n# Table: keyphrase\n[\n  (keyphraseid:bigint, Unique identifier for each keyphrase. Value examples: ['1', '2', '3'].),\n  (keyphrasename:text, The actual keyphrase text. Value examples: ['Machine Learning', 'Climate Change', 'Social Media'].),\n]\n# Table: paper\n[\n  (paperid:bigint, The unique ID of the paper.. Value examples: ['1', '2'].),\n  (title:text, The title of the paper, enclosed in double quotes if it contains commas.. Value examples: ['A Study on Machine Learning Algorithms', 'The Effects of Climate Change on Agriculture'].),\n  (venueid:bigint, The ID of the venue where the paper was published.. Value examples: ['1', '1'].),\n  (year:bigint, The year the paper was published.. Value examples: ['2020', '2020'].),\n  (numciting:bigint, The number of papers that this paper cites.. Value examples: ['2', '1'].),\n  (numcitedby:bigint, The number of papers that cite this paper.. Value examples: ['2', '2'].),\n  (journalid:bigint, The ID of the journal where the paper was published.. Value examples: ['3', '1'].),\n]\n# Table: paperdataset\n[\n  (paperid:bigint, Unique identifier for each paper in the dataset. Value examples: ['1', '2', '3'].),\n  (datasetid:bigint, Unique identifier for each dataset that the paper belongs to. Value examples: ['2', '3', '4'].),\n]\n# Table: paperfield\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3'].),\n  (paperid:bigint, Unique identifier for each paper in the table. Value examples: ['1', '2', '3'].),\n]\n# Table: paperkeyphrase\n[\n  (paperid:bigint, The ID of the paper associated with the keyphrase.. Value examples: ['1', '2', '3', '3'].),\n  (keyphraseid:bigint, The ID of the keyphrase associated with the paper.. Value examples: ['1', '2', '3', '5'].),\n]\n# Table: venue\n[\n  (venueid:bigint, Unique identifier for each venue. Value examples: ['1', '2', '3'].),\n  (venuename:text, Name of the venue. Value examples: ['Conference on Machine Learning', 'International Journal of Climate Change', 'Social Media Analysis Workshop'].),\n]\n# Table: writes\n[\n  (paperid:bigint, The unique identifier for a paper in the writes table.. Value examples: ['1', '2', '3', '4'].),\n  (authorid:bigint, The unique identifier for an author in the writes table.. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.authorid = writes.authorid\ncite.citingpaperid = paper.paperid\ncite.citingpaperid = paperdataset.paperid\ncite.citingpaperid = paperfield.paperid\ncite.citingpaperid = paperkeyphrase.paperid\ncite.citingpaperid = writes.paperid\ndataset.datasetid = paperdataset.datasetid\nfield.fieldid = paperfield.fieldid\njournal.journalid = paper.journalid\nkeyphrase.keyphraseid = paperkeyphrase.keyphraseid\npaper.paperid = paperdataset.paperid\npaper.paperid = paperfield.paperid\npaper.paperid = paperkeyphrase.paperid\npaper.paperid = writes.paperid\npaper.venueid = venue.venueid\npaperfield.paperid = paperkeyphrase.paperid\npaperfield.paperid = writes.paperid\npaperkeyphrase.paperid = writes.paperid\n\n【参考信息】\n\n\n【用户问题】\nWhich authors have published the most papers, ordered by the number of papers they have published in descending order?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT author.authorname, author.authorid, COUNT(DISTINCT writes.paperid) AS number_of_papers FROM author JOIN writes ON author.authorid = writes.authorid GROUP BY author.authorname, author.authorid ORDER BY number_of_papers DESC NULLS LAST",
        "role": "assistant"
      }
    ],
    "db_name": "scholar",
    "id": 161,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the total number of unique keyphrases associated with papers published in the journal with \"IEEE Transactions\" in its name?\n\n【数据库schema】\n【DB_ID】 scholar\n【Schema】\n# Table: author\n[\n  (authorid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3', '4'].),\n  (authorname:text, Name of the author. Value examples: ['John Smith', 'Emily Johnson', 'Michael Brown', 'Sarah Davis'].),\n]\n# Table: cite\n[\n  (citingpaperid:bigint, The ID of the paper that is doing the citing.. Value examples: ['1', '2', '3', '4'].),\n  (citedpaperid:bigint, The ID of the paper that is being cited.. Value examples: ['2', '3', '4', '5'].),\n]\n# Table: dataset\n[\n  (datasetid:bigint, Unique identifier for each dataset in the table. Value examples: ['1', '2', '3', '4'].),\n  (datasetname:text, Name of the dataset. Value examples: ['COVID-19 Research', 'Machine Learning Datasets', 'Climate Change Data', 'Social Media Analysis'].),\n]\n# Table: field\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: journal\n[\n  (journalid:bigint, Unique identifier for each journal entry. Value examples: ['1', '2'].),\n  (journalname:text, Name or title of the journal. Value examples: ['Nature', 'Science'].),\n]\n# Table: keyphrase\n[\n  (keyphraseid:bigint, Unique identifier for each keyphrase. Value examples: ['1', '2', '3'].),\n  (keyphrasename:text, The actual keyphrase text. Value examples: ['Machine Learning', 'Climate Change', 'Social Media'].),\n]\n# Table: paper\n[\n  (paperid:bigint, The unique ID of the paper.. Value examples: ['1', '2'].),\n  (title:text, The title of the paper, enclosed in double quotes if it contains commas.. Value examples: ['A Study on Machine Learning Algorithms', 'The Effects of Climate Change on Agriculture'].),\n  (venueid:bigint, The ID of the venue where the paper was published.. Value examples: ['1', '1'].),\n  (year:bigint, The year the paper was published.. Value examples: ['2020', '2020'].),\n  (numciting:bigint, The number of papers that this paper cites.. Value examples: ['2', '1'].),\n  (numcitedby:bigint, The number of papers that cite this paper.. Value examples: ['2', '2'].),\n  (journalid:bigint, The ID of the journal where the paper was published.. Value examples: ['3', '1'].),\n]\n# Table: paperdataset\n[\n  (paperid:bigint, Unique identifier for each paper in the dataset. Value examples: ['1', '2', '3'].),\n  (datasetid:bigint, Unique identifier for each dataset that the paper belongs to. Value examples: ['2', '3', '4'].),\n]\n# Table: paperfield\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3'].),\n  (paperid:bigint, Unique identifier for each paper in the table. Value examples: ['1', '2', '3'].),\n]\n# Table: paperkeyphrase\n[\n  (paperid:bigint, The ID of the paper associated with the keyphrase.. Value examples: ['1', '2', '3', '3'].),\n  (keyphraseid:bigint, The ID of the keyphrase associated with the paper.. Value examples: ['1', '2', '3', '5'].),\n]\n# Table: venue\n[\n  (venueid:bigint, Unique identifier for each venue. Value examples: ['1', '2', '3'].),\n  (venuename:text, Name of the venue. Value examples: ['Conference on Machine Learning', 'International Journal of Climate Change', 'Social Media Analysis Workshop'].),\n]\n# Table: writes\n[\n  (paperid:bigint, The unique identifier for a paper in the writes table.. Value examples: ['1', '2', '3', '4'].),\n  (authorid:bigint, The unique identifier for an author in the writes table.. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.authorid = writes.authorid\ncite.citingpaperid = paper.paperid\ncite.citingpaperid = paperdataset.paperid\ncite.citingpaperid = paperfield.paperid\ncite.citingpaperid = paperkeyphrase.paperid\ncite.citingpaperid = writes.paperid\ndataset.datasetid = paperdataset.datasetid\nfield.fieldid = paperfield.fieldid\njournal.journalid = paper.journalid\nkeyphrase.keyphraseid = paperkeyphrase.keyphraseid\npaper.paperid = paperdataset.paperid\npaper.paperid = paperfield.paperid\npaper.paperid = paperkeyphrase.paperid\npaper.paperid = writes.paperid\npaper.venueid = venue.venueid\npaperfield.paperid = paperkeyphrase.paperid\npaperfield.paperid = writes.paperid\npaperkeyphrase.paperid = writes.paperid\n\n【参考信息】\n\n\n【用户问题】\nWhat is the total number of unique keyphrases associated with papers published in the journal with \"IEEE Transactions\" in its name?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT COUNT(DISTINCT paperkeyphrase.keyphraseid) AS total_keyphrases FROM paper JOIN journal ON paper.journalid = journal.journalid JOIN paperkeyphrase ON paper.paperid = paperkeyphrase.paperid WHERE journal.journalname ILIKE '%IEEE Transactions%';",
        "role": "assistant"
      }
    ],
    "db_name": "scholar",
    "id": 162,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the total number of papers published in each journal, ordered by the journal name?\n\n【数据库schema】\n【DB_ID】 scholar\n【Schema】\n# Table: author\n[\n  (authorid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3', '4'].),\n  (authorname:text, Name of the author. Value examples: ['John Smith', 'Emily Johnson', 'Michael Brown', 'Sarah Davis'].),\n]\n# Table: cite\n[\n  (citingpaperid:bigint, The ID of the paper that is doing the citing.. Value examples: ['1', '2', '3', '4'].),\n  (citedpaperid:bigint, The ID of the paper that is being cited.. Value examples: ['2', '3', '4', '5'].),\n]\n# Table: dataset\n[\n  (datasetid:bigint, Unique identifier for each dataset in the table. Value examples: ['1', '2', '3', '4'].),\n  (datasetname:text, Name of the dataset. Value examples: ['COVID-19 Research', 'Machine Learning Datasets', 'Climate Change Data', 'Social Media Analysis'].),\n]\n# Table: field\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: journal\n[\n  (journalid:bigint, Unique identifier for each journal entry. Value examples: ['1', '2'].),\n  (journalname:text, Name or title of the journal. Value examples: ['Nature', 'Science'].),\n]\n# Table: keyphrase\n[\n  (keyphraseid:bigint, Unique identifier for each keyphrase. Value examples: ['1', '2', '3'].),\n  (keyphrasename:text, The actual keyphrase text. Value examples: ['Machine Learning', 'Climate Change', 'Social Media'].),\n]\n# Table: paper\n[\n  (paperid:bigint, The unique ID of the paper.. Value examples: ['1', '2'].),\n  (title:text, The title of the paper, enclosed in double quotes if it contains commas.. Value examples: ['A Study on Machine Learning Algorithms', 'The Effects of Climate Change on Agriculture'].),\n  (venueid:bigint, The ID of the venue where the paper was published.. Value examples: ['1', '1'].),\n  (year:bigint, The year the paper was published.. Value examples: ['2020', '2020'].),\n  (numciting:bigint, The number of papers that this paper cites.. Value examples: ['2', '1'].),\n  (numcitedby:bigint, The number of papers that cite this paper.. Value examples: ['2', '2'].),\n  (journalid:bigint, The ID of the journal where the paper was published.. Value examples: ['3', '1'].),\n]\n# Table: paperdataset\n[\n  (paperid:bigint, Unique identifier for each paper in the dataset. Value examples: ['1', '2', '3'].),\n  (datasetid:bigint, Unique identifier for each dataset that the paper belongs to. Value examples: ['2', '3', '4'].),\n]\n# Table: paperfield\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3'].),\n  (paperid:bigint, Unique identifier for each paper in the table. Value examples: ['1', '2', '3'].),\n]\n# Table: paperkeyphrase\n[\n  (paperid:bigint, The ID of the paper associated with the keyphrase.. Value examples: ['1', '2', '3', '3'].),\n  (keyphraseid:bigint, The ID of the keyphrase associated with the paper.. Value examples: ['1', '2', '3', '5'].),\n]\n# Table: venue\n[\n  (venueid:bigint, Unique identifier for each venue. Value examples: ['1', '2', '3'].),\n  (venuename:text, Name of the venue. Value examples: ['Conference on Machine Learning', 'International Journal of Climate Change', 'Social Media Analysis Workshop'].),\n]\n# Table: writes\n[\n  (paperid:bigint, The unique identifier for a paper in the writes table.. Value examples: ['1', '2', '3', '4'].),\n  (authorid:bigint, The unique identifier for an author in the writes table.. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.authorid = writes.authorid\ncite.citingpaperid = paper.paperid\ncite.citingpaperid = paperdataset.paperid\ncite.citingpaperid = paperfield.paperid\ncite.citingpaperid = paperkeyphrase.paperid\ncite.citingpaperid = writes.paperid\ndataset.datasetid = paperdataset.datasetid\nfield.fieldid = paperfield.fieldid\njournal.journalid = paper.journalid\nkeyphrase.keyphraseid = paperkeyphrase.keyphraseid\npaper.paperid = paperdataset.paperid\npaper.paperid = paperfield.paperid\npaper.paperid = paperkeyphrase.paperid\npaper.paperid = writes.paperid\npaper.venueid = venue.venueid\npaperfield.paperid = paperkeyphrase.paperid\npaperfield.paperid = writes.paperid\npaperkeyphrase.paperid = writes.paperid\n\n【参考信息】\n\n\n【用户问题】\nWhat is the total number of papers published in each journal, ordered by the journal name?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT journal.journalname, COUNT(DISTINCT paper.paperid) AS total_papers FROM paper JOIN journal ON paper.journalid = journal.journalid GROUP BY journal.journalname ORDER BY journal.journalname NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "scholar",
    "id": 163,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many papers cite each paper in the dataset named \"COVID-19 Research\"?\n\n【数据库schema】\n【DB_ID】 scholar\n【Schema】\n# Table: author\n[\n  (authorid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3', '4'].),\n  (authorname:text, Name of the author. Value examples: ['John Smith', 'Emily Johnson', 'Michael Brown', 'Sarah Davis'].),\n]\n# Table: cite\n[\n  (citingpaperid:bigint, The ID of the paper that is doing the citing.. Value examples: ['1', '2', '3', '4'].),\n  (citedpaperid:bigint, The ID of the paper that is being cited.. Value examples: ['2', '3', '4', '5'].),\n]\n# Table: dataset\n[\n  (datasetid:bigint, Unique identifier for each dataset in the table. Value examples: ['1', '2', '3', '4'].),\n  (datasetname:text, Name of the dataset. Value examples: ['COVID-19 Research', 'Machine Learning Datasets', 'Climate Change Data', 'Social Media Analysis'].),\n]\n# Table: field\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: journal\n[\n  (journalid:bigint, Unique identifier for each journal entry. Value examples: ['1', '2'].),\n  (journalname:text, Name or title of the journal. Value examples: ['Nature', 'Science'].),\n]\n# Table: keyphrase\n[\n  (keyphraseid:bigint, Unique identifier for each keyphrase. Value examples: ['1', '2', '3'].),\n  (keyphrasename:text, The actual keyphrase text. Value examples: ['Machine Learning', 'Climate Change', 'Social Media'].),\n]\n# Table: paper\n[\n  (paperid:bigint, The unique ID of the paper.. Value examples: ['1', '2'].),\n  (title:text, The title of the paper, enclosed in double quotes if it contains commas.. Value examples: ['A Study on Machine Learning Algorithms', 'The Effects of Climate Change on Agriculture'].),\n  (venueid:bigint, The ID of the venue where the paper was published.. Value examples: ['1', '1'].),\n  (year:bigint, The year the paper was published.. Value examples: ['2020', '2020'].),\n  (numciting:bigint, The number of papers that this paper cites.. Value examples: ['2', '1'].),\n  (numcitedby:bigint, The number of papers that cite this paper.. Value examples: ['2', '2'].),\n  (journalid:bigint, The ID of the journal where the paper was published.. Value examples: ['3', '1'].),\n]\n# Table: paperdataset\n[\n  (paperid:bigint, Unique identifier for each paper in the dataset. Value examples: ['1', '2', '3'].),\n  (datasetid:bigint, Unique identifier for each dataset that the paper belongs to. Value examples: ['2', '3', '4'].),\n]\n# Table: paperfield\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3'].),\n  (paperid:bigint, Unique identifier for each paper in the table. Value examples: ['1', '2', '3'].),\n]\n# Table: paperkeyphrase\n[\n  (paperid:bigint, The ID of the paper associated with the keyphrase.. Value examples: ['1', '2', '3', '3'].),\n  (keyphraseid:bigint, The ID of the keyphrase associated with the paper.. Value examples: ['1', '2', '3', '5'].),\n]\n# Table: venue\n[\n  (venueid:bigint, Unique identifier for each venue. Value examples: ['1', '2', '3'].),\n  (venuename:text, Name of the venue. Value examples: ['Conference on Machine Learning', 'International Journal of Climate Change', 'Social Media Analysis Workshop'].),\n]\n# Table: writes\n[\n  (paperid:bigint, The unique identifier for a paper in the writes table.. Value examples: ['1', '2', '3', '4'].),\n  (authorid:bigint, The unique identifier for an author in the writes table.. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.authorid = writes.authorid\ncite.citingpaperid = paper.paperid\ncite.citingpaperid = paperdataset.paperid\ncite.citingpaperid = paperfield.paperid\ncite.citingpaperid = paperkeyphrase.paperid\ncite.citingpaperid = writes.paperid\ndataset.datasetid = paperdataset.datasetid\nfield.fieldid = paperfield.fieldid\njournal.journalid = paper.journalid\nkeyphrase.keyphraseid = paperkeyphrase.keyphraseid\npaper.paperid = paperdataset.paperid\npaper.paperid = paperfield.paperid\npaper.paperid = paperkeyphrase.paperid\npaper.paperid = writes.paperid\npaper.venueid = venue.venueid\npaperfield.paperid = paperkeyphrase.paperid\npaperfield.paperid = writes.paperid\npaperkeyphrase.paperid = writes.paperid\n\n【参考信息】\n\n\n【用户问题】\nHow many papers cite each paper in the dataset named \"COVID-19 Research\"?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT paperdataset.paperid, COUNT(cite.citedpaperid) AS citation_count FROM paperdataset JOIN cite ON paperdataset.paperid = cite.citedpaperid WHERE paperdataset.datasetid = (SELECT datasetid FROM dataset WHERE datasetname ILIKE '%COVID-19 Research%') GROUP BY paperdataset.paperid ORDER BY citation_count DESC;SELECT p.title, COUNT(c.citingpaperid) AS num_citing_papers FROM paper p JOIN paperdataset pd ON p.paperid = pd.paperid JOIN cite c ON p.paperid = c.citedpaperid JOIN dataset d ON pd.datasetid = d.datasetid WHERE d.datasetname = 'COVID-19 Research' GROUP BY p.title ORDER BY num_citing_papers DESC NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "scholar",
    "id": 164,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the name of the venue where the paper with paper ID 2 was published, and how many papers were published in total in that venue?\n\n【数据库schema】\n【DB_ID】 scholar\n【Schema】\n# Table: author\n[\n  (authorid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3', '4'].),\n  (authorname:text, Name of the author. Value examples: ['John Smith', 'Emily Johnson', 'Michael Brown', 'Sarah Davis'].),\n]\n# Table: cite\n[\n  (citingpaperid:bigint, The ID of the paper that is doing the citing.. Value examples: ['1', '2', '3', '4'].),\n  (citedpaperid:bigint, The ID of the paper that is being cited.. Value examples: ['2', '3', '4', '5'].),\n]\n# Table: dataset\n[\n  (datasetid:bigint, Unique identifier for each dataset in the table. Value examples: ['1', '2', '3', '4'].),\n  (datasetname:text, Name of the dataset. Value examples: ['COVID-19 Research', 'Machine Learning Datasets', 'Climate Change Data', 'Social Media Analysis'].),\n]\n# Table: field\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: journal\n[\n  (journalid:bigint, Unique identifier for each journal entry. Value examples: ['1', '2'].),\n  (journalname:text, Name or title of the journal. Value examples: ['Nature', 'Science'].),\n]\n# Table: keyphrase\n[\n  (keyphraseid:bigint, Unique identifier for each keyphrase. Value examples: ['1', '2', '3'].),\n  (keyphrasename:text, The actual keyphrase text. Value examples: ['Machine Learning', 'Climate Change', 'Social Media'].),\n]\n# Table: paper\n[\n  (paperid:bigint, The unique ID of the paper.. Value examples: ['1', '2'].),\n  (title:text, The title of the paper, enclosed in double quotes if it contains commas.. Value examples: ['A Study on Machine Learning Algorithms', 'The Effects of Climate Change on Agriculture'].),\n  (venueid:bigint, The ID of the venue where the paper was published.. Value examples: ['1', '1'].),\n  (year:bigint, The year the paper was published.. Value examples: ['2020', '2020'].),\n  (numciting:bigint, The number of papers that this paper cites.. Value examples: ['2', '1'].),\n  (numcitedby:bigint, The number of papers that cite this paper.. Value examples: ['2', '2'].),\n  (journalid:bigint, The ID of the journal where the paper was published.. Value examples: ['3', '1'].),\n]\n# Table: paperdataset\n[\n  (paperid:bigint, Unique identifier for each paper in the dataset. Value examples: ['1', '2', '3'].),\n  (datasetid:bigint, Unique identifier for each dataset that the paper belongs to. Value examples: ['2', '3', '4'].),\n]\n# Table: paperfield\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3'].),\n  (paperid:bigint, Unique identifier for each paper in the table. Value examples: ['1', '2', '3'].),\n]\n# Table: paperkeyphrase\n[\n  (paperid:bigint, The ID of the paper associated with the keyphrase.. Value examples: ['1', '2', '3', '3'].),\n  (keyphraseid:bigint, The ID of the keyphrase associated with the paper.. Value examples: ['1', '2', '3', '5'].),\n]\n# Table: venue\n[\n  (venueid:bigint, Unique identifier for each venue. Value examples: ['1', '2', '3'].),\n  (venuename:text, Name of the venue. Value examples: ['Conference on Machine Learning', 'International Journal of Climate Change', 'Social Media Analysis Workshop'].),\n]\n# Table: writes\n[\n  (paperid:bigint, The unique identifier for a paper in the writes table.. Value examples: ['1', '2', '3', '4'].),\n  (authorid:bigint, The unique identifier for an author in the writes table.. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.authorid = writes.authorid\ncite.citingpaperid = paper.paperid\ncite.citingpaperid = paperdataset.paperid\ncite.citingpaperid = paperfield.paperid\ncite.citingpaperid = paperkeyphrase.paperid\ncite.citingpaperid = writes.paperid\ndataset.datasetid = paperdataset.datasetid\nfield.fieldid = paperfield.fieldid\njournal.journalid = paper.journalid\nkeyphrase.keyphraseid = paperkeyphrase.keyphraseid\npaper.paperid = paperdataset.paperid\npaper.paperid = paperfield.paperid\npaper.paperid = paperkeyphrase.paperid\npaper.paperid = writes.paperid\npaper.venueid = venue.venueid\npaperfield.paperid = paperkeyphrase.paperid\npaperfield.paperid = writes.paperid\npaperkeyphrase.paperid = writes.paperid\n\n【参考信息】\nAlways filter strings using ILIKE\n\n【用户问题】\nWhat is the name of the venue where the paper with paper ID 2 was published, and how many papers were published in total in that venue?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT venue.venuename, COUNT(DISTINCT paper.paperid) FROM paper JOIN venue ON paper.venueid = venue.venueid WHERE paper.venueid = (SELECT venueid FROM paper WHERE paperid = 2 ) GROUP BY venue.venuename;",
        "role": "assistant"
      }
    ],
    "db_name": "scholar",
    "id": 165,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the names of the authors who wrote the paper with the title \"The Effects of Climate Change on Agriculture\"?\n\n【数据库schema】\n【DB_ID】 scholar\n【Schema】\n# Table: author\n[\n  (authorid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3', '4'].),\n  (authorname:text, Name of the author. Value examples: ['John Smith', 'Emily Johnson', 'Michael Brown', 'Sarah Davis'].),\n]\n# Table: cite\n[\n  (citingpaperid:bigint, The ID of the paper that is doing the citing.. Value examples: ['1', '2', '3', '4'].),\n  (citedpaperid:bigint, The ID of the paper that is being cited.. Value examples: ['2', '3', '4', '5'].),\n]\n# Table: dataset\n[\n  (datasetid:bigint, Unique identifier for each dataset in the table. Value examples: ['1', '2', '3', '4'].),\n  (datasetname:text, Name of the dataset. Value examples: ['COVID-19 Research', 'Machine Learning Datasets', 'Climate Change Data', 'Social Media Analysis'].),\n]\n# Table: field\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: journal\n[\n  (journalid:bigint, Unique identifier for each journal entry. Value examples: ['1', '2'].),\n  (journalname:text, Name or title of the journal. Value examples: ['Nature', 'Science'].),\n]\n# Table: keyphrase\n[\n  (keyphraseid:bigint, Unique identifier for each keyphrase. Value examples: ['1', '2', '3'].),\n  (keyphrasename:text, The actual keyphrase text. Value examples: ['Machine Learning', 'Climate Change', 'Social Media'].),\n]\n# Table: paper\n[\n  (paperid:bigint, The unique ID of the paper.. Value examples: ['1', '2'].),\n  (title:text, The title of the paper, enclosed in double quotes if it contains commas.. Value examples: ['A Study on Machine Learning Algorithms', 'The Effects of Climate Change on Agriculture'].),\n  (venueid:bigint, The ID of the venue where the paper was published.. Value examples: ['1', '1'].),\n  (year:bigint, The year the paper was published.. Value examples: ['2020', '2020'].),\n  (numciting:bigint, The number of papers that this paper cites.. Value examples: ['2', '1'].),\n  (numcitedby:bigint, The number of papers that cite this paper.. Value examples: ['2', '2'].),\n  (journalid:bigint, The ID of the journal where the paper was published.. Value examples: ['3', '1'].),\n]\n# Table: paperdataset\n[\n  (paperid:bigint, Unique identifier for each paper in the dataset. Value examples: ['1', '2', '3'].),\n  (datasetid:bigint, Unique identifier for each dataset that the paper belongs to. Value examples: ['2', '3', '4'].),\n]\n# Table: paperfield\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3'].),\n  (paperid:bigint, Unique identifier for each paper in the table. Value examples: ['1', '2', '3'].),\n]\n# Table: paperkeyphrase\n[\n  (paperid:bigint, The ID of the paper associated with the keyphrase.. Value examples: ['1', '2', '3', '3'].),\n  (keyphraseid:bigint, The ID of the keyphrase associated with the paper.. Value examples: ['1', '2', '3', '5'].),\n]\n# Table: venue\n[\n  (venueid:bigint, Unique identifier for each venue. Value examples: ['1', '2', '3'].),\n  (venuename:text, Name of the venue. Value examples: ['Conference on Machine Learning', 'International Journal of Climate Change', 'Social Media Analysis Workshop'].),\n]\n# Table: writes\n[\n  (paperid:bigint, The unique identifier for a paper in the writes table.. Value examples: ['1', '2', '3', '4'].),\n  (authorid:bigint, The unique identifier for an author in the writes table.. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.authorid = writes.authorid\ncite.citingpaperid = paper.paperid\ncite.citingpaperid = paperdataset.paperid\ncite.citingpaperid = paperfield.paperid\ncite.citingpaperid = paperkeyphrase.paperid\ncite.citingpaperid = writes.paperid\ndataset.datasetid = paperdataset.datasetid\nfield.fieldid = paperfield.fieldid\njournal.journalid = paper.journalid\nkeyphrase.keyphraseid = paperkeyphrase.keyphraseid\npaper.paperid = paperdataset.paperid\npaper.paperid = paperfield.paperid\npaper.paperid = paperkeyphrase.paperid\npaper.paperid = writes.paperid\npaper.venueid = venue.venueid\npaperfield.paperid = paperkeyphrase.paperid\npaperfield.paperid = writes.paperid\npaperkeyphrase.paperid = writes.paperid\n\n【参考信息】\nAlways filter strings with an exact match\n\n【用户问题】\nWhat are the names of the authors who wrote the paper with the title \"The Effects of Climate Change on Agriculture\"?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT author.authorname FROM author JOIN writes ON author.authorid = writes.authorid JOIN paper ON writes.paperid = paper.paperid WHERE paper.title = 'The Effects of Climate Change on Agriculture';",
        "role": "assistant"
      }
    ],
    "db_name": "scholar",
    "id": 166,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many papers were published in the journal \"nature\" in the year 2020?\n\n【数据库schema】\n【DB_ID】 scholar\n【Schema】\n# Table: author\n[\n  (authorid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3', '4'].),\n  (authorname:text, Name of the author. Value examples: ['John Smith', 'Emily Johnson', 'Michael Brown', 'Sarah Davis'].),\n]\n# Table: cite\n[\n  (citingpaperid:bigint, The ID of the paper that is doing the citing.. Value examples: ['1', '2', '3', '4'].),\n  (citedpaperid:bigint, The ID of the paper that is being cited.. Value examples: ['2', '3', '4', '5'].),\n]\n# Table: dataset\n[\n  (datasetid:bigint, Unique identifier for each dataset in the table. Value examples: ['1', '2', '3', '4'].),\n  (datasetname:text, Name of the dataset. Value examples: ['COVID-19 Research', 'Machine Learning Datasets', 'Climate Change Data', 'Social Media Analysis'].),\n]\n# Table: field\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: journal\n[\n  (journalid:bigint, Unique identifier for each journal entry. Value examples: ['1', '2'].),\n  (journalname:text, Name or title of the journal. Value examples: ['Nature', 'Science'].),\n]\n# Table: keyphrase\n[\n  (keyphraseid:bigint, Unique identifier for each keyphrase. Value examples: ['1', '2', '3'].),\n  (keyphrasename:text, The actual keyphrase text. Value examples: ['Machine Learning', 'Climate Change', 'Social Media'].),\n]\n# Table: paper\n[\n  (paperid:bigint, The unique ID of the paper.. Value examples: ['1', '2'].),\n  (title:text, The title of the paper, enclosed in double quotes if it contains commas.. Value examples: ['A Study on Machine Learning Algorithms', 'The Effects of Climate Change on Agriculture'].),\n  (venueid:bigint, The ID of the venue where the paper was published.. Value examples: ['1', '1'].),\n  (year:bigint, The year the paper was published.. Value examples: ['2020', '2020'].),\n  (numciting:bigint, The number of papers that this paper cites.. Value examples: ['2', '1'].),\n  (numcitedby:bigint, The number of papers that cite this paper.. Value examples: ['2', '2'].),\n  (journalid:bigint, The ID of the journal where the paper was published.. Value examples: ['3', '1'].),\n]\n# Table: paperdataset\n[\n  (paperid:bigint, Unique identifier for each paper in the dataset. Value examples: ['1', '2', '3'].),\n  (datasetid:bigint, Unique identifier for each dataset that the paper belongs to. Value examples: ['2', '3', '4'].),\n]\n# Table: paperfield\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3'].),\n  (paperid:bigint, Unique identifier for each paper in the table. Value examples: ['1', '2', '3'].),\n]\n# Table: paperkeyphrase\n[\n  (paperid:bigint, The ID of the paper associated with the keyphrase.. Value examples: ['1', '2', '3', '3'].),\n  (keyphraseid:bigint, The ID of the keyphrase associated with the paper.. Value examples: ['1', '2', '3', '5'].),\n]\n# Table: venue\n[\n  (venueid:bigint, Unique identifier for each venue. Value examples: ['1', '2', '3'].),\n  (venuename:text, Name of the venue. Value examples: ['Conference on Machine Learning', 'International Journal of Climate Change', 'Social Media Analysis Workshop'].),\n]\n# Table: writes\n[\n  (paperid:bigint, The unique identifier for a paper in the writes table.. Value examples: ['1', '2', '3', '4'].),\n  (authorid:bigint, The unique identifier for an author in the writes table.. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.authorid = writes.authorid\ncite.citingpaperid = paper.paperid\ncite.citingpaperid = paperdataset.paperid\ncite.citingpaperid = paperfield.paperid\ncite.citingpaperid = paperkeyphrase.paperid\ncite.citingpaperid = writes.paperid\ndataset.datasetid = paperdataset.datasetid\nfield.fieldid = paperfield.fieldid\njournal.journalid = paper.journalid\nkeyphrase.keyphraseid = paperkeyphrase.keyphraseid\npaper.paperid = paperdataset.paperid\npaper.paperid = paperfield.paperid\npaper.paperid = paperkeyphrase.paperid\npaper.paperid = writes.paperid\npaper.venueid = venue.venueid\npaperfield.paperid = paperkeyphrase.paperid\npaperfield.paperid = writes.paperid\npaperkeyphrase.paperid = writes.paperid\n\n【参考信息】\nFilter strings with case-insensitive matching\n\n【用户问题】\nHow many papers were published in the journal \"nature\" in the year 2020?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT COUNT(paper.paperid) FROM paper JOIN journal ON paper.journalid = journal.journalid WHERE paper.year = 2020 AND journal.journalname ILIKE '%nature%';",
        "role": "assistant"
      }
    ],
    "db_name": "scholar",
    "id": 167,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many papers are associated with the keyphrase \"machine learning\" and were published in the journal named \"IEEE Transactions on Pattern Analysis and Machine Intelligence\"?\n\n【数据库schema】\n【DB_ID】 scholar\n【Schema】\n# Table: author\n[\n  (authorid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3', '4'].),\n  (authorname:text, Name of the author. Value examples: ['John Smith', 'Emily Johnson', 'Michael Brown', 'Sarah Davis'].),\n]\n# Table: cite\n[\n  (citingpaperid:bigint, The ID of the paper that is doing the citing.. Value examples: ['1', '2', '3', '4'].),\n  (citedpaperid:bigint, The ID of the paper that is being cited.. Value examples: ['2', '3', '4', '5'].),\n]\n# Table: dataset\n[\n  (datasetid:bigint, Unique identifier for each dataset in the table. Value examples: ['1', '2', '3', '4'].),\n  (datasetname:text, Name of the dataset. Value examples: ['COVID-19 Research', 'Machine Learning Datasets', 'Climate Change Data', 'Social Media Analysis'].),\n]\n# Table: field\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: journal\n[\n  (journalid:bigint, Unique identifier for each journal entry. Value examples: ['1', '2'].),\n  (journalname:text, Name or title of the journal. Value examples: ['Nature', 'Science'].),\n]\n# Table: keyphrase\n[\n  (keyphraseid:bigint, Unique identifier for each keyphrase. Value examples: ['1', '2', '3'].),\n  (keyphrasename:text, The actual keyphrase text. Value examples: ['Machine Learning', 'Climate Change', 'Social Media'].),\n]\n# Table: paper\n[\n  (paperid:bigint, The unique ID of the paper.. Value examples: ['1', '2'].),\n  (title:text, The title of the paper, enclosed in double quotes if it contains commas.. Value examples: ['A Study on Machine Learning Algorithms', 'The Effects of Climate Change on Agriculture'].),\n  (venueid:bigint, The ID of the venue where the paper was published.. Value examples: ['1', '1'].),\n  (year:bigint, The year the paper was published.. Value examples: ['2020', '2020'].),\n  (numciting:bigint, The number of papers that this paper cites.. Value examples: ['2', '1'].),\n  (numcitedby:bigint, The number of papers that cite this paper.. Value examples: ['2', '2'].),\n  (journalid:bigint, The ID of the journal where the paper was published.. Value examples: ['3', '1'].),\n]\n# Table: paperdataset\n[\n  (paperid:bigint, Unique identifier for each paper in the dataset. Value examples: ['1', '2', '3'].),\n  (datasetid:bigint, Unique identifier for each dataset that the paper belongs to. Value examples: ['2', '3', '4'].),\n]\n# Table: paperfield\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3'].),\n  (paperid:bigint, Unique identifier for each paper in the table. Value examples: ['1', '2', '3'].),\n]\n# Table: paperkeyphrase\n[\n  (paperid:bigint, The ID of the paper associated with the keyphrase.. Value examples: ['1', '2', '3', '3'].),\n  (keyphraseid:bigint, The ID of the keyphrase associated with the paper.. Value examples: ['1', '2', '3', '5'].),\n]\n# Table: venue\n[\n  (venueid:bigint, Unique identifier for each venue. Value examples: ['1', '2', '3'].),\n  (venuename:text, Name of the venue. Value examples: ['Conference on Machine Learning', 'International Journal of Climate Change', 'Social Media Analysis Workshop'].),\n]\n# Table: writes\n[\n  (paperid:bigint, The unique identifier for a paper in the writes table.. Value examples: ['1', '2', '3', '4'].),\n  (authorid:bigint, The unique identifier for an author in the writes table.. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.authorid = writes.authorid\ncite.citingpaperid = paper.paperid\ncite.citingpaperid = paperdataset.paperid\ncite.citingpaperid = paperfield.paperid\ncite.citingpaperid = paperkeyphrase.paperid\ncite.citingpaperid = writes.paperid\ndataset.datasetid = paperdataset.datasetid\nfield.fieldid = paperfield.fieldid\njournal.journalid = paper.journalid\nkeyphrase.keyphraseid = paperkeyphrase.keyphraseid\npaper.paperid = paperdataset.paperid\npaper.paperid = paperfield.paperid\npaper.paperid = paperkeyphrase.paperid\npaper.paperid = writes.paperid\npaper.venueid = venue.venueid\npaperfield.paperid = paperkeyphrase.paperid\npaperfield.paperid = writes.paperid\npaperkeyphrase.paperid = writes.paperid\n\n【参考信息】\nFilter paper names, journal names, using exact matches. Filter keyphrases with case-insensitive matching.\n\n【用户问题】\nHow many papers are associated with the keyphrase \"machine learning\" and were published in the journal named \"IEEE Transactions on Pattern Analysis and Machine Intelligence\"?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT COUNT(DISTINCT paper.paperid) FROM paper JOIN journal ON paper.journalid = journal.journalid JOIN paperkeyphrase ON paper.paperid = paperkeyphrase.paperid JOIN keyphrase ON paperkeyphrase.keyphraseid = keyphrase.keyphraseid WHERE keyphrase.keyphrasename ILIKE '%machine learning%' AND journal.journalname = 'IEEE Transactions on Pattern Analysis and Machine Intelligence';",
        "role": "assistant"
      }
    ],
    "db_name": "scholar",
    "id": 168,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many authors wrote papers that were published in the journal \"Science\" in the year 2020?\n\n【数据库schema】\n【DB_ID】 scholar\n【Schema】\n# Table: author\n[\n  (authorid:bigint, Unique identifier for each author. Value examples: ['1', '2', '3', '4'].),\n  (authorname:text, Name of the author. Value examples: ['John Smith', 'Emily Johnson', 'Michael Brown', 'Sarah Davis'].),\n]\n# Table: cite\n[\n  (citingpaperid:bigint, The ID of the paper that is doing the citing.. Value examples: ['1', '2', '3', '4'].),\n  (citedpaperid:bigint, The ID of the paper that is being cited.. Value examples: ['2', '3', '4', '5'].),\n]\n# Table: dataset\n[\n  (datasetid:bigint, Unique identifier for each dataset in the table. Value examples: ['1', '2', '3', '4'].),\n  (datasetname:text, Name of the dataset. Value examples: ['COVID-19 Research', 'Machine Learning Datasets', 'Climate Change Data', 'Social Media Analysis'].),\n]\n# Table: field\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3', '4'].),\n]\n# Table: journal\n[\n  (journalid:bigint, Unique identifier for each journal entry. Value examples: ['1', '2'].),\n  (journalname:text, Name or title of the journal. Value examples: ['Nature', 'Science'].),\n]\n# Table: keyphrase\n[\n  (keyphraseid:bigint, Unique identifier for each keyphrase. Value examples: ['1', '2', '3'].),\n  (keyphrasename:text, The actual keyphrase text. Value examples: ['Machine Learning', 'Climate Change', 'Social Media'].),\n]\n# Table: paper\n[\n  (paperid:bigint, The unique ID of the paper.. Value examples: ['1', '2'].),\n  (title:text, The title of the paper, enclosed in double quotes if it contains commas.. Value examples: ['A Study on Machine Learning Algorithms', 'The Effects of Climate Change on Agriculture'].),\n  (venueid:bigint, The ID of the venue where the paper was published.. Value examples: ['1', '1'].),\n  (year:bigint, The year the paper was published.. Value examples: ['2020', '2020'].),\n  (numciting:bigint, The number of papers that this paper cites.. Value examples: ['2', '1'].),\n  (numcitedby:bigint, The number of papers that cite this paper.. Value examples: ['2', '2'].),\n  (journalid:bigint, The ID of the journal where the paper was published.. Value examples: ['3', '1'].),\n]\n# Table: paperdataset\n[\n  (paperid:bigint, Unique identifier for each paper in the dataset. Value examples: ['1', '2', '3'].),\n  (datasetid:bigint, Unique identifier for each dataset that the paper belongs to. Value examples: ['2', '3', '4'].),\n]\n# Table: paperfield\n[\n  (fieldid:bigint, Unique identifier for each field in the table. Value examples: ['1', '2', '3'].),\n  (paperid:bigint, Unique identifier for each paper in the table. Value examples: ['1', '2', '3'].),\n]\n# Table: paperkeyphrase\n[\n  (paperid:bigint, The ID of the paper associated with the keyphrase.. Value examples: ['1', '2', '3', '3'].),\n  (keyphraseid:bigint, The ID of the keyphrase associated with the paper.. Value examples: ['1', '2', '3', '5'].),\n]\n# Table: venue\n[\n  (venueid:bigint, Unique identifier for each venue. Value examples: ['1', '2', '3'].),\n  (venuename:text, Name of the venue. Value examples: ['Conference on Machine Learning', 'International Journal of Climate Change', 'Social Media Analysis Workshop'].),\n]\n# Table: writes\n[\n  (paperid:bigint, The unique identifier for a paper in the writes table.. Value examples: ['1', '2', '3', '4'].),\n  (authorid:bigint, The unique identifier for an author in the writes table.. Value examples: ['1', '2', '3', '4'].),\n]\n\n【Foreign keys】\nauthor.authorid = writes.authorid\ncite.citingpaperid = paper.paperid\ncite.citingpaperid = paperdataset.paperid\ncite.citingpaperid = paperfield.paperid\ncite.citingpaperid = paperkeyphrase.paperid\ncite.citingpaperid = writes.paperid\ndataset.datasetid = paperdataset.datasetid\nfield.fieldid = paperfield.fieldid\njournal.journalid = paper.journalid\nkeyphrase.keyphraseid = paperkeyphrase.keyphraseid\npaper.paperid = paperdataset.paperid\npaper.paperid = paperfield.paperid\npaper.paperid = paperkeyphrase.paperid\npaper.paperid = writes.paperid\npaper.venueid = venue.venueid\npaperfield.paperid = paperkeyphrase.paperid\npaperfield.paperid = writes.paperid\npaperkeyphrase.paperid = writes.paperid\n\n【参考信息】\nFilter paper names using exact matches. Filter keyphrases and journal names with case-insensitive matching.\n\n【用户问题】\nHow many authors wrote papers that were published in the journal \"Science\" in the year 2020?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT COUNT(DISTINCT writes.authorid) AS number_of_authors FROM writes JOIN paper ON writes.paperid = paper.paperid JOIN journal ON paper.journalid = journal.journalid WHERE journal.journalname ILIKE '%Science%' AND paper.year = 2020;",
        "role": "assistant"
      }
    ],
    "db_name": "scholar",
    "id": 169,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many reviews were written for businesses located in California in the last 1000 months?\n\n【数据库schema】\n【DB_ID】 yelp\n【Schema】\n# Table: business\n[\n  (bid:bigint, The unique identifier for the business. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (name:text, The name of the business. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Joe’s Pizza', 'Peter’s Cafe', 'Anna’s Diner'].),\n  (full_address:text, The full address of the business. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (city:text, The city where the business is located. Value examples: ['San Francisco', 'New York', 'Los Angeles'].),\n  (latitude:text, The latitude of the business location. Value examples: ['37.7749295', '40.712776', '34.052235'].),\n  (longitude:text, The longitude of the business location. Value examples: ['-122.4194155', '-74.005974', '-118.243683'].),\n  (review_count:bigint, The number of reviews for the business. Value examples: ['2', '3', '4'].),\n  (is_open:bigint, Indicates whether the business is currently open or closed (1 for open, 0 for closed). Value examples: ['0', '1', '0'].),\n  (state:text, The US state where the business is located, represented by two-letter abbreviations (eg. 'CA', 'NV', 'NY', etc.). Value examples: ['CA', 'NY', 'CA'].),\n]\n# Table: category\n[\n  (id:bigint, Unique identifier for each category. Value examples: ['1', '2'].),\n  (business_id:text, Identifier for the business associated with the category. Value examples: ['abc123', 'def456'].),\n  (category_name:text, Name of the category. Eg 'Bistro', 'Diner', 'Pizza'. Value examples: ['Pizza', 'Cafe'].),\n]\n# Table: checkin\n[\n  (cid:bigint, Unique identifier for the daily check-in count. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the check-in occurred. Value examples: ['abc123', 'def456'].),\n  (count:bigint, Number of check-ins on the given day. Value examples: ['10', '20'].),\n  (day:text, Day of the week when the check-ins occurred. Eg. 'Monday', 'Tuesday', etc.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: neighbourhood\n[\n  (id:bigint, Unique identifier for each neighbourhood. Value examples: ['1', '2', '3'].),\n  (business_id:text, Identifier for each business in the neighbourhood. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (neighbourhood_name:text, Name of the neighbourhood where the business is located. Value examples: ['Downtown', 'Midtown', 'Hollywood'].),\n]\n# Table: review\n[\n  (rid:bigint, The unique identifier for each review.. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business being reviewed.. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (user_id:text, The unique identifier for the user who posted the review.. Value examples: ['1', '2', '3'].),\n  (rating:real, The rating given by the user for the business, on a scale of 1 to 5.. Value examples: ['4.5', '4.2', '3.9'].),\n  (text:text, The text of the review. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Great pizza!', 'Delicious food.', 'Average diner.'].),\n  (year:bigint, The year in which the review was posted.. Value examples: ['2021', '2021', '2021'].),\n  (month:text, The month in which the review was posted. Eg. 'January', 'February', etc.. Value examples: ['January', 'February', 'March'].),\n]\n# Table: tip\n[\n  (tip_id:bigint, Unique identifier for the tip. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the tip was created.. Value examples: ['abc123', 'def456'].),\n  (text:text, Text content of the tip. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Try their pepperoni pizza!', 'Their coffee is amazing.'].),\n  (user_id:text, Unique identifier for the user who created the tip. Value examples: ['1', '2'].),\n  (likes:bigint, Value examples: ['NULL', 'NULL'].),\n  (year:bigint, Year when the tip was created. Value examples: ['2021', '2021'].),\n  (month:text, Month when the tip was created. Eg. 'January', 'February', etc.. Value examples: ['January', 'February'].),\n]\n# Table: users\n[\n  (uid:bigint, Unique identifier for each user. Value examples: ['1', '2', '3', '4'].),\n  (user_id:text, Unique user ID assigned by the system. Value examples: ['1', '2', '3', '4'].),\n  (name:text, Name of the user. Value examples: ['John Doe', 'Jane Smith', 'David Johnson', 'Sarah Williams'].),\n]\n\n【Foreign keys】\nbusiness.business_id = tip.business_id\nbusiness.business_id = review.business_id\nbusiness.business_id = checkin.business_id\nbusiness.business_id = neighbourhood.business_id\nbusiness.business_id = category.business_id\ntip.user_id = users.user_id\nreview.user_id = users.user_id\n\n【参考信息】\n\n\n【用户问题】\nHow many reviews were written for businesses located in California in the last 1000 months?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT count(*) AS review_count FROM review r JOIN business b ON r.business_id = b.business_id WHERE b.state = 'CA' AND (r.year * 12 + extract(MONTH FROM to_date(r.month, 'Month'))) >= (extract(YEAR FROM CURRENT_DATE) * 12 + extract(MONTH FROM CURRENT_DATE) - 1000) ;",
        "role": "assistant"
      }
    ],
    "db_name": "yelp",
    "id": 170,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the total number of check-ins on the 2 days before Saturday?\n\n【数据库schema】\n【DB_ID】 yelp\n【Schema】\n# Table: business\n[\n  (bid:bigint, The unique identifier for the business. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (name:text, The name of the business. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Joe’s Pizza', 'Peter’s Cafe', 'Anna’s Diner'].),\n  (full_address:text, The full address of the business. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (city:text, The city where the business is located. Value examples: ['San Francisco', 'New York', 'Los Angeles'].),\n  (latitude:text, The latitude of the business location. Value examples: ['37.7749295', '40.712776', '34.052235'].),\n  (longitude:text, The longitude of the business location. Value examples: ['-122.4194155', '-74.005974', '-118.243683'].),\n  (review_count:bigint, The number of reviews for the business. Value examples: ['2', '3', '4'].),\n  (is_open:bigint, Indicates whether the business is currently open or closed (1 for open, 0 for closed). Value examples: ['0', '1', '0'].),\n  (state:text, The US state where the business is located, represented by two-letter abbreviations (eg. 'CA', 'NV', 'NY', etc.). Value examples: ['CA', 'NY', 'CA'].),\n]\n# Table: category\n[\n  (id:bigint, Unique identifier for each category. Value examples: ['1', '2'].),\n  (business_id:text, Identifier for the business associated with the category. Value examples: ['abc123', 'def456'].),\n  (category_name:text, Name of the category. Eg 'Bistro', 'Diner', 'Pizza'. Value examples: ['Pizza', 'Cafe'].),\n]\n# Table: checkin\n[\n  (cid:bigint, Unique identifier for the daily check-in count. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the check-in occurred. Value examples: ['abc123', 'def456'].),\n  (count:bigint, Number of check-ins on the given day. Value examples: ['10', '20'].),\n  (day:text, Day of the week when the check-ins occurred. Eg. 'Monday', 'Tuesday', etc.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: neighbourhood\n[\n  (id:bigint, Unique identifier for each neighbourhood. Value examples: ['1', '2', '3'].),\n  (business_id:text, Identifier for each business in the neighbourhood. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (neighbourhood_name:text, Name of the neighbourhood where the business is located. Value examples: ['Downtown', 'Midtown', 'Hollywood'].),\n]\n# Table: review\n[\n  (rid:bigint, The unique identifier for each review.. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business being reviewed.. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (user_id:text, The unique identifier for the user who posted the review.. Value examples: ['1', '2', '3'].),\n  (rating:real, The rating given by the user for the business, on a scale of 1 to 5.. Value examples: ['4.5', '4.2', '3.9'].),\n  (text:text, The text of the review. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Great pizza!', 'Delicious food.', 'Average diner.'].),\n  (year:bigint, The year in which the review was posted.. Value examples: ['2021', '2021', '2021'].),\n  (month:text, The month in which the review was posted. Eg. 'January', 'February', etc.. Value examples: ['January', 'February', 'March'].),\n]\n# Table: tip\n[\n  (tip_id:bigint, Unique identifier for the tip. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the tip was created.. Value examples: ['abc123', 'def456'].),\n  (text:text, Text content of the tip. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Try their pepperoni pizza!', 'Their coffee is amazing.'].),\n  (user_id:text, Unique identifier for the user who created the tip. Value examples: ['1', '2'].),\n  (likes:bigint, Value examples: ['NULL', 'NULL'].),\n  (year:bigint, Year when the tip was created. Value examples: ['2021', '2021'].),\n  (month:text, Month when the tip was created. Eg. 'January', 'February', etc.. Value examples: ['January', 'February'].),\n]\n# Table: users\n[\n  (uid:bigint, Unique identifier for each user. Value examples: ['1', '2', '3', '4'].),\n  (user_id:text, Unique user ID assigned by the system. Value examples: ['1', '2', '3', '4'].),\n  (name:text, Name of the user. Value examples: ['John Doe', 'Jane Smith', 'David Johnson', 'Sarah Williams'].),\n]\n\n【Foreign keys】\nbusiness.business_id = tip.business_id\nbusiness.business_id = review.business_id\nbusiness.business_id = checkin.business_id\nbusiness.business_id = neighbourhood.business_id\nbusiness.business_id = category.business_id\ntip.user_id = users.user_id\nreview.user_id = users.user_id\n\n【参考信息】\n\n\n【用户问题】\nWhat is the total number of check-ins on the 2 days before Saturday?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT sum(COUNT) AS total_checkins FROM checkin WHERE DAY IN ('Thursday', 'Friday') ;",
        "role": "assistant"
      }
    ],
    "db_name": "yelp",
    "id": 171,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many reviews were there 2 months before the review with id 3?\n\n【数据库schema】\n【DB_ID】 yelp\n【Schema】\n# Table: business\n[\n  (bid:bigint, The unique identifier for the business. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (name:text, The name of the business. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Joe’s Pizza', 'Peter’s Cafe', 'Anna’s Diner'].),\n  (full_address:text, The full address of the business. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (city:text, The city where the business is located. Value examples: ['San Francisco', 'New York', 'Los Angeles'].),\n  (latitude:text, The latitude of the business location. Value examples: ['37.7749295', '40.712776', '34.052235'].),\n  (longitude:text, The longitude of the business location. Value examples: ['-122.4194155', '-74.005974', '-118.243683'].),\n  (review_count:bigint, The number of reviews for the business. Value examples: ['2', '3', '4'].),\n  (is_open:bigint, Indicates whether the business is currently open or closed (1 for open, 0 for closed). Value examples: ['0', '1', '0'].),\n  (state:text, The US state where the business is located, represented by two-letter abbreviations (eg. 'CA', 'NV', 'NY', etc.). Value examples: ['CA', 'NY', 'CA'].),\n]\n# Table: category\n[\n  (id:bigint, Unique identifier for each category. Value examples: ['1', '2'].),\n  (business_id:text, Identifier for the business associated with the category. Value examples: ['abc123', 'def456'].),\n  (category_name:text, Name of the category. Eg 'Bistro', 'Diner', 'Pizza'. Value examples: ['Pizza', 'Cafe'].),\n]\n# Table: checkin\n[\n  (cid:bigint, Unique identifier for the daily check-in count. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the check-in occurred. Value examples: ['abc123', 'def456'].),\n  (count:bigint, Number of check-ins on the given day. Value examples: ['10', '20'].),\n  (day:text, Day of the week when the check-ins occurred. Eg. 'Monday', 'Tuesday', etc.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: neighbourhood\n[\n  (id:bigint, Unique identifier for each neighbourhood. Value examples: ['1', '2', '3'].),\n  (business_id:text, Identifier for each business in the neighbourhood. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (neighbourhood_name:text, Name of the neighbourhood where the business is located. Value examples: ['Downtown', 'Midtown', 'Hollywood'].),\n]\n# Table: review\n[\n  (rid:bigint, The unique identifier for each review.. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business being reviewed.. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (user_id:text, The unique identifier for the user who posted the review.. Value examples: ['1', '2', '3'].),\n  (rating:real, The rating given by the user for the business, on a scale of 1 to 5.. Value examples: ['4.5', '4.2', '3.9'].),\n  (text:text, The text of the review. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Great pizza!', 'Delicious food.', 'Average diner.'].),\n  (year:bigint, The year in which the review was posted.. Value examples: ['2021', '2021', '2021'].),\n  (month:text, The month in which the review was posted. Eg. 'January', 'February', etc.. Value examples: ['January', 'February', 'March'].),\n]\n# Table: tip\n[\n  (tip_id:bigint, Unique identifier for the tip. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the tip was created.. Value examples: ['abc123', 'def456'].),\n  (text:text, Text content of the tip. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Try their pepperoni pizza!', 'Their coffee is amazing.'].),\n  (user_id:text, Unique identifier for the user who created the tip. Value examples: ['1', '2'].),\n  (likes:bigint, Value examples: ['NULL', 'NULL'].),\n  (year:bigint, Year when the tip was created. Value examples: ['2021', '2021'].),\n  (month:text, Month when the tip was created. Eg. 'January', 'February', etc.. Value examples: ['January', 'February'].),\n]\n# Table: users\n[\n  (uid:bigint, Unique identifier for each user. Value examples: ['1', '2', '3', '4'].),\n  (user_id:text, Unique user ID assigned by the system. Value examples: ['1', '2', '3', '4'].),\n  (name:text, Name of the user. Value examples: ['John Doe', 'Jane Smith', 'David Johnson', 'Sarah Williams'].),\n]\n\n【Foreign keys】\nbusiness.business_id = tip.business_id\nbusiness.business_id = review.business_id\nbusiness.business_id = checkin.business_id\nbusiness.business_id = neighbourhood.business_id\nbusiness.business_id = category.business_id\ntip.user_id = users.user_id\nreview.user_id = users.user_id\n\n【参考信息】\n\n\n【用户问题】\nHow many reviews were there 2 months before the review with id 3?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT count(*) AS review_count FROM review WHERE (cast(review.year AS text) || '-' || review.month || '-01')::date = (SELECT (cast(r.year AS text) || '-' || r.month || '-01')::date - interval '2 months' FROM review r WHERE r.rid = 3) ;",
        "role": "assistant"
      }
    ],
    "db_name": "yelp",
    "id": 172,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat was the message that came with the tip made exactly 2 months after March 2021?\n\n【数据库schema】\n【DB_ID】 yelp\n【Schema】\n# Table: business\n[\n  (bid:bigint, The unique identifier for the business. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (name:text, The name of the business. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Joe’s Pizza', 'Peter’s Cafe', 'Anna’s Diner'].),\n  (full_address:text, The full address of the business. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (city:text, The city where the business is located. Value examples: ['San Francisco', 'New York', 'Los Angeles'].),\n  (latitude:text, The latitude of the business location. Value examples: ['37.7749295', '40.712776', '34.052235'].),\n  (longitude:text, The longitude of the business location. Value examples: ['-122.4194155', '-74.005974', '-118.243683'].),\n  (review_count:bigint, The number of reviews for the business. Value examples: ['2', '3', '4'].),\n  (is_open:bigint, Indicates whether the business is currently open or closed (1 for open, 0 for closed). Value examples: ['0', '1', '0'].),\n  (state:text, The US state where the business is located, represented by two-letter abbreviations (eg. 'CA', 'NV', 'NY', etc.). Value examples: ['CA', 'NY', 'CA'].),\n]\n# Table: category\n[\n  (id:bigint, Unique identifier for each category. Value examples: ['1', '2'].),\n  (business_id:text, Identifier for the business associated with the category. Value examples: ['abc123', 'def456'].),\n  (category_name:text, Name of the category. Eg 'Bistro', 'Diner', 'Pizza'. Value examples: ['Pizza', 'Cafe'].),\n]\n# Table: checkin\n[\n  (cid:bigint, Unique identifier for the daily check-in count. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the check-in occurred. Value examples: ['abc123', 'def456'].),\n  (count:bigint, Number of check-ins on the given day. Value examples: ['10', '20'].),\n  (day:text, Day of the week when the check-ins occurred. Eg. 'Monday', 'Tuesday', etc.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: neighbourhood\n[\n  (id:bigint, Unique identifier for each neighbourhood. Value examples: ['1', '2', '3'].),\n  (business_id:text, Identifier for each business in the neighbourhood. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (neighbourhood_name:text, Name of the neighbourhood where the business is located. Value examples: ['Downtown', 'Midtown', 'Hollywood'].),\n]\n# Table: review\n[\n  (rid:bigint, The unique identifier for each review.. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business being reviewed.. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (user_id:text, The unique identifier for the user who posted the review.. Value examples: ['1', '2', '3'].),\n  (rating:real, The rating given by the user for the business, on a scale of 1 to 5.. Value examples: ['4.5', '4.2', '3.9'].),\n  (text:text, The text of the review. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Great pizza!', 'Delicious food.', 'Average diner.'].),\n  (year:bigint, The year in which the review was posted.. Value examples: ['2021', '2021', '2021'].),\n  (month:text, The month in which the review was posted. Eg. 'January', 'February', etc.. Value examples: ['January', 'February', 'March'].),\n]\n# Table: tip\n[\n  (tip_id:bigint, Unique identifier for the tip. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the tip was created.. Value examples: ['abc123', 'def456'].),\n  (text:text, Text content of the tip. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Try their pepperoni pizza!', 'Their coffee is amazing.'].),\n  (user_id:text, Unique identifier for the user who created the tip. Value examples: ['1', '2'].),\n  (likes:bigint, Value examples: ['NULL', 'NULL'].),\n  (year:bigint, Year when the tip was created. Value examples: ['2021', '2021'].),\n  (month:text, Month when the tip was created. Eg. 'January', 'February', etc.. Value examples: ['January', 'February'].),\n]\n# Table: users\n[\n  (uid:bigint, Unique identifier for each user. Value examples: ['1', '2', '3', '4'].),\n  (user_id:text, Unique user ID assigned by the system. Value examples: ['1', '2', '3', '4'].),\n  (name:text, Name of the user. Value examples: ['John Doe', 'Jane Smith', 'David Johnson', 'Sarah Williams'].),\n]\n\n【Foreign keys】\nbusiness.business_id = tip.business_id\nbusiness.business_id = review.business_id\nbusiness.business_id = checkin.business_id\nbusiness.business_id = neighbourhood.business_id\nbusiness.business_id = category.business_id\ntip.user_id = users.user_id\nreview.user_id = users.user_id\n\n【参考信息】\n\n\n【用户问题】\nWhat was the message that came with the tip made exactly 2 months after March 2021?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT text AS message FROM tip WHERE MONTH ILIKE '%May%' AND YEAR = 2021 LIMIT 1;",
        "role": "assistant"
      }
    ],
    "db_name": "yelp",
    "id": 173,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many months between June 2021 and December 2021 had reviews?\n\n【数据库schema】\n【DB_ID】 yelp\n【Schema】\n# Table: business\n[\n  (bid:bigint, The unique identifier for the business. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (name:text, The name of the business. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Joe’s Pizza', 'Peter’s Cafe', 'Anna’s Diner'].),\n  (full_address:text, The full address of the business. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (city:text, The city where the business is located. Value examples: ['San Francisco', 'New York', 'Los Angeles'].),\n  (latitude:text, The latitude of the business location. Value examples: ['37.7749295', '40.712776', '34.052235'].),\n  (longitude:text, The longitude of the business location. Value examples: ['-122.4194155', '-74.005974', '-118.243683'].),\n  (review_count:bigint, The number of reviews for the business. Value examples: ['2', '3', '4'].),\n  (is_open:bigint, Indicates whether the business is currently open or closed (1 for open, 0 for closed). Value examples: ['0', '1', '0'].),\n  (state:text, The US state where the business is located, represented by two-letter abbreviations (eg. 'CA', 'NV', 'NY', etc.). Value examples: ['CA', 'NY', 'CA'].),\n]\n# Table: category\n[\n  (id:bigint, Unique identifier for each category. Value examples: ['1', '2'].),\n  (business_id:text, Identifier for the business associated with the category. Value examples: ['abc123', 'def456'].),\n  (category_name:text, Name of the category. Eg 'Bistro', 'Diner', 'Pizza'. Value examples: ['Pizza', 'Cafe'].),\n]\n# Table: checkin\n[\n  (cid:bigint, Unique identifier for the daily check-in count. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the check-in occurred. Value examples: ['abc123', 'def456'].),\n  (count:bigint, Number of check-ins on the given day. Value examples: ['10', '20'].),\n  (day:text, Day of the week when the check-ins occurred. Eg. 'Monday', 'Tuesday', etc.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: neighbourhood\n[\n  (id:bigint, Unique identifier for each neighbourhood. Value examples: ['1', '2', '3'].),\n  (business_id:text, Identifier for each business in the neighbourhood. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (neighbourhood_name:text, Name of the neighbourhood where the business is located. Value examples: ['Downtown', 'Midtown', 'Hollywood'].),\n]\n# Table: review\n[\n  (rid:bigint, The unique identifier for each review.. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business being reviewed.. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (user_id:text, The unique identifier for the user who posted the review.. Value examples: ['1', '2', '3'].),\n  (rating:real, The rating given by the user for the business, on a scale of 1 to 5.. Value examples: ['4.5', '4.2', '3.9'].),\n  (text:text, The text of the review. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Great pizza!', 'Delicious food.', 'Average diner.'].),\n  (year:bigint, The year in which the review was posted.. Value examples: ['2021', '2021', '2021'].),\n  (month:text, The month in which the review was posted. Eg. 'January', 'February', etc.. Value examples: ['January', 'February', 'March'].),\n]\n# Table: tip\n[\n  (tip_id:bigint, Unique identifier for the tip. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the tip was created.. Value examples: ['abc123', 'def456'].),\n  (text:text, Text content of the tip. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Try their pepperoni pizza!', 'Their coffee is amazing.'].),\n  (user_id:text, Unique identifier for the user who created the tip. Value examples: ['1', '2'].),\n  (likes:bigint, Value examples: ['NULL', 'NULL'].),\n  (year:bigint, Year when the tip was created. Value examples: ['2021', '2021'].),\n  (month:text, Month when the tip was created. Eg. 'January', 'February', etc.. Value examples: ['January', 'February'].),\n]\n# Table: users\n[\n  (uid:bigint, Unique identifier for each user. Value examples: ['1', '2', '3', '4'].),\n  (user_id:text, Unique user ID assigned by the system. Value examples: ['1', '2', '3', '4'].),\n  (name:text, Name of the user. Value examples: ['John Doe', 'Jane Smith', 'David Johnson', 'Sarah Williams'].),\n]\n\n【Foreign keys】\nbusiness.business_id = tip.business_id\nbusiness.business_id = review.business_id\nbusiness.business_id = checkin.business_id\nbusiness.business_id = neighbourhood.business_id\nbusiness.business_id = category.business_id\ntip.user_id = users.user_id\nreview.user_id = users.user_id\n\n【参考信息】\n\n\n【用户问题】\nHow many months between June 2021 and December 2021 had reviews?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT COUNT(DISTINCT MONTH) AS num_months FROM review WHERE YEAR = 2021 AND CASE MONTH WHEN 'January' THEN 1 WHEN 'February' THEN 2 WHEN 'March' THEN 3 WHEN 'April' THEN 4 WHEN 'May' THEN 5 WHEN 'June' THEN 6 WHEN 'July' THEN 7 WHEN 'August' THEN 8 WHEN 'September' THEN 9 WHEN 'October' THEN 10 WHEN 'November' THEN 11 WHEN 'December' THEN 12 END BETWEEN 6 AND 12;",
        "role": "assistant"
      }
    ],
    "db_name": "yelp",
    "id": 174,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich neighbourhoods have the highest number of businesses, and how many businesses are located in each neighbourhood?\n\n【数据库schema】\n【DB_ID】 yelp\n【Schema】\n# Table: business\n[\n  (bid:bigint, The unique identifier for the business. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (name:text, The name of the business. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Joe’s Pizza', 'Peter’s Cafe', 'Anna’s Diner'].),\n  (full_address:text, The full address of the business. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (city:text, The city where the business is located. Value examples: ['San Francisco', 'New York', 'Los Angeles'].),\n  (latitude:text, The latitude of the business location. Value examples: ['37.7749295', '40.712776', '34.052235'].),\n  (longitude:text, The longitude of the business location. Value examples: ['-122.4194155', '-74.005974', '-118.243683'].),\n  (review_count:bigint, The number of reviews for the business. Value examples: ['2', '3', '4'].),\n  (is_open:bigint, Indicates whether the business is currently open or closed (1 for open, 0 for closed). Value examples: ['0', '1', '0'].),\n  (state:text, The US state where the business is located, represented by two-letter abbreviations (eg. 'CA', 'NV', 'NY', etc.). Value examples: ['CA', 'NY', 'CA'].),\n]\n# Table: category\n[\n  (id:bigint, Unique identifier for each category. Value examples: ['1', '2'].),\n  (business_id:text, Identifier for the business associated with the category. Value examples: ['abc123', 'def456'].),\n  (category_name:text, Name of the category. Eg 'Bistro', 'Diner', 'Pizza'. Value examples: ['Pizza', 'Cafe'].),\n]\n# Table: checkin\n[\n  (cid:bigint, Unique identifier for the daily check-in count. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the check-in occurred. Value examples: ['abc123', 'def456'].),\n  (count:bigint, Number of check-ins on the given day. Value examples: ['10', '20'].),\n  (day:text, Day of the week when the check-ins occurred. Eg. 'Monday', 'Tuesday', etc.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: neighbourhood\n[\n  (id:bigint, Unique identifier for each neighbourhood. Value examples: ['1', '2', '3'].),\n  (business_id:text, Identifier for each business in the neighbourhood. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (neighbourhood_name:text, Name of the neighbourhood where the business is located. Value examples: ['Downtown', 'Midtown', 'Hollywood'].),\n]\n# Table: review\n[\n  (rid:bigint, The unique identifier for each review.. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business being reviewed.. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (user_id:text, The unique identifier for the user who posted the review.. Value examples: ['1', '2', '3'].),\n  (rating:real, The rating given by the user for the business, on a scale of 1 to 5.. Value examples: ['4.5', '4.2', '3.9'].),\n  (text:text, The text of the review. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Great pizza!', 'Delicious food.', 'Average diner.'].),\n  (year:bigint, The year in which the review was posted.. Value examples: ['2021', '2021', '2021'].),\n  (month:text, The month in which the review was posted. Eg. 'January', 'February', etc.. Value examples: ['January', 'February', 'March'].),\n]\n# Table: tip\n[\n  (tip_id:bigint, Unique identifier for the tip. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the tip was created.. Value examples: ['abc123', 'def456'].),\n  (text:text, Text content of the tip. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Try their pepperoni pizza!', 'Their coffee is amazing.'].),\n  (user_id:text, Unique identifier for the user who created the tip. Value examples: ['1', '2'].),\n  (likes:bigint, Value examples: ['NULL', 'NULL'].),\n  (year:bigint, Year when the tip was created. Value examples: ['2021', '2021'].),\n  (month:text, Month when the tip was created. Eg. 'January', 'February', etc.. Value examples: ['January', 'February'].),\n]\n# Table: users\n[\n  (uid:bigint, Unique identifier for each user. Value examples: ['1', '2', '3', '4'].),\n  (user_id:text, Unique user ID assigned by the system. Value examples: ['1', '2', '3', '4'].),\n  (name:text, Name of the user. Value examples: ['John Doe', 'Jane Smith', 'David Johnson', 'Sarah Williams'].),\n]\n\n【Foreign keys】\nbusiness.business_id = tip.business_id\nbusiness.business_id = review.business_id\nbusiness.business_id = checkin.business_id\nbusiness.business_id = neighbourhood.business_id\nbusiness.business_id = category.business_id\ntip.user_id = users.user_id\nreview.user_id = users.user_id\n\n【参考信息】\n\n\n【用户问题】\nWhich neighbourhoods have the highest number of businesses, and how many businesses are located in each neighbourhood?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT neighbourhood.neighbourhood_name, neighbourhood.id, COUNT(DISTINCT neighbourhood.business_id) AS business_count FROM neighbourhood GROUP BY neighbourhood.neighbourhood_name, neighbourhood.id ORDER BY business_count DESC NULLS LAST",
        "role": "assistant"
      }
    ],
    "db_name": "yelp",
    "id": 175,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the total number of check-ins for each day of the week for the business with ID \"abc123\"?\n\n【数据库schema】\n【DB_ID】 yelp\n【Schema】\n# Table: business\n[\n  (bid:bigint, The unique identifier for the business. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (name:text, The name of the business. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Joe’s Pizza', 'Peter’s Cafe', 'Anna’s Diner'].),\n  (full_address:text, The full address of the business. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (city:text, The city where the business is located. Value examples: ['San Francisco', 'New York', 'Los Angeles'].),\n  (latitude:text, The latitude of the business location. Value examples: ['37.7749295', '40.712776', '34.052235'].),\n  (longitude:text, The longitude of the business location. Value examples: ['-122.4194155', '-74.005974', '-118.243683'].),\n  (review_count:bigint, The number of reviews for the business. Value examples: ['2', '3', '4'].),\n  (is_open:bigint, Indicates whether the business is currently open or closed (1 for open, 0 for closed). Value examples: ['0', '1', '0'].),\n  (state:text, The US state where the business is located, represented by two-letter abbreviations (eg. 'CA', 'NV', 'NY', etc.). Value examples: ['CA', 'NY', 'CA'].),\n]\n# Table: category\n[\n  (id:bigint, Unique identifier for each category. Value examples: ['1', '2'].),\n  (business_id:text, Identifier for the business associated with the category. Value examples: ['abc123', 'def456'].),\n  (category_name:text, Name of the category. Eg 'Bistro', 'Diner', 'Pizza'. Value examples: ['Pizza', 'Cafe'].),\n]\n# Table: checkin\n[\n  (cid:bigint, Unique identifier for the daily check-in count. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the check-in occurred. Value examples: ['abc123', 'def456'].),\n  (count:bigint, Number of check-ins on the given day. Value examples: ['10', '20'].),\n  (day:text, Day of the week when the check-ins occurred. Eg. 'Monday', 'Tuesday', etc.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: neighbourhood\n[\n  (id:bigint, Unique identifier for each neighbourhood. Value examples: ['1', '2', '3'].),\n  (business_id:text, Identifier for each business in the neighbourhood. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (neighbourhood_name:text, Name of the neighbourhood where the business is located. Value examples: ['Downtown', 'Midtown', 'Hollywood'].),\n]\n# Table: review\n[\n  (rid:bigint, The unique identifier for each review.. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business being reviewed.. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (user_id:text, The unique identifier for the user who posted the review.. Value examples: ['1', '2', '3'].),\n  (rating:real, The rating given by the user for the business, on a scale of 1 to 5.. Value examples: ['4.5', '4.2', '3.9'].),\n  (text:text, The text of the review. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Great pizza!', 'Delicious food.', 'Average diner.'].),\n  (year:bigint, The year in which the review was posted.. Value examples: ['2021', '2021', '2021'].),\n  (month:text, The month in which the review was posted. Eg. 'January', 'February', etc.. Value examples: ['January', 'February', 'March'].),\n]\n# Table: tip\n[\n  (tip_id:bigint, Unique identifier for the tip. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the tip was created.. Value examples: ['abc123', 'def456'].),\n  (text:text, Text content of the tip. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Try their pepperoni pizza!', 'Their coffee is amazing.'].),\n  (user_id:text, Unique identifier for the user who created the tip. Value examples: ['1', '2'].),\n  (likes:bigint, Value examples: ['NULL', 'NULL'].),\n  (year:bigint, Year when the tip was created. Value examples: ['2021', '2021'].),\n  (month:text, Month when the tip was created. Eg. 'January', 'February', etc.. Value examples: ['January', 'February'].),\n]\n# Table: users\n[\n  (uid:bigint, Unique identifier for each user. Value examples: ['1', '2', '3', '4'].),\n  (user_id:text, Unique user ID assigned by the system. Value examples: ['1', '2', '3', '4'].),\n  (name:text, Name of the user. Value examples: ['John Doe', 'Jane Smith', 'David Johnson', 'Sarah Williams'].),\n]\n\n【Foreign keys】\nbusiness.business_id = tip.business_id\nbusiness.business_id = review.business_id\nbusiness.business_id = checkin.business_id\nbusiness.business_id = neighbourhood.business_id\nbusiness.business_id = category.business_id\ntip.user_id = users.user_id\nreview.user_id = users.user_id\n\n【参考信息】\n\n\n【用户问题】\nWhat is the total number of check-ins for each day of the week for the business with ID \"abc123\"?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT checkin.day, SUM(checkin.count) AS total_checkins FROM checkin WHERE checkin.business_id = 'abc123' GROUP BY checkin.day ORDER BY total_checkins DESC NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "yelp",
    "id": 176,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the total count of check-ins for each business id?\n\n【数据库schema】\n【DB_ID】 yelp\n【Schema】\n# Table: business\n[\n  (bid:bigint, The unique identifier for the business. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (name:text, The name of the business. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Joe’s Pizza', 'Peter’s Cafe', 'Anna’s Diner'].),\n  (full_address:text, The full address of the business. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (city:text, The city where the business is located. Value examples: ['San Francisco', 'New York', 'Los Angeles'].),\n  (latitude:text, The latitude of the business location. Value examples: ['37.7749295', '40.712776', '34.052235'].),\n  (longitude:text, The longitude of the business location. Value examples: ['-122.4194155', '-74.005974', '-118.243683'].),\n  (review_count:bigint, The number of reviews for the business. Value examples: ['2', '3', '4'].),\n  (is_open:bigint, Indicates whether the business is currently open or closed (1 for open, 0 for closed). Value examples: ['0', '1', '0'].),\n  (state:text, The US state where the business is located, represented by two-letter abbreviations (eg. 'CA', 'NV', 'NY', etc.). Value examples: ['CA', 'NY', 'CA'].),\n]\n# Table: category\n[\n  (id:bigint, Unique identifier for each category. Value examples: ['1', '2'].),\n  (business_id:text, Identifier for the business associated with the category. Value examples: ['abc123', 'def456'].),\n  (category_name:text, Name of the category. Eg 'Bistro', 'Diner', 'Pizza'. Value examples: ['Pizza', 'Cafe'].),\n]\n# Table: checkin\n[\n  (cid:bigint, Unique identifier for the daily check-in count. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the check-in occurred. Value examples: ['abc123', 'def456'].),\n  (count:bigint, Number of check-ins on the given day. Value examples: ['10', '20'].),\n  (day:text, Day of the week when the check-ins occurred. Eg. 'Monday', 'Tuesday', etc.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: neighbourhood\n[\n  (id:bigint, Unique identifier for each neighbourhood. Value examples: ['1', '2', '3'].),\n  (business_id:text, Identifier for each business in the neighbourhood. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (neighbourhood_name:text, Name of the neighbourhood where the business is located. Value examples: ['Downtown', 'Midtown', 'Hollywood'].),\n]\n# Table: review\n[\n  (rid:bigint, The unique identifier for each review.. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business being reviewed.. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (user_id:text, The unique identifier for the user who posted the review.. Value examples: ['1', '2', '3'].),\n  (rating:real, The rating given by the user for the business, on a scale of 1 to 5.. Value examples: ['4.5', '4.2', '3.9'].),\n  (text:text, The text of the review. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Great pizza!', 'Delicious food.', 'Average diner.'].),\n  (year:bigint, The year in which the review was posted.. Value examples: ['2021', '2021', '2021'].),\n  (month:text, The month in which the review was posted. Eg. 'January', 'February', etc.. Value examples: ['January', 'February', 'March'].),\n]\n# Table: tip\n[\n  (tip_id:bigint, Unique identifier for the tip. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the tip was created.. Value examples: ['abc123', 'def456'].),\n  (text:text, Text content of the tip. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Try their pepperoni pizza!', 'Their coffee is amazing.'].),\n  (user_id:text, Unique identifier for the user who created the tip. Value examples: ['1', '2'].),\n  (likes:bigint, Value examples: ['NULL', 'NULL'].),\n  (year:bigint, Year when the tip was created. Value examples: ['2021', '2021'].),\n  (month:text, Month when the tip was created. Eg. 'January', 'February', etc.. Value examples: ['January', 'February'].),\n]\n# Table: users\n[\n  (uid:bigint, Unique identifier for each user. Value examples: ['1', '2', '3', '4'].),\n  (user_id:text, Unique user ID assigned by the system. Value examples: ['1', '2', '3', '4'].),\n  (name:text, Name of the user. Value examples: ['John Doe', 'Jane Smith', 'David Johnson', 'Sarah Williams'].),\n]\n\n【Foreign keys】\nbusiness.business_id = tip.business_id\nbusiness.business_id = review.business_id\nbusiness.business_id = checkin.business_id\nbusiness.business_id = neighbourhood.business_id\nbusiness.business_id = category.business_id\ntip.user_id = users.user_id\nreview.user_id = users.user_id\n\n【参考信息】\n\n\n【用户问题】\nWhat is the total count of check-ins for each business id?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT checkin.business_id, SUM(checkin.count) AS total_checkins FROM checkin GROUP BY checkin.business_id ORDER BY total_checkins DESC NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "yelp",
    "id": 177,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nReturn the name and average rating for each business in new york\n\n【数据库schema】\n【DB_ID】 yelp\n【Schema】\n# Table: business\n[\n  (bid:bigint, The unique identifier for the business. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (name:text, The name of the business. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Joe’s Pizza', 'Peter’s Cafe', 'Anna’s Diner'].),\n  (full_address:text, The full address of the business. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (city:text, The city where the business is located. Value examples: ['San Francisco', 'New York', 'Los Angeles'].),\n  (latitude:text, The latitude of the business location. Value examples: ['37.7749295', '40.712776', '34.052235'].),\n  (longitude:text, The longitude of the business location. Value examples: ['-122.4194155', '-74.005974', '-118.243683'].),\n  (review_count:bigint, The number of reviews for the business. Value examples: ['2', '3', '4'].),\n  (is_open:bigint, Indicates whether the business is currently open or closed (1 for open, 0 for closed). Value examples: ['0', '1', '0'].),\n  (state:text, The US state where the business is located, represented by two-letter abbreviations (eg. 'CA', 'NV', 'NY', etc.). Value examples: ['CA', 'NY', 'CA'].),\n]\n# Table: category\n[\n  (id:bigint, Unique identifier for each category. Value examples: ['1', '2'].),\n  (business_id:text, Identifier for the business associated with the category. Value examples: ['abc123', 'def456'].),\n  (category_name:text, Name of the category. Eg 'Bistro', 'Diner', 'Pizza'. Value examples: ['Pizza', 'Cafe'].),\n]\n# Table: checkin\n[\n  (cid:bigint, Unique identifier for the daily check-in count. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the check-in occurred. Value examples: ['abc123', 'def456'].),\n  (count:bigint, Number of check-ins on the given day. Value examples: ['10', '20'].),\n  (day:text, Day of the week when the check-ins occurred. Eg. 'Monday', 'Tuesday', etc.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: neighbourhood\n[\n  (id:bigint, Unique identifier for each neighbourhood. Value examples: ['1', '2', '3'].),\n  (business_id:text, Identifier for each business in the neighbourhood. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (neighbourhood_name:text, Name of the neighbourhood where the business is located. Value examples: ['Downtown', 'Midtown', 'Hollywood'].),\n]\n# Table: review\n[\n  (rid:bigint, The unique identifier for each review.. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business being reviewed.. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (user_id:text, The unique identifier for the user who posted the review.. Value examples: ['1', '2', '3'].),\n  (rating:real, The rating given by the user for the business, on a scale of 1 to 5.. Value examples: ['4.5', '4.2', '3.9'].),\n  (text:text, The text of the review. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Great pizza!', 'Delicious food.', 'Average diner.'].),\n  (year:bigint, The year in which the review was posted.. Value examples: ['2021', '2021', '2021'].),\n  (month:text, The month in which the review was posted. Eg. 'January', 'February', etc.. Value examples: ['January', 'February', 'March'].),\n]\n# Table: tip\n[\n  (tip_id:bigint, Unique identifier for the tip. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the tip was created.. Value examples: ['abc123', 'def456'].),\n  (text:text, Text content of the tip. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Try their pepperoni pizza!', 'Their coffee is amazing.'].),\n  (user_id:text, Unique identifier for the user who created the tip. Value examples: ['1', '2'].),\n  (likes:bigint, Value examples: ['NULL', 'NULL'].),\n  (year:bigint, Year when the tip was created. Value examples: ['2021', '2021'].),\n  (month:text, Month when the tip was created. Eg. 'January', 'February', etc.. Value examples: ['January', 'February'].),\n]\n# Table: users\n[\n  (uid:bigint, Unique identifier for each user. Value examples: ['1', '2', '3', '4'].),\n  (user_id:text, Unique user ID assigned by the system. Value examples: ['1', '2', '3', '4'].),\n  (name:text, Name of the user. Value examples: ['John Doe', 'Jane Smith', 'David Johnson', 'Sarah Williams'].),\n]\n\n【Foreign keys】\nbusiness.business_id = tip.business_id\nbusiness.business_id = review.business_id\nbusiness.business_id = checkin.business_id\nbusiness.business_id = neighbourhood.business_id\nbusiness.business_id = category.business_id\ntip.user_id = users.user_id\nreview.user_id = users.user_id\n\n【参考信息】\n\n\n【用户问题】\nReturn the name and average rating for each business in new york\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT business.name, AVG(review.rating) AS average_rating FROM business JOIN review ON business.business_id = review.business_id WHERE business.city ILIKE '%NEW YORK%' GROUP BY business.name;",
        "role": "assistant"
      }
    ],
    "db_name": "yelp",
    "id": 178,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many check-ins occurred on each day of the week?\n\n【数据库schema】\n【DB_ID】 yelp\n【Schema】\n# Table: business\n[\n  (bid:bigint, The unique identifier for the business. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (name:text, The name of the business. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Joe’s Pizza', 'Peter’s Cafe', 'Anna’s Diner'].),\n  (full_address:text, The full address of the business. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (city:text, The city where the business is located. Value examples: ['San Francisco', 'New York', 'Los Angeles'].),\n  (latitude:text, The latitude of the business location. Value examples: ['37.7749295', '40.712776', '34.052235'].),\n  (longitude:text, The longitude of the business location. Value examples: ['-122.4194155', '-74.005974', '-118.243683'].),\n  (review_count:bigint, The number of reviews for the business. Value examples: ['2', '3', '4'].),\n  (is_open:bigint, Indicates whether the business is currently open or closed (1 for open, 0 for closed). Value examples: ['0', '1', '0'].),\n  (state:text, The US state where the business is located, represented by two-letter abbreviations (eg. 'CA', 'NV', 'NY', etc.). Value examples: ['CA', 'NY', 'CA'].),\n]\n# Table: category\n[\n  (id:bigint, Unique identifier for each category. Value examples: ['1', '2'].),\n  (business_id:text, Identifier for the business associated with the category. Value examples: ['abc123', 'def456'].),\n  (category_name:text, Name of the category. Eg 'Bistro', 'Diner', 'Pizza'. Value examples: ['Pizza', 'Cafe'].),\n]\n# Table: checkin\n[\n  (cid:bigint, Unique identifier for the daily check-in count. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the check-in occurred. Value examples: ['abc123', 'def456'].),\n  (count:bigint, Number of check-ins on the given day. Value examples: ['10', '20'].),\n  (day:text, Day of the week when the check-ins occurred. Eg. 'Monday', 'Tuesday', etc.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: neighbourhood\n[\n  (id:bigint, Unique identifier for each neighbourhood. Value examples: ['1', '2', '3'].),\n  (business_id:text, Identifier for each business in the neighbourhood. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (neighbourhood_name:text, Name of the neighbourhood where the business is located. Value examples: ['Downtown', 'Midtown', 'Hollywood'].),\n]\n# Table: review\n[\n  (rid:bigint, The unique identifier for each review.. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business being reviewed.. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (user_id:text, The unique identifier for the user who posted the review.. Value examples: ['1', '2', '3'].),\n  (rating:real, The rating given by the user for the business, on a scale of 1 to 5.. Value examples: ['4.5', '4.2', '3.9'].),\n  (text:text, The text of the review. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Great pizza!', 'Delicious food.', 'Average diner.'].),\n  (year:bigint, The year in which the review was posted.. Value examples: ['2021', '2021', '2021'].),\n  (month:text, The month in which the review was posted. Eg. 'January', 'February', etc.. Value examples: ['January', 'February', 'March'].),\n]\n# Table: tip\n[\n  (tip_id:bigint, Unique identifier for the tip. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the tip was created.. Value examples: ['abc123', 'def456'].),\n  (text:text, Text content of the tip. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Try their pepperoni pizza!', 'Their coffee is amazing.'].),\n  (user_id:text, Unique identifier for the user who created the tip. Value examples: ['1', '2'].),\n  (likes:bigint, Value examples: ['NULL', 'NULL'].),\n  (year:bigint, Year when the tip was created. Value examples: ['2021', '2021'].),\n  (month:text, Month when the tip was created. Eg. 'January', 'February', etc.. Value examples: ['January', 'February'].),\n]\n# Table: users\n[\n  (uid:bigint, Unique identifier for each user. Value examples: ['1', '2', '3', '4'].),\n  (user_id:text, Unique user ID assigned by the system. Value examples: ['1', '2', '3', '4'].),\n  (name:text, Name of the user. Value examples: ['John Doe', 'Jane Smith', 'David Johnson', 'Sarah Williams'].),\n]\n\n【Foreign keys】\nbusiness.business_id = tip.business_id\nbusiness.business_id = review.business_id\nbusiness.business_id = checkin.business_id\nbusiness.business_id = neighbourhood.business_id\nbusiness.business_id = category.business_id\ntip.user_id = users.user_id\nreview.user_id = users.user_id\n\n【参考信息】\n\n\n【用户问题】\nHow many check-ins occurred on each day of the week?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT checkin.day, SUM(checkin.count) AS total_checkins FROM checkin GROUP BY checkin.day ORDER BY total_checkins DESC NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "yelp",
    "id": 179,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nPlease provide a list of business names in New York and their average ratings ordered by the highest average rating first.\n\n【数据库schema】\n【DB_ID】 yelp\n【Schema】\n# Table: business\n[\n  (bid:bigint, The unique identifier for the business. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (name:text, The name of the business. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Joe’s Pizza', 'Peter’s Cafe', 'Anna’s Diner'].),\n  (full_address:text, The full address of the business. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (city:text, The city where the business is located. Value examples: ['San Francisco', 'New York', 'Los Angeles'].),\n  (latitude:text, The latitude of the business location. Value examples: ['37.7749295', '40.712776', '34.052235'].),\n  (longitude:text, The longitude of the business location. Value examples: ['-122.4194155', '-74.005974', '-118.243683'].),\n  (review_count:bigint, The number of reviews for the business. Value examples: ['2', '3', '4'].),\n  (is_open:bigint, Indicates whether the business is currently open or closed (1 for open, 0 for closed). Value examples: ['0', '1', '0'].),\n  (state:text, The US state where the business is located, represented by two-letter abbreviations (eg. 'CA', 'NV', 'NY', etc.). Value examples: ['CA', 'NY', 'CA'].),\n]\n# Table: category\n[\n  (id:bigint, Unique identifier for each category. Value examples: ['1', '2'].),\n  (business_id:text, Identifier for the business associated with the category. Value examples: ['abc123', 'def456'].),\n  (category_name:text, Name of the category. Eg 'Bistro', 'Diner', 'Pizza'. Value examples: ['Pizza', 'Cafe'].),\n]\n# Table: checkin\n[\n  (cid:bigint, Unique identifier for the daily check-in count. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the check-in occurred. Value examples: ['abc123', 'def456'].),\n  (count:bigint, Number of check-ins on the given day. Value examples: ['10', '20'].),\n  (day:text, Day of the week when the check-ins occurred. Eg. 'Monday', 'Tuesday', etc.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: neighbourhood\n[\n  (id:bigint, Unique identifier for each neighbourhood. Value examples: ['1', '2', '3'].),\n  (business_id:text, Identifier for each business in the neighbourhood. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (neighbourhood_name:text, Name of the neighbourhood where the business is located. Value examples: ['Downtown', 'Midtown', 'Hollywood'].),\n]\n# Table: review\n[\n  (rid:bigint, The unique identifier for each review.. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business being reviewed.. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (user_id:text, The unique identifier for the user who posted the review.. Value examples: ['1', '2', '3'].),\n  (rating:real, The rating given by the user for the business, on a scale of 1 to 5.. Value examples: ['4.5', '4.2', '3.9'].),\n  (text:text, The text of the review. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Great pizza!', 'Delicious food.', 'Average diner.'].),\n  (year:bigint, The year in which the review was posted.. Value examples: ['2021', '2021', '2021'].),\n  (month:text, The month in which the review was posted. Eg. 'January', 'February', etc.. Value examples: ['January', 'February', 'March'].),\n]\n# Table: tip\n[\n  (tip_id:bigint, Unique identifier for the tip. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the tip was created.. Value examples: ['abc123', 'def456'].),\n  (text:text, Text content of the tip. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Try their pepperoni pizza!', 'Their coffee is amazing.'].),\n  (user_id:text, Unique identifier for the user who created the tip. Value examples: ['1', '2'].),\n  (likes:bigint, Value examples: ['NULL', 'NULL'].),\n  (year:bigint, Year when the tip was created. Value examples: ['2021', '2021'].),\n  (month:text, Month when the tip was created. Eg. 'January', 'February', etc.. Value examples: ['January', 'February'].),\n]\n# Table: users\n[\n  (uid:bigint, Unique identifier for each user. Value examples: ['1', '2', '3', '4'].),\n  (user_id:text, Unique user ID assigned by the system. Value examples: ['1', '2', '3', '4'].),\n  (name:text, Name of the user. Value examples: ['John Doe', 'Jane Smith', 'David Johnson', 'Sarah Williams'].),\n]\n\n【Foreign keys】\nbusiness.business_id = tip.business_id\nbusiness.business_id = review.business_id\nbusiness.business_id = checkin.business_id\nbusiness.business_id = neighbourhood.business_id\nbusiness.business_id = category.business_id\ntip.user_id = users.user_id\nreview.user_id = users.user_id\n\n【参考信息】\n\n\n【用户问题】\nPlease provide a list of business names in New York and their average ratings ordered by the highest average rating first.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT business.name, AVG(review.rating) AS average_rating FROM business JOIN review ON business.business_id = review.business_id WHERE business.city ILIKE '%New York%' GROUP BY business.name, business.business_id ORDER BY average_rating DESC NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "yelp",
    "id": 180,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the latitude and longitude of the business with the highest rating?\n\n【数据库schema】\n【DB_ID】 yelp\n【Schema】\n# Table: business\n[\n  (bid:bigint, The unique identifier for the business. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (name:text, The name of the business. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Joe’s Pizza', 'Peter’s Cafe', 'Anna’s Diner'].),\n  (full_address:text, The full address of the business. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (city:text, The city where the business is located. Value examples: ['San Francisco', 'New York', 'Los Angeles'].),\n  (latitude:text, The latitude of the business location. Value examples: ['37.7749295', '40.712776', '34.052235'].),\n  (longitude:text, The longitude of the business location. Value examples: ['-122.4194155', '-74.005974', '-118.243683'].),\n  (review_count:bigint, The number of reviews for the business. Value examples: ['2', '3', '4'].),\n  (is_open:bigint, Indicates whether the business is currently open or closed (1 for open, 0 for closed). Value examples: ['0', '1', '0'].),\n  (state:text, The US state where the business is located, represented by two-letter abbreviations (eg. 'CA', 'NV', 'NY', etc.). Value examples: ['CA', 'NY', 'CA'].),\n]\n# Table: category\n[\n  (id:bigint, Unique identifier for each category. Value examples: ['1', '2'].),\n  (business_id:text, Identifier for the business associated with the category. Value examples: ['abc123', 'def456'].),\n  (category_name:text, Name of the category. Eg 'Bistro', 'Diner', 'Pizza'. Value examples: ['Pizza', 'Cafe'].),\n]\n# Table: checkin\n[\n  (cid:bigint, Unique identifier for the daily check-in count. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the check-in occurred. Value examples: ['abc123', 'def456'].),\n  (count:bigint, Number of check-ins on the given day. Value examples: ['10', '20'].),\n  (day:text, Day of the week when the check-ins occurred. Eg. 'Monday', 'Tuesday', etc.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: neighbourhood\n[\n  (id:bigint, Unique identifier for each neighbourhood. Value examples: ['1', '2', '3'].),\n  (business_id:text, Identifier for each business in the neighbourhood. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (neighbourhood_name:text, Name of the neighbourhood where the business is located. Value examples: ['Downtown', 'Midtown', 'Hollywood'].),\n]\n# Table: review\n[\n  (rid:bigint, The unique identifier for each review.. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business being reviewed.. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (user_id:text, The unique identifier for the user who posted the review.. Value examples: ['1', '2', '3'].),\n  (rating:real, The rating given by the user for the business, on a scale of 1 to 5.. Value examples: ['4.5', '4.2', '3.9'].),\n  (text:text, The text of the review. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Great pizza!', 'Delicious food.', 'Average diner.'].),\n  (year:bigint, The year in which the review was posted.. Value examples: ['2021', '2021', '2021'].),\n  (month:text, The month in which the review was posted. Eg. 'January', 'February', etc.. Value examples: ['January', 'February', 'March'].),\n]\n# Table: tip\n[\n  (tip_id:bigint, Unique identifier for the tip. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the tip was created.. Value examples: ['abc123', 'def456'].),\n  (text:text, Text content of the tip. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Try their pepperoni pizza!', 'Their coffee is amazing.'].),\n  (user_id:text, Unique identifier for the user who created the tip. Value examples: ['1', '2'].),\n  (likes:bigint, Value examples: ['NULL', 'NULL'].),\n  (year:bigint, Year when the tip was created. Value examples: ['2021', '2021'].),\n  (month:text, Month when the tip was created. Eg. 'January', 'February', etc.. Value examples: ['January', 'February'].),\n]\n# Table: users\n[\n  (uid:bigint, Unique identifier for each user. Value examples: ['1', '2', '3', '4'].),\n  (user_id:text, Unique user ID assigned by the system. Value examples: ['1', '2', '3', '4'].),\n  (name:text, Name of the user. Value examples: ['John Doe', 'Jane Smith', 'David Johnson', 'Sarah Williams'].),\n]\n\n【Foreign keys】\nbusiness.business_id = tip.business_id\nbusiness.business_id = review.business_id\nbusiness.business_id = checkin.business_id\nbusiness.business_id = neighbourhood.business_id\nbusiness.business_id = category.business_id\ntip.user_id = users.user_id\nreview.user_id = users.user_id\n\n【参考信息】\n\n\n【用户问题】\nWhat is the latitude and longitude of the business with the highest rating?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT business.latitude, business.longitude FROM business JOIN review ON business.business_id = review.business_id GROUP BY business.business_id, business.latitude, business.longitude ORDER BY AVG(review.rating) DESC LIMIT 1;",
        "role": "assistant"
      }
    ],
    "db_name": "yelp",
    "id": 181,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the top 3 businesses in terms of review count?\n\n【数据库schema】\n【DB_ID】 yelp\n【Schema】\n# Table: business\n[\n  (bid:bigint, The unique identifier for the business. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (name:text, The name of the business. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Joe’s Pizza', 'Peter’s Cafe', 'Anna’s Diner'].),\n  (full_address:text, The full address of the business. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (city:text, The city where the business is located. Value examples: ['San Francisco', 'New York', 'Los Angeles'].),\n  (latitude:text, The latitude of the business location. Value examples: ['37.7749295', '40.712776', '34.052235'].),\n  (longitude:text, The longitude of the business location. Value examples: ['-122.4194155', '-74.005974', '-118.243683'].),\n  (review_count:bigint, The number of reviews for the business. Value examples: ['2', '3', '4'].),\n  (is_open:bigint, Indicates whether the business is currently open or closed (1 for open, 0 for closed). Value examples: ['0', '1', '0'].),\n  (state:text, The US state where the business is located, represented by two-letter abbreviations (eg. 'CA', 'NV', 'NY', etc.). Value examples: ['CA', 'NY', 'CA'].),\n]\n# Table: category\n[\n  (id:bigint, Unique identifier for each category. Value examples: ['1', '2'].),\n  (business_id:text, Identifier for the business associated with the category. Value examples: ['abc123', 'def456'].),\n  (category_name:text, Name of the category. Eg 'Bistro', 'Diner', 'Pizza'. Value examples: ['Pizza', 'Cafe'].),\n]\n# Table: checkin\n[\n  (cid:bigint, Unique identifier for the daily check-in count. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the check-in occurred. Value examples: ['abc123', 'def456'].),\n  (count:bigint, Number of check-ins on the given day. Value examples: ['10', '20'].),\n  (day:text, Day of the week when the check-ins occurred. Eg. 'Monday', 'Tuesday', etc.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: neighbourhood\n[\n  (id:bigint, Unique identifier for each neighbourhood. Value examples: ['1', '2', '3'].),\n  (business_id:text, Identifier for each business in the neighbourhood. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (neighbourhood_name:text, Name of the neighbourhood where the business is located. Value examples: ['Downtown', 'Midtown', 'Hollywood'].),\n]\n# Table: review\n[\n  (rid:bigint, The unique identifier for each review.. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business being reviewed.. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (user_id:text, The unique identifier for the user who posted the review.. Value examples: ['1', '2', '3'].),\n  (rating:real, The rating given by the user for the business, on a scale of 1 to 5.. Value examples: ['4.5', '4.2', '3.9'].),\n  (text:text, The text of the review. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Great pizza!', 'Delicious food.', 'Average diner.'].),\n  (year:bigint, The year in which the review was posted.. Value examples: ['2021', '2021', '2021'].),\n  (month:text, The month in which the review was posted. Eg. 'January', 'February', etc.. Value examples: ['January', 'February', 'March'].),\n]\n# Table: tip\n[\n  (tip_id:bigint, Unique identifier for the tip. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the tip was created.. Value examples: ['abc123', 'def456'].),\n  (text:text, Text content of the tip. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Try their pepperoni pizza!', 'Their coffee is amazing.'].),\n  (user_id:text, Unique identifier for the user who created the tip. Value examples: ['1', '2'].),\n  (likes:bigint, Value examples: ['NULL', 'NULL'].),\n  (year:bigint, Year when the tip was created. Value examples: ['2021', '2021'].),\n  (month:text, Month when the tip was created. Eg. 'January', 'February', etc.. Value examples: ['January', 'February'].),\n]\n# Table: users\n[\n  (uid:bigint, Unique identifier for each user. Value examples: ['1', '2', '3', '4'].),\n  (user_id:text, Unique user ID assigned by the system. Value examples: ['1', '2', '3', '4'].),\n  (name:text, Name of the user. Value examples: ['John Doe', 'Jane Smith', 'David Johnson', 'Sarah Williams'].),\n]\n\n【Foreign keys】\nbusiness.business_id = tip.business_id\nbusiness.business_id = review.business_id\nbusiness.business_id = checkin.business_id\nbusiness.business_id = neighbourhood.business_id\nbusiness.business_id = category.business_id\ntip.user_id = users.user_id\nreview.user_id = users.user_id\n\n【参考信息】\n\n\n【用户问题】\nWhat are the top 3 businesses in terms of review count?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT business.name, business.business_id, business.bid, business.review_count FROM business ORDER BY business.review_count DESC NULLS LAST LIMIT 3",
        "role": "assistant"
      }
    ],
    "db_name": "yelp",
    "id": 182,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the names of the businesses in the database, ordered alphabetically?\n\n【数据库schema】\n【DB_ID】 yelp\n【Schema】\n# Table: business\n[\n  (bid:bigint, The unique identifier for the business. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (name:text, The name of the business. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Joe’s Pizza', 'Peter’s Cafe', 'Anna’s Diner'].),\n  (full_address:text, The full address of the business. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (city:text, The city where the business is located. Value examples: ['San Francisco', 'New York', 'Los Angeles'].),\n  (latitude:text, The latitude of the business location. Value examples: ['37.7749295', '40.712776', '34.052235'].),\n  (longitude:text, The longitude of the business location. Value examples: ['-122.4194155', '-74.005974', '-118.243683'].),\n  (review_count:bigint, The number of reviews for the business. Value examples: ['2', '3', '4'].),\n  (is_open:bigint, Indicates whether the business is currently open or closed (1 for open, 0 for closed). Value examples: ['0', '1', '0'].),\n  (state:text, The US state where the business is located, represented by two-letter abbreviations (eg. 'CA', 'NV', 'NY', etc.). Value examples: ['CA', 'NY', 'CA'].),\n]\n# Table: category\n[\n  (id:bigint, Unique identifier for each category. Value examples: ['1', '2'].),\n  (business_id:text, Identifier for the business associated with the category. Value examples: ['abc123', 'def456'].),\n  (category_name:text, Name of the category. Eg 'Bistro', 'Diner', 'Pizza'. Value examples: ['Pizza', 'Cafe'].),\n]\n# Table: checkin\n[\n  (cid:bigint, Unique identifier for the daily check-in count. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the check-in occurred. Value examples: ['abc123', 'def456'].),\n  (count:bigint, Number of check-ins on the given day. Value examples: ['10', '20'].),\n  (day:text, Day of the week when the check-ins occurred. Eg. 'Monday', 'Tuesday', etc.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: neighbourhood\n[\n  (id:bigint, Unique identifier for each neighbourhood. Value examples: ['1', '2', '3'].),\n  (business_id:text, Identifier for each business in the neighbourhood. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (neighbourhood_name:text, Name of the neighbourhood where the business is located. Value examples: ['Downtown', 'Midtown', 'Hollywood'].),\n]\n# Table: review\n[\n  (rid:bigint, The unique identifier for each review.. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business being reviewed.. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (user_id:text, The unique identifier for the user who posted the review.. Value examples: ['1', '2', '3'].),\n  (rating:real, The rating given by the user for the business, on a scale of 1 to 5.. Value examples: ['4.5', '4.2', '3.9'].),\n  (text:text, The text of the review. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Great pizza!', 'Delicious food.', 'Average diner.'].),\n  (year:bigint, The year in which the review was posted.. Value examples: ['2021', '2021', '2021'].),\n  (month:text, The month in which the review was posted. Eg. 'January', 'February', etc.. Value examples: ['January', 'February', 'March'].),\n]\n# Table: tip\n[\n  (tip_id:bigint, Unique identifier for the tip. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the tip was created.. Value examples: ['abc123', 'def456'].),\n  (text:text, Text content of the tip. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Try their pepperoni pizza!', 'Their coffee is amazing.'].),\n  (user_id:text, Unique identifier for the user who created the tip. Value examples: ['1', '2'].),\n  (likes:bigint, Value examples: ['NULL', 'NULL'].),\n  (year:bigint, Year when the tip was created. Value examples: ['2021', '2021'].),\n  (month:text, Month when the tip was created. Eg. 'January', 'February', etc.. Value examples: ['January', 'February'].),\n]\n# Table: users\n[\n  (uid:bigint, Unique identifier for each user. Value examples: ['1', '2', '3', '4'].),\n  (user_id:text, Unique user ID assigned by the system. Value examples: ['1', '2', '3', '4'].),\n  (name:text, Name of the user. Value examples: ['John Doe', 'Jane Smith', 'David Johnson', 'Sarah Williams'].),\n]\n\n【Foreign keys】\nbusiness.business_id = tip.business_id\nbusiness.business_id = review.business_id\nbusiness.business_id = checkin.business_id\nbusiness.business_id = neighbourhood.business_id\nbusiness.business_id = category.business_id\ntip.user_id = users.user_id\nreview.user_id = users.user_id\n\n【参考信息】\n\n\n【用户问题】\nWhat are the names of the businesses in the database, ordered alphabetically?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT business.name FROM business ORDER BY business.name ASC NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "yelp",
    "id": 183,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many reviews were posted in each month of the year 2021, ordered by the month?\n\n【数据库schema】\n【DB_ID】 yelp\n【Schema】\n# Table: business\n[\n  (bid:bigint, The unique identifier for the business. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (name:text, The name of the business. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Joe’s Pizza', 'Peter’s Cafe', 'Anna’s Diner'].),\n  (full_address:text, The full address of the business. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (city:text, The city where the business is located. Value examples: ['San Francisco', 'New York', 'Los Angeles'].),\n  (latitude:text, The latitude of the business location. Value examples: ['37.7749295', '40.712776', '34.052235'].),\n  (longitude:text, The longitude of the business location. Value examples: ['-122.4194155', '-74.005974', '-118.243683'].),\n  (review_count:bigint, The number of reviews for the business. Value examples: ['2', '3', '4'].),\n  (is_open:bigint, Indicates whether the business is currently open or closed (1 for open, 0 for closed). Value examples: ['0', '1', '0'].),\n  (state:text, The US state where the business is located, represented by two-letter abbreviations (eg. 'CA', 'NV', 'NY', etc.). Value examples: ['CA', 'NY', 'CA'].),\n]\n# Table: category\n[\n  (id:bigint, Unique identifier for each category. Value examples: ['1', '2'].),\n  (business_id:text, Identifier for the business associated with the category. Value examples: ['abc123', 'def456'].),\n  (category_name:text, Name of the category. Eg 'Bistro', 'Diner', 'Pizza'. Value examples: ['Pizza', 'Cafe'].),\n]\n# Table: checkin\n[\n  (cid:bigint, Unique identifier for the daily check-in count. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the check-in occurred. Value examples: ['abc123', 'def456'].),\n  (count:bigint, Number of check-ins on the given day. Value examples: ['10', '20'].),\n  (day:text, Day of the week when the check-ins occurred. Eg. 'Monday', 'Tuesday', etc.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: neighbourhood\n[\n  (id:bigint, Unique identifier for each neighbourhood. Value examples: ['1', '2', '3'].),\n  (business_id:text, Identifier for each business in the neighbourhood. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (neighbourhood_name:text, Name of the neighbourhood where the business is located. Value examples: ['Downtown', 'Midtown', 'Hollywood'].),\n]\n# Table: review\n[\n  (rid:bigint, The unique identifier for each review.. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business being reviewed.. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (user_id:text, The unique identifier for the user who posted the review.. Value examples: ['1', '2', '3'].),\n  (rating:real, The rating given by the user for the business, on a scale of 1 to 5.. Value examples: ['4.5', '4.2', '3.9'].),\n  (text:text, The text of the review. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Great pizza!', 'Delicious food.', 'Average diner.'].),\n  (year:bigint, The year in which the review was posted.. Value examples: ['2021', '2021', '2021'].),\n  (month:text, The month in which the review was posted. Eg. 'January', 'February', etc.. Value examples: ['January', 'February', 'March'].),\n]\n# Table: tip\n[\n  (tip_id:bigint, Unique identifier for the tip. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the tip was created.. Value examples: ['abc123', 'def456'].),\n  (text:text, Text content of the tip. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Try their pepperoni pizza!', 'Their coffee is amazing.'].),\n  (user_id:text, Unique identifier for the user who created the tip. Value examples: ['1', '2'].),\n  (likes:bigint, Value examples: ['NULL', 'NULL'].),\n  (year:bigint, Year when the tip was created. Value examples: ['2021', '2021'].),\n  (month:text, Month when the tip was created. Eg. 'January', 'February', etc.. Value examples: ['January', 'February'].),\n]\n# Table: users\n[\n  (uid:bigint, Unique identifier for each user. Value examples: ['1', '2', '3', '4'].),\n  (user_id:text, Unique user ID assigned by the system. Value examples: ['1', '2', '3', '4'].),\n  (name:text, Name of the user. Value examples: ['John Doe', 'Jane Smith', 'David Johnson', 'Sarah Williams'].),\n]\n\n【Foreign keys】\nbusiness.business_id = tip.business_id\nbusiness.business_id = review.business_id\nbusiness.business_id = checkin.business_id\nbusiness.business_id = neighbourhood.business_id\nbusiness.business_id = category.business_id\ntip.user_id = users.user_id\nreview.user_id = users.user_id\n\n【参考信息】\n\n\n【用户问题】\nHow many reviews were posted in each month of the year 2021, ordered by the month?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT review.month, COUNT(review.rid) AS review_count FROM review WHERE review.year = 2021 GROUP BY review.month ORDER BY TO_DATE(review.month, 'Month') NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "yelp",
    "id": 184,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the ratio of the number of businesses in each state to the total number of businesses in the database?\n\n【数据库schema】\n【DB_ID】 yelp\n【Schema】\n# Table: business\n[\n  (bid:bigint, The unique identifier for the business. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (name:text, The name of the business. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Joe’s Pizza', 'Peter’s Cafe', 'Anna’s Diner'].),\n  (full_address:text, The full address of the business. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (city:text, The city where the business is located. Value examples: ['San Francisco', 'New York', 'Los Angeles'].),\n  (latitude:text, The latitude of the business location. Value examples: ['37.7749295', '40.712776', '34.052235'].),\n  (longitude:text, The longitude of the business location. Value examples: ['-122.4194155', '-74.005974', '-118.243683'].),\n  (review_count:bigint, The number of reviews for the business. Value examples: ['2', '3', '4'].),\n  (is_open:bigint, Indicates whether the business is currently open or closed (1 for open, 0 for closed). Value examples: ['0', '1', '0'].),\n  (state:text, The US state where the business is located, represented by two-letter abbreviations (eg. 'CA', 'NV', 'NY', etc.). Value examples: ['CA', 'NY', 'CA'].),\n]\n# Table: category\n[\n  (id:bigint, Unique identifier for each category. Value examples: ['1', '2'].),\n  (business_id:text, Identifier for the business associated with the category. Value examples: ['abc123', 'def456'].),\n  (category_name:text, Name of the category. Eg 'Bistro', 'Diner', 'Pizza'. Value examples: ['Pizza', 'Cafe'].),\n]\n# Table: checkin\n[\n  (cid:bigint, Unique identifier for the daily check-in count. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the check-in occurred. Value examples: ['abc123', 'def456'].),\n  (count:bigint, Number of check-ins on the given day. Value examples: ['10', '20'].),\n  (day:text, Day of the week when the check-ins occurred. Eg. 'Monday', 'Tuesday', etc.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: neighbourhood\n[\n  (id:bigint, Unique identifier for each neighbourhood. Value examples: ['1', '2', '3'].),\n  (business_id:text, Identifier for each business in the neighbourhood. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (neighbourhood_name:text, Name of the neighbourhood where the business is located. Value examples: ['Downtown', 'Midtown', 'Hollywood'].),\n]\n# Table: review\n[\n  (rid:bigint, The unique identifier for each review.. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business being reviewed.. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (user_id:text, The unique identifier for the user who posted the review.. Value examples: ['1', '2', '3'].),\n  (rating:real, The rating given by the user for the business, on a scale of 1 to 5.. Value examples: ['4.5', '4.2', '3.9'].),\n  (text:text, The text of the review. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Great pizza!', 'Delicious food.', 'Average diner.'].),\n  (year:bigint, The year in which the review was posted.. Value examples: ['2021', '2021', '2021'].),\n  (month:text, The month in which the review was posted. Eg. 'January', 'February', etc.. Value examples: ['January', 'February', 'March'].),\n]\n# Table: tip\n[\n  (tip_id:bigint, Unique identifier for the tip. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the tip was created.. Value examples: ['abc123', 'def456'].),\n  (text:text, Text content of the tip. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Try their pepperoni pizza!', 'Their coffee is amazing.'].),\n  (user_id:text, Unique identifier for the user who created the tip. Value examples: ['1', '2'].),\n  (likes:bigint, Value examples: ['NULL', 'NULL'].),\n  (year:bigint, Year when the tip was created. Value examples: ['2021', '2021'].),\n  (month:text, Month when the tip was created. Eg. 'January', 'February', etc.. Value examples: ['January', 'February'].),\n]\n# Table: users\n[\n  (uid:bigint, Unique identifier for each user. Value examples: ['1', '2', '3', '4'].),\n  (user_id:text, Unique user ID assigned by the system. Value examples: ['1', '2', '3', '4'].),\n  (name:text, Name of the user. Value examples: ['John Doe', 'Jane Smith', 'David Johnson', 'Sarah Williams'].),\n]\n\n【Foreign keys】\nbusiness.business_id = tip.business_id\nbusiness.business_id = review.business_id\nbusiness.business_id = checkin.business_id\nbusiness.business_id = neighbourhood.business_id\nbusiness.business_id = category.business_id\ntip.user_id = users.user_id\nreview.user_id = users.user_id\n\n【参考信息】\n\n\n【用户问题】\nWhat is the ratio of the number of businesses in each state to the total number of businesses in the database?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT business.state, COUNT(business.business_id) / NULLIF(CAST((SELECT COUNT(*) FROM business) AS FLOAT), 0) AS ratio FROM business GROUP BY business.state;",
        "role": "assistant"
      }
    ],
    "db_name": "yelp",
    "id": 185,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the ratio of open businesses to closed businesses in the city of San Francisco?\n\n【数据库schema】\n【DB_ID】 yelp\n【Schema】\n# Table: business\n[\n  (bid:bigint, The unique identifier for the business. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (name:text, The name of the business. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Joe’s Pizza', 'Peter’s Cafe', 'Anna’s Diner'].),\n  (full_address:text, The full address of the business. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (city:text, The city where the business is located. Value examples: ['San Francisco', 'New York', 'Los Angeles'].),\n  (latitude:text, The latitude of the business location. Value examples: ['37.7749295', '40.712776', '34.052235'].),\n  (longitude:text, The longitude of the business location. Value examples: ['-122.4194155', '-74.005974', '-118.243683'].),\n  (review_count:bigint, The number of reviews for the business. Value examples: ['2', '3', '4'].),\n  (is_open:bigint, Indicates whether the business is currently open or closed (1 for open, 0 for closed). Value examples: ['0', '1', '0'].),\n  (state:text, The US state where the business is located, represented by two-letter abbreviations (eg. 'CA', 'NV', 'NY', etc.). Value examples: ['CA', 'NY', 'CA'].),\n]\n# Table: category\n[\n  (id:bigint, Unique identifier for each category. Value examples: ['1', '2'].),\n  (business_id:text, Identifier for the business associated with the category. Value examples: ['abc123', 'def456'].),\n  (category_name:text, Name of the category. Eg 'Bistro', 'Diner', 'Pizza'. Value examples: ['Pizza', 'Cafe'].),\n]\n# Table: checkin\n[\n  (cid:bigint, Unique identifier for the daily check-in count. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the check-in occurred. Value examples: ['abc123', 'def456'].),\n  (count:bigint, Number of check-ins on the given day. Value examples: ['10', '20'].),\n  (day:text, Day of the week when the check-ins occurred. Eg. 'Monday', 'Tuesday', etc.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: neighbourhood\n[\n  (id:bigint, Unique identifier for each neighbourhood. Value examples: ['1', '2', '3'].),\n  (business_id:text, Identifier for each business in the neighbourhood. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (neighbourhood_name:text, Name of the neighbourhood where the business is located. Value examples: ['Downtown', 'Midtown', 'Hollywood'].),\n]\n# Table: review\n[\n  (rid:bigint, The unique identifier for each review.. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business being reviewed.. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (user_id:text, The unique identifier for the user who posted the review.. Value examples: ['1', '2', '3'].),\n  (rating:real, The rating given by the user for the business, on a scale of 1 to 5.. Value examples: ['4.5', '4.2', '3.9'].),\n  (text:text, The text of the review. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Great pizza!', 'Delicious food.', 'Average diner.'].),\n  (year:bigint, The year in which the review was posted.. Value examples: ['2021', '2021', '2021'].),\n  (month:text, The month in which the review was posted. Eg. 'January', 'February', etc.. Value examples: ['January', 'February', 'March'].),\n]\n# Table: tip\n[\n  (tip_id:bigint, Unique identifier for the tip. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the tip was created.. Value examples: ['abc123', 'def456'].),\n  (text:text, Text content of the tip. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Try their pepperoni pizza!', 'Their coffee is amazing.'].),\n  (user_id:text, Unique identifier for the user who created the tip. Value examples: ['1', '2'].),\n  (likes:bigint, Value examples: ['NULL', 'NULL'].),\n  (year:bigint, Year when the tip was created. Value examples: ['2021', '2021'].),\n  (month:text, Month when the tip was created. Eg. 'January', 'February', etc.. Value examples: ['January', 'February'].),\n]\n# Table: users\n[\n  (uid:bigint, Unique identifier for each user. Value examples: ['1', '2', '3', '4'].),\n  (user_id:text, Unique user ID assigned by the system. Value examples: ['1', '2', '3', '4'].),\n  (name:text, Name of the user. Value examples: ['John Doe', 'Jane Smith', 'David Johnson', 'Sarah Williams'].),\n]\n\n【Foreign keys】\nbusiness.business_id = tip.business_id\nbusiness.business_id = review.business_id\nbusiness.business_id = checkin.business_id\nbusiness.business_id = neighbourhood.business_id\nbusiness.business_id = category.business_id\ntip.user_id = users.user_id\nreview.user_id = users.user_id\n\n【参考信息】\n\n\n【用户问题】\nWhat is the ratio of open businesses to closed businesses in the city of San Francisco?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT CAST(SUM(CASE WHEN business.is_open = 1 THEN 1 ELSE 0 END) AS FLOAT) / NULLIF(SUM(CASE WHEN business.is_open = 0 THEN 1 ELSE 0 END), 0) AS ratio FROM business WHERE LOWER(business.city) ILIKE '%san francisco%';",
        "role": "assistant"
      }
    ],
    "db_name": "yelp",
    "id": 186,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the ratio of check-ins on weekends to check-ins on weekdays for the business named \"Mark's Bistro\"?\n\n【数据库schema】\n【DB_ID】 yelp\n【Schema】\n# Table: business\n[\n  (bid:bigint, The unique identifier for the business. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (name:text, The name of the business. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Joe’s Pizza', 'Peter’s Cafe', 'Anna’s Diner'].),\n  (full_address:text, The full address of the business. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (city:text, The city where the business is located. Value examples: ['San Francisco', 'New York', 'Los Angeles'].),\n  (latitude:text, The latitude of the business location. Value examples: ['37.7749295', '40.712776', '34.052235'].),\n  (longitude:text, The longitude of the business location. Value examples: ['-122.4194155', '-74.005974', '-118.243683'].),\n  (review_count:bigint, The number of reviews for the business. Value examples: ['2', '3', '4'].),\n  (is_open:bigint, Indicates whether the business is currently open or closed (1 for open, 0 for closed). Value examples: ['0', '1', '0'].),\n  (state:text, The US state where the business is located, represented by two-letter abbreviations (eg. 'CA', 'NV', 'NY', etc.). Value examples: ['CA', 'NY', 'CA'].),\n]\n# Table: category\n[\n  (id:bigint, Unique identifier for each category. Value examples: ['1', '2'].),\n  (business_id:text, Identifier for the business associated with the category. Value examples: ['abc123', 'def456'].),\n  (category_name:text, Name of the category. Eg 'Bistro', 'Diner', 'Pizza'. Value examples: ['Pizza', 'Cafe'].),\n]\n# Table: checkin\n[\n  (cid:bigint, Unique identifier for the daily check-in count. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the check-in occurred. Value examples: ['abc123', 'def456'].),\n  (count:bigint, Number of check-ins on the given day. Value examples: ['10', '20'].),\n  (day:text, Day of the week when the check-ins occurred. Eg. 'Monday', 'Tuesday', etc.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: neighbourhood\n[\n  (id:bigint, Unique identifier for each neighbourhood. Value examples: ['1', '2', '3'].),\n  (business_id:text, Identifier for each business in the neighbourhood. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (neighbourhood_name:text, Name of the neighbourhood where the business is located. Value examples: ['Downtown', 'Midtown', 'Hollywood'].),\n]\n# Table: review\n[\n  (rid:bigint, The unique identifier for each review.. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business being reviewed.. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (user_id:text, The unique identifier for the user who posted the review.. Value examples: ['1', '2', '3'].),\n  (rating:real, The rating given by the user for the business, on a scale of 1 to 5.. Value examples: ['4.5', '4.2', '3.9'].),\n  (text:text, The text of the review. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Great pizza!', 'Delicious food.', 'Average diner.'].),\n  (year:bigint, The year in which the review was posted.. Value examples: ['2021', '2021', '2021'].),\n  (month:text, The month in which the review was posted. Eg. 'January', 'February', etc.. Value examples: ['January', 'February', 'March'].),\n]\n# Table: tip\n[\n  (tip_id:bigint, Unique identifier for the tip. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the tip was created.. Value examples: ['abc123', 'def456'].),\n  (text:text, Text content of the tip. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Try their pepperoni pizza!', 'Their coffee is amazing.'].),\n  (user_id:text, Unique identifier for the user who created the tip. Value examples: ['1', '2'].),\n  (likes:bigint, Value examples: ['NULL', 'NULL'].),\n  (year:bigint, Year when the tip was created. Value examples: ['2021', '2021'].),\n  (month:text, Month when the tip was created. Eg. 'January', 'February', etc.. Value examples: ['January', 'February'].),\n]\n# Table: users\n[\n  (uid:bigint, Unique identifier for each user. Value examples: ['1', '2', '3', '4'].),\n  (user_id:text, Unique user ID assigned by the system. Value examples: ['1', '2', '3', '4'].),\n  (name:text, Name of the user. Value examples: ['John Doe', 'Jane Smith', 'David Johnson', 'Sarah Williams'].),\n]\n\n【Foreign keys】\nbusiness.business_id = tip.business_id\nbusiness.business_id = review.business_id\nbusiness.business_id = checkin.business_id\nbusiness.business_id = neighbourhood.business_id\nbusiness.business_id = category.business_id\ntip.user_id = users.user_id\nreview.user_id = users.user_id\n\n【参考信息】\n\n\n【用户问题】\nWhat is the ratio of check-ins on weekends to check-ins on weekdays for the business named \"Mark's Bistro\"?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT CAST(SUM(CASE WHEN checkin.day IN ('Saturday', 'Sunday') THEN checkin.count ELSE 0 END) AS FLOAT) / NULLIF(SUM(CASE WHEN checkin.day NOT IN ('Saturday', 'Sunday') THEN checkin.count ELSE 0 END), 0) AS ratio FROM checkin JOIN business ON checkin.business_id = business.business_id WHERE business.name ILIKE '%Mark''s Bistro%';",
        "role": "assistant"
      }
    ],
    "db_name": "yelp",
    "id": 187,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the ratio of businesses in the state of California to businesses in the state of New York?\n\n【数据库schema】\n【DB_ID】 yelp\n【Schema】\n# Table: business\n[\n  (bid:bigint, The unique identifier for the business. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (name:text, The name of the business. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Joe’s Pizza', 'Peter’s Cafe', 'Anna’s Diner'].),\n  (full_address:text, The full address of the business. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (city:text, The city where the business is located. Value examples: ['San Francisco', 'New York', 'Los Angeles'].),\n  (latitude:text, The latitude of the business location. Value examples: ['37.7749295', '40.712776', '34.052235'].),\n  (longitude:text, The longitude of the business location. Value examples: ['-122.4194155', '-74.005974', '-118.243683'].),\n  (review_count:bigint, The number of reviews for the business. Value examples: ['2', '3', '4'].),\n  (is_open:bigint, Indicates whether the business is currently open or closed (1 for open, 0 for closed). Value examples: ['0', '1', '0'].),\n  (state:text, The US state where the business is located, represented by two-letter abbreviations (eg. 'CA', 'NV', 'NY', etc.). Value examples: ['CA', 'NY', 'CA'].),\n]\n# Table: category\n[\n  (id:bigint, Unique identifier for each category. Value examples: ['1', '2'].),\n  (business_id:text, Identifier for the business associated with the category. Value examples: ['abc123', 'def456'].),\n  (category_name:text, Name of the category. Eg 'Bistro', 'Diner', 'Pizza'. Value examples: ['Pizza', 'Cafe'].),\n]\n# Table: checkin\n[\n  (cid:bigint, Unique identifier for the daily check-in count. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the check-in occurred. Value examples: ['abc123', 'def456'].),\n  (count:bigint, Number of check-ins on the given day. Value examples: ['10', '20'].),\n  (day:text, Day of the week when the check-ins occurred. Eg. 'Monday', 'Tuesday', etc.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: neighbourhood\n[\n  (id:bigint, Unique identifier for each neighbourhood. Value examples: ['1', '2', '3'].),\n  (business_id:text, Identifier for each business in the neighbourhood. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (neighbourhood_name:text, Name of the neighbourhood where the business is located. Value examples: ['Downtown', 'Midtown', 'Hollywood'].),\n]\n# Table: review\n[\n  (rid:bigint, The unique identifier for each review.. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business being reviewed.. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (user_id:text, The unique identifier for the user who posted the review.. Value examples: ['1', '2', '3'].),\n  (rating:real, The rating given by the user for the business, on a scale of 1 to 5.. Value examples: ['4.5', '4.2', '3.9'].),\n  (text:text, The text of the review. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Great pizza!', 'Delicious food.', 'Average diner.'].),\n  (year:bigint, The year in which the review was posted.. Value examples: ['2021', '2021', '2021'].),\n  (month:text, The month in which the review was posted. Eg. 'January', 'February', etc.. Value examples: ['January', 'February', 'March'].),\n]\n# Table: tip\n[\n  (tip_id:bigint, Unique identifier for the tip. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the tip was created.. Value examples: ['abc123', 'def456'].),\n  (text:text, Text content of the tip. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Try their pepperoni pizza!', 'Their coffee is amazing.'].),\n  (user_id:text, Unique identifier for the user who created the tip. Value examples: ['1', '2'].),\n  (likes:bigint, Value examples: ['NULL', 'NULL'].),\n  (year:bigint, Year when the tip was created. Value examples: ['2021', '2021'].),\n  (month:text, Month when the tip was created. Eg. 'January', 'February', etc.. Value examples: ['January', 'February'].),\n]\n# Table: users\n[\n  (uid:bigint, Unique identifier for each user. Value examples: ['1', '2', '3', '4'].),\n  (user_id:text, Unique user ID assigned by the system. Value examples: ['1', '2', '3', '4'].),\n  (name:text, Name of the user. Value examples: ['John Doe', 'Jane Smith', 'David Johnson', 'Sarah Williams'].),\n]\n\n【Foreign keys】\nbusiness.business_id = tip.business_id\nbusiness.business_id = review.business_id\nbusiness.business_id = checkin.business_id\nbusiness.business_id = neighbourhood.business_id\nbusiness.business_id = category.business_id\ntip.user_id = users.user_id\nreview.user_id = users.user_id\n\n【参考信息】\n\n\n【用户问题】\nWhat is the ratio of businesses in the state of California to businesses in the state of New York?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT CAST(COUNT(CASE WHEN business.state = 'CA' THEN 1 END) AS FLOAT) / NULLIF(COUNT(CASE WHEN business.state = 'NY' THEN 1 END), 0) AS ratio FROM business;",
        "role": "assistant"
      }
    ],
    "db_name": "yelp",
    "id": 188,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow does the ratio of positive reviews (rating > 3) to negative reviews (rating < 3) vary across different categories of businesses, ordered by descending ratio?\n\n【数据库schema】\n【DB_ID】 yelp\n【Schema】\n# Table: business\n[\n  (bid:bigint, The unique identifier for the business. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (name:text, The name of the business. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Joe’s Pizza', 'Peter’s Cafe', 'Anna’s Diner'].),\n  (full_address:text, The full address of the business. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (city:text, The city where the business is located. Value examples: ['San Francisco', 'New York', 'Los Angeles'].),\n  (latitude:text, The latitude of the business location. Value examples: ['37.7749295', '40.712776', '34.052235'].),\n  (longitude:text, The longitude of the business location. Value examples: ['-122.4194155', '-74.005974', '-118.243683'].),\n  (review_count:bigint, The number of reviews for the business. Value examples: ['2', '3', '4'].),\n  (is_open:bigint, Indicates whether the business is currently open or closed (1 for open, 0 for closed). Value examples: ['0', '1', '0'].),\n  (state:text, The US state where the business is located, represented by two-letter abbreviations (eg. 'CA', 'NV', 'NY', etc.). Value examples: ['CA', 'NY', 'CA'].),\n]\n# Table: category\n[\n  (id:bigint, Unique identifier for each category. Value examples: ['1', '2'].),\n  (business_id:text, Identifier for the business associated with the category. Value examples: ['abc123', 'def456'].),\n  (category_name:text, Name of the category. Eg 'Bistro', 'Diner', 'Pizza'. Value examples: ['Pizza', 'Cafe'].),\n]\n# Table: checkin\n[\n  (cid:bigint, Unique identifier for the daily check-in count. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the check-in occurred. Value examples: ['abc123', 'def456'].),\n  (count:bigint, Number of check-ins on the given day. Value examples: ['10', '20'].),\n  (day:text, Day of the week when the check-ins occurred. Eg. 'Monday', 'Tuesday', etc.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: neighbourhood\n[\n  (id:bigint, Unique identifier for each neighbourhood. Value examples: ['1', '2', '3'].),\n  (business_id:text, Identifier for each business in the neighbourhood. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (neighbourhood_name:text, Name of the neighbourhood where the business is located. Value examples: ['Downtown', 'Midtown', 'Hollywood'].),\n]\n# Table: review\n[\n  (rid:bigint, The unique identifier for each review.. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business being reviewed.. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (user_id:text, The unique identifier for the user who posted the review.. Value examples: ['1', '2', '3'].),\n  (rating:real, The rating given by the user for the business, on a scale of 1 to 5.. Value examples: ['4.5', '4.2', '3.9'].),\n  (text:text, The text of the review. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Great pizza!', 'Delicious food.', 'Average diner.'].),\n  (year:bigint, The year in which the review was posted.. Value examples: ['2021', '2021', '2021'].),\n  (month:text, The month in which the review was posted. Eg. 'January', 'February', etc.. Value examples: ['January', 'February', 'March'].),\n]\n# Table: tip\n[\n  (tip_id:bigint, Unique identifier for the tip. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the tip was created.. Value examples: ['abc123', 'def456'].),\n  (text:text, Text content of the tip. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Try their pepperoni pizza!', 'Their coffee is amazing.'].),\n  (user_id:text, Unique identifier for the user who created the tip. Value examples: ['1', '2'].),\n  (likes:bigint, Value examples: ['NULL', 'NULL'].),\n  (year:bigint, Year when the tip was created. Value examples: ['2021', '2021'].),\n  (month:text, Month when the tip was created. Eg. 'January', 'February', etc.. Value examples: ['January', 'February'].),\n]\n# Table: users\n[\n  (uid:bigint, Unique identifier for each user. Value examples: ['1', '2', '3', '4'].),\n  (user_id:text, Unique user ID assigned by the system. Value examples: ['1', '2', '3', '4'].),\n  (name:text, Name of the user. Value examples: ['John Doe', 'Jane Smith', 'David Johnson', 'Sarah Williams'].),\n]\n\n【Foreign keys】\nbusiness.business_id = tip.business_id\nbusiness.business_id = review.business_id\nbusiness.business_id = checkin.business_id\nbusiness.business_id = neighbourhood.business_id\nbusiness.business_id = category.business_id\ntip.user_id = users.user_id\nreview.user_id = users.user_id\n\n【参考信息】\n\n\n【用户问题】\nHow does the ratio of positive reviews (rating > 3) to negative reviews (rating < 3) vary across different categories of businesses, ordered by descending ratio?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT category.category_name, category.id, CAST(COUNT(CASE WHEN review.rating > 3 THEN 1 END) AS FLOAT) / NULLIF(COUNT(CASE WHEN review.rating < 3 THEN 1 END), 0) AS ratio FROM review JOIN category ON review.business_id = category.business_id GROUP BY category.category_name, category.id ORDER BY ratio DESC NULLS LAST",
        "role": "assistant"
      }
    ],
    "db_name": "yelp",
    "id": 189,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich users have posted reviews for businesses located in the neighbourhood of \"Downtown\" and how many reviews have they posted?\n\n【数据库schema】\n【DB_ID】 yelp\n【Schema】\n# Table: business\n[\n  (bid:bigint, The unique identifier for the business. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (name:text, The name of the business. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Joe’s Pizza', 'Peter’s Cafe', 'Anna’s Diner'].),\n  (full_address:text, The full address of the business. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (city:text, The city where the business is located. Value examples: ['San Francisco', 'New York', 'Los Angeles'].),\n  (latitude:text, The latitude of the business location. Value examples: ['37.7749295', '40.712776', '34.052235'].),\n  (longitude:text, The longitude of the business location. Value examples: ['-122.4194155', '-74.005974', '-118.243683'].),\n  (review_count:bigint, The number of reviews for the business. Value examples: ['2', '3', '4'].),\n  (is_open:bigint, Indicates whether the business is currently open or closed (1 for open, 0 for closed). Value examples: ['0', '1', '0'].),\n  (state:text, The US state where the business is located, represented by two-letter abbreviations (eg. 'CA', 'NV', 'NY', etc.). Value examples: ['CA', 'NY', 'CA'].),\n]\n# Table: category\n[\n  (id:bigint, Unique identifier for each category. Value examples: ['1', '2'].),\n  (business_id:text, Identifier for the business associated with the category. Value examples: ['abc123', 'def456'].),\n  (category_name:text, Name of the category. Eg 'Bistro', 'Diner', 'Pizza'. Value examples: ['Pizza', 'Cafe'].),\n]\n# Table: checkin\n[\n  (cid:bigint, Unique identifier for the daily check-in count. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the check-in occurred. Value examples: ['abc123', 'def456'].),\n  (count:bigint, Number of check-ins on the given day. Value examples: ['10', '20'].),\n  (day:text, Day of the week when the check-ins occurred. Eg. 'Monday', 'Tuesday', etc.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: neighbourhood\n[\n  (id:bigint, Unique identifier for each neighbourhood. Value examples: ['1', '2', '3'].),\n  (business_id:text, Identifier for each business in the neighbourhood. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (neighbourhood_name:text, Name of the neighbourhood where the business is located. Value examples: ['Downtown', 'Midtown', 'Hollywood'].),\n]\n# Table: review\n[\n  (rid:bigint, The unique identifier for each review.. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business being reviewed.. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (user_id:text, The unique identifier for the user who posted the review.. Value examples: ['1', '2', '3'].),\n  (rating:real, The rating given by the user for the business, on a scale of 1 to 5.. Value examples: ['4.5', '4.2', '3.9'].),\n  (text:text, The text of the review. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Great pizza!', 'Delicious food.', 'Average diner.'].),\n  (year:bigint, The year in which the review was posted.. Value examples: ['2021', '2021', '2021'].),\n  (month:text, The month in which the review was posted. Eg. 'January', 'February', etc.. Value examples: ['January', 'February', 'March'].),\n]\n# Table: tip\n[\n  (tip_id:bigint, Unique identifier for the tip. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the tip was created.. Value examples: ['abc123', 'def456'].),\n  (text:text, Text content of the tip. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Try their pepperoni pizza!', 'Their coffee is amazing.'].),\n  (user_id:text, Unique identifier for the user who created the tip. Value examples: ['1', '2'].),\n  (likes:bigint, Value examples: ['NULL', 'NULL'].),\n  (year:bigint, Year when the tip was created. Value examples: ['2021', '2021'].),\n  (month:text, Month when the tip was created. Eg. 'January', 'February', etc.. Value examples: ['January', 'February'].),\n]\n# Table: users\n[\n  (uid:bigint, Unique identifier for each user. Value examples: ['1', '2', '3', '4'].),\n  (user_id:text, Unique user ID assigned by the system. Value examples: ['1', '2', '3', '4'].),\n  (name:text, Name of the user. Value examples: ['John Doe', 'Jane Smith', 'David Johnson', 'Sarah Williams'].),\n]\n\n【Foreign keys】\nbusiness.business_id = tip.business_id\nbusiness.business_id = review.business_id\nbusiness.business_id = checkin.business_id\nbusiness.business_id = neighbourhood.business_id\nbusiness.business_id = category.business_id\ntip.user_id = users.user_id\nreview.user_id = users.user_id\n\n【参考信息】\n\n\n【用户问题】\nWhich users have posted reviews for businesses located in the neighbourhood of \"Downtown\" and how many reviews have they posted?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT users.name, users.user_id, COUNT(review.rid) AS review_count FROM review JOIN neighbourhood ON review.business_id = neighbourhood.business_id JOIN users ON review.user_id = users.user_id WHERE neighbourhood.neighbourhood_name ILIKE '%Downtown%' GROUP BY users.name, users.user_id ORDER BY review_count DESC NULLS LAST",
        "role": "assistant"
      }
    ],
    "db_name": "yelp",
    "id": 190,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the total number of reviews for each category in the state of \"California\"?\n\n【数据库schema】\n【DB_ID】 yelp\n【Schema】\n# Table: business\n[\n  (bid:bigint, The unique identifier for the business. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (name:text, The name of the business. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Joe’s Pizza', 'Peter’s Cafe', 'Anna’s Diner'].),\n  (full_address:text, The full address of the business. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (city:text, The city where the business is located. Value examples: ['San Francisco', 'New York', 'Los Angeles'].),\n  (latitude:text, The latitude of the business location. Value examples: ['37.7749295', '40.712776', '34.052235'].),\n  (longitude:text, The longitude of the business location. Value examples: ['-122.4194155', '-74.005974', '-118.243683'].),\n  (review_count:bigint, The number of reviews for the business. Value examples: ['2', '3', '4'].),\n  (is_open:bigint, Indicates whether the business is currently open or closed (1 for open, 0 for closed). Value examples: ['0', '1', '0'].),\n  (state:text, The US state where the business is located, represented by two-letter abbreviations (eg. 'CA', 'NV', 'NY', etc.). Value examples: ['CA', 'NY', 'CA'].),\n]\n# Table: category\n[\n  (id:bigint, Unique identifier for each category. Value examples: ['1', '2'].),\n  (business_id:text, Identifier for the business associated with the category. Value examples: ['abc123', 'def456'].),\n  (category_name:text, Name of the category. Eg 'Bistro', 'Diner', 'Pizza'. Value examples: ['Pizza', 'Cafe'].),\n]\n# Table: checkin\n[\n  (cid:bigint, Unique identifier for the daily check-in count. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the check-in occurred. Value examples: ['abc123', 'def456'].),\n  (count:bigint, Number of check-ins on the given day. Value examples: ['10', '20'].),\n  (day:text, Day of the week when the check-ins occurred. Eg. 'Monday', 'Tuesday', etc.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: neighbourhood\n[\n  (id:bigint, Unique identifier for each neighbourhood. Value examples: ['1', '2', '3'].),\n  (business_id:text, Identifier for each business in the neighbourhood. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (neighbourhood_name:text, Name of the neighbourhood where the business is located. Value examples: ['Downtown', 'Midtown', 'Hollywood'].),\n]\n# Table: review\n[\n  (rid:bigint, The unique identifier for each review.. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business being reviewed.. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (user_id:text, The unique identifier for the user who posted the review.. Value examples: ['1', '2', '3'].),\n  (rating:real, The rating given by the user for the business, on a scale of 1 to 5.. Value examples: ['4.5', '4.2', '3.9'].),\n  (text:text, The text of the review. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Great pizza!', 'Delicious food.', 'Average diner.'].),\n  (year:bigint, The year in which the review was posted.. Value examples: ['2021', '2021', '2021'].),\n  (month:text, The month in which the review was posted. Eg. 'January', 'February', etc.. Value examples: ['January', 'February', 'March'].),\n]\n# Table: tip\n[\n  (tip_id:bigint, Unique identifier for the tip. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the tip was created.. Value examples: ['abc123', 'def456'].),\n  (text:text, Text content of the tip. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Try their pepperoni pizza!', 'Their coffee is amazing.'].),\n  (user_id:text, Unique identifier for the user who created the tip. Value examples: ['1', '2'].),\n  (likes:bigint, Value examples: ['NULL', 'NULL'].),\n  (year:bigint, Year when the tip was created. Value examples: ['2021', '2021'].),\n  (month:text, Month when the tip was created. Eg. 'January', 'February', etc.. Value examples: ['January', 'February'].),\n]\n# Table: users\n[\n  (uid:bigint, Unique identifier for each user. Value examples: ['1', '2', '3', '4'].),\n  (user_id:text, Unique user ID assigned by the system. Value examples: ['1', '2', '3', '4'].),\n  (name:text, Name of the user. Value examples: ['John Doe', 'Jane Smith', 'David Johnson', 'Sarah Williams'].),\n]\n\n【Foreign keys】\nbusiness.business_id = tip.business_id\nbusiness.business_id = review.business_id\nbusiness.business_id = checkin.business_id\nbusiness.business_id = neighbourhood.business_id\nbusiness.business_id = category.business_id\ntip.user_id = users.user_id\nreview.user_id = users.user_id\n\n【参考信息】\n\n\n【用户问题】\nWhat is the total number of reviews for each category in the state of \"California\"?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT category.category_name, category.id, SUM(business.review_count) AS total_reviews FROM business JOIN category ON business.business_id = category.business_id WHERE business.state = 'CA' GROUP BY category.category_name, category.id ORDER BY total_reviews DESC NULLS LAST",
        "role": "assistant"
      }
    ],
    "db_name": "yelp",
    "id": 191,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the total number of reviews for each business category?\n\n【数据库schema】\n【DB_ID】 yelp\n【Schema】\n# Table: business\n[\n  (bid:bigint, The unique identifier for the business. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (name:text, The name of the business. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Joe’s Pizza', 'Peter’s Cafe', 'Anna’s Diner'].),\n  (full_address:text, The full address of the business. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (city:text, The city where the business is located. Value examples: ['San Francisco', 'New York', 'Los Angeles'].),\n  (latitude:text, The latitude of the business location. Value examples: ['37.7749295', '40.712776', '34.052235'].),\n  (longitude:text, The longitude of the business location. Value examples: ['-122.4194155', '-74.005974', '-118.243683'].),\n  (review_count:bigint, The number of reviews for the business. Value examples: ['2', '3', '4'].),\n  (is_open:bigint, Indicates whether the business is currently open or closed (1 for open, 0 for closed). Value examples: ['0', '1', '0'].),\n  (state:text, The US state where the business is located, represented by two-letter abbreviations (eg. 'CA', 'NV', 'NY', etc.). Value examples: ['CA', 'NY', 'CA'].),\n]\n# Table: category\n[\n  (id:bigint, Unique identifier for each category. Value examples: ['1', '2'].),\n  (business_id:text, Identifier for the business associated with the category. Value examples: ['abc123', 'def456'].),\n  (category_name:text, Name of the category. Eg 'Bistro', 'Diner', 'Pizza'. Value examples: ['Pizza', 'Cafe'].),\n]\n# Table: checkin\n[\n  (cid:bigint, Unique identifier for the daily check-in count. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the check-in occurred. Value examples: ['abc123', 'def456'].),\n  (count:bigint, Number of check-ins on the given day. Value examples: ['10', '20'].),\n  (day:text, Day of the week when the check-ins occurred. Eg. 'Monday', 'Tuesday', etc.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: neighbourhood\n[\n  (id:bigint, Unique identifier for each neighbourhood. Value examples: ['1', '2', '3'].),\n  (business_id:text, Identifier for each business in the neighbourhood. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (neighbourhood_name:text, Name of the neighbourhood where the business is located. Value examples: ['Downtown', 'Midtown', 'Hollywood'].),\n]\n# Table: review\n[\n  (rid:bigint, The unique identifier for each review.. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business being reviewed.. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (user_id:text, The unique identifier for the user who posted the review.. Value examples: ['1', '2', '3'].),\n  (rating:real, The rating given by the user for the business, on a scale of 1 to 5.. Value examples: ['4.5', '4.2', '3.9'].),\n  (text:text, The text of the review. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Great pizza!', 'Delicious food.', 'Average diner.'].),\n  (year:bigint, The year in which the review was posted.. Value examples: ['2021', '2021', '2021'].),\n  (month:text, The month in which the review was posted. Eg. 'January', 'February', etc.. Value examples: ['January', 'February', 'March'].),\n]\n# Table: tip\n[\n  (tip_id:bigint, Unique identifier for the tip. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the tip was created.. Value examples: ['abc123', 'def456'].),\n  (text:text, Text content of the tip. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Try their pepperoni pizza!', 'Their coffee is amazing.'].),\n  (user_id:text, Unique identifier for the user who created the tip. Value examples: ['1', '2'].),\n  (likes:bigint, Value examples: ['NULL', 'NULL'].),\n  (year:bigint, Year when the tip was created. Value examples: ['2021', '2021'].),\n  (month:text, Month when the tip was created. Eg. 'January', 'February', etc.. Value examples: ['January', 'February'].),\n]\n# Table: users\n[\n  (uid:bigint, Unique identifier for each user. Value examples: ['1', '2', '3', '4'].),\n  (user_id:text, Unique user ID assigned by the system. Value examples: ['1', '2', '3', '4'].),\n  (name:text, Name of the user. Value examples: ['John Doe', 'Jane Smith', 'David Johnson', 'Sarah Williams'].),\n]\n\n【Foreign keys】\nbusiness.business_id = tip.business_id\nbusiness.business_id = review.business_id\nbusiness.business_id = checkin.business_id\nbusiness.business_id = neighbourhood.business_id\nbusiness.business_id = category.business_id\ntip.user_id = users.user_id\nreview.user_id = users.user_id\n\n【参考信息】\n\n\n【用户问题】\nWhat is the total number of reviews for each business category?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT category.category_name, category.id, SUM(business.review_count) AS total_reviews FROM business JOIN category ON business.business_id = category.business_id GROUP BY category.category_name, category.id ORDER BY total_reviews DESC NULLS LAST",
        "role": "assistant"
      }
    ],
    "db_name": "yelp",
    "id": 192,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the total number of check-ins for each business in the state of California?\n\n【数据库schema】\n【DB_ID】 yelp\n【Schema】\n# Table: business\n[\n  (bid:bigint, The unique identifier for the business. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (name:text, The name of the business. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Joe’s Pizza', 'Peter’s Cafe', 'Anna’s Diner'].),\n  (full_address:text, The full address of the business. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (city:text, The city where the business is located. Value examples: ['San Francisco', 'New York', 'Los Angeles'].),\n  (latitude:text, The latitude of the business location. Value examples: ['37.7749295', '40.712776', '34.052235'].),\n  (longitude:text, The longitude of the business location. Value examples: ['-122.4194155', '-74.005974', '-118.243683'].),\n  (review_count:bigint, The number of reviews for the business. Value examples: ['2', '3', '4'].),\n  (is_open:bigint, Indicates whether the business is currently open or closed (1 for open, 0 for closed). Value examples: ['0', '1', '0'].),\n  (state:text, The US state where the business is located, represented by two-letter abbreviations (eg. 'CA', 'NV', 'NY', etc.). Value examples: ['CA', 'NY', 'CA'].),\n]\n# Table: category\n[\n  (id:bigint, Unique identifier for each category. Value examples: ['1', '2'].),\n  (business_id:text, Identifier for the business associated with the category. Value examples: ['abc123', 'def456'].),\n  (category_name:text, Name of the category. Eg 'Bistro', 'Diner', 'Pizza'. Value examples: ['Pizza', 'Cafe'].),\n]\n# Table: checkin\n[\n  (cid:bigint, Unique identifier for the daily check-in count. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the check-in occurred. Value examples: ['abc123', 'def456'].),\n  (count:bigint, Number of check-ins on the given day. Value examples: ['10', '20'].),\n  (day:text, Day of the week when the check-ins occurred. Eg. 'Monday', 'Tuesday', etc.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: neighbourhood\n[\n  (id:bigint, Unique identifier for each neighbourhood. Value examples: ['1', '2', '3'].),\n  (business_id:text, Identifier for each business in the neighbourhood. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (neighbourhood_name:text, Name of the neighbourhood where the business is located. Value examples: ['Downtown', 'Midtown', 'Hollywood'].),\n]\n# Table: review\n[\n  (rid:bigint, The unique identifier for each review.. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business being reviewed.. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (user_id:text, The unique identifier for the user who posted the review.. Value examples: ['1', '2', '3'].),\n  (rating:real, The rating given by the user for the business, on a scale of 1 to 5.. Value examples: ['4.5', '4.2', '3.9'].),\n  (text:text, The text of the review. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Great pizza!', 'Delicious food.', 'Average diner.'].),\n  (year:bigint, The year in which the review was posted.. Value examples: ['2021', '2021', '2021'].),\n  (month:text, The month in which the review was posted. Eg. 'January', 'February', etc.. Value examples: ['January', 'February', 'March'].),\n]\n# Table: tip\n[\n  (tip_id:bigint, Unique identifier for the tip. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the tip was created.. Value examples: ['abc123', 'def456'].),\n  (text:text, Text content of the tip. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Try their pepperoni pizza!', 'Their coffee is amazing.'].),\n  (user_id:text, Unique identifier for the user who created the tip. Value examples: ['1', '2'].),\n  (likes:bigint, Value examples: ['NULL', 'NULL'].),\n  (year:bigint, Year when the tip was created. Value examples: ['2021', '2021'].),\n  (month:text, Month when the tip was created. Eg. 'January', 'February', etc.. Value examples: ['January', 'February'].),\n]\n# Table: users\n[\n  (uid:bigint, Unique identifier for each user. Value examples: ['1', '2', '3', '4'].),\n  (user_id:text, Unique user ID assigned by the system. Value examples: ['1', '2', '3', '4'].),\n  (name:text, Name of the user. Value examples: ['John Doe', 'Jane Smith', 'David Johnson', 'Sarah Williams'].),\n]\n\n【Foreign keys】\nbusiness.business_id = tip.business_id\nbusiness.business_id = review.business_id\nbusiness.business_id = checkin.business_id\nbusiness.business_id = neighbourhood.business_id\nbusiness.business_id = category.business_id\ntip.user_id = users.user_id\nreview.user_id = users.user_id\n\n【参考信息】\n\n\n【用户问题】\nWhat is the total number of check-ins for each business in the state of California?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT business.business_id, business.name, business.bid, SUM(checkin.count) AS total_checkins FROM business JOIN checkin ON business.business_id = checkin.business_id WHERE business.state = 'CA' GROUP BY business.business_id, business.name, business.bid ORDER BY total_checkins DESC NULLS LAST",
        "role": "assistant"
      }
    ],
    "db_name": "yelp",
    "id": 193,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the top 2 categories of businesses with the highest average rating?\n\n【数据库schema】\n【DB_ID】 yelp\n【Schema】\n# Table: business\n[\n  (bid:bigint, The unique identifier for the business. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (name:text, The name of the business. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Joe’s Pizza', 'Peter’s Cafe', 'Anna’s Diner'].),\n  (full_address:text, The full address of the business. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (city:text, The city where the business is located. Value examples: ['San Francisco', 'New York', 'Los Angeles'].),\n  (latitude:text, The latitude of the business location. Value examples: ['37.7749295', '40.712776', '34.052235'].),\n  (longitude:text, The longitude of the business location. Value examples: ['-122.4194155', '-74.005974', '-118.243683'].),\n  (review_count:bigint, The number of reviews for the business. Value examples: ['2', '3', '4'].),\n  (is_open:bigint, Indicates whether the business is currently open or closed (1 for open, 0 for closed). Value examples: ['0', '1', '0'].),\n  (state:text, The US state where the business is located, represented by two-letter abbreviations (eg. 'CA', 'NV', 'NY', etc.). Value examples: ['CA', 'NY', 'CA'].),\n]\n# Table: category\n[\n  (id:bigint, Unique identifier for each category. Value examples: ['1', '2'].),\n  (business_id:text, Identifier for the business associated with the category. Value examples: ['abc123', 'def456'].),\n  (category_name:text, Name of the category. Eg 'Bistro', 'Diner', 'Pizza'. Value examples: ['Pizza', 'Cafe'].),\n]\n# Table: checkin\n[\n  (cid:bigint, Unique identifier for the daily check-in count. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the check-in occurred. Value examples: ['abc123', 'def456'].),\n  (count:bigint, Number of check-ins on the given day. Value examples: ['10', '20'].),\n  (day:text, Day of the week when the check-ins occurred. Eg. 'Monday', 'Tuesday', etc.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: neighbourhood\n[\n  (id:bigint, Unique identifier for each neighbourhood. Value examples: ['1', '2', '3'].),\n  (business_id:text, Identifier for each business in the neighbourhood. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (neighbourhood_name:text, Name of the neighbourhood where the business is located. Value examples: ['Downtown', 'Midtown', 'Hollywood'].),\n]\n# Table: review\n[\n  (rid:bigint, The unique identifier for each review.. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business being reviewed.. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (user_id:text, The unique identifier for the user who posted the review.. Value examples: ['1', '2', '3'].),\n  (rating:real, The rating given by the user for the business, on a scale of 1 to 5.. Value examples: ['4.5', '4.2', '3.9'].),\n  (text:text, The text of the review. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Great pizza!', 'Delicious food.', 'Average diner.'].),\n  (year:bigint, The year in which the review was posted.. Value examples: ['2021', '2021', '2021'].),\n  (month:text, The month in which the review was posted. Eg. 'January', 'February', etc.. Value examples: ['January', 'February', 'March'].),\n]\n# Table: tip\n[\n  (tip_id:bigint, Unique identifier for the tip. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the tip was created.. Value examples: ['abc123', 'def456'].),\n  (text:text, Text content of the tip. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Try their pepperoni pizza!', 'Their coffee is amazing.'].),\n  (user_id:text, Unique identifier for the user who created the tip. Value examples: ['1', '2'].),\n  (likes:bigint, Value examples: ['NULL', 'NULL'].),\n  (year:bigint, Year when the tip was created. Value examples: ['2021', '2021'].),\n  (month:text, Month when the tip was created. Eg. 'January', 'February', etc.. Value examples: ['January', 'February'].),\n]\n# Table: users\n[\n  (uid:bigint, Unique identifier for each user. Value examples: ['1', '2', '3', '4'].),\n  (user_id:text, Unique user ID assigned by the system. Value examples: ['1', '2', '3', '4'].),\n  (name:text, Name of the user. Value examples: ['John Doe', 'Jane Smith', 'David Johnson', 'Sarah Williams'].),\n]\n\n【Foreign keys】\nbusiness.business_id = tip.business_id\nbusiness.business_id = review.business_id\nbusiness.business_id = checkin.business_id\nbusiness.business_id = neighbourhood.business_id\nbusiness.business_id = category.business_id\ntip.user_id = users.user_id\nreview.user_id = users.user_id\n\n【参考信息】\n\n\n【用户问题】\nWhat are the top 2 categories of businesses with the highest average rating?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT category.category_name, category.id FROM (SELECT business.business_id, AVG(review.rating) AS average_rating FROM business JOIN review ON business.business_id = review.business_id GROUP BY business.business_id) AS business_rating JOIN category ON business_rating.business_id = category.business_id GROUP BY category.category_name, category.id ORDER BY AVG(business_rating.average_rating) DESC NULLS LAST LIMIT 2",
        "role": "assistant"
      }
    ],
    "db_name": "yelp",
    "id": 194,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the total number of reviews posted in the year 2021 for businesses in the category \"Cafe\"?\n\n【数据库schema】\n【DB_ID】 yelp\n【Schema】\n# Table: business\n[\n  (bid:bigint, The unique identifier for the business. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (name:text, The name of the business. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Joe’s Pizza', 'Peter’s Cafe', 'Anna’s Diner'].),\n  (full_address:text, The full address of the business. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (city:text, The city where the business is located. Value examples: ['San Francisco', 'New York', 'Los Angeles'].),\n  (latitude:text, The latitude of the business location. Value examples: ['37.7749295', '40.712776', '34.052235'].),\n  (longitude:text, The longitude of the business location. Value examples: ['-122.4194155', '-74.005974', '-118.243683'].),\n  (review_count:bigint, The number of reviews for the business. Value examples: ['2', '3', '4'].),\n  (is_open:bigint, Indicates whether the business is currently open or closed (1 for open, 0 for closed). Value examples: ['0', '1', '0'].),\n  (state:text, The US state where the business is located, represented by two-letter abbreviations (eg. 'CA', 'NV', 'NY', etc.). Value examples: ['CA', 'NY', 'CA'].),\n]\n# Table: category\n[\n  (id:bigint, Unique identifier for each category. Value examples: ['1', '2'].),\n  (business_id:text, Identifier for the business associated with the category. Value examples: ['abc123', 'def456'].),\n  (category_name:text, Name of the category. Eg 'Bistro', 'Diner', 'Pizza'. Value examples: ['Pizza', 'Cafe'].),\n]\n# Table: checkin\n[\n  (cid:bigint, Unique identifier for the daily check-in count. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the check-in occurred. Value examples: ['abc123', 'def456'].),\n  (count:bigint, Number of check-ins on the given day. Value examples: ['10', '20'].),\n  (day:text, Day of the week when the check-ins occurred. Eg. 'Monday', 'Tuesday', etc.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: neighbourhood\n[\n  (id:bigint, Unique identifier for each neighbourhood. Value examples: ['1', '2', '3'].),\n  (business_id:text, Identifier for each business in the neighbourhood. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (neighbourhood_name:text, Name of the neighbourhood where the business is located. Value examples: ['Downtown', 'Midtown', 'Hollywood'].),\n]\n# Table: review\n[\n  (rid:bigint, The unique identifier for each review.. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business being reviewed.. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (user_id:text, The unique identifier for the user who posted the review.. Value examples: ['1', '2', '3'].),\n  (rating:real, The rating given by the user for the business, on a scale of 1 to 5.. Value examples: ['4.5', '4.2', '3.9'].),\n  (text:text, The text of the review. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Great pizza!', 'Delicious food.', 'Average diner.'].),\n  (year:bigint, The year in which the review was posted.. Value examples: ['2021', '2021', '2021'].),\n  (month:text, The month in which the review was posted. Eg. 'January', 'February', etc.. Value examples: ['January', 'February', 'March'].),\n]\n# Table: tip\n[\n  (tip_id:bigint, Unique identifier for the tip. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the tip was created.. Value examples: ['abc123', 'def456'].),\n  (text:text, Text content of the tip. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Try their pepperoni pizza!', 'Their coffee is amazing.'].),\n  (user_id:text, Unique identifier for the user who created the tip. Value examples: ['1', '2'].),\n  (likes:bigint, Value examples: ['NULL', 'NULL'].),\n  (year:bigint, Year when the tip was created. Value examples: ['2021', '2021'].),\n  (month:text, Month when the tip was created. Eg. 'January', 'February', etc.. Value examples: ['January', 'February'].),\n]\n# Table: users\n[\n  (uid:bigint, Unique identifier for each user. Value examples: ['1', '2', '3', '4'].),\n  (user_id:text, Unique user ID assigned by the system. Value examples: ['1', '2', '3', '4'].),\n  (name:text, Name of the user. Value examples: ['John Doe', 'Jane Smith', 'David Johnson', 'Sarah Williams'].),\n]\n\n【Foreign keys】\nbusiness.business_id = tip.business_id\nbusiness.business_id = review.business_id\nbusiness.business_id = checkin.business_id\nbusiness.business_id = neighbourhood.business_id\nbusiness.business_id = category.business_id\ntip.user_id = users.user_id\nreview.user_id = users.user_id\n\n【参考信息】\nFilter strings of users, city, address, business.name using ILIKE with wildcards.\nFilter strings of state using exact upper case matches.\nAssume the rating of a business to be its average rating, and compute it before computing other aggregates on it.\nAlways truncate dates in the question to its current month and year (if applicable) before filtering on `review.year` and `review.month`.\n\n\n【用户问题】\nWhat is the total number of reviews posted in the year 2021 for businesses in the category \"Cafe\"?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT COUNT(review.rid) AS total_reviews FROM review JOIN category ON review.business_id = category.business_id WHERE review.year = 2021 AND category.category_name ILIKE '%Cafe%';",
        "role": "assistant"
      }
    ],
    "db_name": "yelp",
    "id": 195,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the average rating of businesses in the city of San Francisco?\n\n【数据库schema】\n【DB_ID】 yelp\n【Schema】\n# Table: business\n[\n  (bid:bigint, The unique identifier for the business. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (name:text, The name of the business. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Joe’s Pizza', 'Peter’s Cafe', 'Anna’s Diner'].),\n  (full_address:text, The full address of the business. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (city:text, The city where the business is located. Value examples: ['San Francisco', 'New York', 'Los Angeles'].),\n  (latitude:text, The latitude of the business location. Value examples: ['37.7749295', '40.712776', '34.052235'].),\n  (longitude:text, The longitude of the business location. Value examples: ['-122.4194155', '-74.005974', '-118.243683'].),\n  (review_count:bigint, The number of reviews for the business. Value examples: ['2', '3', '4'].),\n  (is_open:bigint, Indicates whether the business is currently open or closed (1 for open, 0 for closed). Value examples: ['0', '1', '0'].),\n  (state:text, The US state where the business is located, represented by two-letter abbreviations (eg. 'CA', 'NV', 'NY', etc.). Value examples: ['CA', 'NY', 'CA'].),\n]\n# Table: category\n[\n  (id:bigint, Unique identifier for each category. Value examples: ['1', '2'].),\n  (business_id:text, Identifier for the business associated with the category. Value examples: ['abc123', 'def456'].),\n  (category_name:text, Name of the category. Eg 'Bistro', 'Diner', 'Pizza'. Value examples: ['Pizza', 'Cafe'].),\n]\n# Table: checkin\n[\n  (cid:bigint, Unique identifier for the daily check-in count. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the check-in occurred. Value examples: ['abc123', 'def456'].),\n  (count:bigint, Number of check-ins on the given day. Value examples: ['10', '20'].),\n  (day:text, Day of the week when the check-ins occurred. Eg. 'Monday', 'Tuesday', etc.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: neighbourhood\n[\n  (id:bigint, Unique identifier for each neighbourhood. Value examples: ['1', '2', '3'].),\n  (business_id:text, Identifier for each business in the neighbourhood. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (neighbourhood_name:text, Name of the neighbourhood where the business is located. Value examples: ['Downtown', 'Midtown', 'Hollywood'].),\n]\n# Table: review\n[\n  (rid:bigint, The unique identifier for each review.. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business being reviewed.. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (user_id:text, The unique identifier for the user who posted the review.. Value examples: ['1', '2', '3'].),\n  (rating:real, The rating given by the user for the business, on a scale of 1 to 5.. Value examples: ['4.5', '4.2', '3.9'].),\n  (text:text, The text of the review. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Great pizza!', 'Delicious food.', 'Average diner.'].),\n  (year:bigint, The year in which the review was posted.. Value examples: ['2021', '2021', '2021'].),\n  (month:text, The month in which the review was posted. Eg. 'January', 'February', etc.. Value examples: ['January', 'February', 'March'].),\n]\n# Table: tip\n[\n  (tip_id:bigint, Unique identifier for the tip. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the tip was created.. Value examples: ['abc123', 'def456'].),\n  (text:text, Text content of the tip. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Try their pepperoni pizza!', 'Their coffee is amazing.'].),\n  (user_id:text, Unique identifier for the user who created the tip. Value examples: ['1', '2'].),\n  (likes:bigint, Value examples: ['NULL', 'NULL'].),\n  (year:bigint, Year when the tip was created. Value examples: ['2021', '2021'].),\n  (month:text, Month when the tip was created. Eg. 'January', 'February', etc.. Value examples: ['January', 'February'].),\n]\n# Table: users\n[\n  (uid:bigint, Unique identifier for each user. Value examples: ['1', '2', '3', '4'].),\n  (user_id:text, Unique user ID assigned by the system. Value examples: ['1', '2', '3', '4'].),\n  (name:text, Name of the user. Value examples: ['John Doe', 'Jane Smith', 'David Johnson', 'Sarah Williams'].),\n]\n\n【Foreign keys】\nbusiness.business_id = tip.business_id\nbusiness.business_id = review.business_id\nbusiness.business_id = checkin.business_id\nbusiness.business_id = neighbourhood.business_id\nbusiness.business_id = category.business_id\ntip.user_id = users.user_id\nreview.user_id = users.user_id\n\n【参考信息】\nFilter strings of users, city, address, business.name using ILIKE with wildcards.\nFilter strings of state using exact upper case matches.\nThe rating of businesses in a city refers to the average rating of the businesses in that city. I.e., you must compute the average rating of each business before computing the average rating of businesses in the city.\nAlways truncate dates in the question to its current month and year (if applicable) before filtering on `review.year` and `review.month`.\n\n\n【用户问题】\nWhat is the average rating of businesses in the city of San Francisco?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT AVG(sf.average_rating) AS sf_average_rating FROM (SELECT business.business_id, AVG(review.rating) AS average_rating FROM business JOIN review ON business.business_id = review.business_id WHERE LOWER(business.city) ILIKE '%san francisco%' GROUP BY business.business_id) AS sf;",
        "role": "assistant"
      }
    ],
    "db_name": "yelp",
    "id": 196,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many reviews were posted for each business id in the year 2021?\n\n【数据库schema】\n【DB_ID】 yelp\n【Schema】\n# Table: business\n[\n  (bid:bigint, The unique identifier for the business. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (name:text, The name of the business. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Joe’s Pizza', 'Peter’s Cafe', 'Anna’s Diner'].),\n  (full_address:text, The full address of the business. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (city:text, The city where the business is located. Value examples: ['San Francisco', 'New York', 'Los Angeles'].),\n  (latitude:text, The latitude of the business location. Value examples: ['37.7749295', '40.712776', '34.052235'].),\n  (longitude:text, The longitude of the business location. Value examples: ['-122.4194155', '-74.005974', '-118.243683'].),\n  (review_count:bigint, The number of reviews for the business. Value examples: ['2', '3', '4'].),\n  (is_open:bigint, Indicates whether the business is currently open or closed (1 for open, 0 for closed). Value examples: ['0', '1', '0'].),\n  (state:text, The US state where the business is located, represented by two-letter abbreviations (eg. 'CA', 'NV', 'NY', etc.). Value examples: ['CA', 'NY', 'CA'].),\n]\n# Table: category\n[\n  (id:bigint, Unique identifier for each category. Value examples: ['1', '2'].),\n  (business_id:text, Identifier for the business associated with the category. Value examples: ['abc123', 'def456'].),\n  (category_name:text, Name of the category. Eg 'Bistro', 'Diner', 'Pizza'. Value examples: ['Pizza', 'Cafe'].),\n]\n# Table: checkin\n[\n  (cid:bigint, Unique identifier for the daily check-in count. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the check-in occurred. Value examples: ['abc123', 'def456'].),\n  (count:bigint, Number of check-ins on the given day. Value examples: ['10', '20'].),\n  (day:text, Day of the week when the check-ins occurred. Eg. 'Monday', 'Tuesday', etc.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: neighbourhood\n[\n  (id:bigint, Unique identifier for each neighbourhood. Value examples: ['1', '2', '3'].),\n  (business_id:text, Identifier for each business in the neighbourhood. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (neighbourhood_name:text, Name of the neighbourhood where the business is located. Value examples: ['Downtown', 'Midtown', 'Hollywood'].),\n]\n# Table: review\n[\n  (rid:bigint, The unique identifier for each review.. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business being reviewed.. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (user_id:text, The unique identifier for the user who posted the review.. Value examples: ['1', '2', '3'].),\n  (rating:real, The rating given by the user for the business, on a scale of 1 to 5.. Value examples: ['4.5', '4.2', '3.9'].),\n  (text:text, The text of the review. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Great pizza!', 'Delicious food.', 'Average diner.'].),\n  (year:bigint, The year in which the review was posted.. Value examples: ['2021', '2021', '2021'].),\n  (month:text, The month in which the review was posted. Eg. 'January', 'February', etc.. Value examples: ['January', 'February', 'March'].),\n]\n# Table: tip\n[\n  (tip_id:bigint, Unique identifier for the tip. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the tip was created.. Value examples: ['abc123', 'def456'].),\n  (text:text, Text content of the tip. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Try their pepperoni pizza!', 'Their coffee is amazing.'].),\n  (user_id:text, Unique identifier for the user who created the tip. Value examples: ['1', '2'].),\n  (likes:bigint, Value examples: ['NULL', 'NULL'].),\n  (year:bigint, Year when the tip was created. Value examples: ['2021', '2021'].),\n  (month:text, Month when the tip was created. Eg. 'January', 'February', etc.. Value examples: ['January', 'February'].),\n]\n# Table: users\n[\n  (uid:bigint, Unique identifier for each user. Value examples: ['1', '2', '3', '4'].),\n  (user_id:text, Unique user ID assigned by the system. Value examples: ['1', '2', '3', '4'].),\n  (name:text, Name of the user. Value examples: ['John Doe', 'Jane Smith', 'David Johnson', 'Sarah Williams'].),\n]\n\n【Foreign keys】\nbusiness.business_id = tip.business_id\nbusiness.business_id = review.business_id\nbusiness.business_id = checkin.business_id\nbusiness.business_id = neighbourhood.business_id\nbusiness.business_id = category.business_id\ntip.user_id = users.user_id\nreview.user_id = users.user_id\n\n【参考信息】\nFilter strings of users, city, address, business.name using ILIKE with wildcards.\nFilter strings of state using exact upper case matches.\nAssume the rating of a business to be its average rating, and compute it before computing other aggregates on it.\nAlways truncate dates in the question to its current month and year (if applicable) before filtering on `review.year` and `review.month`.\n\n\n【用户问题】\nHow many reviews were posted for each business id in the year 2021?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT review.business_id, COUNT(*) AS review_count FROM review WHERE review.year = 2021 GROUP BY review.business_id ORDER BY review_count DESC NULLS LAST;",
        "role": "assistant"
      }
    ],
    "db_name": "yelp",
    "id": 197,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many reviews were posted by users with the name \"Sarah Williams\" in the month of April 2021?\n\n【数据库schema】\n【DB_ID】 yelp\n【Schema】\n# Table: business\n[\n  (bid:bigint, The unique identifier for the business. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (name:text, The name of the business. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Joe’s Pizza', 'Peter’s Cafe', 'Anna’s Diner'].),\n  (full_address:text, The full address of the business. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (city:text, The city where the business is located. Value examples: ['San Francisco', 'New York', 'Los Angeles'].),\n  (latitude:text, The latitude of the business location. Value examples: ['37.7749295', '40.712776', '34.052235'].),\n  (longitude:text, The longitude of the business location. Value examples: ['-122.4194155', '-74.005974', '-118.243683'].),\n  (review_count:bigint, The number of reviews for the business. Value examples: ['2', '3', '4'].),\n  (is_open:bigint, Indicates whether the business is currently open or closed (1 for open, 0 for closed). Value examples: ['0', '1', '0'].),\n  (state:text, The US state where the business is located, represented by two-letter abbreviations (eg. 'CA', 'NV', 'NY', etc.). Value examples: ['CA', 'NY', 'CA'].),\n]\n# Table: category\n[\n  (id:bigint, Unique identifier for each category. Value examples: ['1', '2'].),\n  (business_id:text, Identifier for the business associated with the category. Value examples: ['abc123', 'def456'].),\n  (category_name:text, Name of the category. Eg 'Bistro', 'Diner', 'Pizza'. Value examples: ['Pizza', 'Cafe'].),\n]\n# Table: checkin\n[\n  (cid:bigint, Unique identifier for the daily check-in count. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the check-in occurred. Value examples: ['abc123', 'def456'].),\n  (count:bigint, Number of check-ins on the given day. Value examples: ['10', '20'].),\n  (day:text, Day of the week when the check-ins occurred. Eg. 'Monday', 'Tuesday', etc.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: neighbourhood\n[\n  (id:bigint, Unique identifier for each neighbourhood. Value examples: ['1', '2', '3'].),\n  (business_id:text, Identifier for each business in the neighbourhood. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (neighbourhood_name:text, Name of the neighbourhood where the business is located. Value examples: ['Downtown', 'Midtown', 'Hollywood'].),\n]\n# Table: review\n[\n  (rid:bigint, The unique identifier for each review.. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business being reviewed.. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (user_id:text, The unique identifier for the user who posted the review.. Value examples: ['1', '2', '3'].),\n  (rating:real, The rating given by the user for the business, on a scale of 1 to 5.. Value examples: ['4.5', '4.2', '3.9'].),\n  (text:text, The text of the review. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Great pizza!', 'Delicious food.', 'Average diner.'].),\n  (year:bigint, The year in which the review was posted.. Value examples: ['2021', '2021', '2021'].),\n  (month:text, The month in which the review was posted. Eg. 'January', 'February', etc.. Value examples: ['January', 'February', 'March'].),\n]\n# Table: tip\n[\n  (tip_id:bigint, Unique identifier for the tip. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the tip was created.. Value examples: ['abc123', 'def456'].),\n  (text:text, Text content of the tip. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Try their pepperoni pizza!', 'Their coffee is amazing.'].),\n  (user_id:text, Unique identifier for the user who created the tip. Value examples: ['1', '2'].),\n  (likes:bigint, Value examples: ['NULL', 'NULL'].),\n  (year:bigint, Year when the tip was created. Value examples: ['2021', '2021'].),\n  (month:text, Month when the tip was created. Eg. 'January', 'February', etc.. Value examples: ['January', 'February'].),\n]\n# Table: users\n[\n  (uid:bigint, Unique identifier for each user. Value examples: ['1', '2', '3', '4'].),\n  (user_id:text, Unique user ID assigned by the system. Value examples: ['1', '2', '3', '4'].),\n  (name:text, Name of the user. Value examples: ['John Doe', 'Jane Smith', 'David Johnson', 'Sarah Williams'].),\n]\n\n【Foreign keys】\nbusiness.business_id = tip.business_id\nbusiness.business_id = review.business_id\nbusiness.business_id = checkin.business_id\nbusiness.business_id = neighbourhood.business_id\nbusiness.business_id = category.business_id\ntip.user_id = users.user_id\nreview.user_id = users.user_id\n\n【参考信息】\nFilter strings of users, city, address, business.name using ILIKE with wildcards.\nFilter strings of state using exact upper case matches.\nAssume the rating of a business to be its average rating, and compute it before computing other aggregates on it.\nAlways truncate dates in the question to its current month and year (if applicable) before filtering on `review.year` and `review.month`.\n\n\n【用户问题】\nHow many reviews were posted by users with the name \"Sarah Williams\" in the month of April 2021?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT COUNT(*) FROM review JOIN users ON review.user_id = users.user_id WHERE users.name ILIKE '%Sarah Williams%' AND review.month = 'April' AND review.year = 2021;",
        "role": "assistant"
      }
    ],
    "db_name": "yelp",
    "id": 198,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many check-ins occurred on Mondays at businesses in the state of California?\n\n【数据库schema】\n【DB_ID】 yelp\n【Schema】\n# Table: business\n[\n  (bid:bigint, The unique identifier for the business. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (name:text, The name of the business. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Joe’s Pizza', 'Peter’s Cafe', 'Anna’s Diner'].),\n  (full_address:text, The full address of the business. Value examples: ['123 Main St', '456 Elm St', '789 Oak St'].),\n  (city:text, The city where the business is located. Value examples: ['San Francisco', 'New York', 'Los Angeles'].),\n  (latitude:text, The latitude of the business location. Value examples: ['37.7749295', '40.712776', '34.052235'].),\n  (longitude:text, The longitude of the business location. Value examples: ['-122.4194155', '-74.005974', '-118.243683'].),\n  (review_count:bigint, The number of reviews for the business. Value examples: ['2', '3', '4'].),\n  (is_open:bigint, Indicates whether the business is currently open or closed (1 for open, 0 for closed). Value examples: ['0', '1', '0'].),\n  (state:text, The US state where the business is located, represented by two-letter abbreviations (eg. 'CA', 'NV', 'NY', etc.). Value examples: ['CA', 'NY', 'CA'].),\n]\n# Table: category\n[\n  (id:bigint, Unique identifier for each category. Value examples: ['1', '2'].),\n  (business_id:text, Identifier for the business associated with the category. Value examples: ['abc123', 'def456'].),\n  (category_name:text, Name of the category. Eg 'Bistro', 'Diner', 'Pizza'. Value examples: ['Pizza', 'Cafe'].),\n]\n# Table: checkin\n[\n  (cid:bigint, Unique identifier for the daily check-in count. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the check-in occurred. Value examples: ['abc123', 'def456'].),\n  (count:bigint, Number of check-ins on the given day. Value examples: ['10', '20'].),\n  (day:text, Day of the week when the check-ins occurred. Eg. 'Monday', 'Tuesday', etc.. Value examples: ['Monday', 'Tuesday'].),\n]\n# Table: neighbourhood\n[\n  (id:bigint, Unique identifier for each neighbourhood. Value examples: ['1', '2', '3'].),\n  (business_id:text, Identifier for each business in the neighbourhood. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (neighbourhood_name:text, Name of the neighbourhood where the business is located. Value examples: ['Downtown', 'Midtown', 'Hollywood'].),\n]\n# Table: review\n[\n  (rid:bigint, The unique identifier for each review.. Value examples: ['1', '2', '3'].),\n  (business_id:text, The unique identifier for the business being reviewed.. Value examples: ['abc123', 'def456', 'ghi789'].),\n  (user_id:text, The unique identifier for the user who posted the review.. Value examples: ['1', '2', '3'].),\n  (rating:real, The rating given by the user for the business, on a scale of 1 to 5.. Value examples: ['4.5', '4.2', '3.9'].),\n  (text:text, The text of the review. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Great pizza!', 'Delicious food.', 'Average diner.'].),\n  (year:bigint, The year in which the review was posted.. Value examples: ['2021', '2021', '2021'].),\n  (month:text, The month in which the review was posted. Eg. 'January', 'February', etc.. Value examples: ['January', 'February', 'March'].),\n]\n# Table: tip\n[\n  (tip_id:bigint, Unique identifier for the tip. Value examples: ['1', '2'].),\n  (business_id:text, Unique identifier for the business where the tip was created.. Value examples: ['abc123', 'def456'].),\n  (text:text, Text content of the tip. All apostrophes use ’ instead of ' to avoid SQL errors.. Value examples: ['Try their pepperoni pizza!', 'Their coffee is amazing.'].),\n  (user_id:text, Unique identifier for the user who created the tip. Value examples: ['1', '2'].),\n  (likes:bigint, Value examples: ['NULL', 'NULL'].),\n  (year:bigint, Year when the tip was created. Value examples: ['2021', '2021'].),\n  (month:text, Month when the tip was created. Eg. 'January', 'February', etc.. Value examples: ['January', 'February'].),\n]\n# Table: users\n[\n  (uid:bigint, Unique identifier for each user. Value examples: ['1', '2', '3', '4'].),\n  (user_id:text, Unique user ID assigned by the system. Value examples: ['1', '2', '3', '4'].),\n  (name:text, Name of the user. Value examples: ['John Doe', 'Jane Smith', 'David Johnson', 'Sarah Williams'].),\n]\n\n【Foreign keys】\nbusiness.business_id = tip.business_id\nbusiness.business_id = review.business_id\nbusiness.business_id = checkin.business_id\nbusiness.business_id = neighbourhood.business_id\nbusiness.business_id = category.business_id\ntip.user_id = users.user_id\nreview.user_id = users.user_id\n\n【参考信息】\nFilter strings of users, city, address, business.name using ILIKE with wildcards.\nFilter strings of state using exact upper case matches.\nAssume the rating of a business to be its average rating, and compute it before computing other aggregates on it.\nAlways truncate dates in the question to its current month and year (if applicable) before filtering on `review.year` and `review.month`.\n\n\n【用户问题】\nHow many check-ins occurred on Mondays at businesses in the state of California?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT SUM(checkin.count) AS total_checkins FROM business JOIN checkin ON business.business_id = checkin.business_id WHERE business.state = 'CA' AND checkin.day ILIKE '%Monday%';",
        "role": "assistant"
      }
    ],
    "db_name": "yelp",
    "id": 199,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the top 5 countries by total transaction amount in the past 30 days, inclusive of 30 days ago? Return the country name, number of transactions and total transaction amount.\n\n【数据库schema】\n【DB_ID】 broker\n【Schema】\n# Table: sbCustomer\n[\n  (sbCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbCustName:varchar, Value examples: ['john doe', 'Jane Smith', 'Bob Johnson'].),\n  (sbCustEmail:varchar, Value examples: ['john.doe@email.com', 'jane.smith@email.com', 'bob.johnson@email.com'].),\n  (sbCustPhone:varchar, Value examples: ['555-123-4567', '555-987-6543', '555-246-8135'].),\n  (sbCustAddress1:varchar, Value examples: ['123 Main St', '456 Oak Rd', '789 Pine Ave'].),\n  (sbCustAddress2:varchar,),\n  (sbCustCity:varchar, Value examples: ['Anytown', 'Someville', 'Mytown'].),\n  (sbCustState:varchar, Value examples: ['CA', 'NY', 'TX'].),\n  (sbCustCountry:varchar, Value examples: ['USA', 'USA', 'USA'].),\n  (sbCustPostalCode:varchar, Value examples: ['90001', '10002', '75000'].),\n  (sbCustJoinDate:date, Value examples: ['2020-01-01', '2019-03-15', '2022-06-01'].),\n  (sbCustStatus:varchar, possible values: active, inactive, suspended, closed. Value examples: ['active', 'active', 'inactive'].),\n]\n# Table: sbTicker\n[\n  (sbTickerId:varchar, Value examples: ['T001', 'T002', 'T005'].),\n  (sbTickerSymbol:varchar, Value examples: ['AAPL', 'MSFT', 'GOOGL'].),\n  (sbTickerName:varchar, Value examples: ['Apple Inc.', 'Microsoft Corporation', 'Alphabet Inc.'].),\n  (sbTickerType:varchar, possible values: stock, etf, mutualfund. Value examples: ['stock', 'stock', 'stock'].),\n  (sbTickerExchange:varchar, Value examples: ['NASDAQ', 'NASDAQ', 'NASDAQ'].),\n  (sbTickerCurrency:varchar, Value examples: ['USD', 'USD', 'USD'].),\n  (sbTickerDb2x:varchar, 2 letter exchange code. Value examples: ['NQ', 'NQ', 'NQ'].),\n  (sbTickerIsActive:boolean, Value examples: ['true', 'true', 'true'].),\n]\n# Table: sbDailyPrice\n[\n  (sbDpTickerId:varchar, Value examples: ['T001', 'T002'].),\n  (sbDpDate:date, Value examples: ['2023-04-01', '2023-04-01'].),\n  (sbDpOpen:numeric, Value examples: ['150.00', '280.00'].),\n  (sbDpHigh:numeric, Value examples: ['152.50', '282.75'].),\n  (sbDpLow:numeric, Value examples: ['148.75', '279.50'].),\n  (sbDpClose:numeric, Value examples: ['151.25', '281.00'].),\n  (sbDpVolume:bigint, Value examples: ['75000000', '35000000'].),\n  (sbDpEpochMs:bigint, epoch milliseconds for timestamp. Value examples: ['1680336000000', '1680336000000'].),\n  (sbDpSource:varchar, Value examples: ['NYSE', 'NASDAQ'].),\n]\n# Table: sbTransaction\n[\n  (sbTxId:varchar, Value examples: ['TX001', 'TX002', 'TX003'].),\n  (sbTxCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbTxTickerId:varchar, Value examples: ['T001', 'T002', 'T003'].),\n  (sbTxDateTime:timestamp, Value examples: ['2023-04-01 09:30:00', '2023-04-01 10:15:00', '2023-04-01 11:00:00'].),\n  (sbTxType:varchar, possible values: buy, sell. Value examples: ['buy', 'sell', 'buy'].),\n  (sbTxShares:numeric, Value examples: ['100', '50', '10'].),\n  (sbTxPrice:numeric, Value examples: ['150.00', '280.00', '3200.00'].),\n  (sbTxAmount:numeric, Value examples: ['15000.00', '14000.00', '32000.00'].),\n  (sbTxCcy:varchar, transaction currency. Value examples: ['USD', 'USD', 'USD'].),\n  (sbTxTax:numeric, Value examples: ['75.00', '70.00', '160.00'].),\n  (sbTxCommission:numeric, Value examples: ['10.00', '10.00', '20.00'].),\n  (sbTxKpx:varchar, internal code. Value examples: ['KP001', 'KP002', 'KP003'].),\n  (sbTxSettlementDateStr:varchar, settlement date as string in yyyyMMdd HH:mm:ss format. NULL if not settled. Value examples: ['20230401 09:30:00', '20230401 10:15:00', '20230401 11:00:00'].),\n  (sbTxStatus:varchar, possible values: success, fail, pending. Value examples: ['success', 'success', 'success'].),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nWhat are the top 5 countries by total transaction amount in the past 30 days, inclusive of 30 days ago? Return the country name, number of transactions and total transaction amount.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT c.sbCustCountry, COUNT(t.sbTxId) AS num_transactions, SUM(t.sbTxAmount) AS total_amount FROM sbCustomer c JOIN sbTransaction t ON c.sbCustId = t.sbTxCustId WHERE t.sbTxDateTime >= CURRENT_DATE - INTERVAL '30 days' GROUP BY c.sbCustCountry ORDER BY total_amount DESC LIMIT 5",
        "role": "assistant"
      }
    ],
    "db_name": "broker",
    "id": 200,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many distinct customers made each type of transaction between Jan 1, 2023 and Mar 31, 2023 (inclusive of start and end dates)? Return the transaction type, number of distinct customers and average number of shares, for the top 3 transaction types by number of customers.\n\n【数据库schema】\n【DB_ID】 broker\n【Schema】\n# Table: sbCustomer\n[\n  (sbCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbCustName:varchar, Value examples: ['john doe', 'Jane Smith', 'Bob Johnson'].),\n  (sbCustEmail:varchar, Value examples: ['john.doe@email.com', 'jane.smith@email.com', 'bob.johnson@email.com'].),\n  (sbCustPhone:varchar, Value examples: ['555-123-4567', '555-987-6543', '555-246-8135'].),\n  (sbCustAddress1:varchar, Value examples: ['123 Main St', '456 Oak Rd', '789 Pine Ave'].),\n  (sbCustAddress2:varchar,),\n  (sbCustCity:varchar, Value examples: ['Anytown', 'Someville', 'Mytown'].),\n  (sbCustState:varchar, Value examples: ['CA', 'NY', 'TX'].),\n  (sbCustCountry:varchar, Value examples: ['USA', 'USA', 'USA'].),\n  (sbCustPostalCode:varchar, Value examples: ['90001', '10002', '75000'].),\n  (sbCustJoinDate:date, Value examples: ['2020-01-01', '2019-03-15', '2022-06-01'].),\n  (sbCustStatus:varchar, possible values: active, inactive, suspended, closed. Value examples: ['active', 'active', 'inactive'].),\n]\n# Table: sbTicker\n[\n  (sbTickerId:varchar, Value examples: ['T001', 'T002', 'T005'].),\n  (sbTickerSymbol:varchar, Value examples: ['AAPL', 'MSFT', 'GOOGL'].),\n  (sbTickerName:varchar, Value examples: ['Apple Inc.', 'Microsoft Corporation', 'Alphabet Inc.'].),\n  (sbTickerType:varchar, possible values: stock, etf, mutualfund. Value examples: ['stock', 'stock', 'stock'].),\n  (sbTickerExchange:varchar, Value examples: ['NASDAQ', 'NASDAQ', 'NASDAQ'].),\n  (sbTickerCurrency:varchar, Value examples: ['USD', 'USD', 'USD'].),\n  (sbTickerDb2x:varchar, 2 letter exchange code. Value examples: ['NQ', 'NQ', 'NQ'].),\n  (sbTickerIsActive:boolean, Value examples: ['true', 'true', 'true'].),\n]\n# Table: sbDailyPrice\n[\n  (sbDpTickerId:varchar, Value examples: ['T001', 'T002'].),\n  (sbDpDate:date, Value examples: ['2023-04-01', '2023-04-01'].),\n  (sbDpOpen:numeric, Value examples: ['150.00', '280.00'].),\n  (sbDpHigh:numeric, Value examples: ['152.50', '282.75'].),\n  (sbDpLow:numeric, Value examples: ['148.75', '279.50'].),\n  (sbDpClose:numeric, Value examples: ['151.25', '281.00'].),\n  (sbDpVolume:bigint, Value examples: ['75000000', '35000000'].),\n  (sbDpEpochMs:bigint, epoch milliseconds for timestamp. Value examples: ['1680336000000', '1680336000000'].),\n  (sbDpSource:varchar, Value examples: ['NYSE', 'NASDAQ'].),\n]\n# Table: sbTransaction\n[\n  (sbTxId:varchar, Value examples: ['TX001', 'TX002', 'TX003'].),\n  (sbTxCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbTxTickerId:varchar, Value examples: ['T001', 'T002', 'T003'].),\n  (sbTxDateTime:timestamp, Value examples: ['2023-04-01 09:30:00', '2023-04-01 10:15:00', '2023-04-01 11:00:00'].),\n  (sbTxType:varchar, possible values: buy, sell. Value examples: ['buy', 'sell', 'buy'].),\n  (sbTxShares:numeric, Value examples: ['100', '50', '10'].),\n  (sbTxPrice:numeric, Value examples: ['150.00', '280.00', '3200.00'].),\n  (sbTxAmount:numeric, Value examples: ['15000.00', '14000.00', '32000.00'].),\n  (sbTxCcy:varchar, transaction currency. Value examples: ['USD', 'USD', 'USD'].),\n  (sbTxTax:numeric, Value examples: ['75.00', '70.00', '160.00'].),\n  (sbTxCommission:numeric, Value examples: ['10.00', '10.00', '20.00'].),\n  (sbTxKpx:varchar, internal code. Value examples: ['KP001', 'KP002', 'KP003'].),\n  (sbTxSettlementDateStr:varchar, settlement date as string in yyyyMMdd HH:mm:ss format. NULL if not settled. Value examples: ['20230401 09:30:00', '20230401 10:15:00', '20230401 11:00:00'].),\n  (sbTxStatus:varchar, possible values: success, fail, pending. Value examples: ['success', 'success', 'success'].),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nHow many distinct customers made each type of transaction between Jan 1, 2023 and Mar 31, 2023 (inclusive of start and end dates)? Return the transaction type, number of distinct customers and average number of shares, for the top 3 transaction types by number of customers.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT t.sbTxType, COUNT(DISTINCT t.sbTxCustId) AS num_customers, AVG(t.sbTxShares) AS avg_shares FROM sbTransaction t WHERE t.sbTxDateTime BETWEEN '2023-01-01' AND '2023-03-31 23:59:59' GROUP BY t.sbTxType ORDER BY num_customers DESC LIMIT 3",
        "role": "assistant"
      }
    ],
    "db_name": "broker",
    "id": 201,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the top 10 ticker symbols by total transaction amount? Return the ticker symbol, number of transactions and total transaction amount.\n\n【数据库schema】\n【DB_ID】 broker\n【Schema】\n# Table: sbCustomer\n[\n  (sbCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbCustName:varchar, Value examples: ['john doe', 'Jane Smith', 'Bob Johnson'].),\n  (sbCustEmail:varchar, Value examples: ['john.doe@email.com', 'jane.smith@email.com', 'bob.johnson@email.com'].),\n  (sbCustPhone:varchar, Value examples: ['555-123-4567', '555-987-6543', '555-246-8135'].),\n  (sbCustAddress1:varchar, Value examples: ['123 Main St', '456 Oak Rd', '789 Pine Ave'].),\n  (sbCustAddress2:varchar,),\n  (sbCustCity:varchar, Value examples: ['Anytown', 'Someville', 'Mytown'].),\n  (sbCustState:varchar, Value examples: ['CA', 'NY', 'TX'].),\n  (sbCustCountry:varchar, Value examples: ['USA', 'USA', 'USA'].),\n  (sbCustPostalCode:varchar, Value examples: ['90001', '10002', '75000'].),\n  (sbCustJoinDate:date, Value examples: ['2020-01-01', '2019-03-15', '2022-06-01'].),\n  (sbCustStatus:varchar, possible values: active, inactive, suspended, closed. Value examples: ['active', 'active', 'inactive'].),\n]\n# Table: sbTicker\n[\n  (sbTickerId:varchar, Value examples: ['T001', 'T002', 'T005'].),\n  (sbTickerSymbol:varchar, Value examples: ['AAPL', 'MSFT', 'GOOGL'].),\n  (sbTickerName:varchar, Value examples: ['Apple Inc.', 'Microsoft Corporation', 'Alphabet Inc.'].),\n  (sbTickerType:varchar, possible values: stock, etf, mutualfund. Value examples: ['stock', 'stock', 'stock'].),\n  (sbTickerExchange:varchar, Value examples: ['NASDAQ', 'NASDAQ', 'NASDAQ'].),\n  (sbTickerCurrency:varchar, Value examples: ['USD', 'USD', 'USD'].),\n  (sbTickerDb2x:varchar, 2 letter exchange code. Value examples: ['NQ', 'NQ', 'NQ'].),\n  (sbTickerIsActive:boolean, Value examples: ['true', 'true', 'true'].),\n]\n# Table: sbDailyPrice\n[\n  (sbDpTickerId:varchar, Value examples: ['T001', 'T002'].),\n  (sbDpDate:date, Value examples: ['2023-04-01', '2023-04-01'].),\n  (sbDpOpen:numeric, Value examples: ['150.00', '280.00'].),\n  (sbDpHigh:numeric, Value examples: ['152.50', '282.75'].),\n  (sbDpLow:numeric, Value examples: ['148.75', '279.50'].),\n  (sbDpClose:numeric, Value examples: ['151.25', '281.00'].),\n  (sbDpVolume:bigint, Value examples: ['75000000', '35000000'].),\n  (sbDpEpochMs:bigint, epoch milliseconds for timestamp. Value examples: ['1680336000000', '1680336000000'].),\n  (sbDpSource:varchar, Value examples: ['NYSE', 'NASDAQ'].),\n]\n# Table: sbTransaction\n[\n  (sbTxId:varchar, Value examples: ['TX001', 'TX002', 'TX003'].),\n  (sbTxCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbTxTickerId:varchar, Value examples: ['T001', 'T002', 'T003'].),\n  (sbTxDateTime:timestamp, Value examples: ['2023-04-01 09:30:00', '2023-04-01 10:15:00', '2023-04-01 11:00:00'].),\n  (sbTxType:varchar, possible values: buy, sell. Value examples: ['buy', 'sell', 'buy'].),\n  (sbTxShares:numeric, Value examples: ['100', '50', '10'].),\n  (sbTxPrice:numeric, Value examples: ['150.00', '280.00', '3200.00'].),\n  (sbTxAmount:numeric, Value examples: ['15000.00', '14000.00', '32000.00'].),\n  (sbTxCcy:varchar, transaction currency. Value examples: ['USD', 'USD', 'USD'].),\n  (sbTxTax:numeric, Value examples: ['75.00', '70.00', '160.00'].),\n  (sbTxCommission:numeric, Value examples: ['10.00', '10.00', '20.00'].),\n  (sbTxKpx:varchar, internal code. Value examples: ['KP001', 'KP002', 'KP003'].),\n  (sbTxSettlementDateStr:varchar, settlement date as string in yyyyMMdd HH:mm:ss format. NULL if not settled. Value examples: ['20230401 09:30:00', '20230401 10:15:00', '20230401 11:00:00'].),\n  (sbTxStatus:varchar, possible values: success, fail, pending. Value examples: ['success', 'success', 'success'].),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nWhat are the top 10 ticker symbols by total transaction amount? Return the ticker symbol, number of transactions and total transaction amount.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT tk.sbTickerSymbol, COUNT(tx.sbTxId) AS num_transactions, SUM(tx.sbTxAmount) AS total_amount FROM sbTicker tk JOIN sbTransaction tx ON tk.sbTickerId = tx.sbTxTickerId GROUP BY tk.sbTickerSymbol ORDER BY total_amount DESC LIMIT 10",
        "role": "assistant"
      }
    ],
    "db_name": "broker",
    "id": 202,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the top 5 combinations of customer state and ticker type by number of transactions? Return the customer state, ticker type and number of transactions.\n\n【数据库schema】\n【DB_ID】 broker\n【Schema】\n# Table: sbCustomer\n[\n  (sbCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbCustName:varchar, Value examples: ['john doe', 'Jane Smith', 'Bob Johnson'].),\n  (sbCustEmail:varchar, Value examples: ['john.doe@email.com', 'jane.smith@email.com', 'bob.johnson@email.com'].),\n  (sbCustPhone:varchar, Value examples: ['555-123-4567', '555-987-6543', '555-246-8135'].),\n  (sbCustAddress1:varchar, Value examples: ['123 Main St', '456 Oak Rd', '789 Pine Ave'].),\n  (sbCustAddress2:varchar,),\n  (sbCustCity:varchar, Value examples: ['Anytown', 'Someville', 'Mytown'].),\n  (sbCustState:varchar, Value examples: ['CA', 'NY', 'TX'].),\n  (sbCustCountry:varchar, Value examples: ['USA', 'USA', 'USA'].),\n  (sbCustPostalCode:varchar, Value examples: ['90001', '10002', '75000'].),\n  (sbCustJoinDate:date, Value examples: ['2020-01-01', '2019-03-15', '2022-06-01'].),\n  (sbCustStatus:varchar, possible values: active, inactive, suspended, closed. Value examples: ['active', 'active', 'inactive'].),\n]\n# Table: sbTicker\n[\n  (sbTickerId:varchar, Value examples: ['T001', 'T002', 'T005'].),\n  (sbTickerSymbol:varchar, Value examples: ['AAPL', 'MSFT', 'GOOGL'].),\n  (sbTickerName:varchar, Value examples: ['Apple Inc.', 'Microsoft Corporation', 'Alphabet Inc.'].),\n  (sbTickerType:varchar, possible values: stock, etf, mutualfund. Value examples: ['stock', 'stock', 'stock'].),\n  (sbTickerExchange:varchar, Value examples: ['NASDAQ', 'NASDAQ', 'NASDAQ'].),\n  (sbTickerCurrency:varchar, Value examples: ['USD', 'USD', 'USD'].),\n  (sbTickerDb2x:varchar, 2 letter exchange code. Value examples: ['NQ', 'NQ', 'NQ'].),\n  (sbTickerIsActive:boolean, Value examples: ['true', 'true', 'true'].),\n]\n# Table: sbDailyPrice\n[\n  (sbDpTickerId:varchar, Value examples: ['T001', 'T002'].),\n  (sbDpDate:date, Value examples: ['2023-04-01', '2023-04-01'].),\n  (sbDpOpen:numeric, Value examples: ['150.00', '280.00'].),\n  (sbDpHigh:numeric, Value examples: ['152.50', '282.75'].),\n  (sbDpLow:numeric, Value examples: ['148.75', '279.50'].),\n  (sbDpClose:numeric, Value examples: ['151.25', '281.00'].),\n  (sbDpVolume:bigint, Value examples: ['75000000', '35000000'].),\n  (sbDpEpochMs:bigint, epoch milliseconds for timestamp. Value examples: ['1680336000000', '1680336000000'].),\n  (sbDpSource:varchar, Value examples: ['NYSE', 'NASDAQ'].),\n]\n# Table: sbTransaction\n[\n  (sbTxId:varchar, Value examples: ['TX001', 'TX002', 'TX003'].),\n  (sbTxCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbTxTickerId:varchar, Value examples: ['T001', 'T002', 'T003'].),\n  (sbTxDateTime:timestamp, Value examples: ['2023-04-01 09:30:00', '2023-04-01 10:15:00', '2023-04-01 11:00:00'].),\n  (sbTxType:varchar, possible values: buy, sell. Value examples: ['buy', 'sell', 'buy'].),\n  (sbTxShares:numeric, Value examples: ['100', '50', '10'].),\n  (sbTxPrice:numeric, Value examples: ['150.00', '280.00', '3200.00'].),\n  (sbTxAmount:numeric, Value examples: ['15000.00', '14000.00', '32000.00'].),\n  (sbTxCcy:varchar, transaction currency. Value examples: ['USD', 'USD', 'USD'].),\n  (sbTxTax:numeric, Value examples: ['75.00', '70.00', '160.00'].),\n  (sbTxCommission:numeric, Value examples: ['10.00', '10.00', '20.00'].),\n  (sbTxKpx:varchar, internal code. Value examples: ['KP001', 'KP002', 'KP003'].),\n  (sbTxSettlementDateStr:varchar, settlement date as string in yyyyMMdd HH:mm:ss format. NULL if not settled. Value examples: ['20230401 09:30:00', '20230401 10:15:00', '20230401 11:00:00'].),\n  (sbTxStatus:varchar, possible values: success, fail, pending. Value examples: ['success', 'success', 'success'].),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nWhat are the top 5 combinations of customer state and ticker type by number of transactions? Return the customer state, ticker type and number of transactions.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT c.sbCustState, t.sbTickerType, COUNT(*) AS num_transactions FROM sbTransaction tx JOIN sbCustomer c ON tx.sbTxCustId = c.sbCustId JOIN sbTicker t ON tx.sbTxTickerId = t.sbTickerId GROUP BY c.sbCustState, t.sbTickerType ORDER BY num_transactions DESC LIMIT 5",
        "role": "assistant"
      }
    ],
    "db_name": "broker",
    "id": 203,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nReturn the distinct list of customer IDs who have made a 'buy' transaction.\n\n【数据库schema】\n【DB_ID】 broker\n【Schema】\n# Table: sbCustomer\n[\n  (sbCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbCustName:varchar, Value examples: ['john doe', 'Jane Smith', 'Bob Johnson'].),\n  (sbCustEmail:varchar, Value examples: ['john.doe@email.com', 'jane.smith@email.com', 'bob.johnson@email.com'].),\n  (sbCustPhone:varchar, Value examples: ['555-123-4567', '555-987-6543', '555-246-8135'].),\n  (sbCustAddress1:varchar, Value examples: ['123 Main St', '456 Oak Rd', '789 Pine Ave'].),\n  (sbCustAddress2:varchar,),\n  (sbCustCity:varchar, Value examples: ['Anytown', 'Someville', 'Mytown'].),\n  (sbCustState:varchar, Value examples: ['CA', 'NY', 'TX'].),\n  (sbCustCountry:varchar, Value examples: ['USA', 'USA', 'USA'].),\n  (sbCustPostalCode:varchar, Value examples: ['90001', '10002', '75000'].),\n  (sbCustJoinDate:date, Value examples: ['2020-01-01', '2019-03-15', '2022-06-01'].),\n  (sbCustStatus:varchar, possible values: active, inactive, suspended, closed. Value examples: ['active', 'active', 'inactive'].),\n]\n# Table: sbTicker\n[\n  (sbTickerId:varchar, Value examples: ['T001', 'T002', 'T005'].),\n  (sbTickerSymbol:varchar, Value examples: ['AAPL', 'MSFT', 'GOOGL'].),\n  (sbTickerName:varchar, Value examples: ['Apple Inc.', 'Microsoft Corporation', 'Alphabet Inc.'].),\n  (sbTickerType:varchar, possible values: stock, etf, mutualfund. Value examples: ['stock', 'stock', 'stock'].),\n  (sbTickerExchange:varchar, Value examples: ['NASDAQ', 'NASDAQ', 'NASDAQ'].),\n  (sbTickerCurrency:varchar, Value examples: ['USD', 'USD', 'USD'].),\n  (sbTickerDb2x:varchar, 2 letter exchange code. Value examples: ['NQ', 'NQ', 'NQ'].),\n  (sbTickerIsActive:boolean, Value examples: ['true', 'true', 'true'].),\n]\n# Table: sbDailyPrice\n[\n  (sbDpTickerId:varchar, Value examples: ['T001', 'T002'].),\n  (sbDpDate:date, Value examples: ['2023-04-01', '2023-04-01'].),\n  (sbDpOpen:numeric, Value examples: ['150.00', '280.00'].),\n  (sbDpHigh:numeric, Value examples: ['152.50', '282.75'].),\n  (sbDpLow:numeric, Value examples: ['148.75', '279.50'].),\n  (sbDpClose:numeric, Value examples: ['151.25', '281.00'].),\n  (sbDpVolume:bigint, Value examples: ['75000000', '35000000'].),\n  (sbDpEpochMs:bigint, epoch milliseconds for timestamp. Value examples: ['1680336000000', '1680336000000'].),\n  (sbDpSource:varchar, Value examples: ['NYSE', 'NASDAQ'].),\n]\n# Table: sbTransaction\n[\n  (sbTxId:varchar, Value examples: ['TX001', 'TX002', 'TX003'].),\n  (sbTxCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbTxTickerId:varchar, Value examples: ['T001', 'T002', 'T003'].),\n  (sbTxDateTime:timestamp, Value examples: ['2023-04-01 09:30:00', '2023-04-01 10:15:00', '2023-04-01 11:00:00'].),\n  (sbTxType:varchar, possible values: buy, sell. Value examples: ['buy', 'sell', 'buy'].),\n  (sbTxShares:numeric, Value examples: ['100', '50', '10'].),\n  (sbTxPrice:numeric, Value examples: ['150.00', '280.00', '3200.00'].),\n  (sbTxAmount:numeric, Value examples: ['15000.00', '14000.00', '32000.00'].),\n  (sbTxCcy:varchar, transaction currency. Value examples: ['USD', 'USD', 'USD'].),\n  (sbTxTax:numeric, Value examples: ['75.00', '70.00', '160.00'].),\n  (sbTxCommission:numeric, Value examples: ['10.00', '10.00', '20.00'].),\n  (sbTxKpx:varchar, internal code. Value examples: ['KP001', 'KP002', 'KP003'].),\n  (sbTxSettlementDateStr:varchar, settlement date as string in yyyyMMdd HH:mm:ss format. NULL if not settled. Value examples: ['20230401 09:30:00', '20230401 10:15:00', '20230401 11:00:00'].),\n  (sbTxStatus:varchar, possible values: success, fail, pending. Value examples: ['success', 'success', 'success'].),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nReturn the distinct list of customer IDs who have made a 'buy' transaction.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT DISTINCT c.sbCustId FROM sbCustomer c JOIN sbTransaction t ON c.sbCustId = t.sbTxCustId WHERE t.sbTxType = 'buy'",
        "role": "assistant"
      }
    ],
    "db_name": "broker",
    "id": 204,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nReturn the distinct list of ticker IDs that have daily price records on or after Apr 1, 2023.\n\n【数据库schema】\n【DB_ID】 broker\n【Schema】\n# Table: sbCustomer\n[\n  (sbCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbCustName:varchar, Value examples: ['john doe', 'Jane Smith', 'Bob Johnson'].),\n  (sbCustEmail:varchar, Value examples: ['john.doe@email.com', 'jane.smith@email.com', 'bob.johnson@email.com'].),\n  (sbCustPhone:varchar, Value examples: ['555-123-4567', '555-987-6543', '555-246-8135'].),\n  (sbCustAddress1:varchar, Value examples: ['123 Main St', '456 Oak Rd', '789 Pine Ave'].),\n  (sbCustAddress2:varchar,),\n  (sbCustCity:varchar, Value examples: ['Anytown', 'Someville', 'Mytown'].),\n  (sbCustState:varchar, Value examples: ['CA', 'NY', 'TX'].),\n  (sbCustCountry:varchar, Value examples: ['USA', 'USA', 'USA'].),\n  (sbCustPostalCode:varchar, Value examples: ['90001', '10002', '75000'].),\n  (sbCustJoinDate:date, Value examples: ['2020-01-01', '2019-03-15', '2022-06-01'].),\n  (sbCustStatus:varchar, possible values: active, inactive, suspended, closed. Value examples: ['active', 'active', 'inactive'].),\n]\n# Table: sbTicker\n[\n  (sbTickerId:varchar, Value examples: ['T001', 'T002', 'T005'].),\n  (sbTickerSymbol:varchar, Value examples: ['AAPL', 'MSFT', 'GOOGL'].),\n  (sbTickerName:varchar, Value examples: ['Apple Inc.', 'Microsoft Corporation', 'Alphabet Inc.'].),\n  (sbTickerType:varchar, possible values: stock, etf, mutualfund. Value examples: ['stock', 'stock', 'stock'].),\n  (sbTickerExchange:varchar, Value examples: ['NASDAQ', 'NASDAQ', 'NASDAQ'].),\n  (sbTickerCurrency:varchar, Value examples: ['USD', 'USD', 'USD'].),\n  (sbTickerDb2x:varchar, 2 letter exchange code. Value examples: ['NQ', 'NQ', 'NQ'].),\n  (sbTickerIsActive:boolean, Value examples: ['true', 'true', 'true'].),\n]\n# Table: sbDailyPrice\n[\n  (sbDpTickerId:varchar, Value examples: ['T001', 'T002'].),\n  (sbDpDate:date, Value examples: ['2023-04-01', '2023-04-01'].),\n  (sbDpOpen:numeric, Value examples: ['150.00', '280.00'].),\n  (sbDpHigh:numeric, Value examples: ['152.50', '282.75'].),\n  (sbDpLow:numeric, Value examples: ['148.75', '279.50'].),\n  (sbDpClose:numeric, Value examples: ['151.25', '281.00'].),\n  (sbDpVolume:bigint, Value examples: ['75000000', '35000000'].),\n  (sbDpEpochMs:bigint, epoch milliseconds for timestamp. Value examples: ['1680336000000', '1680336000000'].),\n  (sbDpSource:varchar, Value examples: ['NYSE', 'NASDAQ'].),\n]\n# Table: sbTransaction\n[\n  (sbTxId:varchar, Value examples: ['TX001', 'TX002', 'TX003'].),\n  (sbTxCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbTxTickerId:varchar, Value examples: ['T001', 'T002', 'T003'].),\n  (sbTxDateTime:timestamp, Value examples: ['2023-04-01 09:30:00', '2023-04-01 10:15:00', '2023-04-01 11:00:00'].),\n  (sbTxType:varchar, possible values: buy, sell. Value examples: ['buy', 'sell', 'buy'].),\n  (sbTxShares:numeric, Value examples: ['100', '50', '10'].),\n  (sbTxPrice:numeric, Value examples: ['150.00', '280.00', '3200.00'].),\n  (sbTxAmount:numeric, Value examples: ['15000.00', '14000.00', '32000.00'].),\n  (sbTxCcy:varchar, transaction currency. Value examples: ['USD', 'USD', 'USD'].),\n  (sbTxTax:numeric, Value examples: ['75.00', '70.00', '160.00'].),\n  (sbTxCommission:numeric, Value examples: ['10.00', '10.00', '20.00'].),\n  (sbTxKpx:varchar, internal code. Value examples: ['KP001', 'KP002', 'KP003'].),\n  (sbTxSettlementDateStr:varchar, settlement date as string in yyyyMMdd HH:mm:ss format. NULL if not settled. Value examples: ['20230401 09:30:00', '20230401 10:15:00', '20230401 11:00:00'].),\n  (sbTxStatus:varchar, possible values: success, fail, pending. Value examples: ['success', 'success', 'success'].),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nReturn the distinct list of ticker IDs that have daily price records on or after Apr 1, 2023.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT DISTINCT tk.sbTickerId FROM sbTicker tk JOIN sbDailyPrice dp ON tk.sbTickerId = dp.sbDpTickerId WHERE dp.sbDpDate >= '2023-04-01'",
        "role": "assistant"
      }
    ],
    "db_name": "broker",
    "id": 205,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the top 3 transaction statuses by number of transactions? Return the status and number of transactions.\n\n【数据库schema】\n【DB_ID】 broker\n【Schema】\n# Table: sbCustomer\n[\n  (sbCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbCustName:varchar, Value examples: ['john doe', 'Jane Smith', 'Bob Johnson'].),\n  (sbCustEmail:varchar, Value examples: ['john.doe@email.com', 'jane.smith@email.com', 'bob.johnson@email.com'].),\n  (sbCustPhone:varchar, Value examples: ['555-123-4567', '555-987-6543', '555-246-8135'].),\n  (sbCustAddress1:varchar, Value examples: ['123 Main St', '456 Oak Rd', '789 Pine Ave'].),\n  (sbCustAddress2:varchar,),\n  (sbCustCity:varchar, Value examples: ['Anytown', 'Someville', 'Mytown'].),\n  (sbCustState:varchar, Value examples: ['CA', 'NY', 'TX'].),\n  (sbCustCountry:varchar, Value examples: ['USA', 'USA', 'USA'].),\n  (sbCustPostalCode:varchar, Value examples: ['90001', '10002', '75000'].),\n  (sbCustJoinDate:date, Value examples: ['2020-01-01', '2019-03-15', '2022-06-01'].),\n  (sbCustStatus:varchar, possible values: active, inactive, suspended, closed. Value examples: ['active', 'active', 'inactive'].),\n]\n# Table: sbTicker\n[\n  (sbTickerId:varchar, Value examples: ['T001', 'T002', 'T005'].),\n  (sbTickerSymbol:varchar, Value examples: ['AAPL', 'MSFT', 'GOOGL'].),\n  (sbTickerName:varchar, Value examples: ['Apple Inc.', 'Microsoft Corporation', 'Alphabet Inc.'].),\n  (sbTickerType:varchar, possible values: stock, etf, mutualfund. Value examples: ['stock', 'stock', 'stock'].),\n  (sbTickerExchange:varchar, Value examples: ['NASDAQ', 'NASDAQ', 'NASDAQ'].),\n  (sbTickerCurrency:varchar, Value examples: ['USD', 'USD', 'USD'].),\n  (sbTickerDb2x:varchar, 2 letter exchange code. Value examples: ['NQ', 'NQ', 'NQ'].),\n  (sbTickerIsActive:boolean, Value examples: ['true', 'true', 'true'].),\n]\n# Table: sbDailyPrice\n[\n  (sbDpTickerId:varchar, Value examples: ['T001', 'T002'].),\n  (sbDpDate:date, Value examples: ['2023-04-01', '2023-04-01'].),\n  (sbDpOpen:numeric, Value examples: ['150.00', '280.00'].),\n  (sbDpHigh:numeric, Value examples: ['152.50', '282.75'].),\n  (sbDpLow:numeric, Value examples: ['148.75', '279.50'].),\n  (sbDpClose:numeric, Value examples: ['151.25', '281.00'].),\n  (sbDpVolume:bigint, Value examples: ['75000000', '35000000'].),\n  (sbDpEpochMs:bigint, epoch milliseconds for timestamp. Value examples: ['1680336000000', '1680336000000'].),\n  (sbDpSource:varchar, Value examples: ['NYSE', 'NASDAQ'].),\n]\n# Table: sbTransaction\n[\n  (sbTxId:varchar, Value examples: ['TX001', 'TX002', 'TX003'].),\n  (sbTxCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbTxTickerId:varchar, Value examples: ['T001', 'T002', 'T003'].),\n  (sbTxDateTime:timestamp, Value examples: ['2023-04-01 09:30:00', '2023-04-01 10:15:00', '2023-04-01 11:00:00'].),\n  (sbTxType:varchar, possible values: buy, sell. Value examples: ['buy', 'sell', 'buy'].),\n  (sbTxShares:numeric, Value examples: ['100', '50', '10'].),\n  (sbTxPrice:numeric, Value examples: ['150.00', '280.00', '3200.00'].),\n  (sbTxAmount:numeric, Value examples: ['15000.00', '14000.00', '32000.00'].),\n  (sbTxCcy:varchar, transaction currency. Value examples: ['USD', 'USD', 'USD'].),\n  (sbTxTax:numeric, Value examples: ['75.00', '70.00', '160.00'].),\n  (sbTxCommission:numeric, Value examples: ['10.00', '10.00', '20.00'].),\n  (sbTxKpx:varchar, internal code. Value examples: ['KP001', 'KP002', 'KP003'].),\n  (sbTxSettlementDateStr:varchar, settlement date as string in yyyyMMdd HH:mm:ss format. NULL if not settled. Value examples: ['20230401 09:30:00', '20230401 10:15:00', '20230401 11:00:00'].),\n  (sbTxStatus:varchar, possible values: success, fail, pending. Value examples: ['success', 'success', 'success'].),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nWhat are the top 3 transaction statuses by number of transactions? Return the status and number of transactions.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT sbTxStatus, COUNT(*) AS num_transactions FROM sbTransaction GROUP BY sbTxStatus ORDER BY num_transactions DESC LIMIT 3",
        "role": "assistant"
      }
    ],
    "db_name": "broker",
    "id": 206,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the top 5 countries by number of customers? Return the country name and number of customers.\n\n【数据库schema】\n【DB_ID】 broker\n【Schema】\n# Table: sbCustomer\n[\n  (sbCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbCustName:varchar, Value examples: ['john doe', 'Jane Smith', 'Bob Johnson'].),\n  (sbCustEmail:varchar, Value examples: ['john.doe@email.com', 'jane.smith@email.com', 'bob.johnson@email.com'].),\n  (sbCustPhone:varchar, Value examples: ['555-123-4567', '555-987-6543', '555-246-8135'].),\n  (sbCustAddress1:varchar, Value examples: ['123 Main St', '456 Oak Rd', '789 Pine Ave'].),\n  (sbCustAddress2:varchar,),\n  (sbCustCity:varchar, Value examples: ['Anytown', 'Someville', 'Mytown'].),\n  (sbCustState:varchar, Value examples: ['CA', 'NY', 'TX'].),\n  (sbCustCountry:varchar, Value examples: ['USA', 'USA', 'USA'].),\n  (sbCustPostalCode:varchar, Value examples: ['90001', '10002', '75000'].),\n  (sbCustJoinDate:date, Value examples: ['2020-01-01', '2019-03-15', '2022-06-01'].),\n  (sbCustStatus:varchar, possible values: active, inactive, suspended, closed. Value examples: ['active', 'active', 'inactive'].),\n]\n# Table: sbTicker\n[\n  (sbTickerId:varchar, Value examples: ['T001', 'T002', 'T005'].),\n  (sbTickerSymbol:varchar, Value examples: ['AAPL', 'MSFT', 'GOOGL'].),\n  (sbTickerName:varchar, Value examples: ['Apple Inc.', 'Microsoft Corporation', 'Alphabet Inc.'].),\n  (sbTickerType:varchar, possible values: stock, etf, mutualfund. Value examples: ['stock', 'stock', 'stock'].),\n  (sbTickerExchange:varchar, Value examples: ['NASDAQ', 'NASDAQ', 'NASDAQ'].),\n  (sbTickerCurrency:varchar, Value examples: ['USD', 'USD', 'USD'].),\n  (sbTickerDb2x:varchar, 2 letter exchange code. Value examples: ['NQ', 'NQ', 'NQ'].),\n  (sbTickerIsActive:boolean, Value examples: ['true', 'true', 'true'].),\n]\n# Table: sbDailyPrice\n[\n  (sbDpTickerId:varchar, Value examples: ['T001', 'T002'].),\n  (sbDpDate:date, Value examples: ['2023-04-01', '2023-04-01'].),\n  (sbDpOpen:numeric, Value examples: ['150.00', '280.00'].),\n  (sbDpHigh:numeric, Value examples: ['152.50', '282.75'].),\n  (sbDpLow:numeric, Value examples: ['148.75', '279.50'].),\n  (sbDpClose:numeric, Value examples: ['151.25', '281.00'].),\n  (sbDpVolume:bigint, Value examples: ['75000000', '35000000'].),\n  (sbDpEpochMs:bigint, epoch milliseconds for timestamp. Value examples: ['1680336000000', '1680336000000'].),\n  (sbDpSource:varchar, Value examples: ['NYSE', 'NASDAQ'].),\n]\n# Table: sbTransaction\n[\n  (sbTxId:varchar, Value examples: ['TX001', 'TX002', 'TX003'].),\n  (sbTxCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbTxTickerId:varchar, Value examples: ['T001', 'T002', 'T003'].),\n  (sbTxDateTime:timestamp, Value examples: ['2023-04-01 09:30:00', '2023-04-01 10:15:00', '2023-04-01 11:00:00'].),\n  (sbTxType:varchar, possible values: buy, sell. Value examples: ['buy', 'sell', 'buy'].),\n  (sbTxShares:numeric, Value examples: ['100', '50', '10'].),\n  (sbTxPrice:numeric, Value examples: ['150.00', '280.00', '3200.00'].),\n  (sbTxAmount:numeric, Value examples: ['15000.00', '14000.00', '32000.00'].),\n  (sbTxCcy:varchar, transaction currency. Value examples: ['USD', 'USD', 'USD'].),\n  (sbTxTax:numeric, Value examples: ['75.00', '70.00', '160.00'].),\n  (sbTxCommission:numeric, Value examples: ['10.00', '10.00', '20.00'].),\n  (sbTxKpx:varchar, internal code. Value examples: ['KP001', 'KP002', 'KP003'].),\n  (sbTxSettlementDateStr:varchar, settlement date as string in yyyyMMdd HH:mm:ss format. NULL if not settled. Value examples: ['20230401 09:30:00', '20230401 10:15:00', '20230401 11:00:00'].),\n  (sbTxStatus:varchar, possible values: success, fail, pending. Value examples: ['success', 'success', 'success'].),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nWhat are the top 5 countries by number of customers? Return the country name and number of customers.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT sbCustCountry, COUNT(*) AS num_customers FROM sbCustomer GROUP BY sbCustCountry ORDER BY num_customers DESC LIMIT 5",
        "role": "assistant"
      }
    ],
    "db_name": "broker",
    "id": 207,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nReturn the customer ID and name of customers who have not made any transactions.\n\n【数据库schema】\n【DB_ID】 broker\n【Schema】\n# Table: sbCustomer\n[\n  (sbCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbCustName:varchar, Value examples: ['john doe', 'Jane Smith', 'Bob Johnson'].),\n  (sbCustEmail:varchar, Value examples: ['john.doe@email.com', 'jane.smith@email.com', 'bob.johnson@email.com'].),\n  (sbCustPhone:varchar, Value examples: ['555-123-4567', '555-987-6543', '555-246-8135'].),\n  (sbCustAddress1:varchar, Value examples: ['123 Main St', '456 Oak Rd', '789 Pine Ave'].),\n  (sbCustAddress2:varchar,),\n  (sbCustCity:varchar, Value examples: ['Anytown', 'Someville', 'Mytown'].),\n  (sbCustState:varchar, Value examples: ['CA', 'NY', 'TX'].),\n  (sbCustCountry:varchar, Value examples: ['USA', 'USA', 'USA'].),\n  (sbCustPostalCode:varchar, Value examples: ['90001', '10002', '75000'].),\n  (sbCustJoinDate:date, Value examples: ['2020-01-01', '2019-03-15', '2022-06-01'].),\n  (sbCustStatus:varchar, possible values: active, inactive, suspended, closed. Value examples: ['active', 'active', 'inactive'].),\n]\n# Table: sbTicker\n[\n  (sbTickerId:varchar, Value examples: ['T001', 'T002', 'T005'].),\n  (sbTickerSymbol:varchar, Value examples: ['AAPL', 'MSFT', 'GOOGL'].),\n  (sbTickerName:varchar, Value examples: ['Apple Inc.', 'Microsoft Corporation', 'Alphabet Inc.'].),\n  (sbTickerType:varchar, possible values: stock, etf, mutualfund. Value examples: ['stock', 'stock', 'stock'].),\n  (sbTickerExchange:varchar, Value examples: ['NASDAQ', 'NASDAQ', 'NASDAQ'].),\n  (sbTickerCurrency:varchar, Value examples: ['USD', 'USD', 'USD'].),\n  (sbTickerDb2x:varchar, 2 letter exchange code. Value examples: ['NQ', 'NQ', 'NQ'].),\n  (sbTickerIsActive:boolean, Value examples: ['true', 'true', 'true'].),\n]\n# Table: sbDailyPrice\n[\n  (sbDpTickerId:varchar, Value examples: ['T001', 'T002'].),\n  (sbDpDate:date, Value examples: ['2023-04-01', '2023-04-01'].),\n  (sbDpOpen:numeric, Value examples: ['150.00', '280.00'].),\n  (sbDpHigh:numeric, Value examples: ['152.50', '282.75'].),\n  (sbDpLow:numeric, Value examples: ['148.75', '279.50'].),\n  (sbDpClose:numeric, Value examples: ['151.25', '281.00'].),\n  (sbDpVolume:bigint, Value examples: ['75000000', '35000000'].),\n  (sbDpEpochMs:bigint, epoch milliseconds for timestamp. Value examples: ['1680336000000', '1680336000000'].),\n  (sbDpSource:varchar, Value examples: ['NYSE', 'NASDAQ'].),\n]\n# Table: sbTransaction\n[\n  (sbTxId:varchar, Value examples: ['TX001', 'TX002', 'TX003'].),\n  (sbTxCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbTxTickerId:varchar, Value examples: ['T001', 'T002', 'T003'].),\n  (sbTxDateTime:timestamp, Value examples: ['2023-04-01 09:30:00', '2023-04-01 10:15:00', '2023-04-01 11:00:00'].),\n  (sbTxType:varchar, possible values: buy, sell. Value examples: ['buy', 'sell', 'buy'].),\n  (sbTxShares:numeric, Value examples: ['100', '50', '10'].),\n  (sbTxPrice:numeric, Value examples: ['150.00', '280.00', '3200.00'].),\n  (sbTxAmount:numeric, Value examples: ['15000.00', '14000.00', '32000.00'].),\n  (sbTxCcy:varchar, transaction currency. Value examples: ['USD', 'USD', 'USD'].),\n  (sbTxTax:numeric, Value examples: ['75.00', '70.00', '160.00'].),\n  (sbTxCommission:numeric, Value examples: ['10.00', '10.00', '20.00'].),\n  (sbTxKpx:varchar, internal code. Value examples: ['KP001', 'KP002', 'KP003'].),\n  (sbTxSettlementDateStr:varchar, settlement date as string in yyyyMMdd HH:mm:ss format. NULL if not settled. Value examples: ['20230401 09:30:00', '20230401 10:15:00', '20230401 11:00:00'].),\n  (sbTxStatus:varchar, possible values: success, fail, pending. Value examples: ['success', 'success', 'success'].),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nReturn the customer ID and name of customers who have not made any transactions.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT c.sbCustId, c.sbCustName FROM sbCustomer c LEFT JOIN sbTransaction t ON c.sbCustId = t.sbTxCustId WHERE t.sbTxCustId IS NULL",
        "role": "assistant"
      }
    ],
    "db_name": "broker",
    "id": 208,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nReturn the ticker ID and symbol of tickers that do not have any daily price records.\n\n【数据库schema】\n【DB_ID】 broker\n【Schema】\n# Table: sbCustomer\n[\n  (sbCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbCustName:varchar, Value examples: ['john doe', 'Jane Smith', 'Bob Johnson'].),\n  (sbCustEmail:varchar, Value examples: ['john.doe@email.com', 'jane.smith@email.com', 'bob.johnson@email.com'].),\n  (sbCustPhone:varchar, Value examples: ['555-123-4567', '555-987-6543', '555-246-8135'].),\n  (sbCustAddress1:varchar, Value examples: ['123 Main St', '456 Oak Rd', '789 Pine Ave'].),\n  (sbCustAddress2:varchar,),\n  (sbCustCity:varchar, Value examples: ['Anytown', 'Someville', 'Mytown'].),\n  (sbCustState:varchar, Value examples: ['CA', 'NY', 'TX'].),\n  (sbCustCountry:varchar, Value examples: ['USA', 'USA', 'USA'].),\n  (sbCustPostalCode:varchar, Value examples: ['90001', '10002', '75000'].),\n  (sbCustJoinDate:date, Value examples: ['2020-01-01', '2019-03-15', '2022-06-01'].),\n  (sbCustStatus:varchar, possible values: active, inactive, suspended, closed. Value examples: ['active', 'active', 'inactive'].),\n]\n# Table: sbTicker\n[\n  (sbTickerId:varchar, Value examples: ['T001', 'T002', 'T005'].),\n  (sbTickerSymbol:varchar, Value examples: ['AAPL', 'MSFT', 'GOOGL'].),\n  (sbTickerName:varchar, Value examples: ['Apple Inc.', 'Microsoft Corporation', 'Alphabet Inc.'].),\n  (sbTickerType:varchar, possible values: stock, etf, mutualfund. Value examples: ['stock', 'stock', 'stock'].),\n  (sbTickerExchange:varchar, Value examples: ['NASDAQ', 'NASDAQ', 'NASDAQ'].),\n  (sbTickerCurrency:varchar, Value examples: ['USD', 'USD', 'USD'].),\n  (sbTickerDb2x:varchar, 2 letter exchange code. Value examples: ['NQ', 'NQ', 'NQ'].),\n  (sbTickerIsActive:boolean, Value examples: ['true', 'true', 'true'].),\n]\n# Table: sbDailyPrice\n[\n  (sbDpTickerId:varchar, Value examples: ['T001', 'T002'].),\n  (sbDpDate:date, Value examples: ['2023-04-01', '2023-04-01'].),\n  (sbDpOpen:numeric, Value examples: ['150.00', '280.00'].),\n  (sbDpHigh:numeric, Value examples: ['152.50', '282.75'].),\n  (sbDpLow:numeric, Value examples: ['148.75', '279.50'].),\n  (sbDpClose:numeric, Value examples: ['151.25', '281.00'].),\n  (sbDpVolume:bigint, Value examples: ['75000000', '35000000'].),\n  (sbDpEpochMs:bigint, epoch milliseconds for timestamp. Value examples: ['1680336000000', '1680336000000'].),\n  (sbDpSource:varchar, Value examples: ['NYSE', 'NASDAQ'].),\n]\n# Table: sbTransaction\n[\n  (sbTxId:varchar, Value examples: ['TX001', 'TX002', 'TX003'].),\n  (sbTxCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbTxTickerId:varchar, Value examples: ['T001', 'T002', 'T003'].),\n  (sbTxDateTime:timestamp, Value examples: ['2023-04-01 09:30:00', '2023-04-01 10:15:00', '2023-04-01 11:00:00'].),\n  (sbTxType:varchar, possible values: buy, sell. Value examples: ['buy', 'sell', 'buy'].),\n  (sbTxShares:numeric, Value examples: ['100', '50', '10'].),\n  (sbTxPrice:numeric, Value examples: ['150.00', '280.00', '3200.00'].),\n  (sbTxAmount:numeric, Value examples: ['15000.00', '14000.00', '32000.00'].),\n  (sbTxCcy:varchar, transaction currency. Value examples: ['USD', 'USD', 'USD'].),\n  (sbTxTax:numeric, Value examples: ['75.00', '70.00', '160.00'].),\n  (sbTxCommission:numeric, Value examples: ['10.00', '10.00', '20.00'].),\n  (sbTxKpx:varchar, internal code. Value examples: ['KP001', 'KP002', 'KP003'].),\n  (sbTxSettlementDateStr:varchar, settlement date as string in yyyyMMdd HH:mm:ss format. NULL if not settled. Value examples: ['20230401 09:30:00', '20230401 10:15:00', '20230401 11:00:00'].),\n  (sbTxStatus:varchar, possible values: success, fail, pending. Value examples: ['success', 'success', 'success'].),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nReturn the ticker ID and symbol of tickers that do not have any daily price records.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT tk.sbTickerId, tk.sbTickerSymbol FROM sbTicker tk LEFT JOIN sbDailyPrice dp ON tk.sbTickerId = dp.sbDpTickerId WHERE dp.sbDpTickerId IS NULL",
        "role": "assistant"
      }
    ],
    "db_name": "broker",
    "id": 209,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWho were the top 3 sales representatives by total revenue in the past 3 months, inclusive of today's date? Return their first name, last name, total number of sales and total revenue.\n\n【数据库schema】\n【DB_ID】 car_dealership\n【Schema】\n# Table: cars\n[\n  (id:SERIAL, Primary key for the cars table.),\n  (make:TEXT, Manufacturer of the car. Value examples: ['Toyota', 'Honda'].),\n  (model:TEXT, Model name of the car. Value examples: ['Camry', 'Civic'].),\n  (year:INTEGER, Year of manufacture. Value examples: ['2022', '2021'].),\n  (color:TEXT, Color of the car. Value examples: ['Silver', 'platinum/grey'].),\n  (vin_number:VARCHAR, Vehicle Identification Number. Value examples: ['4T1BF1FK3CU510984', '2HGFC2F53MH522780'].),\n  (engine_type:TEXT, Type of engine (e.g., V6, V8, Electric). Value examples: ['V6', 'Inline 4'].),\n  (transmission:TEXT, Type of transmission (e.g., Automatic, Manual). Value examples: ['Automatic', 'CVT'].),\n  (price:NUMERIC, Selling price of the car. Value examples: ['28500.00', '22000.00'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the car was added to the system.),\n]\n# Table: salespersons\n[\n  (id:SERIAL, Unique identifier for each salesperson.),\n  (first_name:TEXT, Value examples: ['Sarah', 'Daniel', 'Olivia'].),\n  (last_name:TEXT, Value examples: ['Taylor', 'Anderson', 'Thomas'].),\n  (email:VARCHAR, Value examples: ['sarah.taylor@sonicauto.com', 'daniel.anderson@sonicauto.com', 'olivia.thomas@pensake.com'].),\n  (phone:VARCHAR, First 3 digits in brackets is the area code. Format: (123)-456-7890. Value examples: ['(123)-555-6666', '(555)-777-8888', '(333)-415-0000'].),\n  (hire_date:DATE, Value examples: ['2018-09-01', '2021-07-12', '2023-01-25'].),\n  (termination_date:DATE,),\n  (crtd_ts:TIMESTAMP, Timestamp when the salesperson record was created.),\n]\n# Table: customers\n[\n  (id:SERIAL, Primary key for the customers table.),\n  (first_name:TEXT,),\n  (last_name:TEXT,),\n  (email:VARCHAR,),\n  (phone:VARCHAR,),\n  (address:TEXT,),\n  (city:TEXT,),\n  (state:TEXT,),\n  (zip_code:VARCHAR,),\n  (crtd_ts:TIMESTAMP, Timestamp when the customer record was created.),\n]\n# Table: sales\n[\n  (id:SERIAL, Primary key that uniquely identifies each sale.),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '3', '6', '8'].),\n  (salesperson_id:INTEGER, Foreign key referencing the salespersons table. Value examples: ['2', '1', '4', '7'].),\n  (customer_id:INTEGER, Foreign key referencing the customers table. Value examples: ['3', '5', '2', '9'].),\n  (sale_price:NUMERIC, Price at which the car was sold. Value examples: ['27500.00', '44000.00', '24500.00', '38000.00'].),\n  (sale_date:DATE, Date when the car was sold. Value examples: ['2023-03-15', '2023-03-20', '2023-03-22', '2023-03-25'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the sale record was created.),\n]\n# Table: inventory_snapshots\n[\n  (id:SERIAL, Primary key for the inventory_snapshots table.),\n  (snapshot_date:DATE, Date of the inventory snapshot. Value examples: ['2023-03-15', '2023-03-15', '2023-03-15'].),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '2', '3'].),\n  (is_in_inventory:BOOLEAN, Indicates if the car was in inventory on the snapshot date. Value examples: ['TRUE', 'TRUE', 'TRUE'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the inventory snapshot record was created.),\n]\n# Table: payments_received\n[\n  (id:SERIAL, Uniquely identifies each payment received record.),\n  (sale_id:INTEGER, Foreign key referencing the sales table. Value examples: ['1', '1'].),\n  (payment_date:DATE, Date when the payment was received. Can take place after the sale date, or in installments.. Value examples: ['2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment received. Can be less than the sale price if the payment is made in installments.. Value examples: ['5000.00', '22500.00'].),\n  (payment_method:TEXT, Method of payment (e.g., cash, check, card, banktrf, trp01). Value examples: ['check', 'financing'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment received record was created.),\n]\n# Table: payments_made\n[\n  (id:SERIAL, Primary key for the payments_made table.),\n  (vendor_name:TEXT, Name of the vendor to whom the payment was made. Value examples: ['Car Manufacturer Inc', 'Auto Parts Supplier', 'Utility Company', 'Marketing Agency'].),\n  (payment_date:DATE, Date when the payment was made. Value examples: ['2023-03-01', '2023-03-10', '2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment made. Value examples: ['150000.00', '25000.00', '1500.00', '10000.00'].),\n  (payment_method:TEXT, Method of payment (e.g., check, bank_transfer, credit_card). Value examples: ['bank_transfer', 'check', 'bank_transfer', 'credit_card'].),\n  (invoice_number:VARCHAR, Invoice number associated with the payment. Value examples: ['INV-001', 'INV-002', 'INV-003', 'INV-004'].),\n  (invoice_date:DATE, Date of the invoice. Value examples: ['2023-02-25', '2023-03-05', '2023-03-01', '2023-03-15'].),\n  (due_date:DATE, Due date of the invoice. Value examples: ['2023-03-25', '2023-04-04', '2023-03-31', '2023-04-14'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment made record was created.),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nWho were the top 3 sales representatives by total revenue in the past 3 months, inclusive of today's date? Return their first name, last name, total number of sales and total revenue.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT c.first_name, c.last_name, COUNT(s.id) AS total_sales, SUM(s.sale_price) AS total_revenue FROM sales s JOIN salespersons c ON s.salesperson_id = c.id WHERE s.sale_date >= CURRENT_DATE - INTERVAL '3 months' GROUP BY c.first_name, c.last_name ORDER BY total_revenue DESC LIMIT 3",
        "role": "assistant"
      }
    ],
    "db_name": "car_dealership",
    "id": 210,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nReturn the top 5 salespersons by number of sales in the past 30 days? Return their first and last name, total sales count and total revenue amount.\n\n【数据库schema】\n【DB_ID】 car_dealership\n【Schema】\n# Table: cars\n[\n  (id:SERIAL, Primary key for the cars table.),\n  (make:TEXT, Manufacturer of the car. Value examples: ['Toyota', 'Honda'].),\n  (model:TEXT, Model name of the car. Value examples: ['Camry', 'Civic'].),\n  (year:INTEGER, Year of manufacture. Value examples: ['2022', '2021'].),\n  (color:TEXT, Color of the car. Value examples: ['Silver', 'platinum/grey'].),\n  (vin_number:VARCHAR, Vehicle Identification Number. Value examples: ['4T1BF1FK3CU510984', '2HGFC2F53MH522780'].),\n  (engine_type:TEXT, Type of engine (e.g., V6, V8, Electric). Value examples: ['V6', 'Inline 4'].),\n  (transmission:TEXT, Type of transmission (e.g., Automatic, Manual). Value examples: ['Automatic', 'CVT'].),\n  (price:NUMERIC, Selling price of the car. Value examples: ['28500.00', '22000.00'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the car was added to the system.),\n]\n# Table: salespersons\n[\n  (id:SERIAL, Unique identifier for each salesperson.),\n  (first_name:TEXT, Value examples: ['Sarah', 'Daniel', 'Olivia'].),\n  (last_name:TEXT, Value examples: ['Taylor', 'Anderson', 'Thomas'].),\n  (email:VARCHAR, Value examples: ['sarah.taylor@sonicauto.com', 'daniel.anderson@sonicauto.com', 'olivia.thomas@pensake.com'].),\n  (phone:VARCHAR, First 3 digits in brackets is the area code. Format: (123)-456-7890. Value examples: ['(123)-555-6666', '(555)-777-8888', '(333)-415-0000'].),\n  (hire_date:DATE, Value examples: ['2018-09-01', '2021-07-12', '2023-01-25'].),\n  (termination_date:DATE,),\n  (crtd_ts:TIMESTAMP, Timestamp when the salesperson record was created.),\n]\n# Table: customers\n[\n  (id:SERIAL, Primary key for the customers table.),\n  (first_name:TEXT,),\n  (last_name:TEXT,),\n  (email:VARCHAR,),\n  (phone:VARCHAR,),\n  (address:TEXT,),\n  (city:TEXT,),\n  (state:TEXT,),\n  (zip_code:VARCHAR,),\n  (crtd_ts:TIMESTAMP, Timestamp when the customer record was created.),\n]\n# Table: sales\n[\n  (id:SERIAL, Primary key that uniquely identifies each sale.),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '3', '6', '8'].),\n  (salesperson_id:INTEGER, Foreign key referencing the salespersons table. Value examples: ['2', '1', '4', '7'].),\n  (customer_id:INTEGER, Foreign key referencing the customers table. Value examples: ['3', '5', '2', '9'].),\n  (sale_price:NUMERIC, Price at which the car was sold. Value examples: ['27500.00', '44000.00', '24500.00', '38000.00'].),\n  (sale_date:DATE, Date when the car was sold. Value examples: ['2023-03-15', '2023-03-20', '2023-03-22', '2023-03-25'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the sale record was created.),\n]\n# Table: inventory_snapshots\n[\n  (id:SERIAL, Primary key for the inventory_snapshots table.),\n  (snapshot_date:DATE, Date of the inventory snapshot. Value examples: ['2023-03-15', '2023-03-15', '2023-03-15'].),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '2', '3'].),\n  (is_in_inventory:BOOLEAN, Indicates if the car was in inventory on the snapshot date. Value examples: ['TRUE', 'TRUE', 'TRUE'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the inventory snapshot record was created.),\n]\n# Table: payments_received\n[\n  (id:SERIAL, Uniquely identifies each payment received record.),\n  (sale_id:INTEGER, Foreign key referencing the sales table. Value examples: ['1', '1'].),\n  (payment_date:DATE, Date when the payment was received. Can take place after the sale date, or in installments.. Value examples: ['2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment received. Can be less than the sale price if the payment is made in installments.. Value examples: ['5000.00', '22500.00'].),\n  (payment_method:TEXT, Method of payment (e.g., cash, check, card, banktrf, trp01). Value examples: ['check', 'financing'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment received record was created.),\n]\n# Table: payments_made\n[\n  (id:SERIAL, Primary key for the payments_made table.),\n  (vendor_name:TEXT, Name of the vendor to whom the payment was made. Value examples: ['Car Manufacturer Inc', 'Auto Parts Supplier', 'Utility Company', 'Marketing Agency'].),\n  (payment_date:DATE, Date when the payment was made. Value examples: ['2023-03-01', '2023-03-10', '2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment made. Value examples: ['150000.00', '25000.00', '1500.00', '10000.00'].),\n  (payment_method:TEXT, Method of payment (e.g., check, bank_transfer, credit_card). Value examples: ['bank_transfer', 'check', 'bank_transfer', 'credit_card'].),\n  (invoice_number:VARCHAR, Invoice number associated with the payment. Value examples: ['INV-001', 'INV-002', 'INV-003', 'INV-004'].),\n  (invoice_date:DATE, Date of the invoice. Value examples: ['2023-02-25', '2023-03-05', '2023-03-01', '2023-03-15'].),\n  (due_date:DATE, Due date of the invoice. Value examples: ['2023-03-25', '2023-04-04', '2023-03-31', '2023-04-14'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment made record was created.),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nReturn the top 5 salespersons by number of sales in the past 30 days? Return their first and last name, total sales count and total revenue amount.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT sp.first_name, sp.last_name, COUNT(s.id) AS total_sales, SUM(s.sale_price) AS total_revenue FROM sales s JOIN salespersons sp ON s.salesperson_id = sp.id WHERE s.sale_date >= CURRENT_DATE - INTERVAL '30 days' GROUP BY sp.first_name, sp.last_name, sp.id ORDER BY total_sales DESC LIMIT 5",
        "role": "assistant"
      }
    ],
    "db_name": "car_dealership",
    "id": 211,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nReturn the top 5 states by total revenue, showing the number of unique customers and total revenue for each state.\n\n【数据库schema】\n【DB_ID】 car_dealership\n【Schema】\n# Table: cars\n[\n  (id:SERIAL, Primary key for the cars table.),\n  (make:TEXT, Manufacturer of the car. Value examples: ['Toyota', 'Honda'].),\n  (model:TEXT, Model name of the car. Value examples: ['Camry', 'Civic'].),\n  (year:INTEGER, Year of manufacture. Value examples: ['2022', '2021'].),\n  (color:TEXT, Color of the car. Value examples: ['Silver', 'platinum/grey'].),\n  (vin_number:VARCHAR, Vehicle Identification Number. Value examples: ['4T1BF1FK3CU510984', '2HGFC2F53MH522780'].),\n  (engine_type:TEXT, Type of engine (e.g., V6, V8, Electric). Value examples: ['V6', 'Inline 4'].),\n  (transmission:TEXT, Type of transmission (e.g., Automatic, Manual). Value examples: ['Automatic', 'CVT'].),\n  (price:NUMERIC, Selling price of the car. Value examples: ['28500.00', '22000.00'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the car was added to the system.),\n]\n# Table: salespersons\n[\n  (id:SERIAL, Unique identifier for each salesperson.),\n  (first_name:TEXT, Value examples: ['Sarah', 'Daniel', 'Olivia'].),\n  (last_name:TEXT, Value examples: ['Taylor', 'Anderson', 'Thomas'].),\n  (email:VARCHAR, Value examples: ['sarah.taylor@sonicauto.com', 'daniel.anderson@sonicauto.com', 'olivia.thomas@pensake.com'].),\n  (phone:VARCHAR, First 3 digits in brackets is the area code. Format: (123)-456-7890. Value examples: ['(123)-555-6666', '(555)-777-8888', '(333)-415-0000'].),\n  (hire_date:DATE, Value examples: ['2018-09-01', '2021-07-12', '2023-01-25'].),\n  (termination_date:DATE,),\n  (crtd_ts:TIMESTAMP, Timestamp when the salesperson record was created.),\n]\n# Table: customers\n[\n  (id:SERIAL, Primary key for the customers table.),\n  (first_name:TEXT,),\n  (last_name:TEXT,),\n  (email:VARCHAR,),\n  (phone:VARCHAR,),\n  (address:TEXT,),\n  (city:TEXT,),\n  (state:TEXT,),\n  (zip_code:VARCHAR,),\n  (crtd_ts:TIMESTAMP, Timestamp when the customer record was created.),\n]\n# Table: sales\n[\n  (id:SERIAL, Primary key that uniquely identifies each sale.),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '3', '6', '8'].),\n  (salesperson_id:INTEGER, Foreign key referencing the salespersons table. Value examples: ['2', '1', '4', '7'].),\n  (customer_id:INTEGER, Foreign key referencing the customers table. Value examples: ['3', '5', '2', '9'].),\n  (sale_price:NUMERIC, Price at which the car was sold. Value examples: ['27500.00', '44000.00', '24500.00', '38000.00'].),\n  (sale_date:DATE, Date when the car was sold. Value examples: ['2023-03-15', '2023-03-20', '2023-03-22', '2023-03-25'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the sale record was created.),\n]\n# Table: inventory_snapshots\n[\n  (id:SERIAL, Primary key for the inventory_snapshots table.),\n  (snapshot_date:DATE, Date of the inventory snapshot. Value examples: ['2023-03-15', '2023-03-15', '2023-03-15'].),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '2', '3'].),\n  (is_in_inventory:BOOLEAN, Indicates if the car was in inventory on the snapshot date. Value examples: ['TRUE', 'TRUE', 'TRUE'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the inventory snapshot record was created.),\n]\n# Table: payments_received\n[\n  (id:SERIAL, Uniquely identifies each payment received record.),\n  (sale_id:INTEGER, Foreign key referencing the sales table. Value examples: ['1', '1'].),\n  (payment_date:DATE, Date when the payment was received. Can take place after the sale date, or in installments.. Value examples: ['2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment received. Can be less than the sale price if the payment is made in installments.. Value examples: ['5000.00', '22500.00'].),\n  (payment_method:TEXT, Method of payment (e.g., cash, check, card, banktrf, trp01). Value examples: ['check', 'financing'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment received record was created.),\n]\n# Table: payments_made\n[\n  (id:SERIAL, Primary key for the payments_made table.),\n  (vendor_name:TEXT, Name of the vendor to whom the payment was made. Value examples: ['Car Manufacturer Inc', 'Auto Parts Supplier', 'Utility Company', 'Marketing Agency'].),\n  (payment_date:DATE, Date when the payment was made. Value examples: ['2023-03-01', '2023-03-10', '2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment made. Value examples: ['150000.00', '25000.00', '1500.00', '10000.00'].),\n  (payment_method:TEXT, Method of payment (e.g., check, bank_transfer, credit_card). Value examples: ['bank_transfer', 'check', 'bank_transfer', 'credit_card'].),\n  (invoice_number:VARCHAR, Invoice number associated with the payment. Value examples: ['INV-001', 'INV-002', 'INV-003', 'INV-004'].),\n  (invoice_date:DATE, Date of the invoice. Value examples: ['2023-02-25', '2023-03-05', '2023-03-01', '2023-03-15'].),\n  (due_date:DATE, Due date of the invoice. Value examples: ['2023-03-25', '2023-04-04', '2023-03-31', '2023-04-14'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment made record was created.),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nReturn the top 5 states by total revenue, showing the number of unique customers and total revenue for each state.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT c.state, COUNT(DISTINCT s.customer_id) AS unique_customers, SUM(s.sale_price) AS total_revenue FROM sales s JOIN customers c ON s.customer_id = c.id GROUP BY c.state ORDER BY total_revenue DESC LIMIT 5",
        "role": "assistant"
      }
    ],
    "db_name": "car_dealership",
    "id": 212,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the top 5 best selling car models by total revenue? Return the make, model, total number of sales and total revenue.\n\n【数据库schema】\n【DB_ID】 car_dealership\n【Schema】\n# Table: cars\n[\n  (id:SERIAL, Primary key for the cars table.),\n  (make:TEXT, Manufacturer of the car. Value examples: ['Toyota', 'Honda'].),\n  (model:TEXT, Model name of the car. Value examples: ['Camry', 'Civic'].),\n  (year:INTEGER, Year of manufacture. Value examples: ['2022', '2021'].),\n  (color:TEXT, Color of the car. Value examples: ['Silver', 'platinum/grey'].),\n  (vin_number:VARCHAR, Vehicle Identification Number. Value examples: ['4T1BF1FK3CU510984', '2HGFC2F53MH522780'].),\n  (engine_type:TEXT, Type of engine (e.g., V6, V8, Electric). Value examples: ['V6', 'Inline 4'].),\n  (transmission:TEXT, Type of transmission (e.g., Automatic, Manual). Value examples: ['Automatic', 'CVT'].),\n  (price:NUMERIC, Selling price of the car. Value examples: ['28500.00', '22000.00'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the car was added to the system.),\n]\n# Table: salespersons\n[\n  (id:SERIAL, Unique identifier for each salesperson.),\n  (first_name:TEXT, Value examples: ['Sarah', 'Daniel', 'Olivia'].),\n  (last_name:TEXT, Value examples: ['Taylor', 'Anderson', 'Thomas'].),\n  (email:VARCHAR, Value examples: ['sarah.taylor@sonicauto.com', 'daniel.anderson@sonicauto.com', 'olivia.thomas@pensake.com'].),\n  (phone:VARCHAR, First 3 digits in brackets is the area code. Format: (123)-456-7890. Value examples: ['(123)-555-6666', '(555)-777-8888', '(333)-415-0000'].),\n  (hire_date:DATE, Value examples: ['2018-09-01', '2021-07-12', '2023-01-25'].),\n  (termination_date:DATE,),\n  (crtd_ts:TIMESTAMP, Timestamp when the salesperson record was created.),\n]\n# Table: customers\n[\n  (id:SERIAL, Primary key for the customers table.),\n  (first_name:TEXT,),\n  (last_name:TEXT,),\n  (email:VARCHAR,),\n  (phone:VARCHAR,),\n  (address:TEXT,),\n  (city:TEXT,),\n  (state:TEXT,),\n  (zip_code:VARCHAR,),\n  (crtd_ts:TIMESTAMP, Timestamp when the customer record was created.),\n]\n# Table: sales\n[\n  (id:SERIAL, Primary key that uniquely identifies each sale.),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '3', '6', '8'].),\n  (salesperson_id:INTEGER, Foreign key referencing the salespersons table. Value examples: ['2', '1', '4', '7'].),\n  (customer_id:INTEGER, Foreign key referencing the customers table. Value examples: ['3', '5', '2', '9'].),\n  (sale_price:NUMERIC, Price at which the car was sold. Value examples: ['27500.00', '44000.00', '24500.00', '38000.00'].),\n  (sale_date:DATE, Date when the car was sold. Value examples: ['2023-03-15', '2023-03-20', '2023-03-22', '2023-03-25'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the sale record was created.),\n]\n# Table: inventory_snapshots\n[\n  (id:SERIAL, Primary key for the inventory_snapshots table.),\n  (snapshot_date:DATE, Date of the inventory snapshot. Value examples: ['2023-03-15', '2023-03-15', '2023-03-15'].),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '2', '3'].),\n  (is_in_inventory:BOOLEAN, Indicates if the car was in inventory on the snapshot date. Value examples: ['TRUE', 'TRUE', 'TRUE'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the inventory snapshot record was created.),\n]\n# Table: payments_received\n[\n  (id:SERIAL, Uniquely identifies each payment received record.),\n  (sale_id:INTEGER, Foreign key referencing the sales table. Value examples: ['1', '1'].),\n  (payment_date:DATE, Date when the payment was received. Can take place after the sale date, or in installments.. Value examples: ['2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment received. Can be less than the sale price if the payment is made in installments.. Value examples: ['5000.00', '22500.00'].),\n  (payment_method:TEXT, Method of payment (e.g., cash, check, card, banktrf, trp01). Value examples: ['check', 'financing'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment received record was created.),\n]\n# Table: payments_made\n[\n  (id:SERIAL, Primary key for the payments_made table.),\n  (vendor_name:TEXT, Name of the vendor to whom the payment was made. Value examples: ['Car Manufacturer Inc', 'Auto Parts Supplier', 'Utility Company', 'Marketing Agency'].),\n  (payment_date:DATE, Date when the payment was made. Value examples: ['2023-03-01', '2023-03-10', '2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment made. Value examples: ['150000.00', '25000.00', '1500.00', '10000.00'].),\n  (payment_method:TEXT, Method of payment (e.g., check, bank_transfer, credit_card). Value examples: ['bank_transfer', 'check', 'bank_transfer', 'credit_card'].),\n  (invoice_number:VARCHAR, Invoice number associated with the payment. Value examples: ['INV-001', 'INV-002', 'INV-003', 'INV-004'].),\n  (invoice_date:DATE, Date of the invoice. Value examples: ['2023-02-25', '2023-03-05', '2023-03-01', '2023-03-15'].),\n  (due_date:DATE, Due date of the invoice. Value examples: ['2023-03-25', '2023-04-04', '2023-03-31', '2023-04-14'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment made record was created.),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nWhat are the top 5 best selling car models by total revenue? Return the make, model, total number of sales and total revenue.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT c.make, c.model, COUNT(s.id) AS total_sales, SUM(s.sale_price) AS total_revenue FROM sales s JOIN cars c ON s.car_id = c.id GROUP BY c.make, c.model ORDER BY total_revenue DESC LIMIT 5",
        "role": "assistant"
      }
    ],
    "db_name": "car_dealership",
    "id": 213,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nReturn the distinct list of customer IDs that have made a purchase, based on joining the customers and sales tables.\n\n【数据库schema】\n【DB_ID】 car_dealership\n【Schema】\n# Table: cars\n[\n  (id:SERIAL, Primary key for the cars table.),\n  (make:TEXT, Manufacturer of the car. Value examples: ['Toyota', 'Honda'].),\n  (model:TEXT, Model name of the car. Value examples: ['Camry', 'Civic'].),\n  (year:INTEGER, Year of manufacture. Value examples: ['2022', '2021'].),\n  (color:TEXT, Color of the car. Value examples: ['Silver', 'platinum/grey'].),\n  (vin_number:VARCHAR, Vehicle Identification Number. Value examples: ['4T1BF1FK3CU510984', '2HGFC2F53MH522780'].),\n  (engine_type:TEXT, Type of engine (e.g., V6, V8, Electric). Value examples: ['V6', 'Inline 4'].),\n  (transmission:TEXT, Type of transmission (e.g., Automatic, Manual). Value examples: ['Automatic', 'CVT'].),\n  (price:NUMERIC, Selling price of the car. Value examples: ['28500.00', '22000.00'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the car was added to the system.),\n]\n# Table: salespersons\n[\n  (id:SERIAL, Unique identifier for each salesperson.),\n  (first_name:TEXT, Value examples: ['Sarah', 'Daniel', 'Olivia'].),\n  (last_name:TEXT, Value examples: ['Taylor', 'Anderson', 'Thomas'].),\n  (email:VARCHAR, Value examples: ['sarah.taylor@sonicauto.com', 'daniel.anderson@sonicauto.com', 'olivia.thomas@pensake.com'].),\n  (phone:VARCHAR, First 3 digits in brackets is the area code. Format: (123)-456-7890. Value examples: ['(123)-555-6666', '(555)-777-8888', '(333)-415-0000'].),\n  (hire_date:DATE, Value examples: ['2018-09-01', '2021-07-12', '2023-01-25'].),\n  (termination_date:DATE,),\n  (crtd_ts:TIMESTAMP, Timestamp when the salesperson record was created.),\n]\n# Table: customers\n[\n  (id:SERIAL, Primary key for the customers table.),\n  (first_name:TEXT,),\n  (last_name:TEXT,),\n  (email:VARCHAR,),\n  (phone:VARCHAR,),\n  (address:TEXT,),\n  (city:TEXT,),\n  (state:TEXT,),\n  (zip_code:VARCHAR,),\n  (crtd_ts:TIMESTAMP, Timestamp when the customer record was created.),\n]\n# Table: sales\n[\n  (id:SERIAL, Primary key that uniquely identifies each sale.),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '3', '6', '8'].),\n  (salesperson_id:INTEGER, Foreign key referencing the salespersons table. Value examples: ['2', '1', '4', '7'].),\n  (customer_id:INTEGER, Foreign key referencing the customers table. Value examples: ['3', '5', '2', '9'].),\n  (sale_price:NUMERIC, Price at which the car was sold. Value examples: ['27500.00', '44000.00', '24500.00', '38000.00'].),\n  (sale_date:DATE, Date when the car was sold. Value examples: ['2023-03-15', '2023-03-20', '2023-03-22', '2023-03-25'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the sale record was created.),\n]\n# Table: inventory_snapshots\n[\n  (id:SERIAL, Primary key for the inventory_snapshots table.),\n  (snapshot_date:DATE, Date of the inventory snapshot. Value examples: ['2023-03-15', '2023-03-15', '2023-03-15'].),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '2', '3'].),\n  (is_in_inventory:BOOLEAN, Indicates if the car was in inventory on the snapshot date. Value examples: ['TRUE', 'TRUE', 'TRUE'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the inventory snapshot record was created.),\n]\n# Table: payments_received\n[\n  (id:SERIAL, Uniquely identifies each payment received record.),\n  (sale_id:INTEGER, Foreign key referencing the sales table. Value examples: ['1', '1'].),\n  (payment_date:DATE, Date when the payment was received. Can take place after the sale date, or in installments.. Value examples: ['2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment received. Can be less than the sale price if the payment is made in installments.. Value examples: ['5000.00', '22500.00'].),\n  (payment_method:TEXT, Method of payment (e.g., cash, check, card, banktrf, trp01). Value examples: ['check', 'financing'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment received record was created.),\n]\n# Table: payments_made\n[\n  (id:SERIAL, Primary key for the payments_made table.),\n  (vendor_name:TEXT, Name of the vendor to whom the payment was made. Value examples: ['Car Manufacturer Inc', 'Auto Parts Supplier', 'Utility Company', 'Marketing Agency'].),\n  (payment_date:DATE, Date when the payment was made. Value examples: ['2023-03-01', '2023-03-10', '2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment made. Value examples: ['150000.00', '25000.00', '1500.00', '10000.00'].),\n  (payment_method:TEXT, Method of payment (e.g., check, bank_transfer, credit_card). Value examples: ['bank_transfer', 'check', 'bank_transfer', 'credit_card'].),\n  (invoice_number:VARCHAR, Invoice number associated with the payment. Value examples: ['INV-001', 'INV-002', 'INV-003', 'INV-004'].),\n  (invoice_date:DATE, Date of the invoice. Value examples: ['2023-02-25', '2023-03-05', '2023-03-01', '2023-03-15'].),\n  (due_date:DATE, Due date of the invoice. Value examples: ['2023-03-25', '2023-04-04', '2023-03-31', '2023-04-14'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment made record was created.),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nReturn the distinct list of customer IDs that have made a purchase, based on joining the customers and sales tables.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT DISTINCT c.id AS customer_id FROM customers c JOIN sales s ON c.id = s.customer_id",
        "role": "assistant"
      }
    ],
    "db_name": "car_dealership",
    "id": 214,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nReturn the distinct list of salesperson IDs that have received a cash payment, based on joining the salespersons, sales and payments_received tables.\n\n【数据库schema】\n【DB_ID】 car_dealership\n【Schema】\n# Table: cars\n[\n  (id:SERIAL, Primary key for the cars table.),\n  (make:TEXT, Manufacturer of the car. Value examples: ['Toyota', 'Honda'].),\n  (model:TEXT, Model name of the car. Value examples: ['Camry', 'Civic'].),\n  (year:INTEGER, Year of manufacture. Value examples: ['2022', '2021'].),\n  (color:TEXT, Color of the car. Value examples: ['Silver', 'platinum/grey'].),\n  (vin_number:VARCHAR, Vehicle Identification Number. Value examples: ['4T1BF1FK3CU510984', '2HGFC2F53MH522780'].),\n  (engine_type:TEXT, Type of engine (e.g., V6, V8, Electric). Value examples: ['V6', 'Inline 4'].),\n  (transmission:TEXT, Type of transmission (e.g., Automatic, Manual). Value examples: ['Automatic', 'CVT'].),\n  (price:NUMERIC, Selling price of the car. Value examples: ['28500.00', '22000.00'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the car was added to the system.),\n]\n# Table: salespersons\n[\n  (id:SERIAL, Unique identifier for each salesperson.),\n  (first_name:TEXT, Value examples: ['Sarah', 'Daniel', 'Olivia'].),\n  (last_name:TEXT, Value examples: ['Taylor', 'Anderson', 'Thomas'].),\n  (email:VARCHAR, Value examples: ['sarah.taylor@sonicauto.com', 'daniel.anderson@sonicauto.com', 'olivia.thomas@pensake.com'].),\n  (phone:VARCHAR, First 3 digits in brackets is the area code. Format: (123)-456-7890. Value examples: ['(123)-555-6666', '(555)-777-8888', '(333)-415-0000'].),\n  (hire_date:DATE, Value examples: ['2018-09-01', '2021-07-12', '2023-01-25'].),\n  (termination_date:DATE,),\n  (crtd_ts:TIMESTAMP, Timestamp when the salesperson record was created.),\n]\n# Table: customers\n[\n  (id:SERIAL, Primary key for the customers table.),\n  (first_name:TEXT,),\n  (last_name:TEXT,),\n  (email:VARCHAR,),\n  (phone:VARCHAR,),\n  (address:TEXT,),\n  (city:TEXT,),\n  (state:TEXT,),\n  (zip_code:VARCHAR,),\n  (crtd_ts:TIMESTAMP, Timestamp when the customer record was created.),\n]\n# Table: sales\n[\n  (id:SERIAL, Primary key that uniquely identifies each sale.),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '3', '6', '8'].),\n  (salesperson_id:INTEGER, Foreign key referencing the salespersons table. Value examples: ['2', '1', '4', '7'].),\n  (customer_id:INTEGER, Foreign key referencing the customers table. Value examples: ['3', '5', '2', '9'].),\n  (sale_price:NUMERIC, Price at which the car was sold. Value examples: ['27500.00', '44000.00', '24500.00', '38000.00'].),\n  (sale_date:DATE, Date when the car was sold. Value examples: ['2023-03-15', '2023-03-20', '2023-03-22', '2023-03-25'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the sale record was created.),\n]\n# Table: inventory_snapshots\n[\n  (id:SERIAL, Primary key for the inventory_snapshots table.),\n  (snapshot_date:DATE, Date of the inventory snapshot. Value examples: ['2023-03-15', '2023-03-15', '2023-03-15'].),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '2', '3'].),\n  (is_in_inventory:BOOLEAN, Indicates if the car was in inventory on the snapshot date. Value examples: ['TRUE', 'TRUE', 'TRUE'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the inventory snapshot record was created.),\n]\n# Table: payments_received\n[\n  (id:SERIAL, Uniquely identifies each payment received record.),\n  (sale_id:INTEGER, Foreign key referencing the sales table. Value examples: ['1', '1'].),\n  (payment_date:DATE, Date when the payment was received. Can take place after the sale date, or in installments.. Value examples: ['2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment received. Can be less than the sale price if the payment is made in installments.. Value examples: ['5000.00', '22500.00'].),\n  (payment_method:TEXT, Method of payment (e.g., cash, check, card, banktrf, trp01). Value examples: ['check', 'financing'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment received record was created.),\n]\n# Table: payments_made\n[\n  (id:SERIAL, Primary key for the payments_made table.),\n  (vendor_name:TEXT, Name of the vendor to whom the payment was made. Value examples: ['Car Manufacturer Inc', 'Auto Parts Supplier', 'Utility Company', 'Marketing Agency'].),\n  (payment_date:DATE, Date when the payment was made. Value examples: ['2023-03-01', '2023-03-10', '2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment made. Value examples: ['150000.00', '25000.00', '1500.00', '10000.00'].),\n  (payment_method:TEXT, Method of payment (e.g., check, bank_transfer, credit_card). Value examples: ['bank_transfer', 'check', 'bank_transfer', 'credit_card'].),\n  (invoice_number:VARCHAR, Invoice number associated with the payment. Value examples: ['INV-001', 'INV-002', 'INV-003', 'INV-004'].),\n  (invoice_date:DATE, Date of the invoice. Value examples: ['2023-02-25', '2023-03-05', '2023-03-01', '2023-03-15'].),\n  (due_date:DATE, Due date of the invoice. Value examples: ['2023-03-25', '2023-04-04', '2023-03-31', '2023-04-14'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment made record was created.),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nReturn the distinct list of salesperson IDs that have received a cash payment, based on joining the salespersons, sales and payments_received tables.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT DISTINCT s.id AS salesperson_id FROM salespersons s JOIN sales sa ON s.id = sa.salesperson_id JOIN payments_received p ON sa.id = p.sale_id WHERE p.payment_method = 'cash'",
        "role": "assistant"
      }
    ],
    "db_name": "car_dealership",
    "id": 215,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the top 3 payment methods by total payment amount received? Return the payment method, total number of payments and total amount.\n\n【数据库schema】\n【DB_ID】 car_dealership\n【Schema】\n# Table: cars\n[\n  (id:SERIAL, Primary key for the cars table.),\n  (make:TEXT, Manufacturer of the car. Value examples: ['Toyota', 'Honda'].),\n  (model:TEXT, Model name of the car. Value examples: ['Camry', 'Civic'].),\n  (year:INTEGER, Year of manufacture. Value examples: ['2022', '2021'].),\n  (color:TEXT, Color of the car. Value examples: ['Silver', 'platinum/grey'].),\n  (vin_number:VARCHAR, Vehicle Identification Number. Value examples: ['4T1BF1FK3CU510984', '2HGFC2F53MH522780'].),\n  (engine_type:TEXT, Type of engine (e.g., V6, V8, Electric). Value examples: ['V6', 'Inline 4'].),\n  (transmission:TEXT, Type of transmission (e.g., Automatic, Manual). Value examples: ['Automatic', 'CVT'].),\n  (price:NUMERIC, Selling price of the car. Value examples: ['28500.00', '22000.00'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the car was added to the system.),\n]\n# Table: salespersons\n[\n  (id:SERIAL, Unique identifier for each salesperson.),\n  (first_name:TEXT, Value examples: ['Sarah', 'Daniel', 'Olivia'].),\n  (last_name:TEXT, Value examples: ['Taylor', 'Anderson', 'Thomas'].),\n  (email:VARCHAR, Value examples: ['sarah.taylor@sonicauto.com', 'daniel.anderson@sonicauto.com', 'olivia.thomas@pensake.com'].),\n  (phone:VARCHAR, First 3 digits in brackets is the area code. Format: (123)-456-7890. Value examples: ['(123)-555-6666', '(555)-777-8888', '(333)-415-0000'].),\n  (hire_date:DATE, Value examples: ['2018-09-01', '2021-07-12', '2023-01-25'].),\n  (termination_date:DATE,),\n  (crtd_ts:TIMESTAMP, Timestamp when the salesperson record was created.),\n]\n# Table: customers\n[\n  (id:SERIAL, Primary key for the customers table.),\n  (first_name:TEXT,),\n  (last_name:TEXT,),\n  (email:VARCHAR,),\n  (phone:VARCHAR,),\n  (address:TEXT,),\n  (city:TEXT,),\n  (state:TEXT,),\n  (zip_code:VARCHAR,),\n  (crtd_ts:TIMESTAMP, Timestamp when the customer record was created.),\n]\n# Table: sales\n[\n  (id:SERIAL, Primary key that uniquely identifies each sale.),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '3', '6', '8'].),\n  (salesperson_id:INTEGER, Foreign key referencing the salespersons table. Value examples: ['2', '1', '4', '7'].),\n  (customer_id:INTEGER, Foreign key referencing the customers table. Value examples: ['3', '5', '2', '9'].),\n  (sale_price:NUMERIC, Price at which the car was sold. Value examples: ['27500.00', '44000.00', '24500.00', '38000.00'].),\n  (sale_date:DATE, Date when the car was sold. Value examples: ['2023-03-15', '2023-03-20', '2023-03-22', '2023-03-25'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the sale record was created.),\n]\n# Table: inventory_snapshots\n[\n  (id:SERIAL, Primary key for the inventory_snapshots table.),\n  (snapshot_date:DATE, Date of the inventory snapshot. Value examples: ['2023-03-15', '2023-03-15', '2023-03-15'].),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '2', '3'].),\n  (is_in_inventory:BOOLEAN, Indicates if the car was in inventory on the snapshot date. Value examples: ['TRUE', 'TRUE', 'TRUE'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the inventory snapshot record was created.),\n]\n# Table: payments_received\n[\n  (id:SERIAL, Uniquely identifies each payment received record.),\n  (sale_id:INTEGER, Foreign key referencing the sales table. Value examples: ['1', '1'].),\n  (payment_date:DATE, Date when the payment was received. Can take place after the sale date, or in installments.. Value examples: ['2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment received. Can be less than the sale price if the payment is made in installments.. Value examples: ['5000.00', '22500.00'].),\n  (payment_method:TEXT, Method of payment (e.g., cash, check, card, banktrf, trp01). Value examples: ['check', 'financing'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment received record was created.),\n]\n# Table: payments_made\n[\n  (id:SERIAL, Primary key for the payments_made table.),\n  (vendor_name:TEXT, Name of the vendor to whom the payment was made. Value examples: ['Car Manufacturer Inc', 'Auto Parts Supplier', 'Utility Company', 'Marketing Agency'].),\n  (payment_date:DATE, Date when the payment was made. Value examples: ['2023-03-01', '2023-03-10', '2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment made. Value examples: ['150000.00', '25000.00', '1500.00', '10000.00'].),\n  (payment_method:TEXT, Method of payment (e.g., check, bank_transfer, credit_card). Value examples: ['bank_transfer', 'check', 'bank_transfer', 'credit_card'].),\n  (invoice_number:VARCHAR, Invoice number associated with the payment. Value examples: ['INV-001', 'INV-002', 'INV-003', 'INV-004'].),\n  (invoice_date:DATE, Date of the invoice. Value examples: ['2023-02-25', '2023-03-05', '2023-03-01', '2023-03-15'].),\n  (due_date:DATE, Due date of the invoice. Value examples: ['2023-03-25', '2023-04-04', '2023-03-31', '2023-04-14'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment made record was created.),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nWhat are the top 3 payment methods by total payment amount received? Return the payment method, total number of payments and total amount.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT payment_method, COUNT(*) AS total_payments, SUM(payment_amount) AS total_amount FROM payments_received GROUP BY payment_method ORDER BY total_amount DESC LIMIT 3",
        "role": "assistant"
      }
    ],
    "db_name": "car_dealership",
    "id": 216,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the total number of customer signups for the top 2 states? Return the state and total signups, starting from the top.\n\n【数据库schema】\n【DB_ID】 car_dealership\n【Schema】\n# Table: cars\n[\n  (id:SERIAL, Primary key for the cars table.),\n  (make:TEXT, Manufacturer of the car. Value examples: ['Toyota', 'Honda'].),\n  (model:TEXT, Model name of the car. Value examples: ['Camry', 'Civic'].),\n  (year:INTEGER, Year of manufacture. Value examples: ['2022', '2021'].),\n  (color:TEXT, Color of the car. Value examples: ['Silver', 'platinum/grey'].),\n  (vin_number:VARCHAR, Vehicle Identification Number. Value examples: ['4T1BF1FK3CU510984', '2HGFC2F53MH522780'].),\n  (engine_type:TEXT, Type of engine (e.g., V6, V8, Electric). Value examples: ['V6', 'Inline 4'].),\n  (transmission:TEXT, Type of transmission (e.g., Automatic, Manual). Value examples: ['Automatic', 'CVT'].),\n  (price:NUMERIC, Selling price of the car. Value examples: ['28500.00', '22000.00'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the car was added to the system.),\n]\n# Table: salespersons\n[\n  (id:SERIAL, Unique identifier for each salesperson.),\n  (first_name:TEXT, Value examples: ['Sarah', 'Daniel', 'Olivia'].),\n  (last_name:TEXT, Value examples: ['Taylor', 'Anderson', 'Thomas'].),\n  (email:VARCHAR, Value examples: ['sarah.taylor@sonicauto.com', 'daniel.anderson@sonicauto.com', 'olivia.thomas@pensake.com'].),\n  (phone:VARCHAR, First 3 digits in brackets is the area code. Format: (123)-456-7890. Value examples: ['(123)-555-6666', '(555)-777-8888', '(333)-415-0000'].),\n  (hire_date:DATE, Value examples: ['2018-09-01', '2021-07-12', '2023-01-25'].),\n  (termination_date:DATE,),\n  (crtd_ts:TIMESTAMP, Timestamp when the salesperson record was created.),\n]\n# Table: customers\n[\n  (id:SERIAL, Primary key for the customers table.),\n  (first_name:TEXT,),\n  (last_name:TEXT,),\n  (email:VARCHAR,),\n  (phone:VARCHAR,),\n  (address:TEXT,),\n  (city:TEXT,),\n  (state:TEXT,),\n  (zip_code:VARCHAR,),\n  (crtd_ts:TIMESTAMP, Timestamp when the customer record was created.),\n]\n# Table: sales\n[\n  (id:SERIAL, Primary key that uniquely identifies each sale.),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '3', '6', '8'].),\n  (salesperson_id:INTEGER, Foreign key referencing the salespersons table. Value examples: ['2', '1', '4', '7'].),\n  (customer_id:INTEGER, Foreign key referencing the customers table. Value examples: ['3', '5', '2', '9'].),\n  (sale_price:NUMERIC, Price at which the car was sold. Value examples: ['27500.00', '44000.00', '24500.00', '38000.00'].),\n  (sale_date:DATE, Date when the car was sold. Value examples: ['2023-03-15', '2023-03-20', '2023-03-22', '2023-03-25'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the sale record was created.),\n]\n# Table: inventory_snapshots\n[\n  (id:SERIAL, Primary key for the inventory_snapshots table.),\n  (snapshot_date:DATE, Date of the inventory snapshot. Value examples: ['2023-03-15', '2023-03-15', '2023-03-15'].),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '2', '3'].),\n  (is_in_inventory:BOOLEAN, Indicates if the car was in inventory on the snapshot date. Value examples: ['TRUE', 'TRUE', 'TRUE'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the inventory snapshot record was created.),\n]\n# Table: payments_received\n[\n  (id:SERIAL, Uniquely identifies each payment received record.),\n  (sale_id:INTEGER, Foreign key referencing the sales table. Value examples: ['1', '1'].),\n  (payment_date:DATE, Date when the payment was received. Can take place after the sale date, or in installments.. Value examples: ['2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment received. Can be less than the sale price if the payment is made in installments.. Value examples: ['5000.00', '22500.00'].),\n  (payment_method:TEXT, Method of payment (e.g., cash, check, card, banktrf, trp01). Value examples: ['check', 'financing'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment received record was created.),\n]\n# Table: payments_made\n[\n  (id:SERIAL, Primary key for the payments_made table.),\n  (vendor_name:TEXT, Name of the vendor to whom the payment was made. Value examples: ['Car Manufacturer Inc', 'Auto Parts Supplier', 'Utility Company', 'Marketing Agency'].),\n  (payment_date:DATE, Date when the payment was made. Value examples: ['2023-03-01', '2023-03-10', '2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment made. Value examples: ['150000.00', '25000.00', '1500.00', '10000.00'].),\n  (payment_method:TEXT, Method of payment (e.g., check, bank_transfer, credit_card). Value examples: ['bank_transfer', 'check', 'bank_transfer', 'credit_card'].),\n  (invoice_number:VARCHAR, Invoice number associated with the payment. Value examples: ['INV-001', 'INV-002', 'INV-003', 'INV-004'].),\n  (invoice_date:DATE, Date of the invoice. Value examples: ['2023-02-25', '2023-03-05', '2023-03-01', '2023-03-15'].),\n  (due_date:DATE, Due date of the invoice. Value examples: ['2023-03-25', '2023-04-04', '2023-03-31', '2023-04-14'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment made record was created.),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nWhat are the total number of customer signups for the top 2 states? Return the state and total signups, starting from the top.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT state, COUNT(*) AS total_signups FROM customers GROUP BY state ORDER BY total_signups DESC LIMIT 2",
        "role": "assistant"
      }
    ],
    "db_name": "car_dealership",
    "id": 217,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nReturn the car ID, make, model and year for cars that have no sales records, by doing a left join from the cars to sales table.\n\n【数据库schema】\n【DB_ID】 car_dealership\n【Schema】\n# Table: cars\n[\n  (id:SERIAL, Primary key for the cars table.),\n  (make:TEXT, Manufacturer of the car. Value examples: ['Toyota', 'Honda'].),\n  (model:TEXT, Model name of the car. Value examples: ['Camry', 'Civic'].),\n  (year:INTEGER, Year of manufacture. Value examples: ['2022', '2021'].),\n  (color:TEXT, Color of the car. Value examples: ['Silver', 'platinum/grey'].),\n  (vin_number:VARCHAR, Vehicle Identification Number. Value examples: ['4T1BF1FK3CU510984', '2HGFC2F53MH522780'].),\n  (engine_type:TEXT, Type of engine (e.g., V6, V8, Electric). Value examples: ['V6', 'Inline 4'].),\n  (transmission:TEXT, Type of transmission (e.g., Automatic, Manual). Value examples: ['Automatic', 'CVT'].),\n  (price:NUMERIC, Selling price of the car. Value examples: ['28500.00', '22000.00'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the car was added to the system.),\n]\n# Table: salespersons\n[\n  (id:SERIAL, Unique identifier for each salesperson.),\n  (first_name:TEXT, Value examples: ['Sarah', 'Daniel', 'Olivia'].),\n  (last_name:TEXT, Value examples: ['Taylor', 'Anderson', 'Thomas'].),\n  (email:VARCHAR, Value examples: ['sarah.taylor@sonicauto.com', 'daniel.anderson@sonicauto.com', 'olivia.thomas@pensake.com'].),\n  (phone:VARCHAR, First 3 digits in brackets is the area code. Format: (123)-456-7890. Value examples: ['(123)-555-6666', '(555)-777-8888', '(333)-415-0000'].),\n  (hire_date:DATE, Value examples: ['2018-09-01', '2021-07-12', '2023-01-25'].),\n  (termination_date:DATE,),\n  (crtd_ts:TIMESTAMP, Timestamp when the salesperson record was created.),\n]\n# Table: customers\n[\n  (id:SERIAL, Primary key for the customers table.),\n  (first_name:TEXT,),\n  (last_name:TEXT,),\n  (email:VARCHAR,),\n  (phone:VARCHAR,),\n  (address:TEXT,),\n  (city:TEXT,),\n  (state:TEXT,),\n  (zip_code:VARCHAR,),\n  (crtd_ts:TIMESTAMP, Timestamp when the customer record was created.),\n]\n# Table: sales\n[\n  (id:SERIAL, Primary key that uniquely identifies each sale.),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '3', '6', '8'].),\n  (salesperson_id:INTEGER, Foreign key referencing the salespersons table. Value examples: ['2', '1', '4', '7'].),\n  (customer_id:INTEGER, Foreign key referencing the customers table. Value examples: ['3', '5', '2', '9'].),\n  (sale_price:NUMERIC, Price at which the car was sold. Value examples: ['27500.00', '44000.00', '24500.00', '38000.00'].),\n  (sale_date:DATE, Date when the car was sold. Value examples: ['2023-03-15', '2023-03-20', '2023-03-22', '2023-03-25'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the sale record was created.),\n]\n# Table: inventory_snapshots\n[\n  (id:SERIAL, Primary key for the inventory_snapshots table.),\n  (snapshot_date:DATE, Date of the inventory snapshot. Value examples: ['2023-03-15', '2023-03-15', '2023-03-15'].),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '2', '3'].),\n  (is_in_inventory:BOOLEAN, Indicates if the car was in inventory on the snapshot date. Value examples: ['TRUE', 'TRUE', 'TRUE'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the inventory snapshot record was created.),\n]\n# Table: payments_received\n[\n  (id:SERIAL, Uniquely identifies each payment received record.),\n  (sale_id:INTEGER, Foreign key referencing the sales table. Value examples: ['1', '1'].),\n  (payment_date:DATE, Date when the payment was received. Can take place after the sale date, or in installments.. Value examples: ['2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment received. Can be less than the sale price if the payment is made in installments.. Value examples: ['5000.00', '22500.00'].),\n  (payment_method:TEXT, Method of payment (e.g., cash, check, card, banktrf, trp01). Value examples: ['check', 'financing'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment received record was created.),\n]\n# Table: payments_made\n[\n  (id:SERIAL, Primary key for the payments_made table.),\n  (vendor_name:TEXT, Name of the vendor to whom the payment was made. Value examples: ['Car Manufacturer Inc', 'Auto Parts Supplier', 'Utility Company', 'Marketing Agency'].),\n  (payment_date:DATE, Date when the payment was made. Value examples: ['2023-03-01', '2023-03-10', '2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment made. Value examples: ['150000.00', '25000.00', '1500.00', '10000.00'].),\n  (payment_method:TEXT, Method of payment (e.g., check, bank_transfer, credit_card). Value examples: ['bank_transfer', 'check', 'bank_transfer', 'credit_card'].),\n  (invoice_number:VARCHAR, Invoice number associated with the payment. Value examples: ['INV-001', 'INV-002', 'INV-003', 'INV-004'].),\n  (invoice_date:DATE, Date of the invoice. Value examples: ['2023-02-25', '2023-03-05', '2023-03-01', '2023-03-15'].),\n  (due_date:DATE, Due date of the invoice. Value examples: ['2023-03-25', '2023-04-04', '2023-03-31', '2023-04-14'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment made record was created.),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nReturn the car ID, make, model and year for cars that have no sales records, by doing a left join from the cars to sales table.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT c.id AS car_id, c.make, c.model, c.year FROM cars c LEFT JOIN sales s ON c.id = s.car_id WHERE s.car_id IS NULL",
        "role": "assistant"
      }
    ],
    "db_name": "car_dealership",
    "id": 218,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nReturn the salesperson ID, first name and last name for salespersons that have no sales records, by doing a left join from the salespersons to sales table.\n\n【数据库schema】\n【DB_ID】 car_dealership\n【Schema】\n# Table: cars\n[\n  (id:SERIAL, Primary key for the cars table.),\n  (make:TEXT, Manufacturer of the car. Value examples: ['Toyota', 'Honda'].),\n  (model:TEXT, Model name of the car. Value examples: ['Camry', 'Civic'].),\n  (year:INTEGER, Year of manufacture. Value examples: ['2022', '2021'].),\n  (color:TEXT, Color of the car. Value examples: ['Silver', 'platinum/grey'].),\n  (vin_number:VARCHAR, Vehicle Identification Number. Value examples: ['4T1BF1FK3CU510984', '2HGFC2F53MH522780'].),\n  (engine_type:TEXT, Type of engine (e.g., V6, V8, Electric). Value examples: ['V6', 'Inline 4'].),\n  (transmission:TEXT, Type of transmission (e.g., Automatic, Manual). Value examples: ['Automatic', 'CVT'].),\n  (price:NUMERIC, Selling price of the car. Value examples: ['28500.00', '22000.00'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the car was added to the system.),\n]\n# Table: salespersons\n[\n  (id:SERIAL, Unique identifier for each salesperson.),\n  (first_name:TEXT, Value examples: ['Sarah', 'Daniel', 'Olivia'].),\n  (last_name:TEXT, Value examples: ['Taylor', 'Anderson', 'Thomas'].),\n  (email:VARCHAR, Value examples: ['sarah.taylor@sonicauto.com', 'daniel.anderson@sonicauto.com', 'olivia.thomas@pensake.com'].),\n  (phone:VARCHAR, First 3 digits in brackets is the area code. Format: (123)-456-7890. Value examples: ['(123)-555-6666', '(555)-777-8888', '(333)-415-0000'].),\n  (hire_date:DATE, Value examples: ['2018-09-01', '2021-07-12', '2023-01-25'].),\n  (termination_date:DATE,),\n  (crtd_ts:TIMESTAMP, Timestamp when the salesperson record was created.),\n]\n# Table: customers\n[\n  (id:SERIAL, Primary key for the customers table.),\n  (first_name:TEXT,),\n  (last_name:TEXT,),\n  (email:VARCHAR,),\n  (phone:VARCHAR,),\n  (address:TEXT,),\n  (city:TEXT,),\n  (state:TEXT,),\n  (zip_code:VARCHAR,),\n  (crtd_ts:TIMESTAMP, Timestamp when the customer record was created.),\n]\n# Table: sales\n[\n  (id:SERIAL, Primary key that uniquely identifies each sale.),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '3', '6', '8'].),\n  (salesperson_id:INTEGER, Foreign key referencing the salespersons table. Value examples: ['2', '1', '4', '7'].),\n  (customer_id:INTEGER, Foreign key referencing the customers table. Value examples: ['3', '5', '2', '9'].),\n  (sale_price:NUMERIC, Price at which the car was sold. Value examples: ['27500.00', '44000.00', '24500.00', '38000.00'].),\n  (sale_date:DATE, Date when the car was sold. Value examples: ['2023-03-15', '2023-03-20', '2023-03-22', '2023-03-25'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the sale record was created.),\n]\n# Table: inventory_snapshots\n[\n  (id:SERIAL, Primary key for the inventory_snapshots table.),\n  (snapshot_date:DATE, Date of the inventory snapshot. Value examples: ['2023-03-15', '2023-03-15', '2023-03-15'].),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '2', '3'].),\n  (is_in_inventory:BOOLEAN, Indicates if the car was in inventory on the snapshot date. Value examples: ['TRUE', 'TRUE', 'TRUE'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the inventory snapshot record was created.),\n]\n# Table: payments_received\n[\n  (id:SERIAL, Uniquely identifies each payment received record.),\n  (sale_id:INTEGER, Foreign key referencing the sales table. Value examples: ['1', '1'].),\n  (payment_date:DATE, Date when the payment was received. Can take place after the sale date, or in installments.. Value examples: ['2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment received. Can be less than the sale price if the payment is made in installments.. Value examples: ['5000.00', '22500.00'].),\n  (payment_method:TEXT, Method of payment (e.g., cash, check, card, banktrf, trp01). Value examples: ['check', 'financing'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment received record was created.),\n]\n# Table: payments_made\n[\n  (id:SERIAL, Primary key for the payments_made table.),\n  (vendor_name:TEXT, Name of the vendor to whom the payment was made. Value examples: ['Car Manufacturer Inc', 'Auto Parts Supplier', 'Utility Company', 'Marketing Agency'].),\n  (payment_date:DATE, Date when the payment was made. Value examples: ['2023-03-01', '2023-03-10', '2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment made. Value examples: ['150000.00', '25000.00', '1500.00', '10000.00'].),\n  (payment_method:TEXT, Method of payment (e.g., check, bank_transfer, credit_card). Value examples: ['bank_transfer', 'check', 'bank_transfer', 'credit_card'].),\n  (invoice_number:VARCHAR, Invoice number associated with the payment. Value examples: ['INV-001', 'INV-002', 'INV-003', 'INV-004'].),\n  (invoice_date:DATE, Date of the invoice. Value examples: ['2023-02-25', '2023-03-05', '2023-03-01', '2023-03-15'].),\n  (due_date:DATE, Due date of the invoice. Value examples: ['2023-03-25', '2023-04-04', '2023-03-31', '2023-04-14'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment made record was created.),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nReturn the salesperson ID, first name and last name for salespersons that have no sales records, by doing a left join from the salespersons to sales table.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT s.id AS salesperson_id, s.first_name, s.last_name FROM salespersons s LEFT JOIN sales sa ON s.id = sa.salesperson_id WHERE sa.salesperson_id IS NULL",
        "role": "assistant"
      }
    ],
    "db_name": "car_dealership",
    "id": 219,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the top 3 doctor specialties by total drug amount prescribed for treatments started in the past 6 calendar months? Return the specialty, number of treatments, and total drug amount.\n\n【数据库schema】\n【DB_ID】 derm_treatment\n【Schema】\n# Table: doctors\n[\n  (doc_id:SERIAL,),\n  (first_name:VARCHAR,),\n  (last_name:VARCHAR,),\n  (specialty:TEXT, possible values: dermatology, immunology, general.),\n  (year_reg:INT, year the doctor was registered and obtained license.),\n  (med_school_name:VARCHAR,),\n  (loc_city:VARCHAR,),\n  (loc_state:CHAR,),\n  (loc_zip:VARCHAR,),\n  (bd_cert_num:VARCHAR, board certification number.),\n]\n# Table: patients\n[\n  (patient_id:SERIAL,),\n  (first_name:VARCHAR, Value examples: ['Alice', 'Bob'].),\n  (last_name:VARCHAR, Value examples: ['Johnson', 'Smith'].),\n  (date_of_birth:DATE, Value examples: ['1985-03-15', '1978-11-23'].),\n  (date_of_registration:DATE, Value examples: ['2023-01-03', '2023-01-10'].),\n  (gender:VARCHAR, Male, Female, Others. Value examples: ['Female', 'Male'].),\n  (email:VARCHAR, Value examples: ['alice@email.com', 'bob@email.com'].),\n  (phone:VARCHAR, Value examples: ['555-123-4567', '555-987-6543'].),\n  (addr_street:VARCHAR, Value examples: ['123 Main St', '456 Oak Ave'].),\n  (addr_city:VARCHAR, Value examples: ['Anytown', 'Somecity'].),\n  (addr_state:CHAR, Value examples: ['CA', 'NY'].),\n  (addr_zip:VARCHAR, Value examples: ['12345', '54321'].),\n  (ins_type:TEXT, Insurance type. Possible values: private, medicare, medicaid, uninsured. Value examples: ['private', 'medicare'].),\n  (ins_policy_num:VARCHAR, Insurance policy number. Value examples: ['ABC123456', 'XYZ789012'].),\n  (height_cm:FLOAT, Value examples: ['165', '180'].),\n  (weight_kg:FLOAT, Value examples: ['60', '85'].),\n]\n# Table: drugs\n[\n  (drug_id:SERIAL,),\n  (drug_name:VARCHAR, Value examples: ['Drugalin', 'Medicol'].),\n  (manufacturer:VARCHAR, Value examples: ['Pharma Inc', 'Acme Pharma'].),\n  (drug_type:TEXT, possible values: biologic, small molecule, topical. Value examples: ['biologic', 'small molecule'].),\n  (moa:TEXT, mechanism of action. Value examples: ['TNF-alpha inhibitor', 'IL-17A inhibitor'].),\n  (fda_appr_dt:DATE, FDA approval date. NULL if drug is still under trial.. Value examples: ['2010-01-15', '2015-06-30'].),\n  (admin_route:TEXT, possible values: oral, injection, topical. Value examples: ['injection', 'oral'].),\n  (dos_amt:DECIMAL, recommended dosage amount. Value examples: ['40', '30'].),\n  (dos_unit:VARCHAR, recommended dosage unit. Value examples: ['mg', 'mg'].),\n  (dos_freq_hrs:INT, recommended number of hours between dosages. Value examples: ['336', '24'].),\n  (ndc:VARCHAR, National Drug Code. Value examples: ['12345-678-90', '54321-012-34'].),\n]\n# Table: diagnoses\n[\n  (diag_id:SERIAL,),\n  (diag_code:VARCHAR, Value examples: ['L40.1', 'L40.51'].),\n  (diag_name:VARCHAR, Value examples: ['Generalized pustular psoriasis', 'Distal interphalangeal psoriatic arthropathy'].),\n  (diag_desc:TEXT, Value examples: ['Widespread pustules on top of red skin', 'Psoriatic arthritis mainly affecting the ends of fingers and toes'].),\n]\n# Table: treatments\n[\n  (treatment_id:SERIAL,),\n  (patient_id:INT,),\n  (doc_id:INT,),\n  (drug_id:INT,),\n  (diag_id:INT,),\n  (start_dt:DATE,),\n  (end_dt:DATE, NULL if treatment is ongoing.),\n  (is_placebo:BOOLEAN,),\n  (tot_drug_amt:DECIMAL,),\n  (drug_unit:TEXT, possible values: mg, ml, g.),\n]\n# Table: outcomes\n[\n  (outcome_id:SERIAL,),\n  (treatment_id:INT, Value examples: ['1', '2', '3', '4'].),\n  (assess_dt:DATE, Value examples: ['2022-01-08', '2022-02-22', '2022-03-17', '2022-04-08'].),\n  (day7_lesion_cnt:INT, lesion counts on day 7.. Value examples: ['20', '25', '18', '30'].),\n  (day30_lesion_cnt:INT, Value examples: ['15', '18', '12', '25'].),\n  (day100_lesion_cnt:INT, Value examples: ['5', '8', '3', '12'].),\n  (day7_pasi_score:DECIMAL, PASI score range 0-72. Value examples: ['12.5', '15.0', '10.8', '18.2'].),\n  (day30_pasi_score:DECIMAL, Value examples: ['8.2', '10.1', '6.4', '13.9'].),\n  (day100_pasi_score:DECIMAL, Value examples: ['2.1', '3.5', '1.2', '5.8'].),\n  (day7_tewl:DECIMAL, in g/m^2/h. Value examples: ['18.2', '20.1', '16.5', '22.4'].),\n  (day30_tewl:DECIMAL, Value examples: ['15.6', '17.2', '14.0', '19.1'].),\n  (day100_tewl:DECIMAL, Value examples: ['12.1', '13.5', '10.8', '15.2'].),\n  (day7_itch_vas:INT, visual analog scale 0-100. Value examples: ['60', '70', '55', '80'].),\n  (day30_itch_vas:INT, Value examples: ['40', '50', '35', '60'].),\n  (day100_itch_vas:INT, Value examples: ['20', '30', '15', '40'].),\n  (day7_hfg:DECIMAL, hair growth factor range 0-5. Value examples: ['1.5', '1.0', '2.0', '0.5'].),\n  (day30_hfg:DECIMAL, Value examples: ['2.5', '2.0', '3.0', '1.5'].),\n  (day100_hfg:DECIMAL, Value examples: ['4.0', '3.5', '4.5', '3.0'].),\n]\n# Table: adverse_events\n[\n  (id:SERIAL, 1 row per adverse event per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '5'].),\n  (reported_dt:DATE, Value examples: ['2022-01-15', '2022-05-20'].),\n  (description:TEXT, Value examples: ['Mild injection site reaction', 'Upper respiratory infection'].),\n]\n# Table: concomitant_meds\n[\n  (id:SERIAL, 1 row per med per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '1', '2', '3'].),\n  (med_name:VARCHAR, Value examples: ['Acetaminophen', 'Ibuprofen', 'Loratadine', 'Multivitamin'].),\n  (start_dt:TEXT, YYYY-MM-DD. Value examples: ['2022-01-01', '2022-01-08', '2022-02-15', '2022-03-10'].),\n  (end_dt:TEXT, YYYY-MM-DD NULL if still taking. Value examples: ['2022-01-07', '2022-01-14', '2022-03-15', 'NULL'].),\n  (dose_amt:DECIMAL, Value examples: ['500', '200', '10', '1'].),\n  (dose_unit:TEXT, possible values: mg, ml, g. Value examples: ['mg', 'mg', 'mg', 'tablet'].),\n  (freq_hrs:INT, Value examples: ['6', '8', '24', '24'].),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nWhat are the top 3 doctor specialties by total drug amount prescribed for treatments started in the past 6 calendar months? Return the specialty, number of treatments, and total drug amount.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT d.specialty, COUNT(*) AS num_treatments, SUM(t.tot_drug_amt) AS total_drug_amt FROM treatments t JOIN doctors d ON t.doc_id = d.doc_id WHERE t.start_dt >= DATE_TRUNC('month', CURRENT_DATE - INTERVAL '6 months') GROUP BY d.specialty ORDER BY total_drug_amt DESC LIMIT 3",
        "role": "assistant"
      }
    ],
    "db_name": "derm_treatment",
    "id": 220,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nFor treatments that ended in the year 2022 (from Jan 1st to Dec 31st inclusive), what is the average PASI score at day 100 and number of distinct patients per insurance type? Return the top 5 insurance types sorted by lowest average PASI score first.\n\n【数据库schema】\n【DB_ID】 derm_treatment\n【Schema】\n# Table: doctors\n[\n  (doc_id:SERIAL,),\n  (first_name:VARCHAR,),\n  (last_name:VARCHAR,),\n  (specialty:TEXT, possible values: dermatology, immunology, general.),\n  (year_reg:INT, year the doctor was registered and obtained license.),\n  (med_school_name:VARCHAR,),\n  (loc_city:VARCHAR,),\n  (loc_state:CHAR,),\n  (loc_zip:VARCHAR,),\n  (bd_cert_num:VARCHAR, board certification number.),\n]\n# Table: patients\n[\n  (patient_id:SERIAL,),\n  (first_name:VARCHAR, Value examples: ['Alice', 'Bob'].),\n  (last_name:VARCHAR, Value examples: ['Johnson', 'Smith'].),\n  (date_of_birth:DATE, Value examples: ['1985-03-15', '1978-11-23'].),\n  (date_of_registration:DATE, Value examples: ['2023-01-03', '2023-01-10'].),\n  (gender:VARCHAR, Male, Female, Others. Value examples: ['Female', 'Male'].),\n  (email:VARCHAR, Value examples: ['alice@email.com', 'bob@email.com'].),\n  (phone:VARCHAR, Value examples: ['555-123-4567', '555-987-6543'].),\n  (addr_street:VARCHAR, Value examples: ['123 Main St', '456 Oak Ave'].),\n  (addr_city:VARCHAR, Value examples: ['Anytown', 'Somecity'].),\n  (addr_state:CHAR, Value examples: ['CA', 'NY'].),\n  (addr_zip:VARCHAR, Value examples: ['12345', '54321'].),\n  (ins_type:TEXT, Insurance type. Possible values: private, medicare, medicaid, uninsured. Value examples: ['private', 'medicare'].),\n  (ins_policy_num:VARCHAR, Insurance policy number. Value examples: ['ABC123456', 'XYZ789012'].),\n  (height_cm:FLOAT, Value examples: ['165', '180'].),\n  (weight_kg:FLOAT, Value examples: ['60', '85'].),\n]\n# Table: drugs\n[\n  (drug_id:SERIAL,),\n  (drug_name:VARCHAR, Value examples: ['Drugalin', 'Medicol'].),\n  (manufacturer:VARCHAR, Value examples: ['Pharma Inc', 'Acme Pharma'].),\n  (drug_type:TEXT, possible values: biologic, small molecule, topical. Value examples: ['biologic', 'small molecule'].),\n  (moa:TEXT, mechanism of action. Value examples: ['TNF-alpha inhibitor', 'IL-17A inhibitor'].),\n  (fda_appr_dt:DATE, FDA approval date. NULL if drug is still under trial.. Value examples: ['2010-01-15', '2015-06-30'].),\n  (admin_route:TEXT, possible values: oral, injection, topical. Value examples: ['injection', 'oral'].),\n  (dos_amt:DECIMAL, recommended dosage amount. Value examples: ['40', '30'].),\n  (dos_unit:VARCHAR, recommended dosage unit. Value examples: ['mg', 'mg'].),\n  (dos_freq_hrs:INT, recommended number of hours between dosages. Value examples: ['336', '24'].),\n  (ndc:VARCHAR, National Drug Code. Value examples: ['12345-678-90', '54321-012-34'].),\n]\n# Table: diagnoses\n[\n  (diag_id:SERIAL,),\n  (diag_code:VARCHAR, Value examples: ['L40.1', 'L40.51'].),\n  (diag_name:VARCHAR, Value examples: ['Generalized pustular psoriasis', 'Distal interphalangeal psoriatic arthropathy'].),\n  (diag_desc:TEXT, Value examples: ['Widespread pustules on top of red skin', 'Psoriatic arthritis mainly affecting the ends of fingers and toes'].),\n]\n# Table: treatments\n[\n  (treatment_id:SERIAL,),\n  (patient_id:INT,),\n  (doc_id:INT,),\n  (drug_id:INT,),\n  (diag_id:INT,),\n  (start_dt:DATE,),\n  (end_dt:DATE, NULL if treatment is ongoing.),\n  (is_placebo:BOOLEAN,),\n  (tot_drug_amt:DECIMAL,),\n  (drug_unit:TEXT, possible values: mg, ml, g.),\n]\n# Table: outcomes\n[\n  (outcome_id:SERIAL,),\n  (treatment_id:INT, Value examples: ['1', '2', '3', '4'].),\n  (assess_dt:DATE, Value examples: ['2022-01-08', '2022-02-22', '2022-03-17', '2022-04-08'].),\n  (day7_lesion_cnt:INT, lesion counts on day 7.. Value examples: ['20', '25', '18', '30'].),\n  (day30_lesion_cnt:INT, Value examples: ['15', '18', '12', '25'].),\n  (day100_lesion_cnt:INT, Value examples: ['5', '8', '3', '12'].),\n  (day7_pasi_score:DECIMAL, PASI score range 0-72. Value examples: ['12.5', '15.0', '10.8', '18.2'].),\n  (day30_pasi_score:DECIMAL, Value examples: ['8.2', '10.1', '6.4', '13.9'].),\n  (day100_pasi_score:DECIMAL, Value examples: ['2.1', '3.5', '1.2', '5.8'].),\n  (day7_tewl:DECIMAL, in g/m^2/h. Value examples: ['18.2', '20.1', '16.5', '22.4'].),\n  (day30_tewl:DECIMAL, Value examples: ['15.6', '17.2', '14.0', '19.1'].),\n  (day100_tewl:DECIMAL, Value examples: ['12.1', '13.5', '10.8', '15.2'].),\n  (day7_itch_vas:INT, visual analog scale 0-100. Value examples: ['60', '70', '55', '80'].),\n  (day30_itch_vas:INT, Value examples: ['40', '50', '35', '60'].),\n  (day100_itch_vas:INT, Value examples: ['20', '30', '15', '40'].),\n  (day7_hfg:DECIMAL, hair growth factor range 0-5. Value examples: ['1.5', '1.0', '2.0', '0.5'].),\n  (day30_hfg:DECIMAL, Value examples: ['2.5', '2.0', '3.0', '1.5'].),\n  (day100_hfg:DECIMAL, Value examples: ['4.0', '3.5', '4.5', '3.0'].),\n]\n# Table: adverse_events\n[\n  (id:SERIAL, 1 row per adverse event per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '5'].),\n  (reported_dt:DATE, Value examples: ['2022-01-15', '2022-05-20'].),\n  (description:TEXT, Value examples: ['Mild injection site reaction', 'Upper respiratory infection'].),\n]\n# Table: concomitant_meds\n[\n  (id:SERIAL, 1 row per med per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '1', '2', '3'].),\n  (med_name:VARCHAR, Value examples: ['Acetaminophen', 'Ibuprofen', 'Loratadine', 'Multivitamin'].),\n  (start_dt:TEXT, YYYY-MM-DD. Value examples: ['2022-01-01', '2022-01-08', '2022-02-15', '2022-03-10'].),\n  (end_dt:TEXT, YYYY-MM-DD NULL if still taking. Value examples: ['2022-01-07', '2022-01-14', '2022-03-15', 'NULL'].),\n  (dose_amt:DECIMAL, Value examples: ['500', '200', '10', '1'].),\n  (dose_unit:TEXT, possible values: mg, ml, g. Value examples: ['mg', 'mg', 'mg', 'tablet'].),\n  (freq_hrs:INT, Value examples: ['6', '8', '24', '24'].),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nFor treatments that ended in the year 2022 (from Jan 1st to Dec 31st inclusive), what is the average PASI score at day 100 and number of distinct patients per insurance type? Return the top 5 insurance types sorted by lowest average PASI score first.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT p.ins_type, COUNT(DISTINCT t.patient_id) AS num_patients, AVG(o.day100_pasi_score) AS avg_pasi_score FROM treatments t JOIN patients p ON t.patient_id = p.patient_id JOIN outcomes o ON t.treatment_id = o.treatment_id WHERE t.end_dt BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY p.ins_type ORDER BY avg_pasi_score LIMIT 5",
        "role": "assistant"
      }
    ],
    "db_name": "derm_treatment",
    "id": 221,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the top 5 drugs by number of treatments and average drug amount per treatment? Return the drug name, number of treatments, and average drug amount.\n\n【数据库schema】\n【DB_ID】 derm_treatment\n【Schema】\n# Table: doctors\n[\n  (doc_id:SERIAL,),\n  (first_name:VARCHAR,),\n  (last_name:VARCHAR,),\n  (specialty:TEXT, possible values: dermatology, immunology, general.),\n  (year_reg:INT, year the doctor was registered and obtained license.),\n  (med_school_name:VARCHAR,),\n  (loc_city:VARCHAR,),\n  (loc_state:CHAR,),\n  (loc_zip:VARCHAR,),\n  (bd_cert_num:VARCHAR, board certification number.),\n]\n# Table: patients\n[\n  (patient_id:SERIAL,),\n  (first_name:VARCHAR, Value examples: ['Alice', 'Bob'].),\n  (last_name:VARCHAR, Value examples: ['Johnson', 'Smith'].),\n  (date_of_birth:DATE, Value examples: ['1985-03-15', '1978-11-23'].),\n  (date_of_registration:DATE, Value examples: ['2023-01-03', '2023-01-10'].),\n  (gender:VARCHAR, Male, Female, Others. Value examples: ['Female', 'Male'].),\n  (email:VARCHAR, Value examples: ['alice@email.com', 'bob@email.com'].),\n  (phone:VARCHAR, Value examples: ['555-123-4567', '555-987-6543'].),\n  (addr_street:VARCHAR, Value examples: ['123 Main St', '456 Oak Ave'].),\n  (addr_city:VARCHAR, Value examples: ['Anytown', 'Somecity'].),\n  (addr_state:CHAR, Value examples: ['CA', 'NY'].),\n  (addr_zip:VARCHAR, Value examples: ['12345', '54321'].),\n  (ins_type:TEXT, Insurance type. Possible values: private, medicare, medicaid, uninsured. Value examples: ['private', 'medicare'].),\n  (ins_policy_num:VARCHAR, Insurance policy number. Value examples: ['ABC123456', 'XYZ789012'].),\n  (height_cm:FLOAT, Value examples: ['165', '180'].),\n  (weight_kg:FLOAT, Value examples: ['60', '85'].),\n]\n# Table: drugs\n[\n  (drug_id:SERIAL,),\n  (drug_name:VARCHAR, Value examples: ['Drugalin', 'Medicol'].),\n  (manufacturer:VARCHAR, Value examples: ['Pharma Inc', 'Acme Pharma'].),\n  (drug_type:TEXT, possible values: biologic, small molecule, topical. Value examples: ['biologic', 'small molecule'].),\n  (moa:TEXT, mechanism of action. Value examples: ['TNF-alpha inhibitor', 'IL-17A inhibitor'].),\n  (fda_appr_dt:DATE, FDA approval date. NULL if drug is still under trial.. Value examples: ['2010-01-15', '2015-06-30'].),\n  (admin_route:TEXT, possible values: oral, injection, topical. Value examples: ['injection', 'oral'].),\n  (dos_amt:DECIMAL, recommended dosage amount. Value examples: ['40', '30'].),\n  (dos_unit:VARCHAR, recommended dosage unit. Value examples: ['mg', 'mg'].),\n  (dos_freq_hrs:INT, recommended number of hours between dosages. Value examples: ['336', '24'].),\n  (ndc:VARCHAR, National Drug Code. Value examples: ['12345-678-90', '54321-012-34'].),\n]\n# Table: diagnoses\n[\n  (diag_id:SERIAL,),\n  (diag_code:VARCHAR, Value examples: ['L40.1', 'L40.51'].),\n  (diag_name:VARCHAR, Value examples: ['Generalized pustular psoriasis', 'Distal interphalangeal psoriatic arthropathy'].),\n  (diag_desc:TEXT, Value examples: ['Widespread pustules on top of red skin', 'Psoriatic arthritis mainly affecting the ends of fingers and toes'].),\n]\n# Table: treatments\n[\n  (treatment_id:SERIAL,),\n  (patient_id:INT,),\n  (doc_id:INT,),\n  (drug_id:INT,),\n  (diag_id:INT,),\n  (start_dt:DATE,),\n  (end_dt:DATE, NULL if treatment is ongoing.),\n  (is_placebo:BOOLEAN,),\n  (tot_drug_amt:DECIMAL,),\n  (drug_unit:TEXT, possible values: mg, ml, g.),\n]\n# Table: outcomes\n[\n  (outcome_id:SERIAL,),\n  (treatment_id:INT, Value examples: ['1', '2', '3', '4'].),\n  (assess_dt:DATE, Value examples: ['2022-01-08', '2022-02-22', '2022-03-17', '2022-04-08'].),\n  (day7_lesion_cnt:INT, lesion counts on day 7.. Value examples: ['20', '25', '18', '30'].),\n  (day30_lesion_cnt:INT, Value examples: ['15', '18', '12', '25'].),\n  (day100_lesion_cnt:INT, Value examples: ['5', '8', '3', '12'].),\n  (day7_pasi_score:DECIMAL, PASI score range 0-72. Value examples: ['12.5', '15.0', '10.8', '18.2'].),\n  (day30_pasi_score:DECIMAL, Value examples: ['8.2', '10.1', '6.4', '13.9'].),\n  (day100_pasi_score:DECIMAL, Value examples: ['2.1', '3.5', '1.2', '5.8'].),\n  (day7_tewl:DECIMAL, in g/m^2/h. Value examples: ['18.2', '20.1', '16.5', '22.4'].),\n  (day30_tewl:DECIMAL, Value examples: ['15.6', '17.2', '14.0', '19.1'].),\n  (day100_tewl:DECIMAL, Value examples: ['12.1', '13.5', '10.8', '15.2'].),\n  (day7_itch_vas:INT, visual analog scale 0-100. Value examples: ['60', '70', '55', '80'].),\n  (day30_itch_vas:INT, Value examples: ['40', '50', '35', '60'].),\n  (day100_itch_vas:INT, Value examples: ['20', '30', '15', '40'].),\n  (day7_hfg:DECIMAL, hair growth factor range 0-5. Value examples: ['1.5', '1.0', '2.0', '0.5'].),\n  (day30_hfg:DECIMAL, Value examples: ['2.5', '2.0', '3.0', '1.5'].),\n  (day100_hfg:DECIMAL, Value examples: ['4.0', '3.5', '4.5', '3.0'].),\n]\n# Table: adverse_events\n[\n  (id:SERIAL, 1 row per adverse event per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '5'].),\n  (reported_dt:DATE, Value examples: ['2022-01-15', '2022-05-20'].),\n  (description:TEXT, Value examples: ['Mild injection site reaction', 'Upper respiratory infection'].),\n]\n# Table: concomitant_meds\n[\n  (id:SERIAL, 1 row per med per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '1', '2', '3'].),\n  (med_name:VARCHAR, Value examples: ['Acetaminophen', 'Ibuprofen', 'Loratadine', 'Multivitamin'].),\n  (start_dt:TEXT, YYYY-MM-DD. Value examples: ['2022-01-01', '2022-01-08', '2022-02-15', '2022-03-10'].),\n  (end_dt:TEXT, YYYY-MM-DD NULL if still taking. Value examples: ['2022-01-07', '2022-01-14', '2022-03-15', 'NULL'].),\n  (dose_amt:DECIMAL, Value examples: ['500', '200', '10', '1'].),\n  (dose_unit:TEXT, possible values: mg, ml, g. Value examples: ['mg', 'mg', 'mg', 'tablet'].),\n  (freq_hrs:INT, Value examples: ['6', '8', '24', '24'].),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nWhat are the top 5 drugs by number of treatments and average drug amount per treatment? Return the drug name, number of treatments, and average drug amount.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT d.drug_name, COUNT(*) AS num_treatments, AVG(t.tot_drug_amt) AS avg_drug_amt FROM treatments t JOIN drugs d ON t.drug_id = d.drug_id GROUP BY d.drug_name ORDER BY num_treatments DESC, avg_drug_amt DESC LIMIT 5",
        "role": "assistant"
      }
    ],
    "db_name": "derm_treatment",
    "id": 222,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the top 3 diagnoses by maximum itch VAS score at day 100 and number of distinct patients? Return the diagnosis name, number of patients, and maximum itch score.\n\n【数据库schema】\n【DB_ID】 derm_treatment\n【Schema】\n# Table: doctors\n[\n  (doc_id:SERIAL,),\n  (first_name:VARCHAR,),\n  (last_name:VARCHAR,),\n  (specialty:TEXT, possible values: dermatology, immunology, general.),\n  (year_reg:INT, year the doctor was registered and obtained license.),\n  (med_school_name:VARCHAR,),\n  (loc_city:VARCHAR,),\n  (loc_state:CHAR,),\n  (loc_zip:VARCHAR,),\n  (bd_cert_num:VARCHAR, board certification number.),\n]\n# Table: patients\n[\n  (patient_id:SERIAL,),\n  (first_name:VARCHAR, Value examples: ['Alice', 'Bob'].),\n  (last_name:VARCHAR, Value examples: ['Johnson', 'Smith'].),\n  (date_of_birth:DATE, Value examples: ['1985-03-15', '1978-11-23'].),\n  (date_of_registration:DATE, Value examples: ['2023-01-03', '2023-01-10'].),\n  (gender:VARCHAR, Male, Female, Others. Value examples: ['Female', 'Male'].),\n  (email:VARCHAR, Value examples: ['alice@email.com', 'bob@email.com'].),\n  (phone:VARCHAR, Value examples: ['555-123-4567', '555-987-6543'].),\n  (addr_street:VARCHAR, Value examples: ['123 Main St', '456 Oak Ave'].),\n  (addr_city:VARCHAR, Value examples: ['Anytown', 'Somecity'].),\n  (addr_state:CHAR, Value examples: ['CA', 'NY'].),\n  (addr_zip:VARCHAR, Value examples: ['12345', '54321'].),\n  (ins_type:TEXT, Insurance type. Possible values: private, medicare, medicaid, uninsured. Value examples: ['private', 'medicare'].),\n  (ins_policy_num:VARCHAR, Insurance policy number. Value examples: ['ABC123456', 'XYZ789012'].),\n  (height_cm:FLOAT, Value examples: ['165', '180'].),\n  (weight_kg:FLOAT, Value examples: ['60', '85'].),\n]\n# Table: drugs\n[\n  (drug_id:SERIAL,),\n  (drug_name:VARCHAR, Value examples: ['Drugalin', 'Medicol'].),\n  (manufacturer:VARCHAR, Value examples: ['Pharma Inc', 'Acme Pharma'].),\n  (drug_type:TEXT, possible values: biologic, small molecule, topical. Value examples: ['biologic', 'small molecule'].),\n  (moa:TEXT, mechanism of action. Value examples: ['TNF-alpha inhibitor', 'IL-17A inhibitor'].),\n  (fda_appr_dt:DATE, FDA approval date. NULL if drug is still under trial.. Value examples: ['2010-01-15', '2015-06-30'].),\n  (admin_route:TEXT, possible values: oral, injection, topical. Value examples: ['injection', 'oral'].),\n  (dos_amt:DECIMAL, recommended dosage amount. Value examples: ['40', '30'].),\n  (dos_unit:VARCHAR, recommended dosage unit. Value examples: ['mg', 'mg'].),\n  (dos_freq_hrs:INT, recommended number of hours between dosages. Value examples: ['336', '24'].),\n  (ndc:VARCHAR, National Drug Code. Value examples: ['12345-678-90', '54321-012-34'].),\n]\n# Table: diagnoses\n[\n  (diag_id:SERIAL,),\n  (diag_code:VARCHAR, Value examples: ['L40.1', 'L40.51'].),\n  (diag_name:VARCHAR, Value examples: ['Generalized pustular psoriasis', 'Distal interphalangeal psoriatic arthropathy'].),\n  (diag_desc:TEXT, Value examples: ['Widespread pustules on top of red skin', 'Psoriatic arthritis mainly affecting the ends of fingers and toes'].),\n]\n# Table: treatments\n[\n  (treatment_id:SERIAL,),\n  (patient_id:INT,),\n  (doc_id:INT,),\n  (drug_id:INT,),\n  (diag_id:INT,),\n  (start_dt:DATE,),\n  (end_dt:DATE, NULL if treatment is ongoing.),\n  (is_placebo:BOOLEAN,),\n  (tot_drug_amt:DECIMAL,),\n  (drug_unit:TEXT, possible values: mg, ml, g.),\n]\n# Table: outcomes\n[\n  (outcome_id:SERIAL,),\n  (treatment_id:INT, Value examples: ['1', '2', '3', '4'].),\n  (assess_dt:DATE, Value examples: ['2022-01-08', '2022-02-22', '2022-03-17', '2022-04-08'].),\n  (day7_lesion_cnt:INT, lesion counts on day 7.. Value examples: ['20', '25', '18', '30'].),\n  (day30_lesion_cnt:INT, Value examples: ['15', '18', '12', '25'].),\n  (day100_lesion_cnt:INT, Value examples: ['5', '8', '3', '12'].),\n  (day7_pasi_score:DECIMAL, PASI score range 0-72. Value examples: ['12.5', '15.0', '10.8', '18.2'].),\n  (day30_pasi_score:DECIMAL, Value examples: ['8.2', '10.1', '6.4', '13.9'].),\n  (day100_pasi_score:DECIMAL, Value examples: ['2.1', '3.5', '1.2', '5.8'].),\n  (day7_tewl:DECIMAL, in g/m^2/h. Value examples: ['18.2', '20.1', '16.5', '22.4'].),\n  (day30_tewl:DECIMAL, Value examples: ['15.6', '17.2', '14.0', '19.1'].),\n  (day100_tewl:DECIMAL, Value examples: ['12.1', '13.5', '10.8', '15.2'].),\n  (day7_itch_vas:INT, visual analog scale 0-100. Value examples: ['60', '70', '55', '80'].),\n  (day30_itch_vas:INT, Value examples: ['40', '50', '35', '60'].),\n  (day100_itch_vas:INT, Value examples: ['20', '30', '15', '40'].),\n  (day7_hfg:DECIMAL, hair growth factor range 0-5. Value examples: ['1.5', '1.0', '2.0', '0.5'].),\n  (day30_hfg:DECIMAL, Value examples: ['2.5', '2.0', '3.0', '1.5'].),\n  (day100_hfg:DECIMAL, Value examples: ['4.0', '3.5', '4.5', '3.0'].),\n]\n# Table: adverse_events\n[\n  (id:SERIAL, 1 row per adverse event per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '5'].),\n  (reported_dt:DATE, Value examples: ['2022-01-15', '2022-05-20'].),\n  (description:TEXT, Value examples: ['Mild injection site reaction', 'Upper respiratory infection'].),\n]\n# Table: concomitant_meds\n[\n  (id:SERIAL, 1 row per med per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '1', '2', '3'].),\n  (med_name:VARCHAR, Value examples: ['Acetaminophen', 'Ibuprofen', 'Loratadine', 'Multivitamin'].),\n  (start_dt:TEXT, YYYY-MM-DD. Value examples: ['2022-01-01', '2022-01-08', '2022-02-15', '2022-03-10'].),\n  (end_dt:TEXT, YYYY-MM-DD NULL if still taking. Value examples: ['2022-01-07', '2022-01-14', '2022-03-15', 'NULL'].),\n  (dose_amt:DECIMAL, Value examples: ['500', '200', '10', '1'].),\n  (dose_unit:TEXT, possible values: mg, ml, g. Value examples: ['mg', 'mg', 'mg', 'tablet'].),\n  (freq_hrs:INT, Value examples: ['6', '8', '24', '24'].),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nWhat are the top 3 diagnoses by maximum itch VAS score at day 100 and number of distinct patients? Return the diagnosis name, number of patients, and maximum itch score.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT di.diag_name, COUNT(DISTINCT t.patient_id) AS num_patients, MAX(o.day100_itch_vas) AS max_itch_score FROM treatments t JOIN diagnoses di ON t.diag_id = di.diag_id JOIN outcomes o ON t.treatment_id = o.treatment_id GROUP BY di.diag_name ORDER BY max_itch_score DESC, num_patients DESC LIMIT 3",
        "role": "assistant"
      }
    ],
    "db_name": "derm_treatment",
    "id": 223,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nReturn the distinct list of doctor IDs, first names and last names that have prescribed treatments.\n\n【数据库schema】\n【DB_ID】 derm_treatment\n【Schema】\n# Table: doctors\n[\n  (doc_id:SERIAL,),\n  (first_name:VARCHAR,),\n  (last_name:VARCHAR,),\n  (specialty:TEXT, possible values: dermatology, immunology, general.),\n  (year_reg:INT, year the doctor was registered and obtained license.),\n  (med_school_name:VARCHAR,),\n  (loc_city:VARCHAR,),\n  (loc_state:CHAR,),\n  (loc_zip:VARCHAR,),\n  (bd_cert_num:VARCHAR, board certification number.),\n]\n# Table: patients\n[\n  (patient_id:SERIAL,),\n  (first_name:VARCHAR, Value examples: ['Alice', 'Bob'].),\n  (last_name:VARCHAR, Value examples: ['Johnson', 'Smith'].),\n  (date_of_birth:DATE, Value examples: ['1985-03-15', '1978-11-23'].),\n  (date_of_registration:DATE, Value examples: ['2023-01-03', '2023-01-10'].),\n  (gender:VARCHAR, Male, Female, Others. Value examples: ['Female', 'Male'].),\n  (email:VARCHAR, Value examples: ['alice@email.com', 'bob@email.com'].),\n  (phone:VARCHAR, Value examples: ['555-123-4567', '555-987-6543'].),\n  (addr_street:VARCHAR, Value examples: ['123 Main St', '456 Oak Ave'].),\n  (addr_city:VARCHAR, Value examples: ['Anytown', 'Somecity'].),\n  (addr_state:CHAR, Value examples: ['CA', 'NY'].),\n  (addr_zip:VARCHAR, Value examples: ['12345', '54321'].),\n  (ins_type:TEXT, Insurance type. Possible values: private, medicare, medicaid, uninsured. Value examples: ['private', 'medicare'].),\n  (ins_policy_num:VARCHAR, Insurance policy number. Value examples: ['ABC123456', 'XYZ789012'].),\n  (height_cm:FLOAT, Value examples: ['165', '180'].),\n  (weight_kg:FLOAT, Value examples: ['60', '85'].),\n]\n# Table: drugs\n[\n  (drug_id:SERIAL,),\n  (drug_name:VARCHAR, Value examples: ['Drugalin', 'Medicol'].),\n  (manufacturer:VARCHAR, Value examples: ['Pharma Inc', 'Acme Pharma'].),\n  (drug_type:TEXT, possible values: biologic, small molecule, topical. Value examples: ['biologic', 'small molecule'].),\n  (moa:TEXT, mechanism of action. Value examples: ['TNF-alpha inhibitor', 'IL-17A inhibitor'].),\n  (fda_appr_dt:DATE, FDA approval date. NULL if drug is still under trial.. Value examples: ['2010-01-15', '2015-06-30'].),\n  (admin_route:TEXT, possible values: oral, injection, topical. Value examples: ['injection', 'oral'].),\n  (dos_amt:DECIMAL, recommended dosage amount. Value examples: ['40', '30'].),\n  (dos_unit:VARCHAR, recommended dosage unit. Value examples: ['mg', 'mg'].),\n  (dos_freq_hrs:INT, recommended number of hours between dosages. Value examples: ['336', '24'].),\n  (ndc:VARCHAR, National Drug Code. Value examples: ['12345-678-90', '54321-012-34'].),\n]\n# Table: diagnoses\n[\n  (diag_id:SERIAL,),\n  (diag_code:VARCHAR, Value examples: ['L40.1', 'L40.51'].),\n  (diag_name:VARCHAR, Value examples: ['Generalized pustular psoriasis', 'Distal interphalangeal psoriatic arthropathy'].),\n  (diag_desc:TEXT, Value examples: ['Widespread pustules on top of red skin', 'Psoriatic arthritis mainly affecting the ends of fingers and toes'].),\n]\n# Table: treatments\n[\n  (treatment_id:SERIAL,),\n  (patient_id:INT,),\n  (doc_id:INT,),\n  (drug_id:INT,),\n  (diag_id:INT,),\n  (start_dt:DATE,),\n  (end_dt:DATE, NULL if treatment is ongoing.),\n  (is_placebo:BOOLEAN,),\n  (tot_drug_amt:DECIMAL,),\n  (drug_unit:TEXT, possible values: mg, ml, g.),\n]\n# Table: outcomes\n[\n  (outcome_id:SERIAL,),\n  (treatment_id:INT, Value examples: ['1', '2', '3', '4'].),\n  (assess_dt:DATE, Value examples: ['2022-01-08', '2022-02-22', '2022-03-17', '2022-04-08'].),\n  (day7_lesion_cnt:INT, lesion counts on day 7.. Value examples: ['20', '25', '18', '30'].),\n  (day30_lesion_cnt:INT, Value examples: ['15', '18', '12', '25'].),\n  (day100_lesion_cnt:INT, Value examples: ['5', '8', '3', '12'].),\n  (day7_pasi_score:DECIMAL, PASI score range 0-72. Value examples: ['12.5', '15.0', '10.8', '18.2'].),\n  (day30_pasi_score:DECIMAL, Value examples: ['8.2', '10.1', '6.4', '13.9'].),\n  (day100_pasi_score:DECIMAL, Value examples: ['2.1', '3.5', '1.2', '5.8'].),\n  (day7_tewl:DECIMAL, in g/m^2/h. Value examples: ['18.2', '20.1', '16.5', '22.4'].),\n  (day30_tewl:DECIMAL, Value examples: ['15.6', '17.2', '14.0', '19.1'].),\n  (day100_tewl:DECIMAL, Value examples: ['12.1', '13.5', '10.8', '15.2'].),\n  (day7_itch_vas:INT, visual analog scale 0-100. Value examples: ['60', '70', '55', '80'].),\n  (day30_itch_vas:INT, Value examples: ['40', '50', '35', '60'].),\n  (day100_itch_vas:INT, Value examples: ['20', '30', '15', '40'].),\n  (day7_hfg:DECIMAL, hair growth factor range 0-5. Value examples: ['1.5', '1.0', '2.0', '0.5'].),\n  (day30_hfg:DECIMAL, Value examples: ['2.5', '2.0', '3.0', '1.5'].),\n  (day100_hfg:DECIMAL, Value examples: ['4.0', '3.5', '4.5', '3.0'].),\n]\n# Table: adverse_events\n[\n  (id:SERIAL, 1 row per adverse event per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '5'].),\n  (reported_dt:DATE, Value examples: ['2022-01-15', '2022-05-20'].),\n  (description:TEXT, Value examples: ['Mild injection site reaction', 'Upper respiratory infection'].),\n]\n# Table: concomitant_meds\n[\n  (id:SERIAL, 1 row per med per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '1', '2', '3'].),\n  (med_name:VARCHAR, Value examples: ['Acetaminophen', 'Ibuprofen', 'Loratadine', 'Multivitamin'].),\n  (start_dt:TEXT, YYYY-MM-DD. Value examples: ['2022-01-01', '2022-01-08', '2022-02-15', '2022-03-10'].),\n  (end_dt:TEXT, YYYY-MM-DD NULL if still taking. Value examples: ['2022-01-07', '2022-01-14', '2022-03-15', 'NULL'].),\n  (dose_amt:DECIMAL, Value examples: ['500', '200', '10', '1'].),\n  (dose_unit:TEXT, possible values: mg, ml, g. Value examples: ['mg', 'mg', 'mg', 'tablet'].),\n  (freq_hrs:INT, Value examples: ['6', '8', '24', '24'].),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nReturn the distinct list of doctor IDs, first names and last names that have prescribed treatments.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT DISTINCT d.doc_id, d.first_name, d.last_name FROM treatments t JOIN doctors d ON t.doc_id = d.doc_id",
        "role": "assistant"
      }
    ],
    "db_name": "derm_treatment",
    "id": 224,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nReturn the distinct list of patient IDs, first names and last names that have outcome assessments.\n\n【数据库schema】\n【DB_ID】 derm_treatment\n【Schema】\n# Table: doctors\n[\n  (doc_id:SERIAL,),\n  (first_name:VARCHAR,),\n  (last_name:VARCHAR,),\n  (specialty:TEXT, possible values: dermatology, immunology, general.),\n  (year_reg:INT, year the doctor was registered and obtained license.),\n  (med_school_name:VARCHAR,),\n  (loc_city:VARCHAR,),\n  (loc_state:CHAR,),\n  (loc_zip:VARCHAR,),\n  (bd_cert_num:VARCHAR, board certification number.),\n]\n# Table: patients\n[\n  (patient_id:SERIAL,),\n  (first_name:VARCHAR, Value examples: ['Alice', 'Bob'].),\n  (last_name:VARCHAR, Value examples: ['Johnson', 'Smith'].),\n  (date_of_birth:DATE, Value examples: ['1985-03-15', '1978-11-23'].),\n  (date_of_registration:DATE, Value examples: ['2023-01-03', '2023-01-10'].),\n  (gender:VARCHAR, Male, Female, Others. Value examples: ['Female', 'Male'].),\n  (email:VARCHAR, Value examples: ['alice@email.com', 'bob@email.com'].),\n  (phone:VARCHAR, Value examples: ['555-123-4567', '555-987-6543'].),\n  (addr_street:VARCHAR, Value examples: ['123 Main St', '456 Oak Ave'].),\n  (addr_city:VARCHAR, Value examples: ['Anytown', 'Somecity'].),\n  (addr_state:CHAR, Value examples: ['CA', 'NY'].),\n  (addr_zip:VARCHAR, Value examples: ['12345', '54321'].),\n  (ins_type:TEXT, Insurance type. Possible values: private, medicare, medicaid, uninsured. Value examples: ['private', 'medicare'].),\n  (ins_policy_num:VARCHAR, Insurance policy number. Value examples: ['ABC123456', 'XYZ789012'].),\n  (height_cm:FLOAT, Value examples: ['165', '180'].),\n  (weight_kg:FLOAT, Value examples: ['60', '85'].),\n]\n# Table: drugs\n[\n  (drug_id:SERIAL,),\n  (drug_name:VARCHAR, Value examples: ['Drugalin', 'Medicol'].),\n  (manufacturer:VARCHAR, Value examples: ['Pharma Inc', 'Acme Pharma'].),\n  (drug_type:TEXT, possible values: biologic, small molecule, topical. Value examples: ['biologic', 'small molecule'].),\n  (moa:TEXT, mechanism of action. Value examples: ['TNF-alpha inhibitor', 'IL-17A inhibitor'].),\n  (fda_appr_dt:DATE, FDA approval date. NULL if drug is still under trial.. Value examples: ['2010-01-15', '2015-06-30'].),\n  (admin_route:TEXT, possible values: oral, injection, topical. Value examples: ['injection', 'oral'].),\n  (dos_amt:DECIMAL, recommended dosage amount. Value examples: ['40', '30'].),\n  (dos_unit:VARCHAR, recommended dosage unit. Value examples: ['mg', 'mg'].),\n  (dos_freq_hrs:INT, recommended number of hours between dosages. Value examples: ['336', '24'].),\n  (ndc:VARCHAR, National Drug Code. Value examples: ['12345-678-90', '54321-012-34'].),\n]\n# Table: diagnoses\n[\n  (diag_id:SERIAL,),\n  (diag_code:VARCHAR, Value examples: ['L40.1', 'L40.51'].),\n  (diag_name:VARCHAR, Value examples: ['Generalized pustular psoriasis', 'Distal interphalangeal psoriatic arthropathy'].),\n  (diag_desc:TEXT, Value examples: ['Widespread pustules on top of red skin', 'Psoriatic arthritis mainly affecting the ends of fingers and toes'].),\n]\n# Table: treatments\n[\n  (treatment_id:SERIAL,),\n  (patient_id:INT,),\n  (doc_id:INT,),\n  (drug_id:INT,),\n  (diag_id:INT,),\n  (start_dt:DATE,),\n  (end_dt:DATE, NULL if treatment is ongoing.),\n  (is_placebo:BOOLEAN,),\n  (tot_drug_amt:DECIMAL,),\n  (drug_unit:TEXT, possible values: mg, ml, g.),\n]\n# Table: outcomes\n[\n  (outcome_id:SERIAL,),\n  (treatment_id:INT, Value examples: ['1', '2', '3', '4'].),\n  (assess_dt:DATE, Value examples: ['2022-01-08', '2022-02-22', '2022-03-17', '2022-04-08'].),\n  (day7_lesion_cnt:INT, lesion counts on day 7.. Value examples: ['20', '25', '18', '30'].),\n  (day30_lesion_cnt:INT, Value examples: ['15', '18', '12', '25'].),\n  (day100_lesion_cnt:INT, Value examples: ['5', '8', '3', '12'].),\n  (day7_pasi_score:DECIMAL, PASI score range 0-72. Value examples: ['12.5', '15.0', '10.8', '18.2'].),\n  (day30_pasi_score:DECIMAL, Value examples: ['8.2', '10.1', '6.4', '13.9'].),\n  (day100_pasi_score:DECIMAL, Value examples: ['2.1', '3.5', '1.2', '5.8'].),\n  (day7_tewl:DECIMAL, in g/m^2/h. Value examples: ['18.2', '20.1', '16.5', '22.4'].),\n  (day30_tewl:DECIMAL, Value examples: ['15.6', '17.2', '14.0', '19.1'].),\n  (day100_tewl:DECIMAL, Value examples: ['12.1', '13.5', '10.8', '15.2'].),\n  (day7_itch_vas:INT, visual analog scale 0-100. Value examples: ['60', '70', '55', '80'].),\n  (day30_itch_vas:INT, Value examples: ['40', '50', '35', '60'].),\n  (day100_itch_vas:INT, Value examples: ['20', '30', '15', '40'].),\n  (day7_hfg:DECIMAL, hair growth factor range 0-5. Value examples: ['1.5', '1.0', '2.0', '0.5'].),\n  (day30_hfg:DECIMAL, Value examples: ['2.5', '2.0', '3.0', '1.5'].),\n  (day100_hfg:DECIMAL, Value examples: ['4.0', '3.5', '4.5', '3.0'].),\n]\n# Table: adverse_events\n[\n  (id:SERIAL, 1 row per adverse event per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '5'].),\n  (reported_dt:DATE, Value examples: ['2022-01-15', '2022-05-20'].),\n  (description:TEXT, Value examples: ['Mild injection site reaction', 'Upper respiratory infection'].),\n]\n# Table: concomitant_meds\n[\n  (id:SERIAL, 1 row per med per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '1', '2', '3'].),\n  (med_name:VARCHAR, Value examples: ['Acetaminophen', 'Ibuprofen', 'Loratadine', 'Multivitamin'].),\n  (start_dt:TEXT, YYYY-MM-DD. Value examples: ['2022-01-01', '2022-01-08', '2022-02-15', '2022-03-10'].),\n  (end_dt:TEXT, YYYY-MM-DD NULL if still taking. Value examples: ['2022-01-07', '2022-01-14', '2022-03-15', 'NULL'].),\n  (dose_amt:DECIMAL, Value examples: ['500', '200', '10', '1'].),\n  (dose_unit:TEXT, possible values: mg, ml, g. Value examples: ['mg', 'mg', 'mg', 'tablet'].),\n  (freq_hrs:INT, Value examples: ['6', '8', '24', '24'].),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nReturn the distinct list of patient IDs, first names and last names that have outcome assessments.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT DISTINCT p.patient_id, p.first_name, p.last_name FROM outcomes o JOIN treatments t ON o.treatment_id = t.treatment_id JOIN patients p ON t.patient_id = p.patient_id",
        "role": "assistant"
      }
    ],
    "db_name": "derm_treatment",
    "id": 225,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the top 3 insurance types by average patient height in cm? Return the insurance type, average height and average weight.\n\n【数据库schema】\n【DB_ID】 derm_treatment\n【Schema】\n# Table: doctors\n[\n  (doc_id:SERIAL,),\n  (first_name:VARCHAR,),\n  (last_name:VARCHAR,),\n  (specialty:TEXT, possible values: dermatology, immunology, general.),\n  (year_reg:INT, year the doctor was registered and obtained license.),\n  (med_school_name:VARCHAR,),\n  (loc_city:VARCHAR,),\n  (loc_state:CHAR,),\n  (loc_zip:VARCHAR,),\n  (bd_cert_num:VARCHAR, board certification number.),\n]\n# Table: patients\n[\n  (patient_id:SERIAL,),\n  (first_name:VARCHAR, Value examples: ['Alice', 'Bob'].),\n  (last_name:VARCHAR, Value examples: ['Johnson', 'Smith'].),\n  (date_of_birth:DATE, Value examples: ['1985-03-15', '1978-11-23'].),\n  (date_of_registration:DATE, Value examples: ['2023-01-03', '2023-01-10'].),\n  (gender:VARCHAR, Male, Female, Others. Value examples: ['Female', 'Male'].),\n  (email:VARCHAR, Value examples: ['alice@email.com', 'bob@email.com'].),\n  (phone:VARCHAR, Value examples: ['555-123-4567', '555-987-6543'].),\n  (addr_street:VARCHAR, Value examples: ['123 Main St', '456 Oak Ave'].),\n  (addr_city:VARCHAR, Value examples: ['Anytown', 'Somecity'].),\n  (addr_state:CHAR, Value examples: ['CA', 'NY'].),\n  (addr_zip:VARCHAR, Value examples: ['12345', '54321'].),\n  (ins_type:TEXT, Insurance type. Possible values: private, medicare, medicaid, uninsured. Value examples: ['private', 'medicare'].),\n  (ins_policy_num:VARCHAR, Insurance policy number. Value examples: ['ABC123456', 'XYZ789012'].),\n  (height_cm:FLOAT, Value examples: ['165', '180'].),\n  (weight_kg:FLOAT, Value examples: ['60', '85'].),\n]\n# Table: drugs\n[\n  (drug_id:SERIAL,),\n  (drug_name:VARCHAR, Value examples: ['Drugalin', 'Medicol'].),\n  (manufacturer:VARCHAR, Value examples: ['Pharma Inc', 'Acme Pharma'].),\n  (drug_type:TEXT, possible values: biologic, small molecule, topical. Value examples: ['biologic', 'small molecule'].),\n  (moa:TEXT, mechanism of action. Value examples: ['TNF-alpha inhibitor', 'IL-17A inhibitor'].),\n  (fda_appr_dt:DATE, FDA approval date. NULL if drug is still under trial.. Value examples: ['2010-01-15', '2015-06-30'].),\n  (admin_route:TEXT, possible values: oral, injection, topical. Value examples: ['injection', 'oral'].),\n  (dos_amt:DECIMAL, recommended dosage amount. Value examples: ['40', '30'].),\n  (dos_unit:VARCHAR, recommended dosage unit. Value examples: ['mg', 'mg'].),\n  (dos_freq_hrs:INT, recommended number of hours between dosages. Value examples: ['336', '24'].),\n  (ndc:VARCHAR, National Drug Code. Value examples: ['12345-678-90', '54321-012-34'].),\n]\n# Table: diagnoses\n[\n  (diag_id:SERIAL,),\n  (diag_code:VARCHAR, Value examples: ['L40.1', 'L40.51'].),\n  (diag_name:VARCHAR, Value examples: ['Generalized pustular psoriasis', 'Distal interphalangeal psoriatic arthropathy'].),\n  (diag_desc:TEXT, Value examples: ['Widespread pustules on top of red skin', 'Psoriatic arthritis mainly affecting the ends of fingers and toes'].),\n]\n# Table: treatments\n[\n  (treatment_id:SERIAL,),\n  (patient_id:INT,),\n  (doc_id:INT,),\n  (drug_id:INT,),\n  (diag_id:INT,),\n  (start_dt:DATE,),\n  (end_dt:DATE, NULL if treatment is ongoing.),\n  (is_placebo:BOOLEAN,),\n  (tot_drug_amt:DECIMAL,),\n  (drug_unit:TEXT, possible values: mg, ml, g.),\n]\n# Table: outcomes\n[\n  (outcome_id:SERIAL,),\n  (treatment_id:INT, Value examples: ['1', '2', '3', '4'].),\n  (assess_dt:DATE, Value examples: ['2022-01-08', '2022-02-22', '2022-03-17', '2022-04-08'].),\n  (day7_lesion_cnt:INT, lesion counts on day 7.. Value examples: ['20', '25', '18', '30'].),\n  (day30_lesion_cnt:INT, Value examples: ['15', '18', '12', '25'].),\n  (day100_lesion_cnt:INT, Value examples: ['5', '8', '3', '12'].),\n  (day7_pasi_score:DECIMAL, PASI score range 0-72. Value examples: ['12.5', '15.0', '10.8', '18.2'].),\n  (day30_pasi_score:DECIMAL, Value examples: ['8.2', '10.1', '6.4', '13.9'].),\n  (day100_pasi_score:DECIMAL, Value examples: ['2.1', '3.5', '1.2', '5.8'].),\n  (day7_tewl:DECIMAL, in g/m^2/h. Value examples: ['18.2', '20.1', '16.5', '22.4'].),\n  (day30_tewl:DECIMAL, Value examples: ['15.6', '17.2', '14.0', '19.1'].),\n  (day100_tewl:DECIMAL, Value examples: ['12.1', '13.5', '10.8', '15.2'].),\n  (day7_itch_vas:INT, visual analog scale 0-100. Value examples: ['60', '70', '55', '80'].),\n  (day30_itch_vas:INT, Value examples: ['40', '50', '35', '60'].),\n  (day100_itch_vas:INT, Value examples: ['20', '30', '15', '40'].),\n  (day7_hfg:DECIMAL, hair growth factor range 0-5. Value examples: ['1.5', '1.0', '2.0', '0.5'].),\n  (day30_hfg:DECIMAL, Value examples: ['2.5', '2.0', '3.0', '1.5'].),\n  (day100_hfg:DECIMAL, Value examples: ['4.0', '3.5', '4.5', '3.0'].),\n]\n# Table: adverse_events\n[\n  (id:SERIAL, 1 row per adverse event per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '5'].),\n  (reported_dt:DATE, Value examples: ['2022-01-15', '2022-05-20'].),\n  (description:TEXT, Value examples: ['Mild injection site reaction', 'Upper respiratory infection'].),\n]\n# Table: concomitant_meds\n[\n  (id:SERIAL, 1 row per med per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '1', '2', '3'].),\n  (med_name:VARCHAR, Value examples: ['Acetaminophen', 'Ibuprofen', 'Loratadine', 'Multivitamin'].),\n  (start_dt:TEXT, YYYY-MM-DD. Value examples: ['2022-01-01', '2022-01-08', '2022-02-15', '2022-03-10'].),\n  (end_dt:TEXT, YYYY-MM-DD NULL if still taking. Value examples: ['2022-01-07', '2022-01-14', '2022-03-15', 'NULL'].),\n  (dose_amt:DECIMAL, Value examples: ['500', '200', '10', '1'].),\n  (dose_unit:TEXT, possible values: mg, ml, g. Value examples: ['mg', 'mg', 'mg', 'tablet'].),\n  (freq_hrs:INT, Value examples: ['6', '8', '24', '24'].),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nWhat are the top 3 insurance types by average patient height in cm? Return the insurance type, average height and average weight.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT ins_type, AVG(height_cm) AS avg_height, AVG(weight_kg) AS avg_weight FROM patients GROUP BY ins_type ORDER BY avg_height DESC LIMIT 3",
        "role": "assistant"
      }
    ],
    "db_name": "derm_treatment",
    "id": 226,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the top 2 specialties by number of doctors? Return the specialty and number of doctors.\n\n【数据库schema】\n【DB_ID】 derm_treatment\n【Schema】\n# Table: doctors\n[\n  (doc_id:SERIAL,),\n  (first_name:VARCHAR,),\n  (last_name:VARCHAR,),\n  (specialty:TEXT, possible values: dermatology, immunology, general.),\n  (year_reg:INT, year the doctor was registered and obtained license.),\n  (med_school_name:VARCHAR,),\n  (loc_city:VARCHAR,),\n  (loc_state:CHAR,),\n  (loc_zip:VARCHAR,),\n  (bd_cert_num:VARCHAR, board certification number.),\n]\n# Table: patients\n[\n  (patient_id:SERIAL,),\n  (first_name:VARCHAR, Value examples: ['Alice', 'Bob'].),\n  (last_name:VARCHAR, Value examples: ['Johnson', 'Smith'].),\n  (date_of_birth:DATE, Value examples: ['1985-03-15', '1978-11-23'].),\n  (date_of_registration:DATE, Value examples: ['2023-01-03', '2023-01-10'].),\n  (gender:VARCHAR, Male, Female, Others. Value examples: ['Female', 'Male'].),\n  (email:VARCHAR, Value examples: ['alice@email.com', 'bob@email.com'].),\n  (phone:VARCHAR, Value examples: ['555-123-4567', '555-987-6543'].),\n  (addr_street:VARCHAR, Value examples: ['123 Main St', '456 Oak Ave'].),\n  (addr_city:VARCHAR, Value examples: ['Anytown', 'Somecity'].),\n  (addr_state:CHAR, Value examples: ['CA', 'NY'].),\n  (addr_zip:VARCHAR, Value examples: ['12345', '54321'].),\n  (ins_type:TEXT, Insurance type. Possible values: private, medicare, medicaid, uninsured. Value examples: ['private', 'medicare'].),\n  (ins_policy_num:VARCHAR, Insurance policy number. Value examples: ['ABC123456', 'XYZ789012'].),\n  (height_cm:FLOAT, Value examples: ['165', '180'].),\n  (weight_kg:FLOAT, Value examples: ['60', '85'].),\n]\n# Table: drugs\n[\n  (drug_id:SERIAL,),\n  (drug_name:VARCHAR, Value examples: ['Drugalin', 'Medicol'].),\n  (manufacturer:VARCHAR, Value examples: ['Pharma Inc', 'Acme Pharma'].),\n  (drug_type:TEXT, possible values: biologic, small molecule, topical. Value examples: ['biologic', 'small molecule'].),\n  (moa:TEXT, mechanism of action. Value examples: ['TNF-alpha inhibitor', 'IL-17A inhibitor'].),\n  (fda_appr_dt:DATE, FDA approval date. NULL if drug is still under trial.. Value examples: ['2010-01-15', '2015-06-30'].),\n  (admin_route:TEXT, possible values: oral, injection, topical. Value examples: ['injection', 'oral'].),\n  (dos_amt:DECIMAL, recommended dosage amount. Value examples: ['40', '30'].),\n  (dos_unit:VARCHAR, recommended dosage unit. Value examples: ['mg', 'mg'].),\n  (dos_freq_hrs:INT, recommended number of hours between dosages. Value examples: ['336', '24'].),\n  (ndc:VARCHAR, National Drug Code. Value examples: ['12345-678-90', '54321-012-34'].),\n]\n# Table: diagnoses\n[\n  (diag_id:SERIAL,),\n  (diag_code:VARCHAR, Value examples: ['L40.1', 'L40.51'].),\n  (diag_name:VARCHAR, Value examples: ['Generalized pustular psoriasis', 'Distal interphalangeal psoriatic arthropathy'].),\n  (diag_desc:TEXT, Value examples: ['Widespread pustules on top of red skin', 'Psoriatic arthritis mainly affecting the ends of fingers and toes'].),\n]\n# Table: treatments\n[\n  (treatment_id:SERIAL,),\n  (patient_id:INT,),\n  (doc_id:INT,),\n  (drug_id:INT,),\n  (diag_id:INT,),\n  (start_dt:DATE,),\n  (end_dt:DATE, NULL if treatment is ongoing.),\n  (is_placebo:BOOLEAN,),\n  (tot_drug_amt:DECIMAL,),\n  (drug_unit:TEXT, possible values: mg, ml, g.),\n]\n# Table: outcomes\n[\n  (outcome_id:SERIAL,),\n  (treatment_id:INT, Value examples: ['1', '2', '3', '4'].),\n  (assess_dt:DATE, Value examples: ['2022-01-08', '2022-02-22', '2022-03-17', '2022-04-08'].),\n  (day7_lesion_cnt:INT, lesion counts on day 7.. Value examples: ['20', '25', '18', '30'].),\n  (day30_lesion_cnt:INT, Value examples: ['15', '18', '12', '25'].),\n  (day100_lesion_cnt:INT, Value examples: ['5', '8', '3', '12'].),\n  (day7_pasi_score:DECIMAL, PASI score range 0-72. Value examples: ['12.5', '15.0', '10.8', '18.2'].),\n  (day30_pasi_score:DECIMAL, Value examples: ['8.2', '10.1', '6.4', '13.9'].),\n  (day100_pasi_score:DECIMAL, Value examples: ['2.1', '3.5', '1.2', '5.8'].),\n  (day7_tewl:DECIMAL, in g/m^2/h. Value examples: ['18.2', '20.1', '16.5', '22.4'].),\n  (day30_tewl:DECIMAL, Value examples: ['15.6', '17.2', '14.0', '19.1'].),\n  (day100_tewl:DECIMAL, Value examples: ['12.1', '13.5', '10.8', '15.2'].),\n  (day7_itch_vas:INT, visual analog scale 0-100. Value examples: ['60', '70', '55', '80'].),\n  (day30_itch_vas:INT, Value examples: ['40', '50', '35', '60'].),\n  (day100_itch_vas:INT, Value examples: ['20', '30', '15', '40'].),\n  (day7_hfg:DECIMAL, hair growth factor range 0-5. Value examples: ['1.5', '1.0', '2.0', '0.5'].),\n  (day30_hfg:DECIMAL, Value examples: ['2.5', '2.0', '3.0', '1.5'].),\n  (day100_hfg:DECIMAL, Value examples: ['4.0', '3.5', '4.5', '3.0'].),\n]\n# Table: adverse_events\n[\n  (id:SERIAL, 1 row per adverse event per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '5'].),\n  (reported_dt:DATE, Value examples: ['2022-01-15', '2022-05-20'].),\n  (description:TEXT, Value examples: ['Mild injection site reaction', 'Upper respiratory infection'].),\n]\n# Table: concomitant_meds\n[\n  (id:SERIAL, 1 row per med per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '1', '2', '3'].),\n  (med_name:VARCHAR, Value examples: ['Acetaminophen', 'Ibuprofen', 'Loratadine', 'Multivitamin'].),\n  (start_dt:TEXT, YYYY-MM-DD. Value examples: ['2022-01-01', '2022-01-08', '2022-02-15', '2022-03-10'].),\n  (end_dt:TEXT, YYYY-MM-DD NULL if still taking. Value examples: ['2022-01-07', '2022-01-14', '2022-03-15', 'NULL'].),\n  (dose_amt:DECIMAL, Value examples: ['500', '200', '10', '1'].),\n  (dose_unit:TEXT, possible values: mg, ml, g. Value examples: ['mg', 'mg', 'mg', 'tablet'].),\n  (freq_hrs:INT, Value examples: ['6', '8', '24', '24'].),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nWhat are the top 2 specialties by number of doctors? Return the specialty and number of doctors.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT specialty, COUNT(*) AS num_doctors FROM doctors GROUP BY specialty ORDER BY num_doctors DESC LIMIT 2",
        "role": "assistant"
      }
    ],
    "db_name": "derm_treatment",
    "id": 227,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nReturn the patient IDs, first names and last names of patients who have not received any treatments.\n\n【数据库schema】\n【DB_ID】 derm_treatment\n【Schema】\n# Table: doctors\n[\n  (doc_id:SERIAL,),\n  (first_name:VARCHAR,),\n  (last_name:VARCHAR,),\n  (specialty:TEXT, possible values: dermatology, immunology, general.),\n  (year_reg:INT, year the doctor was registered and obtained license.),\n  (med_school_name:VARCHAR,),\n  (loc_city:VARCHAR,),\n  (loc_state:CHAR,),\n  (loc_zip:VARCHAR,),\n  (bd_cert_num:VARCHAR, board certification number.),\n]\n# Table: patients\n[\n  (patient_id:SERIAL,),\n  (first_name:VARCHAR, Value examples: ['Alice', 'Bob'].),\n  (last_name:VARCHAR, Value examples: ['Johnson', 'Smith'].),\n  (date_of_birth:DATE, Value examples: ['1985-03-15', '1978-11-23'].),\n  (date_of_registration:DATE, Value examples: ['2023-01-03', '2023-01-10'].),\n  (gender:VARCHAR, Male, Female, Others. Value examples: ['Female', 'Male'].),\n  (email:VARCHAR, Value examples: ['alice@email.com', 'bob@email.com'].),\n  (phone:VARCHAR, Value examples: ['555-123-4567', '555-987-6543'].),\n  (addr_street:VARCHAR, Value examples: ['123 Main St', '456 Oak Ave'].),\n  (addr_city:VARCHAR, Value examples: ['Anytown', 'Somecity'].),\n  (addr_state:CHAR, Value examples: ['CA', 'NY'].),\n  (addr_zip:VARCHAR, Value examples: ['12345', '54321'].),\n  (ins_type:TEXT, Insurance type. Possible values: private, medicare, medicaid, uninsured. Value examples: ['private', 'medicare'].),\n  (ins_policy_num:VARCHAR, Insurance policy number. Value examples: ['ABC123456', 'XYZ789012'].),\n  (height_cm:FLOAT, Value examples: ['165', '180'].),\n  (weight_kg:FLOAT, Value examples: ['60', '85'].),\n]\n# Table: drugs\n[\n  (drug_id:SERIAL,),\n  (drug_name:VARCHAR, Value examples: ['Drugalin', 'Medicol'].),\n  (manufacturer:VARCHAR, Value examples: ['Pharma Inc', 'Acme Pharma'].),\n  (drug_type:TEXT, possible values: biologic, small molecule, topical. Value examples: ['biologic', 'small molecule'].),\n  (moa:TEXT, mechanism of action. Value examples: ['TNF-alpha inhibitor', 'IL-17A inhibitor'].),\n  (fda_appr_dt:DATE, FDA approval date. NULL if drug is still under trial.. Value examples: ['2010-01-15', '2015-06-30'].),\n  (admin_route:TEXT, possible values: oral, injection, topical. Value examples: ['injection', 'oral'].),\n  (dos_amt:DECIMAL, recommended dosage amount. Value examples: ['40', '30'].),\n  (dos_unit:VARCHAR, recommended dosage unit. Value examples: ['mg', 'mg'].),\n  (dos_freq_hrs:INT, recommended number of hours between dosages. Value examples: ['336', '24'].),\n  (ndc:VARCHAR, National Drug Code. Value examples: ['12345-678-90', '54321-012-34'].),\n]\n# Table: diagnoses\n[\n  (diag_id:SERIAL,),\n  (diag_code:VARCHAR, Value examples: ['L40.1', 'L40.51'].),\n  (diag_name:VARCHAR, Value examples: ['Generalized pustular psoriasis', 'Distal interphalangeal psoriatic arthropathy'].),\n  (diag_desc:TEXT, Value examples: ['Widespread pustules on top of red skin', 'Psoriatic arthritis mainly affecting the ends of fingers and toes'].),\n]\n# Table: treatments\n[\n  (treatment_id:SERIAL,),\n  (patient_id:INT,),\n  (doc_id:INT,),\n  (drug_id:INT,),\n  (diag_id:INT,),\n  (start_dt:DATE,),\n  (end_dt:DATE, NULL if treatment is ongoing.),\n  (is_placebo:BOOLEAN,),\n  (tot_drug_amt:DECIMAL,),\n  (drug_unit:TEXT, possible values: mg, ml, g.),\n]\n# Table: outcomes\n[\n  (outcome_id:SERIAL,),\n  (treatment_id:INT, Value examples: ['1', '2', '3', '4'].),\n  (assess_dt:DATE, Value examples: ['2022-01-08', '2022-02-22', '2022-03-17', '2022-04-08'].),\n  (day7_lesion_cnt:INT, lesion counts on day 7.. Value examples: ['20', '25', '18', '30'].),\n  (day30_lesion_cnt:INT, Value examples: ['15', '18', '12', '25'].),\n  (day100_lesion_cnt:INT, Value examples: ['5', '8', '3', '12'].),\n  (day7_pasi_score:DECIMAL, PASI score range 0-72. Value examples: ['12.5', '15.0', '10.8', '18.2'].),\n  (day30_pasi_score:DECIMAL, Value examples: ['8.2', '10.1', '6.4', '13.9'].),\n  (day100_pasi_score:DECIMAL, Value examples: ['2.1', '3.5', '1.2', '5.8'].),\n  (day7_tewl:DECIMAL, in g/m^2/h. Value examples: ['18.2', '20.1', '16.5', '22.4'].),\n  (day30_tewl:DECIMAL, Value examples: ['15.6', '17.2', '14.0', '19.1'].),\n  (day100_tewl:DECIMAL, Value examples: ['12.1', '13.5', '10.8', '15.2'].),\n  (day7_itch_vas:INT, visual analog scale 0-100. Value examples: ['60', '70', '55', '80'].),\n  (day30_itch_vas:INT, Value examples: ['40', '50', '35', '60'].),\n  (day100_itch_vas:INT, Value examples: ['20', '30', '15', '40'].),\n  (day7_hfg:DECIMAL, hair growth factor range 0-5. Value examples: ['1.5', '1.0', '2.0', '0.5'].),\n  (day30_hfg:DECIMAL, Value examples: ['2.5', '2.0', '3.0', '1.5'].),\n  (day100_hfg:DECIMAL, Value examples: ['4.0', '3.5', '4.5', '3.0'].),\n]\n# Table: adverse_events\n[\n  (id:SERIAL, 1 row per adverse event per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '5'].),\n  (reported_dt:DATE, Value examples: ['2022-01-15', '2022-05-20'].),\n  (description:TEXT, Value examples: ['Mild injection site reaction', 'Upper respiratory infection'].),\n]\n# Table: concomitant_meds\n[\n  (id:SERIAL, 1 row per med per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '1', '2', '3'].),\n  (med_name:VARCHAR, Value examples: ['Acetaminophen', 'Ibuprofen', 'Loratadine', 'Multivitamin'].),\n  (start_dt:TEXT, YYYY-MM-DD. Value examples: ['2022-01-01', '2022-01-08', '2022-02-15', '2022-03-10'].),\n  (end_dt:TEXT, YYYY-MM-DD NULL if still taking. Value examples: ['2022-01-07', '2022-01-14', '2022-03-15', 'NULL'].),\n  (dose_amt:DECIMAL, Value examples: ['500', '200', '10', '1'].),\n  (dose_unit:TEXT, possible values: mg, ml, g. Value examples: ['mg', 'mg', 'mg', 'tablet'].),\n  (freq_hrs:INT, Value examples: ['6', '8', '24', '24'].),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nReturn the patient IDs, first names and last names of patients who have not received any treatments.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT p.patient_id, p.first_name, p.last_name FROM patients p LEFT JOIN treatments t ON p.patient_id = t.patient_id WHERE t.patient_id IS NULL",
        "role": "assistant"
      }
    ],
    "db_name": "derm_treatment",
    "id": 228,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nReturn the drug IDs and names of drugs that have not been used in any treatments.\n\n【数据库schema】\n【DB_ID】 derm_treatment\n【Schema】\n# Table: doctors\n[\n  (doc_id:SERIAL,),\n  (first_name:VARCHAR,),\n  (last_name:VARCHAR,),\n  (specialty:TEXT, possible values: dermatology, immunology, general.),\n  (year_reg:INT, year the doctor was registered and obtained license.),\n  (med_school_name:VARCHAR,),\n  (loc_city:VARCHAR,),\n  (loc_state:CHAR,),\n  (loc_zip:VARCHAR,),\n  (bd_cert_num:VARCHAR, board certification number.),\n]\n# Table: patients\n[\n  (patient_id:SERIAL,),\n  (first_name:VARCHAR, Value examples: ['Alice', 'Bob'].),\n  (last_name:VARCHAR, Value examples: ['Johnson', 'Smith'].),\n  (date_of_birth:DATE, Value examples: ['1985-03-15', '1978-11-23'].),\n  (date_of_registration:DATE, Value examples: ['2023-01-03', '2023-01-10'].),\n  (gender:VARCHAR, Male, Female, Others. Value examples: ['Female', 'Male'].),\n  (email:VARCHAR, Value examples: ['alice@email.com', 'bob@email.com'].),\n  (phone:VARCHAR, Value examples: ['555-123-4567', '555-987-6543'].),\n  (addr_street:VARCHAR, Value examples: ['123 Main St', '456 Oak Ave'].),\n  (addr_city:VARCHAR, Value examples: ['Anytown', 'Somecity'].),\n  (addr_state:CHAR, Value examples: ['CA', 'NY'].),\n  (addr_zip:VARCHAR, Value examples: ['12345', '54321'].),\n  (ins_type:TEXT, Insurance type. Possible values: private, medicare, medicaid, uninsured. Value examples: ['private', 'medicare'].),\n  (ins_policy_num:VARCHAR, Insurance policy number. Value examples: ['ABC123456', 'XYZ789012'].),\n  (height_cm:FLOAT, Value examples: ['165', '180'].),\n  (weight_kg:FLOAT, Value examples: ['60', '85'].),\n]\n# Table: drugs\n[\n  (drug_id:SERIAL,),\n  (drug_name:VARCHAR, Value examples: ['Drugalin', 'Medicol'].),\n  (manufacturer:VARCHAR, Value examples: ['Pharma Inc', 'Acme Pharma'].),\n  (drug_type:TEXT, possible values: biologic, small molecule, topical. Value examples: ['biologic', 'small molecule'].),\n  (moa:TEXT, mechanism of action. Value examples: ['TNF-alpha inhibitor', 'IL-17A inhibitor'].),\n  (fda_appr_dt:DATE, FDA approval date. NULL if drug is still under trial.. Value examples: ['2010-01-15', '2015-06-30'].),\n  (admin_route:TEXT, possible values: oral, injection, topical. Value examples: ['injection', 'oral'].),\n  (dos_amt:DECIMAL, recommended dosage amount. Value examples: ['40', '30'].),\n  (dos_unit:VARCHAR, recommended dosage unit. Value examples: ['mg', 'mg'].),\n  (dos_freq_hrs:INT, recommended number of hours between dosages. Value examples: ['336', '24'].),\n  (ndc:VARCHAR, National Drug Code. Value examples: ['12345-678-90', '54321-012-34'].),\n]\n# Table: diagnoses\n[\n  (diag_id:SERIAL,),\n  (diag_code:VARCHAR, Value examples: ['L40.1', 'L40.51'].),\n  (diag_name:VARCHAR, Value examples: ['Generalized pustular psoriasis', 'Distal interphalangeal psoriatic arthropathy'].),\n  (diag_desc:TEXT, Value examples: ['Widespread pustules on top of red skin', 'Psoriatic arthritis mainly affecting the ends of fingers and toes'].),\n]\n# Table: treatments\n[\n  (treatment_id:SERIAL,),\n  (patient_id:INT,),\n  (doc_id:INT,),\n  (drug_id:INT,),\n  (diag_id:INT,),\n  (start_dt:DATE,),\n  (end_dt:DATE, NULL if treatment is ongoing.),\n  (is_placebo:BOOLEAN,),\n  (tot_drug_amt:DECIMAL,),\n  (drug_unit:TEXT, possible values: mg, ml, g.),\n]\n# Table: outcomes\n[\n  (outcome_id:SERIAL,),\n  (treatment_id:INT, Value examples: ['1', '2', '3', '4'].),\n  (assess_dt:DATE, Value examples: ['2022-01-08', '2022-02-22', '2022-03-17', '2022-04-08'].),\n  (day7_lesion_cnt:INT, lesion counts on day 7.. Value examples: ['20', '25', '18', '30'].),\n  (day30_lesion_cnt:INT, Value examples: ['15', '18', '12', '25'].),\n  (day100_lesion_cnt:INT, Value examples: ['5', '8', '3', '12'].),\n  (day7_pasi_score:DECIMAL, PASI score range 0-72. Value examples: ['12.5', '15.0', '10.8', '18.2'].),\n  (day30_pasi_score:DECIMAL, Value examples: ['8.2', '10.1', '6.4', '13.9'].),\n  (day100_pasi_score:DECIMAL, Value examples: ['2.1', '3.5', '1.2', '5.8'].),\n  (day7_tewl:DECIMAL, in g/m^2/h. Value examples: ['18.2', '20.1', '16.5', '22.4'].),\n  (day30_tewl:DECIMAL, Value examples: ['15.6', '17.2', '14.0', '19.1'].),\n  (day100_tewl:DECIMAL, Value examples: ['12.1', '13.5', '10.8', '15.2'].),\n  (day7_itch_vas:INT, visual analog scale 0-100. Value examples: ['60', '70', '55', '80'].),\n  (day30_itch_vas:INT, Value examples: ['40', '50', '35', '60'].),\n  (day100_itch_vas:INT, Value examples: ['20', '30', '15', '40'].),\n  (day7_hfg:DECIMAL, hair growth factor range 0-5. Value examples: ['1.5', '1.0', '2.0', '0.5'].),\n  (day30_hfg:DECIMAL, Value examples: ['2.5', '2.0', '3.0', '1.5'].),\n  (day100_hfg:DECIMAL, Value examples: ['4.0', '3.5', '4.5', '3.0'].),\n]\n# Table: adverse_events\n[\n  (id:SERIAL, 1 row per adverse event per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '5'].),\n  (reported_dt:DATE, Value examples: ['2022-01-15', '2022-05-20'].),\n  (description:TEXT, Value examples: ['Mild injection site reaction', 'Upper respiratory infection'].),\n]\n# Table: concomitant_meds\n[\n  (id:SERIAL, 1 row per med per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '1', '2', '3'].),\n  (med_name:VARCHAR, Value examples: ['Acetaminophen', 'Ibuprofen', 'Loratadine', 'Multivitamin'].),\n  (start_dt:TEXT, YYYY-MM-DD. Value examples: ['2022-01-01', '2022-01-08', '2022-02-15', '2022-03-10'].),\n  (end_dt:TEXT, YYYY-MM-DD NULL if still taking. Value examples: ['2022-01-07', '2022-01-14', '2022-03-15', 'NULL'].),\n  (dose_amt:DECIMAL, Value examples: ['500', '200', '10', '1'].),\n  (dose_unit:TEXT, possible values: mg, ml, g. Value examples: ['mg', 'mg', 'mg', 'tablet'].),\n  (freq_hrs:INT, Value examples: ['6', '8', '24', '24'].),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nReturn the drug IDs and names of drugs that have not been used in any treatments.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT d.drug_id, d.drug_name FROM drugs d LEFT JOIN treatments t ON d.drug_id = t.drug_id WHERE t.drug_id IS NULL",
        "role": "assistant"
      }
    ],
    "db_name": "derm_treatment",
    "id": 229,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWho are the top 5 merchants (receiver type 1) by total transaction amount in the past 30 days (inclusive of 30 days ago)? Return the merchant name, total number of transactions, and total transaction amount.\n\n【数据库schema】\n【DB_ID】 ewallet\n【Schema】\n# Table: users\n[\n  (uid:BIGINT,),\n  (username:VARCHAR,),\n  (email:VARCHAR,),\n  (phone_number:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (last_login_at:TIMESTAMP,),\n  (user_type:VARCHAR, possible values: individual, business, admin.),\n  (status:VARCHAR, possible values: active, inactive, suspended, deleted.),\n  (country:VARCHAR, 2-letter country code.),\n  (address_billing:TEXT,),\n  (address_delivery:TEXT,),\n  (kyc_status:VARCHAR, possible values: pending, approved, rejected.),\n  (kyc_verified_at:TIMESTAMP,),\n]\n# Table: merchants\n[\n  (mid:BIGINT,),\n  (name:VARCHAR,),\n  (description:TEXT,),\n  (website_url:VARCHAR,),\n  (logo_url:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (country:VARCHAR, 2-letter country code.),\n  (state:VARCHAR,),\n  (city:VARCHAR,),\n  (postal_code:VARCHAR,),\n  (address:TEXT,),\n  (status:VARCHAR, possible values: active, inactive, suspended.),\n  (category:VARCHAR,),\n  (sub_category:VARCHAR,),\n  (mcc:INT, Merchant Category Code.),\n  (contact_name:VARCHAR,),\n  (contact_email:VARCHAR,),\n  (contact_phone:VARCHAR,),\n]\n# Table: coupons\n[\n  (cid:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (code:VARCHAR, Value examples: ['TECH20', 'NEWYEAR30', 'DINEDISCOUNT', 'HOME15'].),\n  (description:TEXT, Value examples: ['20% off tech and electronics', '30% off workout gear', 'Get $10 off $50 order', '15% off weekly rental'].),\n  (start_date:DATE, Value examples: ['2023-05-01', '2023-01-01', '2023-06-01', '2023-07-01'].),\n  (end_date:DATE, Value examples: ['2023-05-31', '2023-01-15', '2023-06-30', '2023-08-31'].),\n  (discount_type:VARCHAR, possible values: percentage, fixed_amount. Value examples: ['percentage', 'percentage', 'fixed_amount', 'percentage'].),\n  (discount_value:DECIMAL, Value examples: ['20.00', '30.00', '10.00', '15.00'].),\n  (min_purchase_amount:DECIMAL, Value examples: ['100.00', 'NULL', '50.00', '1000.00'].),\n  (max_discount_amount:DECIMAL, Value examples: ['NULL', 'NULL', '10.00', '300.00'].),\n  (redemption_limit:INT, Value examples: ['500', '1000', 'NULL', '200'].),\n  (status:VARCHAR, possible values: active, inactive, expired. Value examples: ['active', 'expired', 'active', 'active'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-04-01 09:00:00', '2022-12-01 12:00:00', '2023-05-15 15:30:00', '2023-05-01 09:15:00'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-04-15 11:30:00', '2023-01-16 18:45:00', 'NULL', 'NULL'].),\n]\n# Table: wallet_transactions_daily\n[\n  (txid:SERIAL,),\n  (sender_id:BIGINT, Value examples: ['1'].),\n  (sender_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (receiver_id:BIGINT, Value examples: ['1'].),\n  (receiver_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (amount:DECIMAL, Value examples: ['99.99'].),\n  (status:VARCHAR, possible values: pending, success, failed, refunded. Value examples: ['success'].),\n  (type:VARCHAR, possible values: credit, debit. Value examples: ['debit'].),\n  (description:TEXT, Value examples: ['Online purchase'].),\n  (coupon_id:BIGINT, NULL if transaction doesn't involve a coupon. Value examples: ['NULL'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:15:30'].),\n  (completed_at:TIMESTAMP, NULL if failed. Value examples: ['2023-06-01 10:15:45'].),\n  (transaction_ref:VARCHAR, randomly generated uuid4 for users' reference. Value examples: ['ad154bf7-8185-4230-a8d8-3ef59b4e0012'].),\n  (gateway_name:VARCHAR, Value examples: ['Stripe'].),\n  (gateway_ref:VARCHAR, Value examples: ['tx_123abc456def'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1'].),\n  (ip_address:VARCHAR, Value examples: ['192.168.0.1'].),\n  (user_agent:TEXT, Value examples: ['Mozilla/5.0 (iPhone'].),\n]\n# Table: wallet_user_balance_daily\n[\n  (user_id:BIGINT, Value examples: ['1', '2'].),\n  (balance:DECIMAL, Value examples: ['525.80', '429.76'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: wallet_merchant_balance_daily\n[\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3'].),\n  (balance:DECIMAL, Value examples: ['3897.99', '155.24', '2775.25'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: notifications\n[\n  (id:SERIAL,),\n  (user_id:INT, Value examples: ['1', '1', '2'].),\n  (message:TEXT, Value examples: ['Your order #123abc has been shipped!', 'Get 20% off your next purchase! Limited time offer.', 'A package is being returned to you. Refund processing...'].),\n  (type:VARCHAR, possible values: transaction, promotion, security, general. Value examples: ['transaction', 'promotion', 'transaction'].),\n  (status:VARCHAR, possible values: unread, read, archived. Value examples: ['unread', 'unread', 'read'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:16:00', '2023-06-02 09:00:00', '2023-06-07 10:12:00'].),\n  (read_at:TIMESTAMP, NULL if not read.),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'email', 'mobile_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'NULL', 'mobile_1av8p0'].),\n  (action_url:TEXT, can be external https or deeplink url within the app. Value examples: ['app://orders/123abc', 'https://techmart.com/promo/TECH20', 'app://orders?status=returned'].),\n]\n# Table: user_sessions\n[\n  (user_id:BIGINT, Value examples: ['1', '1', '1'].),\n  (session_start_ts:TIMESTAMP, Value examples: ['2023-06-01 09:45:22', '2023-06-02 13:30:00', '2023-06-06 14:19:00'].),\n  (session_end_ts:TIMESTAMP, Value examples: ['2023-06-01 10:20:35', '2023-06-02 14:15:15', '2023-06-06 14:22:10'].),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'web_app', 'web_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'web_33lq1dh', 'web_33lq1dh'].),\n]\n# Table: user_setting_snapshot\n[\n  (user_id:BIGINT, Value examples: ['1', '4', '5'].),\n  (snapshot_date:DATE, Value examples: ['2023-06-07', '2023-06-07', '2023-06-07'].),\n  (tx_limit_daily:DECIMAL, Value examples: ['1000.00', '5000.00', '100.00'].),\n  (tx_limit_monthly:DECIMAL, Value examples: ['5000.00', '20000.00', '500.00'].),\n  (membership_status:INTEGER, 0 for bronze, 1 for silver, 2 for gold, 3 for platinum, 4 for VIP. Value examples: ['2', '4', '0'].),\n  (password_hash:VARCHAR, Value examples: ['bcryptHash($2yz9!&ka1)', 'bcryptHash(Vacay2023*&!Rm)', 'bcryptHash(cRaf7yCr8zy)'].),\n  (api_key:VARCHAR, Value examples: ['9d61c49b-8977-4914-a36b-80d1445e38fa', 'NULL', 'NULL'].),\n  (verified_devices:TEXT, comma separated list of device ids. Value examples: ['mobile_8fh2k1', 'mobile_34jdkl', 'web_8902wknz'].),\n  (verified_ips:TEXT, comma separated list of IP addresses. Value examples: ['192.168.0.1', '143.92.64.138', '192.64.112.188'].),\n  (mfa_enabled:BOOLEAN, Value examples: ['true', 'false', 'false'].),\n  (marketing_opt_in:BOOLEAN, Value examples: ['false', 'true', 'false'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-07 00:00:00', '2023-06-07 00:00:00', '2023-06-07 00:00:00'].),\n  (PRIMARY:KEY,),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nWho are the top 5 merchants (receiver type 1) by total transaction amount in the past 30 days (inclusive of 30 days ago)? Return the merchant name, total number of transactions, and total transaction amount.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT m.name AS merchant_name, COUNT(t.txid) AS total_transactions, SUM(t.amount) AS total_amount FROM consumer_div.merchants m JOIN consumer_div.wallet_transactions_daily t ON m.mid = t.receiver_id WHERE t.receiver_type = 1 AND t.created_at >= CURRENT_DATE - INTERVAL '30 days' GROUP BY m.name ORDER BY total_amount DESC LIMIT 5",
        "role": "assistant"
      }
    ],
    "db_name": "ewallet",
    "id": 230,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many distinct active users sent money per month in 2023? Return the number of active users per month (as a date), starting from the earliest date. Do not include merchants in the query. Only included successful transactions.\n\n【数据库schema】\n【DB_ID】 ewallet\n【Schema】\n# Table: users\n[\n  (uid:BIGINT,),\n  (username:VARCHAR,),\n  (email:VARCHAR,),\n  (phone_number:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (last_login_at:TIMESTAMP,),\n  (user_type:VARCHAR, possible values: individual, business, admin.),\n  (status:VARCHAR, possible values: active, inactive, suspended, deleted.),\n  (country:VARCHAR, 2-letter country code.),\n  (address_billing:TEXT,),\n  (address_delivery:TEXT,),\n  (kyc_status:VARCHAR, possible values: pending, approved, rejected.),\n  (kyc_verified_at:TIMESTAMP,),\n]\n# Table: merchants\n[\n  (mid:BIGINT,),\n  (name:VARCHAR,),\n  (description:TEXT,),\n  (website_url:VARCHAR,),\n  (logo_url:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (country:VARCHAR, 2-letter country code.),\n  (state:VARCHAR,),\n  (city:VARCHAR,),\n  (postal_code:VARCHAR,),\n  (address:TEXT,),\n  (status:VARCHAR, possible values: active, inactive, suspended.),\n  (category:VARCHAR,),\n  (sub_category:VARCHAR,),\n  (mcc:INT, Merchant Category Code.),\n  (contact_name:VARCHAR,),\n  (contact_email:VARCHAR,),\n  (contact_phone:VARCHAR,),\n]\n# Table: coupons\n[\n  (cid:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (code:VARCHAR, Value examples: ['TECH20', 'NEWYEAR30', 'DINEDISCOUNT', 'HOME15'].),\n  (description:TEXT, Value examples: ['20% off tech and electronics', '30% off workout gear', 'Get $10 off $50 order', '15% off weekly rental'].),\n  (start_date:DATE, Value examples: ['2023-05-01', '2023-01-01', '2023-06-01', '2023-07-01'].),\n  (end_date:DATE, Value examples: ['2023-05-31', '2023-01-15', '2023-06-30', '2023-08-31'].),\n  (discount_type:VARCHAR, possible values: percentage, fixed_amount. Value examples: ['percentage', 'percentage', 'fixed_amount', 'percentage'].),\n  (discount_value:DECIMAL, Value examples: ['20.00', '30.00', '10.00', '15.00'].),\n  (min_purchase_amount:DECIMAL, Value examples: ['100.00', 'NULL', '50.00', '1000.00'].),\n  (max_discount_amount:DECIMAL, Value examples: ['NULL', 'NULL', '10.00', '300.00'].),\n  (redemption_limit:INT, Value examples: ['500', '1000', 'NULL', '200'].),\n  (status:VARCHAR, possible values: active, inactive, expired. Value examples: ['active', 'expired', 'active', 'active'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-04-01 09:00:00', '2022-12-01 12:00:00', '2023-05-15 15:30:00', '2023-05-01 09:15:00'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-04-15 11:30:00', '2023-01-16 18:45:00', 'NULL', 'NULL'].),\n]\n# Table: wallet_transactions_daily\n[\n  (txid:SERIAL,),\n  (sender_id:BIGINT, Value examples: ['1'].),\n  (sender_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (receiver_id:BIGINT, Value examples: ['1'].),\n  (receiver_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (amount:DECIMAL, Value examples: ['99.99'].),\n  (status:VARCHAR, possible values: pending, success, failed, refunded. Value examples: ['success'].),\n  (type:VARCHAR, possible values: credit, debit. Value examples: ['debit'].),\n  (description:TEXT, Value examples: ['Online purchase'].),\n  (coupon_id:BIGINT, NULL if transaction doesn't involve a coupon. Value examples: ['NULL'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:15:30'].),\n  (completed_at:TIMESTAMP, NULL if failed. Value examples: ['2023-06-01 10:15:45'].),\n  (transaction_ref:VARCHAR, randomly generated uuid4 for users' reference. Value examples: ['ad154bf7-8185-4230-a8d8-3ef59b4e0012'].),\n  (gateway_name:VARCHAR, Value examples: ['Stripe'].),\n  (gateway_ref:VARCHAR, Value examples: ['tx_123abc456def'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1'].),\n  (ip_address:VARCHAR, Value examples: ['192.168.0.1'].),\n  (user_agent:TEXT, Value examples: ['Mozilla/5.0 (iPhone'].),\n]\n# Table: wallet_user_balance_daily\n[\n  (user_id:BIGINT, Value examples: ['1', '2'].),\n  (balance:DECIMAL, Value examples: ['525.80', '429.76'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: wallet_merchant_balance_daily\n[\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3'].),\n  (balance:DECIMAL, Value examples: ['3897.99', '155.24', '2775.25'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: notifications\n[\n  (id:SERIAL,),\n  (user_id:INT, Value examples: ['1', '1', '2'].),\n  (message:TEXT, Value examples: ['Your order #123abc has been shipped!', 'Get 20% off your next purchase! Limited time offer.', 'A package is being returned to you. Refund processing...'].),\n  (type:VARCHAR, possible values: transaction, promotion, security, general. Value examples: ['transaction', 'promotion', 'transaction'].),\n  (status:VARCHAR, possible values: unread, read, archived. Value examples: ['unread', 'unread', 'read'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:16:00', '2023-06-02 09:00:00', '2023-06-07 10:12:00'].),\n  (read_at:TIMESTAMP, NULL if not read.),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'email', 'mobile_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'NULL', 'mobile_1av8p0'].),\n  (action_url:TEXT, can be external https or deeplink url within the app. Value examples: ['app://orders/123abc', 'https://techmart.com/promo/TECH20', 'app://orders?status=returned'].),\n]\n# Table: user_sessions\n[\n  (user_id:BIGINT, Value examples: ['1', '1', '1'].),\n  (session_start_ts:TIMESTAMP, Value examples: ['2023-06-01 09:45:22', '2023-06-02 13:30:00', '2023-06-06 14:19:00'].),\n  (session_end_ts:TIMESTAMP, Value examples: ['2023-06-01 10:20:35', '2023-06-02 14:15:15', '2023-06-06 14:22:10'].),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'web_app', 'web_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'web_33lq1dh', 'web_33lq1dh'].),\n]\n# Table: user_setting_snapshot\n[\n  (user_id:BIGINT, Value examples: ['1', '4', '5'].),\n  (snapshot_date:DATE, Value examples: ['2023-06-07', '2023-06-07', '2023-06-07'].),\n  (tx_limit_daily:DECIMAL, Value examples: ['1000.00', '5000.00', '100.00'].),\n  (tx_limit_monthly:DECIMAL, Value examples: ['5000.00', '20000.00', '500.00'].),\n  (membership_status:INTEGER, 0 for bronze, 1 for silver, 2 for gold, 3 for platinum, 4 for VIP. Value examples: ['2', '4', '0'].),\n  (password_hash:VARCHAR, Value examples: ['bcryptHash($2yz9!&ka1)', 'bcryptHash(Vacay2023*&!Rm)', 'bcryptHash(cRaf7yCr8zy)'].),\n  (api_key:VARCHAR, Value examples: ['9d61c49b-8977-4914-a36b-80d1445e38fa', 'NULL', 'NULL'].),\n  (verified_devices:TEXT, comma separated list of device ids. Value examples: ['mobile_8fh2k1', 'mobile_34jdkl', 'web_8902wknz'].),\n  (verified_ips:TEXT, comma separated list of IP addresses. Value examples: ['192.168.0.1', '143.92.64.138', '192.64.112.188'].),\n  (mfa_enabled:BOOLEAN, Value examples: ['true', 'false', 'false'].),\n  (marketing_opt_in:BOOLEAN, Value examples: ['false', 'true', 'false'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-07 00:00:00', '2023-06-07 00:00:00', '2023-06-07 00:00:00'].),\n  (PRIMARY:KEY,),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nHow many distinct active users sent money per month in 2023? Return the number of active users per month (as a date), starting from the earliest date. Do not include merchants in the query. Only included successful transactions.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT DATE_TRUNC('month', t.created_at) AS MONTH, COUNT(DISTINCT t.sender_id) AS active_users FROM consumer_div.wallet_transactions_daily t JOIN consumer_div.users u ON t.sender_id = u.uid WHERE t.sender_type = 0 AND t.status = 'success' AND u.status = 'active' AND t.created_at >= '2023-01-01' AND t.created_at < '2024-01-01' GROUP BY MONTH ORDER BY MONTH",
        "role": "assistant"
      }
    ],
    "db_name": "ewallet",
    "id": 231,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the top 3 most frequently used coupon codes? Return the coupon code, total number of redemptions, and total amount redeemed.\n\n【数据库schema】\n【DB_ID】 ewallet\n【Schema】\n# Table: users\n[\n  (uid:BIGINT,),\n  (username:VARCHAR,),\n  (email:VARCHAR,),\n  (phone_number:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (last_login_at:TIMESTAMP,),\n  (user_type:VARCHAR, possible values: individual, business, admin.),\n  (status:VARCHAR, possible values: active, inactive, suspended, deleted.),\n  (country:VARCHAR, 2-letter country code.),\n  (address_billing:TEXT,),\n  (address_delivery:TEXT,),\n  (kyc_status:VARCHAR, possible values: pending, approved, rejected.),\n  (kyc_verified_at:TIMESTAMP,),\n]\n# Table: merchants\n[\n  (mid:BIGINT,),\n  (name:VARCHAR,),\n  (description:TEXT,),\n  (website_url:VARCHAR,),\n  (logo_url:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (country:VARCHAR, 2-letter country code.),\n  (state:VARCHAR,),\n  (city:VARCHAR,),\n  (postal_code:VARCHAR,),\n  (address:TEXT,),\n  (status:VARCHAR, possible values: active, inactive, suspended.),\n  (category:VARCHAR,),\n  (sub_category:VARCHAR,),\n  (mcc:INT, Merchant Category Code.),\n  (contact_name:VARCHAR,),\n  (contact_email:VARCHAR,),\n  (contact_phone:VARCHAR,),\n]\n# Table: coupons\n[\n  (cid:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (code:VARCHAR, Value examples: ['TECH20', 'NEWYEAR30', 'DINEDISCOUNT', 'HOME15'].),\n  (description:TEXT, Value examples: ['20% off tech and electronics', '30% off workout gear', 'Get $10 off $50 order', '15% off weekly rental'].),\n  (start_date:DATE, Value examples: ['2023-05-01', '2023-01-01', '2023-06-01', '2023-07-01'].),\n  (end_date:DATE, Value examples: ['2023-05-31', '2023-01-15', '2023-06-30', '2023-08-31'].),\n  (discount_type:VARCHAR, possible values: percentage, fixed_amount. Value examples: ['percentage', 'percentage', 'fixed_amount', 'percentage'].),\n  (discount_value:DECIMAL, Value examples: ['20.00', '30.00', '10.00', '15.00'].),\n  (min_purchase_amount:DECIMAL, Value examples: ['100.00', 'NULL', '50.00', '1000.00'].),\n  (max_discount_amount:DECIMAL, Value examples: ['NULL', 'NULL', '10.00', '300.00'].),\n  (redemption_limit:INT, Value examples: ['500', '1000', 'NULL', '200'].),\n  (status:VARCHAR, possible values: active, inactive, expired. Value examples: ['active', 'expired', 'active', 'active'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-04-01 09:00:00', '2022-12-01 12:00:00', '2023-05-15 15:30:00', '2023-05-01 09:15:00'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-04-15 11:30:00', '2023-01-16 18:45:00', 'NULL', 'NULL'].),\n]\n# Table: wallet_transactions_daily\n[\n  (txid:SERIAL,),\n  (sender_id:BIGINT, Value examples: ['1'].),\n  (sender_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (receiver_id:BIGINT, Value examples: ['1'].),\n  (receiver_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (amount:DECIMAL, Value examples: ['99.99'].),\n  (status:VARCHAR, possible values: pending, success, failed, refunded. Value examples: ['success'].),\n  (type:VARCHAR, possible values: credit, debit. Value examples: ['debit'].),\n  (description:TEXT, Value examples: ['Online purchase'].),\n  (coupon_id:BIGINT, NULL if transaction doesn't involve a coupon. Value examples: ['NULL'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:15:30'].),\n  (completed_at:TIMESTAMP, NULL if failed. Value examples: ['2023-06-01 10:15:45'].),\n  (transaction_ref:VARCHAR, randomly generated uuid4 for users' reference. Value examples: ['ad154bf7-8185-4230-a8d8-3ef59b4e0012'].),\n  (gateway_name:VARCHAR, Value examples: ['Stripe'].),\n  (gateway_ref:VARCHAR, Value examples: ['tx_123abc456def'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1'].),\n  (ip_address:VARCHAR, Value examples: ['192.168.0.1'].),\n  (user_agent:TEXT, Value examples: ['Mozilla/5.0 (iPhone'].),\n]\n# Table: wallet_user_balance_daily\n[\n  (user_id:BIGINT, Value examples: ['1', '2'].),\n  (balance:DECIMAL, Value examples: ['525.80', '429.76'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: wallet_merchant_balance_daily\n[\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3'].),\n  (balance:DECIMAL, Value examples: ['3897.99', '155.24', '2775.25'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: notifications\n[\n  (id:SERIAL,),\n  (user_id:INT, Value examples: ['1', '1', '2'].),\n  (message:TEXT, Value examples: ['Your order #123abc has been shipped!', 'Get 20% off your next purchase! Limited time offer.', 'A package is being returned to you. Refund processing...'].),\n  (type:VARCHAR, possible values: transaction, promotion, security, general. Value examples: ['transaction', 'promotion', 'transaction'].),\n  (status:VARCHAR, possible values: unread, read, archived. Value examples: ['unread', 'unread', 'read'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:16:00', '2023-06-02 09:00:00', '2023-06-07 10:12:00'].),\n  (read_at:TIMESTAMP, NULL if not read.),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'email', 'mobile_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'NULL', 'mobile_1av8p0'].),\n  (action_url:TEXT, can be external https or deeplink url within the app. Value examples: ['app://orders/123abc', 'https://techmart.com/promo/TECH20', 'app://orders?status=returned'].),\n]\n# Table: user_sessions\n[\n  (user_id:BIGINT, Value examples: ['1', '1', '1'].),\n  (session_start_ts:TIMESTAMP, Value examples: ['2023-06-01 09:45:22', '2023-06-02 13:30:00', '2023-06-06 14:19:00'].),\n  (session_end_ts:TIMESTAMP, Value examples: ['2023-06-01 10:20:35', '2023-06-02 14:15:15', '2023-06-06 14:22:10'].),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'web_app', 'web_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'web_33lq1dh', 'web_33lq1dh'].),\n]\n# Table: user_setting_snapshot\n[\n  (user_id:BIGINT, Value examples: ['1', '4', '5'].),\n  (snapshot_date:DATE, Value examples: ['2023-06-07', '2023-06-07', '2023-06-07'].),\n  (tx_limit_daily:DECIMAL, Value examples: ['1000.00', '5000.00', '100.00'].),\n  (tx_limit_monthly:DECIMAL, Value examples: ['5000.00', '20000.00', '500.00'].),\n  (membership_status:INTEGER, 0 for bronze, 1 for silver, 2 for gold, 3 for platinum, 4 for VIP. Value examples: ['2', '4', '0'].),\n  (password_hash:VARCHAR, Value examples: ['bcryptHash($2yz9!&ka1)', 'bcryptHash(Vacay2023*&!Rm)', 'bcryptHash(cRaf7yCr8zy)'].),\n  (api_key:VARCHAR, Value examples: ['9d61c49b-8977-4914-a36b-80d1445e38fa', 'NULL', 'NULL'].),\n  (verified_devices:TEXT, comma separated list of device ids. Value examples: ['mobile_8fh2k1', 'mobile_34jdkl', 'web_8902wknz'].),\n  (verified_ips:TEXT, comma separated list of IP addresses. Value examples: ['192.168.0.1', '143.92.64.138', '192.64.112.188'].),\n  (mfa_enabled:BOOLEAN, Value examples: ['true', 'false', 'false'].),\n  (marketing_opt_in:BOOLEAN, Value examples: ['false', 'true', 'false'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-07 00:00:00', '2023-06-07 00:00:00', '2023-06-07 00:00:00'].),\n  (PRIMARY:KEY,),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nWhat are the top 3 most frequently used coupon codes? Return the coupon code, total number of redemptions, and total amount redeemed.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT c.code AS coupon_code, COUNT(t.txid) AS redemption_count, SUM(t.amount) AS total_discount FROM consumer_div.coupons c JOIN consumer_div.wallet_transactions_daily t ON c.cid = t.coupon_id GROUP BY c.code ORDER BY redemption_count DESC LIMIT 3",
        "role": "assistant"
      }
    ],
    "db_name": "ewallet",
    "id": 232,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich are the top 5 countries by total transaction amount sent by users, sender_type = 0? Return the country, number of distinct users who sent, and total transaction amount.\n\n【数据库schema】\n【DB_ID】 ewallet\n【Schema】\n# Table: users\n[\n  (uid:BIGINT,),\n  (username:VARCHAR,),\n  (email:VARCHAR,),\n  (phone_number:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (last_login_at:TIMESTAMP,),\n  (user_type:VARCHAR, possible values: individual, business, admin.),\n  (status:VARCHAR, possible values: active, inactive, suspended, deleted.),\n  (country:VARCHAR, 2-letter country code.),\n  (address_billing:TEXT,),\n  (address_delivery:TEXT,),\n  (kyc_status:VARCHAR, possible values: pending, approved, rejected.),\n  (kyc_verified_at:TIMESTAMP,),\n]\n# Table: merchants\n[\n  (mid:BIGINT,),\n  (name:VARCHAR,),\n  (description:TEXT,),\n  (website_url:VARCHAR,),\n  (logo_url:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (country:VARCHAR, 2-letter country code.),\n  (state:VARCHAR,),\n  (city:VARCHAR,),\n  (postal_code:VARCHAR,),\n  (address:TEXT,),\n  (status:VARCHAR, possible values: active, inactive, suspended.),\n  (category:VARCHAR,),\n  (sub_category:VARCHAR,),\n  (mcc:INT, Merchant Category Code.),\n  (contact_name:VARCHAR,),\n  (contact_email:VARCHAR,),\n  (contact_phone:VARCHAR,),\n]\n# Table: coupons\n[\n  (cid:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (code:VARCHAR, Value examples: ['TECH20', 'NEWYEAR30', 'DINEDISCOUNT', 'HOME15'].),\n  (description:TEXT, Value examples: ['20% off tech and electronics', '30% off workout gear', 'Get $10 off $50 order', '15% off weekly rental'].),\n  (start_date:DATE, Value examples: ['2023-05-01', '2023-01-01', '2023-06-01', '2023-07-01'].),\n  (end_date:DATE, Value examples: ['2023-05-31', '2023-01-15', '2023-06-30', '2023-08-31'].),\n  (discount_type:VARCHAR, possible values: percentage, fixed_amount. Value examples: ['percentage', 'percentage', 'fixed_amount', 'percentage'].),\n  (discount_value:DECIMAL, Value examples: ['20.00', '30.00', '10.00', '15.00'].),\n  (min_purchase_amount:DECIMAL, Value examples: ['100.00', 'NULL', '50.00', '1000.00'].),\n  (max_discount_amount:DECIMAL, Value examples: ['NULL', 'NULL', '10.00', '300.00'].),\n  (redemption_limit:INT, Value examples: ['500', '1000', 'NULL', '200'].),\n  (status:VARCHAR, possible values: active, inactive, expired. Value examples: ['active', 'expired', 'active', 'active'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-04-01 09:00:00', '2022-12-01 12:00:00', '2023-05-15 15:30:00', '2023-05-01 09:15:00'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-04-15 11:30:00', '2023-01-16 18:45:00', 'NULL', 'NULL'].),\n]\n# Table: wallet_transactions_daily\n[\n  (txid:SERIAL,),\n  (sender_id:BIGINT, Value examples: ['1'].),\n  (sender_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (receiver_id:BIGINT, Value examples: ['1'].),\n  (receiver_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (amount:DECIMAL, Value examples: ['99.99'].),\n  (status:VARCHAR, possible values: pending, success, failed, refunded. Value examples: ['success'].),\n  (type:VARCHAR, possible values: credit, debit. Value examples: ['debit'].),\n  (description:TEXT, Value examples: ['Online purchase'].),\n  (coupon_id:BIGINT, NULL if transaction doesn't involve a coupon. Value examples: ['NULL'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:15:30'].),\n  (completed_at:TIMESTAMP, NULL if failed. Value examples: ['2023-06-01 10:15:45'].),\n  (transaction_ref:VARCHAR, randomly generated uuid4 for users' reference. Value examples: ['ad154bf7-8185-4230-a8d8-3ef59b4e0012'].),\n  (gateway_name:VARCHAR, Value examples: ['Stripe'].),\n  (gateway_ref:VARCHAR, Value examples: ['tx_123abc456def'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1'].),\n  (ip_address:VARCHAR, Value examples: ['192.168.0.1'].),\n  (user_agent:TEXT, Value examples: ['Mozilla/5.0 (iPhone'].),\n]\n# Table: wallet_user_balance_daily\n[\n  (user_id:BIGINT, Value examples: ['1', '2'].),\n  (balance:DECIMAL, Value examples: ['525.80', '429.76'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: wallet_merchant_balance_daily\n[\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3'].),\n  (balance:DECIMAL, Value examples: ['3897.99', '155.24', '2775.25'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: notifications\n[\n  (id:SERIAL,),\n  (user_id:INT, Value examples: ['1', '1', '2'].),\n  (message:TEXT, Value examples: ['Your order #123abc has been shipped!', 'Get 20% off your next purchase! Limited time offer.', 'A package is being returned to you. Refund processing...'].),\n  (type:VARCHAR, possible values: transaction, promotion, security, general. Value examples: ['transaction', 'promotion', 'transaction'].),\n  (status:VARCHAR, possible values: unread, read, archived. Value examples: ['unread', 'unread', 'read'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:16:00', '2023-06-02 09:00:00', '2023-06-07 10:12:00'].),\n  (read_at:TIMESTAMP, NULL if not read.),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'email', 'mobile_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'NULL', 'mobile_1av8p0'].),\n  (action_url:TEXT, can be external https or deeplink url within the app. Value examples: ['app://orders/123abc', 'https://techmart.com/promo/TECH20', 'app://orders?status=returned'].),\n]\n# Table: user_sessions\n[\n  (user_id:BIGINT, Value examples: ['1', '1', '1'].),\n  (session_start_ts:TIMESTAMP, Value examples: ['2023-06-01 09:45:22', '2023-06-02 13:30:00', '2023-06-06 14:19:00'].),\n  (session_end_ts:TIMESTAMP, Value examples: ['2023-06-01 10:20:35', '2023-06-02 14:15:15', '2023-06-06 14:22:10'].),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'web_app', 'web_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'web_33lq1dh', 'web_33lq1dh'].),\n]\n# Table: user_setting_snapshot\n[\n  (user_id:BIGINT, Value examples: ['1', '4', '5'].),\n  (snapshot_date:DATE, Value examples: ['2023-06-07', '2023-06-07', '2023-06-07'].),\n  (tx_limit_daily:DECIMAL, Value examples: ['1000.00', '5000.00', '100.00'].),\n  (tx_limit_monthly:DECIMAL, Value examples: ['5000.00', '20000.00', '500.00'].),\n  (membership_status:INTEGER, 0 for bronze, 1 for silver, 2 for gold, 3 for platinum, 4 for VIP. Value examples: ['2', '4', '0'].),\n  (password_hash:VARCHAR, Value examples: ['bcryptHash($2yz9!&ka1)', 'bcryptHash(Vacay2023*&!Rm)', 'bcryptHash(cRaf7yCr8zy)'].),\n  (api_key:VARCHAR, Value examples: ['9d61c49b-8977-4914-a36b-80d1445e38fa', 'NULL', 'NULL'].),\n  (verified_devices:TEXT, comma separated list of device ids. Value examples: ['mobile_8fh2k1', 'mobile_34jdkl', 'web_8902wknz'].),\n  (verified_ips:TEXT, comma separated list of IP addresses. Value examples: ['192.168.0.1', '143.92.64.138', '192.64.112.188'].),\n  (mfa_enabled:BOOLEAN, Value examples: ['true', 'false', 'false'].),\n  (marketing_opt_in:BOOLEAN, Value examples: ['false', 'true', 'false'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-07 00:00:00', '2023-06-07 00:00:00', '2023-06-07 00:00:00'].),\n  (PRIMARY:KEY,),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nWhich are the top 5 countries by total transaction amount sent by users, sender_type = 0? Return the country, number of distinct users who sent, and total transaction amount.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT u.country, COUNT(DISTINCT t.sender_id) AS user_count, SUM(t.amount) AS total_amount FROM consumer_div.users u JOIN consumer_div.wallet_transactions_daily t ON u.uid = t.sender_id WHERE t.sender_type = 0 GROUP BY u.country ORDER BY total_amount DESC LIMIT 5",
        "role": "assistant"
      }
    ],
    "db_name": "ewallet",
    "id": 233,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nReturn the distinct list of merchant IDs that have received money from a transaction. Include all transaction types in the results you return.\n\n【数据库schema】\n【DB_ID】 ewallet\n【Schema】\n# Table: users\n[\n  (uid:BIGINT,),\n  (username:VARCHAR,),\n  (email:VARCHAR,),\n  (phone_number:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (last_login_at:TIMESTAMP,),\n  (user_type:VARCHAR, possible values: individual, business, admin.),\n  (status:VARCHAR, possible values: active, inactive, suspended, deleted.),\n  (country:VARCHAR, 2-letter country code.),\n  (address_billing:TEXT,),\n  (address_delivery:TEXT,),\n  (kyc_status:VARCHAR, possible values: pending, approved, rejected.),\n  (kyc_verified_at:TIMESTAMP,),\n]\n# Table: merchants\n[\n  (mid:BIGINT,),\n  (name:VARCHAR,),\n  (description:TEXT,),\n  (website_url:VARCHAR,),\n  (logo_url:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (country:VARCHAR, 2-letter country code.),\n  (state:VARCHAR,),\n  (city:VARCHAR,),\n  (postal_code:VARCHAR,),\n  (address:TEXT,),\n  (status:VARCHAR, possible values: active, inactive, suspended.),\n  (category:VARCHAR,),\n  (sub_category:VARCHAR,),\n  (mcc:INT, Merchant Category Code.),\n  (contact_name:VARCHAR,),\n  (contact_email:VARCHAR,),\n  (contact_phone:VARCHAR,),\n]\n# Table: coupons\n[\n  (cid:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (code:VARCHAR, Value examples: ['TECH20', 'NEWYEAR30', 'DINEDISCOUNT', 'HOME15'].),\n  (description:TEXT, Value examples: ['20% off tech and electronics', '30% off workout gear', 'Get $10 off $50 order', '15% off weekly rental'].),\n  (start_date:DATE, Value examples: ['2023-05-01', '2023-01-01', '2023-06-01', '2023-07-01'].),\n  (end_date:DATE, Value examples: ['2023-05-31', '2023-01-15', '2023-06-30', '2023-08-31'].),\n  (discount_type:VARCHAR, possible values: percentage, fixed_amount. Value examples: ['percentage', 'percentage', 'fixed_amount', 'percentage'].),\n  (discount_value:DECIMAL, Value examples: ['20.00', '30.00', '10.00', '15.00'].),\n  (min_purchase_amount:DECIMAL, Value examples: ['100.00', 'NULL', '50.00', '1000.00'].),\n  (max_discount_amount:DECIMAL, Value examples: ['NULL', 'NULL', '10.00', '300.00'].),\n  (redemption_limit:INT, Value examples: ['500', '1000', 'NULL', '200'].),\n  (status:VARCHAR, possible values: active, inactive, expired. Value examples: ['active', 'expired', 'active', 'active'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-04-01 09:00:00', '2022-12-01 12:00:00', '2023-05-15 15:30:00', '2023-05-01 09:15:00'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-04-15 11:30:00', '2023-01-16 18:45:00', 'NULL', 'NULL'].),\n]\n# Table: wallet_transactions_daily\n[\n  (txid:SERIAL,),\n  (sender_id:BIGINT, Value examples: ['1'].),\n  (sender_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (receiver_id:BIGINT, Value examples: ['1'].),\n  (receiver_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (amount:DECIMAL, Value examples: ['99.99'].),\n  (status:VARCHAR, possible values: pending, success, failed, refunded. Value examples: ['success'].),\n  (type:VARCHAR, possible values: credit, debit. Value examples: ['debit'].),\n  (description:TEXT, Value examples: ['Online purchase'].),\n  (coupon_id:BIGINT, NULL if transaction doesn't involve a coupon. Value examples: ['NULL'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:15:30'].),\n  (completed_at:TIMESTAMP, NULL if failed. Value examples: ['2023-06-01 10:15:45'].),\n  (transaction_ref:VARCHAR, randomly generated uuid4 for users' reference. Value examples: ['ad154bf7-8185-4230-a8d8-3ef59b4e0012'].),\n  (gateway_name:VARCHAR, Value examples: ['Stripe'].),\n  (gateway_ref:VARCHAR, Value examples: ['tx_123abc456def'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1'].),\n  (ip_address:VARCHAR, Value examples: ['192.168.0.1'].),\n  (user_agent:TEXT, Value examples: ['Mozilla/5.0 (iPhone'].),\n]\n# Table: wallet_user_balance_daily\n[\n  (user_id:BIGINT, Value examples: ['1', '2'].),\n  (balance:DECIMAL, Value examples: ['525.80', '429.76'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: wallet_merchant_balance_daily\n[\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3'].),\n  (balance:DECIMAL, Value examples: ['3897.99', '155.24', '2775.25'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: notifications\n[\n  (id:SERIAL,),\n  (user_id:INT, Value examples: ['1', '1', '2'].),\n  (message:TEXT, Value examples: ['Your order #123abc has been shipped!', 'Get 20% off your next purchase! Limited time offer.', 'A package is being returned to you. Refund processing...'].),\n  (type:VARCHAR, possible values: transaction, promotion, security, general. Value examples: ['transaction', 'promotion', 'transaction'].),\n  (status:VARCHAR, possible values: unread, read, archived. Value examples: ['unread', 'unread', 'read'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:16:00', '2023-06-02 09:00:00', '2023-06-07 10:12:00'].),\n  (read_at:TIMESTAMP, NULL if not read.),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'email', 'mobile_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'NULL', 'mobile_1av8p0'].),\n  (action_url:TEXT, can be external https or deeplink url within the app. Value examples: ['app://orders/123abc', 'https://techmart.com/promo/TECH20', 'app://orders?status=returned'].),\n]\n# Table: user_sessions\n[\n  (user_id:BIGINT, Value examples: ['1', '1', '1'].),\n  (session_start_ts:TIMESTAMP, Value examples: ['2023-06-01 09:45:22', '2023-06-02 13:30:00', '2023-06-06 14:19:00'].),\n  (session_end_ts:TIMESTAMP, Value examples: ['2023-06-01 10:20:35', '2023-06-02 14:15:15', '2023-06-06 14:22:10'].),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'web_app', 'web_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'web_33lq1dh', 'web_33lq1dh'].),\n]\n# Table: user_setting_snapshot\n[\n  (user_id:BIGINT, Value examples: ['1', '4', '5'].),\n  (snapshot_date:DATE, Value examples: ['2023-06-07', '2023-06-07', '2023-06-07'].),\n  (tx_limit_daily:DECIMAL, Value examples: ['1000.00', '5000.00', '100.00'].),\n  (tx_limit_monthly:DECIMAL, Value examples: ['5000.00', '20000.00', '500.00'].),\n  (membership_status:INTEGER, 0 for bronze, 1 for silver, 2 for gold, 3 for platinum, 4 for VIP. Value examples: ['2', '4', '0'].),\n  (password_hash:VARCHAR, Value examples: ['bcryptHash($2yz9!&ka1)', 'bcryptHash(Vacay2023*&!Rm)', 'bcryptHash(cRaf7yCr8zy)'].),\n  (api_key:VARCHAR, Value examples: ['9d61c49b-8977-4914-a36b-80d1445e38fa', 'NULL', 'NULL'].),\n  (verified_devices:TEXT, comma separated list of device ids. Value examples: ['mobile_8fh2k1', 'mobile_34jdkl', 'web_8902wknz'].),\n  (verified_ips:TEXT, comma separated list of IP addresses. Value examples: ['192.168.0.1', '143.92.64.138', '192.64.112.188'].),\n  (mfa_enabled:BOOLEAN, Value examples: ['true', 'false', 'false'].),\n  (marketing_opt_in:BOOLEAN, Value examples: ['false', 'true', 'false'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-07 00:00:00', '2023-06-07 00:00:00', '2023-06-07 00:00:00'].),\n  (PRIMARY:KEY,),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nReturn the distinct list of merchant IDs that have received money from a transaction. Include all transaction types in the results you return.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT DISTINCT m.mid AS merchant_id FROM consumer_div.merchants m JOIN consumer_div.wallet_transactions_daily t ON m.mid = t.receiver_id WHERE t.receiver_type = 1",
        "role": "assistant"
      }
    ],
    "db_name": "ewallet",
    "id": 234,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nReturn the distinct list of user IDs who have received transaction notifications.\n\n【数据库schema】\n【DB_ID】 ewallet\n【Schema】\n# Table: users\n[\n  (uid:BIGINT,),\n  (username:VARCHAR,),\n  (email:VARCHAR,),\n  (phone_number:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (last_login_at:TIMESTAMP,),\n  (user_type:VARCHAR, possible values: individual, business, admin.),\n  (status:VARCHAR, possible values: active, inactive, suspended, deleted.),\n  (country:VARCHAR, 2-letter country code.),\n  (address_billing:TEXT,),\n  (address_delivery:TEXT,),\n  (kyc_status:VARCHAR, possible values: pending, approved, rejected.),\n  (kyc_verified_at:TIMESTAMP,),\n]\n# Table: merchants\n[\n  (mid:BIGINT,),\n  (name:VARCHAR,),\n  (description:TEXT,),\n  (website_url:VARCHAR,),\n  (logo_url:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (country:VARCHAR, 2-letter country code.),\n  (state:VARCHAR,),\n  (city:VARCHAR,),\n  (postal_code:VARCHAR,),\n  (address:TEXT,),\n  (status:VARCHAR, possible values: active, inactive, suspended.),\n  (category:VARCHAR,),\n  (sub_category:VARCHAR,),\n  (mcc:INT, Merchant Category Code.),\n  (contact_name:VARCHAR,),\n  (contact_email:VARCHAR,),\n  (contact_phone:VARCHAR,),\n]\n# Table: coupons\n[\n  (cid:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (code:VARCHAR, Value examples: ['TECH20', 'NEWYEAR30', 'DINEDISCOUNT', 'HOME15'].),\n  (description:TEXT, Value examples: ['20% off tech and electronics', '30% off workout gear', 'Get $10 off $50 order', '15% off weekly rental'].),\n  (start_date:DATE, Value examples: ['2023-05-01', '2023-01-01', '2023-06-01', '2023-07-01'].),\n  (end_date:DATE, Value examples: ['2023-05-31', '2023-01-15', '2023-06-30', '2023-08-31'].),\n  (discount_type:VARCHAR, possible values: percentage, fixed_amount. Value examples: ['percentage', 'percentage', 'fixed_amount', 'percentage'].),\n  (discount_value:DECIMAL, Value examples: ['20.00', '30.00', '10.00', '15.00'].),\n  (min_purchase_amount:DECIMAL, Value examples: ['100.00', 'NULL', '50.00', '1000.00'].),\n  (max_discount_amount:DECIMAL, Value examples: ['NULL', 'NULL', '10.00', '300.00'].),\n  (redemption_limit:INT, Value examples: ['500', '1000', 'NULL', '200'].),\n  (status:VARCHAR, possible values: active, inactive, expired. Value examples: ['active', 'expired', 'active', 'active'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-04-01 09:00:00', '2022-12-01 12:00:00', '2023-05-15 15:30:00', '2023-05-01 09:15:00'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-04-15 11:30:00', '2023-01-16 18:45:00', 'NULL', 'NULL'].),\n]\n# Table: wallet_transactions_daily\n[\n  (txid:SERIAL,),\n  (sender_id:BIGINT, Value examples: ['1'].),\n  (sender_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (receiver_id:BIGINT, Value examples: ['1'].),\n  (receiver_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (amount:DECIMAL, Value examples: ['99.99'].),\n  (status:VARCHAR, possible values: pending, success, failed, refunded. Value examples: ['success'].),\n  (type:VARCHAR, possible values: credit, debit. Value examples: ['debit'].),\n  (description:TEXT, Value examples: ['Online purchase'].),\n  (coupon_id:BIGINT, NULL if transaction doesn't involve a coupon. Value examples: ['NULL'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:15:30'].),\n  (completed_at:TIMESTAMP, NULL if failed. Value examples: ['2023-06-01 10:15:45'].),\n  (transaction_ref:VARCHAR, randomly generated uuid4 for users' reference. Value examples: ['ad154bf7-8185-4230-a8d8-3ef59b4e0012'].),\n  (gateway_name:VARCHAR, Value examples: ['Stripe'].),\n  (gateway_ref:VARCHAR, Value examples: ['tx_123abc456def'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1'].),\n  (ip_address:VARCHAR, Value examples: ['192.168.0.1'].),\n  (user_agent:TEXT, Value examples: ['Mozilla/5.0 (iPhone'].),\n]\n# Table: wallet_user_balance_daily\n[\n  (user_id:BIGINT, Value examples: ['1', '2'].),\n  (balance:DECIMAL, Value examples: ['525.80', '429.76'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: wallet_merchant_balance_daily\n[\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3'].),\n  (balance:DECIMAL, Value examples: ['3897.99', '155.24', '2775.25'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: notifications\n[\n  (id:SERIAL,),\n  (user_id:INT, Value examples: ['1', '1', '2'].),\n  (message:TEXT, Value examples: ['Your order #123abc has been shipped!', 'Get 20% off your next purchase! Limited time offer.', 'A package is being returned to you. Refund processing...'].),\n  (type:VARCHAR, possible values: transaction, promotion, security, general. Value examples: ['transaction', 'promotion', 'transaction'].),\n  (status:VARCHAR, possible values: unread, read, archived. Value examples: ['unread', 'unread', 'read'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:16:00', '2023-06-02 09:00:00', '2023-06-07 10:12:00'].),\n  (read_at:TIMESTAMP, NULL if not read.),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'email', 'mobile_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'NULL', 'mobile_1av8p0'].),\n  (action_url:TEXT, can be external https or deeplink url within the app. Value examples: ['app://orders/123abc', 'https://techmart.com/promo/TECH20', 'app://orders?status=returned'].),\n]\n# Table: user_sessions\n[\n  (user_id:BIGINT, Value examples: ['1', '1', '1'].),\n  (session_start_ts:TIMESTAMP, Value examples: ['2023-06-01 09:45:22', '2023-06-02 13:30:00', '2023-06-06 14:19:00'].),\n  (session_end_ts:TIMESTAMP, Value examples: ['2023-06-01 10:20:35', '2023-06-02 14:15:15', '2023-06-06 14:22:10'].),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'web_app', 'web_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'web_33lq1dh', 'web_33lq1dh'].),\n]\n# Table: user_setting_snapshot\n[\n  (user_id:BIGINT, Value examples: ['1', '4', '5'].),\n  (snapshot_date:DATE, Value examples: ['2023-06-07', '2023-06-07', '2023-06-07'].),\n  (tx_limit_daily:DECIMAL, Value examples: ['1000.00', '5000.00', '100.00'].),\n  (tx_limit_monthly:DECIMAL, Value examples: ['5000.00', '20000.00', '500.00'].),\n  (membership_status:INTEGER, 0 for bronze, 1 for silver, 2 for gold, 3 for platinum, 4 for VIP. Value examples: ['2', '4', '0'].),\n  (password_hash:VARCHAR, Value examples: ['bcryptHash($2yz9!&ka1)', 'bcryptHash(Vacay2023*&!Rm)', 'bcryptHash(cRaf7yCr8zy)'].),\n  (api_key:VARCHAR, Value examples: ['9d61c49b-8977-4914-a36b-80d1445e38fa', 'NULL', 'NULL'].),\n  (verified_devices:TEXT, comma separated list of device ids. Value examples: ['mobile_8fh2k1', 'mobile_34jdkl', 'web_8902wknz'].),\n  (verified_ips:TEXT, comma separated list of IP addresses. Value examples: ['192.168.0.1', '143.92.64.138', '192.64.112.188'].),\n  (mfa_enabled:BOOLEAN, Value examples: ['true', 'false', 'false'].),\n  (marketing_opt_in:BOOLEAN, Value examples: ['false', 'true', 'false'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-07 00:00:00', '2023-06-07 00:00:00', '2023-06-07 00:00:00'].),\n  (PRIMARY:KEY,),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nReturn the distinct list of user IDs who have received transaction notifications.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT DISTINCT user_id FROM consumer_div.notifications WHERE type = 'transaction'",
        "role": "assistant"
      }
    ],
    "db_name": "ewallet",
    "id": 235,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the top 3 most common transaction statuses and their respective counts?\n\n【数据库schema】\n【DB_ID】 ewallet\n【Schema】\n# Table: users\n[\n  (uid:BIGINT,),\n  (username:VARCHAR,),\n  (email:VARCHAR,),\n  (phone_number:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (last_login_at:TIMESTAMP,),\n  (user_type:VARCHAR, possible values: individual, business, admin.),\n  (status:VARCHAR, possible values: active, inactive, suspended, deleted.),\n  (country:VARCHAR, 2-letter country code.),\n  (address_billing:TEXT,),\n  (address_delivery:TEXT,),\n  (kyc_status:VARCHAR, possible values: pending, approved, rejected.),\n  (kyc_verified_at:TIMESTAMP,),\n]\n# Table: merchants\n[\n  (mid:BIGINT,),\n  (name:VARCHAR,),\n  (description:TEXT,),\n  (website_url:VARCHAR,),\n  (logo_url:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (country:VARCHAR, 2-letter country code.),\n  (state:VARCHAR,),\n  (city:VARCHAR,),\n  (postal_code:VARCHAR,),\n  (address:TEXT,),\n  (status:VARCHAR, possible values: active, inactive, suspended.),\n  (category:VARCHAR,),\n  (sub_category:VARCHAR,),\n  (mcc:INT, Merchant Category Code.),\n  (contact_name:VARCHAR,),\n  (contact_email:VARCHAR,),\n  (contact_phone:VARCHAR,),\n]\n# Table: coupons\n[\n  (cid:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (code:VARCHAR, Value examples: ['TECH20', 'NEWYEAR30', 'DINEDISCOUNT', 'HOME15'].),\n  (description:TEXT, Value examples: ['20% off tech and electronics', '30% off workout gear', 'Get $10 off $50 order', '15% off weekly rental'].),\n  (start_date:DATE, Value examples: ['2023-05-01', '2023-01-01', '2023-06-01', '2023-07-01'].),\n  (end_date:DATE, Value examples: ['2023-05-31', '2023-01-15', '2023-06-30', '2023-08-31'].),\n  (discount_type:VARCHAR, possible values: percentage, fixed_amount. Value examples: ['percentage', 'percentage', 'fixed_amount', 'percentage'].),\n  (discount_value:DECIMAL, Value examples: ['20.00', '30.00', '10.00', '15.00'].),\n  (min_purchase_amount:DECIMAL, Value examples: ['100.00', 'NULL', '50.00', '1000.00'].),\n  (max_discount_amount:DECIMAL, Value examples: ['NULL', 'NULL', '10.00', '300.00'].),\n  (redemption_limit:INT, Value examples: ['500', '1000', 'NULL', '200'].),\n  (status:VARCHAR, possible values: active, inactive, expired. Value examples: ['active', 'expired', 'active', 'active'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-04-01 09:00:00', '2022-12-01 12:00:00', '2023-05-15 15:30:00', '2023-05-01 09:15:00'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-04-15 11:30:00', '2023-01-16 18:45:00', 'NULL', 'NULL'].),\n]\n# Table: wallet_transactions_daily\n[\n  (txid:SERIAL,),\n  (sender_id:BIGINT, Value examples: ['1'].),\n  (sender_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (receiver_id:BIGINT, Value examples: ['1'].),\n  (receiver_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (amount:DECIMAL, Value examples: ['99.99'].),\n  (status:VARCHAR, possible values: pending, success, failed, refunded. Value examples: ['success'].),\n  (type:VARCHAR, possible values: credit, debit. Value examples: ['debit'].),\n  (description:TEXT, Value examples: ['Online purchase'].),\n  (coupon_id:BIGINT, NULL if transaction doesn't involve a coupon. Value examples: ['NULL'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:15:30'].),\n  (completed_at:TIMESTAMP, NULL if failed. Value examples: ['2023-06-01 10:15:45'].),\n  (transaction_ref:VARCHAR, randomly generated uuid4 for users' reference. Value examples: ['ad154bf7-8185-4230-a8d8-3ef59b4e0012'].),\n  (gateway_name:VARCHAR, Value examples: ['Stripe'].),\n  (gateway_ref:VARCHAR, Value examples: ['tx_123abc456def'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1'].),\n  (ip_address:VARCHAR, Value examples: ['192.168.0.1'].),\n  (user_agent:TEXT, Value examples: ['Mozilla/5.0 (iPhone'].),\n]\n# Table: wallet_user_balance_daily\n[\n  (user_id:BIGINT, Value examples: ['1', '2'].),\n  (balance:DECIMAL, Value examples: ['525.80', '429.76'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: wallet_merchant_balance_daily\n[\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3'].),\n  (balance:DECIMAL, Value examples: ['3897.99', '155.24', '2775.25'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: notifications\n[\n  (id:SERIAL,),\n  (user_id:INT, Value examples: ['1', '1', '2'].),\n  (message:TEXT, Value examples: ['Your order #123abc has been shipped!', 'Get 20% off your next purchase! Limited time offer.', 'A package is being returned to you. Refund processing...'].),\n  (type:VARCHAR, possible values: transaction, promotion, security, general. Value examples: ['transaction', 'promotion', 'transaction'].),\n  (status:VARCHAR, possible values: unread, read, archived. Value examples: ['unread', 'unread', 'read'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:16:00', '2023-06-02 09:00:00', '2023-06-07 10:12:00'].),\n  (read_at:TIMESTAMP, NULL if not read.),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'email', 'mobile_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'NULL', 'mobile_1av8p0'].),\n  (action_url:TEXT, can be external https or deeplink url within the app. Value examples: ['app://orders/123abc', 'https://techmart.com/promo/TECH20', 'app://orders?status=returned'].),\n]\n# Table: user_sessions\n[\n  (user_id:BIGINT, Value examples: ['1', '1', '1'].),\n  (session_start_ts:TIMESTAMP, Value examples: ['2023-06-01 09:45:22', '2023-06-02 13:30:00', '2023-06-06 14:19:00'].),\n  (session_end_ts:TIMESTAMP, Value examples: ['2023-06-01 10:20:35', '2023-06-02 14:15:15', '2023-06-06 14:22:10'].),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'web_app', 'web_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'web_33lq1dh', 'web_33lq1dh'].),\n]\n# Table: user_setting_snapshot\n[\n  (user_id:BIGINT, Value examples: ['1', '4', '5'].),\n  (snapshot_date:DATE, Value examples: ['2023-06-07', '2023-06-07', '2023-06-07'].),\n  (tx_limit_daily:DECIMAL, Value examples: ['1000.00', '5000.00', '100.00'].),\n  (tx_limit_monthly:DECIMAL, Value examples: ['5000.00', '20000.00', '500.00'].),\n  (membership_status:INTEGER, 0 for bronze, 1 for silver, 2 for gold, 3 for platinum, 4 for VIP. Value examples: ['2', '4', '0'].),\n  (password_hash:VARCHAR, Value examples: ['bcryptHash($2yz9!&ka1)', 'bcryptHash(Vacay2023*&!Rm)', 'bcryptHash(cRaf7yCr8zy)'].),\n  (api_key:VARCHAR, Value examples: ['9d61c49b-8977-4914-a36b-80d1445e38fa', 'NULL', 'NULL'].),\n  (verified_devices:TEXT, comma separated list of device ids. Value examples: ['mobile_8fh2k1', 'mobile_34jdkl', 'web_8902wknz'].),\n  (verified_ips:TEXT, comma separated list of IP addresses. Value examples: ['192.168.0.1', '143.92.64.138', '192.64.112.188'].),\n  (mfa_enabled:BOOLEAN, Value examples: ['true', 'false', 'false'].),\n  (marketing_opt_in:BOOLEAN, Value examples: ['false', 'true', 'false'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-07 00:00:00', '2023-06-07 00:00:00', '2023-06-07 00:00:00'].),\n  (PRIMARY:KEY,),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nWhat are the top 3 most common transaction statuses and their respective counts?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT status, COUNT(*) AS COUNT FROM consumer_div.wallet_transactions_daily GROUP BY status ORDER BY COUNT DESC LIMIT 3",
        "role": "assistant"
      }
    ],
    "db_name": "ewallet",
    "id": 236,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the top 2 most frequently used device types for user sessions and their respective counts?\n\n【数据库schema】\n【DB_ID】 ewallet\n【Schema】\n# Table: users\n[\n  (uid:BIGINT,),\n  (username:VARCHAR,),\n  (email:VARCHAR,),\n  (phone_number:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (last_login_at:TIMESTAMP,),\n  (user_type:VARCHAR, possible values: individual, business, admin.),\n  (status:VARCHAR, possible values: active, inactive, suspended, deleted.),\n  (country:VARCHAR, 2-letter country code.),\n  (address_billing:TEXT,),\n  (address_delivery:TEXT,),\n  (kyc_status:VARCHAR, possible values: pending, approved, rejected.),\n  (kyc_verified_at:TIMESTAMP,),\n]\n# Table: merchants\n[\n  (mid:BIGINT,),\n  (name:VARCHAR,),\n  (description:TEXT,),\n  (website_url:VARCHAR,),\n  (logo_url:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (country:VARCHAR, 2-letter country code.),\n  (state:VARCHAR,),\n  (city:VARCHAR,),\n  (postal_code:VARCHAR,),\n  (address:TEXT,),\n  (status:VARCHAR, possible values: active, inactive, suspended.),\n  (category:VARCHAR,),\n  (sub_category:VARCHAR,),\n  (mcc:INT, Merchant Category Code.),\n  (contact_name:VARCHAR,),\n  (contact_email:VARCHAR,),\n  (contact_phone:VARCHAR,),\n]\n# Table: coupons\n[\n  (cid:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (code:VARCHAR, Value examples: ['TECH20', 'NEWYEAR30', 'DINEDISCOUNT', 'HOME15'].),\n  (description:TEXT, Value examples: ['20% off tech and electronics', '30% off workout gear', 'Get $10 off $50 order', '15% off weekly rental'].),\n  (start_date:DATE, Value examples: ['2023-05-01', '2023-01-01', '2023-06-01', '2023-07-01'].),\n  (end_date:DATE, Value examples: ['2023-05-31', '2023-01-15', '2023-06-30', '2023-08-31'].),\n  (discount_type:VARCHAR, possible values: percentage, fixed_amount. Value examples: ['percentage', 'percentage', 'fixed_amount', 'percentage'].),\n  (discount_value:DECIMAL, Value examples: ['20.00', '30.00', '10.00', '15.00'].),\n  (min_purchase_amount:DECIMAL, Value examples: ['100.00', 'NULL', '50.00', '1000.00'].),\n  (max_discount_amount:DECIMAL, Value examples: ['NULL', 'NULL', '10.00', '300.00'].),\n  (redemption_limit:INT, Value examples: ['500', '1000', 'NULL', '200'].),\n  (status:VARCHAR, possible values: active, inactive, expired. Value examples: ['active', 'expired', 'active', 'active'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-04-01 09:00:00', '2022-12-01 12:00:00', '2023-05-15 15:30:00', '2023-05-01 09:15:00'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-04-15 11:30:00', '2023-01-16 18:45:00', 'NULL', 'NULL'].),\n]\n# Table: wallet_transactions_daily\n[\n  (txid:SERIAL,),\n  (sender_id:BIGINT, Value examples: ['1'].),\n  (sender_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (receiver_id:BIGINT, Value examples: ['1'].),\n  (receiver_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (amount:DECIMAL, Value examples: ['99.99'].),\n  (status:VARCHAR, possible values: pending, success, failed, refunded. Value examples: ['success'].),\n  (type:VARCHAR, possible values: credit, debit. Value examples: ['debit'].),\n  (description:TEXT, Value examples: ['Online purchase'].),\n  (coupon_id:BIGINT, NULL if transaction doesn't involve a coupon. Value examples: ['NULL'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:15:30'].),\n  (completed_at:TIMESTAMP, NULL if failed. Value examples: ['2023-06-01 10:15:45'].),\n  (transaction_ref:VARCHAR, randomly generated uuid4 for users' reference. Value examples: ['ad154bf7-8185-4230-a8d8-3ef59b4e0012'].),\n  (gateway_name:VARCHAR, Value examples: ['Stripe'].),\n  (gateway_ref:VARCHAR, Value examples: ['tx_123abc456def'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1'].),\n  (ip_address:VARCHAR, Value examples: ['192.168.0.1'].),\n  (user_agent:TEXT, Value examples: ['Mozilla/5.0 (iPhone'].),\n]\n# Table: wallet_user_balance_daily\n[\n  (user_id:BIGINT, Value examples: ['1', '2'].),\n  (balance:DECIMAL, Value examples: ['525.80', '429.76'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: wallet_merchant_balance_daily\n[\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3'].),\n  (balance:DECIMAL, Value examples: ['3897.99', '155.24', '2775.25'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: notifications\n[\n  (id:SERIAL,),\n  (user_id:INT, Value examples: ['1', '1', '2'].),\n  (message:TEXT, Value examples: ['Your order #123abc has been shipped!', 'Get 20% off your next purchase! Limited time offer.', 'A package is being returned to you. Refund processing...'].),\n  (type:VARCHAR, possible values: transaction, promotion, security, general. Value examples: ['transaction', 'promotion', 'transaction'].),\n  (status:VARCHAR, possible values: unread, read, archived. Value examples: ['unread', 'unread', 'read'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:16:00', '2023-06-02 09:00:00', '2023-06-07 10:12:00'].),\n  (read_at:TIMESTAMP, NULL if not read.),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'email', 'mobile_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'NULL', 'mobile_1av8p0'].),\n  (action_url:TEXT, can be external https or deeplink url within the app. Value examples: ['app://orders/123abc', 'https://techmart.com/promo/TECH20', 'app://orders?status=returned'].),\n]\n# Table: user_sessions\n[\n  (user_id:BIGINT, Value examples: ['1', '1', '1'].),\n  (session_start_ts:TIMESTAMP, Value examples: ['2023-06-01 09:45:22', '2023-06-02 13:30:00', '2023-06-06 14:19:00'].),\n  (session_end_ts:TIMESTAMP, Value examples: ['2023-06-01 10:20:35', '2023-06-02 14:15:15', '2023-06-06 14:22:10'].),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'web_app', 'web_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'web_33lq1dh', 'web_33lq1dh'].),\n]\n# Table: user_setting_snapshot\n[\n  (user_id:BIGINT, Value examples: ['1', '4', '5'].),\n  (snapshot_date:DATE, Value examples: ['2023-06-07', '2023-06-07', '2023-06-07'].),\n  (tx_limit_daily:DECIMAL, Value examples: ['1000.00', '5000.00', '100.00'].),\n  (tx_limit_monthly:DECIMAL, Value examples: ['5000.00', '20000.00', '500.00'].),\n  (membership_status:INTEGER, 0 for bronze, 1 for silver, 2 for gold, 3 for platinum, 4 for VIP. Value examples: ['2', '4', '0'].),\n  (password_hash:VARCHAR, Value examples: ['bcryptHash($2yz9!&ka1)', 'bcryptHash(Vacay2023*&!Rm)', 'bcryptHash(cRaf7yCr8zy)'].),\n  (api_key:VARCHAR, Value examples: ['9d61c49b-8977-4914-a36b-80d1445e38fa', 'NULL', 'NULL'].),\n  (verified_devices:TEXT, comma separated list of device ids. Value examples: ['mobile_8fh2k1', 'mobile_34jdkl', 'web_8902wknz'].),\n  (verified_ips:TEXT, comma separated list of IP addresses. Value examples: ['192.168.0.1', '143.92.64.138', '192.64.112.188'].),\n  (mfa_enabled:BOOLEAN, Value examples: ['true', 'false', 'false'].),\n  (marketing_opt_in:BOOLEAN, Value examples: ['false', 'true', 'false'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-07 00:00:00', '2023-06-07 00:00:00', '2023-06-07 00:00:00'].),\n  (PRIMARY:KEY,),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nWhat are the top 2 most frequently used device types for user sessions and their respective counts?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT device_type, COUNT(*) AS COUNT FROM consumer_div.user_sessions GROUP BY device_type ORDER BY COUNT DESC LIMIT 2",
        "role": "assistant"
      }
    ],
    "db_name": "ewallet",
    "id": 237,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nReturn users (user ID and username) who have not received any notifications\n\n【数据库schema】\n【DB_ID】 ewallet\n【Schema】\n# Table: users\n[\n  (uid:BIGINT,),\n  (username:VARCHAR,),\n  (email:VARCHAR,),\n  (phone_number:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (last_login_at:TIMESTAMP,),\n  (user_type:VARCHAR, possible values: individual, business, admin.),\n  (status:VARCHAR, possible values: active, inactive, suspended, deleted.),\n  (country:VARCHAR, 2-letter country code.),\n  (address_billing:TEXT,),\n  (address_delivery:TEXT,),\n  (kyc_status:VARCHAR, possible values: pending, approved, rejected.),\n  (kyc_verified_at:TIMESTAMP,),\n]\n# Table: merchants\n[\n  (mid:BIGINT,),\n  (name:VARCHAR,),\n  (description:TEXT,),\n  (website_url:VARCHAR,),\n  (logo_url:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (country:VARCHAR, 2-letter country code.),\n  (state:VARCHAR,),\n  (city:VARCHAR,),\n  (postal_code:VARCHAR,),\n  (address:TEXT,),\n  (status:VARCHAR, possible values: active, inactive, suspended.),\n  (category:VARCHAR,),\n  (sub_category:VARCHAR,),\n  (mcc:INT, Merchant Category Code.),\n  (contact_name:VARCHAR,),\n  (contact_email:VARCHAR,),\n  (contact_phone:VARCHAR,),\n]\n# Table: coupons\n[\n  (cid:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (code:VARCHAR, Value examples: ['TECH20', 'NEWYEAR30', 'DINEDISCOUNT', 'HOME15'].),\n  (description:TEXT, Value examples: ['20% off tech and electronics', '30% off workout gear', 'Get $10 off $50 order', '15% off weekly rental'].),\n  (start_date:DATE, Value examples: ['2023-05-01', '2023-01-01', '2023-06-01', '2023-07-01'].),\n  (end_date:DATE, Value examples: ['2023-05-31', '2023-01-15', '2023-06-30', '2023-08-31'].),\n  (discount_type:VARCHAR, possible values: percentage, fixed_amount. Value examples: ['percentage', 'percentage', 'fixed_amount', 'percentage'].),\n  (discount_value:DECIMAL, Value examples: ['20.00', '30.00', '10.00', '15.00'].),\n  (min_purchase_amount:DECIMAL, Value examples: ['100.00', 'NULL', '50.00', '1000.00'].),\n  (max_discount_amount:DECIMAL, Value examples: ['NULL', 'NULL', '10.00', '300.00'].),\n  (redemption_limit:INT, Value examples: ['500', '1000', 'NULL', '200'].),\n  (status:VARCHAR, possible values: active, inactive, expired. Value examples: ['active', 'expired', 'active', 'active'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-04-01 09:00:00', '2022-12-01 12:00:00', '2023-05-15 15:30:00', '2023-05-01 09:15:00'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-04-15 11:30:00', '2023-01-16 18:45:00', 'NULL', 'NULL'].),\n]\n# Table: wallet_transactions_daily\n[\n  (txid:SERIAL,),\n  (sender_id:BIGINT, Value examples: ['1'].),\n  (sender_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (receiver_id:BIGINT, Value examples: ['1'].),\n  (receiver_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (amount:DECIMAL, Value examples: ['99.99'].),\n  (status:VARCHAR, possible values: pending, success, failed, refunded. Value examples: ['success'].),\n  (type:VARCHAR, possible values: credit, debit. Value examples: ['debit'].),\n  (description:TEXT, Value examples: ['Online purchase'].),\n  (coupon_id:BIGINT, NULL if transaction doesn't involve a coupon. Value examples: ['NULL'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:15:30'].),\n  (completed_at:TIMESTAMP, NULL if failed. Value examples: ['2023-06-01 10:15:45'].),\n  (transaction_ref:VARCHAR, randomly generated uuid4 for users' reference. Value examples: ['ad154bf7-8185-4230-a8d8-3ef59b4e0012'].),\n  (gateway_name:VARCHAR, Value examples: ['Stripe'].),\n  (gateway_ref:VARCHAR, Value examples: ['tx_123abc456def'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1'].),\n  (ip_address:VARCHAR, Value examples: ['192.168.0.1'].),\n  (user_agent:TEXT, Value examples: ['Mozilla/5.0 (iPhone'].),\n]\n# Table: wallet_user_balance_daily\n[\n  (user_id:BIGINT, Value examples: ['1', '2'].),\n  (balance:DECIMAL, Value examples: ['525.80', '429.76'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: wallet_merchant_balance_daily\n[\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3'].),\n  (balance:DECIMAL, Value examples: ['3897.99', '155.24', '2775.25'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: notifications\n[\n  (id:SERIAL,),\n  (user_id:INT, Value examples: ['1', '1', '2'].),\n  (message:TEXT, Value examples: ['Your order #123abc has been shipped!', 'Get 20% off your next purchase! Limited time offer.', 'A package is being returned to you. Refund processing...'].),\n  (type:VARCHAR, possible values: transaction, promotion, security, general. Value examples: ['transaction', 'promotion', 'transaction'].),\n  (status:VARCHAR, possible values: unread, read, archived. Value examples: ['unread', 'unread', 'read'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:16:00', '2023-06-02 09:00:00', '2023-06-07 10:12:00'].),\n  (read_at:TIMESTAMP, NULL if not read.),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'email', 'mobile_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'NULL', 'mobile_1av8p0'].),\n  (action_url:TEXT, can be external https or deeplink url within the app. Value examples: ['app://orders/123abc', 'https://techmart.com/promo/TECH20', 'app://orders?status=returned'].),\n]\n# Table: user_sessions\n[\n  (user_id:BIGINT, Value examples: ['1', '1', '1'].),\n  (session_start_ts:TIMESTAMP, Value examples: ['2023-06-01 09:45:22', '2023-06-02 13:30:00', '2023-06-06 14:19:00'].),\n  (session_end_ts:TIMESTAMP, Value examples: ['2023-06-01 10:20:35', '2023-06-02 14:15:15', '2023-06-06 14:22:10'].),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'web_app', 'web_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'web_33lq1dh', 'web_33lq1dh'].),\n]\n# Table: user_setting_snapshot\n[\n  (user_id:BIGINT, Value examples: ['1', '4', '5'].),\n  (snapshot_date:DATE, Value examples: ['2023-06-07', '2023-06-07', '2023-06-07'].),\n  (tx_limit_daily:DECIMAL, Value examples: ['1000.00', '5000.00', '100.00'].),\n  (tx_limit_monthly:DECIMAL, Value examples: ['5000.00', '20000.00', '500.00'].),\n  (membership_status:INTEGER, 0 for bronze, 1 for silver, 2 for gold, 3 for platinum, 4 for VIP. Value examples: ['2', '4', '0'].),\n  (password_hash:VARCHAR, Value examples: ['bcryptHash($2yz9!&ka1)', 'bcryptHash(Vacay2023*&!Rm)', 'bcryptHash(cRaf7yCr8zy)'].),\n  (api_key:VARCHAR, Value examples: ['9d61c49b-8977-4914-a36b-80d1445e38fa', 'NULL', 'NULL'].),\n  (verified_devices:TEXT, comma separated list of device ids. Value examples: ['mobile_8fh2k1', 'mobile_34jdkl', 'web_8902wknz'].),\n  (verified_ips:TEXT, comma separated list of IP addresses. Value examples: ['192.168.0.1', '143.92.64.138', '192.64.112.188'].),\n  (mfa_enabled:BOOLEAN, Value examples: ['true', 'false', 'false'].),\n  (marketing_opt_in:BOOLEAN, Value examples: ['false', 'true', 'false'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-07 00:00:00', '2023-06-07 00:00:00', '2023-06-07 00:00:00'].),\n  (PRIMARY:KEY,),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nReturn users (user ID and username) who have not received any notifications\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT u.uid, u.username FROM consumer_div.users u LEFT JOIN consumer_div.notifications n ON u.uid = n.user_id WHERE n.id IS NULL",
        "role": "assistant"
      }
    ],
    "db_name": "ewallet",
    "id": 238,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nReturn merchants (merchant ID and name) who have not issued any coupons.\n\n【数据库schema】\n【DB_ID】 ewallet\n【Schema】\n# Table: users\n[\n  (uid:BIGINT,),\n  (username:VARCHAR,),\n  (email:VARCHAR,),\n  (phone_number:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (last_login_at:TIMESTAMP,),\n  (user_type:VARCHAR, possible values: individual, business, admin.),\n  (status:VARCHAR, possible values: active, inactive, suspended, deleted.),\n  (country:VARCHAR, 2-letter country code.),\n  (address_billing:TEXT,),\n  (address_delivery:TEXT,),\n  (kyc_status:VARCHAR, possible values: pending, approved, rejected.),\n  (kyc_verified_at:TIMESTAMP,),\n]\n# Table: merchants\n[\n  (mid:BIGINT,),\n  (name:VARCHAR,),\n  (description:TEXT,),\n  (website_url:VARCHAR,),\n  (logo_url:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (country:VARCHAR, 2-letter country code.),\n  (state:VARCHAR,),\n  (city:VARCHAR,),\n  (postal_code:VARCHAR,),\n  (address:TEXT,),\n  (status:VARCHAR, possible values: active, inactive, suspended.),\n  (category:VARCHAR,),\n  (sub_category:VARCHAR,),\n  (mcc:INT, Merchant Category Code.),\n  (contact_name:VARCHAR,),\n  (contact_email:VARCHAR,),\n  (contact_phone:VARCHAR,),\n]\n# Table: coupons\n[\n  (cid:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (code:VARCHAR, Value examples: ['TECH20', 'NEWYEAR30', 'DINEDISCOUNT', 'HOME15'].),\n  (description:TEXT, Value examples: ['20% off tech and electronics', '30% off workout gear', 'Get $10 off $50 order', '15% off weekly rental'].),\n  (start_date:DATE, Value examples: ['2023-05-01', '2023-01-01', '2023-06-01', '2023-07-01'].),\n  (end_date:DATE, Value examples: ['2023-05-31', '2023-01-15', '2023-06-30', '2023-08-31'].),\n  (discount_type:VARCHAR, possible values: percentage, fixed_amount. Value examples: ['percentage', 'percentage', 'fixed_amount', 'percentage'].),\n  (discount_value:DECIMAL, Value examples: ['20.00', '30.00', '10.00', '15.00'].),\n  (min_purchase_amount:DECIMAL, Value examples: ['100.00', 'NULL', '50.00', '1000.00'].),\n  (max_discount_amount:DECIMAL, Value examples: ['NULL', 'NULL', '10.00', '300.00'].),\n  (redemption_limit:INT, Value examples: ['500', '1000', 'NULL', '200'].),\n  (status:VARCHAR, possible values: active, inactive, expired. Value examples: ['active', 'expired', 'active', 'active'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-04-01 09:00:00', '2022-12-01 12:00:00', '2023-05-15 15:30:00', '2023-05-01 09:15:00'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-04-15 11:30:00', '2023-01-16 18:45:00', 'NULL', 'NULL'].),\n]\n# Table: wallet_transactions_daily\n[\n  (txid:SERIAL,),\n  (sender_id:BIGINT, Value examples: ['1'].),\n  (sender_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (receiver_id:BIGINT, Value examples: ['1'].),\n  (receiver_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (amount:DECIMAL, Value examples: ['99.99'].),\n  (status:VARCHAR, possible values: pending, success, failed, refunded. Value examples: ['success'].),\n  (type:VARCHAR, possible values: credit, debit. Value examples: ['debit'].),\n  (description:TEXT, Value examples: ['Online purchase'].),\n  (coupon_id:BIGINT, NULL if transaction doesn't involve a coupon. Value examples: ['NULL'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:15:30'].),\n  (completed_at:TIMESTAMP, NULL if failed. Value examples: ['2023-06-01 10:15:45'].),\n  (transaction_ref:VARCHAR, randomly generated uuid4 for users' reference. Value examples: ['ad154bf7-8185-4230-a8d8-3ef59b4e0012'].),\n  (gateway_name:VARCHAR, Value examples: ['Stripe'].),\n  (gateway_ref:VARCHAR, Value examples: ['tx_123abc456def'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1'].),\n  (ip_address:VARCHAR, Value examples: ['192.168.0.1'].),\n  (user_agent:TEXT, Value examples: ['Mozilla/5.0 (iPhone'].),\n]\n# Table: wallet_user_balance_daily\n[\n  (user_id:BIGINT, Value examples: ['1', '2'].),\n  (balance:DECIMAL, Value examples: ['525.80', '429.76'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: wallet_merchant_balance_daily\n[\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3'].),\n  (balance:DECIMAL, Value examples: ['3897.99', '155.24', '2775.25'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: notifications\n[\n  (id:SERIAL,),\n  (user_id:INT, Value examples: ['1', '1', '2'].),\n  (message:TEXT, Value examples: ['Your order #123abc has been shipped!', 'Get 20% off your next purchase! Limited time offer.', 'A package is being returned to you. Refund processing...'].),\n  (type:VARCHAR, possible values: transaction, promotion, security, general. Value examples: ['transaction', 'promotion', 'transaction'].),\n  (status:VARCHAR, possible values: unread, read, archived. Value examples: ['unread', 'unread', 'read'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:16:00', '2023-06-02 09:00:00', '2023-06-07 10:12:00'].),\n  (read_at:TIMESTAMP, NULL if not read.),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'email', 'mobile_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'NULL', 'mobile_1av8p0'].),\n  (action_url:TEXT, can be external https or deeplink url within the app. Value examples: ['app://orders/123abc', 'https://techmart.com/promo/TECH20', 'app://orders?status=returned'].),\n]\n# Table: user_sessions\n[\n  (user_id:BIGINT, Value examples: ['1', '1', '1'].),\n  (session_start_ts:TIMESTAMP, Value examples: ['2023-06-01 09:45:22', '2023-06-02 13:30:00', '2023-06-06 14:19:00'].),\n  (session_end_ts:TIMESTAMP, Value examples: ['2023-06-01 10:20:35', '2023-06-02 14:15:15', '2023-06-06 14:22:10'].),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'web_app', 'web_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'web_33lq1dh', 'web_33lq1dh'].),\n]\n# Table: user_setting_snapshot\n[\n  (user_id:BIGINT, Value examples: ['1', '4', '5'].),\n  (snapshot_date:DATE, Value examples: ['2023-06-07', '2023-06-07', '2023-06-07'].),\n  (tx_limit_daily:DECIMAL, Value examples: ['1000.00', '5000.00', '100.00'].),\n  (tx_limit_monthly:DECIMAL, Value examples: ['5000.00', '20000.00', '500.00'].),\n  (membership_status:INTEGER, 0 for bronze, 1 for silver, 2 for gold, 3 for platinum, 4 for VIP. Value examples: ['2', '4', '0'].),\n  (password_hash:VARCHAR, Value examples: ['bcryptHash($2yz9!&ka1)', 'bcryptHash(Vacay2023*&!Rm)', 'bcryptHash(cRaf7yCr8zy)'].),\n  (api_key:VARCHAR, Value examples: ['9d61c49b-8977-4914-a36b-80d1445e38fa', 'NULL', 'NULL'].),\n  (verified_devices:TEXT, comma separated list of device ids. Value examples: ['mobile_8fh2k1', 'mobile_34jdkl', 'web_8902wknz'].),\n  (verified_ips:TEXT, comma separated list of IP addresses. Value examples: ['192.168.0.1', '143.92.64.138', '192.64.112.188'].),\n  (mfa_enabled:BOOLEAN, Value examples: ['true', 'false', 'false'].),\n  (marketing_opt_in:BOOLEAN, Value examples: ['false', 'true', 'false'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-07 00:00:00', '2023-06-07 00:00:00', '2023-06-07 00:00:00'].),\n  (PRIMARY:KEY,),\n]\n\n【Foreign keys】\n\n【参考信息】\n\n\n【用户问题】\nReturn merchants (merchant ID and name) who have not issued any coupons.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT m.mid AS merchant_id, m.name AS merchant_name FROM consumer_div.merchants m LEFT JOIN consumer_div.coupons c ON m.mid = c.merchant_id WHERE c.cid IS NULL",
        "role": "assistant"
      }
    ],
    "db_name": "ewallet",
    "id": 239,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWho are the top 5 customers by total transaction amount? Return their name and total amount.\n\n【数据库schema】\n【DB_ID】 broker\n【Schema】\n# Table: sbCustomer\n[\n  (sbCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbCustName:varchar, Value examples: ['john doe', 'Jane Smith', 'Bob Johnson'].),\n  (sbCustEmail:varchar, Value examples: ['john.doe@email.com', 'jane.smith@email.com', 'bob.johnson@email.com'].),\n  (sbCustPhone:varchar, Value examples: ['555-123-4567', '555-987-6543', '555-246-8135'].),\n  (sbCustAddress1:varchar, Value examples: ['123 Main St', '456 Oak Rd', '789 Pine Ave'].),\n  (sbCustAddress2:varchar,),\n  (sbCustCity:varchar, Value examples: ['Anytown', 'Someville', 'Mytown'].),\n  (sbCustState:varchar, Value examples: ['CA', 'NY', 'TX'].),\n  (sbCustCountry:varchar, Value examples: ['USA', 'USA', 'USA'].),\n  (sbCustPostalCode:varchar, Value examples: ['90001', '10002', '75000'].),\n  (sbCustJoinDate:date, Value examples: ['2020-01-01', '2019-03-15', '2022-06-01'].),\n  (sbCustStatus:varchar, possible values: active, inactive, suspended, closed. Value examples: ['active', 'active', 'inactive'].),\n]\n# Table: sbTicker\n[\n  (sbTickerId:varchar, Value examples: ['T001', 'T002', 'T005'].),\n  (sbTickerSymbol:varchar, Value examples: ['AAPL', 'MSFT', 'GOOGL'].),\n  (sbTickerName:varchar, Value examples: ['Apple Inc.', 'Microsoft Corporation', 'Alphabet Inc.'].),\n  (sbTickerType:varchar, possible values: stock, etf, mutualfund. Value examples: ['stock', 'stock', 'stock'].),\n  (sbTickerExchange:varchar, Value examples: ['NASDAQ', 'NASDAQ', 'NASDAQ'].),\n  (sbTickerCurrency:varchar, Value examples: ['USD', 'USD', 'USD'].),\n  (sbTickerDb2x:varchar, 2 letter exchange code. Value examples: ['NQ', 'NQ', 'NQ'].),\n  (sbTickerIsActive:boolean, Value examples: ['true', 'true', 'true'].),\n]\n# Table: sbDailyPrice\n[\n  (sbDpTickerId:varchar, Value examples: ['T001', 'T002'].),\n  (sbDpDate:date, Value examples: ['2023-04-01', '2023-04-01'].),\n  (sbDpOpen:numeric, Value examples: ['150.00', '280.00'].),\n  (sbDpHigh:numeric, Value examples: ['152.50', '282.75'].),\n  (sbDpLow:numeric, Value examples: ['148.75', '279.50'].),\n  (sbDpClose:numeric, Value examples: ['151.25', '281.00'].),\n  (sbDpVolume:bigint, Value examples: ['75000000', '35000000'].),\n  (sbDpEpochMs:bigint, epoch milliseconds for timestamp. Value examples: ['1680336000000', '1680336000000'].),\n  (sbDpSource:varchar, Value examples: ['NYSE', 'NASDAQ'].),\n]\n# Table: sbTransaction\n[\n  (sbTxId:varchar, Value examples: ['TX001', 'TX002', 'TX003'].),\n  (sbTxCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbTxTickerId:varchar, Value examples: ['T001', 'T002', 'T003'].),\n  (sbTxDateTime:timestamp, Value examples: ['2023-04-01 09:30:00', '2023-04-01 10:15:00', '2023-04-01 11:00:00'].),\n  (sbTxType:varchar, possible values: buy, sell. Value examples: ['buy', 'sell', 'buy'].),\n  (sbTxShares:numeric, Value examples: ['100', '50', '10'].),\n  (sbTxPrice:numeric, Value examples: ['150.00', '280.00', '3200.00'].),\n  (sbTxAmount:numeric, Value examples: ['15000.00', '14000.00', '32000.00'].),\n  (sbTxCcy:varchar, transaction currency. Value examples: ['USD', 'USD', 'USD'].),\n  (sbTxTax:numeric, Value examples: ['75.00', '70.00', '160.00'].),\n  (sbTxCommission:numeric, Value examples: ['10.00', '10.00', '20.00'].),\n  (sbTxKpx:varchar, internal code. Value examples: ['KP001', 'KP002', 'KP003'].),\n  (sbTxSettlementDateStr:varchar, settlement date as string in yyyyMMdd HH:mm:ss format. NULL if not settled. Value examples: ['20230401 09:30:00', '20230401 10:15:00', '20230401 11:00:00'].),\n  (sbTxStatus:varchar, possible values: success, fail, pending. Value examples: ['success', 'success', 'success'].),\n]\n\n【Foreign keys】\n\n【参考信息】\nTo get the total transaction amount per customer, join the customer and transaction tables, group by customer, and sum the transaction amounts.\nTAC = Total Active Customers who have recently joined\nMoMC = Month-over-month change in average closing price for each ticker.\nACP = Average Closing Price of tickers over a recent period\n\n【用户问题】\nWho are the top 5 customers by total transaction amount? Return their name and total amount.\n\n```sql",
        "role": "user"
      },
      {
        "content": "WITH cust_tx AS (SELECT c.sbCustId, c.sbCustName, SUM(t.sbTxAmount) AS total_amount FROM sbCustomer c JOIN sbTransaction t ON c.sbCustId = t.sbTxCustId GROUP BY c.sbCustId, c.sbCustName) SELECT sbCustName, total_amount FROM cust_tx ORDER BY total_amount DESC LIMIT 5",
        "role": "assistant"
      }
    ],
    "db_name": "broker",
    "id": 240,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the 5 most frequently bought stock ticker symbols in the past 10 days? Return the ticker symbol and number of buy transactions.\n\n【数据库schema】\n【DB_ID】 broker\n【Schema】\n# Table: sbCustomer\n[\n  (sbCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbCustName:varchar, Value examples: ['john doe', 'Jane Smith', 'Bob Johnson'].),\n  (sbCustEmail:varchar, Value examples: ['john.doe@email.com', 'jane.smith@email.com', 'bob.johnson@email.com'].),\n  (sbCustPhone:varchar, Value examples: ['555-123-4567', '555-987-6543', '555-246-8135'].),\n  (sbCustAddress1:varchar, Value examples: ['123 Main St', '456 Oak Rd', '789 Pine Ave'].),\n  (sbCustAddress2:varchar,),\n  (sbCustCity:varchar, Value examples: ['Anytown', 'Someville', 'Mytown'].),\n  (sbCustState:varchar, Value examples: ['CA', 'NY', 'TX'].),\n  (sbCustCountry:varchar, Value examples: ['USA', 'USA', 'USA'].),\n  (sbCustPostalCode:varchar, Value examples: ['90001', '10002', '75000'].),\n  (sbCustJoinDate:date, Value examples: ['2020-01-01', '2019-03-15', '2022-06-01'].),\n  (sbCustStatus:varchar, possible values: active, inactive, suspended, closed. Value examples: ['active', 'active', 'inactive'].),\n]\n# Table: sbTicker\n[\n  (sbTickerId:varchar, Value examples: ['T001', 'T002', 'T005'].),\n  (sbTickerSymbol:varchar, Value examples: ['AAPL', 'MSFT', 'GOOGL'].),\n  (sbTickerName:varchar, Value examples: ['Apple Inc.', 'Microsoft Corporation', 'Alphabet Inc.'].),\n  (sbTickerType:varchar, possible values: stock, etf, mutualfund. Value examples: ['stock', 'stock', 'stock'].),\n  (sbTickerExchange:varchar, Value examples: ['NASDAQ', 'NASDAQ', 'NASDAQ'].),\n  (sbTickerCurrency:varchar, Value examples: ['USD', 'USD', 'USD'].),\n  (sbTickerDb2x:varchar, 2 letter exchange code. Value examples: ['NQ', 'NQ', 'NQ'].),\n  (sbTickerIsActive:boolean, Value examples: ['true', 'true', 'true'].),\n]\n# Table: sbDailyPrice\n[\n  (sbDpTickerId:varchar, Value examples: ['T001', 'T002'].),\n  (sbDpDate:date, Value examples: ['2023-04-01', '2023-04-01'].),\n  (sbDpOpen:numeric, Value examples: ['150.00', '280.00'].),\n  (sbDpHigh:numeric, Value examples: ['152.50', '282.75'].),\n  (sbDpLow:numeric, Value examples: ['148.75', '279.50'].),\n  (sbDpClose:numeric, Value examples: ['151.25', '281.00'].),\n  (sbDpVolume:bigint, Value examples: ['75000000', '35000000'].),\n  (sbDpEpochMs:bigint, epoch milliseconds for timestamp. Value examples: ['1680336000000', '1680336000000'].),\n  (sbDpSource:varchar, Value examples: ['NYSE', 'NASDAQ'].),\n]\n# Table: sbTransaction\n[\n  (sbTxId:varchar, Value examples: ['TX001', 'TX002', 'TX003'].),\n  (sbTxCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbTxTickerId:varchar, Value examples: ['T001', 'T002', 'T003'].),\n  (sbTxDateTime:timestamp, Value examples: ['2023-04-01 09:30:00', '2023-04-01 10:15:00', '2023-04-01 11:00:00'].),\n  (sbTxType:varchar, possible values: buy, sell. Value examples: ['buy', 'sell', 'buy'].),\n  (sbTxShares:numeric, Value examples: ['100', '50', '10'].),\n  (sbTxPrice:numeric, Value examples: ['150.00', '280.00', '3200.00'].),\n  (sbTxAmount:numeric, Value examples: ['15000.00', '14000.00', '32000.00'].),\n  (sbTxCcy:varchar, transaction currency. Value examples: ['USD', 'USD', 'USD'].),\n  (sbTxTax:numeric, Value examples: ['75.00', '70.00', '160.00'].),\n  (sbTxCommission:numeric, Value examples: ['10.00', '10.00', '20.00'].),\n  (sbTxKpx:varchar, internal code. Value examples: ['KP001', 'KP002', 'KP003'].),\n  (sbTxSettlementDateStr:varchar, settlement date as string in yyyyMMdd HH:mm:ss format. NULL if not settled. Value examples: ['20230401 09:30:00', '20230401 10:15:00', '20230401 11:00:00'].),\n  (sbTxStatus:varchar, possible values: success, fail, pending. Value examples: ['success', 'success', 'success'].),\n]\n\n【Foreign keys】\n\n【参考信息】\nMoMC = month-over-month change in average closing price Weekend days refer to Saturday and Sunday; adjust dates to weeks for aggregation. To find the most popular stocks in the past 10 days, join the transaction and ticker tables, filter for buy transactions in the last 10 days, group by ticker and count transactions. CR = customer rank by total transaction volume, where rank 1 belongs to the customer with the highest volume\n\n【用户问题】\nWhat are the 5 most frequently bought stock ticker symbols in the past 10 days? Return the ticker symbol and number of buy transactions.\n\n```sql",
        "role": "user"
      },
      {
        "content": "WITH popular_stocks AS (SELECT t.sbTickerSymbol, COUNT(*) AS tx_count FROM sbTransaction tx JOIN sbTicker t ON tx.sbTxTickerId = t.sbTickerId WHERE tx.sbTxType = 'buy' AND tx.sbTxDateTime >= CURRENT_DATE - INTERVAL '10 days' GROUP BY t.sbTickerSymbol) SELECT sbTickerSymbol, tx_count FROM popular_stocks ORDER BY tx_count DESC LIMIT 5",
        "role": "assistant"
      }
    ],
    "db_name": "broker",
    "id": 241,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nFor customers with at least 5 total transactions, what is their transaction success rate? Return the customer name and success rate, ordered from lowest to highest success rate.\n\n【数据库schema】\n【DB_ID】 broker\n【Schema】\n# Table: sbCustomer\n[\n  (sbCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbCustName:varchar, Value examples: ['john doe', 'Jane Smith', 'Bob Johnson'].),\n  (sbCustEmail:varchar, Value examples: ['john.doe@email.com', 'jane.smith@email.com', 'bob.johnson@email.com'].),\n  (sbCustPhone:varchar, Value examples: ['555-123-4567', '555-987-6543', '555-246-8135'].),\n  (sbCustAddress1:varchar, Value examples: ['123 Main St', '456 Oak Rd', '789 Pine Ave'].),\n  (sbCustAddress2:varchar,),\n  (sbCustCity:varchar, Value examples: ['Anytown', 'Someville', 'Mytown'].),\n  (sbCustState:varchar, Value examples: ['CA', 'NY', 'TX'].),\n  (sbCustCountry:varchar, Value examples: ['USA', 'USA', 'USA'].),\n  (sbCustPostalCode:varchar, Value examples: ['90001', '10002', '75000'].),\n  (sbCustJoinDate:date, Value examples: ['2020-01-01', '2019-03-15', '2022-06-01'].),\n  (sbCustStatus:varchar, possible values: active, inactive, suspended, closed. Value examples: ['active', 'active', 'inactive'].),\n]\n# Table: sbTicker\n[\n  (sbTickerId:varchar, Value examples: ['T001', 'T002', 'T005'].),\n  (sbTickerSymbol:varchar, Value examples: ['AAPL', 'MSFT', 'GOOGL'].),\n  (sbTickerName:varchar, Value examples: ['Apple Inc.', 'Microsoft Corporation', 'Alphabet Inc.'].),\n  (sbTickerType:varchar, possible values: stock, etf, mutualfund. Value examples: ['stock', 'stock', 'stock'].),\n  (sbTickerExchange:varchar, Value examples: ['NASDAQ', 'NASDAQ', 'NASDAQ'].),\n  (sbTickerCurrency:varchar, Value examples: ['USD', 'USD', 'USD'].),\n  (sbTickerDb2x:varchar, 2 letter exchange code. Value examples: ['NQ', 'NQ', 'NQ'].),\n  (sbTickerIsActive:boolean, Value examples: ['true', 'true', 'true'].),\n]\n# Table: sbDailyPrice\n[\n  (sbDpTickerId:varchar, Value examples: ['T001', 'T002'].),\n  (sbDpDate:date, Value examples: ['2023-04-01', '2023-04-01'].),\n  (sbDpOpen:numeric, Value examples: ['150.00', '280.00'].),\n  (sbDpHigh:numeric, Value examples: ['152.50', '282.75'].),\n  (sbDpLow:numeric, Value examples: ['148.75', '279.50'].),\n  (sbDpClose:numeric, Value examples: ['151.25', '281.00'].),\n  (sbDpVolume:bigint, Value examples: ['75000000', '35000000'].),\n  (sbDpEpochMs:bigint, epoch milliseconds for timestamp. Value examples: ['1680336000000', '1680336000000'].),\n  (sbDpSource:varchar, Value examples: ['NYSE', 'NASDAQ'].),\n]\n# Table: sbTransaction\n[\n  (sbTxId:varchar, Value examples: ['TX001', 'TX002', 'TX003'].),\n  (sbTxCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbTxTickerId:varchar, Value examples: ['T001', 'T002', 'T003'].),\n  (sbTxDateTime:timestamp, Value examples: ['2023-04-01 09:30:00', '2023-04-01 10:15:00', '2023-04-01 11:00:00'].),\n  (sbTxType:varchar, possible values: buy, sell. Value examples: ['buy', 'sell', 'buy'].),\n  (sbTxShares:numeric, Value examples: ['100', '50', '10'].),\n  (sbTxPrice:numeric, Value examples: ['150.00', '280.00', '3200.00'].),\n  (sbTxAmount:numeric, Value examples: ['15000.00', '14000.00', '32000.00'].),\n  (sbTxCcy:varchar, transaction currency. Value examples: ['USD', 'USD', 'USD'].),\n  (sbTxTax:numeric, Value examples: ['75.00', '70.00', '160.00'].),\n  (sbTxCommission:numeric, Value examples: ['10.00', '10.00', '20.00'].),\n  (sbTxKpx:varchar, internal code. Value examples: ['KP001', 'KP002', 'KP003'].),\n  (sbTxSettlementDateStr:varchar, settlement date as string in yyyyMMdd HH:mm:ss format. NULL if not settled. Value examples: ['20230401 09:30:00', '20230401 10:15:00', '20230401 11:00:00'].),\n  (sbTxStatus:varchar, possible values: success, fail, pending. Value examples: ['success', 'success', 'success'].),\n]\n\n【Foreign keys】\n\n【参考信息】\nCR = customer rank by total transaction amount, with different rankings based on transaction amounts MoMC = month-over-month change in average closing price based on previous month's averages for each ticker each month To get the success rate of transactions per customer, join customer and transaction tables, group by customer, and calculate the percentage of successful transactions. Always join transactions with customers before using the transactions table. TAC = Total Active Customers who joined after a certain date\n\n【用户问题】\nFor customers with at least 5 total transactions, what is their transaction success rate? Return the customer name and success rate, ordered from lowest to highest success rate.\n\n```sql",
        "role": "user"
      },
      {
        "content": "WITH cust_tx_stats AS (SELECT c.sbCustId, c.sbCustName, COUNT(t.sbTxId) AS total_tx, SUM(CASE WHEN t.sbTxStatus = 'success' THEN 1 ELSE 0 END) AS success_tx FROM sbCustomer c JOIN sbTransaction t ON c.sbCustId = t.sbTxCustId GROUP BY c.sbCustId, c.sbCustName) SELECT sbCustName, success_tx::float/total_tx AS success_rate FROM cust_tx_stats WHERE total_tx >= 5 ORDER BY success_rate",
        "role": "assistant"
      }
    ],
    "db_name": "broker",
    "id": 242,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich 3 distinct stocks had the highest price change between the low and high from April 1 2023 to April 4 2023? I want the different in the low and high throughout this timerange, not just the intraday price changes. Return the ticker symbol and price change.\n\n【数据库schema】\n【DB_ID】 broker\n【Schema】\n# Table: sbCustomer\n[\n  (sbCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbCustName:varchar, Value examples: ['john doe', 'Jane Smith', 'Bob Johnson'].),\n  (sbCustEmail:varchar, Value examples: ['john.doe@email.com', 'jane.smith@email.com', 'bob.johnson@email.com'].),\n  (sbCustPhone:varchar, Value examples: ['555-123-4567', '555-987-6543', '555-246-8135'].),\n  (sbCustAddress1:varchar, Value examples: ['123 Main St', '456 Oak Rd', '789 Pine Ave'].),\n  (sbCustAddress2:varchar,),\n  (sbCustCity:varchar, Value examples: ['Anytown', 'Someville', 'Mytown'].),\n  (sbCustState:varchar, Value examples: ['CA', 'NY', 'TX'].),\n  (sbCustCountry:varchar, Value examples: ['USA', 'USA', 'USA'].),\n  (sbCustPostalCode:varchar, Value examples: ['90001', '10002', '75000'].),\n  (sbCustJoinDate:date, Value examples: ['2020-01-01', '2019-03-15', '2022-06-01'].),\n  (sbCustStatus:varchar, possible values: active, inactive, suspended, closed. Value examples: ['active', 'active', 'inactive'].),\n]\n# Table: sbTicker\n[\n  (sbTickerId:varchar, Value examples: ['T001', 'T002', 'T005'].),\n  (sbTickerSymbol:varchar, Value examples: ['AAPL', 'MSFT', 'GOOGL'].),\n  (sbTickerName:varchar, Value examples: ['Apple Inc.', 'Microsoft Corporation', 'Alphabet Inc.'].),\n  (sbTickerType:varchar, possible values: stock, etf, mutualfund. Value examples: ['stock', 'stock', 'stock'].),\n  (sbTickerExchange:varchar, Value examples: ['NASDAQ', 'NASDAQ', 'NASDAQ'].),\n  (sbTickerCurrency:varchar, Value examples: ['USD', 'USD', 'USD'].),\n  (sbTickerDb2x:varchar, 2 letter exchange code. Value examples: ['NQ', 'NQ', 'NQ'].),\n  (sbTickerIsActive:boolean, Value examples: ['true', 'true', 'true'].),\n]\n# Table: sbDailyPrice\n[\n  (sbDpTickerId:varchar, Value examples: ['T001', 'T002'].),\n  (sbDpDate:date, Value examples: ['2023-04-01', '2023-04-01'].),\n  (sbDpOpen:numeric, Value examples: ['150.00', '280.00'].),\n  (sbDpHigh:numeric, Value examples: ['152.50', '282.75'].),\n  (sbDpLow:numeric, Value examples: ['148.75', '279.50'].),\n  (sbDpClose:numeric, Value examples: ['151.25', '281.00'].),\n  (sbDpVolume:bigint, Value examples: ['75000000', '35000000'].),\n  (sbDpEpochMs:bigint, epoch milliseconds for timestamp. Value examples: ['1680336000000', '1680336000000'].),\n  (sbDpSource:varchar, Value examples: ['NYSE', 'NASDAQ'].),\n]\n# Table: sbTransaction\n[\n  (sbTxId:varchar, Value examples: ['TX001', 'TX002', 'TX003'].),\n  (sbTxCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbTxTickerId:varchar, Value examples: ['T001', 'T002', 'T003'].),\n  (sbTxDateTime:timestamp, Value examples: ['2023-04-01 09:30:00', '2023-04-01 10:15:00', '2023-04-01 11:00:00'].),\n  (sbTxType:varchar, possible values: buy, sell. Value examples: ['buy', 'sell', 'buy'].),\n  (sbTxShares:numeric, Value examples: ['100', '50', '10'].),\n  (sbTxPrice:numeric, Value examples: ['150.00', '280.00', '3200.00'].),\n  (sbTxAmount:numeric, Value examples: ['15000.00', '14000.00', '32000.00'].),\n  (sbTxCcy:varchar, transaction currency. Value examples: ['USD', 'USD', 'USD'].),\n  (sbTxTax:numeric, Value examples: ['75.00', '70.00', '160.00'].),\n  (sbTxCommission:numeric, Value examples: ['10.00', '10.00', '20.00'].),\n  (sbTxKpx:varchar, internal code. Value examples: ['KP001', 'KP002', 'KP003'].),\n  (sbTxSettlementDateStr:varchar, settlement date as string in yyyyMMdd HH:mm:ss format. NULL if not settled. Value examples: ['20230401 09:30:00', '20230401 10:15:00', '20230401 11:00:00'].),\n  (sbTxStatus:varchar, possible values: success, fail, pending. Value examples: ['success', 'success', 'success'].),\n]\n\n【Foreign keys】\n\n【参考信息】\nPMCS = per month customer signups\nTAC = Total Active Customers who joined after a certain date\nPMAT = per month average transaction amount, using date truncation for aggregation.\nTo analyze stock performance, join the daily price and ticker tables, filter for a specific date range, and calculate price change.\nCR = customer rank by total transaction amount, with the highest transaction amount getting the top rank\n\n【用户问题】\nWhich 3 distinct stocks had the highest price change between the low and high from April 1 2023 to April 4 2023? I want the different in the low and high throughout this timerange, not just the intraday price changes. Return the ticker symbol and price change.\n\n```sql",
        "role": "user"
      },
      {
        "content": "WITH stock_stats AS (SELECT t.sbTickerSymbol, MIN(d.sbDpLow) AS min_price, MAX(d.sbDpHigh) AS max_price FROM sbDailyPrice d JOIN sbTicker t ON d.sbDpTickerId = t.sbTickerId WHERE d.sbDpDate BETWEEN '2023-04-01' AND '2023-04-04' GROUP BY t.sbTickerSymbol) SELECT sbTickerSymbol, max_price - min_price AS price_change FROM stock_stats ORDER BY price_change DESC LIMIT 3",
        "role": "assistant"
      }
    ],
    "db_name": "broker",
    "id": 243,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the ticker symbol, month, average closing price, highest price, lowest price, and MoMC for each ticker by month?\n\n【数据库schema】\n【DB_ID】 broker\n【Schema】\n# Table: sbCustomer\n[\n  (sbCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbCustName:varchar, Value examples: ['john doe', 'Jane Smith', 'Bob Johnson'].),\n  (sbCustEmail:varchar, Value examples: ['john.doe@email.com', 'jane.smith@email.com', 'bob.johnson@email.com'].),\n  (sbCustPhone:varchar, Value examples: ['555-123-4567', '555-987-6543', '555-246-8135'].),\n  (sbCustAddress1:varchar, Value examples: ['123 Main St', '456 Oak Rd', '789 Pine Ave'].),\n  (sbCustAddress2:varchar,),\n  (sbCustCity:varchar, Value examples: ['Anytown', 'Someville', 'Mytown'].),\n  (sbCustState:varchar, Value examples: ['CA', 'NY', 'TX'].),\n  (sbCustCountry:varchar, Value examples: ['USA', 'USA', 'USA'].),\n  (sbCustPostalCode:varchar, Value examples: ['90001', '10002', '75000'].),\n  (sbCustJoinDate:date, Value examples: ['2020-01-01', '2019-03-15', '2022-06-01'].),\n  (sbCustStatus:varchar, possible values: active, inactive, suspended, closed. Value examples: ['active', 'active', 'inactive'].),\n]\n# Table: sbTicker\n[\n  (sbTickerId:varchar, Value examples: ['T001', 'T002', 'T005'].),\n  (sbTickerSymbol:varchar, Value examples: ['AAPL', 'MSFT', 'GOOGL'].),\n  (sbTickerName:varchar, Value examples: ['Apple Inc.', 'Microsoft Corporation', 'Alphabet Inc.'].),\n  (sbTickerType:varchar, possible values: stock, etf, mutualfund. Value examples: ['stock', 'stock', 'stock'].),\n  (sbTickerExchange:varchar, Value examples: ['NASDAQ', 'NASDAQ', 'NASDAQ'].),\n  (sbTickerCurrency:varchar, Value examples: ['USD', 'USD', 'USD'].),\n  (sbTickerDb2x:varchar, 2 letter exchange code. Value examples: ['NQ', 'NQ', 'NQ'].),\n  (sbTickerIsActive:boolean, Value examples: ['true', 'true', 'true'].),\n]\n# Table: sbDailyPrice\n[\n  (sbDpTickerId:varchar, Value examples: ['T001', 'T002'].),\n  (sbDpDate:date, Value examples: ['2023-04-01', '2023-04-01'].),\n  (sbDpOpen:numeric, Value examples: ['150.00', '280.00'].),\n  (sbDpHigh:numeric, Value examples: ['152.50', '282.75'].),\n  (sbDpLow:numeric, Value examples: ['148.75', '279.50'].),\n  (sbDpClose:numeric, Value examples: ['151.25', '281.00'].),\n  (sbDpVolume:bigint, Value examples: ['75000000', '35000000'].),\n  (sbDpEpochMs:bigint, epoch milliseconds for timestamp. Value examples: ['1680336000000', '1680336000000'].),\n  (sbDpSource:varchar, Value examples: ['NYSE', 'NASDAQ'].),\n]\n# Table: sbTransaction\n[\n  (sbTxId:varchar, Value examples: ['TX001', 'TX002', 'TX003'].),\n  (sbTxCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbTxTickerId:varchar, Value examples: ['T001', 'T002', 'T003'].),\n  (sbTxDateTime:timestamp, Value examples: ['2023-04-01 09:30:00', '2023-04-01 10:15:00', '2023-04-01 11:00:00'].),\n  (sbTxType:varchar, possible values: buy, sell. Value examples: ['buy', 'sell', 'buy'].),\n  (sbTxShares:numeric, Value examples: ['100', '50', '10'].),\n  (sbTxPrice:numeric, Value examples: ['150.00', '280.00', '3200.00'].),\n  (sbTxAmount:numeric, Value examples: ['15000.00', '14000.00', '32000.00'].),\n  (sbTxCcy:varchar, transaction currency. Value examples: ['USD', 'USD', 'USD'].),\n  (sbTxTax:numeric, Value examples: ['75.00', '70.00', '160.00'].),\n  (sbTxCommission:numeric, Value examples: ['10.00', '10.00', '20.00'].),\n  (sbTxKpx:varchar, internal code. Value examples: ['KP001', 'KP002', 'KP003'].),\n  (sbTxSettlementDateStr:varchar, settlement date as string in yyyyMMdd HH:mm:ss format. NULL if not settled. Value examples: ['20230401 09:30:00', '20230401 10:15:00', '20230401 11:00:00'].),\n  (sbTxStatus:varchar, possible values: success, fail, pending. Value examples: ['success', 'success', 'success'].),\n]\n\n【Foreign keys】\n\n【参考信息】\nNPM (Net Profit Margin) = (Total Income from Sales - (Tax + Commission Expenses)) / Total Income from Sales * 100, for recent transactions. TAC = Total Active Customers who have recently joined ACP = Average Closing Price of tickers over a recent period MoMC = month-over-month change in average closing price = (avg_close_given_month - avg_close_previous_month) / avg_close_previous_month for each ticker each month\n\n【用户问题】\nWhat is the ticker symbol, month, average closing price, highest price, lowest price, and MoMC for each ticker by month?\n\n```sql",
        "role": "user"
      },
      {
        "content": "WITH monthly_price_stats AS (SELECT DATE_TRUNC('month', sbDpDate) AS MONTH, sbDpTickerId, AVG(sbDpClose) AS avg_close, MAX(sbDpHigh) AS max_high, MIN(sbDpLow) AS min_low FROM sbDailyPrice GROUP BY MONTH, sbDpTickerId) SELECT t.sbTickerSymbol, mps.month, mps.avg_close, mps.max_high, mps.min_low, (mps.avg_close - LAG(mps.avg_close) OVER (PARTITION BY mps.sbDpTickerId ORDER BY mps.month)) / LAG(mps.avg_close) OVER (PARTITION BY mps.sbDpTickerId ORDER BY mps.month) AS mom_change FROM monthly_price_stats mps JOIN sbTicker t ON mps.sbDpTickerId = t.sbTickerId;",
        "role": "assistant"
      }
    ],
    "db_name": "broker",
    "id": 244,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nReturn the customer name, number of transactions, total transaction amount, and CR for all customers\n\n【数据库schema】\n【DB_ID】 broker\n【Schema】\n# Table: sbCustomer\n[\n  (sbCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbCustName:varchar, Value examples: ['john doe', 'Jane Smith', 'Bob Johnson'].),\n  (sbCustEmail:varchar, Value examples: ['john.doe@email.com', 'jane.smith@email.com', 'bob.johnson@email.com'].),\n  (sbCustPhone:varchar, Value examples: ['555-123-4567', '555-987-6543', '555-246-8135'].),\n  (sbCustAddress1:varchar, Value examples: ['123 Main St', '456 Oak Rd', '789 Pine Ave'].),\n  (sbCustAddress2:varchar,),\n  (sbCustCity:varchar, Value examples: ['Anytown', 'Someville', 'Mytown'].),\n  (sbCustState:varchar, Value examples: ['CA', 'NY', 'TX'].),\n  (sbCustCountry:varchar, Value examples: ['USA', 'USA', 'USA'].),\n  (sbCustPostalCode:varchar, Value examples: ['90001', '10002', '75000'].),\n  (sbCustJoinDate:date, Value examples: ['2020-01-01', '2019-03-15', '2022-06-01'].),\n  (sbCustStatus:varchar, possible values: active, inactive, suspended, closed. Value examples: ['active', 'active', 'inactive'].),\n]\n# Table: sbTicker\n[\n  (sbTickerId:varchar, Value examples: ['T001', 'T002', 'T005'].),\n  (sbTickerSymbol:varchar, Value examples: ['AAPL', 'MSFT', 'GOOGL'].),\n  (sbTickerName:varchar, Value examples: ['Apple Inc.', 'Microsoft Corporation', 'Alphabet Inc.'].),\n  (sbTickerType:varchar, possible values: stock, etf, mutualfund. Value examples: ['stock', 'stock', 'stock'].),\n  (sbTickerExchange:varchar, Value examples: ['NASDAQ', 'NASDAQ', 'NASDAQ'].),\n  (sbTickerCurrency:varchar, Value examples: ['USD', 'USD', 'USD'].),\n  (sbTickerDb2x:varchar, 2 letter exchange code. Value examples: ['NQ', 'NQ', 'NQ'].),\n  (sbTickerIsActive:boolean, Value examples: ['true', 'true', 'true'].),\n]\n# Table: sbDailyPrice\n[\n  (sbDpTickerId:varchar, Value examples: ['T001', 'T002'].),\n  (sbDpDate:date, Value examples: ['2023-04-01', '2023-04-01'].),\n  (sbDpOpen:numeric, Value examples: ['150.00', '280.00'].),\n  (sbDpHigh:numeric, Value examples: ['152.50', '282.75'].),\n  (sbDpLow:numeric, Value examples: ['148.75', '279.50'].),\n  (sbDpClose:numeric, Value examples: ['151.25', '281.00'].),\n  (sbDpVolume:bigint, Value examples: ['75000000', '35000000'].),\n  (sbDpEpochMs:bigint, epoch milliseconds for timestamp. Value examples: ['1680336000000', '1680336000000'].),\n  (sbDpSource:varchar, Value examples: ['NYSE', 'NASDAQ'].),\n]\n# Table: sbTransaction\n[\n  (sbTxId:varchar, Value examples: ['TX001', 'TX002', 'TX003'].),\n  (sbTxCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbTxTickerId:varchar, Value examples: ['T001', 'T002', 'T003'].),\n  (sbTxDateTime:timestamp, Value examples: ['2023-04-01 09:30:00', '2023-04-01 10:15:00', '2023-04-01 11:00:00'].),\n  (sbTxType:varchar, possible values: buy, sell. Value examples: ['buy', 'sell', 'buy'].),\n  (sbTxShares:numeric, Value examples: ['100', '50', '10'].),\n  (sbTxPrice:numeric, Value examples: ['150.00', '280.00', '3200.00'].),\n  (sbTxAmount:numeric, Value examples: ['15000.00', '14000.00', '32000.00'].),\n  (sbTxCcy:varchar, transaction currency. Value examples: ['USD', 'USD', 'USD'].),\n  (sbTxTax:numeric, Value examples: ['75.00', '70.00', '160.00'].),\n  (sbTxCommission:numeric, Value examples: ['10.00', '10.00', '20.00'].),\n  (sbTxKpx:varchar, internal code. Value examples: ['KP001', 'KP002', 'KP003'].),\n  (sbTxSettlementDateStr:varchar, settlement date as string in yyyyMMdd HH:mm:ss format. NULL if not settled. Value examples: ['20230401 09:30:00', '20230401 10:15:00', '20230401 11:00:00'].),\n  (sbTxStatus:varchar, possible values: success, fail, pending. Value examples: ['success', 'success', 'success'].),\n]\n\n【Foreign keys】\n\n【参考信息】\nACP = Average Closing Price of tickers over a select period of days\nTAC = Total Active Customers who have recently joined\nNPM (Net Profit Margin) = Net income divided by net sales for a specific time frame, expressed as a percentage for transactions in a recent period.\nCR = customer rank by total transaction amount, with rank 1 being the customer with the highest total transaction amount\n\n【用户问题】\nReturn the customer name, number of transactions, total transaction amount, and CR for all customers\n\n```sql",
        "role": "user"
      },
      {
        "content": "WITH cust_tx_counts AS (SELECT sbTxCustId, COUNT(*) AS num_tx, SUM(sbTxAmount) AS total_amount FROM sbTransaction GROUP BY sbTxCustId) SELECT c.sbCustName, ct.num_tx, ct.total_amount, RANK() OVER (ORDER BY ct.total_amount DESC) AS cust_rank FROM cust_tx_counts ct JOIN sbCustomer c ON ct.sbTxCustId = c.sbCustId",
        "role": "assistant"
      }
    ],
    "db_name": "broker",
    "id": 245,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the PMCS and PMAT for customers who signed up in the last 6 months excluding the current month?\n\n【数据库schema】\n【DB_ID】 broker\n【Schema】\n# Table: sbCustomer\n[\n  (sbCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbCustName:varchar, Value examples: ['john doe', 'Jane Smith', 'Bob Johnson'].),\n  (sbCustEmail:varchar, Value examples: ['john.doe@email.com', 'jane.smith@email.com', 'bob.johnson@email.com'].),\n  (sbCustPhone:varchar, Value examples: ['555-123-4567', '555-987-6543', '555-246-8135'].),\n  (sbCustAddress1:varchar, Value examples: ['123 Main St', '456 Oak Rd', '789 Pine Ave'].),\n  (sbCustAddress2:varchar,),\n  (sbCustCity:varchar, Value examples: ['Anytown', 'Someville', 'Mytown'].),\n  (sbCustState:varchar, Value examples: ['CA', 'NY', 'TX'].),\n  (sbCustCountry:varchar, Value examples: ['USA', 'USA', 'USA'].),\n  (sbCustPostalCode:varchar, Value examples: ['90001', '10002', '75000'].),\n  (sbCustJoinDate:date, Value examples: ['2020-01-01', '2019-03-15', '2022-06-01'].),\n  (sbCustStatus:varchar, possible values: active, inactive, suspended, closed. Value examples: ['active', 'active', 'inactive'].),\n]\n# Table: sbTicker\n[\n  (sbTickerId:varchar, Value examples: ['T001', 'T002', 'T005'].),\n  (sbTickerSymbol:varchar, Value examples: ['AAPL', 'MSFT', 'GOOGL'].),\n  (sbTickerName:varchar, Value examples: ['Apple Inc.', 'Microsoft Corporation', 'Alphabet Inc.'].),\n  (sbTickerType:varchar, possible values: stock, etf, mutualfund. Value examples: ['stock', 'stock', 'stock'].),\n  (sbTickerExchange:varchar, Value examples: ['NASDAQ', 'NASDAQ', 'NASDAQ'].),\n  (sbTickerCurrency:varchar, Value examples: ['USD', 'USD', 'USD'].),\n  (sbTickerDb2x:varchar, 2 letter exchange code. Value examples: ['NQ', 'NQ', 'NQ'].),\n  (sbTickerIsActive:boolean, Value examples: ['true', 'true', 'true'].),\n]\n# Table: sbDailyPrice\n[\n  (sbDpTickerId:varchar, Value examples: ['T001', 'T002'].),\n  (sbDpDate:date, Value examples: ['2023-04-01', '2023-04-01'].),\n  (sbDpOpen:numeric, Value examples: ['150.00', '280.00'].),\n  (sbDpHigh:numeric, Value examples: ['152.50', '282.75'].),\n  (sbDpLow:numeric, Value examples: ['148.75', '279.50'].),\n  (sbDpClose:numeric, Value examples: ['151.25', '281.00'].),\n  (sbDpVolume:bigint, Value examples: ['75000000', '35000000'].),\n  (sbDpEpochMs:bigint, epoch milliseconds for timestamp. Value examples: ['1680336000000', '1680336000000'].),\n  (sbDpSource:varchar, Value examples: ['NYSE', 'NASDAQ'].),\n]\n# Table: sbTransaction\n[\n  (sbTxId:varchar, Value examples: ['TX001', 'TX002', 'TX003'].),\n  (sbTxCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbTxTickerId:varchar, Value examples: ['T001', 'T002', 'T003'].),\n  (sbTxDateTime:timestamp, Value examples: ['2023-04-01 09:30:00', '2023-04-01 10:15:00', '2023-04-01 11:00:00'].),\n  (sbTxType:varchar, possible values: buy, sell. Value examples: ['buy', 'sell', 'buy'].),\n  (sbTxShares:numeric, Value examples: ['100', '50', '10'].),\n  (sbTxPrice:numeric, Value examples: ['150.00', '280.00', '3200.00'].),\n  (sbTxAmount:numeric, Value examples: ['15000.00', '14000.00', '32000.00'].),\n  (sbTxCcy:varchar, transaction currency. Value examples: ['USD', 'USD', 'USD'].),\n  (sbTxTax:numeric, Value examples: ['75.00', '70.00', '160.00'].),\n  (sbTxCommission:numeric, Value examples: ['10.00', '10.00', '20.00'].),\n  (sbTxKpx:varchar, internal code. Value examples: ['KP001', 'KP002', 'KP003'].),\n  (sbTxSettlementDateStr:varchar, settlement date as string in yyyyMMdd HH:mm:ss format. NULL if not settled. Value examples: ['20230401 09:30:00', '20230401 10:15:00', '20230401 11:00:00'].),\n  (sbTxStatus:varchar, possible values: success, fail, pending. Value examples: ['success', 'success', 'success'].),\n]\n\n【Foreign keys】\n\n【参考信息】\nACP = Average Closing Price of tickers over a selected period, including the end day\nCR = customer rank by total transaction amount, where the top customer has the highest amount.\nPMCS = per month customer signups. PMAT = per month average transaction amount. Truncate date to month for aggregation.\nTAC = Total Active Customers who joined after a specified date\n\n【用户问题】\nWhat are the PMCS and PMAT for customers who signed up in the last 6 months excluding the current month?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT DATE_TRUNC('month', sbCustJoinDate) AS MONTH, COUNT(sbCustId) AS customer_signups, AVG(t.sbTxAmount) AS avg_tx_amount FROM sbCustomer c LEFT JOIN sbTransaction t ON c.sbCustId = t.sbTxCustId AND DATE_TRUNC('month', t.sbTxDateTime) = DATE_TRUNC('month', c.sbCustJoinDate) WHERE sbCustJoinDate >= DATE_TRUNC('month', CURRENT_DATE) - INTERVAL '6 months' AND sbCustJoinDate < DATE_TRUNC('month', CURRENT_DATE) GROUP BY MONTH",
        "role": "assistant"
      }
    ],
    "db_name": "broker",
    "id": 246,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many transactions were made by customers from the USA last week (exclusive of the current week)? Return the number of transactions and total transaction amount.\n\n【数据库schema】\n【DB_ID】 broker\n【Schema】\n# Table: sbCustomer\n[\n  (sbCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbCustName:varchar, Value examples: ['john doe', 'Jane Smith', 'Bob Johnson'].),\n  (sbCustEmail:varchar, Value examples: ['john.doe@email.com', 'jane.smith@email.com', 'bob.johnson@email.com'].),\n  (sbCustPhone:varchar, Value examples: ['555-123-4567', '555-987-6543', '555-246-8135'].),\n  (sbCustAddress1:varchar, Value examples: ['123 Main St', '456 Oak Rd', '789 Pine Ave'].),\n  (sbCustAddress2:varchar,),\n  (sbCustCity:varchar, Value examples: ['Anytown', 'Someville', 'Mytown'].),\n  (sbCustState:varchar, Value examples: ['CA', 'NY', 'TX'].),\n  (sbCustCountry:varchar, Value examples: ['USA', 'USA', 'USA'].),\n  (sbCustPostalCode:varchar, Value examples: ['90001', '10002', '75000'].),\n  (sbCustJoinDate:date, Value examples: ['2020-01-01', '2019-03-15', '2022-06-01'].),\n  (sbCustStatus:varchar, possible values: active, inactive, suspended, closed. Value examples: ['active', 'active', 'inactive'].),\n]\n# Table: sbTicker\n[\n  (sbTickerId:varchar, Value examples: ['T001', 'T002', 'T005'].),\n  (sbTickerSymbol:varchar, Value examples: ['AAPL', 'MSFT', 'GOOGL'].),\n  (sbTickerName:varchar, Value examples: ['Apple Inc.', 'Microsoft Corporation', 'Alphabet Inc.'].),\n  (sbTickerType:varchar, possible values: stock, etf, mutualfund. Value examples: ['stock', 'stock', 'stock'].),\n  (sbTickerExchange:varchar, Value examples: ['NASDAQ', 'NASDAQ', 'NASDAQ'].),\n  (sbTickerCurrency:varchar, Value examples: ['USD', 'USD', 'USD'].),\n  (sbTickerDb2x:varchar, 2 letter exchange code. Value examples: ['NQ', 'NQ', 'NQ'].),\n  (sbTickerIsActive:boolean, Value examples: ['true', 'true', 'true'].),\n]\n# Table: sbDailyPrice\n[\n  (sbDpTickerId:varchar, Value examples: ['T001', 'T002'].),\n  (sbDpDate:date, Value examples: ['2023-04-01', '2023-04-01'].),\n  (sbDpOpen:numeric, Value examples: ['150.00', '280.00'].),\n  (sbDpHigh:numeric, Value examples: ['152.50', '282.75'].),\n  (sbDpLow:numeric, Value examples: ['148.75', '279.50'].),\n  (sbDpClose:numeric, Value examples: ['151.25', '281.00'].),\n  (sbDpVolume:bigint, Value examples: ['75000000', '35000000'].),\n  (sbDpEpochMs:bigint, epoch milliseconds for timestamp. Value examples: ['1680336000000', '1680336000000'].),\n  (sbDpSource:varchar, Value examples: ['NYSE', 'NASDAQ'].),\n]\n# Table: sbTransaction\n[\n  (sbTxId:varchar, Value examples: ['TX001', 'TX002', 'TX003'].),\n  (sbTxCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbTxTickerId:varchar, Value examples: ['T001', 'T002', 'T003'].),\n  (sbTxDateTime:timestamp, Value examples: ['2023-04-01 09:30:00', '2023-04-01 10:15:00', '2023-04-01 11:00:00'].),\n  (sbTxType:varchar, possible values: buy, sell. Value examples: ['buy', 'sell', 'buy'].),\n  (sbTxShares:numeric, Value examples: ['100', '50', '10'].),\n  (sbTxPrice:numeric, Value examples: ['150.00', '280.00', '3200.00'].),\n  (sbTxAmount:numeric, Value examples: ['15000.00', '14000.00', '32000.00'].),\n  (sbTxCcy:varchar, transaction currency. Value examples: ['USD', 'USD', 'USD'].),\n  (sbTxTax:numeric, Value examples: ['75.00', '70.00', '160.00'].),\n  (sbTxCommission:numeric, Value examples: ['10.00', '10.00', '20.00'].),\n  (sbTxKpx:varchar, internal code. Value examples: ['KP001', 'KP002', 'KP003'].),\n  (sbTxSettlementDateStr:varchar, settlement date as string in yyyyMMdd HH:mm:ss format. NULL if not settled. Value examples: ['20230401 09:30:00', '20230401 10:15:00', '20230401 11:00:00'].),\n  (sbTxStatus:varchar, possible values: success, fail, pending. Value examples: ['success', 'success', 'success'].),\n]\n\n【Foreign keys】\n\n【参考信息】\nTo analyze stock performance, join the daily price and ticker tables and calculate price change To get the total transaction amount per customer, join the customer and transaction tables, group by customer, and sum the transaction amounts. Last week = DATE_TRUNC('week', CURRENT_DATE) - INTERVAL '1 week' to DATE_TRUNC('week', CURRENT_DATE) - INTERVAL '1 day'. Always join transactions with customers before using the transactions table. To get the success rate of transactions per customer, join customer and transaction tables, group by customer, and calculate the percentage of successful transactions\n\n【用户问题】\nHow many transactions were made by customers from the USA last week (exclusive of the current week)? Return the number of transactions and total transaction amount.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT COUNT(sbTxId) AS num_transactions, SUM(sbTxAmount) AS total_amount FROM sbTransaction t JOIN sbCustomer c ON t.sbTxCustId = c.sbCustId WHERE c.sbCustCountry = 'USA' AND t.sbTxDateTime BETWEEN DATE_TRUNC('week', CURRENT_DATE) - INTERVAL '1 week' AND DATE_TRUNC('week', CURRENT_DATE) - INTERVAL '1 millisecond'",
        "role": "assistant"
      }
    ],
    "db_name": "broker",
    "id": 247,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many transactions for stocks occurred in each of the last 8 weeks excluding the current week? How many of these transactions happened on weekends?\n\n【数据库schema】\n【DB_ID】 broker\n【Schema】\n# Table: sbCustomer\n[\n  (sbCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbCustName:varchar, Value examples: ['john doe', 'Jane Smith', 'Bob Johnson'].),\n  (sbCustEmail:varchar, Value examples: ['john.doe@email.com', 'jane.smith@email.com', 'bob.johnson@email.com'].),\n  (sbCustPhone:varchar, Value examples: ['555-123-4567', '555-987-6543', '555-246-8135'].),\n  (sbCustAddress1:varchar, Value examples: ['123 Main St', '456 Oak Rd', '789 Pine Ave'].),\n  (sbCustAddress2:varchar,),\n  (sbCustCity:varchar, Value examples: ['Anytown', 'Someville', 'Mytown'].),\n  (sbCustState:varchar, Value examples: ['CA', 'NY', 'TX'].),\n  (sbCustCountry:varchar, Value examples: ['USA', 'USA', 'USA'].),\n  (sbCustPostalCode:varchar, Value examples: ['90001', '10002', '75000'].),\n  (sbCustJoinDate:date, Value examples: ['2020-01-01', '2019-03-15', '2022-06-01'].),\n  (sbCustStatus:varchar, possible values: active, inactive, suspended, closed. Value examples: ['active', 'active', 'inactive'].),\n]\n# Table: sbTicker\n[\n  (sbTickerId:varchar, Value examples: ['T001', 'T002', 'T005'].),\n  (sbTickerSymbol:varchar, Value examples: ['AAPL', 'MSFT', 'GOOGL'].),\n  (sbTickerName:varchar, Value examples: ['Apple Inc.', 'Microsoft Corporation', 'Alphabet Inc.'].),\n  (sbTickerType:varchar, possible values: stock, etf, mutualfund. Value examples: ['stock', 'stock', 'stock'].),\n  (sbTickerExchange:varchar, Value examples: ['NASDAQ', 'NASDAQ', 'NASDAQ'].),\n  (sbTickerCurrency:varchar, Value examples: ['USD', 'USD', 'USD'].),\n  (sbTickerDb2x:varchar, 2 letter exchange code. Value examples: ['NQ', 'NQ', 'NQ'].),\n  (sbTickerIsActive:boolean, Value examples: ['true', 'true', 'true'].),\n]\n# Table: sbDailyPrice\n[\n  (sbDpTickerId:varchar, Value examples: ['T001', 'T002'].),\n  (sbDpDate:date, Value examples: ['2023-04-01', '2023-04-01'].),\n  (sbDpOpen:numeric, Value examples: ['150.00', '280.00'].),\n  (sbDpHigh:numeric, Value examples: ['152.50', '282.75'].),\n  (sbDpLow:numeric, Value examples: ['148.75', '279.50'].),\n  (sbDpClose:numeric, Value examples: ['151.25', '281.00'].),\n  (sbDpVolume:bigint, Value examples: ['75000000', '35000000'].),\n  (sbDpEpochMs:bigint, epoch milliseconds for timestamp. Value examples: ['1680336000000', '1680336000000'].),\n  (sbDpSource:varchar, Value examples: ['NYSE', 'NASDAQ'].),\n]\n# Table: sbTransaction\n[\n  (sbTxId:varchar, Value examples: ['TX001', 'TX002', 'TX003'].),\n  (sbTxCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbTxTickerId:varchar, Value examples: ['T001', 'T002', 'T003'].),\n  (sbTxDateTime:timestamp, Value examples: ['2023-04-01 09:30:00', '2023-04-01 10:15:00', '2023-04-01 11:00:00'].),\n  (sbTxType:varchar, possible values: buy, sell. Value examples: ['buy', 'sell', 'buy'].),\n  (sbTxShares:numeric, Value examples: ['100', '50', '10'].),\n  (sbTxPrice:numeric, Value examples: ['150.00', '280.00', '3200.00'].),\n  (sbTxAmount:numeric, Value examples: ['15000.00', '14000.00', '32000.00'].),\n  (sbTxCcy:varchar, transaction currency. Value examples: ['USD', 'USD', 'USD'].),\n  (sbTxTax:numeric, Value examples: ['75.00', '70.00', '160.00'].),\n  (sbTxCommission:numeric, Value examples: ['10.00', '10.00', '20.00'].),\n  (sbTxKpx:varchar, internal code. Value examples: ['KP001', 'KP002', 'KP003'].),\n  (sbTxSettlementDateStr:varchar, settlement date as string in yyyyMMdd HH:mm:ss format. NULL if not settled. Value examples: ['20230401 09:30:00', '20230401 10:15:00', '20230401 11:00:00'].),\n  (sbTxStatus:varchar, possible values: success, fail, pending. Value examples: ['success', 'success', 'success'].),\n]\n\n【Foreign keys】\n\n【参考信息】\nFor an analysis of stock performance, link daily price data with ticker information, select a relevant time period, and calculate the change in price\nTo determine the success rate of transactions for each customer, merge customer and transaction records, group by customer ID, and compute the ratio of successful transactions.\nWeekend days are Saturday and Sunday. Truncate date to week for aggregation.\nTo get the total amount of transactions per customer, perform a join between customer and transaction datasets, then group by customer ID and sum up the transaction amounts\n\n【用户问题】\nHow many transactions for stocks occurred in each of the last 8 weeks excluding the current week? How many of these transactions happened on weekends?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT DATE_TRUNC('week', t.sbTxDateTime) AS WEEK, COUNT(t.sbTxId) AS num_transactions, COUNT(CASE WHEN EXTRACT(dow FROM t.sbTxDateTime) IN (0, 6) THEN 1 END) AS weekend_transactions FROM sbTransaction t JOIN sbTicker tk ON t.sbTxTickerId = tk.sbTickerId WHERE tk.sbTickerType = 'stock' AND t.sbTxDateTime >= DATE_TRUNC('week', CURRENT_DATE) - INTERVAL '8 weeks' AND t.sbTxDateTime < DATE_TRUNC('week', CURRENT_DATE) GROUP BY WEEK",
        "role": "assistant"
      }
    ],
    "db_name": "broker",
    "id": 248,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich customer made the highest number of transactions in the same month as they signed up? Return the customer's id, name and number of transactions.\n\n【数据库schema】\n【DB_ID】 broker\n【Schema】\n# Table: sbCustomer\n[\n  (sbCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbCustName:varchar, Value examples: ['john doe', 'Jane Smith', 'Bob Johnson'].),\n  (sbCustEmail:varchar, Value examples: ['john.doe@email.com', 'jane.smith@email.com', 'bob.johnson@email.com'].),\n  (sbCustPhone:varchar, Value examples: ['555-123-4567', '555-987-6543', '555-246-8135'].),\n  (sbCustAddress1:varchar, Value examples: ['123 Main St', '456 Oak Rd', '789 Pine Ave'].),\n  (sbCustAddress2:varchar,),\n  (sbCustCity:varchar, Value examples: ['Anytown', 'Someville', 'Mytown'].),\n  (sbCustState:varchar, Value examples: ['CA', 'NY', 'TX'].),\n  (sbCustCountry:varchar, Value examples: ['USA', 'USA', 'USA'].),\n  (sbCustPostalCode:varchar, Value examples: ['90001', '10002', '75000'].),\n  (sbCustJoinDate:date, Value examples: ['2020-01-01', '2019-03-15', '2022-06-01'].),\n  (sbCustStatus:varchar, possible values: active, inactive, suspended, closed. Value examples: ['active', 'active', 'inactive'].),\n]\n# Table: sbTicker\n[\n  (sbTickerId:varchar, Value examples: ['T001', 'T002', 'T005'].),\n  (sbTickerSymbol:varchar, Value examples: ['AAPL', 'MSFT', 'GOOGL'].),\n  (sbTickerName:varchar, Value examples: ['Apple Inc.', 'Microsoft Corporation', 'Alphabet Inc.'].),\n  (sbTickerType:varchar, possible values: stock, etf, mutualfund. Value examples: ['stock', 'stock', 'stock'].),\n  (sbTickerExchange:varchar, Value examples: ['NASDAQ', 'NASDAQ', 'NASDAQ'].),\n  (sbTickerCurrency:varchar, Value examples: ['USD', 'USD', 'USD'].),\n  (sbTickerDb2x:varchar, 2 letter exchange code. Value examples: ['NQ', 'NQ', 'NQ'].),\n  (sbTickerIsActive:boolean, Value examples: ['true', 'true', 'true'].),\n]\n# Table: sbDailyPrice\n[\n  (sbDpTickerId:varchar, Value examples: ['T001', 'T002'].),\n  (sbDpDate:date, Value examples: ['2023-04-01', '2023-04-01'].),\n  (sbDpOpen:numeric, Value examples: ['150.00', '280.00'].),\n  (sbDpHigh:numeric, Value examples: ['152.50', '282.75'].),\n  (sbDpLow:numeric, Value examples: ['148.75', '279.50'].),\n  (sbDpClose:numeric, Value examples: ['151.25', '281.00'].),\n  (sbDpVolume:bigint, Value examples: ['75000000', '35000000'].),\n  (sbDpEpochMs:bigint, epoch milliseconds for timestamp. Value examples: ['1680336000000', '1680336000000'].),\n  (sbDpSource:varchar, Value examples: ['NYSE', 'NASDAQ'].),\n]\n# Table: sbTransaction\n[\n  (sbTxId:varchar, Value examples: ['TX001', 'TX002', 'TX003'].),\n  (sbTxCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbTxTickerId:varchar, Value examples: ['T001', 'T002', 'T003'].),\n  (sbTxDateTime:timestamp, Value examples: ['2023-04-01 09:30:00', '2023-04-01 10:15:00', '2023-04-01 11:00:00'].),\n  (sbTxType:varchar, possible values: buy, sell. Value examples: ['buy', 'sell', 'buy'].),\n  (sbTxShares:numeric, Value examples: ['100', '50', '10'].),\n  (sbTxPrice:numeric, Value examples: ['150.00', '280.00', '3200.00'].),\n  (sbTxAmount:numeric, Value examples: ['15000.00', '14000.00', '32000.00'].),\n  (sbTxCcy:varchar, transaction currency. Value examples: ['USD', 'USD', 'USD'].),\n  (sbTxTax:numeric, Value examples: ['75.00', '70.00', '160.00'].),\n  (sbTxCommission:numeric, Value examples: ['10.00', '10.00', '20.00'].),\n  (sbTxKpx:varchar, internal code. Value examples: ['KP001', 'KP002', 'KP003'].),\n  (sbTxSettlementDateStr:varchar, settlement date as string in yyyyMMdd HH:mm:ss format. NULL if not settled. Value examples: ['20230401 09:30:00', '20230401 10:15:00', '20230401 11:00:00'].),\n  (sbTxStatus:varchar, possible values: success, fail, pending. Value examples: ['success', 'success', 'success'].),\n]\n\n【Foreign keys】\n\n【参考信息】\nTo analyze the performance of stocks, join the tables for daily prices and tickers, filter for a designated time frame, and calculate the change in price To get the total transaction amount by each customer, you should join the customer and transaction tables, group by the customer, and sum up the amounts of the transactions If transactions from 2 different tables from the same interval are to be joined, join on the respective truncated date fields eg `FROM t1 JOIN t2 ON DATE_TRUNC('<interval>', t1.date)=DATE_TRUNC('<interval>', t2.date). To identify the most popular stocks within a recent period, join the transaction table with the ticker table, filter for buy transactions during the last several days, group by the ticker symbol, and count the number of transactions.\n\n【用户问题】\nWhich customer made the highest number of transactions in the same month as they signed up? Return the customer's id, name and number of transactions.\n\n```sql",
        "role": "user"
      },
      {
        "content": "WITH active_customers AS (SELECT c.sbCustId, COUNT(t.sbTxId) AS num_transactions FROM sbCustomer c JOIN sbTransaction t ON c.sbCustId = t.sbTxCustId AND DATE_TRUNC('month', c.sbCustJoinDate) = DATE_TRUNC('month', t.sbTxDateTime) GROUP BY c.sbCustId) SELECT ac.sbCustId, c.sbCustName, ac.num_transactions FROM active_customers ac JOIN sbCustomer c ON ac.sbCustId = c.sbCustId ORDER BY ac.num_transactions DESC LIMIT 1",
        "role": "assistant"
      }
    ],
    "db_name": "broker",
    "id": 249,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many distinct customers with a .com email address bought stocks of FAANG companies (Amazon, Apple, Google, Meta or Netflix)?\n\n【数据库schema】\n【DB_ID】 broker\n【Schema】\n# Table: sbCustomer\n[\n  (sbCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbCustName:varchar, Value examples: ['john doe', 'Jane Smith', 'Bob Johnson'].),\n  (sbCustEmail:varchar, Value examples: ['john.doe@email.com', 'jane.smith@email.com', 'bob.johnson@email.com'].),\n  (sbCustPhone:varchar, Value examples: ['555-123-4567', '555-987-6543', '555-246-8135'].),\n  (sbCustAddress1:varchar, Value examples: ['123 Main St', '456 Oak Rd', '789 Pine Ave'].),\n  (sbCustAddress2:varchar,),\n  (sbCustCity:varchar, Value examples: ['Anytown', 'Someville', 'Mytown'].),\n  (sbCustState:varchar, Value examples: ['CA', 'NY', 'TX'].),\n  (sbCustCountry:varchar, Value examples: ['USA', 'USA', 'USA'].),\n  (sbCustPostalCode:varchar, Value examples: ['90001', '10002', '75000'].),\n  (sbCustJoinDate:date, Value examples: ['2020-01-01', '2019-03-15', '2022-06-01'].),\n  (sbCustStatus:varchar, possible values: active, inactive, suspended, closed. Value examples: ['active', 'active', 'inactive'].),\n]\n# Table: sbTicker\n[\n  (sbTickerId:varchar, Value examples: ['T001', 'T002', 'T005'].),\n  (sbTickerSymbol:varchar, Value examples: ['AAPL', 'MSFT', 'GOOGL'].),\n  (sbTickerName:varchar, Value examples: ['Apple Inc.', 'Microsoft Corporation', 'Alphabet Inc.'].),\n  (sbTickerType:varchar, possible values: stock, etf, mutualfund. Value examples: ['stock', 'stock', 'stock'].),\n  (sbTickerExchange:varchar, Value examples: ['NASDAQ', 'NASDAQ', 'NASDAQ'].),\n  (sbTickerCurrency:varchar, Value examples: ['USD', 'USD', 'USD'].),\n  (sbTickerDb2x:varchar, 2 letter exchange code. Value examples: ['NQ', 'NQ', 'NQ'].),\n  (sbTickerIsActive:boolean, Value examples: ['true', 'true', 'true'].),\n]\n# Table: sbDailyPrice\n[\n  (sbDpTickerId:varchar, Value examples: ['T001', 'T002'].),\n  (sbDpDate:date, Value examples: ['2023-04-01', '2023-04-01'].),\n  (sbDpOpen:numeric, Value examples: ['150.00', '280.00'].),\n  (sbDpHigh:numeric, Value examples: ['152.50', '282.75'].),\n  (sbDpLow:numeric, Value examples: ['148.75', '279.50'].),\n  (sbDpClose:numeric, Value examples: ['151.25', '281.00'].),\n  (sbDpVolume:bigint, Value examples: ['75000000', '35000000'].),\n  (sbDpEpochMs:bigint, epoch milliseconds for timestamp. Value examples: ['1680336000000', '1680336000000'].),\n  (sbDpSource:varchar, Value examples: ['NYSE', 'NASDAQ'].),\n]\n# Table: sbTransaction\n[\n  (sbTxId:varchar, Value examples: ['TX001', 'TX002', 'TX003'].),\n  (sbTxCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbTxTickerId:varchar, Value examples: ['T001', 'T002', 'T003'].),\n  (sbTxDateTime:timestamp, Value examples: ['2023-04-01 09:30:00', '2023-04-01 10:15:00', '2023-04-01 11:00:00'].),\n  (sbTxType:varchar, possible values: buy, sell. Value examples: ['buy', 'sell', 'buy'].),\n  (sbTxShares:numeric, Value examples: ['100', '50', '10'].),\n  (sbTxPrice:numeric, Value examples: ['150.00', '280.00', '3200.00'].),\n  (sbTxAmount:numeric, Value examples: ['15000.00', '14000.00', '32000.00'].),\n  (sbTxCcy:varchar, transaction currency. Value examples: ['USD', 'USD', 'USD'].),\n  (sbTxTax:numeric, Value examples: ['75.00', '70.00', '160.00'].),\n  (sbTxCommission:numeric, Value examples: ['10.00', '10.00', '20.00'].),\n  (sbTxKpx:varchar, internal code. Value examples: ['KP001', 'KP002', 'KP003'].),\n  (sbTxSettlementDateStr:varchar, settlement date as string in yyyyMMdd HH:mm:ss format. NULL if not settled. Value examples: ['20230401 09:30:00', '20230401 10:15:00', '20230401 11:00:00'].),\n  (sbTxStatus:varchar, possible values: success, fail, pending. Value examples: ['success', 'success', 'success'].),\n]\n\n【Foreign keys】\n\n【参考信息】\nMoMC = month-over-month change in average closing price = (average closing price of given month - average closing price of previous month) / average closing price of previous month for each ticker. ACP = Average Closing Price of tickers within a defined time frame TAC = Total Active Customers who have joined since a specific starting date Customers with a '.com' email address who bought FAANG stocks (ticker symbol contains 'AMZN', 'AAPL', 'GOOGL', 'META' or 'NFLX')\n\n【用户问题】\nHow many distinct customers with a .com email address bought stocks of FAANG companies (Amazon, Apple, Google, Meta or Netflix)?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT COUNT(DISTINCT t.sbTxCustId) FROM sbTransaction t JOIN sbCustomer c ON t.sbTxCustId = c.sbCustId JOIN sbTicker tk ON t.sbTxTickerId = tk.sbTickerId WHERE c.sbCustEmail LIKE '%.com' AND tk.sbTickerSymbol ~ '(AMZN|AAPL|GOOGL|META|NFLX)'",
        "role": "assistant"
      }
    ],
    "db_name": "broker",
    "id": 250,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the number of customers whose name starts with J or ends with 'ez', and who live in a state ending with the letter 'a'?\n\n【数据库schema】\n【DB_ID】 broker\n【Schema】\n# Table: sbCustomer\n[\n  (sbCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbCustName:varchar, Value examples: ['john doe', 'Jane Smith', 'Bob Johnson'].),\n  (sbCustEmail:varchar, Value examples: ['john.doe@email.com', 'jane.smith@email.com', 'bob.johnson@email.com'].),\n  (sbCustPhone:varchar, Value examples: ['555-123-4567', '555-987-6543', '555-246-8135'].),\n  (sbCustAddress1:varchar, Value examples: ['123 Main St', '456 Oak Rd', '789 Pine Ave'].),\n  (sbCustAddress2:varchar,),\n  (sbCustCity:varchar, Value examples: ['Anytown', 'Someville', 'Mytown'].),\n  (sbCustState:varchar, Value examples: ['CA', 'NY', 'TX'].),\n  (sbCustCountry:varchar, Value examples: ['USA', 'USA', 'USA'].),\n  (sbCustPostalCode:varchar, Value examples: ['90001', '10002', '75000'].),\n  (sbCustJoinDate:date, Value examples: ['2020-01-01', '2019-03-15', '2022-06-01'].),\n  (sbCustStatus:varchar, possible values: active, inactive, suspended, closed. Value examples: ['active', 'active', 'inactive'].),\n]\n# Table: sbTicker\n[\n  (sbTickerId:varchar, Value examples: ['T001', 'T002', 'T005'].),\n  (sbTickerSymbol:varchar, Value examples: ['AAPL', 'MSFT', 'GOOGL'].),\n  (sbTickerName:varchar, Value examples: ['Apple Inc.', 'Microsoft Corporation', 'Alphabet Inc.'].),\n  (sbTickerType:varchar, possible values: stock, etf, mutualfund. Value examples: ['stock', 'stock', 'stock'].),\n  (sbTickerExchange:varchar, Value examples: ['NASDAQ', 'NASDAQ', 'NASDAQ'].),\n  (sbTickerCurrency:varchar, Value examples: ['USD', 'USD', 'USD'].),\n  (sbTickerDb2x:varchar, 2 letter exchange code. Value examples: ['NQ', 'NQ', 'NQ'].),\n  (sbTickerIsActive:boolean, Value examples: ['true', 'true', 'true'].),\n]\n# Table: sbDailyPrice\n[\n  (sbDpTickerId:varchar, Value examples: ['T001', 'T002'].),\n  (sbDpDate:date, Value examples: ['2023-04-01', '2023-04-01'].),\n  (sbDpOpen:numeric, Value examples: ['150.00', '280.00'].),\n  (sbDpHigh:numeric, Value examples: ['152.50', '282.75'].),\n  (sbDpLow:numeric, Value examples: ['148.75', '279.50'].),\n  (sbDpClose:numeric, Value examples: ['151.25', '281.00'].),\n  (sbDpVolume:bigint, Value examples: ['75000000', '35000000'].),\n  (sbDpEpochMs:bigint, epoch milliseconds for timestamp. Value examples: ['1680336000000', '1680336000000'].),\n  (sbDpSource:varchar, Value examples: ['NYSE', 'NASDAQ'].),\n]\n# Table: sbTransaction\n[\n  (sbTxId:varchar, Value examples: ['TX001', 'TX002', 'TX003'].),\n  (sbTxCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbTxTickerId:varchar, Value examples: ['T001', 'T002', 'T003'].),\n  (sbTxDateTime:timestamp, Value examples: ['2023-04-01 09:30:00', '2023-04-01 10:15:00', '2023-04-01 11:00:00'].),\n  (sbTxType:varchar, possible values: buy, sell. Value examples: ['buy', 'sell', 'buy'].),\n  (sbTxShares:numeric, Value examples: ['100', '50', '10'].),\n  (sbTxPrice:numeric, Value examples: ['150.00', '280.00', '3200.00'].),\n  (sbTxAmount:numeric, Value examples: ['15000.00', '14000.00', '32000.00'].),\n  (sbTxCcy:varchar, transaction currency. Value examples: ['USD', 'USD', 'USD'].),\n  (sbTxTax:numeric, Value examples: ['75.00', '70.00', '160.00'].),\n  (sbTxCommission:numeric, Value examples: ['10.00', '10.00', '20.00'].),\n  (sbTxKpx:varchar, internal code. Value examples: ['KP001', 'KP002', 'KP003'].),\n  (sbTxSettlementDateStr:varchar, settlement date as string in yyyyMMdd HH:mm:ss format. NULL if not settled. Value examples: ['20230401 09:30:00', '20230401 10:15:00', '20230401 11:00:00'].),\n  (sbTxStatus:varchar, possible values: success, fail, pending. Value examples: ['success', 'success', 'success'].),\n]\n\n【Foreign keys】\n\n【参考信息】\nTo get the total transaction amount per customer, join the customer and transaction tables, group by customer, and sum the transaction amounts To find the most popular stocks over a recent period, join the transaction and ticker tables, filter for buy transactions within that period, group by ticker, and count transactions. To analyze stock performance, join the daily price and ticker tables, filter for a specific date range, and calculate price change all customer attributes should be matched case insensitively\n\n【用户问题】\nWhat is the number of customers whose name starts with J or ends with 'ez', and who live in a state ending with the letter 'a'?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT COUNT(sbCustId) FROM sbCustomer WHERE (LOWER(sbCustName) LIKE 'j%' OR LOWER(sbCustName) LIKE '%ez') AND LOWER(sbCustState) LIKE '%a'",
        "role": "assistant"
      }
    ],
    "db_name": "broker",
    "id": 251,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many TAC are there from each country, for customers who joined on or after January 1, 2023? Return the country and the count.\n\n【数据库schema】\n【DB_ID】 broker\n【Schema】\n# Table: sbCustomer\n[\n  (sbCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbCustName:varchar, Value examples: ['john doe', 'Jane Smith', 'Bob Johnson'].),\n  (sbCustEmail:varchar, Value examples: ['john.doe@email.com', 'jane.smith@email.com', 'bob.johnson@email.com'].),\n  (sbCustPhone:varchar, Value examples: ['555-123-4567', '555-987-6543', '555-246-8135'].),\n  (sbCustAddress1:varchar, Value examples: ['123 Main St', '456 Oak Rd', '789 Pine Ave'].),\n  (sbCustAddress2:varchar,),\n  (sbCustCity:varchar, Value examples: ['Anytown', 'Someville', 'Mytown'].),\n  (sbCustState:varchar, Value examples: ['CA', 'NY', 'TX'].),\n  (sbCustCountry:varchar, Value examples: ['USA', 'USA', 'USA'].),\n  (sbCustPostalCode:varchar, Value examples: ['90001', '10002', '75000'].),\n  (sbCustJoinDate:date, Value examples: ['2020-01-01', '2019-03-15', '2022-06-01'].),\n  (sbCustStatus:varchar, possible values: active, inactive, suspended, closed. Value examples: ['active', 'active', 'inactive'].),\n]\n# Table: sbTicker\n[\n  (sbTickerId:varchar, Value examples: ['T001', 'T002', 'T005'].),\n  (sbTickerSymbol:varchar, Value examples: ['AAPL', 'MSFT', 'GOOGL'].),\n  (sbTickerName:varchar, Value examples: ['Apple Inc.', 'Microsoft Corporation', 'Alphabet Inc.'].),\n  (sbTickerType:varchar, possible values: stock, etf, mutualfund. Value examples: ['stock', 'stock', 'stock'].),\n  (sbTickerExchange:varchar, Value examples: ['NASDAQ', 'NASDAQ', 'NASDAQ'].),\n  (sbTickerCurrency:varchar, Value examples: ['USD', 'USD', 'USD'].),\n  (sbTickerDb2x:varchar, 2 letter exchange code. Value examples: ['NQ', 'NQ', 'NQ'].),\n  (sbTickerIsActive:boolean, Value examples: ['true', 'true', 'true'].),\n]\n# Table: sbDailyPrice\n[\n  (sbDpTickerId:varchar, Value examples: ['T001', 'T002'].),\n  (sbDpDate:date, Value examples: ['2023-04-01', '2023-04-01'].),\n  (sbDpOpen:numeric, Value examples: ['150.00', '280.00'].),\n  (sbDpHigh:numeric, Value examples: ['152.50', '282.75'].),\n  (sbDpLow:numeric, Value examples: ['148.75', '279.50'].),\n  (sbDpClose:numeric, Value examples: ['151.25', '281.00'].),\n  (sbDpVolume:bigint, Value examples: ['75000000', '35000000'].),\n  (sbDpEpochMs:bigint, epoch milliseconds for timestamp. Value examples: ['1680336000000', '1680336000000'].),\n  (sbDpSource:varchar, Value examples: ['NYSE', 'NASDAQ'].),\n]\n# Table: sbTransaction\n[\n  (sbTxId:varchar, Value examples: ['TX001', 'TX002', 'TX003'].),\n  (sbTxCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbTxTickerId:varchar, Value examples: ['T001', 'T002', 'T003'].),\n  (sbTxDateTime:timestamp, Value examples: ['2023-04-01 09:30:00', '2023-04-01 10:15:00', '2023-04-01 11:00:00'].),\n  (sbTxType:varchar, possible values: buy, sell. Value examples: ['buy', 'sell', 'buy'].),\n  (sbTxShares:numeric, Value examples: ['100', '50', '10'].),\n  (sbTxPrice:numeric, Value examples: ['150.00', '280.00', '3200.00'].),\n  (sbTxAmount:numeric, Value examples: ['15000.00', '14000.00', '32000.00'].),\n  (sbTxCcy:varchar, transaction currency. Value examples: ['USD', 'USD', 'USD'].),\n  (sbTxTax:numeric, Value examples: ['75.00', '70.00', '160.00'].),\n  (sbTxCommission:numeric, Value examples: ['10.00', '10.00', '20.00'].),\n  (sbTxKpx:varchar, internal code. Value examples: ['KP001', 'KP002', 'KP003'].),\n  (sbTxSettlementDateStr:varchar, settlement date as string in yyyyMMdd HH:mm:ss format. NULL if not settled. Value examples: ['20230401 09:30:00', '20230401 10:15:00', '20230401 11:00:00'].),\n  (sbTxStatus:varchar, possible values: success, fail, pending. Value examples: ['success', 'success', 'success'].),\n]\n\n【Foreign keys】\n\n【参考信息】\nTo analyze stock performance, join the daily price and stock symbol tables, filter for a designated date range, and compute the variation in price\nTo calculate the success rate of transactions for each customer, merge the customer and transaction records, aggregate by customer, and assess the rate of successful transactions\nTAC = Total Active Customers who joined on or after January 1, 2023\nTo ascertain the most sought-after stocks within a recent timeframe, combine the transaction and stock symbol datasets, focus on purchase actions during the specified period, group by stock symbol, and tally the transactions.\n\n【用户问题】\nHow many TAC are there from each country, for customers who joined on or after January 1, 2023? Return the country and the count.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT sbCustCountry, COUNT(sbCustId) AS TAC FROM sbCustomer WHERE sbCustJoinDate >= '2023-01-01' GROUP BY sbCustCountry",
        "role": "assistant"
      }
    ],
    "db_name": "broker",
    "id": 252,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the ACP for each ticker type in the past 7 days, inclusive of today? Return the ticker type and the average closing price.\n\n【数据库schema】\n【DB_ID】 broker\n【Schema】\n# Table: sbCustomer\n[\n  (sbCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbCustName:varchar, Value examples: ['john doe', 'Jane Smith', 'Bob Johnson'].),\n  (sbCustEmail:varchar, Value examples: ['john.doe@email.com', 'jane.smith@email.com', 'bob.johnson@email.com'].),\n  (sbCustPhone:varchar, Value examples: ['555-123-4567', '555-987-6543', '555-246-8135'].),\n  (sbCustAddress1:varchar, Value examples: ['123 Main St', '456 Oak Rd', '789 Pine Ave'].),\n  (sbCustAddress2:varchar,),\n  (sbCustCity:varchar, Value examples: ['Anytown', 'Someville', 'Mytown'].),\n  (sbCustState:varchar, Value examples: ['CA', 'NY', 'TX'].),\n  (sbCustCountry:varchar, Value examples: ['USA', 'USA', 'USA'].),\n  (sbCustPostalCode:varchar, Value examples: ['90001', '10002', '75000'].),\n  (sbCustJoinDate:date, Value examples: ['2020-01-01', '2019-03-15', '2022-06-01'].),\n  (sbCustStatus:varchar, possible values: active, inactive, suspended, closed. Value examples: ['active', 'active', 'inactive'].),\n]\n# Table: sbTicker\n[\n  (sbTickerId:varchar, Value examples: ['T001', 'T002', 'T005'].),\n  (sbTickerSymbol:varchar, Value examples: ['AAPL', 'MSFT', 'GOOGL'].),\n  (sbTickerName:varchar, Value examples: ['Apple Inc.', 'Microsoft Corporation', 'Alphabet Inc.'].),\n  (sbTickerType:varchar, possible values: stock, etf, mutualfund. Value examples: ['stock', 'stock', 'stock'].),\n  (sbTickerExchange:varchar, Value examples: ['NASDAQ', 'NASDAQ', 'NASDAQ'].),\n  (sbTickerCurrency:varchar, Value examples: ['USD', 'USD', 'USD'].),\n  (sbTickerDb2x:varchar, 2 letter exchange code. Value examples: ['NQ', 'NQ', 'NQ'].),\n  (sbTickerIsActive:boolean, Value examples: ['true', 'true', 'true'].),\n]\n# Table: sbDailyPrice\n[\n  (sbDpTickerId:varchar, Value examples: ['T001', 'T002'].),\n  (sbDpDate:date, Value examples: ['2023-04-01', '2023-04-01'].),\n  (sbDpOpen:numeric, Value examples: ['150.00', '280.00'].),\n  (sbDpHigh:numeric, Value examples: ['152.50', '282.75'].),\n  (sbDpLow:numeric, Value examples: ['148.75', '279.50'].),\n  (sbDpClose:numeric, Value examples: ['151.25', '281.00'].),\n  (sbDpVolume:bigint, Value examples: ['75000000', '35000000'].),\n  (sbDpEpochMs:bigint, epoch milliseconds for timestamp. Value examples: ['1680336000000', '1680336000000'].),\n  (sbDpSource:varchar, Value examples: ['NYSE', 'NASDAQ'].),\n]\n# Table: sbTransaction\n[\n  (sbTxId:varchar, Value examples: ['TX001', 'TX002', 'TX003'].),\n  (sbTxCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbTxTickerId:varchar, Value examples: ['T001', 'T002', 'T003'].),\n  (sbTxDateTime:timestamp, Value examples: ['2023-04-01 09:30:00', '2023-04-01 10:15:00', '2023-04-01 11:00:00'].),\n  (sbTxType:varchar, possible values: buy, sell. Value examples: ['buy', 'sell', 'buy'].),\n  (sbTxShares:numeric, Value examples: ['100', '50', '10'].),\n  (sbTxPrice:numeric, Value examples: ['150.00', '280.00', '3200.00'].),\n  (sbTxAmount:numeric, Value examples: ['15000.00', '14000.00', '32000.00'].),\n  (sbTxCcy:varchar, transaction currency. Value examples: ['USD', 'USD', 'USD'].),\n  (sbTxTax:numeric, Value examples: ['75.00', '70.00', '160.00'].),\n  (sbTxCommission:numeric, Value examples: ['10.00', '10.00', '20.00'].),\n  (sbTxKpx:varchar, internal code. Value examples: ['KP001', 'KP002', 'KP003'].),\n  (sbTxSettlementDateStr:varchar, settlement date as string in yyyyMMdd HH:mm:ss format. NULL if not settled. Value examples: ['20230401 09:30:00', '20230401 10:15:00', '20230401 11:00:00'].),\n  (sbTxStatus:varchar, possible values: success, fail, pending. Value examples: ['success', 'success', 'success'].),\n]\n\n【Foreign keys】\n\n【参考信息】\nTo determine the Activity Ratio (AR), divide the number of active customers by the total customer count and then multiply by 100, focusing on customers who joined within a particular year\nCustomer Rank (CR) is determined by ranking customers based on their total transaction amount, with rank 1 assigned to the customer with the highest amount.\nTo calculate Net Profit Margin (NPM), subtract the sum of tax and commission from the total amount obtained from sales, then divide by the total sales amount and multiply by 100, assessing transactions within a specific period\nACP = Average Closing Price of tickers in the last 7 days, inclusive of today\n\n【用户问题】\nWhat is the ACP for each ticker type in the past 7 days, inclusive of today? Return the ticker type and the average closing price.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT sbTickerType, AVG(sbDpClose) AS ACP FROM sbDailyPrice JOIN sbTicker ON sbDailyPrice.sbDpTickerId = sbTicker.sbTickerId WHERE sbDpDate >= CURRENT_DATE - INTERVAL '7 days' GROUP BY sbTickerType",
        "role": "assistant"
      }
    ],
    "db_name": "broker",
    "id": 253,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the AR for each country for customers who joined in 2022? Return the country and AR.\n\n【数据库schema】\n【DB_ID】 broker\n【Schema】\n# Table: sbCustomer\n[\n  (sbCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbCustName:varchar, Value examples: ['john doe', 'Jane Smith', 'Bob Johnson'].),\n  (sbCustEmail:varchar, Value examples: ['john.doe@email.com', 'jane.smith@email.com', 'bob.johnson@email.com'].),\n  (sbCustPhone:varchar, Value examples: ['555-123-4567', '555-987-6543', '555-246-8135'].),\n  (sbCustAddress1:varchar, Value examples: ['123 Main St', '456 Oak Rd', '789 Pine Ave'].),\n  (sbCustAddress2:varchar,),\n  (sbCustCity:varchar, Value examples: ['Anytown', 'Someville', 'Mytown'].),\n  (sbCustState:varchar, Value examples: ['CA', 'NY', 'TX'].),\n  (sbCustCountry:varchar, Value examples: ['USA', 'USA', 'USA'].),\n  (sbCustPostalCode:varchar, Value examples: ['90001', '10002', '75000'].),\n  (sbCustJoinDate:date, Value examples: ['2020-01-01', '2019-03-15', '2022-06-01'].),\n  (sbCustStatus:varchar, possible values: active, inactive, suspended, closed. Value examples: ['active', 'active', 'inactive'].),\n]\n# Table: sbTicker\n[\n  (sbTickerId:varchar, Value examples: ['T001', 'T002', 'T005'].),\n  (sbTickerSymbol:varchar, Value examples: ['AAPL', 'MSFT', 'GOOGL'].),\n  (sbTickerName:varchar, Value examples: ['Apple Inc.', 'Microsoft Corporation', 'Alphabet Inc.'].),\n  (sbTickerType:varchar, possible values: stock, etf, mutualfund. Value examples: ['stock', 'stock', 'stock'].),\n  (sbTickerExchange:varchar, Value examples: ['NASDAQ', 'NASDAQ', 'NASDAQ'].),\n  (sbTickerCurrency:varchar, Value examples: ['USD', 'USD', 'USD'].),\n  (sbTickerDb2x:varchar, 2 letter exchange code. Value examples: ['NQ', 'NQ', 'NQ'].),\n  (sbTickerIsActive:boolean, Value examples: ['true', 'true', 'true'].),\n]\n# Table: sbDailyPrice\n[\n  (sbDpTickerId:varchar, Value examples: ['T001', 'T002'].),\n  (sbDpDate:date, Value examples: ['2023-04-01', '2023-04-01'].),\n  (sbDpOpen:numeric, Value examples: ['150.00', '280.00'].),\n  (sbDpHigh:numeric, Value examples: ['152.50', '282.75'].),\n  (sbDpLow:numeric, Value examples: ['148.75', '279.50'].),\n  (sbDpClose:numeric, Value examples: ['151.25', '281.00'].),\n  (sbDpVolume:bigint, Value examples: ['75000000', '35000000'].),\n  (sbDpEpochMs:bigint, epoch milliseconds for timestamp. Value examples: ['1680336000000', '1680336000000'].),\n  (sbDpSource:varchar, Value examples: ['NYSE', 'NASDAQ'].),\n]\n# Table: sbTransaction\n[\n  (sbTxId:varchar, Value examples: ['TX001', 'TX002', 'TX003'].),\n  (sbTxCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbTxTickerId:varchar, Value examples: ['T001', 'T002', 'T003'].),\n  (sbTxDateTime:timestamp, Value examples: ['2023-04-01 09:30:00', '2023-04-01 10:15:00', '2023-04-01 11:00:00'].),\n  (sbTxType:varchar, possible values: buy, sell. Value examples: ['buy', 'sell', 'buy'].),\n  (sbTxShares:numeric, Value examples: ['100', '50', '10'].),\n  (sbTxPrice:numeric, Value examples: ['150.00', '280.00', '3200.00'].),\n  (sbTxAmount:numeric, Value examples: ['15000.00', '14000.00', '32000.00'].),\n  (sbTxCcy:varchar, transaction currency. Value examples: ['USD', 'USD', 'USD'].),\n  (sbTxTax:numeric, Value examples: ['75.00', '70.00', '160.00'].),\n  (sbTxCommission:numeric, Value examples: ['10.00', '10.00', '20.00'].),\n  (sbTxKpx:varchar, internal code. Value examples: ['KP001', 'KP002', 'KP003'].),\n  (sbTxSettlementDateStr:varchar, settlement date as string in yyyyMMdd HH:mm:ss format. NULL if not settled. Value examples: ['20230401 09:30:00', '20230401 10:15:00', '20230401 11:00:00'].),\n  (sbTxStatus:varchar, possible values: success, fail, pending. Value examples: ['success', 'success', 'success'].),\n]\n\n【Foreign keys】\n\n【参考信息】\nTo get the total transaction amount per customer, join the customer and transaction tables, group by customer, and sum the transaction amounts If transactions from 2 different tables from the same interval are to be joined, join on the respective truncated date fields. AR (Activity Ratio) = (Number of Active Customers with Transactions / Total Number of Customers with Transactions) * 100. To analyze stock performance, join the daily price and ticker tables, filter for a specific date range, and calculate the price change\n\n【用户问题】\nWhat is the AR for each country for customers who joined in 2022? Return the country and AR.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT c.sbCustCountry,COALESCE(100.0 * COUNT(DISTINCT CASE WHEN c.sbCustStatus = 'active' THEN c.sbCustId END) / NULLIF(COUNT(DISTINCT t.sbTxCustId), 0), 0) AS AR FROM sbCustomer c JOIN sbTransaction t ON c.sbCustId = t.sbTxCustId WHERE c.sbCustJoinDate BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY c.sbCustCountry",
        "role": "assistant"
      }
    ],
    "db_name": "broker",
    "id": 254,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the SPM for each ticker symbol from sell transactions in the past month, inclusive of 1 month ago? Return the ticker symbol and SPM.\n\n【数据库schema】\n【DB_ID】 broker\n【Schema】\n# Table: sbCustomer\n[\n  (sbCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbCustName:varchar, Value examples: ['john doe', 'Jane Smith', 'Bob Johnson'].),\n  (sbCustEmail:varchar, Value examples: ['john.doe@email.com', 'jane.smith@email.com', 'bob.johnson@email.com'].),\n  (sbCustPhone:varchar, Value examples: ['555-123-4567', '555-987-6543', '555-246-8135'].),\n  (sbCustAddress1:varchar, Value examples: ['123 Main St', '456 Oak Rd', '789 Pine Ave'].),\n  (sbCustAddress2:varchar,),\n  (sbCustCity:varchar, Value examples: ['Anytown', 'Someville', 'Mytown'].),\n  (sbCustState:varchar, Value examples: ['CA', 'NY', 'TX'].),\n  (sbCustCountry:varchar, Value examples: ['USA', 'USA', 'USA'].),\n  (sbCustPostalCode:varchar, Value examples: ['90001', '10002', '75000'].),\n  (sbCustJoinDate:date, Value examples: ['2020-01-01', '2019-03-15', '2022-06-01'].),\n  (sbCustStatus:varchar, possible values: active, inactive, suspended, closed. Value examples: ['active', 'active', 'inactive'].),\n]\n# Table: sbTicker\n[\n  (sbTickerId:varchar, Value examples: ['T001', 'T002', 'T005'].),\n  (sbTickerSymbol:varchar, Value examples: ['AAPL', 'MSFT', 'GOOGL'].),\n  (sbTickerName:varchar, Value examples: ['Apple Inc.', 'Microsoft Corporation', 'Alphabet Inc.'].),\n  (sbTickerType:varchar, possible values: stock, etf, mutualfund. Value examples: ['stock', 'stock', 'stock'].),\n  (sbTickerExchange:varchar, Value examples: ['NASDAQ', 'NASDAQ', 'NASDAQ'].),\n  (sbTickerCurrency:varchar, Value examples: ['USD', 'USD', 'USD'].),\n  (sbTickerDb2x:varchar, 2 letter exchange code. Value examples: ['NQ', 'NQ', 'NQ'].),\n  (sbTickerIsActive:boolean, Value examples: ['true', 'true', 'true'].),\n]\n# Table: sbDailyPrice\n[\n  (sbDpTickerId:varchar, Value examples: ['T001', 'T002'].),\n  (sbDpDate:date, Value examples: ['2023-04-01', '2023-04-01'].),\n  (sbDpOpen:numeric, Value examples: ['150.00', '280.00'].),\n  (sbDpHigh:numeric, Value examples: ['152.50', '282.75'].),\n  (sbDpLow:numeric, Value examples: ['148.75', '279.50'].),\n  (sbDpClose:numeric, Value examples: ['151.25', '281.00'].),\n  (sbDpVolume:bigint, Value examples: ['75000000', '35000000'].),\n  (sbDpEpochMs:bigint, epoch milliseconds for timestamp. Value examples: ['1680336000000', '1680336000000'].),\n  (sbDpSource:varchar, Value examples: ['NYSE', 'NASDAQ'].),\n]\n# Table: sbTransaction\n[\n  (sbTxId:varchar, Value examples: ['TX001', 'TX002', 'TX003'].),\n  (sbTxCustId:varchar, Value examples: ['C001', 'C002', 'C003'].),\n  (sbTxTickerId:varchar, Value examples: ['T001', 'T002', 'T003'].),\n  (sbTxDateTime:timestamp, Value examples: ['2023-04-01 09:30:00', '2023-04-01 10:15:00', '2023-04-01 11:00:00'].),\n  (sbTxType:varchar, possible values: buy, sell. Value examples: ['buy', 'sell', 'buy'].),\n  (sbTxShares:numeric, Value examples: ['100', '50', '10'].),\n  (sbTxPrice:numeric, Value examples: ['150.00', '280.00', '3200.00'].),\n  (sbTxAmount:numeric, Value examples: ['15000.00', '14000.00', '32000.00'].),\n  (sbTxCcy:varchar, transaction currency. Value examples: ['USD', 'USD', 'USD'].),\n  (sbTxTax:numeric, Value examples: ['75.00', '70.00', '160.00'].),\n  (sbTxCommission:numeric, Value examples: ['10.00', '10.00', '20.00'].),\n  (sbTxKpx:varchar, internal code. Value examples: ['KP001', 'KP002', 'KP003'].),\n  (sbTxSettlementDateStr:varchar, settlement date as string in yyyyMMdd HH:mm:ss format. NULL if not settled. Value examples: ['20230401 09:30:00', '20230401 10:15:00', '20230401 11:00:00'].),\n  (sbTxStatus:varchar, possible values: success, fail, pending. Value examples: ['success', 'success', 'success'].),\n]\n\n【Foreign keys】\n\n【参考信息】\nTo calculate the Total Active Customers who have recently joined, the Average Closing Price of tickers within a recent period, and the Customer Rank by their total transaction volume, you would need different queries and calculations that are not directly related to calculating the Net Profit Margin (NPM) for sell transactions of ticker symbols in the past month. ACP = Calculate the Average Closing Price of tickers over a chosen recent time span Analyze customer signups over a certain period.\nSPM (Selling Profit Margin) = (Total Amount from Sells - (Tax + Commission)) / Total Amount from Sells * 100\nTAC = Total Active Customers who joined within a specified timeframe\nCR = Rank customers by their total transaction volume, identifying the customer with the highest transaction volume as rank 1. This involves joining price data with ticker identifiers and filtering for a specified date range.\n\n【用户问题】\nWhat is the SPM for each ticker symbol from sell transactions in the past month, inclusive of 1 month ago? Return the ticker symbol and SPM.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT sbTickerSymbol, CASE WHEN SUM(sbTxAmount) = 0 THEN NULL ELSE (SUM(sbTxAmount) - SUM(sbTxTax + sbTxCommission)) / SUM(sbTxAmount) * 100 END AS SPM FROM sbTransaction JOIN sbTicker ON sbTransaction.sbTxTickerId = sbTicker.sbTickerId WHERE sbTxType = 'sell' AND sbTxDateTime >= CURRENT_DATE - INTERVAL '1 month' GROUP BY sbTickerSymbol;",
        "role": "assistant"
      }
    ],
    "db_name": "broker",
    "id": 255,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the average number of days between the sale date and payment received date, rounded to 2 decimal places?\n\n【数据库schema】\n【DB_ID】 car_dealership\n【Schema】\n# Table: cars\n[\n  (id:SERIAL, Primary key for the cars table.),\n  (make:TEXT, Manufacturer of the car. Value examples: ['Toyota', 'Honda'].),\n  (model:TEXT, Model name of the car. Value examples: ['Camry', 'Civic'].),\n  (year:INTEGER, Year of manufacture. Value examples: ['2022', '2021'].),\n  (color:TEXT, Color of the car. Value examples: ['Silver', 'platinum/grey'].),\n  (vin_number:VARCHAR, Vehicle Identification Number. Value examples: ['4T1BF1FK3CU510984', '2HGFC2F53MH522780'].),\n  (engine_type:TEXT, Type of engine (e.g., V6, V8, Electric). Value examples: ['V6', 'Inline 4'].),\n  (transmission:TEXT, Type of transmission (e.g., Automatic, Manual). Value examples: ['Automatic', 'CVT'].),\n  (price:NUMERIC, Selling price of the car. Value examples: ['28500.00', '22000.00'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the car was added to the system.),\n]\n# Table: salespersons\n[\n  (id:SERIAL, Unique identifier for each salesperson.),\n  (first_name:TEXT, Value examples: ['Sarah', 'Daniel', 'Olivia'].),\n  (last_name:TEXT, Value examples: ['Taylor', 'Anderson', 'Thomas'].),\n  (email:VARCHAR, Value examples: ['sarah.taylor@sonicauto.com', 'daniel.anderson@sonicauto.com', 'olivia.thomas@pensake.com'].),\n  (phone:VARCHAR, First 3 digits in brackets is the area code. Format: (123)-456-7890. Value examples: ['(123)-555-6666', '(555)-777-8888', '(333)-415-0000'].),\n  (hire_date:DATE, Value examples: ['2018-09-01', '2021-07-12', '2023-01-25'].),\n  (termination_date:DATE,),\n  (crtd_ts:TIMESTAMP, Timestamp when the salesperson record was created.),\n]\n# Table: customers\n[\n  (id:SERIAL, Primary key for the customers table.),\n  (first_name:TEXT,),\n  (last_name:TEXT,),\n  (email:VARCHAR,),\n  (phone:VARCHAR,),\n  (address:TEXT,),\n  (city:TEXT,),\n  (state:TEXT,),\n  (zip_code:VARCHAR,),\n  (crtd_ts:TIMESTAMP, Timestamp when the customer record was created.),\n]\n# Table: sales\n[\n  (id:SERIAL, Primary key that uniquely identifies each sale.),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '3', '6', '8'].),\n  (salesperson_id:INTEGER, Foreign key referencing the salespersons table. Value examples: ['2', '1', '4', '7'].),\n  (customer_id:INTEGER, Foreign key referencing the customers table. Value examples: ['3', '5', '2', '9'].),\n  (sale_price:NUMERIC, Price at which the car was sold. Value examples: ['27500.00', '44000.00', '24500.00', '38000.00'].),\n  (sale_date:DATE, Date when the car was sold. Value examples: ['2023-03-15', '2023-03-20', '2023-03-22', '2023-03-25'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the sale record was created.),\n]\n# Table: inventory_snapshots\n[\n  (id:SERIAL, Primary key for the inventory_snapshots table.),\n  (snapshot_date:DATE, Date of the inventory snapshot. Value examples: ['2023-03-15', '2023-03-15', '2023-03-15'].),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '2', '3'].),\n  (is_in_inventory:BOOLEAN, Indicates if the car was in inventory on the snapshot date. Value examples: ['TRUE', 'TRUE', 'TRUE'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the inventory snapshot record was created.),\n]\n# Table: payments_received\n[\n  (id:SERIAL, Uniquely identifies each payment received record.),\n  (sale_id:INTEGER, Foreign key referencing the sales table. Value examples: ['1', '1'].),\n  (payment_date:DATE, Date when the payment was received. Can take place after the sale date, or in installments.. Value examples: ['2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment received. Can be less than the sale price if the payment is made in installments.. Value examples: ['5000.00', '22500.00'].),\n  (payment_method:TEXT, Method of payment (e.g., cash, check, card, banktrf, trp01). Value examples: ['check', 'financing'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment received record was created.),\n]\n# Table: payments_made\n[\n  (id:SERIAL, Primary key for the payments_made table.),\n  (vendor_name:TEXT, Name of the vendor to whom the payment was made. Value examples: ['Car Manufacturer Inc', 'Auto Parts Supplier', 'Utility Company', 'Marketing Agency'].),\n  (payment_date:DATE, Date when the payment was made. Value examples: ['2023-03-01', '2023-03-10', '2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment made. Value examples: ['150000.00', '25000.00', '1500.00', '10000.00'].),\n  (payment_method:TEXT, Method of payment (e.g., check, bank_transfer, credit_card). Value examples: ['bank_transfer', 'check', 'bank_transfer', 'credit_card'].),\n  (invoice_number:VARCHAR, Invoice number associated with the payment. Value examples: ['INV-001', 'INV-002', 'INV-003', 'INV-004'].),\n  (invoice_date:DATE, Date of the invoice. Value examples: ['2023-02-25', '2023-03-05', '2023-03-01', '2023-03-15'].),\n  (due_date:DATE, Due date of the invoice. Value examples: ['2023-03-25', '2023-04-04', '2023-03-31', '2023-04-14'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment made record was created.),\n]\n\n【Foreign keys】\n\n【参考信息】\nWhen getting duration between sale and payment date for each sale, get the latest payment for sale by aggregating over the payments_received table first. ASP = Calculate the average price of sales within a specific timeframe Last 30 days = Use a range from the current date minus a certain interval to the current date, always ensure to make the necessary joins before utilizing the sales data. TSC = Count of sales within a specified period\n\n【用户问题】\nWhat is the average number of days between the sale date and payment received date, rounded to 2 decimal places?\n\n```sql",
        "role": "user"
      },
      {
        "content": "WITH sale_payments AS (SELECT s.id AS sale_id, s.sale_date, MAX(p.payment_date) AS latest_payment_date FROM sales s JOIN payments_received p ON s.id = p.sale_id GROUP BY 1,2) SELECT ROUND(AVG(latest_payment_date - sale_date), 2) AS avg_days_to_payment FROM sale_payments",
        "role": "assistant"
      }
    ],
    "db_name": "car_dealership",
    "id": 256,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nReturn the highest sale price for each make and model of cars that have been sold and are no longer in inventory, ordered by the sale price from highest to lowest.\n\n【数据库schema】\n【DB_ID】 car_dealership\n【Schema】\n# Table: cars\n[\n  (id:SERIAL, Primary key for the cars table.),\n  (make:TEXT, Manufacturer of the car. Value examples: ['Toyota', 'Honda'].),\n  (model:TEXT, Model name of the car. Value examples: ['Camry', 'Civic'].),\n  (year:INTEGER, Year of manufacture. Value examples: ['2022', '2021'].),\n  (color:TEXT, Color of the car. Value examples: ['Silver', 'platinum/grey'].),\n  (vin_number:VARCHAR, Vehicle Identification Number. Value examples: ['4T1BF1FK3CU510984', '2HGFC2F53MH522780'].),\n  (engine_type:TEXT, Type of engine (e.g., V6, V8, Electric). Value examples: ['V6', 'Inline 4'].),\n  (transmission:TEXT, Type of transmission (e.g., Automatic, Manual). Value examples: ['Automatic', 'CVT'].),\n  (price:NUMERIC, Selling price of the car. Value examples: ['28500.00', '22000.00'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the car was added to the system.),\n]\n# Table: salespersons\n[\n  (id:SERIAL, Unique identifier for each salesperson.),\n  (first_name:TEXT, Value examples: ['Sarah', 'Daniel', 'Olivia'].),\n  (last_name:TEXT, Value examples: ['Taylor', 'Anderson', 'Thomas'].),\n  (email:VARCHAR, Value examples: ['sarah.taylor@sonicauto.com', 'daniel.anderson@sonicauto.com', 'olivia.thomas@pensake.com'].),\n  (phone:VARCHAR, First 3 digits in brackets is the area code. Format: (123)-456-7890. Value examples: ['(123)-555-6666', '(555)-777-8888', '(333)-415-0000'].),\n  (hire_date:DATE, Value examples: ['2018-09-01', '2021-07-12', '2023-01-25'].),\n  (termination_date:DATE,),\n  (crtd_ts:TIMESTAMP, Timestamp when the salesperson record was created.),\n]\n# Table: customers\n[\n  (id:SERIAL, Primary key for the customers table.),\n  (first_name:TEXT,),\n  (last_name:TEXT,),\n  (email:VARCHAR,),\n  (phone:VARCHAR,),\n  (address:TEXT,),\n  (city:TEXT,),\n  (state:TEXT,),\n  (zip_code:VARCHAR,),\n  (crtd_ts:TIMESTAMP, Timestamp when the customer record was created.),\n]\n# Table: sales\n[\n  (id:SERIAL, Primary key that uniquely identifies each sale.),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '3', '6', '8'].),\n  (salesperson_id:INTEGER, Foreign key referencing the salespersons table. Value examples: ['2', '1', '4', '7'].),\n  (customer_id:INTEGER, Foreign key referencing the customers table. Value examples: ['3', '5', '2', '9'].),\n  (sale_price:NUMERIC, Price at which the car was sold. Value examples: ['27500.00', '44000.00', '24500.00', '38000.00'].),\n  (sale_date:DATE, Date when the car was sold. Value examples: ['2023-03-15', '2023-03-20', '2023-03-22', '2023-03-25'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the sale record was created.),\n]\n# Table: inventory_snapshots\n[\n  (id:SERIAL, Primary key for the inventory_snapshots table.),\n  (snapshot_date:DATE, Date of the inventory snapshot. Value examples: ['2023-03-15', '2023-03-15', '2023-03-15'].),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '2', '3'].),\n  (is_in_inventory:BOOLEAN, Indicates if the car was in inventory on the snapshot date. Value examples: ['TRUE', 'TRUE', 'TRUE'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the inventory snapshot record was created.),\n]\n# Table: payments_received\n[\n  (id:SERIAL, Uniquely identifies each payment received record.),\n  (sale_id:INTEGER, Foreign key referencing the sales table. Value examples: ['1', '1'].),\n  (payment_date:DATE, Date when the payment was received. Can take place after the sale date, or in installments.. Value examples: ['2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment received. Can be less than the sale price if the payment is made in installments.. Value examples: ['5000.00', '22500.00'].),\n  (payment_method:TEXT, Method of payment (e.g., cash, check, card, banktrf, trp01). Value examples: ['check', 'financing'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment received record was created.),\n]\n# Table: payments_made\n[\n  (id:SERIAL, Primary key for the payments_made table.),\n  (vendor_name:TEXT, Name of the vendor to whom the payment was made. Value examples: ['Car Manufacturer Inc', 'Auto Parts Supplier', 'Utility Company', 'Marketing Agency'].),\n  (payment_date:DATE, Date when the payment was made. Value examples: ['2023-03-01', '2023-03-10', '2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment made. Value examples: ['150000.00', '25000.00', '1500.00', '10000.00'].),\n  (payment_method:TEXT, Method of payment (e.g., check, bank_transfer, credit_card). Value examples: ['bank_transfer', 'check', 'bank_transfer', 'credit_card'].),\n  (invoice_number:VARCHAR, Invoice number associated with the payment. Value examples: ['INV-001', 'INV-002', 'INV-003', 'INV-004'].),\n  (invoice_date:DATE, Date of the invoice. Value examples: ['2023-02-25', '2023-03-05', '2023-03-01', '2023-03-15'].),\n  (due_date:DATE, Due date of the invoice. Value examples: ['2023-03-25', '2023-04-04', '2023-03-31', '2023-04-14'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment made record was created.),\n]\n\n【Foreign keys】\n\n【参考信息】\nTSC = Count of sales within a specified period\nMoM = Change in total receivable amounts from one month to the next, comparing with the immediately preceding month.\nASP = Mean sale price for a designated start period\nWhen getting a car's inventory status, always take the latest status from the inventory_snapshots table\n\n【用户问题】\nReturn the highest sale price for each make and model of cars that have been sold and are no longer in inventory, ordered by the sale price from highest to lowest.\n\n```sql",
        "role": "user"
      },
      {
        "content": "WITH latest_inventory_status AS (SELECT car_id, is_in_inventory, ROW_NUMBER() OVER(PARTITION BY car_id ORDER BY snapshot_date DESC, crtd_ts DESC) AS rn FROM inventory_snapshots) SELECT c.make, c.model, MAX(s.sale_price) AS highest_sale_price FROM cars c JOIN sales s ON c.id = s.car_id JOIN latest_inventory_status lis ON c.id = lis.car_id WHERE lis.is_in_inventory = FALSE AND lis.rn = 1 GROUP BY c.make, c.model ORDER BY highest_sale_price DESC",
        "role": "assistant"
      }
    ],
    "db_name": "car_dealership",
    "id": 257,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWho are the top 5 salespersons by total sales amount? Return their ID, first name, last name and total sales amount.\n\n【数据库schema】\n【DB_ID】 car_dealership\n【Schema】\n# Table: cars\n[\n  (id:SERIAL, Primary key for the cars table.),\n  (make:TEXT, Manufacturer of the car. Value examples: ['Toyota', 'Honda'].),\n  (model:TEXT, Model name of the car. Value examples: ['Camry', 'Civic'].),\n  (year:INTEGER, Year of manufacture. Value examples: ['2022', '2021'].),\n  (color:TEXT, Color of the car. Value examples: ['Silver', 'platinum/grey'].),\n  (vin_number:VARCHAR, Vehicle Identification Number. Value examples: ['4T1BF1FK3CU510984', '2HGFC2F53MH522780'].),\n  (engine_type:TEXT, Type of engine (e.g., V6, V8, Electric). Value examples: ['V6', 'Inline 4'].),\n  (transmission:TEXT, Type of transmission (e.g., Automatic, Manual). Value examples: ['Automatic', 'CVT'].),\n  (price:NUMERIC, Selling price of the car. Value examples: ['28500.00', '22000.00'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the car was added to the system.),\n]\n# Table: salespersons\n[\n  (id:SERIAL, Unique identifier for each salesperson.),\n  (first_name:TEXT, Value examples: ['Sarah', 'Daniel', 'Olivia'].),\n  (last_name:TEXT, Value examples: ['Taylor', 'Anderson', 'Thomas'].),\n  (email:VARCHAR, Value examples: ['sarah.taylor@sonicauto.com', 'daniel.anderson@sonicauto.com', 'olivia.thomas@pensake.com'].),\n  (phone:VARCHAR, First 3 digits in brackets is the area code. Format: (123)-456-7890. Value examples: ['(123)-555-6666', '(555)-777-8888', '(333)-415-0000'].),\n  (hire_date:DATE, Value examples: ['2018-09-01', '2021-07-12', '2023-01-25'].),\n  (termination_date:DATE,),\n  (crtd_ts:TIMESTAMP, Timestamp when the salesperson record was created.),\n]\n# Table: customers\n[\n  (id:SERIAL, Primary key for the customers table.),\n  (first_name:TEXT,),\n  (last_name:TEXT,),\n  (email:VARCHAR,),\n  (phone:VARCHAR,),\n  (address:TEXT,),\n  (city:TEXT,),\n  (state:TEXT,),\n  (zip_code:VARCHAR,),\n  (crtd_ts:TIMESTAMP, Timestamp when the customer record was created.),\n]\n# Table: sales\n[\n  (id:SERIAL, Primary key that uniquely identifies each sale.),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '3', '6', '8'].),\n  (salesperson_id:INTEGER, Foreign key referencing the salespersons table. Value examples: ['2', '1', '4', '7'].),\n  (customer_id:INTEGER, Foreign key referencing the customers table. Value examples: ['3', '5', '2', '9'].),\n  (sale_price:NUMERIC, Price at which the car was sold. Value examples: ['27500.00', '44000.00', '24500.00', '38000.00'].),\n  (sale_date:DATE, Date when the car was sold. Value examples: ['2023-03-15', '2023-03-20', '2023-03-22', '2023-03-25'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the sale record was created.),\n]\n# Table: inventory_snapshots\n[\n  (id:SERIAL, Primary key for the inventory_snapshots table.),\n  (snapshot_date:DATE, Date of the inventory snapshot. Value examples: ['2023-03-15', '2023-03-15', '2023-03-15'].),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '2', '3'].),\n  (is_in_inventory:BOOLEAN, Indicates if the car was in inventory on the snapshot date. Value examples: ['TRUE', 'TRUE', 'TRUE'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the inventory snapshot record was created.),\n]\n# Table: payments_received\n[\n  (id:SERIAL, Uniquely identifies each payment received record.),\n  (sale_id:INTEGER, Foreign key referencing the sales table. Value examples: ['1', '1'].),\n  (payment_date:DATE, Date when the payment was received. Can take place after the sale date, or in installments.. Value examples: ['2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment received. Can be less than the sale price if the payment is made in installments.. Value examples: ['5000.00', '22500.00'].),\n  (payment_method:TEXT, Method of payment (e.g., cash, check, card, banktrf, trp01). Value examples: ['check', 'financing'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment received record was created.),\n]\n# Table: payments_made\n[\n  (id:SERIAL, Primary key for the payments_made table.),\n  (vendor_name:TEXT, Name of the vendor to whom the payment was made. Value examples: ['Car Manufacturer Inc', 'Auto Parts Supplier', 'Utility Company', 'Marketing Agency'].),\n  (payment_date:DATE, Date when the payment was made. Value examples: ['2023-03-01', '2023-03-10', '2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment made. Value examples: ['150000.00', '25000.00', '1500.00', '10000.00'].),\n  (payment_method:TEXT, Method of payment (e.g., check, bank_transfer, credit_card). Value examples: ['bank_transfer', 'check', 'bank_transfer', 'credit_card'].),\n  (invoice_number:VARCHAR, Invoice number associated with the payment. Value examples: ['INV-001', 'INV-002', 'INV-003', 'INV-004'].),\n  (invoice_date:DATE, Date of the invoice. Value examples: ['2023-02-25', '2023-03-05', '2023-03-01', '2023-03-15'].),\n  (due_date:DATE, Due date of the invoice. Value examples: ['2023-03-25', '2023-04-04', '2023-03-31', '2023-04-14'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment made record was created.),\n]\n\n【Foreign keys】\n\n【参考信息】\nPMSR = per month sales revenue\nAlways join sales with cars before using the sales table\nWeekend days are Saturday and Sunday\nTruncate date to month for aggregation\nLast 30 days = CURRENT_DATE - INTERVAL 'some time' to CURRENT_DATE\nPMSPS = per month salesperson signups\nTo get the total sales amount per salesperson, join the salespersons and sales tables, group by salesperson, and sum the sale_price. Always order results with NULLS last.\nTruncate date to week for aggregation.\n\n【用户问题】\nWho are the top 5 salespersons by total sales amount? Return their ID, first name, last name and total sales amount.\n\n```sql",
        "role": "user"
      },
      {
        "content": "WITH salesperson_sales AS (SELECT s.id, s.first_name, s.last_name, SUM(sa.sale_price) AS total_sales FROM salespersons s LEFT JOIN sales sa ON s.id = sa.salesperson_id GROUP BY s.id) SELECT id, first_name, last_name, total_sales FROM salesperson_sales ORDER BY total_sales DESC NULLS LAST LIMIT 5",
        "role": "assistant"
      }
    ],
    "db_name": "car_dealership",
    "id": 258,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many sales did each salesperson make in the past 30 days, inclusive of today's date? Return their ID, first name, last name and number of sales made, ordered from most to least sales.\n\n【数据库schema】\n【DB_ID】 car_dealership\n【Schema】\n# Table: cars\n[\n  (id:SERIAL, Primary key for the cars table.),\n  (make:TEXT, Manufacturer of the car. Value examples: ['Toyota', 'Honda'].),\n  (model:TEXT, Model name of the car. Value examples: ['Camry', 'Civic'].),\n  (year:INTEGER, Year of manufacture. Value examples: ['2022', '2021'].),\n  (color:TEXT, Color of the car. Value examples: ['Silver', 'platinum/grey'].),\n  (vin_number:VARCHAR, Vehicle Identification Number. Value examples: ['4T1BF1FK3CU510984', '2HGFC2F53MH522780'].),\n  (engine_type:TEXT, Type of engine (e.g., V6, V8, Electric). Value examples: ['V6', 'Inline 4'].),\n  (transmission:TEXT, Type of transmission (e.g., Automatic, Manual). Value examples: ['Automatic', 'CVT'].),\n  (price:NUMERIC, Selling price of the car. Value examples: ['28500.00', '22000.00'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the car was added to the system.),\n]\n# Table: salespersons\n[\n  (id:SERIAL, Unique identifier for each salesperson.),\n  (first_name:TEXT, Value examples: ['Sarah', 'Daniel', 'Olivia'].),\n  (last_name:TEXT, Value examples: ['Taylor', 'Anderson', 'Thomas'].),\n  (email:VARCHAR, Value examples: ['sarah.taylor@sonicauto.com', 'daniel.anderson@sonicauto.com', 'olivia.thomas@pensake.com'].),\n  (phone:VARCHAR, First 3 digits in brackets is the area code. Format: (123)-456-7890. Value examples: ['(123)-555-6666', '(555)-777-8888', '(333)-415-0000'].),\n  (hire_date:DATE, Value examples: ['2018-09-01', '2021-07-12', '2023-01-25'].),\n  (termination_date:DATE,),\n  (crtd_ts:TIMESTAMP, Timestamp when the salesperson record was created.),\n]\n# Table: customers\n[\n  (id:SERIAL, Primary key for the customers table.),\n  (first_name:TEXT,),\n  (last_name:TEXT,),\n  (email:VARCHAR,),\n  (phone:VARCHAR,),\n  (address:TEXT,),\n  (city:TEXT,),\n  (state:TEXT,),\n  (zip_code:VARCHAR,),\n  (crtd_ts:TIMESTAMP, Timestamp when the customer record was created.),\n]\n# Table: sales\n[\n  (id:SERIAL, Primary key that uniquely identifies each sale.),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '3', '6', '8'].),\n  (salesperson_id:INTEGER, Foreign key referencing the salespersons table. Value examples: ['2', '1', '4', '7'].),\n  (customer_id:INTEGER, Foreign key referencing the customers table. Value examples: ['3', '5', '2', '9'].),\n  (sale_price:NUMERIC, Price at which the car was sold. Value examples: ['27500.00', '44000.00', '24500.00', '38000.00'].),\n  (sale_date:DATE, Date when the car was sold. Value examples: ['2023-03-15', '2023-03-20', '2023-03-22', '2023-03-25'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the sale record was created.),\n]\n# Table: inventory_snapshots\n[\n  (id:SERIAL, Primary key for the inventory_snapshots table.),\n  (snapshot_date:DATE, Date of the inventory snapshot. Value examples: ['2023-03-15', '2023-03-15', '2023-03-15'].),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '2', '3'].),\n  (is_in_inventory:BOOLEAN, Indicates if the car was in inventory on the snapshot date. Value examples: ['TRUE', 'TRUE', 'TRUE'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the inventory snapshot record was created.),\n]\n# Table: payments_received\n[\n  (id:SERIAL, Uniquely identifies each payment received record.),\n  (sale_id:INTEGER, Foreign key referencing the sales table. Value examples: ['1', '1'].),\n  (payment_date:DATE, Date when the payment was received. Can take place after the sale date, or in installments.. Value examples: ['2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment received. Can be less than the sale price if the payment is made in installments.. Value examples: ['5000.00', '22500.00'].),\n  (payment_method:TEXT, Method of payment (e.g., cash, check, card, banktrf, trp01). Value examples: ['check', 'financing'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment received record was created.),\n]\n# Table: payments_made\n[\n  (id:SERIAL, Primary key for the payments_made table.),\n  (vendor_name:TEXT, Name of the vendor to whom the payment was made. Value examples: ['Car Manufacturer Inc', 'Auto Parts Supplier', 'Utility Company', 'Marketing Agency'].),\n  (payment_date:DATE, Date when the payment was made. Value examples: ['2023-03-01', '2023-03-10', '2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment made. Value examples: ['150000.00', '25000.00', '1500.00', '10000.00'].),\n  (payment_method:TEXT, Method of payment (e.g., check, bank_transfer, credit_card). Value examples: ['bank_transfer', 'check', 'bank_transfer', 'credit_card'].),\n  (invoice_number:VARCHAR, Invoice number associated with the payment. Value examples: ['INV-001', 'INV-002', 'INV-003', 'INV-004'].),\n  (invoice_date:DATE, Date of the invoice. Value examples: ['2023-02-25', '2023-03-05', '2023-03-01', '2023-03-15'].),\n  (due_date:DATE, Due date of the invoice. Value examples: ['2023-03-25', '2023-04-04', '2023-03-31', '2023-04-14'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment made record was created.),\n]\n\n【Foreign keys】\n\n【参考信息】\nWhen using car makes, model names, engine_type, and vin_number, ensure matching is case-insensitive and allows for partial matches using LIKE with wildcards.\nTo get the number of sales made by each salesperson in the past 30 days, join the salespersons and sales tables and filter for sales in the last 30 days.\nASP = Calculate the average sale price without specifying the period\nGPM = Define gross profit margin as a ratio without specifying how to calculate total revenue or total cost\n\n【用户问题】\nHow many sales did each salesperson make in the past 30 days, inclusive of today's date? Return their ID, first name, last name and number of sales made, ordered from most to least sales.\n\n```sql",
        "role": "user"
      },
      {
        "content": "WITH recent_sales AS (SELECT sp.id, sp.first_name, sp.last_name, COUNT(s.id) AS num_sales FROM salespersons sp LEFT JOIN sales s ON sp.id = s.salesperson_id WHERE s.sale_date >= CURRENT_DATE - INTERVAL '30 days' GROUP BY sp.id) SELECT id, first_name, last_name, num_sales FROM recent_sales ORDER BY num_sales DESC;WITH recent_sales AS (SELECT sp.id, sp.first_name, sp.last_name, COUNT(s.id) AS num_sales FROM salespersons sp LEFT JOIN sales s ON sp.id = s.salesperson_id AND s.sale_date >= CURRENT_DATE - INTERVAL '30 days' GROUP BY sp.id, sp.first_name, sp.last_name) SELECT id, first_name, last_name, num_sales FROM recent_sales ORDER BY num_sales DESC",
        "role": "assistant"
      }
    ],
    "db_name": "car_dealership",
    "id": 259,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nReturn the first name, last name, total sales amount, number of sales, and SR for each salesperson\n\n【数据库schema】\n【DB_ID】 car_dealership\n【Schema】\n# Table: cars\n[\n  (id:SERIAL, Primary key for the cars table.),\n  (make:TEXT, Manufacturer of the car. Value examples: ['Toyota', 'Honda'].),\n  (model:TEXT, Model name of the car. Value examples: ['Camry', 'Civic'].),\n  (year:INTEGER, Year of manufacture. Value examples: ['2022', '2021'].),\n  (color:TEXT, Color of the car. Value examples: ['Silver', 'platinum/grey'].),\n  (vin_number:VARCHAR, Vehicle Identification Number. Value examples: ['4T1BF1FK3CU510984', '2HGFC2F53MH522780'].),\n  (engine_type:TEXT, Type of engine (e.g., V6, V8, Electric). Value examples: ['V6', 'Inline 4'].),\n  (transmission:TEXT, Type of transmission (e.g., Automatic, Manual). Value examples: ['Automatic', 'CVT'].),\n  (price:NUMERIC, Selling price of the car. Value examples: ['28500.00', '22000.00'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the car was added to the system.),\n]\n# Table: salespersons\n[\n  (id:SERIAL, Unique identifier for each salesperson.),\n  (first_name:TEXT, Value examples: ['Sarah', 'Daniel', 'Olivia'].),\n  (last_name:TEXT, Value examples: ['Taylor', 'Anderson', 'Thomas'].),\n  (email:VARCHAR, Value examples: ['sarah.taylor@sonicauto.com', 'daniel.anderson@sonicauto.com', 'olivia.thomas@pensake.com'].),\n  (phone:VARCHAR, First 3 digits in brackets is the area code. Format: (123)-456-7890. Value examples: ['(123)-555-6666', '(555)-777-8888', '(333)-415-0000'].),\n  (hire_date:DATE, Value examples: ['2018-09-01', '2021-07-12', '2023-01-25'].),\n  (termination_date:DATE,),\n  (crtd_ts:TIMESTAMP, Timestamp when the salesperson record was created.),\n]\n# Table: customers\n[\n  (id:SERIAL, Primary key for the customers table.),\n  (first_name:TEXT,),\n  (last_name:TEXT,),\n  (email:VARCHAR,),\n  (phone:VARCHAR,),\n  (address:TEXT,),\n  (city:TEXT,),\n  (state:TEXT,),\n  (zip_code:VARCHAR,),\n  (crtd_ts:TIMESTAMP, Timestamp when the customer record was created.),\n]\n# Table: sales\n[\n  (id:SERIAL, Primary key that uniquely identifies each sale.),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '3', '6', '8'].),\n  (salesperson_id:INTEGER, Foreign key referencing the salespersons table. Value examples: ['2', '1', '4', '7'].),\n  (customer_id:INTEGER, Foreign key referencing the customers table. Value examples: ['3', '5', '2', '9'].),\n  (sale_price:NUMERIC, Price at which the car was sold. Value examples: ['27500.00', '44000.00', '24500.00', '38000.00'].),\n  (sale_date:DATE, Date when the car was sold. Value examples: ['2023-03-15', '2023-03-20', '2023-03-22', '2023-03-25'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the sale record was created.),\n]\n# Table: inventory_snapshots\n[\n  (id:SERIAL, Primary key for the inventory_snapshots table.),\n  (snapshot_date:DATE, Date of the inventory snapshot. Value examples: ['2023-03-15', '2023-03-15', '2023-03-15'].),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '2', '3'].),\n  (is_in_inventory:BOOLEAN, Indicates if the car was in inventory on the snapshot date. Value examples: ['TRUE', 'TRUE', 'TRUE'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the inventory snapshot record was created.),\n]\n# Table: payments_received\n[\n  (id:SERIAL, Uniquely identifies each payment received record.),\n  (sale_id:INTEGER, Foreign key referencing the sales table. Value examples: ['1', '1'].),\n  (payment_date:DATE, Date when the payment was received. Can take place after the sale date, or in installments.. Value examples: ['2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment received. Can be less than the sale price if the payment is made in installments.. Value examples: ['5000.00', '22500.00'].),\n  (payment_method:TEXT, Method of payment (e.g., cash, check, card, banktrf, trp01). Value examples: ['check', 'financing'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment received record was created.),\n]\n# Table: payments_made\n[\n  (id:SERIAL, Primary key for the payments_made table.),\n  (vendor_name:TEXT, Name of the vendor to whom the payment was made. Value examples: ['Car Manufacturer Inc', 'Auto Parts Supplier', 'Utility Company', 'Marketing Agency'].),\n  (payment_date:DATE, Date when the payment was made. Value examples: ['2023-03-01', '2023-03-10', '2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment made. Value examples: ['150000.00', '25000.00', '1500.00', '10000.00'].),\n  (payment_method:TEXT, Method of payment (e.g., check, bank_transfer, credit_card). Value examples: ['bank_transfer', 'check', 'bank_transfer', 'credit_card'].),\n  (invoice_number:VARCHAR, Invoice number associated with the payment. Value examples: ['INV-001', 'INV-002', 'INV-003', 'INV-004'].),\n  (invoice_date:DATE, Date of the invoice. Value examples: ['2023-02-25', '2023-03-05', '2023-03-01', '2023-03-15'].),\n  (due_date:DATE, Due date of the invoice. Value examples: ['2023-03-25', '2023-04-04', '2023-03-31', '2023-04-14'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment made record was created.),\n]\n\n【Foreign keys】\n\n【参考信息】\nSR = sales rank of each salesperson ordered by their total sales amount descending To determine the sales performance per territory, sum the sales amount and count the sales, grouping by territory To calculate the average sale price, join the sales table with itself on the salesperson_id and find the ratio of total sales amount to number of sales To assess inventory turnover, compare inventory snapshots with sales on matching days, focusing on the quantity of items sold.\n\n【用户问题】\nReturn the first name, last name, total sales amount, number of sales, and SR for each salesperson\n\n```sql",
        "role": "user"
      },
      {
        "content": "WITH salesperson_sales AS (SELECT salesperson_id, SUM(sale_price) AS total_sales, COUNT(*) AS num_sales FROM sales GROUP BY salesperson_id) SELECT s.first_name, s.last_name, ss.total_sales, ss.num_sales, RANK() OVER (ORDER BY ss.total_sales DESC) AS sales_rank FROM salesperson_sales ss JOIN salespersons s ON ss.salesperson_id = s.id",
        "role": "assistant"
      }
    ],
    "db_name": "car_dealership",
    "id": 260,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the total payments received per month? Also calculate the MoM change for each month.\n\n【数据库schema】\n【DB_ID】 car_dealership\n【Schema】\n# Table: cars\n[\n  (id:SERIAL, Primary key for the cars table.),\n  (make:TEXT, Manufacturer of the car. Value examples: ['Toyota', 'Honda'].),\n  (model:TEXT, Model name of the car. Value examples: ['Camry', 'Civic'].),\n  (year:INTEGER, Year of manufacture. Value examples: ['2022', '2021'].),\n  (color:TEXT, Color of the car. Value examples: ['Silver', 'platinum/grey'].),\n  (vin_number:VARCHAR, Vehicle Identification Number. Value examples: ['4T1BF1FK3CU510984', '2HGFC2F53MH522780'].),\n  (engine_type:TEXT, Type of engine (e.g., V6, V8, Electric). Value examples: ['V6', 'Inline 4'].),\n  (transmission:TEXT, Type of transmission (e.g., Automatic, Manual). Value examples: ['Automatic', 'CVT'].),\n  (price:NUMERIC, Selling price of the car. Value examples: ['28500.00', '22000.00'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the car was added to the system.),\n]\n# Table: salespersons\n[\n  (id:SERIAL, Unique identifier for each salesperson.),\n  (first_name:TEXT, Value examples: ['Sarah', 'Daniel', 'Olivia'].),\n  (last_name:TEXT, Value examples: ['Taylor', 'Anderson', 'Thomas'].),\n  (email:VARCHAR, Value examples: ['sarah.taylor@sonicauto.com', 'daniel.anderson@sonicauto.com', 'olivia.thomas@pensake.com'].),\n  (phone:VARCHAR, First 3 digits in brackets is the area code. Format: (123)-456-7890. Value examples: ['(123)-555-6666', '(555)-777-8888', '(333)-415-0000'].),\n  (hire_date:DATE, Value examples: ['2018-09-01', '2021-07-12', '2023-01-25'].),\n  (termination_date:DATE,),\n  (crtd_ts:TIMESTAMP, Timestamp when the salesperson record was created.),\n]\n# Table: customers\n[\n  (id:SERIAL, Primary key for the customers table.),\n  (first_name:TEXT,),\n  (last_name:TEXT,),\n  (email:VARCHAR,),\n  (phone:VARCHAR,),\n  (address:TEXT,),\n  (city:TEXT,),\n  (state:TEXT,),\n  (zip_code:VARCHAR,),\n  (crtd_ts:TIMESTAMP, Timestamp when the customer record was created.),\n]\n# Table: sales\n[\n  (id:SERIAL, Primary key that uniquely identifies each sale.),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '3', '6', '8'].),\n  (salesperson_id:INTEGER, Foreign key referencing the salespersons table. Value examples: ['2', '1', '4', '7'].),\n  (customer_id:INTEGER, Foreign key referencing the customers table. Value examples: ['3', '5', '2', '9'].),\n  (sale_price:NUMERIC, Price at which the car was sold. Value examples: ['27500.00', '44000.00', '24500.00', '38000.00'].),\n  (sale_date:DATE, Date when the car was sold. Value examples: ['2023-03-15', '2023-03-20', '2023-03-22', '2023-03-25'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the sale record was created.),\n]\n# Table: inventory_snapshots\n[\n  (id:SERIAL, Primary key for the inventory_snapshots table.),\n  (snapshot_date:DATE, Date of the inventory snapshot. Value examples: ['2023-03-15', '2023-03-15', '2023-03-15'].),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '2', '3'].),\n  (is_in_inventory:BOOLEAN, Indicates if the car was in inventory on the snapshot date. Value examples: ['TRUE', 'TRUE', 'TRUE'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the inventory snapshot record was created.),\n]\n# Table: payments_received\n[\n  (id:SERIAL, Uniquely identifies each payment received record.),\n  (sale_id:INTEGER, Foreign key referencing the sales table. Value examples: ['1', '1'].),\n  (payment_date:DATE, Date when the payment was received. Can take place after the sale date, or in installments.. Value examples: ['2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment received. Can be less than the sale price if the payment is made in installments.. Value examples: ['5000.00', '22500.00'].),\n  (payment_method:TEXT, Method of payment (e.g., cash, check, card, banktrf, trp01). Value examples: ['check', 'financing'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment received record was created.),\n]\n# Table: payments_made\n[\n  (id:SERIAL, Primary key for the payments_made table.),\n  (vendor_name:TEXT, Name of the vendor to whom the payment was made. Value examples: ['Car Manufacturer Inc', 'Auto Parts Supplier', 'Utility Company', 'Marketing Agency'].),\n  (payment_date:DATE, Date when the payment was made. Value examples: ['2023-03-01', '2023-03-10', '2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment made. Value examples: ['150000.00', '25000.00', '1500.00', '10000.00'].),\n  (payment_method:TEXT, Method of payment (e.g., check, bank_transfer, credit_card). Value examples: ['bank_transfer', 'check', 'bank_transfer', 'credit_card'].),\n  (invoice_number:VARCHAR, Invoice number associated with the payment. Value examples: ['INV-001', 'INV-002', 'INV-003', 'INV-004'].),\n  (invoice_date:DATE, Date of the invoice. Value examples: ['2023-02-25', '2023-03-05', '2023-03-01', '2023-03-15'].),\n  (due_date:DATE, Due date of the invoice. Value examples: ['2023-03-25', '2023-04-04', '2023-03-31', '2023-04-14'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment made record was created.),\n]\n\n【Foreign keys】\n\n【参考信息】\nTo ascertain the volume of sales conducted by each salesperson over a recent period, merge the salespersons and sales tables, applying a filter for recent sales transactions.\nTo determine the average duration from sale date to payment date, perform a join between the sales and payments tables\nTo calculate the average selling price, join the sales and products tables, group by product name, and compute the ratio of total sales amount to the number of sales\nMoM change = (current month value - prev month value). Return months with no payments as 0.\n\n【用户问题】\nWhat is the total payments received per month? Also calculate the MoM change for each month.\n\n```sql",
        "role": "user"
      },
      {
        "content": "WITH monthly_totals AS (SELECT DATE_TRUNC('month', payment_date) AS dt, SUM(payment_amount) AS total_payments FROM payments_received GROUP BY dt), monthly_range AS (SELECT generate_series(DATE_TRUNC('month', MIN(payment_date)), DATE_TRUNC('month', MAX(payment_date)), '1 month'::interval) AS dt FROM payments_received), monthly_totals_with_zero AS (SELECT mr.dt, COALESCE(mt.total_payments, 0) AS total_payments FROM monthly_range mr LEFT JOIN monthly_totals mt ON mr.dt = mt.dt) SELECT m.dt::DATE AS MONTH, m.total_payments, m.total_payments - lag(m.total_payments, 1) OVER (ORDER BY dt) AS mom_change FROM monthly_totals_with_zero m ORDER BY m.dt;WITH monthly_payments AS (SELECT DATE_TRUNC('month', pr.payment_date) AS MONTH, SUM(pr.payment_amount) AS total_payments FROM payments_received pr GROUP BY MONTH ORDER BY MONTH), monthly_range AS (SELECT generate_series(DATE_TRUNC('month', MIN(pr.payment_date)), DATE_TRUNC('month', MAX(pr.payment_date)), '1 month'::interval) AS MONTH FROM payments_received pr), monthly_payments_with_zeros AS (SELECT mr.month, COALESCE(mp.total_payments, 0) AS total_payments FROM monthly_range mr LEFT JOIN monthly_payments mp ON mr.month = mp.month) SELECT mp.month, mp.total_payments, COALESCE(mp.total_payments - lag(mp.total_payments, 1) OVER (ORDER BY mp.month), 0) AS mom_change FROM monthly_payments_with_zeros mp ORDER BY mp.month;",
        "role": "assistant"
      }
    ],
    "db_name": "car_dealership",
    "id": 261,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the PMSPS and PMSR in the last 6 months excluding the current month, for salespersons hired between 2022 and 2023 (both inclusive)? Include months where metrics are 0. Order by month ascending.\n\n【数据库schema】\n【DB_ID】 car_dealership\n【Schema】\n# Table: cars\n[\n  (id:SERIAL, Primary key for the cars table.),\n  (make:TEXT, Manufacturer of the car. Value examples: ['Toyota', 'Honda'].),\n  (model:TEXT, Model name of the car. Value examples: ['Camry', 'Civic'].),\n  (year:INTEGER, Year of manufacture. Value examples: ['2022', '2021'].),\n  (color:TEXT, Color of the car. Value examples: ['Silver', 'platinum/grey'].),\n  (vin_number:VARCHAR, Vehicle Identification Number. Value examples: ['4T1BF1FK3CU510984', '2HGFC2F53MH522780'].),\n  (engine_type:TEXT, Type of engine (e.g., V6, V8, Electric). Value examples: ['V6', 'Inline 4'].),\n  (transmission:TEXT, Type of transmission (e.g., Automatic, Manual). Value examples: ['Automatic', 'CVT'].),\n  (price:NUMERIC, Selling price of the car. Value examples: ['28500.00', '22000.00'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the car was added to the system.),\n]\n# Table: salespersons\n[\n  (id:SERIAL, Unique identifier for each salesperson.),\n  (first_name:TEXT, Value examples: ['Sarah', 'Daniel', 'Olivia'].),\n  (last_name:TEXT, Value examples: ['Taylor', 'Anderson', 'Thomas'].),\n  (email:VARCHAR, Value examples: ['sarah.taylor@sonicauto.com', 'daniel.anderson@sonicauto.com', 'olivia.thomas@pensake.com'].),\n  (phone:VARCHAR, First 3 digits in brackets is the area code. Format: (123)-456-7890. Value examples: ['(123)-555-6666', '(555)-777-8888', '(333)-415-0000'].),\n  (hire_date:DATE, Value examples: ['2018-09-01', '2021-07-12', '2023-01-25'].),\n  (termination_date:DATE,),\n  (crtd_ts:TIMESTAMP, Timestamp when the salesperson record was created.),\n]\n# Table: customers\n[\n  (id:SERIAL, Primary key for the customers table.),\n  (first_name:TEXT,),\n  (last_name:TEXT,),\n  (email:VARCHAR,),\n  (phone:VARCHAR,),\n  (address:TEXT,),\n  (city:TEXT,),\n  (state:TEXT,),\n  (zip_code:VARCHAR,),\n  (crtd_ts:TIMESTAMP, Timestamp when the customer record was created.),\n]\n# Table: sales\n[\n  (id:SERIAL, Primary key that uniquely identifies each sale.),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '3', '6', '8'].),\n  (salesperson_id:INTEGER, Foreign key referencing the salespersons table. Value examples: ['2', '1', '4', '7'].),\n  (customer_id:INTEGER, Foreign key referencing the customers table. Value examples: ['3', '5', '2', '9'].),\n  (sale_price:NUMERIC, Price at which the car was sold. Value examples: ['27500.00', '44000.00', '24500.00', '38000.00'].),\n  (sale_date:DATE, Date when the car was sold. Value examples: ['2023-03-15', '2023-03-20', '2023-03-22', '2023-03-25'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the sale record was created.),\n]\n# Table: inventory_snapshots\n[\n  (id:SERIAL, Primary key for the inventory_snapshots table.),\n  (snapshot_date:DATE, Date of the inventory snapshot. Value examples: ['2023-03-15', '2023-03-15', '2023-03-15'].),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '2', '3'].),\n  (is_in_inventory:BOOLEAN, Indicates if the car was in inventory on the snapshot date. Value examples: ['TRUE', 'TRUE', 'TRUE'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the inventory snapshot record was created.),\n]\n# Table: payments_received\n[\n  (id:SERIAL, Uniquely identifies each payment received record.),\n  (sale_id:INTEGER, Foreign key referencing the sales table. Value examples: ['1', '1'].),\n  (payment_date:DATE, Date when the payment was received. Can take place after the sale date, or in installments.. Value examples: ['2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment received. Can be less than the sale price if the payment is made in installments.. Value examples: ['5000.00', '22500.00'].),\n  (payment_method:TEXT, Method of payment (e.g., cash, check, card, banktrf, trp01). Value examples: ['check', 'financing'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment received record was created.),\n]\n# Table: payments_made\n[\n  (id:SERIAL, Primary key for the payments_made table.),\n  (vendor_name:TEXT, Name of the vendor to whom the payment was made. Value examples: ['Car Manufacturer Inc', 'Auto Parts Supplier', 'Utility Company', 'Marketing Agency'].),\n  (payment_date:DATE, Date when the payment was made. Value examples: ['2023-03-01', '2023-03-10', '2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment made. Value examples: ['150000.00', '25000.00', '1500.00', '10000.00'].),\n  (payment_method:TEXT, Method of payment (e.g., check, bank_transfer, credit_card). Value examples: ['bank_transfer', 'check', 'bank_transfer', 'credit_card'].),\n  (invoice_number:VARCHAR, Invoice number associated with the payment. Value examples: ['INV-001', 'INV-002', 'INV-003', 'INV-004'].),\n  (invoice_date:DATE, Date of the invoice. Value examples: ['2023-02-25', '2023-03-05', '2023-03-01', '2023-03-15'].),\n  (due_date:DATE, Due date of the invoice. Value examples: ['2023-03-25', '2023-04-04', '2023-03-31', '2023-04-14'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment made record was created.),\n]\n\n【Foreign keys】\n\n【参考信息】\nPMSPS = per month salesperson sales count. PMSR = per month sales revenue in dollars. Truncate date to month for aggregation.\nASP = Average Sale Price during a specific timeframe\nTo calculate the average days between a sale date and when the payment was received, join the relevant tables.\nTSC = Total Sales Count for a given period\n\n【用户问题】\nWhat are the PMSPS and PMSR in the last 6 months excluding the current month, for salespersons hired between 2022 and 2023 (both inclusive)? Include months where metrics are 0. Order by month ascending.\n\n```sql",
        "role": "user"
      },
      {
        "content": "WITH date_range AS (SELECT generate_series(date_trunc('month', CURRENT_DATE - interval '6 months'), date_trunc('month', CURRENT_DATE - interval '1 month'), '1 month')::DATE AS month_start), sales_metrics AS (SELECT date_trunc('month', s.sale_date) AS sale_month, COUNT(s.id) AS PMSPS, SUM(s.sale_price) AS PMSR FROM sales s JOIN salespersons sp ON s.salesperson_id = sp.id WHERE EXTRACT(YEAR FROM sp.hire_date) BETWEEN 2022 AND 2023 AND s.sale_date >= date_trunc('month', CURRENT_DATE - interval '6 months') AND s.sale_date < date_trunc('month', CURRENT_DATE) GROUP BY sale_month) SELECT dr.month_start, COALESCE(sm.PMSPS, 0) AS PMSPS, COALESCE(sm.PMSR, 0) AS PMSR FROM date_range dr LEFT JOIN sales_metrics sm ON dr.month_start = sm.sale_month ORDER BY dr.month_start ASC",
        "role": "assistant"
      }
    ],
    "db_name": "car_dealership",
    "id": 262,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many Toyota cars were sold in the last 30 days inclusive of today? Return the number of sales and total revenue.\n\n【数据库schema】\n【DB_ID】 car_dealership\n【Schema】\n# Table: cars\n[\n  (id:SERIAL, Primary key for the cars table.),\n  (make:TEXT, Manufacturer of the car. Value examples: ['Toyota', 'Honda'].),\n  (model:TEXT, Model name of the car. Value examples: ['Camry', 'Civic'].),\n  (year:INTEGER, Year of manufacture. Value examples: ['2022', '2021'].),\n  (color:TEXT, Color of the car. Value examples: ['Silver', 'platinum/grey'].),\n  (vin_number:VARCHAR, Vehicle Identification Number. Value examples: ['4T1BF1FK3CU510984', '2HGFC2F53MH522780'].),\n  (engine_type:TEXT, Type of engine (e.g., V6, V8, Electric). Value examples: ['V6', 'Inline 4'].),\n  (transmission:TEXT, Type of transmission (e.g., Automatic, Manual). Value examples: ['Automatic', 'CVT'].),\n  (price:NUMERIC, Selling price of the car. Value examples: ['28500.00', '22000.00'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the car was added to the system.),\n]\n# Table: salespersons\n[\n  (id:SERIAL, Unique identifier for each salesperson.),\n  (first_name:TEXT, Value examples: ['Sarah', 'Daniel', 'Olivia'].),\n  (last_name:TEXT, Value examples: ['Taylor', 'Anderson', 'Thomas'].),\n  (email:VARCHAR, Value examples: ['sarah.taylor@sonicauto.com', 'daniel.anderson@sonicauto.com', 'olivia.thomas@pensake.com'].),\n  (phone:VARCHAR, First 3 digits in brackets is the area code. Format: (123)-456-7890. Value examples: ['(123)-555-6666', '(555)-777-8888', '(333)-415-0000'].),\n  (hire_date:DATE, Value examples: ['2018-09-01', '2021-07-12', '2023-01-25'].),\n  (termination_date:DATE,),\n  (crtd_ts:TIMESTAMP, Timestamp when the salesperson record was created.),\n]\n# Table: customers\n[\n  (id:SERIAL, Primary key for the customers table.),\n  (first_name:TEXT,),\n  (last_name:TEXT,),\n  (email:VARCHAR,),\n  (phone:VARCHAR,),\n  (address:TEXT,),\n  (city:TEXT,),\n  (state:TEXT,),\n  (zip_code:VARCHAR,),\n  (crtd_ts:TIMESTAMP, Timestamp when the customer record was created.),\n]\n# Table: sales\n[\n  (id:SERIAL, Primary key that uniquely identifies each sale.),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '3', '6', '8'].),\n  (salesperson_id:INTEGER, Foreign key referencing the salespersons table. Value examples: ['2', '1', '4', '7'].),\n  (customer_id:INTEGER, Foreign key referencing the customers table. Value examples: ['3', '5', '2', '9'].),\n  (sale_price:NUMERIC, Price at which the car was sold. Value examples: ['27500.00', '44000.00', '24500.00', '38000.00'].),\n  (sale_date:DATE, Date when the car was sold. Value examples: ['2023-03-15', '2023-03-20', '2023-03-22', '2023-03-25'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the sale record was created.),\n]\n# Table: inventory_snapshots\n[\n  (id:SERIAL, Primary key for the inventory_snapshots table.),\n  (snapshot_date:DATE, Date of the inventory snapshot. Value examples: ['2023-03-15', '2023-03-15', '2023-03-15'].),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '2', '3'].),\n  (is_in_inventory:BOOLEAN, Indicates if the car was in inventory on the snapshot date. Value examples: ['TRUE', 'TRUE', 'TRUE'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the inventory snapshot record was created.),\n]\n# Table: payments_received\n[\n  (id:SERIAL, Uniquely identifies each payment received record.),\n  (sale_id:INTEGER, Foreign key referencing the sales table. Value examples: ['1', '1'].),\n  (payment_date:DATE, Date when the payment was received. Can take place after the sale date, or in installments.. Value examples: ['2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment received. Can be less than the sale price if the payment is made in installments.. Value examples: ['5000.00', '22500.00'].),\n  (payment_method:TEXT, Method of payment (e.g., cash, check, card, banktrf, trp01). Value examples: ['check', 'financing'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment received record was created.),\n]\n# Table: payments_made\n[\n  (id:SERIAL, Primary key for the payments_made table.),\n  (vendor_name:TEXT, Name of the vendor to whom the payment was made. Value examples: ['Car Manufacturer Inc', 'Auto Parts Supplier', 'Utility Company', 'Marketing Agency'].),\n  (payment_date:DATE, Date when the payment was made. Value examples: ['2023-03-01', '2023-03-10', '2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment made. Value examples: ['150000.00', '25000.00', '1500.00', '10000.00'].),\n  (payment_method:TEXT, Method of payment (e.g., check, bank_transfer, credit_card). Value examples: ['bank_transfer', 'check', 'bank_transfer', 'credit_card'].),\n  (invoice_number:VARCHAR, Invoice number associated with the payment. Value examples: ['INV-001', 'INV-002', 'INV-003', 'INV-004'].),\n  (invoice_date:DATE, Date of the invoice. Value examples: ['2023-02-25', '2023-03-05', '2023-03-01', '2023-03-15'].),\n  (due_date:DATE, Due date of the invoice. Value examples: ['2023-03-25', '2023-04-04', '2023-03-31', '2023-04-14'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment made record was created.),\n]\n\n【Foreign keys】\n\n【参考信息】\nTo calculate the average days between sale date and payment received date, join the sales and payments_received tables\nTo get the list of cars that were sold and their sale price, join the cars and sales tables\nLast 30 days = CURRENT_DATE - INTERVAL '30 days' to CURRENT_DATE. Always join sales with cars before using the sales table.\nWhen using car makes, model names, engine_type, and vin_number, match case-insensitively and allow partial matches using LIKE with wildcards.\n\n【用户问题】\nHow many Toyota cars were sold in the last 30 days inclusive of today? Return the number of sales and total revenue.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT COUNT(s.id) AS num_sales, SUM(s.sale_price) AS total_revenue FROM sales s JOIN cars c ON s.car_id = c.id WHERE c.make = 'Toyota' AND s.sale_date BETWEEN CURRENT_DATE - INTERVAL '30 days' AND CURRENT_DATE",
        "role": "assistant"
      }
    ],
    "db_name": "car_dealership",
    "id": 263,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nFor sales with sale price over $30,000, how many payments were received in total and on weekends in each of the last 8 calendar weeks (excluding the current week)? Return the week (as a date), total payments received, and weekend payments received in ascending order.\n\n【数据库schema】\n【DB_ID】 car_dealership\n【Schema】\n# Table: cars\n[\n  (id:SERIAL, Primary key for the cars table.),\n  (make:TEXT, Manufacturer of the car. Value examples: ['Toyota', 'Honda'].),\n  (model:TEXT, Model name of the car. Value examples: ['Camry', 'Civic'].),\n  (year:INTEGER, Year of manufacture. Value examples: ['2022', '2021'].),\n  (color:TEXT, Color of the car. Value examples: ['Silver', 'platinum/grey'].),\n  (vin_number:VARCHAR, Vehicle Identification Number. Value examples: ['4T1BF1FK3CU510984', '2HGFC2F53MH522780'].),\n  (engine_type:TEXT, Type of engine (e.g., V6, V8, Electric). Value examples: ['V6', 'Inline 4'].),\n  (transmission:TEXT, Type of transmission (e.g., Automatic, Manual). Value examples: ['Automatic', 'CVT'].),\n  (price:NUMERIC, Selling price of the car. Value examples: ['28500.00', '22000.00'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the car was added to the system.),\n]\n# Table: salespersons\n[\n  (id:SERIAL, Unique identifier for each salesperson.),\n  (first_name:TEXT, Value examples: ['Sarah', 'Daniel', 'Olivia'].),\n  (last_name:TEXT, Value examples: ['Taylor', 'Anderson', 'Thomas'].),\n  (email:VARCHAR, Value examples: ['sarah.taylor@sonicauto.com', 'daniel.anderson@sonicauto.com', 'olivia.thomas@pensake.com'].),\n  (phone:VARCHAR, First 3 digits in brackets is the area code. Format: (123)-456-7890. Value examples: ['(123)-555-6666', '(555)-777-8888', '(333)-415-0000'].),\n  (hire_date:DATE, Value examples: ['2018-09-01', '2021-07-12', '2023-01-25'].),\n  (termination_date:DATE,),\n  (crtd_ts:TIMESTAMP, Timestamp when the salesperson record was created.),\n]\n# Table: customers\n[\n  (id:SERIAL, Primary key for the customers table.),\n  (first_name:TEXT,),\n  (last_name:TEXT,),\n  (email:VARCHAR,),\n  (phone:VARCHAR,),\n  (address:TEXT,),\n  (city:TEXT,),\n  (state:TEXT,),\n  (zip_code:VARCHAR,),\n  (crtd_ts:TIMESTAMP, Timestamp when the customer record was created.),\n]\n# Table: sales\n[\n  (id:SERIAL, Primary key that uniquely identifies each sale.),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '3', '6', '8'].),\n  (salesperson_id:INTEGER, Foreign key referencing the salespersons table. Value examples: ['2', '1', '4', '7'].),\n  (customer_id:INTEGER, Foreign key referencing the customers table. Value examples: ['3', '5', '2', '9'].),\n  (sale_price:NUMERIC, Price at which the car was sold. Value examples: ['27500.00', '44000.00', '24500.00', '38000.00'].),\n  (sale_date:DATE, Date when the car was sold. Value examples: ['2023-03-15', '2023-03-20', '2023-03-22', '2023-03-25'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the sale record was created.),\n]\n# Table: inventory_snapshots\n[\n  (id:SERIAL, Primary key for the inventory_snapshots table.),\n  (snapshot_date:DATE, Date of the inventory snapshot. Value examples: ['2023-03-15', '2023-03-15', '2023-03-15'].),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '2', '3'].),\n  (is_in_inventory:BOOLEAN, Indicates if the car was in inventory on the snapshot date. Value examples: ['TRUE', 'TRUE', 'TRUE'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the inventory snapshot record was created.),\n]\n# Table: payments_received\n[\n  (id:SERIAL, Uniquely identifies each payment received record.),\n  (sale_id:INTEGER, Foreign key referencing the sales table. Value examples: ['1', '1'].),\n  (payment_date:DATE, Date when the payment was received. Can take place after the sale date, or in installments.. Value examples: ['2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment received. Can be less than the sale price if the payment is made in installments.. Value examples: ['5000.00', '22500.00'].),\n  (payment_method:TEXT, Method of payment (e.g., cash, check, card, banktrf, trp01). Value examples: ['check', 'financing'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment received record was created.),\n]\n# Table: payments_made\n[\n  (id:SERIAL, Primary key for the payments_made table.),\n  (vendor_name:TEXT, Name of the vendor to whom the payment was made. Value examples: ['Car Manufacturer Inc', 'Auto Parts Supplier', 'Utility Company', 'Marketing Agency'].),\n  (payment_date:DATE, Date when the payment was made. Value examples: ['2023-03-01', '2023-03-10', '2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment made. Value examples: ['150000.00', '25000.00', '1500.00', '10000.00'].),\n  (payment_method:TEXT, Method of payment (e.g., check, bank_transfer, credit_card). Value examples: ['bank_transfer', 'check', 'bank_transfer', 'credit_card'].),\n  (invoice_number:VARCHAR, Invoice number associated with the payment. Value examples: ['INV-001', 'INV-002', 'INV-003', 'INV-004'].),\n  (invoice_date:DATE, Date of the invoice. Value examples: ['2023-02-25', '2023-03-05', '2023-03-01', '2023-03-15'].),\n  (due_date:DATE, Due date of the invoice. Value examples: ['2023-03-25', '2023-04-04', '2023-03-31', '2023-04-14'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment made record was created.),\n]\n\n【Foreign keys】\n\n【参考信息】\nTo calculate the average days between sale date and payment received date, join the sales and payments received tables Weekend days are Saturday (6) and Sunday (0). Truncate date to week for aggregation. When using car makes, model names, engine_type and vin_number, match case-insensitively and allow partial matches using LIKE with wildcards. To get the total sales amount per salesperson, join the salespersons and sales tables, group by salesperson, and sum the sale_price\n\n【用户问题】\nFor sales with sale price over $30,000, how many payments were received in total and on weekends in each of the last 8 calendar weeks (excluding the current week)? Return the week (as a date), total payments received, and weekend payments received in ascending order.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT DATE_TRUNC('week', p.payment_date) AS WEEK, COUNT(p.id) AS total_payments, COUNT(CASE WHEN EXTRACT(dow FROM p.payment_date) IN (0, 6) THEN 1 END) AS weekend_payments FROM payments_received p JOIN sales s ON p.sale_id = s.id WHERE s.sale_price > 30000 AND p.payment_date >= DATE_TRUNC('week', CURRENT_DATE) - INTERVAL '8 weeks' AND p.payment_date < DATE_TRUNC('week', CURRENT_DATE) GROUP BY WEEK ORDER BY WEEK",
        "role": "assistant"
      }
    ],
    "db_name": "car_dealership",
    "id": 264,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the make, model and sale price of the car with the highest sale price that was sold on the same day it went out of inventory?\n\n【数据库schema】\n【DB_ID】 car_dealership\n【Schema】\n# Table: cars\n[\n  (id:SERIAL, Primary key for the cars table.),\n  (make:TEXT, Manufacturer of the car. Value examples: ['Toyota', 'Honda'].),\n  (model:TEXT, Model name of the car. Value examples: ['Camry', 'Civic'].),\n  (year:INTEGER, Year of manufacture. Value examples: ['2022', '2021'].),\n  (color:TEXT, Color of the car. Value examples: ['Silver', 'platinum/grey'].),\n  (vin_number:VARCHAR, Vehicle Identification Number. Value examples: ['4T1BF1FK3CU510984', '2HGFC2F53MH522780'].),\n  (engine_type:TEXT, Type of engine (e.g., V6, V8, Electric). Value examples: ['V6', 'Inline 4'].),\n  (transmission:TEXT, Type of transmission (e.g., Automatic, Manual). Value examples: ['Automatic', 'CVT'].),\n  (price:NUMERIC, Selling price of the car. Value examples: ['28500.00', '22000.00'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the car was added to the system.),\n]\n# Table: salespersons\n[\n  (id:SERIAL, Unique identifier for each salesperson.),\n  (first_name:TEXT, Value examples: ['Sarah', 'Daniel', 'Olivia'].),\n  (last_name:TEXT, Value examples: ['Taylor', 'Anderson', 'Thomas'].),\n  (email:VARCHAR, Value examples: ['sarah.taylor@sonicauto.com', 'daniel.anderson@sonicauto.com', 'olivia.thomas@pensake.com'].),\n  (phone:VARCHAR, First 3 digits in brackets is the area code. Format: (123)-456-7890. Value examples: ['(123)-555-6666', '(555)-777-8888', '(333)-415-0000'].),\n  (hire_date:DATE, Value examples: ['2018-09-01', '2021-07-12', '2023-01-25'].),\n  (termination_date:DATE,),\n  (crtd_ts:TIMESTAMP, Timestamp when the salesperson record was created.),\n]\n# Table: customers\n[\n  (id:SERIAL, Primary key for the customers table.),\n  (first_name:TEXT,),\n  (last_name:TEXT,),\n  (email:VARCHAR,),\n  (phone:VARCHAR,),\n  (address:TEXT,),\n  (city:TEXT,),\n  (state:TEXT,),\n  (zip_code:VARCHAR,),\n  (crtd_ts:TIMESTAMP, Timestamp when the customer record was created.),\n]\n# Table: sales\n[\n  (id:SERIAL, Primary key that uniquely identifies each sale.),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '3', '6', '8'].),\n  (salesperson_id:INTEGER, Foreign key referencing the salespersons table. Value examples: ['2', '1', '4', '7'].),\n  (customer_id:INTEGER, Foreign key referencing the customers table. Value examples: ['3', '5', '2', '9'].),\n  (sale_price:NUMERIC, Price at which the car was sold. Value examples: ['27500.00', '44000.00', '24500.00', '38000.00'].),\n  (sale_date:DATE, Date when the car was sold. Value examples: ['2023-03-15', '2023-03-20', '2023-03-22', '2023-03-25'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the sale record was created.),\n]\n# Table: inventory_snapshots\n[\n  (id:SERIAL, Primary key for the inventory_snapshots table.),\n  (snapshot_date:DATE, Date of the inventory snapshot. Value examples: ['2023-03-15', '2023-03-15', '2023-03-15'].),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '2', '3'].),\n  (is_in_inventory:BOOLEAN, Indicates if the car was in inventory on the snapshot date. Value examples: ['TRUE', 'TRUE', 'TRUE'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the inventory snapshot record was created.),\n]\n# Table: payments_received\n[\n  (id:SERIAL, Uniquely identifies each payment received record.),\n  (sale_id:INTEGER, Foreign key referencing the sales table. Value examples: ['1', '1'].),\n  (payment_date:DATE, Date when the payment was received. Can take place after the sale date, or in installments.. Value examples: ['2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment received. Can be less than the sale price if the payment is made in installments.. Value examples: ['5000.00', '22500.00'].),\n  (payment_method:TEXT, Method of payment (e.g., cash, check, card, banktrf, trp01). Value examples: ['check', 'financing'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment received record was created.),\n]\n# Table: payments_made\n[\n  (id:SERIAL, Primary key for the payments_made table.),\n  (vendor_name:TEXT, Name of the vendor to whom the payment was made. Value examples: ['Car Manufacturer Inc', 'Auto Parts Supplier', 'Utility Company', 'Marketing Agency'].),\n  (payment_date:DATE, Date when the payment was made. Value examples: ['2023-03-01', '2023-03-10', '2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment made. Value examples: ['150000.00', '25000.00', '1500.00', '10000.00'].),\n  (payment_method:TEXT, Method of payment (e.g., check, bank_transfer, credit_card). Value examples: ['bank_transfer', 'check', 'bank_transfer', 'credit_card'].),\n  (invoice_number:VARCHAR, Invoice number associated with the payment. Value examples: ['INV-001', 'INV-002', 'INV-003', 'INV-004'].),\n  (invoice_date:DATE, Date of the invoice. Value examples: ['2023-02-25', '2023-03-05', '2023-03-01', '2023-03-15'].),\n  (due_date:DATE, Due date of the invoice. Value examples: ['2023-03-25', '2023-04-04', '2023-03-31', '2023-04-14'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment made record was created.),\n]\n\n【Foreign keys】\n\n【参考信息】\nASP (average selling price) = total sales amount / number of sales\nTo calculate the gross profit margin, join the appropriate tables and calculate the margin\nIf inventory snapshots and sales from the same day are to be joined, join on the truncated date fields eg FROM inventory_snapshots i JOIN sales s ON DATE_TRUNC('day', i.snapshot_date) = DATE_TRUNC('day', s.sale_date).\nTo rank salespersons by their sales volume, join the salespersons and sales data, order by sales volume.\n\nSo, the rephrased instructions would be: \"GPM (gross profit margin) = (total revenue - total cost) / total cost * 100\nTo determine the average sale price, join the sales data and calculate the average\nSR = sales rank of each salesperson ordered by their total sales amount descending.\"\n\n【用户问题】\nWhat is the make, model and sale price of the car with the highest sale price that was sold on the same day it went out of inventory?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT c.make, c.model, s.sale_price FROM cars c JOIN sales s ON c.id = s.car_id JOIN inventory_snapshots i ON c.id = i.car_id AND DATE_TRUNC('day', s.sale_date) = DATE_TRUNC('day', i.snapshot_date) WHERE i.is_in_inventory = FALSE ORDER BY s.sale_price DESC LIMIT 1",
        "role": "assistant"
      }
    ],
    "db_name": "car_dealership",
    "id": 265,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the details and average sale price for cars that have 'Ford' in their make name or 'Mustang' in the model name? Return make, model, year, color, vin_number and avg_sale_price.\n\n【数据库schema】\n【DB_ID】 car_dealership\n【Schema】\n# Table: cars\n[\n  (id:SERIAL, Primary key for the cars table.),\n  (make:TEXT, Manufacturer of the car. Value examples: ['Toyota', 'Honda'].),\n  (model:TEXT, Model name of the car. Value examples: ['Camry', 'Civic'].),\n  (year:INTEGER, Year of manufacture. Value examples: ['2022', '2021'].),\n  (color:TEXT, Color of the car. Value examples: ['Silver', 'platinum/grey'].),\n  (vin_number:VARCHAR, Vehicle Identification Number. Value examples: ['4T1BF1FK3CU510984', '2HGFC2F53MH522780'].),\n  (engine_type:TEXT, Type of engine (e.g., V6, V8, Electric). Value examples: ['V6', 'Inline 4'].),\n  (transmission:TEXT, Type of transmission (e.g., Automatic, Manual). Value examples: ['Automatic', 'CVT'].),\n  (price:NUMERIC, Selling price of the car. Value examples: ['28500.00', '22000.00'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the car was added to the system.),\n]\n# Table: salespersons\n[\n  (id:SERIAL, Unique identifier for each salesperson.),\n  (first_name:TEXT, Value examples: ['Sarah', 'Daniel', 'Olivia'].),\n  (last_name:TEXT, Value examples: ['Taylor', 'Anderson', 'Thomas'].),\n  (email:VARCHAR, Value examples: ['sarah.taylor@sonicauto.com', 'daniel.anderson@sonicauto.com', 'olivia.thomas@pensake.com'].),\n  (phone:VARCHAR, First 3 digits in brackets is the area code. Format: (123)-456-7890. Value examples: ['(123)-555-6666', '(555)-777-8888', '(333)-415-0000'].),\n  (hire_date:DATE, Value examples: ['2018-09-01', '2021-07-12', '2023-01-25'].),\n  (termination_date:DATE,),\n  (crtd_ts:TIMESTAMP, Timestamp when the salesperson record was created.),\n]\n# Table: customers\n[\n  (id:SERIAL, Primary key for the customers table.),\n  (first_name:TEXT,),\n  (last_name:TEXT,),\n  (email:VARCHAR,),\n  (phone:VARCHAR,),\n  (address:TEXT,),\n  (city:TEXT,),\n  (state:TEXT,),\n  (zip_code:VARCHAR,),\n  (crtd_ts:TIMESTAMP, Timestamp when the customer record was created.),\n]\n# Table: sales\n[\n  (id:SERIAL, Primary key that uniquely identifies each sale.),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '3', '6', '8'].),\n  (salesperson_id:INTEGER, Foreign key referencing the salespersons table. Value examples: ['2', '1', '4', '7'].),\n  (customer_id:INTEGER, Foreign key referencing the customers table. Value examples: ['3', '5', '2', '9'].),\n  (sale_price:NUMERIC, Price at which the car was sold. Value examples: ['27500.00', '44000.00', '24500.00', '38000.00'].),\n  (sale_date:DATE, Date when the car was sold. Value examples: ['2023-03-15', '2023-03-20', '2023-03-22', '2023-03-25'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the sale record was created.),\n]\n# Table: inventory_snapshots\n[\n  (id:SERIAL, Primary key for the inventory_snapshots table.),\n  (snapshot_date:DATE, Date of the inventory snapshot. Value examples: ['2023-03-15', '2023-03-15', '2023-03-15'].),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '2', '3'].),\n  (is_in_inventory:BOOLEAN, Indicates if the car was in inventory on the snapshot date. Value examples: ['TRUE', 'TRUE', 'TRUE'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the inventory snapshot record was created.),\n]\n# Table: payments_received\n[\n  (id:SERIAL, Uniquely identifies each payment received record.),\n  (sale_id:INTEGER, Foreign key referencing the sales table. Value examples: ['1', '1'].),\n  (payment_date:DATE, Date when the payment was received. Can take place after the sale date, or in installments.. Value examples: ['2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment received. Can be less than the sale price if the payment is made in installments.. Value examples: ['5000.00', '22500.00'].),\n  (payment_method:TEXT, Method of payment (e.g., cash, check, card, banktrf, trp01). Value examples: ['check', 'financing'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment received record was created.),\n]\n# Table: payments_made\n[\n  (id:SERIAL, Primary key for the payments_made table.),\n  (vendor_name:TEXT, Name of the vendor to whom the payment was made. Value examples: ['Car Manufacturer Inc', 'Auto Parts Supplier', 'Utility Company', 'Marketing Agency'].),\n  (payment_date:DATE, Date when the payment was made. Value examples: ['2023-03-01', '2023-03-10', '2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment made. Value examples: ['150000.00', '25000.00', '1500.00', '10000.00'].),\n  (payment_method:TEXT, Method of payment (e.g., check, bank_transfer, credit_card). Value examples: ['bank_transfer', 'check', 'bank_transfer', 'credit_card'].),\n  (invoice_number:VARCHAR, Invoice number associated with the payment. Value examples: ['INV-001', 'INV-002', 'INV-003', 'INV-004'].),\n  (invoice_date:DATE, Date of the invoice. Value examples: ['2023-02-25', '2023-03-05', '2023-03-01', '2023-03-15'].),\n  (due_date:DATE, Due date of the invoice. Value examples: ['2023-03-25', '2023-04-04', '2023-03-31', '2023-04-14'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment made record was created.),\n]\n\n【Foreign keys】\n\n【参考信息】\nTo calculate the gross profit margin, use the formula where GPM is the quotient of total revenue minus total cost over total cost, multiplied by 100 When using car makes, model names, engine_type and vin_number, match case-insensitively and allow partial matches using LIKE with wildcards. To compute the average sales price, divide the total sales amount by the number of sales To determine the sales rank of each salesperson, order by their total sales amount in descending order.\n\n【用户问题】\nWhat are the details and average sale price for cars that have 'Ford' in their make name or 'Mustang' in the model name? Return make, model, year, color, vin_number and avg_sale_price.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT c.make, c.model, c.year, c.color, c.vin_number, AVG(s.sale_price) AS avg_sale_price FROM cars c JOIN sales s ON c.id = s.car_id WHERE LOWER(c.make) LIKE '%ford%' OR LOWER(c.model) LIKE '%mustang%' GROUP BY c.make, c.model, c.year, c.color, c.vin_number",
        "role": "assistant"
      }
    ],
    "db_name": "car_dealership",
    "id": 266,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many sales were made for each car model that has 'M5' in its VIN number? Return the make, model and number of sales.\n\n【数据库schema】\n【DB_ID】 car_dealership\n【Schema】\n# Table: cars\n[\n  (id:SERIAL, Primary key for the cars table.),\n  (make:TEXT, Manufacturer of the car. Value examples: ['Toyota', 'Honda'].),\n  (model:TEXT, Model name of the car. Value examples: ['Camry', 'Civic'].),\n  (year:INTEGER, Year of manufacture. Value examples: ['2022', '2021'].),\n  (color:TEXT, Color of the car. Value examples: ['Silver', 'platinum/grey'].),\n  (vin_number:VARCHAR, Vehicle Identification Number. Value examples: ['4T1BF1FK3CU510984', '2HGFC2F53MH522780'].),\n  (engine_type:TEXT, Type of engine (e.g., V6, V8, Electric). Value examples: ['V6', 'Inline 4'].),\n  (transmission:TEXT, Type of transmission (e.g., Automatic, Manual). Value examples: ['Automatic', 'CVT'].),\n  (price:NUMERIC, Selling price of the car. Value examples: ['28500.00', '22000.00'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the car was added to the system.),\n]\n# Table: salespersons\n[\n  (id:SERIAL, Unique identifier for each salesperson.),\n  (first_name:TEXT, Value examples: ['Sarah', 'Daniel', 'Olivia'].),\n  (last_name:TEXT, Value examples: ['Taylor', 'Anderson', 'Thomas'].),\n  (email:VARCHAR, Value examples: ['sarah.taylor@sonicauto.com', 'daniel.anderson@sonicauto.com', 'olivia.thomas@pensake.com'].),\n  (phone:VARCHAR, First 3 digits in brackets is the area code. Format: (123)-456-7890. Value examples: ['(123)-555-6666', '(555)-777-8888', '(333)-415-0000'].),\n  (hire_date:DATE, Value examples: ['2018-09-01', '2021-07-12', '2023-01-25'].),\n  (termination_date:DATE,),\n  (crtd_ts:TIMESTAMP, Timestamp when the salesperson record was created.),\n]\n# Table: customers\n[\n  (id:SERIAL, Primary key for the customers table.),\n  (first_name:TEXT,),\n  (last_name:TEXT,),\n  (email:VARCHAR,),\n  (phone:VARCHAR,),\n  (address:TEXT,),\n  (city:TEXT,),\n  (state:TEXT,),\n  (zip_code:VARCHAR,),\n  (crtd_ts:TIMESTAMP, Timestamp when the customer record was created.),\n]\n# Table: sales\n[\n  (id:SERIAL, Primary key that uniquely identifies each sale.),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '3', '6', '8'].),\n  (salesperson_id:INTEGER, Foreign key referencing the salespersons table. Value examples: ['2', '1', '4', '7'].),\n  (customer_id:INTEGER, Foreign key referencing the customers table. Value examples: ['3', '5', '2', '9'].),\n  (sale_price:NUMERIC, Price at which the car was sold. Value examples: ['27500.00', '44000.00', '24500.00', '38000.00'].),\n  (sale_date:DATE, Date when the car was sold. Value examples: ['2023-03-15', '2023-03-20', '2023-03-22', '2023-03-25'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the sale record was created.),\n]\n# Table: inventory_snapshots\n[\n  (id:SERIAL, Primary key for the inventory_snapshots table.),\n  (snapshot_date:DATE, Date of the inventory snapshot. Value examples: ['2023-03-15', '2023-03-15', '2023-03-15'].),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '2', '3'].),\n  (is_in_inventory:BOOLEAN, Indicates if the car was in inventory on the snapshot date. Value examples: ['TRUE', 'TRUE', 'TRUE'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the inventory snapshot record was created.),\n]\n# Table: payments_received\n[\n  (id:SERIAL, Uniquely identifies each payment received record.),\n  (sale_id:INTEGER, Foreign key referencing the sales table. Value examples: ['1', '1'].),\n  (payment_date:DATE, Date when the payment was received. Can take place after the sale date, or in installments.. Value examples: ['2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment received. Can be less than the sale price if the payment is made in installments.. Value examples: ['5000.00', '22500.00'].),\n  (payment_method:TEXT, Method of payment (e.g., cash, check, card, banktrf, trp01). Value examples: ['check', 'financing'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment received record was created.),\n]\n# Table: payments_made\n[\n  (id:SERIAL, Primary key for the payments_made table.),\n  (vendor_name:TEXT, Name of the vendor to whom the payment was made. Value examples: ['Car Manufacturer Inc', 'Auto Parts Supplier', 'Utility Company', 'Marketing Agency'].),\n  (payment_date:DATE, Date when the payment was made. Value examples: ['2023-03-01', '2023-03-10', '2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment made. Value examples: ['150000.00', '25000.00', '1500.00', '10000.00'].),\n  (payment_method:TEXT, Method of payment (e.g., check, bank_transfer, credit_card). Value examples: ['bank_transfer', 'check', 'bank_transfer', 'credit_card'].),\n  (invoice_number:VARCHAR, Invoice number associated with the payment. Value examples: ['INV-001', 'INV-002', 'INV-003', 'INV-004'].),\n  (invoice_date:DATE, Date of the invoice. Value examples: ['2023-02-25', '2023-03-05', '2023-03-01', '2023-03-15'].),\n  (due_date:DATE, Due date of the invoice. Value examples: ['2023-03-25', '2023-04-04', '2023-03-31', '2023-04-14'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment made record was created.),\n]\n\n【Foreign keys】\n\n【参考信息】\nTo determine the total sales amount for each salesperson, combine data from the salespersons and sales tables, grouping by salesperson and summing the sale_price\nWhen using car makes, model names, engine_type and vin_number, match case-insensitively and allow partial matches using LIKE with wildcards.\nTo calculate the average selling price, join the sales and cars tables, and divide the total sales amount by the number of sales\nFor understanding the number of sales achieved by each salesperson within a specified period, merge the salespersons and sales tables and apply a filter based on the given time frame.\n\n【用户问题】\nHow many sales were made for each car model that has 'M5' in its VIN number? Return the make, model and number of sales.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT c.make, c.model, COUNT(s.id) AS num_sales FROM cars c LEFT JOIN sales s ON c.id = s.car_id WHERE LOWER(c.vin_number) LIKE '%m5%' GROUP BY c.make, c.model",
        "role": "assistant"
      }
    ],
    "db_name": "car_dealership",
    "id": 267,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the TSC in the past 7 days, inclusive of today?\n\n【数据库schema】\n【DB_ID】 car_dealership\n【Schema】\n# Table: cars\n[\n  (id:SERIAL, Primary key for the cars table.),\n  (make:TEXT, Manufacturer of the car. Value examples: ['Toyota', 'Honda'].),\n  (model:TEXT, Model name of the car. Value examples: ['Camry', 'Civic'].),\n  (year:INTEGER, Year of manufacture. Value examples: ['2022', '2021'].),\n  (color:TEXT, Color of the car. Value examples: ['Silver', 'platinum/grey'].),\n  (vin_number:VARCHAR, Vehicle Identification Number. Value examples: ['4T1BF1FK3CU510984', '2HGFC2F53MH522780'].),\n  (engine_type:TEXT, Type of engine (e.g., V6, V8, Electric). Value examples: ['V6', 'Inline 4'].),\n  (transmission:TEXT, Type of transmission (e.g., Automatic, Manual). Value examples: ['Automatic', 'CVT'].),\n  (price:NUMERIC, Selling price of the car. Value examples: ['28500.00', '22000.00'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the car was added to the system.),\n]\n# Table: salespersons\n[\n  (id:SERIAL, Unique identifier for each salesperson.),\n  (first_name:TEXT, Value examples: ['Sarah', 'Daniel', 'Olivia'].),\n  (last_name:TEXT, Value examples: ['Taylor', 'Anderson', 'Thomas'].),\n  (email:VARCHAR, Value examples: ['sarah.taylor@sonicauto.com', 'daniel.anderson@sonicauto.com', 'olivia.thomas@pensake.com'].),\n  (phone:VARCHAR, First 3 digits in brackets is the area code. Format: (123)-456-7890. Value examples: ['(123)-555-6666', '(555)-777-8888', '(333)-415-0000'].),\n  (hire_date:DATE, Value examples: ['2018-09-01', '2021-07-12', '2023-01-25'].),\n  (termination_date:DATE,),\n  (crtd_ts:TIMESTAMP, Timestamp when the salesperson record was created.),\n]\n# Table: customers\n[\n  (id:SERIAL, Primary key for the customers table.),\n  (first_name:TEXT,),\n  (last_name:TEXT,),\n  (email:VARCHAR,),\n  (phone:VARCHAR,),\n  (address:TEXT,),\n  (city:TEXT,),\n  (state:TEXT,),\n  (zip_code:VARCHAR,),\n  (crtd_ts:TIMESTAMP, Timestamp when the customer record was created.),\n]\n# Table: sales\n[\n  (id:SERIAL, Primary key that uniquely identifies each sale.),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '3', '6', '8'].),\n  (salesperson_id:INTEGER, Foreign key referencing the salespersons table. Value examples: ['2', '1', '4', '7'].),\n  (customer_id:INTEGER, Foreign key referencing the customers table. Value examples: ['3', '5', '2', '9'].),\n  (sale_price:NUMERIC, Price at which the car was sold. Value examples: ['27500.00', '44000.00', '24500.00', '38000.00'].),\n  (sale_date:DATE, Date when the car was sold. Value examples: ['2023-03-15', '2023-03-20', '2023-03-22', '2023-03-25'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the sale record was created.),\n]\n# Table: inventory_snapshots\n[\n  (id:SERIAL, Primary key for the inventory_snapshots table.),\n  (snapshot_date:DATE, Date of the inventory snapshot. Value examples: ['2023-03-15', '2023-03-15', '2023-03-15'].),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '2', '3'].),\n  (is_in_inventory:BOOLEAN, Indicates if the car was in inventory on the snapshot date. Value examples: ['TRUE', 'TRUE', 'TRUE'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the inventory snapshot record was created.),\n]\n# Table: payments_received\n[\n  (id:SERIAL, Uniquely identifies each payment received record.),\n  (sale_id:INTEGER, Foreign key referencing the sales table. Value examples: ['1', '1'].),\n  (payment_date:DATE, Date when the payment was received. Can take place after the sale date, or in installments.. Value examples: ['2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment received. Can be less than the sale price if the payment is made in installments.. Value examples: ['5000.00', '22500.00'].),\n  (payment_method:TEXT, Method of payment (e.g., cash, check, card, banktrf, trp01). Value examples: ['check', 'financing'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment received record was created.),\n]\n# Table: payments_made\n[\n  (id:SERIAL, Primary key for the payments_made table.),\n  (vendor_name:TEXT, Name of the vendor to whom the payment was made. Value examples: ['Car Manufacturer Inc', 'Auto Parts Supplier', 'Utility Company', 'Marketing Agency'].),\n  (payment_date:DATE, Date when the payment was made. Value examples: ['2023-03-01', '2023-03-10', '2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment made. Value examples: ['150000.00', '25000.00', '1500.00', '10000.00'].),\n  (payment_method:TEXT, Method of payment (e.g., check, bank_transfer, credit_card). Value examples: ['bank_transfer', 'check', 'bank_transfer', 'credit_card'].),\n  (invoice_number:VARCHAR, Invoice number associated with the payment. Value examples: ['INV-001', 'INV-002', 'INV-003', 'INV-004'].),\n  (invoice_date:DATE, Date of the invoice. Value examples: ['2023-02-25', '2023-03-05', '2023-03-01', '2023-03-15'].),\n  (due_date:DATE, Due date of the invoice. Value examples: ['2023-03-25', '2023-04-04', '2023-03-31', '2023-04-14'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment made record was created.),\n]\n\n【Foreign keys】\n\n【参考信息】\nTo determine the average selling price, divide the total sales amount by the number of sales\nTo calculate the gross profit margin, subtract the total cost from the total revenue, then divide by the total cost and multiply by 100\nTo ascertain the sales rank of each salesperson, order them by their total sales amount in descending order.\nTSC = Total Sales Count.\n\n【用户问题】\nWhat is the TSC in the past 7 days, inclusive of today?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT COUNT(id) AS TSC FROM sales WHERE sale_date >= CURRENT_DATE - INTERVAL '7 days'",
        "role": "assistant"
      }
    ],
    "db_name": "car_dealership",
    "id": 268,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the ASP for sales made in the first quarter of 2023?\n\n【数据库schema】\n【DB_ID】 car_dealership\n【Schema】\n# Table: cars\n[\n  (id:SERIAL, Primary key for the cars table.),\n  (make:TEXT, Manufacturer of the car. Value examples: ['Toyota', 'Honda'].),\n  (model:TEXT, Model name of the car. Value examples: ['Camry', 'Civic'].),\n  (year:INTEGER, Year of manufacture. Value examples: ['2022', '2021'].),\n  (color:TEXT, Color of the car. Value examples: ['Silver', 'platinum/grey'].),\n  (vin_number:VARCHAR, Vehicle Identification Number. Value examples: ['4T1BF1FK3CU510984', '2HGFC2F53MH522780'].),\n  (engine_type:TEXT, Type of engine (e.g., V6, V8, Electric). Value examples: ['V6', 'Inline 4'].),\n  (transmission:TEXT, Type of transmission (e.g., Automatic, Manual). Value examples: ['Automatic', 'CVT'].),\n  (price:NUMERIC, Selling price of the car. Value examples: ['28500.00', '22000.00'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the car was added to the system.),\n]\n# Table: salespersons\n[\n  (id:SERIAL, Unique identifier for each salesperson.),\n  (first_name:TEXT, Value examples: ['Sarah', 'Daniel', 'Olivia'].),\n  (last_name:TEXT, Value examples: ['Taylor', 'Anderson', 'Thomas'].),\n  (email:VARCHAR, Value examples: ['sarah.taylor@sonicauto.com', 'daniel.anderson@sonicauto.com', 'olivia.thomas@pensake.com'].),\n  (phone:VARCHAR, First 3 digits in brackets is the area code. Format: (123)-456-7890. Value examples: ['(123)-555-6666', '(555)-777-8888', '(333)-415-0000'].),\n  (hire_date:DATE, Value examples: ['2018-09-01', '2021-07-12', '2023-01-25'].),\n  (termination_date:DATE,),\n  (crtd_ts:TIMESTAMP, Timestamp when the salesperson record was created.),\n]\n# Table: customers\n[\n  (id:SERIAL, Primary key for the customers table.),\n  (first_name:TEXT,),\n  (last_name:TEXT,),\n  (email:VARCHAR,),\n  (phone:VARCHAR,),\n  (address:TEXT,),\n  (city:TEXT,),\n  (state:TEXT,),\n  (zip_code:VARCHAR,),\n  (crtd_ts:TIMESTAMP, Timestamp when the customer record was created.),\n]\n# Table: sales\n[\n  (id:SERIAL, Primary key that uniquely identifies each sale.),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '3', '6', '8'].),\n  (salesperson_id:INTEGER, Foreign key referencing the salespersons table. Value examples: ['2', '1', '4', '7'].),\n  (customer_id:INTEGER, Foreign key referencing the customers table. Value examples: ['3', '5', '2', '9'].),\n  (sale_price:NUMERIC, Price at which the car was sold. Value examples: ['27500.00', '44000.00', '24500.00', '38000.00'].),\n  (sale_date:DATE, Date when the car was sold. Value examples: ['2023-03-15', '2023-03-20', '2023-03-22', '2023-03-25'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the sale record was created.),\n]\n# Table: inventory_snapshots\n[\n  (id:SERIAL, Primary key for the inventory_snapshots table.),\n  (snapshot_date:DATE, Date of the inventory snapshot. Value examples: ['2023-03-15', '2023-03-15', '2023-03-15'].),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '2', '3'].),\n  (is_in_inventory:BOOLEAN, Indicates if the car was in inventory on the snapshot date. Value examples: ['TRUE', 'TRUE', 'TRUE'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the inventory snapshot record was created.),\n]\n# Table: payments_received\n[\n  (id:SERIAL, Uniquely identifies each payment received record.),\n  (sale_id:INTEGER, Foreign key referencing the sales table. Value examples: ['1', '1'].),\n  (payment_date:DATE, Date when the payment was received. Can take place after the sale date, or in installments.. Value examples: ['2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment received. Can be less than the sale price if the payment is made in installments.. Value examples: ['5000.00', '22500.00'].),\n  (payment_method:TEXT, Method of payment (e.g., cash, check, card, banktrf, trp01). Value examples: ['check', 'financing'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment received record was created.),\n]\n# Table: payments_made\n[\n  (id:SERIAL, Primary key for the payments_made table.),\n  (vendor_name:TEXT, Name of the vendor to whom the payment was made. Value examples: ['Car Manufacturer Inc', 'Auto Parts Supplier', 'Utility Company', 'Marketing Agency'].),\n  (payment_date:DATE, Date when the payment was made. Value examples: ['2023-03-01', '2023-03-10', '2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment made. Value examples: ['150000.00', '25000.00', '1500.00', '10000.00'].),\n  (payment_method:TEXT, Method of payment (e.g., check, bank_transfer, credit_card). Value examples: ['bank_transfer', 'check', 'bank_transfer', 'credit_card'].),\n  (invoice_number:VARCHAR, Invoice number associated with the payment. Value examples: ['INV-001', 'INV-002', 'INV-003', 'INV-004'].),\n  (invoice_date:DATE, Date of the invoice. Value examples: ['2023-02-25', '2023-03-05', '2023-03-01', '2023-03-15'].),\n  (due_date:DATE, Due date of the invoice. Value examples: ['2023-03-25', '2023-04-04', '2023-03-31', '2023-04-14'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment made record was created.),\n]\n\n【Foreign keys】\n\n【参考信息】\nAlways join sales with cars before using the sales table. ASP = Average Sale Price in the first quarter of 2023. To calculate the average days between sale date and payment received date, join the sales and payments tables To get the list of cars that were sold along with their sale prices, join the cars and sales tables Last 30 days = CURRENT_DATE - INTERVAL 'last month' days to CURRENT_DATE\n\n【用户问题】\nWhat is the ASP for sales made in the first quarter of 2023?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT AVG(sale_price) AS ASP FROM sales WHERE sale_date >= '2023-01-01' AND sale_date <= '2023-03-31'",
        "role": "assistant"
      }
    ],
    "db_name": "car_dealership",
    "id": 269,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWho are the top 3 salespersons by ASP? Return their first name, last name and ASP.\n\n【数据库schema】\n【DB_ID】 car_dealership\n【Schema】\n# Table: cars\n[\n  (id:SERIAL, Primary key for the cars table.),\n  (make:TEXT, Manufacturer of the car. Value examples: ['Toyota', 'Honda'].),\n  (model:TEXT, Model name of the car. Value examples: ['Camry', 'Civic'].),\n  (year:INTEGER, Year of manufacture. Value examples: ['2022', '2021'].),\n  (color:TEXT, Color of the car. Value examples: ['Silver', 'platinum/grey'].),\n  (vin_number:VARCHAR, Vehicle Identification Number. Value examples: ['4T1BF1FK3CU510984', '2HGFC2F53MH522780'].),\n  (engine_type:TEXT, Type of engine (e.g., V6, V8, Electric). Value examples: ['V6', 'Inline 4'].),\n  (transmission:TEXT, Type of transmission (e.g., Automatic, Manual). Value examples: ['Automatic', 'CVT'].),\n  (price:NUMERIC, Selling price of the car. Value examples: ['28500.00', '22000.00'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the car was added to the system.),\n]\n# Table: salespersons\n[\n  (id:SERIAL, Unique identifier for each salesperson.),\n  (first_name:TEXT, Value examples: ['Sarah', 'Daniel', 'Olivia'].),\n  (last_name:TEXT, Value examples: ['Taylor', 'Anderson', 'Thomas'].),\n  (email:VARCHAR, Value examples: ['sarah.taylor@sonicauto.com', 'daniel.anderson@sonicauto.com', 'olivia.thomas@pensake.com'].),\n  (phone:VARCHAR, First 3 digits in brackets is the area code. Format: (123)-456-7890. Value examples: ['(123)-555-6666', '(555)-777-8888', '(333)-415-0000'].),\n  (hire_date:DATE, Value examples: ['2018-09-01', '2021-07-12', '2023-01-25'].),\n  (termination_date:DATE,),\n  (crtd_ts:TIMESTAMP, Timestamp when the salesperson record was created.),\n]\n# Table: customers\n[\n  (id:SERIAL, Primary key for the customers table.),\n  (first_name:TEXT,),\n  (last_name:TEXT,),\n  (email:VARCHAR,),\n  (phone:VARCHAR,),\n  (address:TEXT,),\n  (city:TEXT,),\n  (state:TEXT,),\n  (zip_code:VARCHAR,),\n  (crtd_ts:TIMESTAMP, Timestamp when the customer record was created.),\n]\n# Table: sales\n[\n  (id:SERIAL, Primary key that uniquely identifies each sale.),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '3', '6', '8'].),\n  (salesperson_id:INTEGER, Foreign key referencing the salespersons table. Value examples: ['2', '1', '4', '7'].),\n  (customer_id:INTEGER, Foreign key referencing the customers table. Value examples: ['3', '5', '2', '9'].),\n  (sale_price:NUMERIC, Price at which the car was sold. Value examples: ['27500.00', '44000.00', '24500.00', '38000.00'].),\n  (sale_date:DATE, Date when the car was sold. Value examples: ['2023-03-15', '2023-03-20', '2023-03-22', '2023-03-25'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the sale record was created.),\n]\n# Table: inventory_snapshots\n[\n  (id:SERIAL, Primary key for the inventory_snapshots table.),\n  (snapshot_date:DATE, Date of the inventory snapshot. Value examples: ['2023-03-15', '2023-03-15', '2023-03-15'].),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '2', '3'].),\n  (is_in_inventory:BOOLEAN, Indicates if the car was in inventory on the snapshot date. Value examples: ['TRUE', 'TRUE', 'TRUE'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the inventory snapshot record was created.),\n]\n# Table: payments_received\n[\n  (id:SERIAL, Uniquely identifies each payment received record.),\n  (sale_id:INTEGER, Foreign key referencing the sales table. Value examples: ['1', '1'].),\n  (payment_date:DATE, Date when the payment was received. Can take place after the sale date, or in installments.. Value examples: ['2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment received. Can be less than the sale price if the payment is made in installments.. Value examples: ['5000.00', '22500.00'].),\n  (payment_method:TEXT, Method of payment (e.g., cash, check, card, banktrf, trp01). Value examples: ['check', 'financing'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment received record was created.),\n]\n# Table: payments_made\n[\n  (id:SERIAL, Primary key for the payments_made table.),\n  (vendor_name:TEXT, Name of the vendor to whom the payment was made. Value examples: ['Car Manufacturer Inc', 'Auto Parts Supplier', 'Utility Company', 'Marketing Agency'].),\n  (payment_date:DATE, Date when the payment was made. Value examples: ['2023-03-01', '2023-03-10', '2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment made. Value examples: ['150000.00', '25000.00', '1500.00', '10000.00'].),\n  (payment_method:TEXT, Method of payment (e.g., check, bank_transfer, credit_card). Value examples: ['bank_transfer', 'check', 'bank_transfer', 'credit_card'].),\n  (invoice_number:VARCHAR, Invoice number associated with the payment. Value examples: ['INV-001', 'INV-002', 'INV-003', 'INV-004'].),\n  (invoice_date:DATE, Date of the invoice. Value examples: ['2023-02-25', '2023-03-05', '2023-03-01', '2023-03-15'].),\n  (due_date:DATE, Due date of the invoice. Value examples: ['2023-03-25', '2023-04-04', '2023-03-31', '2023-04-14'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment made record was created.),\n]\n\n【Foreign keys】\n\n【参考信息】\nTo get the total sales amount per salesperson, join the salespersons and sales tables, group by salesperson, and sum the sale_amount. To calculate the average days between the sale date and payment received date, join the sales and payments_received tables. ASP (average selling price) = total sales amount / number of sales. To get the list of cars that were sold and their sale price, join the cars and sales tables.\n\n【用户问题】\nWho are the top 3 salespersons by ASP? Return their first name, last name and ASP.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT salespersons.first_name, salespersons.last_name, AVG(sales.sale_price) AS ASP FROM sales JOIN salespersons ON sales.salesperson_id = salespersons.id GROUP BY salespersons.first_name, salespersons.last_name ORDER BY ASP DESC NULLS LAST LIMIT 3",
        "role": "assistant"
      }
    ],
    "db_name": "car_dealership",
    "id": 270,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the GPM for all car sales in 2023?\n\n【数据库schema】\n【DB_ID】 car_dealership\n【Schema】\n# Table: cars\n[\n  (id:SERIAL, Primary key for the cars table.),\n  (make:TEXT, Manufacturer of the car. Value examples: ['Toyota', 'Honda'].),\n  (model:TEXT, Model name of the car. Value examples: ['Camry', 'Civic'].),\n  (year:INTEGER, Year of manufacture. Value examples: ['2022', '2021'].),\n  (color:TEXT, Color of the car. Value examples: ['Silver', 'platinum/grey'].),\n  (vin_number:VARCHAR, Vehicle Identification Number. Value examples: ['4T1BF1FK3CU510984', '2HGFC2F53MH522780'].),\n  (engine_type:TEXT, Type of engine (e.g., V6, V8, Electric). Value examples: ['V6', 'Inline 4'].),\n  (transmission:TEXT, Type of transmission (e.g., Automatic, Manual). Value examples: ['Automatic', 'CVT'].),\n  (price:NUMERIC, Selling price of the car. Value examples: ['28500.00', '22000.00'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the car was added to the system.),\n]\n# Table: salespersons\n[\n  (id:SERIAL, Unique identifier for each salesperson.),\n  (first_name:TEXT, Value examples: ['Sarah', 'Daniel', 'Olivia'].),\n  (last_name:TEXT, Value examples: ['Taylor', 'Anderson', 'Thomas'].),\n  (email:VARCHAR, Value examples: ['sarah.taylor@sonicauto.com', 'daniel.anderson@sonicauto.com', 'olivia.thomas@pensake.com'].),\n  (phone:VARCHAR, First 3 digits in brackets is the area code. Format: (123)-456-7890. Value examples: ['(123)-555-6666', '(555)-777-8888', '(333)-415-0000'].),\n  (hire_date:DATE, Value examples: ['2018-09-01', '2021-07-12', '2023-01-25'].),\n  (termination_date:DATE,),\n  (crtd_ts:TIMESTAMP, Timestamp when the salesperson record was created.),\n]\n# Table: customers\n[\n  (id:SERIAL, Primary key for the customers table.),\n  (first_name:TEXT,),\n  (last_name:TEXT,),\n  (email:VARCHAR,),\n  (phone:VARCHAR,),\n  (address:TEXT,),\n  (city:TEXT,),\n  (state:TEXT,),\n  (zip_code:VARCHAR,),\n  (crtd_ts:TIMESTAMP, Timestamp when the customer record was created.),\n]\n# Table: sales\n[\n  (id:SERIAL, Primary key that uniquely identifies each sale.),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '3', '6', '8'].),\n  (salesperson_id:INTEGER, Foreign key referencing the salespersons table. Value examples: ['2', '1', '4', '7'].),\n  (customer_id:INTEGER, Foreign key referencing the customers table. Value examples: ['3', '5', '2', '9'].),\n  (sale_price:NUMERIC, Price at which the car was sold. Value examples: ['27500.00', '44000.00', '24500.00', '38000.00'].),\n  (sale_date:DATE, Date when the car was sold. Value examples: ['2023-03-15', '2023-03-20', '2023-03-22', '2023-03-25'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the sale record was created.),\n]\n# Table: inventory_snapshots\n[\n  (id:SERIAL, Primary key for the inventory_snapshots table.),\n  (snapshot_date:DATE, Date of the inventory snapshot. Value examples: ['2023-03-15', '2023-03-15', '2023-03-15'].),\n  (car_id:INTEGER, Foreign key referencing the cars table. Value examples: ['1', '2', '3'].),\n  (is_in_inventory:BOOLEAN, Indicates if the car was in inventory on the snapshot date. Value examples: ['TRUE', 'TRUE', 'TRUE'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the inventory snapshot record was created.),\n]\n# Table: payments_received\n[\n  (id:SERIAL, Uniquely identifies each payment received record.),\n  (sale_id:INTEGER, Foreign key referencing the sales table. Value examples: ['1', '1'].),\n  (payment_date:DATE, Date when the payment was received. Can take place after the sale date, or in installments.. Value examples: ['2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment received. Can be less than the sale price if the payment is made in installments.. Value examples: ['5000.00', '22500.00'].),\n  (payment_method:TEXT, Method of payment (e.g., cash, check, card, banktrf, trp01). Value examples: ['check', 'financing'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment received record was created.),\n]\n# Table: payments_made\n[\n  (id:SERIAL, Primary key for the payments_made table.),\n  (vendor_name:TEXT, Name of the vendor to whom the payment was made. Value examples: ['Car Manufacturer Inc', 'Auto Parts Supplier', 'Utility Company', 'Marketing Agency'].),\n  (payment_date:DATE, Date when the payment was made. Value examples: ['2023-03-01', '2023-03-10', '2023-03-15', '2023-03-20'].),\n  (payment_amount:NUMERIC, Amount of the payment made. Value examples: ['150000.00', '25000.00', '1500.00', '10000.00'].),\n  (payment_method:TEXT, Method of payment (e.g., check, bank_transfer, credit_card). Value examples: ['bank_transfer', 'check', 'bank_transfer', 'credit_card'].),\n  (invoice_number:VARCHAR, Invoice number associated with the payment. Value examples: ['INV-001', 'INV-002', 'INV-003', 'INV-004'].),\n  (invoice_date:DATE, Date of the invoice. Value examples: ['2023-02-25', '2023-03-05', '2023-03-01', '2023-03-15'].),\n  (due_date:DATE, Due date of the invoice. Value examples: ['2023-03-25', '2023-04-04', '2023-03-31', '2023-04-14'].),\n  (crtd_ts:TIMESTAMP, Timestamp when the payment made record was created.),\n]\n\n【Foreign keys】\n\n【参考信息】\nAnalyze salesperson activity over a selected period by connecting salespersons with sales records\nGPM (gross profit margin) = (total revenue - total cost) / total cost * 100\nFor weekly trends, consider the start of the week\nTo calculate the TSC = Total Sales Count within a given period\nIdentify sold vehicles and pricing by linking car and sales data\nMoM = assess the month-over-month change in total financial transactions\nSR = sales rank of each salesperson based on their total sales without specifying the order\nUtilize LIKE for flexible matching in vehicle information queries.\nUse inventory and sales data for concurrent analysis, ensuring date alignment\nTo summarize sales performance, combine sales and salesperson data, focusing on total sales\nPMSPS and PMSR aim to measure salesperson engagement and monthly revenue, respectively\nFor insights on sale to payment duration, correlate sales with payment dates\nTo find the ASP = Average Sale Price for a specific time frame\nFor timing analysis, apply specific date intervals\n\n【用户问题】\nWhat is the GPM for all car sales in 2023?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT (SUM(sale_price) - SUM(cars.price)) / SUM(cars.price) * 100 AS gpm FROM sales JOIN cars ON sales.car_id = cars.id WHERE EXTRACT(YEAR FROM sale_date) = 2023",
        "role": "assistant"
      }
    ],
    "db_name": "car_dealership",
    "id": 271,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich states do doctors who have prescribed biologic drugs reside in? Return the distinct states.\n\n【数据库schema】\n【DB_ID】 derm_treatment\n【Schema】\n# Table: doctors\n[\n  (doc_id:SERIAL,),\n  (first_name:VARCHAR,),\n  (last_name:VARCHAR,),\n  (specialty:TEXT, possible values: dermatology, immunology, general.),\n  (year_reg:INT, year the doctor was registered and obtained license.),\n  (med_school_name:VARCHAR,),\n  (loc_city:VARCHAR,),\n  (loc_state:CHAR,),\n  (loc_zip:VARCHAR,),\n  (bd_cert_num:VARCHAR, board certification number.),\n]\n# Table: patients\n[\n  (patient_id:SERIAL,),\n  (first_name:VARCHAR, Value examples: ['Alice', 'Bob'].),\n  (last_name:VARCHAR, Value examples: ['Johnson', 'Smith'].),\n  (date_of_birth:DATE, Value examples: ['1985-03-15', '1978-11-23'].),\n  (date_of_registration:DATE, Value examples: ['2023-01-03', '2023-01-10'].),\n  (gender:VARCHAR, Male, Female, Others. Value examples: ['Female', 'Male'].),\n  (email:VARCHAR, Value examples: ['alice@email.com', 'bob@email.com'].),\n  (phone:VARCHAR, Value examples: ['555-123-4567', '555-987-6543'].),\n  (addr_street:VARCHAR, Value examples: ['123 Main St', '456 Oak Ave'].),\n  (addr_city:VARCHAR, Value examples: ['Anytown', 'Somecity'].),\n  (addr_state:CHAR, Value examples: ['CA', 'NY'].),\n  (addr_zip:VARCHAR, Value examples: ['12345', '54321'].),\n  (ins_type:TEXT, Insurance type. Possible values: private, medicare, medicaid, uninsured. Value examples: ['private', 'medicare'].),\n  (ins_policy_num:VARCHAR, Insurance policy number. Value examples: ['ABC123456', 'XYZ789012'].),\n  (height_cm:FLOAT, Value examples: ['165', '180'].),\n  (weight_kg:FLOAT, Value examples: ['60', '85'].),\n]\n# Table: drugs\n[\n  (drug_id:SERIAL,),\n  (drug_name:VARCHAR, Value examples: ['Drugalin', 'Medicol'].),\n  (manufacturer:VARCHAR, Value examples: ['Pharma Inc', 'Acme Pharma'].),\n  (drug_type:TEXT, possible values: biologic, small molecule, topical. Value examples: ['biologic', 'small molecule'].),\n  (moa:TEXT, mechanism of action. Value examples: ['TNF-alpha inhibitor', 'IL-17A inhibitor'].),\n  (fda_appr_dt:DATE, FDA approval date. NULL if drug is still under trial.. Value examples: ['2010-01-15', '2015-06-30'].),\n  (admin_route:TEXT, possible values: oral, injection, topical. Value examples: ['injection', 'oral'].),\n  (dos_amt:DECIMAL, recommended dosage amount. Value examples: ['40', '30'].),\n  (dos_unit:VARCHAR, recommended dosage unit. Value examples: ['mg', 'mg'].),\n  (dos_freq_hrs:INT, recommended number of hours between dosages. Value examples: ['336', '24'].),\n  (ndc:VARCHAR, National Drug Code. Value examples: ['12345-678-90', '54321-012-34'].),\n]\n# Table: diagnoses\n[\n  (diag_id:SERIAL,),\n  (diag_code:VARCHAR, Value examples: ['L40.1', 'L40.51'].),\n  (diag_name:VARCHAR, Value examples: ['Generalized pustular psoriasis', 'Distal interphalangeal psoriatic arthropathy'].),\n  (diag_desc:TEXT, Value examples: ['Widespread pustules on top of red skin', 'Psoriatic arthritis mainly affecting the ends of fingers and toes'].),\n]\n# Table: treatments\n[\n  (treatment_id:SERIAL,),\n  (patient_id:INT,),\n  (doc_id:INT,),\n  (drug_id:INT,),\n  (diag_id:INT,),\n  (start_dt:DATE,),\n  (end_dt:DATE, NULL if treatment is ongoing.),\n  (is_placebo:BOOLEAN,),\n  (tot_drug_amt:DECIMAL,),\n  (drug_unit:TEXT, possible values: mg, ml, g.),\n]\n# Table: outcomes\n[\n  (outcome_id:SERIAL,),\n  (treatment_id:INT, Value examples: ['1', '2', '3', '4'].),\n  (assess_dt:DATE, Value examples: ['2022-01-08', '2022-02-22', '2022-03-17', '2022-04-08'].),\n  (day7_lesion_cnt:INT, lesion counts on day 7.. Value examples: ['20', '25', '18', '30'].),\n  (day30_lesion_cnt:INT, Value examples: ['15', '18', '12', '25'].),\n  (day100_lesion_cnt:INT, Value examples: ['5', '8', '3', '12'].),\n  (day7_pasi_score:DECIMAL, PASI score range 0-72. Value examples: ['12.5', '15.0', '10.8', '18.2'].),\n  (day30_pasi_score:DECIMAL, Value examples: ['8.2', '10.1', '6.4', '13.9'].),\n  (day100_pasi_score:DECIMAL, Value examples: ['2.1', '3.5', '1.2', '5.8'].),\n  (day7_tewl:DECIMAL, in g/m^2/h. Value examples: ['18.2', '20.1', '16.5', '22.4'].),\n  (day30_tewl:DECIMAL, Value examples: ['15.6', '17.2', '14.0', '19.1'].),\n  (day100_tewl:DECIMAL, Value examples: ['12.1', '13.5', '10.8', '15.2'].),\n  (day7_itch_vas:INT, visual analog scale 0-100. Value examples: ['60', '70', '55', '80'].),\n  (day30_itch_vas:INT, Value examples: ['40', '50', '35', '60'].),\n  (day100_itch_vas:INT, Value examples: ['20', '30', '15', '40'].),\n  (day7_hfg:DECIMAL, hair growth factor range 0-5. Value examples: ['1.5', '1.0', '2.0', '0.5'].),\n  (day30_hfg:DECIMAL, Value examples: ['2.5', '2.0', '3.0', '1.5'].),\n  (day100_hfg:DECIMAL, Value examples: ['4.0', '3.5', '4.5', '3.0'].),\n]\n# Table: adverse_events\n[\n  (id:SERIAL, 1 row per adverse event per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '5'].),\n  (reported_dt:DATE, Value examples: ['2022-01-15', '2022-05-20'].),\n  (description:TEXT, Value examples: ['Mild injection site reaction', 'Upper respiratory infection'].),\n]\n# Table: concomitant_meds\n[\n  (id:SERIAL, 1 row per med per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '1', '2', '3'].),\n  (med_name:VARCHAR, Value examples: ['Acetaminophen', 'Ibuprofen', 'Loratadine', 'Multivitamin'].),\n  (start_dt:TEXT, YYYY-MM-DD. Value examples: ['2022-01-01', '2022-01-08', '2022-02-15', '2022-03-10'].),\n  (end_dt:TEXT, YYYY-MM-DD NULL if still taking. Value examples: ['2022-01-07', '2022-01-14', '2022-03-15', 'NULL'].),\n  (dose_amt:DECIMAL, Value examples: ['500', '200', '10', '1'].),\n  (dose_unit:TEXT, possible values: mg, ml, g. Value examples: ['mg', 'mg', 'mg', 'tablet'].),\n  (freq_hrs:INT, Value examples: ['6', '8', '24', '24'].),\n]\n\n【Foreign keys】\n\n【参考信息】\nAWF = average weight for male patients TPC = total count of female patients Each of these metrics, while providing valuable insights for other analyses, would not alter the scope or outcome of the provided SQL query aimed at identifying states with doctors who have prescribed biologic drugs. PMPD = counts of patient diagnoses per month To identify doctors who have prescribed a certain drug type and their respective states, first join doctors with treatments on doc_id, then filter by the drug type.\n\n【用户问题】\nWhich states do doctors who have prescribed biologic drugs reside in? Return the distinct states.\n\n```sql",
        "role": "user"
      },
      {
        "content": "WITH doctor_treatment AS (SELECT d.doc_id, d.loc_state FROM doctors d JOIN treatments t ON d.doc_id = t.doc_id JOIN drugs dr ON t.drug_id = dr.drug_id WHERE dr.drug_type = 'biologic') SELECT DISTINCT loc_state FROM doctor_treatment",
        "role": "assistant"
      }
    ],
    "db_name": "derm_treatment",
    "id": 272,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the average weight in kg of patients treated with the drug named 'Drugalin'? Return the average weight.\n\n【数据库schema】\n【DB_ID】 derm_treatment\n【Schema】\n# Table: doctors\n[\n  (doc_id:SERIAL,),\n  (first_name:VARCHAR,),\n  (last_name:VARCHAR,),\n  (specialty:TEXT, possible values: dermatology, immunology, general.),\n  (year_reg:INT, year the doctor was registered and obtained license.),\n  (med_school_name:VARCHAR,),\n  (loc_city:VARCHAR,),\n  (loc_state:CHAR,),\n  (loc_zip:VARCHAR,),\n  (bd_cert_num:VARCHAR, board certification number.),\n]\n# Table: patients\n[\n  (patient_id:SERIAL,),\n  (first_name:VARCHAR, Value examples: ['Alice', 'Bob'].),\n  (last_name:VARCHAR, Value examples: ['Johnson', 'Smith'].),\n  (date_of_birth:DATE, Value examples: ['1985-03-15', '1978-11-23'].),\n  (date_of_registration:DATE, Value examples: ['2023-01-03', '2023-01-10'].),\n  (gender:VARCHAR, Male, Female, Others. Value examples: ['Female', 'Male'].),\n  (email:VARCHAR, Value examples: ['alice@email.com', 'bob@email.com'].),\n  (phone:VARCHAR, Value examples: ['555-123-4567', '555-987-6543'].),\n  (addr_street:VARCHAR, Value examples: ['123 Main St', '456 Oak Ave'].),\n  (addr_city:VARCHAR, Value examples: ['Anytown', 'Somecity'].),\n  (addr_state:CHAR, Value examples: ['CA', 'NY'].),\n  (addr_zip:VARCHAR, Value examples: ['12345', '54321'].),\n  (ins_type:TEXT, Insurance type. Possible values: private, medicare, medicaid, uninsured. Value examples: ['private', 'medicare'].),\n  (ins_policy_num:VARCHAR, Insurance policy number. Value examples: ['ABC123456', 'XYZ789012'].),\n  (height_cm:FLOAT, Value examples: ['165', '180'].),\n  (weight_kg:FLOAT, Value examples: ['60', '85'].),\n]\n# Table: drugs\n[\n  (drug_id:SERIAL,),\n  (drug_name:VARCHAR, Value examples: ['Drugalin', 'Medicol'].),\n  (manufacturer:VARCHAR, Value examples: ['Pharma Inc', 'Acme Pharma'].),\n  (drug_type:TEXT, possible values: biologic, small molecule, topical. Value examples: ['biologic', 'small molecule'].),\n  (moa:TEXT, mechanism of action. Value examples: ['TNF-alpha inhibitor', 'IL-17A inhibitor'].),\n  (fda_appr_dt:DATE, FDA approval date. NULL if drug is still under trial.. Value examples: ['2010-01-15', '2015-06-30'].),\n  (admin_route:TEXT, possible values: oral, injection, topical. Value examples: ['injection', 'oral'].),\n  (dos_amt:DECIMAL, recommended dosage amount. Value examples: ['40', '30'].),\n  (dos_unit:VARCHAR, recommended dosage unit. Value examples: ['mg', 'mg'].),\n  (dos_freq_hrs:INT, recommended number of hours between dosages. Value examples: ['336', '24'].),\n  (ndc:VARCHAR, National Drug Code. Value examples: ['12345-678-90', '54321-012-34'].),\n]\n# Table: diagnoses\n[\n  (diag_id:SERIAL,),\n  (diag_code:VARCHAR, Value examples: ['L40.1', 'L40.51'].),\n  (diag_name:VARCHAR, Value examples: ['Generalized pustular psoriasis', 'Distal interphalangeal psoriatic arthropathy'].),\n  (diag_desc:TEXT, Value examples: ['Widespread pustules on top of red skin', 'Psoriatic arthritis mainly affecting the ends of fingers and toes'].),\n]\n# Table: treatments\n[\n  (treatment_id:SERIAL,),\n  (patient_id:INT,),\n  (doc_id:INT,),\n  (drug_id:INT,),\n  (diag_id:INT,),\n  (start_dt:DATE,),\n  (end_dt:DATE, NULL if treatment is ongoing.),\n  (is_placebo:BOOLEAN,),\n  (tot_drug_amt:DECIMAL,),\n  (drug_unit:TEXT, possible values: mg, ml, g.),\n]\n# Table: outcomes\n[\n  (outcome_id:SERIAL,),\n  (treatment_id:INT, Value examples: ['1', '2', '3', '4'].),\n  (assess_dt:DATE, Value examples: ['2022-01-08', '2022-02-22', '2022-03-17', '2022-04-08'].),\n  (day7_lesion_cnt:INT, lesion counts on day 7.. Value examples: ['20', '25', '18', '30'].),\n  (day30_lesion_cnt:INT, Value examples: ['15', '18', '12', '25'].),\n  (day100_lesion_cnt:INT, Value examples: ['5', '8', '3', '12'].),\n  (day7_pasi_score:DECIMAL, PASI score range 0-72. Value examples: ['12.5', '15.0', '10.8', '18.2'].),\n  (day30_pasi_score:DECIMAL, Value examples: ['8.2', '10.1', '6.4', '13.9'].),\n  (day100_pasi_score:DECIMAL, Value examples: ['2.1', '3.5', '1.2', '5.8'].),\n  (day7_tewl:DECIMAL, in g/m^2/h. Value examples: ['18.2', '20.1', '16.5', '22.4'].),\n  (day30_tewl:DECIMAL, Value examples: ['15.6', '17.2', '14.0', '19.1'].),\n  (day100_tewl:DECIMAL, Value examples: ['12.1', '13.5', '10.8', '15.2'].),\n  (day7_itch_vas:INT, visual analog scale 0-100. Value examples: ['60', '70', '55', '80'].),\n  (day30_itch_vas:INT, Value examples: ['40', '50', '35', '60'].),\n  (day100_itch_vas:INT, Value examples: ['20', '30', '15', '40'].),\n  (day7_hfg:DECIMAL, hair growth factor range 0-5. Value examples: ['1.5', '1.0', '2.0', '0.5'].),\n  (day30_hfg:DECIMAL, Value examples: ['2.5', '2.0', '3.0', '1.5'].),\n  (day100_hfg:DECIMAL, Value examples: ['4.0', '3.5', '4.5', '3.0'].),\n]\n# Table: adverse_events\n[\n  (id:SERIAL, 1 row per adverse event per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '5'].),\n  (reported_dt:DATE, Value examples: ['2022-01-15', '2022-05-20'].),\n  (description:TEXT, Value examples: ['Mild injection site reaction', 'Upper respiratory infection'].),\n]\n# Table: concomitant_meds\n[\n  (id:SERIAL, 1 row per med per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '1', '2', '3'].),\n  (med_name:VARCHAR, Value examples: ['Acetaminophen', 'Ibuprofen', 'Loratadine', 'Multivitamin'].),\n  (start_dt:TEXT, YYYY-MM-DD. Value examples: ['2022-01-01', '2022-01-08', '2022-02-15', '2022-03-10'].),\n  (end_dt:TEXT, YYYY-MM-DD NULL if still taking. Value examples: ['2022-01-07', '2022-01-14', '2022-03-15', 'NULL'].),\n  (dose_amt:DECIMAL, Value examples: ['500', '200', '10', '1'].),\n  (dose_unit:TEXT, possible values: mg, ml, g. Value examples: ['mg', 'mg', 'mg', 'tablet'].),\n  (freq_hrs:INT, Value examples: ['6', '8', '24', '24'].),\n]\n\n【Foreign keys】\n\n【参考信息】\nTo find the average weight of patients treated with a specific drug, first join patients with treatments on patient_id, then filter by the drug name.\nPMPD = Determine the number of diagnoses made for patients each month.\nDDD = Compute the overall consumed medication amount divided by the total number of treatment days\nAWF = Calculate the average weight in kilograms for patients identified as male\n\n【用户问题】\nWhat is the average weight in kg of patients treated with the drug named 'Drugalin'? Return the average weight.\n\n```sql",
        "role": "user"
      },
      {
        "content": "WITH patient_treatment AS (SELECT p.patient_id, p.weight_kg FROM patients p JOIN treatments t ON p.patient_id = t.patient_id WHERE t.drug_id = (SELECT drug_id FROM drugs WHERE drug_name = 'Drugalin')) SELECT AVG(weight_kg) FROM patient_treatment",
        "role": "assistant"
      }
    ],
    "db_name": "derm_treatment",
    "id": 273,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nI want the adverse events that have been reported for treatments involving topical drugs. Give me the description, treatment id, drug id and name.\n\n【数据库schema】\n【DB_ID】 derm_treatment\n【Schema】\n# Table: doctors\n[\n  (doc_id:SERIAL,),\n  (first_name:VARCHAR,),\n  (last_name:VARCHAR,),\n  (specialty:TEXT, possible values: dermatology, immunology, general.),\n  (year_reg:INT, year the doctor was registered and obtained license.),\n  (med_school_name:VARCHAR,),\n  (loc_city:VARCHAR,),\n  (loc_state:CHAR,),\n  (loc_zip:VARCHAR,),\n  (bd_cert_num:VARCHAR, board certification number.),\n]\n# Table: patients\n[\n  (patient_id:SERIAL,),\n  (first_name:VARCHAR, Value examples: ['Alice', 'Bob'].),\n  (last_name:VARCHAR, Value examples: ['Johnson', 'Smith'].),\n  (date_of_birth:DATE, Value examples: ['1985-03-15', '1978-11-23'].),\n  (date_of_registration:DATE, Value examples: ['2023-01-03', '2023-01-10'].),\n  (gender:VARCHAR, Male, Female, Others. Value examples: ['Female', 'Male'].),\n  (email:VARCHAR, Value examples: ['alice@email.com', 'bob@email.com'].),\n  (phone:VARCHAR, Value examples: ['555-123-4567', '555-987-6543'].),\n  (addr_street:VARCHAR, Value examples: ['123 Main St', '456 Oak Ave'].),\n  (addr_city:VARCHAR, Value examples: ['Anytown', 'Somecity'].),\n  (addr_state:CHAR, Value examples: ['CA', 'NY'].),\n  (addr_zip:VARCHAR, Value examples: ['12345', '54321'].),\n  (ins_type:TEXT, Insurance type. Possible values: private, medicare, medicaid, uninsured. Value examples: ['private', 'medicare'].),\n  (ins_policy_num:VARCHAR, Insurance policy number. Value examples: ['ABC123456', 'XYZ789012'].),\n  (height_cm:FLOAT, Value examples: ['165', '180'].),\n  (weight_kg:FLOAT, Value examples: ['60', '85'].),\n]\n# Table: drugs\n[\n  (drug_id:SERIAL,),\n  (drug_name:VARCHAR, Value examples: ['Drugalin', 'Medicol'].),\n  (manufacturer:VARCHAR, Value examples: ['Pharma Inc', 'Acme Pharma'].),\n  (drug_type:TEXT, possible values: biologic, small molecule, topical. Value examples: ['biologic', 'small molecule'].),\n  (moa:TEXT, mechanism of action. Value examples: ['TNF-alpha inhibitor', 'IL-17A inhibitor'].),\n  (fda_appr_dt:DATE, FDA approval date. NULL if drug is still under trial.. Value examples: ['2010-01-15', '2015-06-30'].),\n  (admin_route:TEXT, possible values: oral, injection, topical. Value examples: ['injection', 'oral'].),\n  (dos_amt:DECIMAL, recommended dosage amount. Value examples: ['40', '30'].),\n  (dos_unit:VARCHAR, recommended dosage unit. Value examples: ['mg', 'mg'].),\n  (dos_freq_hrs:INT, recommended number of hours between dosages. Value examples: ['336', '24'].),\n  (ndc:VARCHAR, National Drug Code. Value examples: ['12345-678-90', '54321-012-34'].),\n]\n# Table: diagnoses\n[\n  (diag_id:SERIAL,),\n  (diag_code:VARCHAR, Value examples: ['L40.1', 'L40.51'].),\n  (diag_name:VARCHAR, Value examples: ['Generalized pustular psoriasis', 'Distal interphalangeal psoriatic arthropathy'].),\n  (diag_desc:TEXT, Value examples: ['Widespread pustules on top of red skin', 'Psoriatic arthritis mainly affecting the ends of fingers and toes'].),\n]\n# Table: treatments\n[\n  (treatment_id:SERIAL,),\n  (patient_id:INT,),\n  (doc_id:INT,),\n  (drug_id:INT,),\n  (diag_id:INT,),\n  (start_dt:DATE,),\n  (end_dt:DATE, NULL if treatment is ongoing.),\n  (is_placebo:BOOLEAN,),\n  (tot_drug_amt:DECIMAL,),\n  (drug_unit:TEXT, possible values: mg, ml, g.),\n]\n# Table: outcomes\n[\n  (outcome_id:SERIAL,),\n  (treatment_id:INT, Value examples: ['1', '2', '3', '4'].),\n  (assess_dt:DATE, Value examples: ['2022-01-08', '2022-02-22', '2022-03-17', '2022-04-08'].),\n  (day7_lesion_cnt:INT, lesion counts on day 7.. Value examples: ['20', '25', '18', '30'].),\n  (day30_lesion_cnt:INT, Value examples: ['15', '18', '12', '25'].),\n  (day100_lesion_cnt:INT, Value examples: ['5', '8', '3', '12'].),\n  (day7_pasi_score:DECIMAL, PASI score range 0-72. Value examples: ['12.5', '15.0', '10.8', '18.2'].),\n  (day30_pasi_score:DECIMAL, Value examples: ['8.2', '10.1', '6.4', '13.9'].),\n  (day100_pasi_score:DECIMAL, Value examples: ['2.1', '3.5', '1.2', '5.8'].),\n  (day7_tewl:DECIMAL, in g/m^2/h. Value examples: ['18.2', '20.1', '16.5', '22.4'].),\n  (day30_tewl:DECIMAL, Value examples: ['15.6', '17.2', '14.0', '19.1'].),\n  (day100_tewl:DECIMAL, Value examples: ['12.1', '13.5', '10.8', '15.2'].),\n  (day7_itch_vas:INT, visual analog scale 0-100. Value examples: ['60', '70', '55', '80'].),\n  (day30_itch_vas:INT, Value examples: ['40', '50', '35', '60'].),\n  (day100_itch_vas:INT, Value examples: ['20', '30', '15', '40'].),\n  (day7_hfg:DECIMAL, hair growth factor range 0-5. Value examples: ['1.5', '1.0', '2.0', '0.5'].),\n  (day30_hfg:DECIMAL, Value examples: ['2.5', '2.0', '3.0', '1.5'].),\n  (day100_hfg:DECIMAL, Value examples: ['4.0', '3.5', '4.5', '3.0'].),\n]\n# Table: adverse_events\n[\n  (id:SERIAL, 1 row per adverse event per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '5'].),\n  (reported_dt:DATE, Value examples: ['2022-01-15', '2022-05-20'].),\n  (description:TEXT, Value examples: ['Mild injection site reaction', 'Upper respiratory infection'].),\n]\n# Table: concomitant_meds\n[\n  (id:SERIAL, 1 row per med per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '1', '2', '3'].),\n  (med_name:VARCHAR, Value examples: ['Acetaminophen', 'Ibuprofen', 'Loratadine', 'Multivitamin'].),\n  (start_dt:TEXT, YYYY-MM-DD. Value examples: ['2022-01-01', '2022-01-08', '2022-02-15', '2022-03-10'].),\n  (end_dt:TEXT, YYYY-MM-DD NULL if still taking. Value examples: ['2022-01-07', '2022-01-14', '2022-03-15', 'NULL'].),\n  (dose_amt:DECIMAL, Value examples: ['500', '200', '10', '1'].),\n  (dose_unit:TEXT, possible values: mg, ml, g. Value examples: ['mg', 'mg', 'mg', 'tablet'].),\n  (freq_hrs:INT, Value examples: ['6', '8', '24', '24'].),\n]\n\n【Foreign keys】\n\n【参考信息】\nAWF = Average weight of female patients (kg)\nPASI improvement rate is calculated as ((average PASI score on day 100 - average PASI score on day 7) / average PASI score on day 7) * 100, including only patients with non-null PASI scores at both timepoints.\nTo calculate the total number of adverse events reported for treatments involving topical drugs, first join treatments with adverse_events on treatment_id, then filter by the drug type.\nTPC = total patient count\n\n【用户问题】\nI want the adverse events that have been reported for treatments involving topical drugs. Give me the description, treatment id, drug id and name.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT a.description, a.treatment_id, d.drug_id, d.drug_name FROM adverse_events a JOIN treatments t ON a.treatment_id = t.treatment_id JOIN drugs d ON t.drug_id = d.drug_id WHERE d.drug_type = 'topical'",
        "role": "assistant"
      }
    ],
    "db_name": "derm_treatment",
    "id": 274,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many patients have been diagnosed with 'Psoriasis vulgaris' and treated with a biologic drug? Return the distinct count of patients.\n\n【数据库schema】\n【DB_ID】 derm_treatment\n【Schema】\n# Table: doctors\n[\n  (doc_id:SERIAL,),\n  (first_name:VARCHAR,),\n  (last_name:VARCHAR,),\n  (specialty:TEXT, possible values: dermatology, immunology, general.),\n  (year_reg:INT, year the doctor was registered and obtained license.),\n  (med_school_name:VARCHAR,),\n  (loc_city:VARCHAR,),\n  (loc_state:CHAR,),\n  (loc_zip:VARCHAR,),\n  (bd_cert_num:VARCHAR, board certification number.),\n]\n# Table: patients\n[\n  (patient_id:SERIAL,),\n  (first_name:VARCHAR, Value examples: ['Alice', 'Bob'].),\n  (last_name:VARCHAR, Value examples: ['Johnson', 'Smith'].),\n  (date_of_birth:DATE, Value examples: ['1985-03-15', '1978-11-23'].),\n  (date_of_registration:DATE, Value examples: ['2023-01-03', '2023-01-10'].),\n  (gender:VARCHAR, Male, Female, Others. Value examples: ['Female', 'Male'].),\n  (email:VARCHAR, Value examples: ['alice@email.com', 'bob@email.com'].),\n  (phone:VARCHAR, Value examples: ['555-123-4567', '555-987-6543'].),\n  (addr_street:VARCHAR, Value examples: ['123 Main St', '456 Oak Ave'].),\n  (addr_city:VARCHAR, Value examples: ['Anytown', 'Somecity'].),\n  (addr_state:CHAR, Value examples: ['CA', 'NY'].),\n  (addr_zip:VARCHAR, Value examples: ['12345', '54321'].),\n  (ins_type:TEXT, Insurance type. Possible values: private, medicare, medicaid, uninsured. Value examples: ['private', 'medicare'].),\n  (ins_policy_num:VARCHAR, Insurance policy number. Value examples: ['ABC123456', 'XYZ789012'].),\n  (height_cm:FLOAT, Value examples: ['165', '180'].),\n  (weight_kg:FLOAT, Value examples: ['60', '85'].),\n]\n# Table: drugs\n[\n  (drug_id:SERIAL,),\n  (drug_name:VARCHAR, Value examples: ['Drugalin', 'Medicol'].),\n  (manufacturer:VARCHAR, Value examples: ['Pharma Inc', 'Acme Pharma'].),\n  (drug_type:TEXT, possible values: biologic, small molecule, topical. Value examples: ['biologic', 'small molecule'].),\n  (moa:TEXT, mechanism of action. Value examples: ['TNF-alpha inhibitor', 'IL-17A inhibitor'].),\n  (fda_appr_dt:DATE, FDA approval date. NULL if drug is still under trial.. Value examples: ['2010-01-15', '2015-06-30'].),\n  (admin_route:TEXT, possible values: oral, injection, topical. Value examples: ['injection', 'oral'].),\n  (dos_amt:DECIMAL, recommended dosage amount. Value examples: ['40', '30'].),\n  (dos_unit:VARCHAR, recommended dosage unit. Value examples: ['mg', 'mg'].),\n  (dos_freq_hrs:INT, recommended number of hours between dosages. Value examples: ['336', '24'].),\n  (ndc:VARCHAR, National Drug Code. Value examples: ['12345-678-90', '54321-012-34'].),\n]\n# Table: diagnoses\n[\n  (diag_id:SERIAL,),\n  (diag_code:VARCHAR, Value examples: ['L40.1', 'L40.51'].),\n  (diag_name:VARCHAR, Value examples: ['Generalized pustular psoriasis', 'Distal interphalangeal psoriatic arthropathy'].),\n  (diag_desc:TEXT, Value examples: ['Widespread pustules on top of red skin', 'Psoriatic arthritis mainly affecting the ends of fingers and toes'].),\n]\n# Table: treatments\n[\n  (treatment_id:SERIAL,),\n  (patient_id:INT,),\n  (doc_id:INT,),\n  (drug_id:INT,),\n  (diag_id:INT,),\n  (start_dt:DATE,),\n  (end_dt:DATE, NULL if treatment is ongoing.),\n  (is_placebo:BOOLEAN,),\n  (tot_drug_amt:DECIMAL,),\n  (drug_unit:TEXT, possible values: mg, ml, g.),\n]\n# Table: outcomes\n[\n  (outcome_id:SERIAL,),\n  (treatment_id:INT, Value examples: ['1', '2', '3', '4'].),\n  (assess_dt:DATE, Value examples: ['2022-01-08', '2022-02-22', '2022-03-17', '2022-04-08'].),\n  (day7_lesion_cnt:INT, lesion counts on day 7.. Value examples: ['20', '25', '18', '30'].),\n  (day30_lesion_cnt:INT, Value examples: ['15', '18', '12', '25'].),\n  (day100_lesion_cnt:INT, Value examples: ['5', '8', '3', '12'].),\n  (day7_pasi_score:DECIMAL, PASI score range 0-72. Value examples: ['12.5', '15.0', '10.8', '18.2'].),\n  (day30_pasi_score:DECIMAL, Value examples: ['8.2', '10.1', '6.4', '13.9'].),\n  (day100_pasi_score:DECIMAL, Value examples: ['2.1', '3.5', '1.2', '5.8'].),\n  (day7_tewl:DECIMAL, in g/m^2/h. Value examples: ['18.2', '20.1', '16.5', '22.4'].),\n  (day30_tewl:DECIMAL, Value examples: ['15.6', '17.2', '14.0', '19.1'].),\n  (day100_tewl:DECIMAL, Value examples: ['12.1', '13.5', '10.8', '15.2'].),\n  (day7_itch_vas:INT, visual analog scale 0-100. Value examples: ['60', '70', '55', '80'].),\n  (day30_itch_vas:INT, Value examples: ['40', '50', '35', '60'].),\n  (day100_itch_vas:INT, Value examples: ['20', '30', '15', '40'].),\n  (day7_hfg:DECIMAL, hair growth factor range 0-5. Value examples: ['1.5', '1.0', '2.0', '0.5'].),\n  (day30_hfg:DECIMAL, Value examples: ['2.5', '2.0', '3.0', '1.5'].),\n  (day100_hfg:DECIMAL, Value examples: ['4.0', '3.5', '4.5', '3.0'].),\n]\n# Table: adverse_events\n[\n  (id:SERIAL, 1 row per adverse event per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '5'].),\n  (reported_dt:DATE, Value examples: ['2022-01-15', '2022-05-20'].),\n  (description:TEXT, Value examples: ['Mild injection site reaction', 'Upper respiratory infection'].),\n]\n# Table: concomitant_meds\n[\n  (id:SERIAL, 1 row per med per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '1', '2', '3'].),\n  (med_name:VARCHAR, Value examples: ['Acetaminophen', 'Ibuprofen', 'Loratadine', 'Multivitamin'].),\n  (start_dt:TEXT, YYYY-MM-DD. Value examples: ['2022-01-01', '2022-01-08', '2022-02-15', '2022-03-10'].),\n  (end_dt:TEXT, YYYY-MM-DD NULL if still taking. Value examples: ['2022-01-07', '2022-01-14', '2022-03-15', 'NULL'].),\n  (dose_amt:DECIMAL, Value examples: ['500', '200', '10', '1'].),\n  (dose_unit:TEXT, possible values: mg, ml, g. Value examples: ['mg', 'mg', 'mg', 'tablet'].),\n  (freq_hrs:INT, Value examples: ['6', '8', '24', '24'].),\n]\n\n【Foreign keys】\n\n【参考信息】\nTPC: Determine the total count of female patients To find the number of patients who have been diagnosed with a specific type of psoriasis and treated with a biologic drug, first join patients with treatments on patient_id, then join with diagnoses on diag_id, filtering by diagnosis and drug type. D7D100PIR: Compute the improvement rate of the PASI score from day 7 to day 100, considering only patients with available PASI scores for both days. AWF: Calculate the mean weight for male patients in kilograms\n\n【用户问题】\nHow many patients have been diagnosed with 'Psoriasis vulgaris' and treated with a biologic drug? Return the distinct count of patients.\n\n```sql",
        "role": "user"
      },
      {
        "content": "WITH patient_diagnosis_treatment AS (SELECT p.patient_id FROM patients p JOIN treatments t ON p.patient_id = t.patient_id JOIN diagnoses d ON t.diag_id = d.diag_id JOIN drugs dr ON t.drug_id = dr.drug_id WHERE d.diag_name = 'Psoriasis vulgaris' AND dr.drug_type = 'biologic') SELECT COUNT(DISTINCT patient_id) FROM patient_diagnosis_treatment",
        "role": "assistant"
      }
    ],
    "db_name": "derm_treatment",
    "id": 275,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the NPI for each year? Return the year, number of new patients, and NPI\n\n【数据库schema】\n【DB_ID】 derm_treatment\n【Schema】\n# Table: doctors\n[\n  (doc_id:SERIAL,),\n  (first_name:VARCHAR,),\n  (last_name:VARCHAR,),\n  (specialty:TEXT, possible values: dermatology, immunology, general.),\n  (year_reg:INT, year the doctor was registered and obtained license.),\n  (med_school_name:VARCHAR,),\n  (loc_city:VARCHAR,),\n  (loc_state:CHAR,),\n  (loc_zip:VARCHAR,),\n  (bd_cert_num:VARCHAR, board certification number.),\n]\n# Table: patients\n[\n  (patient_id:SERIAL,),\n  (first_name:VARCHAR, Value examples: ['Alice', 'Bob'].),\n  (last_name:VARCHAR, Value examples: ['Johnson', 'Smith'].),\n  (date_of_birth:DATE, Value examples: ['1985-03-15', '1978-11-23'].),\n  (date_of_registration:DATE, Value examples: ['2023-01-03', '2023-01-10'].),\n  (gender:VARCHAR, Male, Female, Others. Value examples: ['Female', 'Male'].),\n  (email:VARCHAR, Value examples: ['alice@email.com', 'bob@email.com'].),\n  (phone:VARCHAR, Value examples: ['555-123-4567', '555-987-6543'].),\n  (addr_street:VARCHAR, Value examples: ['123 Main St', '456 Oak Ave'].),\n  (addr_city:VARCHAR, Value examples: ['Anytown', 'Somecity'].),\n  (addr_state:CHAR, Value examples: ['CA', 'NY'].),\n  (addr_zip:VARCHAR, Value examples: ['12345', '54321'].),\n  (ins_type:TEXT, Insurance type. Possible values: private, medicare, medicaid, uninsured. Value examples: ['private', 'medicare'].),\n  (ins_policy_num:VARCHAR, Insurance policy number. Value examples: ['ABC123456', 'XYZ789012'].),\n  (height_cm:FLOAT, Value examples: ['165', '180'].),\n  (weight_kg:FLOAT, Value examples: ['60', '85'].),\n]\n# Table: drugs\n[\n  (drug_id:SERIAL,),\n  (drug_name:VARCHAR, Value examples: ['Drugalin', 'Medicol'].),\n  (manufacturer:VARCHAR, Value examples: ['Pharma Inc', 'Acme Pharma'].),\n  (drug_type:TEXT, possible values: biologic, small molecule, topical. Value examples: ['biologic', 'small molecule'].),\n  (moa:TEXT, mechanism of action. Value examples: ['TNF-alpha inhibitor', 'IL-17A inhibitor'].),\n  (fda_appr_dt:DATE, FDA approval date. NULL if drug is still under trial.. Value examples: ['2010-01-15', '2015-06-30'].),\n  (admin_route:TEXT, possible values: oral, injection, topical. Value examples: ['injection', 'oral'].),\n  (dos_amt:DECIMAL, recommended dosage amount. Value examples: ['40', '30'].),\n  (dos_unit:VARCHAR, recommended dosage unit. Value examples: ['mg', 'mg'].),\n  (dos_freq_hrs:INT, recommended number of hours between dosages. Value examples: ['336', '24'].),\n  (ndc:VARCHAR, National Drug Code. Value examples: ['12345-678-90', '54321-012-34'].),\n]\n# Table: diagnoses\n[\n  (diag_id:SERIAL,),\n  (diag_code:VARCHAR, Value examples: ['L40.1', 'L40.51'].),\n  (diag_name:VARCHAR, Value examples: ['Generalized pustular psoriasis', 'Distal interphalangeal psoriatic arthropathy'].),\n  (diag_desc:TEXT, Value examples: ['Widespread pustules on top of red skin', 'Psoriatic arthritis mainly affecting the ends of fingers and toes'].),\n]\n# Table: treatments\n[\n  (treatment_id:SERIAL,),\n  (patient_id:INT,),\n  (doc_id:INT,),\n  (drug_id:INT,),\n  (diag_id:INT,),\n  (start_dt:DATE,),\n  (end_dt:DATE, NULL if treatment is ongoing.),\n  (is_placebo:BOOLEAN,),\n  (tot_drug_amt:DECIMAL,),\n  (drug_unit:TEXT, possible values: mg, ml, g.),\n]\n# Table: outcomes\n[\n  (outcome_id:SERIAL,),\n  (treatment_id:INT, Value examples: ['1', '2', '3', '4'].),\n  (assess_dt:DATE, Value examples: ['2022-01-08', '2022-02-22', '2022-03-17', '2022-04-08'].),\n  (day7_lesion_cnt:INT, lesion counts on day 7.. Value examples: ['20', '25', '18', '30'].),\n  (day30_lesion_cnt:INT, Value examples: ['15', '18', '12', '25'].),\n  (day100_lesion_cnt:INT, Value examples: ['5', '8', '3', '12'].),\n  (day7_pasi_score:DECIMAL, PASI score range 0-72. Value examples: ['12.5', '15.0', '10.8', '18.2'].),\n  (day30_pasi_score:DECIMAL, Value examples: ['8.2', '10.1', '6.4', '13.9'].),\n  (day100_pasi_score:DECIMAL, Value examples: ['2.1', '3.5', '1.2', '5.8'].),\n  (day7_tewl:DECIMAL, in g/m^2/h. Value examples: ['18.2', '20.1', '16.5', '22.4'].),\n  (day30_tewl:DECIMAL, Value examples: ['15.6', '17.2', '14.0', '19.1'].),\n  (day100_tewl:DECIMAL, Value examples: ['12.1', '13.5', '10.8', '15.2'].),\n  (day7_itch_vas:INT, visual analog scale 0-100. Value examples: ['60', '70', '55', '80'].),\n  (day30_itch_vas:INT, Value examples: ['40', '50', '35', '60'].),\n  (day100_itch_vas:INT, Value examples: ['20', '30', '15', '40'].),\n  (day7_hfg:DECIMAL, hair growth factor range 0-5. Value examples: ['1.5', '1.0', '2.0', '0.5'].),\n  (day30_hfg:DECIMAL, Value examples: ['2.5', '2.0', '3.0', '1.5'].),\n  (day100_hfg:DECIMAL, Value examples: ['4.0', '3.5', '4.5', '3.0'].),\n]\n# Table: adverse_events\n[\n  (id:SERIAL, 1 row per adverse event per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '5'].),\n  (reported_dt:DATE, Value examples: ['2022-01-15', '2022-05-20'].),\n  (description:TEXT, Value examples: ['Mild injection site reaction', 'Upper respiratory infection'].),\n]\n# Table: concomitant_meds\n[\n  (id:SERIAL, 1 row per med per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '1', '2', '3'].),\n  (med_name:VARCHAR, Value examples: ['Acetaminophen', 'Ibuprofen', 'Loratadine', 'Multivitamin'].),\n  (start_dt:TEXT, YYYY-MM-DD. Value examples: ['2022-01-01', '2022-01-08', '2022-02-15', '2022-03-10'].),\n  (end_dt:TEXT, YYYY-MM-DD NULL if still taking. Value examples: ['2022-01-07', '2022-01-14', '2022-03-15', 'NULL'].),\n  (dose_amt:DECIMAL, Value examples: ['500', '200', '10', '1'].),\n  (dose_unit:TEXT, possible values: mg, ml, g. Value examples: ['mg', 'mg', 'mg', 'tablet'].),\n  (freq_hrs:INT, Value examples: ['6', '8', '24', '24'].),\n]\n\n【Foreign keys】\n\n【参考信息】\nNPI (new patients increase) = the increase in number of new patients compared to the previous year. New patients are defined as patients starting their first treatment and require joining the patients table with the earliest record of each patient from the treatment table on patient_id\nIf events from two different sources need to be linked based on time, it's advised to align them by truncating both dates to the same interval for the join condition.\nTo find the average weight of patients treated with any drug, join the patients and treatments tables using patient_id, then filter as needed by the drug\nTo identify doctors who have prescribed any drug type along with their states, join the doctors with treatments on doc_id, then apply the necessary filter for the drug type\n\n【用户问题】\nWhat is the NPI for each year? Return the year, number of new patients, and NPI\n\n```sql",
        "role": "user"
      },
      {
        "content": "WITH FirstTreatment AS (SELECT p.patient_id, MIN(t.start_dt) AS first_treatment_date FROM patients p JOIN treatments t ON p.patient_id = t.patient_id GROUP BY p.patient_id), NewPatientsPerYear AS (SELECT EXTRACT(YEAR FROM first_treatment_date) AS YEAR, COUNT(patient_id) AS new_patients FROM FirstTreatment GROUP BY EXTRACT(YEAR FROM first_treatment_date)), NPI AS (SELECT YEAR, new_patients, new_patients - LAG(new_patients, 1) OVER (ORDER BY YEAR) AS npi FROM NewPatientsPerYear) SELECT YEAR, new_patients, npi FROM NPI ORDER BY YEAR",
        "role": "assistant"
      }
    ],
    "db_name": "derm_treatment",
    "id": 276,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nReturn each doctor's doc_id, specialty, number of distinct drugs prescribed, and SDR\n\n【数据库schema】\n【DB_ID】 derm_treatment\n【Schema】\n# Table: doctors\n[\n  (doc_id:SERIAL,),\n  (first_name:VARCHAR,),\n  (last_name:VARCHAR,),\n  (specialty:TEXT, possible values: dermatology, immunology, general.),\n  (year_reg:INT, year the doctor was registered and obtained license.),\n  (med_school_name:VARCHAR,),\n  (loc_city:VARCHAR,),\n  (loc_state:CHAR,),\n  (loc_zip:VARCHAR,),\n  (bd_cert_num:VARCHAR, board certification number.),\n]\n# Table: patients\n[\n  (patient_id:SERIAL,),\n  (first_name:VARCHAR, Value examples: ['Alice', 'Bob'].),\n  (last_name:VARCHAR, Value examples: ['Johnson', 'Smith'].),\n  (date_of_birth:DATE, Value examples: ['1985-03-15', '1978-11-23'].),\n  (date_of_registration:DATE, Value examples: ['2023-01-03', '2023-01-10'].),\n  (gender:VARCHAR, Male, Female, Others. Value examples: ['Female', 'Male'].),\n  (email:VARCHAR, Value examples: ['alice@email.com', 'bob@email.com'].),\n  (phone:VARCHAR, Value examples: ['555-123-4567', '555-987-6543'].),\n  (addr_street:VARCHAR, Value examples: ['123 Main St', '456 Oak Ave'].),\n  (addr_city:VARCHAR, Value examples: ['Anytown', 'Somecity'].),\n  (addr_state:CHAR, Value examples: ['CA', 'NY'].),\n  (addr_zip:VARCHAR, Value examples: ['12345', '54321'].),\n  (ins_type:TEXT, Insurance type. Possible values: private, medicare, medicaid, uninsured. Value examples: ['private', 'medicare'].),\n  (ins_policy_num:VARCHAR, Insurance policy number. Value examples: ['ABC123456', 'XYZ789012'].),\n  (height_cm:FLOAT, Value examples: ['165', '180'].),\n  (weight_kg:FLOAT, Value examples: ['60', '85'].),\n]\n# Table: drugs\n[\n  (drug_id:SERIAL,),\n  (drug_name:VARCHAR, Value examples: ['Drugalin', 'Medicol'].),\n  (manufacturer:VARCHAR, Value examples: ['Pharma Inc', 'Acme Pharma'].),\n  (drug_type:TEXT, possible values: biologic, small molecule, topical. Value examples: ['biologic', 'small molecule'].),\n  (moa:TEXT, mechanism of action. Value examples: ['TNF-alpha inhibitor', 'IL-17A inhibitor'].),\n  (fda_appr_dt:DATE, FDA approval date. NULL if drug is still under trial.. Value examples: ['2010-01-15', '2015-06-30'].),\n  (admin_route:TEXT, possible values: oral, injection, topical. Value examples: ['injection', 'oral'].),\n  (dos_amt:DECIMAL, recommended dosage amount. Value examples: ['40', '30'].),\n  (dos_unit:VARCHAR, recommended dosage unit. Value examples: ['mg', 'mg'].),\n  (dos_freq_hrs:INT, recommended number of hours between dosages. Value examples: ['336', '24'].),\n  (ndc:VARCHAR, National Drug Code. Value examples: ['12345-678-90', '54321-012-34'].),\n]\n# Table: diagnoses\n[\n  (diag_id:SERIAL,),\n  (diag_code:VARCHAR, Value examples: ['L40.1', 'L40.51'].),\n  (diag_name:VARCHAR, Value examples: ['Generalized pustular psoriasis', 'Distal interphalangeal psoriatic arthropathy'].),\n  (diag_desc:TEXT, Value examples: ['Widespread pustules on top of red skin', 'Psoriatic arthritis mainly affecting the ends of fingers and toes'].),\n]\n# Table: treatments\n[\n  (treatment_id:SERIAL,),\n  (patient_id:INT,),\n  (doc_id:INT,),\n  (drug_id:INT,),\n  (diag_id:INT,),\n  (start_dt:DATE,),\n  (end_dt:DATE, NULL if treatment is ongoing.),\n  (is_placebo:BOOLEAN,),\n  (tot_drug_amt:DECIMAL,),\n  (drug_unit:TEXT, possible values: mg, ml, g.),\n]\n# Table: outcomes\n[\n  (outcome_id:SERIAL,),\n  (treatment_id:INT, Value examples: ['1', '2', '3', '4'].),\n  (assess_dt:DATE, Value examples: ['2022-01-08', '2022-02-22', '2022-03-17', '2022-04-08'].),\n  (day7_lesion_cnt:INT, lesion counts on day 7.. Value examples: ['20', '25', '18', '30'].),\n  (day30_lesion_cnt:INT, Value examples: ['15', '18', '12', '25'].),\n  (day100_lesion_cnt:INT, Value examples: ['5', '8', '3', '12'].),\n  (day7_pasi_score:DECIMAL, PASI score range 0-72. Value examples: ['12.5', '15.0', '10.8', '18.2'].),\n  (day30_pasi_score:DECIMAL, Value examples: ['8.2', '10.1', '6.4', '13.9'].),\n  (day100_pasi_score:DECIMAL, Value examples: ['2.1', '3.5', '1.2', '5.8'].),\n  (day7_tewl:DECIMAL, in g/m^2/h. Value examples: ['18.2', '20.1', '16.5', '22.4'].),\n  (day30_tewl:DECIMAL, Value examples: ['15.6', '17.2', '14.0', '19.1'].),\n  (day100_tewl:DECIMAL, Value examples: ['12.1', '13.5', '10.8', '15.2'].),\n  (day7_itch_vas:INT, visual analog scale 0-100. Value examples: ['60', '70', '55', '80'].),\n  (day30_itch_vas:INT, Value examples: ['40', '50', '35', '60'].),\n  (day100_itch_vas:INT, Value examples: ['20', '30', '15', '40'].),\n  (day7_hfg:DECIMAL, hair growth factor range 0-5. Value examples: ['1.5', '1.0', '2.0', '0.5'].),\n  (day30_hfg:DECIMAL, Value examples: ['2.5', '2.0', '3.0', '1.5'].),\n  (day100_hfg:DECIMAL, Value examples: ['4.0', '3.5', '4.5', '3.0'].),\n]\n# Table: adverse_events\n[\n  (id:SERIAL, 1 row per adverse event per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '5'].),\n  (reported_dt:DATE, Value examples: ['2022-01-15', '2022-05-20'].),\n  (description:TEXT, Value examples: ['Mild injection site reaction', 'Upper respiratory infection'].),\n]\n# Table: concomitant_meds\n[\n  (id:SERIAL, 1 row per med per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '1', '2', '3'].),\n  (med_name:VARCHAR, Value examples: ['Acetaminophen', 'Ibuprofen', 'Loratadine', 'Multivitamin'].),\n  (start_dt:TEXT, YYYY-MM-DD. Value examples: ['2022-01-01', '2022-01-08', '2022-02-15', '2022-03-10'].),\n  (end_dt:TEXT, YYYY-MM-DD NULL if still taking. Value examples: ['2022-01-07', '2022-01-14', '2022-03-15', 'NULL'].),\n  (dose_amt:DECIMAL, Value examples: ['500', '200', '10', '1'].),\n  (dose_unit:TEXT, possible values: mg, ml, g. Value examples: ['mg', 'mg', 'mg', 'tablet'].),\n  (freq_hrs:INT, Value examples: ['6', '8', '24', '24'].),\n]\n\n【Foreign keys】\n\n【参考信息】\nTo calculate the average weight of all patients who have been given a certain medication, join the patients and treatments tables on the patient's ID, then apply a filter for the specific medication To discover physicians who have prescribed a particular type of medication and identify their locations, link the doctors and treatments tables via the doctor's ID, then use a condition to filter by the medication type To ascertain the total count of adverse reactions recorded for treatments that involve topical medications, merge the treatments and adverse_events tables using the treatment ID, and apply a filter for the medication type. SDR = a doctor's rank within their specialty by number of distinct drugs prescribed, with doctors prescribing the most distinct drugs having rank 1\n\n【用户问题】\nReturn each doctor's doc_id, specialty, number of distinct drugs prescribed, and SDR\n\n```sql",
        "role": "user"
      },
      {
        "content": "WITH doc_drug_counts AS (SELECT d.doc_id, d.specialty, COUNT(DISTINCT t.drug_id) AS num_drugs_prescribed FROM doctors d JOIN treatments t ON d.doc_id = t.doc_id GROUP BY d.doc_id) SELECT doc_id, specialty, num_drugs_prescribed, DENSE_RANK() OVER (PARTITION BY specialty ORDER BY num_drugs_prescribed DESC) AS specialty_drug_rank FROM doc_drug_counts",
        "role": "assistant"
      }
    ],
    "db_name": "derm_treatment",
    "id": 277,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many treatments did the patient Alice have in the last 6 months, not including the current month?\n\n【数据库schema】\n【DB_ID】 derm_treatment\n【Schema】\n# Table: doctors\n[\n  (doc_id:SERIAL,),\n  (first_name:VARCHAR,),\n  (last_name:VARCHAR,),\n  (specialty:TEXT, possible values: dermatology, immunology, general.),\n  (year_reg:INT, year the doctor was registered and obtained license.),\n  (med_school_name:VARCHAR,),\n  (loc_city:VARCHAR,),\n  (loc_state:CHAR,),\n  (loc_zip:VARCHAR,),\n  (bd_cert_num:VARCHAR, board certification number.),\n]\n# Table: patients\n[\n  (patient_id:SERIAL,),\n  (first_name:VARCHAR, Value examples: ['Alice', 'Bob'].),\n  (last_name:VARCHAR, Value examples: ['Johnson', 'Smith'].),\n  (date_of_birth:DATE, Value examples: ['1985-03-15', '1978-11-23'].),\n  (date_of_registration:DATE, Value examples: ['2023-01-03', '2023-01-10'].),\n  (gender:VARCHAR, Male, Female, Others. Value examples: ['Female', 'Male'].),\n  (email:VARCHAR, Value examples: ['alice@email.com', 'bob@email.com'].),\n  (phone:VARCHAR, Value examples: ['555-123-4567', '555-987-6543'].),\n  (addr_street:VARCHAR, Value examples: ['123 Main St', '456 Oak Ave'].),\n  (addr_city:VARCHAR, Value examples: ['Anytown', 'Somecity'].),\n  (addr_state:CHAR, Value examples: ['CA', 'NY'].),\n  (addr_zip:VARCHAR, Value examples: ['12345', '54321'].),\n  (ins_type:TEXT, Insurance type. Possible values: private, medicare, medicaid, uninsured. Value examples: ['private', 'medicare'].),\n  (ins_policy_num:VARCHAR, Insurance policy number. Value examples: ['ABC123456', 'XYZ789012'].),\n  (height_cm:FLOAT, Value examples: ['165', '180'].),\n  (weight_kg:FLOAT, Value examples: ['60', '85'].),\n]\n# Table: drugs\n[\n  (drug_id:SERIAL,),\n  (drug_name:VARCHAR, Value examples: ['Drugalin', 'Medicol'].),\n  (manufacturer:VARCHAR, Value examples: ['Pharma Inc', 'Acme Pharma'].),\n  (drug_type:TEXT, possible values: biologic, small molecule, topical. Value examples: ['biologic', 'small molecule'].),\n  (moa:TEXT, mechanism of action. Value examples: ['TNF-alpha inhibitor', 'IL-17A inhibitor'].),\n  (fda_appr_dt:DATE, FDA approval date. NULL if drug is still under trial.. Value examples: ['2010-01-15', '2015-06-30'].),\n  (admin_route:TEXT, possible values: oral, injection, topical. Value examples: ['injection', 'oral'].),\n  (dos_amt:DECIMAL, recommended dosage amount. Value examples: ['40', '30'].),\n  (dos_unit:VARCHAR, recommended dosage unit. Value examples: ['mg', 'mg'].),\n  (dos_freq_hrs:INT, recommended number of hours between dosages. Value examples: ['336', '24'].),\n  (ndc:VARCHAR, National Drug Code. Value examples: ['12345-678-90', '54321-012-34'].),\n]\n# Table: diagnoses\n[\n  (diag_id:SERIAL,),\n  (diag_code:VARCHAR, Value examples: ['L40.1', 'L40.51'].),\n  (diag_name:VARCHAR, Value examples: ['Generalized pustular psoriasis', 'Distal interphalangeal psoriatic arthropathy'].),\n  (diag_desc:TEXT, Value examples: ['Widespread pustules on top of red skin', 'Psoriatic arthritis mainly affecting the ends of fingers and toes'].),\n]\n# Table: treatments\n[\n  (treatment_id:SERIAL,),\n  (patient_id:INT,),\n  (doc_id:INT,),\n  (drug_id:INT,),\n  (diag_id:INT,),\n  (start_dt:DATE,),\n  (end_dt:DATE, NULL if treatment is ongoing.),\n  (is_placebo:BOOLEAN,),\n  (tot_drug_amt:DECIMAL,),\n  (drug_unit:TEXT, possible values: mg, ml, g.),\n]\n# Table: outcomes\n[\n  (outcome_id:SERIAL,),\n  (treatment_id:INT, Value examples: ['1', '2', '3', '4'].),\n  (assess_dt:DATE, Value examples: ['2022-01-08', '2022-02-22', '2022-03-17', '2022-04-08'].),\n  (day7_lesion_cnt:INT, lesion counts on day 7.. Value examples: ['20', '25', '18', '30'].),\n  (day30_lesion_cnt:INT, Value examples: ['15', '18', '12', '25'].),\n  (day100_lesion_cnt:INT, Value examples: ['5', '8', '3', '12'].),\n  (day7_pasi_score:DECIMAL, PASI score range 0-72. Value examples: ['12.5', '15.0', '10.8', '18.2'].),\n  (day30_pasi_score:DECIMAL, Value examples: ['8.2', '10.1', '6.4', '13.9'].),\n  (day100_pasi_score:DECIMAL, Value examples: ['2.1', '3.5', '1.2', '5.8'].),\n  (day7_tewl:DECIMAL, in g/m^2/h. Value examples: ['18.2', '20.1', '16.5', '22.4'].),\n  (day30_tewl:DECIMAL, Value examples: ['15.6', '17.2', '14.0', '19.1'].),\n  (day100_tewl:DECIMAL, Value examples: ['12.1', '13.5', '10.8', '15.2'].),\n  (day7_itch_vas:INT, visual analog scale 0-100. Value examples: ['60', '70', '55', '80'].),\n  (day30_itch_vas:INT, Value examples: ['40', '50', '35', '60'].),\n  (day100_itch_vas:INT, Value examples: ['20', '30', '15', '40'].),\n  (day7_hfg:DECIMAL, hair growth factor range 0-5. Value examples: ['1.5', '1.0', '2.0', '0.5'].),\n  (day30_hfg:DECIMAL, Value examples: ['2.5', '2.0', '3.0', '1.5'].),\n  (day100_hfg:DECIMAL, Value examples: ['4.0', '3.5', '4.5', '3.0'].),\n]\n# Table: adverse_events\n[\n  (id:SERIAL, 1 row per adverse event per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '5'].),\n  (reported_dt:DATE, Value examples: ['2022-01-15', '2022-05-20'].),\n  (description:TEXT, Value examples: ['Mild injection site reaction', 'Upper respiratory infection'].),\n]\n# Table: concomitant_meds\n[\n  (id:SERIAL, 1 row per med per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '1', '2', '3'].),\n  (med_name:VARCHAR, Value examples: ['Acetaminophen', 'Ibuprofen', 'Loratadine', 'Multivitamin'].),\n  (start_dt:TEXT, YYYY-MM-DD. Value examples: ['2022-01-01', '2022-01-08', '2022-02-15', '2022-03-10'].),\n  (end_dt:TEXT, YYYY-MM-DD NULL if still taking. Value examples: ['2022-01-07', '2022-01-14', '2022-03-15', 'NULL'].),\n  (dose_amt:DECIMAL, Value examples: ['500', '200', '10', '1'].),\n  (dose_unit:TEXT, possible values: mg, ml, g. Value examples: ['mg', 'mg', 'mg', 'tablet'].),\n  (freq_hrs:INT, Value examples: ['6', '8', '24', '24'].),\n]\n\n【Foreign keys】\n\n【参考信息】\nLast 6 months = DATE_TRUNC('month', CURRENT_DATE) - INTERVAL '6 months' to DATE_TRUNC('month', CURRENT_DATE) - INTERVAL '1 day'. Always join treatments with patients before using the treatments table. If not mentioned, the patient name provided is the first name. To identify doctors with certain name characteristics; To calculate the total adverse event counts for specific drug treatments; To examine patient diagnosis and treatment correlations with certain drugs.\n\n【用户问题】\nHow many treatments did the patient Alice have in the last 6 months, not including the current month?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT COUNT(t.treatment_id) FROM treatments t JOIN patients p ON t.patient_id = p.patient_id WHERE p.first_name = 'Alice' AND t.start_dt BETWEEN DATE_TRUNC('month', CURRENT_DATE) - INTERVAL '6 months' AND DATE_TRUNC('month', CURRENT_DATE) - INTERVAL '1 day'",
        "role": "assistant"
      }
    ],
    "db_name": "derm_treatment",
    "id": 278,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat are the PMPD and PMTC for each of the last 12 months, not including the current month\n\n【数据库schema】\n【DB_ID】 derm_treatment\n【Schema】\n# Table: doctors\n[\n  (doc_id:SERIAL,),\n  (first_name:VARCHAR,),\n  (last_name:VARCHAR,),\n  (specialty:TEXT, possible values: dermatology, immunology, general.),\n  (year_reg:INT, year the doctor was registered and obtained license.),\n  (med_school_name:VARCHAR,),\n  (loc_city:VARCHAR,),\n  (loc_state:CHAR,),\n  (loc_zip:VARCHAR,),\n  (bd_cert_num:VARCHAR, board certification number.),\n]\n# Table: patients\n[\n  (patient_id:SERIAL,),\n  (first_name:VARCHAR, Value examples: ['Alice', 'Bob'].),\n  (last_name:VARCHAR, Value examples: ['Johnson', 'Smith'].),\n  (date_of_birth:DATE, Value examples: ['1985-03-15', '1978-11-23'].),\n  (date_of_registration:DATE, Value examples: ['2023-01-03', '2023-01-10'].),\n  (gender:VARCHAR, Male, Female, Others. Value examples: ['Female', 'Male'].),\n  (email:VARCHAR, Value examples: ['alice@email.com', 'bob@email.com'].),\n  (phone:VARCHAR, Value examples: ['555-123-4567', '555-987-6543'].),\n  (addr_street:VARCHAR, Value examples: ['123 Main St', '456 Oak Ave'].),\n  (addr_city:VARCHAR, Value examples: ['Anytown', 'Somecity'].),\n  (addr_state:CHAR, Value examples: ['CA', 'NY'].),\n  (addr_zip:VARCHAR, Value examples: ['12345', '54321'].),\n  (ins_type:TEXT, Insurance type. Possible values: private, medicare, medicaid, uninsured. Value examples: ['private', 'medicare'].),\n  (ins_policy_num:VARCHAR, Insurance policy number. Value examples: ['ABC123456', 'XYZ789012'].),\n  (height_cm:FLOAT, Value examples: ['165', '180'].),\n  (weight_kg:FLOAT, Value examples: ['60', '85'].),\n]\n# Table: drugs\n[\n  (drug_id:SERIAL,),\n  (drug_name:VARCHAR, Value examples: ['Drugalin', 'Medicol'].),\n  (manufacturer:VARCHAR, Value examples: ['Pharma Inc', 'Acme Pharma'].),\n  (drug_type:TEXT, possible values: biologic, small molecule, topical. Value examples: ['biologic', 'small molecule'].),\n  (moa:TEXT, mechanism of action. Value examples: ['TNF-alpha inhibitor', 'IL-17A inhibitor'].),\n  (fda_appr_dt:DATE, FDA approval date. NULL if drug is still under trial.. Value examples: ['2010-01-15', '2015-06-30'].),\n  (admin_route:TEXT, possible values: oral, injection, topical. Value examples: ['injection', 'oral'].),\n  (dos_amt:DECIMAL, recommended dosage amount. Value examples: ['40', '30'].),\n  (dos_unit:VARCHAR, recommended dosage unit. Value examples: ['mg', 'mg'].),\n  (dos_freq_hrs:INT, recommended number of hours between dosages. Value examples: ['336', '24'].),\n  (ndc:VARCHAR, National Drug Code. Value examples: ['12345-678-90', '54321-012-34'].),\n]\n# Table: diagnoses\n[\n  (diag_id:SERIAL,),\n  (diag_code:VARCHAR, Value examples: ['L40.1', 'L40.51'].),\n  (diag_name:VARCHAR, Value examples: ['Generalized pustular psoriasis', 'Distal interphalangeal psoriatic arthropathy'].),\n  (diag_desc:TEXT, Value examples: ['Widespread pustules on top of red skin', 'Psoriatic arthritis mainly affecting the ends of fingers and toes'].),\n]\n# Table: treatments\n[\n  (treatment_id:SERIAL,),\n  (patient_id:INT,),\n  (doc_id:INT,),\n  (drug_id:INT,),\n  (diag_id:INT,),\n  (start_dt:DATE,),\n  (end_dt:DATE, NULL if treatment is ongoing.),\n  (is_placebo:BOOLEAN,),\n  (tot_drug_amt:DECIMAL,),\n  (drug_unit:TEXT, possible values: mg, ml, g.),\n]\n# Table: outcomes\n[\n  (outcome_id:SERIAL,),\n  (treatment_id:INT, Value examples: ['1', '2', '3', '4'].),\n  (assess_dt:DATE, Value examples: ['2022-01-08', '2022-02-22', '2022-03-17', '2022-04-08'].),\n  (day7_lesion_cnt:INT, lesion counts on day 7.. Value examples: ['20', '25', '18', '30'].),\n  (day30_lesion_cnt:INT, Value examples: ['15', '18', '12', '25'].),\n  (day100_lesion_cnt:INT, Value examples: ['5', '8', '3', '12'].),\n  (day7_pasi_score:DECIMAL, PASI score range 0-72. Value examples: ['12.5', '15.0', '10.8', '18.2'].),\n  (day30_pasi_score:DECIMAL, Value examples: ['8.2', '10.1', '6.4', '13.9'].),\n  (day100_pasi_score:DECIMAL, Value examples: ['2.1', '3.5', '1.2', '5.8'].),\n  (day7_tewl:DECIMAL, in g/m^2/h. Value examples: ['18.2', '20.1', '16.5', '22.4'].),\n  (day30_tewl:DECIMAL, Value examples: ['15.6', '17.2', '14.0', '19.1'].),\n  (day100_tewl:DECIMAL, Value examples: ['12.1', '13.5', '10.8', '15.2'].),\n  (day7_itch_vas:INT, visual analog scale 0-100. Value examples: ['60', '70', '55', '80'].),\n  (day30_itch_vas:INT, Value examples: ['40', '50', '35', '60'].),\n  (day100_itch_vas:INT, Value examples: ['20', '30', '15', '40'].),\n  (day7_hfg:DECIMAL, hair growth factor range 0-5. Value examples: ['1.5', '1.0', '2.0', '0.5'].),\n  (day30_hfg:DECIMAL, Value examples: ['2.5', '2.0', '3.0', '1.5'].),\n  (day100_hfg:DECIMAL, Value examples: ['4.0', '3.5', '4.5', '3.0'].),\n]\n# Table: adverse_events\n[\n  (id:SERIAL, 1 row per adverse event per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '5'].),\n  (reported_dt:DATE, Value examples: ['2022-01-15', '2022-05-20'].),\n  (description:TEXT, Value examples: ['Mild injection site reaction', 'Upper respiratory infection'].),\n]\n# Table: concomitant_meds\n[\n  (id:SERIAL, 1 row per med per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '1', '2', '3'].),\n  (med_name:VARCHAR, Value examples: ['Acetaminophen', 'Ibuprofen', 'Loratadine', 'Multivitamin'].),\n  (start_dt:TEXT, YYYY-MM-DD. Value examples: ['2022-01-01', '2022-01-08', '2022-02-15', '2022-03-10'].),\n  (end_dt:TEXT, YYYY-MM-DD NULL if still taking. Value examples: ['2022-01-07', '2022-01-14', '2022-03-15', 'NULL'].),\n  (dose_amt:DECIMAL, Value examples: ['500', '200', '10', '1'].),\n  (dose_unit:TEXT, possible values: mg, ml, g. Value examples: ['mg', 'mg', 'mg', 'tablet'].),\n  (freq_hrs:INT, Value examples: ['6', '8', '24', '24'].),\n]\n\n【Foreign keys】\n\n【参考信息】\nPMPD = per month patient diagnoses. PMTC = per month treatment count. Truncate start_dt to month for aggregation. TPC = count of female patients; AWF = average weight for male patients; D7D100PIR = (average PASI score at day 100 - average PASI score at day 7) / average PASI score at day 7 * 100 with non-null PASI scores at both timepoints; DDD = total consumed drug amount divided by total treatment days.\n\n【用户问题】\nWhat are the PMPD and PMTC for each of the last 12 months, not including the current month\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT DATE_TRUNC('month', t.start_dt) AS MONTH, COUNT(DISTINCT d.diag_id) AS patient_count, COUNT(DISTINCT t.treatment_id) AS treatment_count FROM treatments t JOIN diagnoses d ON t.diag_id = d.diag_id WHERE t.start_dt >= DATE_TRUNC('month', CURRENT_DATE) - INTERVAL '12 months' AND t.start_dt < DATE_TRUNC('month', CURRENT_DATE) GROUP BY MONTH",
        "role": "assistant"
      }
    ],
    "db_name": "derm_treatment",
    "id": 279,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many distinct patients had treatments in each of the last 3 months, not including the current month? Out of these, how many had treatments with biologic drugs? Return the month, patient count, and biologic treatment count.\n\n【数据库schema】\n【DB_ID】 derm_treatment\n【Schema】\n# Table: doctors\n[\n  (doc_id:SERIAL,),\n  (first_name:VARCHAR,),\n  (last_name:VARCHAR,),\n  (specialty:TEXT, possible values: dermatology, immunology, general.),\n  (year_reg:INT, year the doctor was registered and obtained license.),\n  (med_school_name:VARCHAR,),\n  (loc_city:VARCHAR,),\n  (loc_state:CHAR,),\n  (loc_zip:VARCHAR,),\n  (bd_cert_num:VARCHAR, board certification number.),\n]\n# Table: patients\n[\n  (patient_id:SERIAL,),\n  (first_name:VARCHAR, Value examples: ['Alice', 'Bob'].),\n  (last_name:VARCHAR, Value examples: ['Johnson', 'Smith'].),\n  (date_of_birth:DATE, Value examples: ['1985-03-15', '1978-11-23'].),\n  (date_of_registration:DATE, Value examples: ['2023-01-03', '2023-01-10'].),\n  (gender:VARCHAR, Male, Female, Others. Value examples: ['Female', 'Male'].),\n  (email:VARCHAR, Value examples: ['alice@email.com', 'bob@email.com'].),\n  (phone:VARCHAR, Value examples: ['555-123-4567', '555-987-6543'].),\n  (addr_street:VARCHAR, Value examples: ['123 Main St', '456 Oak Ave'].),\n  (addr_city:VARCHAR, Value examples: ['Anytown', 'Somecity'].),\n  (addr_state:CHAR, Value examples: ['CA', 'NY'].),\n  (addr_zip:VARCHAR, Value examples: ['12345', '54321'].),\n  (ins_type:TEXT, Insurance type. Possible values: private, medicare, medicaid, uninsured. Value examples: ['private', 'medicare'].),\n  (ins_policy_num:VARCHAR, Insurance policy number. Value examples: ['ABC123456', 'XYZ789012'].),\n  (height_cm:FLOAT, Value examples: ['165', '180'].),\n  (weight_kg:FLOAT, Value examples: ['60', '85'].),\n]\n# Table: drugs\n[\n  (drug_id:SERIAL,),\n  (drug_name:VARCHAR, Value examples: ['Drugalin', 'Medicol'].),\n  (manufacturer:VARCHAR, Value examples: ['Pharma Inc', 'Acme Pharma'].),\n  (drug_type:TEXT, possible values: biologic, small molecule, topical. Value examples: ['biologic', 'small molecule'].),\n  (moa:TEXT, mechanism of action. Value examples: ['TNF-alpha inhibitor', 'IL-17A inhibitor'].),\n  (fda_appr_dt:DATE, FDA approval date. NULL if drug is still under trial.. Value examples: ['2010-01-15', '2015-06-30'].),\n  (admin_route:TEXT, possible values: oral, injection, topical. Value examples: ['injection', 'oral'].),\n  (dos_amt:DECIMAL, recommended dosage amount. Value examples: ['40', '30'].),\n  (dos_unit:VARCHAR, recommended dosage unit. Value examples: ['mg', 'mg'].),\n  (dos_freq_hrs:INT, recommended number of hours between dosages. Value examples: ['336', '24'].),\n  (ndc:VARCHAR, National Drug Code. Value examples: ['12345-678-90', '54321-012-34'].),\n]\n# Table: diagnoses\n[\n  (diag_id:SERIAL,),\n  (diag_code:VARCHAR, Value examples: ['L40.1', 'L40.51'].),\n  (diag_name:VARCHAR, Value examples: ['Generalized pustular psoriasis', 'Distal interphalangeal psoriatic arthropathy'].),\n  (diag_desc:TEXT, Value examples: ['Widespread pustules on top of red skin', 'Psoriatic arthritis mainly affecting the ends of fingers and toes'].),\n]\n# Table: treatments\n[\n  (treatment_id:SERIAL,),\n  (patient_id:INT,),\n  (doc_id:INT,),\n  (drug_id:INT,),\n  (diag_id:INT,),\n  (start_dt:DATE,),\n  (end_dt:DATE, NULL if treatment is ongoing.),\n  (is_placebo:BOOLEAN,),\n  (tot_drug_amt:DECIMAL,),\n  (drug_unit:TEXT, possible values: mg, ml, g.),\n]\n# Table: outcomes\n[\n  (outcome_id:SERIAL,),\n  (treatment_id:INT, Value examples: ['1', '2', '3', '4'].),\n  (assess_dt:DATE, Value examples: ['2022-01-08', '2022-02-22', '2022-03-17', '2022-04-08'].),\n  (day7_lesion_cnt:INT, lesion counts on day 7.. Value examples: ['20', '25', '18', '30'].),\n  (day30_lesion_cnt:INT, Value examples: ['15', '18', '12', '25'].),\n  (day100_lesion_cnt:INT, Value examples: ['5', '8', '3', '12'].),\n  (day7_pasi_score:DECIMAL, PASI score range 0-72. Value examples: ['12.5', '15.0', '10.8', '18.2'].),\n  (day30_pasi_score:DECIMAL, Value examples: ['8.2', '10.1', '6.4', '13.9'].),\n  (day100_pasi_score:DECIMAL, Value examples: ['2.1', '3.5', '1.2', '5.8'].),\n  (day7_tewl:DECIMAL, in g/m^2/h. Value examples: ['18.2', '20.1', '16.5', '22.4'].),\n  (day30_tewl:DECIMAL, Value examples: ['15.6', '17.2', '14.0', '19.1'].),\n  (day100_tewl:DECIMAL, Value examples: ['12.1', '13.5', '10.8', '15.2'].),\n  (day7_itch_vas:INT, visual analog scale 0-100. Value examples: ['60', '70', '55', '80'].),\n  (day30_itch_vas:INT, Value examples: ['40', '50', '35', '60'].),\n  (day100_itch_vas:INT, Value examples: ['20', '30', '15', '40'].),\n  (day7_hfg:DECIMAL, hair growth factor range 0-5. Value examples: ['1.5', '1.0', '2.0', '0.5'].),\n  (day30_hfg:DECIMAL, Value examples: ['2.5', '2.0', '3.0', '1.5'].),\n  (day100_hfg:DECIMAL, Value examples: ['4.0', '3.5', '4.5', '3.0'].),\n]\n# Table: adverse_events\n[\n  (id:SERIAL, 1 row per adverse event per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '5'].),\n  (reported_dt:DATE, Value examples: ['2022-01-15', '2022-05-20'].),\n  (description:TEXT, Value examples: ['Mild injection site reaction', 'Upper respiratory infection'].),\n]\n# Table: concomitant_meds\n[\n  (id:SERIAL, 1 row per med per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '1', '2', '3'].),\n  (med_name:VARCHAR, Value examples: ['Acetaminophen', 'Ibuprofen', 'Loratadine', 'Multivitamin'].),\n  (start_dt:TEXT, YYYY-MM-DD. Value examples: ['2022-01-01', '2022-01-08', '2022-02-15', '2022-03-10'].),\n  (end_dt:TEXT, YYYY-MM-DD NULL if still taking. Value examples: ['2022-01-07', '2022-01-14', '2022-03-15', 'NULL'].),\n  (dose_amt:DECIMAL, Value examples: ['500', '200', '10', '1'].),\n  (dose_unit:TEXT, possible values: mg, ml, g. Value examples: ['mg', 'mg', 'mg', 'tablet'].),\n  (freq_hrs:INT, Value examples: ['6', '8', '24', '24'].),\n]\n\n【Foreign keys】\n\n【参考信息】\nTo calculate the DDD (Defined Daily Dose) = the total amount of drug consumed divided by the total number of days of treatment\nTo count the number of adverse events reported for treatments involving any specified drug type, first join the treatments table with the adverse_events table based on treatment_id, then apply a filter by the specified drug type.\nTo determine the SDR (Specialty Doctor Rank) = rank doctors within their specialty by the number of distinct drugs prescribed, with those prescribing more distinct drugs achieving a higher rank\nBiologic drugs have drug_type = 'biologic'. Truncate start_dt to month for aggregation.\n\n【用户问题】\nHow many distinct patients had treatments in each of the last 3 months, not including the current month? Out of these, how many had treatments with biologic drugs? Return the month, patient count, and biologic treatment count.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT DATE_TRUNC('month', t.start_dt) AS MONTH, COUNT(DISTINCT t.patient_id) AS patient_count, COUNT(DISTINCT CASE WHEN d.drug_type = 'biologic' THEN t.patient_id ELSE NULL END) AS biologic_count FROM treatments t JOIN drugs d ON t.drug_id = d.drug_id WHERE t.start_dt >= DATE_TRUNC('month', CURRENT_DATE) - INTERVAL '3 months' AND t.start_dt < DATE_TRUNC('month', CURRENT_DATE) GROUP BY MONTH",
        "role": "assistant"
      }
    ],
    "db_name": "derm_treatment",
    "id": 280,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich drug had the highest number of adverse events reported within the same month as the treatment start date (adverse event or treatment can be earlier than the other)? Return the number of adverse events along with the drug's id and name.\n\n【数据库schema】\n【DB_ID】 derm_treatment\n【Schema】\n# Table: doctors\n[\n  (doc_id:SERIAL,),\n  (first_name:VARCHAR,),\n  (last_name:VARCHAR,),\n  (specialty:TEXT, possible values: dermatology, immunology, general.),\n  (year_reg:INT, year the doctor was registered and obtained license.),\n  (med_school_name:VARCHAR,),\n  (loc_city:VARCHAR,),\n  (loc_state:CHAR,),\n  (loc_zip:VARCHAR,),\n  (bd_cert_num:VARCHAR, board certification number.),\n]\n# Table: patients\n[\n  (patient_id:SERIAL,),\n  (first_name:VARCHAR, Value examples: ['Alice', 'Bob'].),\n  (last_name:VARCHAR, Value examples: ['Johnson', 'Smith'].),\n  (date_of_birth:DATE, Value examples: ['1985-03-15', '1978-11-23'].),\n  (date_of_registration:DATE, Value examples: ['2023-01-03', '2023-01-10'].),\n  (gender:VARCHAR, Male, Female, Others. Value examples: ['Female', 'Male'].),\n  (email:VARCHAR, Value examples: ['alice@email.com', 'bob@email.com'].),\n  (phone:VARCHAR, Value examples: ['555-123-4567', '555-987-6543'].),\n  (addr_street:VARCHAR, Value examples: ['123 Main St', '456 Oak Ave'].),\n  (addr_city:VARCHAR, Value examples: ['Anytown', 'Somecity'].),\n  (addr_state:CHAR, Value examples: ['CA', 'NY'].),\n  (addr_zip:VARCHAR, Value examples: ['12345', '54321'].),\n  (ins_type:TEXT, Insurance type. Possible values: private, medicare, medicaid, uninsured. Value examples: ['private', 'medicare'].),\n  (ins_policy_num:VARCHAR, Insurance policy number. Value examples: ['ABC123456', 'XYZ789012'].),\n  (height_cm:FLOAT, Value examples: ['165', '180'].),\n  (weight_kg:FLOAT, Value examples: ['60', '85'].),\n]\n# Table: drugs\n[\n  (drug_id:SERIAL,),\n  (drug_name:VARCHAR, Value examples: ['Drugalin', 'Medicol'].),\n  (manufacturer:VARCHAR, Value examples: ['Pharma Inc', 'Acme Pharma'].),\n  (drug_type:TEXT, possible values: biologic, small molecule, topical. Value examples: ['biologic', 'small molecule'].),\n  (moa:TEXT, mechanism of action. Value examples: ['TNF-alpha inhibitor', 'IL-17A inhibitor'].),\n  (fda_appr_dt:DATE, FDA approval date. NULL if drug is still under trial.. Value examples: ['2010-01-15', '2015-06-30'].),\n  (admin_route:TEXT, possible values: oral, injection, topical. Value examples: ['injection', 'oral'].),\n  (dos_amt:DECIMAL, recommended dosage amount. Value examples: ['40', '30'].),\n  (dos_unit:VARCHAR, recommended dosage unit. Value examples: ['mg', 'mg'].),\n  (dos_freq_hrs:INT, recommended number of hours between dosages. Value examples: ['336', '24'].),\n  (ndc:VARCHAR, National Drug Code. Value examples: ['12345-678-90', '54321-012-34'].),\n]\n# Table: diagnoses\n[\n  (diag_id:SERIAL,),\n  (diag_code:VARCHAR, Value examples: ['L40.1', 'L40.51'].),\n  (diag_name:VARCHAR, Value examples: ['Generalized pustular psoriasis', 'Distal interphalangeal psoriatic arthropathy'].),\n  (diag_desc:TEXT, Value examples: ['Widespread pustules on top of red skin', 'Psoriatic arthritis mainly affecting the ends of fingers and toes'].),\n]\n# Table: treatments\n[\n  (treatment_id:SERIAL,),\n  (patient_id:INT,),\n  (doc_id:INT,),\n  (drug_id:INT,),\n  (diag_id:INT,),\n  (start_dt:DATE,),\n  (end_dt:DATE, NULL if treatment is ongoing.),\n  (is_placebo:BOOLEAN,),\n  (tot_drug_amt:DECIMAL,),\n  (drug_unit:TEXT, possible values: mg, ml, g.),\n]\n# Table: outcomes\n[\n  (outcome_id:SERIAL,),\n  (treatment_id:INT, Value examples: ['1', '2', '3', '4'].),\n  (assess_dt:DATE, Value examples: ['2022-01-08', '2022-02-22', '2022-03-17', '2022-04-08'].),\n  (day7_lesion_cnt:INT, lesion counts on day 7.. Value examples: ['20', '25', '18', '30'].),\n  (day30_lesion_cnt:INT, Value examples: ['15', '18', '12', '25'].),\n  (day100_lesion_cnt:INT, Value examples: ['5', '8', '3', '12'].),\n  (day7_pasi_score:DECIMAL, PASI score range 0-72. Value examples: ['12.5', '15.0', '10.8', '18.2'].),\n  (day30_pasi_score:DECIMAL, Value examples: ['8.2', '10.1', '6.4', '13.9'].),\n  (day100_pasi_score:DECIMAL, Value examples: ['2.1', '3.5', '1.2', '5.8'].),\n  (day7_tewl:DECIMAL, in g/m^2/h. Value examples: ['18.2', '20.1', '16.5', '22.4'].),\n  (day30_tewl:DECIMAL, Value examples: ['15.6', '17.2', '14.0', '19.1'].),\n  (day100_tewl:DECIMAL, Value examples: ['12.1', '13.5', '10.8', '15.2'].),\n  (day7_itch_vas:INT, visual analog scale 0-100. Value examples: ['60', '70', '55', '80'].),\n  (day30_itch_vas:INT, Value examples: ['40', '50', '35', '60'].),\n  (day100_itch_vas:INT, Value examples: ['20', '30', '15', '40'].),\n  (day7_hfg:DECIMAL, hair growth factor range 0-5. Value examples: ['1.5', '1.0', '2.0', '0.5'].),\n  (day30_hfg:DECIMAL, Value examples: ['2.5', '2.0', '3.0', '1.5'].),\n  (day100_hfg:DECIMAL, Value examples: ['4.0', '3.5', '4.5', '3.0'].),\n]\n# Table: adverse_events\n[\n  (id:SERIAL, 1 row per adverse event per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '5'].),\n  (reported_dt:DATE, Value examples: ['2022-01-15', '2022-05-20'].),\n  (description:TEXT, Value examples: ['Mild injection site reaction', 'Upper respiratory infection'].),\n]\n# Table: concomitant_meds\n[\n  (id:SERIAL, 1 row per med per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '1', '2', '3'].),\n  (med_name:VARCHAR, Value examples: ['Acetaminophen', 'Ibuprofen', 'Loratadine', 'Multivitamin'].),\n  (start_dt:TEXT, YYYY-MM-DD. Value examples: ['2022-01-01', '2022-01-08', '2022-02-15', '2022-03-10'].),\n  (end_dt:TEXT, YYYY-MM-DD NULL if still taking. Value examples: ['2022-01-07', '2022-01-14', '2022-03-15', 'NULL'].),\n  (dose_amt:DECIMAL, Value examples: ['500', '200', '10', '1'].),\n  (dose_unit:TEXT, possible values: mg, ml, g. Value examples: ['mg', 'mg', 'mg', 'tablet'].),\n  (freq_hrs:INT, Value examples: ['6', '8', '24', '24'].),\n]\n\n【Foreign keys】\n\n【参考信息】\nIf events from 2 different tables from the same interval are to be joined, join on the respective truncated date fields eg `FROM t1 JOIN t2 ON DATE_TRUNC('<interval>', t1.date)=DATE_TRUNC('<interval>', t2.date). To determine the total count of adverse reactions reported for treatments that include topical medications, associate treatments with adverse_events through the treatment identifier, applying a filter based on the type of medication. To identify the healthcare providers who have prescribed a specific category of medication along with their state, connect doctors to treatments by doctor identifier, filtering by the type of medication To calculate the average weight of patients who have received a certain medication, link patients to treatments via the patient identifier, then narrow down by the name of the medication\n\n【用户问题】\nWhich drug had the highest number of adverse events reported within the same month as the treatment start date (adverse event or treatment can be earlier than the other)? Return the number of adverse events along with the drug's id and name.\n\n```sql",
        "role": "user"
      },
      {
        "content": "WITH adverse_events_per_drug AS (SELECT d.drug_id, COUNT(ae.id) AS num_events FROM adverse_events ae JOIN treatments t ON ae.treatment_id = t.treatment_id AND DATE_TRUNC('month', ae.reported_dt) = DATE_TRUNC('month', t.start_dt) JOIN drugs d ON t.drug_id = d.drug_id GROUP BY d.drug_id) SELECT ae.drug_id, d.drug_name, ae.num_events FROM adverse_events_per_drug ae JOIN drugs d USING(drug_id) ORDER BY ae.num_events DESC LIMIT 1",
        "role": "assistant"
      }
    ],
    "db_name": "derm_treatment",
    "id": 281,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many patients have a Gmail or Yahoo email address?\n\n【数据库schema】\n【DB_ID】 derm_treatment\n【Schema】\n# Table: doctors\n[\n  (doc_id:SERIAL,),\n  (first_name:VARCHAR,),\n  (last_name:VARCHAR,),\n  (specialty:TEXT, possible values: dermatology, immunology, general.),\n  (year_reg:INT, year the doctor was registered and obtained license.),\n  (med_school_name:VARCHAR,),\n  (loc_city:VARCHAR,),\n  (loc_state:CHAR,),\n  (loc_zip:VARCHAR,),\n  (bd_cert_num:VARCHAR, board certification number.),\n]\n# Table: patients\n[\n  (patient_id:SERIAL,),\n  (first_name:VARCHAR, Value examples: ['Alice', 'Bob'].),\n  (last_name:VARCHAR, Value examples: ['Johnson', 'Smith'].),\n  (date_of_birth:DATE, Value examples: ['1985-03-15', '1978-11-23'].),\n  (date_of_registration:DATE, Value examples: ['2023-01-03', '2023-01-10'].),\n  (gender:VARCHAR, Male, Female, Others. Value examples: ['Female', 'Male'].),\n  (email:VARCHAR, Value examples: ['alice@email.com', 'bob@email.com'].),\n  (phone:VARCHAR, Value examples: ['555-123-4567', '555-987-6543'].),\n  (addr_street:VARCHAR, Value examples: ['123 Main St', '456 Oak Ave'].),\n  (addr_city:VARCHAR, Value examples: ['Anytown', 'Somecity'].),\n  (addr_state:CHAR, Value examples: ['CA', 'NY'].),\n  (addr_zip:VARCHAR, Value examples: ['12345', '54321'].),\n  (ins_type:TEXT, Insurance type. Possible values: private, medicare, medicaid, uninsured. Value examples: ['private', 'medicare'].),\n  (ins_policy_num:VARCHAR, Insurance policy number. Value examples: ['ABC123456', 'XYZ789012'].),\n  (height_cm:FLOAT, Value examples: ['165', '180'].),\n  (weight_kg:FLOAT, Value examples: ['60', '85'].),\n]\n# Table: drugs\n[\n  (drug_id:SERIAL,),\n  (drug_name:VARCHAR, Value examples: ['Drugalin', 'Medicol'].),\n  (manufacturer:VARCHAR, Value examples: ['Pharma Inc', 'Acme Pharma'].),\n  (drug_type:TEXT, possible values: biologic, small molecule, topical. Value examples: ['biologic', 'small molecule'].),\n  (moa:TEXT, mechanism of action. Value examples: ['TNF-alpha inhibitor', 'IL-17A inhibitor'].),\n  (fda_appr_dt:DATE, FDA approval date. NULL if drug is still under trial.. Value examples: ['2010-01-15', '2015-06-30'].),\n  (admin_route:TEXT, possible values: oral, injection, topical. Value examples: ['injection', 'oral'].),\n  (dos_amt:DECIMAL, recommended dosage amount. Value examples: ['40', '30'].),\n  (dos_unit:VARCHAR, recommended dosage unit. Value examples: ['mg', 'mg'].),\n  (dos_freq_hrs:INT, recommended number of hours between dosages. Value examples: ['336', '24'].),\n  (ndc:VARCHAR, National Drug Code. Value examples: ['12345-678-90', '54321-012-34'].),\n]\n# Table: diagnoses\n[\n  (diag_id:SERIAL,),\n  (diag_code:VARCHAR, Value examples: ['L40.1', 'L40.51'].),\n  (diag_name:VARCHAR, Value examples: ['Generalized pustular psoriasis', 'Distal interphalangeal psoriatic arthropathy'].),\n  (diag_desc:TEXT, Value examples: ['Widespread pustules on top of red skin', 'Psoriatic arthritis mainly affecting the ends of fingers and toes'].),\n]\n# Table: treatments\n[\n  (treatment_id:SERIAL,),\n  (patient_id:INT,),\n  (doc_id:INT,),\n  (drug_id:INT,),\n  (diag_id:INT,),\n  (start_dt:DATE,),\n  (end_dt:DATE, NULL if treatment is ongoing.),\n  (is_placebo:BOOLEAN,),\n  (tot_drug_amt:DECIMAL,),\n  (drug_unit:TEXT, possible values: mg, ml, g.),\n]\n# Table: outcomes\n[\n  (outcome_id:SERIAL,),\n  (treatment_id:INT, Value examples: ['1', '2', '3', '4'].),\n  (assess_dt:DATE, Value examples: ['2022-01-08', '2022-02-22', '2022-03-17', '2022-04-08'].),\n  (day7_lesion_cnt:INT, lesion counts on day 7.. Value examples: ['20', '25', '18', '30'].),\n  (day30_lesion_cnt:INT, Value examples: ['15', '18', '12', '25'].),\n  (day100_lesion_cnt:INT, Value examples: ['5', '8', '3', '12'].),\n  (day7_pasi_score:DECIMAL, PASI score range 0-72. Value examples: ['12.5', '15.0', '10.8', '18.2'].),\n  (day30_pasi_score:DECIMAL, Value examples: ['8.2', '10.1', '6.4', '13.9'].),\n  (day100_pasi_score:DECIMAL, Value examples: ['2.1', '3.5', '1.2', '5.8'].),\n  (day7_tewl:DECIMAL, in g/m^2/h. Value examples: ['18.2', '20.1', '16.5', '22.4'].),\n  (day30_tewl:DECIMAL, Value examples: ['15.6', '17.2', '14.0', '19.1'].),\n  (day100_tewl:DECIMAL, Value examples: ['12.1', '13.5', '10.8', '15.2'].),\n  (day7_itch_vas:INT, visual analog scale 0-100. Value examples: ['60', '70', '55', '80'].),\n  (day30_itch_vas:INT, Value examples: ['40', '50', '35', '60'].),\n  (day100_itch_vas:INT, Value examples: ['20', '30', '15', '40'].),\n  (day7_hfg:DECIMAL, hair growth factor range 0-5. Value examples: ['1.5', '1.0', '2.0', '0.5'].),\n  (day30_hfg:DECIMAL, Value examples: ['2.5', '2.0', '3.0', '1.5'].),\n  (day100_hfg:DECIMAL, Value examples: ['4.0', '3.5', '4.5', '3.0'].),\n]\n# Table: adverse_events\n[\n  (id:SERIAL, 1 row per adverse event per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '5'].),\n  (reported_dt:DATE, Value examples: ['2022-01-15', '2022-05-20'].),\n  (description:TEXT, Value examples: ['Mild injection site reaction', 'Upper respiratory infection'].),\n]\n# Table: concomitant_meds\n[\n  (id:SERIAL, 1 row per med per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '1', '2', '3'].),\n  (med_name:VARCHAR, Value examples: ['Acetaminophen', 'Ibuprofen', 'Loratadine', 'Multivitamin'].),\n  (start_dt:TEXT, YYYY-MM-DD. Value examples: ['2022-01-01', '2022-01-08', '2022-02-15', '2022-03-10'].),\n  (end_dt:TEXT, YYYY-MM-DD NULL if still taking. Value examples: ['2022-01-07', '2022-01-14', '2022-03-15', 'NULL'].),\n  (dose_amt:DECIMAL, Value examples: ['500', '200', '10', '1'].),\n  (dose_unit:TEXT, possible values: mg, ml, g. Value examples: ['mg', 'mg', 'mg', 'tablet'].),\n  (freq_hrs:INT, Value examples: ['6', '8', '24', '24'].),\n]\n\n【Foreign keys】\n\n【参考信息】\nTo calculate the total number of adverse events for treatments involving topical medications, join the treatments and adverse_events tables on treatment_id, and then filter based on the drug's form.\nPatients with gmail or yahoo email addresses\nTo find the average weight of patients treated with a specific drug, join the patients and treatments tables by patient_id, then select the drug of interest\nTo identify doctors who have prescribed a certain type of drug and their practice states, join the doctors and treatments tables on doc_id, filtering by the drug's category\n\n【用户问题】\nHow many patients have a Gmail or Yahoo email address?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT COUNT(*) FROM patients WHERE email LIKE '%@gmail.com' OR email LIKE '%@yahoo.com'",
        "role": "assistant"
      }
    ],
    "db_name": "derm_treatment",
    "id": 282,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nReturn the first name, last name and specialty of doctors whose first name starts with 'J' or last name contains 'son', case-insensitive.\n\n【数据库schema】\n【DB_ID】 derm_treatment\n【Schema】\n# Table: doctors\n[\n  (doc_id:SERIAL,),\n  (first_name:VARCHAR,),\n  (last_name:VARCHAR,),\n  (specialty:TEXT, possible values: dermatology, immunology, general.),\n  (year_reg:INT, year the doctor was registered and obtained license.),\n  (med_school_name:VARCHAR,),\n  (loc_city:VARCHAR,),\n  (loc_state:CHAR,),\n  (loc_zip:VARCHAR,),\n  (bd_cert_num:VARCHAR, board certification number.),\n]\n# Table: patients\n[\n  (patient_id:SERIAL,),\n  (first_name:VARCHAR, Value examples: ['Alice', 'Bob'].),\n  (last_name:VARCHAR, Value examples: ['Johnson', 'Smith'].),\n  (date_of_birth:DATE, Value examples: ['1985-03-15', '1978-11-23'].),\n  (date_of_registration:DATE, Value examples: ['2023-01-03', '2023-01-10'].),\n  (gender:VARCHAR, Male, Female, Others. Value examples: ['Female', 'Male'].),\n  (email:VARCHAR, Value examples: ['alice@email.com', 'bob@email.com'].),\n  (phone:VARCHAR, Value examples: ['555-123-4567', '555-987-6543'].),\n  (addr_street:VARCHAR, Value examples: ['123 Main St', '456 Oak Ave'].),\n  (addr_city:VARCHAR, Value examples: ['Anytown', 'Somecity'].),\n  (addr_state:CHAR, Value examples: ['CA', 'NY'].),\n  (addr_zip:VARCHAR, Value examples: ['12345', '54321'].),\n  (ins_type:TEXT, Insurance type. Possible values: private, medicare, medicaid, uninsured. Value examples: ['private', 'medicare'].),\n  (ins_policy_num:VARCHAR, Insurance policy number. Value examples: ['ABC123456', 'XYZ789012'].),\n  (height_cm:FLOAT, Value examples: ['165', '180'].),\n  (weight_kg:FLOAT, Value examples: ['60', '85'].),\n]\n# Table: drugs\n[\n  (drug_id:SERIAL,),\n  (drug_name:VARCHAR, Value examples: ['Drugalin', 'Medicol'].),\n  (manufacturer:VARCHAR, Value examples: ['Pharma Inc', 'Acme Pharma'].),\n  (drug_type:TEXT, possible values: biologic, small molecule, topical. Value examples: ['biologic', 'small molecule'].),\n  (moa:TEXT, mechanism of action. Value examples: ['TNF-alpha inhibitor', 'IL-17A inhibitor'].),\n  (fda_appr_dt:DATE, FDA approval date. NULL if drug is still under trial.. Value examples: ['2010-01-15', '2015-06-30'].),\n  (admin_route:TEXT, possible values: oral, injection, topical. Value examples: ['injection', 'oral'].),\n  (dos_amt:DECIMAL, recommended dosage amount. Value examples: ['40', '30'].),\n  (dos_unit:VARCHAR, recommended dosage unit. Value examples: ['mg', 'mg'].),\n  (dos_freq_hrs:INT, recommended number of hours between dosages. Value examples: ['336', '24'].),\n  (ndc:VARCHAR, National Drug Code. Value examples: ['12345-678-90', '54321-012-34'].),\n]\n# Table: diagnoses\n[\n  (diag_id:SERIAL,),\n  (diag_code:VARCHAR, Value examples: ['L40.1', 'L40.51'].),\n  (diag_name:VARCHAR, Value examples: ['Generalized pustular psoriasis', 'Distal interphalangeal psoriatic arthropathy'].),\n  (diag_desc:TEXT, Value examples: ['Widespread pustules on top of red skin', 'Psoriatic arthritis mainly affecting the ends of fingers and toes'].),\n]\n# Table: treatments\n[\n  (treatment_id:SERIAL,),\n  (patient_id:INT,),\n  (doc_id:INT,),\n  (drug_id:INT,),\n  (diag_id:INT,),\n  (start_dt:DATE,),\n  (end_dt:DATE, NULL if treatment is ongoing.),\n  (is_placebo:BOOLEAN,),\n  (tot_drug_amt:DECIMAL,),\n  (drug_unit:TEXT, possible values: mg, ml, g.),\n]\n# Table: outcomes\n[\n  (outcome_id:SERIAL,),\n  (treatment_id:INT, Value examples: ['1', '2', '3', '4'].),\n  (assess_dt:DATE, Value examples: ['2022-01-08', '2022-02-22', '2022-03-17', '2022-04-08'].),\n  (day7_lesion_cnt:INT, lesion counts on day 7.. Value examples: ['20', '25', '18', '30'].),\n  (day30_lesion_cnt:INT, Value examples: ['15', '18', '12', '25'].),\n  (day100_lesion_cnt:INT, Value examples: ['5', '8', '3', '12'].),\n  (day7_pasi_score:DECIMAL, PASI score range 0-72. Value examples: ['12.5', '15.0', '10.8', '18.2'].),\n  (day30_pasi_score:DECIMAL, Value examples: ['8.2', '10.1', '6.4', '13.9'].),\n  (day100_pasi_score:DECIMAL, Value examples: ['2.1', '3.5', '1.2', '5.8'].),\n  (day7_tewl:DECIMAL, in g/m^2/h. Value examples: ['18.2', '20.1', '16.5', '22.4'].),\n  (day30_tewl:DECIMAL, Value examples: ['15.6', '17.2', '14.0', '19.1'].),\n  (day100_tewl:DECIMAL, Value examples: ['12.1', '13.5', '10.8', '15.2'].),\n  (day7_itch_vas:INT, visual analog scale 0-100. Value examples: ['60', '70', '55', '80'].),\n  (day30_itch_vas:INT, Value examples: ['40', '50', '35', '60'].),\n  (day100_itch_vas:INT, Value examples: ['20', '30', '15', '40'].),\n  (day7_hfg:DECIMAL, hair growth factor range 0-5. Value examples: ['1.5', '1.0', '2.0', '0.5'].),\n  (day30_hfg:DECIMAL, Value examples: ['2.5', '2.0', '3.0', '1.5'].),\n  (day100_hfg:DECIMAL, Value examples: ['4.0', '3.5', '4.5', '3.0'].),\n]\n# Table: adverse_events\n[\n  (id:SERIAL, 1 row per adverse event per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '5'].),\n  (reported_dt:DATE, Value examples: ['2022-01-15', '2022-05-20'].),\n  (description:TEXT, Value examples: ['Mild injection site reaction', 'Upper respiratory infection'].),\n]\n# Table: concomitant_meds\n[\n  (id:SERIAL, 1 row per med per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '1', '2', '3'].),\n  (med_name:VARCHAR, Value examples: ['Acetaminophen', 'Ibuprofen', 'Loratadine', 'Multivitamin'].),\n  (start_dt:TEXT, YYYY-MM-DD. Value examples: ['2022-01-01', '2022-01-08', '2022-02-15', '2022-03-10'].),\n  (end_dt:TEXT, YYYY-MM-DD NULL if still taking. Value examples: ['2022-01-07', '2022-01-14', '2022-03-15', 'NULL'].),\n  (dose_amt:DECIMAL, Value examples: ['500', '200', '10', '1'].),\n  (dose_unit:TEXT, possible values: mg, ml, g. Value examples: ['mg', 'mg', 'mg', 'tablet'].),\n  (freq_hrs:INT, Value examples: ['6', '8', '24', '24'].),\n]\n\n【Foreign keys】\n\n【参考信息】\nDoctors whose first name starts with 'J' or last name contains 'son', case-insensitive To calculate the total number of adverse events reported for treatments involving topical drugs, first join treatments with adverse_events on treatment_id, then filter by the drug type. To identify doctors who have prescribed a certain drug type and their respective states, first join doctors with treatments on doc_id, then filter by the drug type To find the average weight of patients treated with a specific drug, first join patients with treatments on patient_id, then filter by the drug name\n\n【用户问题】\nReturn the first name, last name and specialty of doctors whose first name starts with 'J' or last name contains 'son', case-insensitive.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT first_name, last_name, specialty FROM doctors WHERE first_name ILIKE 'J%' OR last_name ILIKE '%son%'",
        "role": "assistant"
      }
    ],
    "db_name": "derm_treatment",
    "id": 283,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the PIC for female patients?\n\n【数据库schema】\n【DB_ID】 derm_treatment\n【Schema】\n# Table: doctors\n[\n  (doc_id:SERIAL,),\n  (first_name:VARCHAR,),\n  (last_name:VARCHAR,),\n  (specialty:TEXT, possible values: dermatology, immunology, general.),\n  (year_reg:INT, year the doctor was registered and obtained license.),\n  (med_school_name:VARCHAR,),\n  (loc_city:VARCHAR,),\n  (loc_state:CHAR,),\n  (loc_zip:VARCHAR,),\n  (bd_cert_num:VARCHAR, board certification number.),\n]\n# Table: patients\n[\n  (patient_id:SERIAL,),\n  (first_name:VARCHAR, Value examples: ['Alice', 'Bob'].),\n  (last_name:VARCHAR, Value examples: ['Johnson', 'Smith'].),\n  (date_of_birth:DATE, Value examples: ['1985-03-15', '1978-11-23'].),\n  (date_of_registration:DATE, Value examples: ['2023-01-03', '2023-01-10'].),\n  (gender:VARCHAR, Male, Female, Others. Value examples: ['Female', 'Male'].),\n  (email:VARCHAR, Value examples: ['alice@email.com', 'bob@email.com'].),\n  (phone:VARCHAR, Value examples: ['555-123-4567', '555-987-6543'].),\n  (addr_street:VARCHAR, Value examples: ['123 Main St', '456 Oak Ave'].),\n  (addr_city:VARCHAR, Value examples: ['Anytown', 'Somecity'].),\n  (addr_state:CHAR, Value examples: ['CA', 'NY'].),\n  (addr_zip:VARCHAR, Value examples: ['12345', '54321'].),\n  (ins_type:TEXT, Insurance type. Possible values: private, medicare, medicaid, uninsured. Value examples: ['private', 'medicare'].),\n  (ins_policy_num:VARCHAR, Insurance policy number. Value examples: ['ABC123456', 'XYZ789012'].),\n  (height_cm:FLOAT, Value examples: ['165', '180'].),\n  (weight_kg:FLOAT, Value examples: ['60', '85'].),\n]\n# Table: drugs\n[\n  (drug_id:SERIAL,),\n  (drug_name:VARCHAR, Value examples: ['Drugalin', 'Medicol'].),\n  (manufacturer:VARCHAR, Value examples: ['Pharma Inc', 'Acme Pharma'].),\n  (drug_type:TEXT, possible values: biologic, small molecule, topical. Value examples: ['biologic', 'small molecule'].),\n  (moa:TEXT, mechanism of action. Value examples: ['TNF-alpha inhibitor', 'IL-17A inhibitor'].),\n  (fda_appr_dt:DATE, FDA approval date. NULL if drug is still under trial.. Value examples: ['2010-01-15', '2015-06-30'].),\n  (admin_route:TEXT, possible values: oral, injection, topical. Value examples: ['injection', 'oral'].),\n  (dos_amt:DECIMAL, recommended dosage amount. Value examples: ['40', '30'].),\n  (dos_unit:VARCHAR, recommended dosage unit. Value examples: ['mg', 'mg'].),\n  (dos_freq_hrs:INT, recommended number of hours between dosages. Value examples: ['336', '24'].),\n  (ndc:VARCHAR, National Drug Code. Value examples: ['12345-678-90', '54321-012-34'].),\n]\n# Table: diagnoses\n[\n  (diag_id:SERIAL,),\n  (diag_code:VARCHAR, Value examples: ['L40.1', 'L40.51'].),\n  (diag_name:VARCHAR, Value examples: ['Generalized pustular psoriasis', 'Distal interphalangeal psoriatic arthropathy'].),\n  (diag_desc:TEXT, Value examples: ['Widespread pustules on top of red skin', 'Psoriatic arthritis mainly affecting the ends of fingers and toes'].),\n]\n# Table: treatments\n[\n  (treatment_id:SERIAL,),\n  (patient_id:INT,),\n  (doc_id:INT,),\n  (drug_id:INT,),\n  (diag_id:INT,),\n  (start_dt:DATE,),\n  (end_dt:DATE, NULL if treatment is ongoing.),\n  (is_placebo:BOOLEAN,),\n  (tot_drug_amt:DECIMAL,),\n  (drug_unit:TEXT, possible values: mg, ml, g.),\n]\n# Table: outcomes\n[\n  (outcome_id:SERIAL,),\n  (treatment_id:INT, Value examples: ['1', '2', '3', '4'].),\n  (assess_dt:DATE, Value examples: ['2022-01-08', '2022-02-22', '2022-03-17', '2022-04-08'].),\n  (day7_lesion_cnt:INT, lesion counts on day 7.. Value examples: ['20', '25', '18', '30'].),\n  (day30_lesion_cnt:INT, Value examples: ['15', '18', '12', '25'].),\n  (day100_lesion_cnt:INT, Value examples: ['5', '8', '3', '12'].),\n  (day7_pasi_score:DECIMAL, PASI score range 0-72. Value examples: ['12.5', '15.0', '10.8', '18.2'].),\n  (day30_pasi_score:DECIMAL, Value examples: ['8.2', '10.1', '6.4', '13.9'].),\n  (day100_pasi_score:DECIMAL, Value examples: ['2.1', '3.5', '1.2', '5.8'].),\n  (day7_tewl:DECIMAL, in g/m^2/h. Value examples: ['18.2', '20.1', '16.5', '22.4'].),\n  (day30_tewl:DECIMAL, Value examples: ['15.6', '17.2', '14.0', '19.1'].),\n  (day100_tewl:DECIMAL, Value examples: ['12.1', '13.5', '10.8', '15.2'].),\n  (day7_itch_vas:INT, visual analog scale 0-100. Value examples: ['60', '70', '55', '80'].),\n  (day30_itch_vas:INT, Value examples: ['40', '50', '35', '60'].),\n  (day100_itch_vas:INT, Value examples: ['20', '30', '15', '40'].),\n  (day7_hfg:DECIMAL, hair growth factor range 0-5. Value examples: ['1.5', '1.0', '2.0', '0.5'].),\n  (day30_hfg:DECIMAL, Value examples: ['2.5', '2.0', '3.0', '1.5'].),\n  (day100_hfg:DECIMAL, Value examples: ['4.0', '3.5', '4.5', '3.0'].),\n]\n# Table: adverse_events\n[\n  (id:SERIAL, 1 row per adverse event per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '5'].),\n  (reported_dt:DATE, Value examples: ['2022-01-15', '2022-05-20'].),\n  (description:TEXT, Value examples: ['Mild injection site reaction', 'Upper respiratory infection'].),\n]\n# Table: concomitant_meds\n[\n  (id:SERIAL, 1 row per med per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '1', '2', '3'].),\n  (med_name:VARCHAR, Value examples: ['Acetaminophen', 'Ibuprofen', 'Loratadine', 'Multivitamin'].),\n  (start_dt:TEXT, YYYY-MM-DD. Value examples: ['2022-01-01', '2022-01-08', '2022-02-15', '2022-03-10'].),\n  (end_dt:TEXT, YYYY-MM-DD NULL if still taking. Value examples: ['2022-01-07', '2022-01-14', '2022-03-15', 'NULL'].),\n  (dose_amt:DECIMAL, Value examples: ['500', '200', '10', '1'].),\n  (dose_unit:TEXT, possible values: mg, ml, g. Value examples: ['mg', 'mg', 'mg', 'tablet'].),\n  (freq_hrs:INT, Value examples: ['6', '8', '24', '24'].),\n]\n\n【Foreign keys】\n\n【参考信息】\nPIC = private insured patient count. To calculate the D7D100PIR, subtract the average PASI score at day 100 from the average at day 7, divide by the average at day 7, and multiply by 100. PI calculates the month-over-month growth in new patients. For DDD, divide the total drug quantity used by the total treatment days\n\n【用户问题】\nWhat is the PIC for female patients?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT COUNT(patient_id) AS pic FROM patients WHERE gender = 'Female' AND ins_type = 'private'",
        "role": "assistant"
      }
    ],
    "db_name": "derm_treatment",
    "id": 284,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the CAW for male patients\n\n【数据库schema】\n【DB_ID】 derm_treatment\n【Schema】\n# Table: doctors\n[\n  (doc_id:SERIAL,),\n  (first_name:VARCHAR,),\n  (last_name:VARCHAR,),\n  (specialty:TEXT, possible values: dermatology, immunology, general.),\n  (year_reg:INT, year the doctor was registered and obtained license.),\n  (med_school_name:VARCHAR,),\n  (loc_city:VARCHAR,),\n  (loc_state:CHAR,),\n  (loc_zip:VARCHAR,),\n  (bd_cert_num:VARCHAR, board certification number.),\n]\n# Table: patients\n[\n  (patient_id:SERIAL,),\n  (first_name:VARCHAR, Value examples: ['Alice', 'Bob'].),\n  (last_name:VARCHAR, Value examples: ['Johnson', 'Smith'].),\n  (date_of_birth:DATE, Value examples: ['1985-03-15', '1978-11-23'].),\n  (date_of_registration:DATE, Value examples: ['2023-01-03', '2023-01-10'].),\n  (gender:VARCHAR, Male, Female, Others. Value examples: ['Female', 'Male'].),\n  (email:VARCHAR, Value examples: ['alice@email.com', 'bob@email.com'].),\n  (phone:VARCHAR, Value examples: ['555-123-4567', '555-987-6543'].),\n  (addr_street:VARCHAR, Value examples: ['123 Main St', '456 Oak Ave'].),\n  (addr_city:VARCHAR, Value examples: ['Anytown', 'Somecity'].),\n  (addr_state:CHAR, Value examples: ['CA', 'NY'].),\n  (addr_zip:VARCHAR, Value examples: ['12345', '54321'].),\n  (ins_type:TEXT, Insurance type. Possible values: private, medicare, medicaid, uninsured. Value examples: ['private', 'medicare'].),\n  (ins_policy_num:VARCHAR, Insurance policy number. Value examples: ['ABC123456', 'XYZ789012'].),\n  (height_cm:FLOAT, Value examples: ['165', '180'].),\n  (weight_kg:FLOAT, Value examples: ['60', '85'].),\n]\n# Table: drugs\n[\n  (drug_id:SERIAL,),\n  (drug_name:VARCHAR, Value examples: ['Drugalin', 'Medicol'].),\n  (manufacturer:VARCHAR, Value examples: ['Pharma Inc', 'Acme Pharma'].),\n  (drug_type:TEXT, possible values: biologic, small molecule, topical. Value examples: ['biologic', 'small molecule'].),\n  (moa:TEXT, mechanism of action. Value examples: ['TNF-alpha inhibitor', 'IL-17A inhibitor'].),\n  (fda_appr_dt:DATE, FDA approval date. NULL if drug is still under trial.. Value examples: ['2010-01-15', '2015-06-30'].),\n  (admin_route:TEXT, possible values: oral, injection, topical. Value examples: ['injection', 'oral'].),\n  (dos_amt:DECIMAL, recommended dosage amount. Value examples: ['40', '30'].),\n  (dos_unit:VARCHAR, recommended dosage unit. Value examples: ['mg', 'mg'].),\n  (dos_freq_hrs:INT, recommended number of hours between dosages. Value examples: ['336', '24'].),\n  (ndc:VARCHAR, National Drug Code. Value examples: ['12345-678-90', '54321-012-34'].),\n]\n# Table: diagnoses\n[\n  (diag_id:SERIAL,),\n  (diag_code:VARCHAR, Value examples: ['L40.1', 'L40.51'].),\n  (diag_name:VARCHAR, Value examples: ['Generalized pustular psoriasis', 'Distal interphalangeal psoriatic arthropathy'].),\n  (diag_desc:TEXT, Value examples: ['Widespread pustules on top of red skin', 'Psoriatic arthritis mainly affecting the ends of fingers and toes'].),\n]\n# Table: treatments\n[\n  (treatment_id:SERIAL,),\n  (patient_id:INT,),\n  (doc_id:INT,),\n  (drug_id:INT,),\n  (diag_id:INT,),\n  (start_dt:DATE,),\n  (end_dt:DATE, NULL if treatment is ongoing.),\n  (is_placebo:BOOLEAN,),\n  (tot_drug_amt:DECIMAL,),\n  (drug_unit:TEXT, possible values: mg, ml, g.),\n]\n# Table: outcomes\n[\n  (outcome_id:SERIAL,),\n  (treatment_id:INT, Value examples: ['1', '2', '3', '4'].),\n  (assess_dt:DATE, Value examples: ['2022-01-08', '2022-02-22', '2022-03-17', '2022-04-08'].),\n  (day7_lesion_cnt:INT, lesion counts on day 7.. Value examples: ['20', '25', '18', '30'].),\n  (day30_lesion_cnt:INT, Value examples: ['15', '18', '12', '25'].),\n  (day100_lesion_cnt:INT, Value examples: ['5', '8', '3', '12'].),\n  (day7_pasi_score:DECIMAL, PASI score range 0-72. Value examples: ['12.5', '15.0', '10.8', '18.2'].),\n  (day30_pasi_score:DECIMAL, Value examples: ['8.2', '10.1', '6.4', '13.9'].),\n  (day100_pasi_score:DECIMAL, Value examples: ['2.1', '3.5', '1.2', '5.8'].),\n  (day7_tewl:DECIMAL, in g/m^2/h. Value examples: ['18.2', '20.1', '16.5', '22.4'].),\n  (day30_tewl:DECIMAL, Value examples: ['15.6', '17.2', '14.0', '19.1'].),\n  (day100_tewl:DECIMAL, Value examples: ['12.1', '13.5', '10.8', '15.2'].),\n  (day7_itch_vas:INT, visual analog scale 0-100. Value examples: ['60', '70', '55', '80'].),\n  (day30_itch_vas:INT, Value examples: ['40', '50', '35', '60'].),\n  (day100_itch_vas:INT, Value examples: ['20', '30', '15', '40'].),\n  (day7_hfg:DECIMAL, hair growth factor range 0-5. Value examples: ['1.5', '1.0', '2.0', '0.5'].),\n  (day30_hfg:DECIMAL, Value examples: ['2.5', '2.0', '3.0', '1.5'].),\n  (day100_hfg:DECIMAL, Value examples: ['4.0', '3.5', '4.5', '3.0'].),\n]\n# Table: adverse_events\n[\n  (id:SERIAL, 1 row per adverse event per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '5'].),\n  (reported_dt:DATE, Value examples: ['2022-01-15', '2022-05-20'].),\n  (description:TEXT, Value examples: ['Mild injection site reaction', 'Upper respiratory infection'].),\n]\n# Table: concomitant_meds\n[\n  (id:SERIAL, 1 row per med per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '1', '2', '3'].),\n  (med_name:VARCHAR, Value examples: ['Acetaminophen', 'Ibuprofen', 'Loratadine', 'Multivitamin'].),\n  (start_dt:TEXT, YYYY-MM-DD. Value examples: ['2022-01-01', '2022-01-08', '2022-02-15', '2022-03-10'].),\n  (end_dt:TEXT, YYYY-MM-DD NULL if still taking. Value examples: ['2022-01-07', '2022-01-14', '2022-03-15', 'NULL'].),\n  (dose_amt:DECIMAL, Value examples: ['500', '200', '10', '1'].),\n  (dose_unit:TEXT, possible values: mg, ml, g. Value examples: ['mg', 'mg', 'mg', 'tablet'].),\n  (freq_hrs:INT, Value examples: ['6', '8', '24', '24'].),\n]\n\n【Foreign keys】\n\n【参考信息】\nA doctor's Specialty Distinct Drug Rank (SDR) is established by the variety of distinct drugs they've prescribed, with the highest prescribers ranked first.\nCAW = cohort average weight in kilograms\nTo calculate the D7D100PIR, subtract the average PASI score at the beginning of the period from the average at the end, divide by the initial average, and multiply by 100\nThe Defined Daily Dose (DDD) is calculated as the total consumed medication divided by the treatment duration\n\n【用户问题】\nWhat is the CAW for male patients\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT AVG(weight_kg) AS caw FROM patients WHERE gender = 'Male'",
        "role": "assistant"
      }
    ],
    "db_name": "derm_treatment",
    "id": 285,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nCalculate the DDD for each drug. Return the drug name and DDD value.\n\n【数据库schema】\n【DB_ID】 derm_treatment\n【Schema】\n# Table: doctors\n[\n  (doc_id:SERIAL,),\n  (first_name:VARCHAR,),\n  (last_name:VARCHAR,),\n  (specialty:TEXT, possible values: dermatology, immunology, general.),\n  (year_reg:INT, year the doctor was registered and obtained license.),\n  (med_school_name:VARCHAR,),\n  (loc_city:VARCHAR,),\n  (loc_state:CHAR,),\n  (loc_zip:VARCHAR,),\n  (bd_cert_num:VARCHAR, board certification number.),\n]\n# Table: patients\n[\n  (patient_id:SERIAL,),\n  (first_name:VARCHAR, Value examples: ['Alice', 'Bob'].),\n  (last_name:VARCHAR, Value examples: ['Johnson', 'Smith'].),\n  (date_of_birth:DATE, Value examples: ['1985-03-15', '1978-11-23'].),\n  (date_of_registration:DATE, Value examples: ['2023-01-03', '2023-01-10'].),\n  (gender:VARCHAR, Male, Female, Others. Value examples: ['Female', 'Male'].),\n  (email:VARCHAR, Value examples: ['alice@email.com', 'bob@email.com'].),\n  (phone:VARCHAR, Value examples: ['555-123-4567', '555-987-6543'].),\n  (addr_street:VARCHAR, Value examples: ['123 Main St', '456 Oak Ave'].),\n  (addr_city:VARCHAR, Value examples: ['Anytown', 'Somecity'].),\n  (addr_state:CHAR, Value examples: ['CA', 'NY'].),\n  (addr_zip:VARCHAR, Value examples: ['12345', '54321'].),\n  (ins_type:TEXT, Insurance type. Possible values: private, medicare, medicaid, uninsured. Value examples: ['private', 'medicare'].),\n  (ins_policy_num:VARCHAR, Insurance policy number. Value examples: ['ABC123456', 'XYZ789012'].),\n  (height_cm:FLOAT, Value examples: ['165', '180'].),\n  (weight_kg:FLOAT, Value examples: ['60', '85'].),\n]\n# Table: drugs\n[\n  (drug_id:SERIAL,),\n  (drug_name:VARCHAR, Value examples: ['Drugalin', 'Medicol'].),\n  (manufacturer:VARCHAR, Value examples: ['Pharma Inc', 'Acme Pharma'].),\n  (drug_type:TEXT, possible values: biologic, small molecule, topical. Value examples: ['biologic', 'small molecule'].),\n  (moa:TEXT, mechanism of action. Value examples: ['TNF-alpha inhibitor', 'IL-17A inhibitor'].),\n  (fda_appr_dt:DATE, FDA approval date. NULL if drug is still under trial.. Value examples: ['2010-01-15', '2015-06-30'].),\n  (admin_route:TEXT, possible values: oral, injection, topical. Value examples: ['injection', 'oral'].),\n  (dos_amt:DECIMAL, recommended dosage amount. Value examples: ['40', '30'].),\n  (dos_unit:VARCHAR, recommended dosage unit. Value examples: ['mg', 'mg'].),\n  (dos_freq_hrs:INT, recommended number of hours between dosages. Value examples: ['336', '24'].),\n  (ndc:VARCHAR, National Drug Code. Value examples: ['12345-678-90', '54321-012-34'].),\n]\n# Table: diagnoses\n[\n  (diag_id:SERIAL,),\n  (diag_code:VARCHAR, Value examples: ['L40.1', 'L40.51'].),\n  (diag_name:VARCHAR, Value examples: ['Generalized pustular psoriasis', 'Distal interphalangeal psoriatic arthropathy'].),\n  (diag_desc:TEXT, Value examples: ['Widespread pustules on top of red skin', 'Psoriatic arthritis mainly affecting the ends of fingers and toes'].),\n]\n# Table: treatments\n[\n  (treatment_id:SERIAL,),\n  (patient_id:INT,),\n  (doc_id:INT,),\n  (drug_id:INT,),\n  (diag_id:INT,),\n  (start_dt:DATE,),\n  (end_dt:DATE, NULL if treatment is ongoing.),\n  (is_placebo:BOOLEAN,),\n  (tot_drug_amt:DECIMAL,),\n  (drug_unit:TEXT, possible values: mg, ml, g.),\n]\n# Table: outcomes\n[\n  (outcome_id:SERIAL,),\n  (treatment_id:INT, Value examples: ['1', '2', '3', '4'].),\n  (assess_dt:DATE, Value examples: ['2022-01-08', '2022-02-22', '2022-03-17', '2022-04-08'].),\n  (day7_lesion_cnt:INT, lesion counts on day 7.. Value examples: ['20', '25', '18', '30'].),\n  (day30_lesion_cnt:INT, Value examples: ['15', '18', '12', '25'].),\n  (day100_lesion_cnt:INT, Value examples: ['5', '8', '3', '12'].),\n  (day7_pasi_score:DECIMAL, PASI score range 0-72. Value examples: ['12.5', '15.0', '10.8', '18.2'].),\n  (day30_pasi_score:DECIMAL, Value examples: ['8.2', '10.1', '6.4', '13.9'].),\n  (day100_pasi_score:DECIMAL, Value examples: ['2.1', '3.5', '1.2', '5.8'].),\n  (day7_tewl:DECIMAL, in g/m^2/h. Value examples: ['18.2', '20.1', '16.5', '22.4'].),\n  (day30_tewl:DECIMAL, Value examples: ['15.6', '17.2', '14.0', '19.1'].),\n  (day100_tewl:DECIMAL, Value examples: ['12.1', '13.5', '10.8', '15.2'].),\n  (day7_itch_vas:INT, visual analog scale 0-100. Value examples: ['60', '70', '55', '80'].),\n  (day30_itch_vas:INT, Value examples: ['40', '50', '35', '60'].),\n  (day100_itch_vas:INT, Value examples: ['20', '30', '15', '40'].),\n  (day7_hfg:DECIMAL, hair growth factor range 0-5. Value examples: ['1.5', '1.0', '2.0', '0.5'].),\n  (day30_hfg:DECIMAL, Value examples: ['2.5', '2.0', '3.0', '1.5'].),\n  (day100_hfg:DECIMAL, Value examples: ['4.0', '3.5', '4.5', '3.0'].),\n]\n# Table: adverse_events\n[\n  (id:SERIAL, 1 row per adverse event per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '5'].),\n  (reported_dt:DATE, Value examples: ['2022-01-15', '2022-05-20'].),\n  (description:TEXT, Value examples: ['Mild injection site reaction', 'Upper respiratory infection'].),\n]\n# Table: concomitant_meds\n[\n  (id:SERIAL, 1 row per med per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '1', '2', '3'].),\n  (med_name:VARCHAR, Value examples: ['Acetaminophen', 'Ibuprofen', 'Loratadine', 'Multivitamin'].),\n  (start_dt:TEXT, YYYY-MM-DD. Value examples: ['2022-01-01', '2022-01-08', '2022-02-15', '2022-03-10'].),\n  (end_dt:TEXT, YYYY-MM-DD NULL if still taking. Value examples: ['2022-01-07', '2022-01-14', '2022-03-15', 'NULL'].),\n  (dose_amt:DECIMAL, Value examples: ['500', '200', '10', '1'].),\n  (dose_unit:TEXT, possible values: mg, ml, g. Value examples: ['mg', 'mg', 'mg', 'tablet'].),\n  (freq_hrs:INT, Value examples: ['6', '8', '24', '24'].),\n]\n\n【Foreign keys】\n\n【参考信息】\nDDD (defined daily dose) = total drug amount consumed / total days of treatment (end - start date in days). To find the average weight of patients treated with a specific drug, first join patients with treatments on patient_id, then filter by the drug name. To identify doctors who have prescribed a certain drug type and their respective locations, first join doctors with treatments on doc_id, then filter by the drug type. To calculate the total number of adverse events reported for treatments involving certain drug types, first join treatments with adverse_events on treatment_id, then filter by the drug type.\n\n【用户问题】\nCalculate the DDD for each drug. Return the drug name and DDD value.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT d.drug_name, AVG(t.tot_drug_amt / NULLIF((t.end_dt - t.start_dt), 0)) AS ddd FROM treatments t JOIN drugs d ON t.drug_id = d.drug_id WHERE t.end_dt IS NOT NULL GROUP BY d.drug_name",
        "role": "assistant"
      }
    ],
    "db_name": "derm_treatment",
    "id": 286,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the overall D7D100PIR across all treatments? Return the percentage value.\n\n【数据库schema】\n【DB_ID】 derm_treatment\n【Schema】\n# Table: doctors\n[\n  (doc_id:SERIAL,),\n  (first_name:VARCHAR,),\n  (last_name:VARCHAR,),\n  (specialty:TEXT, possible values: dermatology, immunology, general.),\n  (year_reg:INT, year the doctor was registered and obtained license.),\n  (med_school_name:VARCHAR,),\n  (loc_city:VARCHAR,),\n  (loc_state:CHAR,),\n  (loc_zip:VARCHAR,),\n  (bd_cert_num:VARCHAR, board certification number.),\n]\n# Table: patients\n[\n  (patient_id:SERIAL,),\n  (first_name:VARCHAR, Value examples: ['Alice', 'Bob'].),\n  (last_name:VARCHAR, Value examples: ['Johnson', 'Smith'].),\n  (date_of_birth:DATE, Value examples: ['1985-03-15', '1978-11-23'].),\n  (date_of_registration:DATE, Value examples: ['2023-01-03', '2023-01-10'].),\n  (gender:VARCHAR, Male, Female, Others. Value examples: ['Female', 'Male'].),\n  (email:VARCHAR, Value examples: ['alice@email.com', 'bob@email.com'].),\n  (phone:VARCHAR, Value examples: ['555-123-4567', '555-987-6543'].),\n  (addr_street:VARCHAR, Value examples: ['123 Main St', '456 Oak Ave'].),\n  (addr_city:VARCHAR, Value examples: ['Anytown', 'Somecity'].),\n  (addr_state:CHAR, Value examples: ['CA', 'NY'].),\n  (addr_zip:VARCHAR, Value examples: ['12345', '54321'].),\n  (ins_type:TEXT, Insurance type. Possible values: private, medicare, medicaid, uninsured. Value examples: ['private', 'medicare'].),\n  (ins_policy_num:VARCHAR, Insurance policy number. Value examples: ['ABC123456', 'XYZ789012'].),\n  (height_cm:FLOAT, Value examples: ['165', '180'].),\n  (weight_kg:FLOAT, Value examples: ['60', '85'].),\n]\n# Table: drugs\n[\n  (drug_id:SERIAL,),\n  (drug_name:VARCHAR, Value examples: ['Drugalin', 'Medicol'].),\n  (manufacturer:VARCHAR, Value examples: ['Pharma Inc', 'Acme Pharma'].),\n  (drug_type:TEXT, possible values: biologic, small molecule, topical. Value examples: ['biologic', 'small molecule'].),\n  (moa:TEXT, mechanism of action. Value examples: ['TNF-alpha inhibitor', 'IL-17A inhibitor'].),\n  (fda_appr_dt:DATE, FDA approval date. NULL if drug is still under trial.. Value examples: ['2010-01-15', '2015-06-30'].),\n  (admin_route:TEXT, possible values: oral, injection, topical. Value examples: ['injection', 'oral'].),\n  (dos_amt:DECIMAL, recommended dosage amount. Value examples: ['40', '30'].),\n  (dos_unit:VARCHAR, recommended dosage unit. Value examples: ['mg', 'mg'].),\n  (dos_freq_hrs:INT, recommended number of hours between dosages. Value examples: ['336', '24'].),\n  (ndc:VARCHAR, National Drug Code. Value examples: ['12345-678-90', '54321-012-34'].),\n]\n# Table: diagnoses\n[\n  (diag_id:SERIAL,),\n  (diag_code:VARCHAR, Value examples: ['L40.1', 'L40.51'].),\n  (diag_name:VARCHAR, Value examples: ['Generalized pustular psoriasis', 'Distal interphalangeal psoriatic arthropathy'].),\n  (diag_desc:TEXT, Value examples: ['Widespread pustules on top of red skin', 'Psoriatic arthritis mainly affecting the ends of fingers and toes'].),\n]\n# Table: treatments\n[\n  (treatment_id:SERIAL,),\n  (patient_id:INT,),\n  (doc_id:INT,),\n  (drug_id:INT,),\n  (diag_id:INT,),\n  (start_dt:DATE,),\n  (end_dt:DATE, NULL if treatment is ongoing.),\n  (is_placebo:BOOLEAN,),\n  (tot_drug_amt:DECIMAL,),\n  (drug_unit:TEXT, possible values: mg, ml, g.),\n]\n# Table: outcomes\n[\n  (outcome_id:SERIAL,),\n  (treatment_id:INT, Value examples: ['1', '2', '3', '4'].),\n  (assess_dt:DATE, Value examples: ['2022-01-08', '2022-02-22', '2022-03-17', '2022-04-08'].),\n  (day7_lesion_cnt:INT, lesion counts on day 7.. Value examples: ['20', '25', '18', '30'].),\n  (day30_lesion_cnt:INT, Value examples: ['15', '18', '12', '25'].),\n  (day100_lesion_cnt:INT, Value examples: ['5', '8', '3', '12'].),\n  (day7_pasi_score:DECIMAL, PASI score range 0-72. Value examples: ['12.5', '15.0', '10.8', '18.2'].),\n  (day30_pasi_score:DECIMAL, Value examples: ['8.2', '10.1', '6.4', '13.9'].),\n  (day100_pasi_score:DECIMAL, Value examples: ['2.1', '3.5', '1.2', '5.8'].),\n  (day7_tewl:DECIMAL, in g/m^2/h. Value examples: ['18.2', '20.1', '16.5', '22.4'].),\n  (day30_tewl:DECIMAL, Value examples: ['15.6', '17.2', '14.0', '19.1'].),\n  (day100_tewl:DECIMAL, Value examples: ['12.1', '13.5', '10.8', '15.2'].),\n  (day7_itch_vas:INT, visual analog scale 0-100. Value examples: ['60', '70', '55', '80'].),\n  (day30_itch_vas:INT, Value examples: ['40', '50', '35', '60'].),\n  (day100_itch_vas:INT, Value examples: ['20', '30', '15', '40'].),\n  (day7_hfg:DECIMAL, hair growth factor range 0-5. Value examples: ['1.5', '1.0', '2.0', '0.5'].),\n  (day30_hfg:DECIMAL, Value examples: ['2.5', '2.0', '3.0', '1.5'].),\n  (day100_hfg:DECIMAL, Value examples: ['4.0', '3.5', '4.5', '3.0'].),\n]\n# Table: adverse_events\n[\n  (id:SERIAL, 1 row per adverse event per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '5'].),\n  (reported_dt:DATE, Value examples: ['2022-01-15', '2022-05-20'].),\n  (description:TEXT, Value examples: ['Mild injection site reaction', 'Upper respiratory infection'].),\n]\n# Table: concomitant_meds\n[\n  (id:SERIAL, 1 row per med per treatment_id.),\n  (treatment_id:INT, Value examples: ['1', '1', '2', '3'].),\n  (med_name:VARCHAR, Value examples: ['Acetaminophen', 'Ibuprofen', 'Loratadine', 'Multivitamin'].),\n  (start_dt:TEXT, YYYY-MM-DD. Value examples: ['2022-01-01', '2022-01-08', '2022-02-15', '2022-03-10'].),\n  (end_dt:TEXT, YYYY-MM-DD NULL if still taking. Value examples: ['2022-01-07', '2022-01-14', '2022-03-15', 'NULL'].),\n  (dose_amt:DECIMAL, Value examples: ['500', '200', '10', '1'].),\n  (dose_unit:TEXT, possible values: mg, ml, g. Value examples: ['mg', 'mg', 'mg', 'tablet'].),\n  (freq_hrs:INT, Value examples: ['6', '8', '24', '24'].),\n]\n\n【Foreign keys】\n\n【参考信息】\nTo discover the average weight of patients who have been prescribed a specific medication, begin by associating patients with treatments on patient_id, and then apply a filter by the drug name.\nD7D100PIR (day 7 to day 100 PASI improvement rate) = (avg PASI score on day 100 - avg PASI score on day 7) / avg PASI score on day 7 * 100. This should only include patients who have non-null PASI scores for both timepoints.\nTo identify doctors who have prescribed a certain type of drug and their state of practice, initially join doctors with treatments on doc_id, followed by filtering based on the drug type\nTo calculate the total number of adverse events reported for treatments involving topical drugs, first link treatments with adverse_events on treatment_id, then use a filter for the drug type\n\n【用户问题】\nWhat is the overall D7D100PIR across all treatments? Return the percentage value.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT (AVG(day100_pasi_score) - AVG(day7_pasi_score)) / AVG(day7_pasi_score) * 100 AS d7d100pir FROM outcomes WHERE day7_pasi_score IS NOT NULL AND day100_pasi_score IS NOT NULL",
        "role": "assistant"
      }
    ],
    "db_name": "derm_treatment",
    "id": 287,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the total number of wallet transactions sent by each user? Return the user ID and total transaction count.\n\n【数据库schema】\n【DB_ID】 ewallet\n【Schema】\n# Table: users\n[\n  (uid:BIGINT,),\n  (username:VARCHAR,),\n  (email:VARCHAR,),\n  (phone_number:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (last_login_at:TIMESTAMP,),\n  (user_type:VARCHAR, possible values: individual, business, admin.),\n  (status:VARCHAR, possible values: active, inactive, suspended, deleted.),\n  (country:VARCHAR, 2-letter country code.),\n  (address_billing:TEXT,),\n  (address_delivery:TEXT,),\n  (kyc_status:VARCHAR, possible values: pending, approved, rejected.),\n  (kyc_verified_at:TIMESTAMP,),\n]\n# Table: merchants\n[\n  (mid:BIGINT,),\n  (name:VARCHAR,),\n  (description:TEXT,),\n  (website_url:VARCHAR,),\n  (logo_url:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (country:VARCHAR, 2-letter country code.),\n  (state:VARCHAR,),\n  (city:VARCHAR,),\n  (postal_code:VARCHAR,),\n  (address:TEXT,),\n  (status:VARCHAR, possible values: active, inactive, suspended.),\n  (category:VARCHAR,),\n  (sub_category:VARCHAR,),\n  (mcc:INT, Merchant Category Code.),\n  (contact_name:VARCHAR,),\n  (contact_email:VARCHAR,),\n  (contact_phone:VARCHAR,),\n]\n# Table: coupons\n[\n  (cid:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (code:VARCHAR, Value examples: ['TECH20', 'NEWYEAR30', 'DINEDISCOUNT', 'HOME15'].),\n  (description:TEXT, Value examples: ['20% off tech and electronics', '30% off workout gear', 'Get $10 off $50 order', '15% off weekly rental'].),\n  (start_date:DATE, Value examples: ['2023-05-01', '2023-01-01', '2023-06-01', '2023-07-01'].),\n  (end_date:DATE, Value examples: ['2023-05-31', '2023-01-15', '2023-06-30', '2023-08-31'].),\n  (discount_type:VARCHAR, possible values: percentage, fixed_amount. Value examples: ['percentage', 'percentage', 'fixed_amount', 'percentage'].),\n  (discount_value:DECIMAL, Value examples: ['20.00', '30.00', '10.00', '15.00'].),\n  (min_purchase_amount:DECIMAL, Value examples: ['100.00', 'NULL', '50.00', '1000.00'].),\n  (max_discount_amount:DECIMAL, Value examples: ['NULL', 'NULL', '10.00', '300.00'].),\n  (redemption_limit:INT, Value examples: ['500', '1000', 'NULL', '200'].),\n  (status:VARCHAR, possible values: active, inactive, expired. Value examples: ['active', 'expired', 'active', 'active'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-04-01 09:00:00', '2022-12-01 12:00:00', '2023-05-15 15:30:00', '2023-05-01 09:15:00'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-04-15 11:30:00', '2023-01-16 18:45:00', 'NULL', 'NULL'].),\n]\n# Table: wallet_transactions_daily\n[\n  (txid:SERIAL,),\n  (sender_id:BIGINT, Value examples: ['1'].),\n  (sender_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (receiver_id:BIGINT, Value examples: ['1'].),\n  (receiver_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (amount:DECIMAL, Value examples: ['99.99'].),\n  (status:VARCHAR, possible values: pending, success, failed, refunded. Value examples: ['success'].),\n  (type:VARCHAR, possible values: credit, debit. Value examples: ['debit'].),\n  (description:TEXT, Value examples: ['Online purchase'].),\n  (coupon_id:BIGINT, NULL if transaction doesn't involve a coupon. Value examples: ['NULL'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:15:30'].),\n  (completed_at:TIMESTAMP, NULL if failed. Value examples: ['2023-06-01 10:15:45'].),\n  (transaction_ref:VARCHAR, randomly generated uuid4 for users' reference. Value examples: ['ad154bf7-8185-4230-a8d8-3ef59b4e0012'].),\n  (gateway_name:VARCHAR, Value examples: ['Stripe'].),\n  (gateway_ref:VARCHAR, Value examples: ['tx_123abc456def'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1'].),\n  (ip_address:VARCHAR, Value examples: ['192.168.0.1'].),\n  (user_agent:TEXT, Value examples: ['Mozilla/5.0 (iPhone'].),\n]\n# Table: wallet_user_balance_daily\n[\n  (user_id:BIGINT, Value examples: ['1', '2'].),\n  (balance:DECIMAL, Value examples: ['525.80', '429.76'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: wallet_merchant_balance_daily\n[\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3'].),\n  (balance:DECIMAL, Value examples: ['3897.99', '155.24', '2775.25'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: notifications\n[\n  (id:SERIAL,),\n  (user_id:INT, Value examples: ['1', '1', '2'].),\n  (message:TEXT, Value examples: ['Your order #123abc has been shipped!', 'Get 20% off your next purchase! Limited time offer.', 'A package is being returned to you. Refund processing...'].),\n  (type:VARCHAR, possible values: transaction, promotion, security, general. Value examples: ['transaction', 'promotion', 'transaction'].),\n  (status:VARCHAR, possible values: unread, read, archived. Value examples: ['unread', 'unread', 'read'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:16:00', '2023-06-02 09:00:00', '2023-06-07 10:12:00'].),\n  (read_at:TIMESTAMP, NULL if not read.),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'email', 'mobile_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'NULL', 'mobile_1av8p0'].),\n  (action_url:TEXT, can be external https or deeplink url within the app. Value examples: ['app://orders/123abc', 'https://techmart.com/promo/TECH20', 'app://orders?status=returned'].),\n]\n# Table: user_sessions\n[\n  (user_id:BIGINT, Value examples: ['1', '1', '1'].),\n  (session_start_ts:TIMESTAMP, Value examples: ['2023-06-01 09:45:22', '2023-06-02 13:30:00', '2023-06-06 14:19:00'].),\n  (session_end_ts:TIMESTAMP, Value examples: ['2023-06-01 10:20:35', '2023-06-02 14:15:15', '2023-06-06 14:22:10'].),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'web_app', 'web_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'web_33lq1dh', 'web_33lq1dh'].),\n]\n# Table: user_setting_snapshot\n[\n  (user_id:BIGINT, Value examples: ['1', '4', '5'].),\n  (snapshot_date:DATE, Value examples: ['2023-06-07', '2023-06-07', '2023-06-07'].),\n  (tx_limit_daily:DECIMAL, Value examples: ['1000.00', '5000.00', '100.00'].),\n  (tx_limit_monthly:DECIMAL, Value examples: ['5000.00', '20000.00', '500.00'].),\n  (membership_status:INTEGER, 0 for bronze, 1 for silver, 2 for gold, 3 for platinum, 4 for VIP. Value examples: ['2', '4', '0'].),\n  (password_hash:VARCHAR, Value examples: ['bcryptHash($2yz9!&ka1)', 'bcryptHash(Vacay2023*&!Rm)', 'bcryptHash(cRaf7yCr8zy)'].),\n  (api_key:VARCHAR, Value examples: ['9d61c49b-8977-4914-a36b-80d1445e38fa', 'NULL', 'NULL'].),\n  (verified_devices:TEXT, comma separated list of device ids. Value examples: ['mobile_8fh2k1', 'mobile_34jdkl', 'web_8902wknz'].),\n  (verified_ips:TEXT, comma separated list of IP addresses. Value examples: ['192.168.0.1', '143.92.64.138', '192.64.112.188'].),\n  (mfa_enabled:BOOLEAN, Value examples: ['true', 'false', 'false'].),\n  (marketing_opt_in:BOOLEAN, Value examples: ['false', 'true', 'false'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-07 00:00:00', '2023-06-07 00:00:00', '2023-06-07 00:00:00'].),\n  (PRIMARY:KEY,),\n]\n\n【Foreign keys】\n\n【参考信息】\nPMDAU = Aggregate daily active users by truncating the date to the month for aggregation.\nAMB = Average balance of user wallets\nLUB = Most recent balance for each user\nTo get the total number of transactions per user, join the users and wallet_transactions_daily tables in a CTE, then aggregate by user_id and count the number of transactions\n\n【用户问题】\nWhat is the total number of wallet transactions sent by each user? Return the user ID and total transaction count.\n\n```sql",
        "role": "user"
      },
      {
        "content": "WITH user_transactions AS (SELECT u.uid, t.txid FROM consumer_div.users u JOIN consumer_div.wallet_transactions_daily t ON u.uid = t.sender_id WHERE t.sender_type = 0) SELECT UID, COUNT(txid) AS total_transactions FROM user_transactions GROUP BY UID",
        "role": "assistant"
      }
    ],
    "db_name": "ewallet",
    "id": 288,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the total transaction amount for each coupon offered by merchant with ID 1? Return the coupon ID and total amount transacted with it.\n\n【数据库schema】\n【DB_ID】 ewallet\n【Schema】\n# Table: users\n[\n  (uid:BIGINT,),\n  (username:VARCHAR,),\n  (email:VARCHAR,),\n  (phone_number:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (last_login_at:TIMESTAMP,),\n  (user_type:VARCHAR, possible values: individual, business, admin.),\n  (status:VARCHAR, possible values: active, inactive, suspended, deleted.),\n  (country:VARCHAR, 2-letter country code.),\n  (address_billing:TEXT,),\n  (address_delivery:TEXT,),\n  (kyc_status:VARCHAR, possible values: pending, approved, rejected.),\n  (kyc_verified_at:TIMESTAMP,),\n]\n# Table: merchants\n[\n  (mid:BIGINT,),\n  (name:VARCHAR,),\n  (description:TEXT,),\n  (website_url:VARCHAR,),\n  (logo_url:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (country:VARCHAR, 2-letter country code.),\n  (state:VARCHAR,),\n  (city:VARCHAR,),\n  (postal_code:VARCHAR,),\n  (address:TEXT,),\n  (status:VARCHAR, possible values: active, inactive, suspended.),\n  (category:VARCHAR,),\n  (sub_category:VARCHAR,),\n  (mcc:INT, Merchant Category Code.),\n  (contact_name:VARCHAR,),\n  (contact_email:VARCHAR,),\n  (contact_phone:VARCHAR,),\n]\n# Table: coupons\n[\n  (cid:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (code:VARCHAR, Value examples: ['TECH20', 'NEWYEAR30', 'DINEDISCOUNT', 'HOME15'].),\n  (description:TEXT, Value examples: ['20% off tech and electronics', '30% off workout gear', 'Get $10 off $50 order', '15% off weekly rental'].),\n  (start_date:DATE, Value examples: ['2023-05-01', '2023-01-01', '2023-06-01', '2023-07-01'].),\n  (end_date:DATE, Value examples: ['2023-05-31', '2023-01-15', '2023-06-30', '2023-08-31'].),\n  (discount_type:VARCHAR, possible values: percentage, fixed_amount. Value examples: ['percentage', 'percentage', 'fixed_amount', 'percentage'].),\n  (discount_value:DECIMAL, Value examples: ['20.00', '30.00', '10.00', '15.00'].),\n  (min_purchase_amount:DECIMAL, Value examples: ['100.00', 'NULL', '50.00', '1000.00'].),\n  (max_discount_amount:DECIMAL, Value examples: ['NULL', 'NULL', '10.00', '300.00'].),\n  (redemption_limit:INT, Value examples: ['500', '1000', 'NULL', '200'].),\n  (status:VARCHAR, possible values: active, inactive, expired. Value examples: ['active', 'expired', 'active', 'active'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-04-01 09:00:00', '2022-12-01 12:00:00', '2023-05-15 15:30:00', '2023-05-01 09:15:00'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-04-15 11:30:00', '2023-01-16 18:45:00', 'NULL', 'NULL'].),\n]\n# Table: wallet_transactions_daily\n[\n  (txid:SERIAL,),\n  (sender_id:BIGINT, Value examples: ['1'].),\n  (sender_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (receiver_id:BIGINT, Value examples: ['1'].),\n  (receiver_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (amount:DECIMAL, Value examples: ['99.99'].),\n  (status:VARCHAR, possible values: pending, success, failed, refunded. Value examples: ['success'].),\n  (type:VARCHAR, possible values: credit, debit. Value examples: ['debit'].),\n  (description:TEXT, Value examples: ['Online purchase'].),\n  (coupon_id:BIGINT, NULL if transaction doesn't involve a coupon. Value examples: ['NULL'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:15:30'].),\n  (completed_at:TIMESTAMP, NULL if failed. Value examples: ['2023-06-01 10:15:45'].),\n  (transaction_ref:VARCHAR, randomly generated uuid4 for users' reference. Value examples: ['ad154bf7-8185-4230-a8d8-3ef59b4e0012'].),\n  (gateway_name:VARCHAR, Value examples: ['Stripe'].),\n  (gateway_ref:VARCHAR, Value examples: ['tx_123abc456def'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1'].),\n  (ip_address:VARCHAR, Value examples: ['192.168.0.1'].),\n  (user_agent:TEXT, Value examples: ['Mozilla/5.0 (iPhone'].),\n]\n# Table: wallet_user_balance_daily\n[\n  (user_id:BIGINT, Value examples: ['1', '2'].),\n  (balance:DECIMAL, Value examples: ['525.80', '429.76'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: wallet_merchant_balance_daily\n[\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3'].),\n  (balance:DECIMAL, Value examples: ['3897.99', '155.24', '2775.25'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: notifications\n[\n  (id:SERIAL,),\n  (user_id:INT, Value examples: ['1', '1', '2'].),\n  (message:TEXT, Value examples: ['Your order #123abc has been shipped!', 'Get 20% off your next purchase! Limited time offer.', 'A package is being returned to you. Refund processing...'].),\n  (type:VARCHAR, possible values: transaction, promotion, security, general. Value examples: ['transaction', 'promotion', 'transaction'].),\n  (status:VARCHAR, possible values: unread, read, archived. Value examples: ['unread', 'unread', 'read'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:16:00', '2023-06-02 09:00:00', '2023-06-07 10:12:00'].),\n  (read_at:TIMESTAMP, NULL if not read.),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'email', 'mobile_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'NULL', 'mobile_1av8p0'].),\n  (action_url:TEXT, can be external https or deeplink url within the app. Value examples: ['app://orders/123abc', 'https://techmart.com/promo/TECH20', 'app://orders?status=returned'].),\n]\n# Table: user_sessions\n[\n  (user_id:BIGINT, Value examples: ['1', '1', '1'].),\n  (session_start_ts:TIMESTAMP, Value examples: ['2023-06-01 09:45:22', '2023-06-02 13:30:00', '2023-06-06 14:19:00'].),\n  (session_end_ts:TIMESTAMP, Value examples: ['2023-06-01 10:20:35', '2023-06-02 14:15:15', '2023-06-06 14:22:10'].),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'web_app', 'web_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'web_33lq1dh', 'web_33lq1dh'].),\n]\n# Table: user_setting_snapshot\n[\n  (user_id:BIGINT, Value examples: ['1', '4', '5'].),\n  (snapshot_date:DATE, Value examples: ['2023-06-07', '2023-06-07', '2023-06-07'].),\n  (tx_limit_daily:DECIMAL, Value examples: ['1000.00', '5000.00', '100.00'].),\n  (tx_limit_monthly:DECIMAL, Value examples: ['5000.00', '20000.00', '500.00'].),\n  (membership_status:INTEGER, 0 for bronze, 1 for silver, 2 for gold, 3 for platinum, 4 for VIP. Value examples: ['2', '4', '0'].),\n  (password_hash:VARCHAR, Value examples: ['bcryptHash($2yz9!&ka1)', 'bcryptHash(Vacay2023*&!Rm)', 'bcryptHash(cRaf7yCr8zy)'].),\n  (api_key:VARCHAR, Value examples: ['9d61c49b-8977-4914-a36b-80d1445e38fa', 'NULL', 'NULL'].),\n  (verified_devices:TEXT, comma separated list of device ids. Value examples: ['mobile_8fh2k1', 'mobile_34jdkl', 'web_8902wknz'].),\n  (verified_ips:TEXT, comma separated list of IP addresses. Value examples: ['192.168.0.1', '143.92.64.138', '192.64.112.188'].),\n  (mfa_enabled:BOOLEAN, Value examples: ['true', 'false', 'false'].),\n  (marketing_opt_in:BOOLEAN, Value examples: ['false', 'true', 'false'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-07 00:00:00', '2023-06-07 00:00:00', '2023-06-07 00:00:00'].),\n  (PRIMARY:KEY,),\n]\n\n【Foreign keys】\n\n【参考信息】\nAMB = Average balance of user wallets updated recently\nTo get coupon usage, join the coupons and wallet_transactions_daily on coupon_id \nSTR (success transaction rate) = Number of successful transactions divided by total transactions\nPMDAU = Aggregation based on truncating creation dates to months for active user metrics.\n\n【用户问题】\nWhat is the total transaction amount for each coupon offered by merchant with ID 1? Return the coupon ID and total amount transacted with it.\n\n```sql",
        "role": "user"
      },
      {
        "content": "WITH merchant_coupon_usage AS (SELECT c.cid, t.amount FROM consumer_div.coupons c JOIN consumer_div.wallet_transactions_daily t ON c.cid = t.coupon_id WHERE c.merchant_id = 1) SELECT cid, SUM(amount) AS total_discount FROM merchant_coupon_usage GROUP BY cid",
        "role": "assistant"
      }
    ],
    "db_name": "ewallet",
    "id": 289,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the total session duration in seconds for each user between 2023-06-01 inclusive and 2023-06-08 exclusive? Return the user ID and their total duration sorted by total duration with the longest duration first\n\n【数据库schema】\n【DB_ID】 ewallet\n【Schema】\n# Table: users\n[\n  (uid:BIGINT,),\n  (username:VARCHAR,),\n  (email:VARCHAR,),\n  (phone_number:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (last_login_at:TIMESTAMP,),\n  (user_type:VARCHAR, possible values: individual, business, admin.),\n  (status:VARCHAR, possible values: active, inactive, suspended, deleted.),\n  (country:VARCHAR, 2-letter country code.),\n  (address_billing:TEXT,),\n  (address_delivery:TEXT,),\n  (kyc_status:VARCHAR, possible values: pending, approved, rejected.),\n  (kyc_verified_at:TIMESTAMP,),\n]\n# Table: merchants\n[\n  (mid:BIGINT,),\n  (name:VARCHAR,),\n  (description:TEXT,),\n  (website_url:VARCHAR,),\n  (logo_url:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (country:VARCHAR, 2-letter country code.),\n  (state:VARCHAR,),\n  (city:VARCHAR,),\n  (postal_code:VARCHAR,),\n  (address:TEXT,),\n  (status:VARCHAR, possible values: active, inactive, suspended.),\n  (category:VARCHAR,),\n  (sub_category:VARCHAR,),\n  (mcc:INT, Merchant Category Code.),\n  (contact_name:VARCHAR,),\n  (contact_email:VARCHAR,),\n  (contact_phone:VARCHAR,),\n]\n# Table: coupons\n[\n  (cid:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (code:VARCHAR, Value examples: ['TECH20', 'NEWYEAR30', 'DINEDISCOUNT', 'HOME15'].),\n  (description:TEXT, Value examples: ['20% off tech and electronics', '30% off workout gear', 'Get $10 off $50 order', '15% off weekly rental'].),\n  (start_date:DATE, Value examples: ['2023-05-01', '2023-01-01', '2023-06-01', '2023-07-01'].),\n  (end_date:DATE, Value examples: ['2023-05-31', '2023-01-15', '2023-06-30', '2023-08-31'].),\n  (discount_type:VARCHAR, possible values: percentage, fixed_amount. Value examples: ['percentage', 'percentage', 'fixed_amount', 'percentage'].),\n  (discount_value:DECIMAL, Value examples: ['20.00', '30.00', '10.00', '15.00'].),\n  (min_purchase_amount:DECIMAL, Value examples: ['100.00', 'NULL', '50.00', '1000.00'].),\n  (max_discount_amount:DECIMAL, Value examples: ['NULL', 'NULL', '10.00', '300.00'].),\n  (redemption_limit:INT, Value examples: ['500', '1000', 'NULL', '200'].),\n  (status:VARCHAR, possible values: active, inactive, expired. Value examples: ['active', 'expired', 'active', 'active'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-04-01 09:00:00', '2022-12-01 12:00:00', '2023-05-15 15:30:00', '2023-05-01 09:15:00'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-04-15 11:30:00', '2023-01-16 18:45:00', 'NULL', 'NULL'].),\n]\n# Table: wallet_transactions_daily\n[\n  (txid:SERIAL,),\n  (sender_id:BIGINT, Value examples: ['1'].),\n  (sender_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (receiver_id:BIGINT, Value examples: ['1'].),\n  (receiver_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (amount:DECIMAL, Value examples: ['99.99'].),\n  (status:VARCHAR, possible values: pending, success, failed, refunded. Value examples: ['success'].),\n  (type:VARCHAR, possible values: credit, debit. Value examples: ['debit'].),\n  (description:TEXT, Value examples: ['Online purchase'].),\n  (coupon_id:BIGINT, NULL if transaction doesn't involve a coupon. Value examples: ['NULL'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:15:30'].),\n  (completed_at:TIMESTAMP, NULL if failed. Value examples: ['2023-06-01 10:15:45'].),\n  (transaction_ref:VARCHAR, randomly generated uuid4 for users' reference. Value examples: ['ad154bf7-8185-4230-a8d8-3ef59b4e0012'].),\n  (gateway_name:VARCHAR, Value examples: ['Stripe'].),\n  (gateway_ref:VARCHAR, Value examples: ['tx_123abc456def'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1'].),\n  (ip_address:VARCHAR, Value examples: ['192.168.0.1'].),\n  (user_agent:TEXT, Value examples: ['Mozilla/5.0 (iPhone'].),\n]\n# Table: wallet_user_balance_daily\n[\n  (user_id:BIGINT, Value examples: ['1', '2'].),\n  (balance:DECIMAL, Value examples: ['525.80', '429.76'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: wallet_merchant_balance_daily\n[\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3'].),\n  (balance:DECIMAL, Value examples: ['3897.99', '155.24', '2775.25'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: notifications\n[\n  (id:SERIAL,),\n  (user_id:INT, Value examples: ['1', '1', '2'].),\n  (message:TEXT, Value examples: ['Your order #123abc has been shipped!', 'Get 20% off your next purchase! Limited time offer.', 'A package is being returned to you. Refund processing...'].),\n  (type:VARCHAR, possible values: transaction, promotion, security, general. Value examples: ['transaction', 'promotion', 'transaction'].),\n  (status:VARCHAR, possible values: unread, read, archived. Value examples: ['unread', 'unread', 'read'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:16:00', '2023-06-02 09:00:00', '2023-06-07 10:12:00'].),\n  (read_at:TIMESTAMP, NULL if not read.),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'email', 'mobile_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'NULL', 'mobile_1av8p0'].),\n  (action_url:TEXT, can be external https or deeplink url within the app. Value examples: ['app://orders/123abc', 'https://techmart.com/promo/TECH20', 'app://orders?status=returned'].),\n]\n# Table: user_sessions\n[\n  (user_id:BIGINT, Value examples: ['1', '1', '1'].),\n  (session_start_ts:TIMESTAMP, Value examples: ['2023-06-01 09:45:22', '2023-06-02 13:30:00', '2023-06-06 14:19:00'].),\n  (session_end_ts:TIMESTAMP, Value examples: ['2023-06-01 10:20:35', '2023-06-02 14:15:15', '2023-06-06 14:22:10'].),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'web_app', 'web_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'web_33lq1dh', 'web_33lq1dh'].),\n]\n# Table: user_setting_snapshot\n[\n  (user_id:BIGINT, Value examples: ['1', '4', '5'].),\n  (snapshot_date:DATE, Value examples: ['2023-06-07', '2023-06-07', '2023-06-07'].),\n  (tx_limit_daily:DECIMAL, Value examples: ['1000.00', '5000.00', '100.00'].),\n  (tx_limit_monthly:DECIMAL, Value examples: ['5000.00', '20000.00', '500.00'].),\n  (membership_status:INTEGER, 0 for bronze, 1 for silver, 2 for gold, 3 for platinum, 4 for VIP. Value examples: ['2', '4', '0'].),\n  (password_hash:VARCHAR, Value examples: ['bcryptHash($2yz9!&ka1)', 'bcryptHash(Vacay2023*&!Rm)', 'bcryptHash(cRaf7yCr8zy)'].),\n  (api_key:VARCHAR, Value examples: ['9d61c49b-8977-4914-a36b-80d1445e38fa', 'NULL', 'NULL'].),\n  (verified_devices:TEXT, comma separated list of device ids. Value examples: ['mobile_8fh2k1', 'mobile_34jdkl', 'web_8902wknz'].),\n  (verified_ips:TEXT, comma separated list of IP addresses. Value examples: ['192.168.0.1', '143.92.64.138', '192.64.112.188'].),\n  (mfa_enabled:BOOLEAN, Value examples: ['true', 'false', 'false'].),\n  (marketing_opt_in:BOOLEAN, Value examples: ['false', 'true', 'false'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-07 00:00:00', '2023-06-07 00:00:00', '2023-06-07 00:00:00'].),\n  (PRIMARY:KEY,),\n]\n\n【Foreign keys】\n\n【参考信息】\nLUB = Most recent account balance for each user. CPUR (coupon usage rate) = Ratio of distinct coupons used to the number of distinct transactions AMB = Average balance of user wallets over a specified period To analyze user engagement, join the users and user_sessions tables in a CTE, then aggregate to calculate total session duration per user for a given date range\n\n【用户问题】\nWhat is the total session duration in seconds for each user between 2023-06-01 inclusive and 2023-06-08 exclusive? Return the user ID and their total duration sorted by total duration with the longest duration first\n\n```sql",
        "role": "user"
      },
      {
        "content": "WITH user_session_duration AS (SELECT u.uid, s.session_start_ts, s.session_end_ts FROM consumer_div.users u JOIN consumer_div.user_sessions s ON u.uid = s.user_id WHERE s.session_start_ts >= '2023-06-01' AND s.session_end_ts < '2023-06-08') SELECT UID, SUM(EXTRACT(EPOCH FROM session_end_ts) - EXTRACT(EPOCH FROM session_start_ts)) AS total_duration FROM user_session_duration GROUP BY UID ORDER BY total_duration DESC",
        "role": "assistant"
      }
    ],
    "db_name": "ewallet",
    "id": 290,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the marketing opt-in preference for each user? Return the user ID and boolean opt-in value\n\n【数据库schema】\n【DB_ID】 ewallet\n【Schema】\n# Table: users\n[\n  (uid:BIGINT,),\n  (username:VARCHAR,),\n  (email:VARCHAR,),\n  (phone_number:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (last_login_at:TIMESTAMP,),\n  (user_type:VARCHAR, possible values: individual, business, admin.),\n  (status:VARCHAR, possible values: active, inactive, suspended, deleted.),\n  (country:VARCHAR, 2-letter country code.),\n  (address_billing:TEXT,),\n  (address_delivery:TEXT,),\n  (kyc_status:VARCHAR, possible values: pending, approved, rejected.),\n  (kyc_verified_at:TIMESTAMP,),\n]\n# Table: merchants\n[\n  (mid:BIGINT,),\n  (name:VARCHAR,),\n  (description:TEXT,),\n  (website_url:VARCHAR,),\n  (logo_url:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (country:VARCHAR, 2-letter country code.),\n  (state:VARCHAR,),\n  (city:VARCHAR,),\n  (postal_code:VARCHAR,),\n  (address:TEXT,),\n  (status:VARCHAR, possible values: active, inactive, suspended.),\n  (category:VARCHAR,),\n  (sub_category:VARCHAR,),\n  (mcc:INT, Merchant Category Code.),\n  (contact_name:VARCHAR,),\n  (contact_email:VARCHAR,),\n  (contact_phone:VARCHAR,),\n]\n# Table: coupons\n[\n  (cid:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (code:VARCHAR, Value examples: ['TECH20', 'NEWYEAR30', 'DINEDISCOUNT', 'HOME15'].),\n  (description:TEXT, Value examples: ['20% off tech and electronics', '30% off workout gear', 'Get $10 off $50 order', '15% off weekly rental'].),\n  (start_date:DATE, Value examples: ['2023-05-01', '2023-01-01', '2023-06-01', '2023-07-01'].),\n  (end_date:DATE, Value examples: ['2023-05-31', '2023-01-15', '2023-06-30', '2023-08-31'].),\n  (discount_type:VARCHAR, possible values: percentage, fixed_amount. Value examples: ['percentage', 'percentage', 'fixed_amount', 'percentage'].),\n  (discount_value:DECIMAL, Value examples: ['20.00', '30.00', '10.00', '15.00'].),\n  (min_purchase_amount:DECIMAL, Value examples: ['100.00', 'NULL', '50.00', '1000.00'].),\n  (max_discount_amount:DECIMAL, Value examples: ['NULL', 'NULL', '10.00', '300.00'].),\n  (redemption_limit:INT, Value examples: ['500', '1000', 'NULL', '200'].),\n  (status:VARCHAR, possible values: active, inactive, expired. Value examples: ['active', 'expired', 'active', 'active'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-04-01 09:00:00', '2022-12-01 12:00:00', '2023-05-15 15:30:00', '2023-05-01 09:15:00'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-04-15 11:30:00', '2023-01-16 18:45:00', 'NULL', 'NULL'].),\n]\n# Table: wallet_transactions_daily\n[\n  (txid:SERIAL,),\n  (sender_id:BIGINT, Value examples: ['1'].),\n  (sender_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (receiver_id:BIGINT, Value examples: ['1'].),\n  (receiver_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (amount:DECIMAL, Value examples: ['99.99'].),\n  (status:VARCHAR, possible values: pending, success, failed, refunded. Value examples: ['success'].),\n  (type:VARCHAR, possible values: credit, debit. Value examples: ['debit'].),\n  (description:TEXT, Value examples: ['Online purchase'].),\n  (coupon_id:BIGINT, NULL if transaction doesn't involve a coupon. Value examples: ['NULL'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:15:30'].),\n  (completed_at:TIMESTAMP, NULL if failed. Value examples: ['2023-06-01 10:15:45'].),\n  (transaction_ref:VARCHAR, randomly generated uuid4 for users' reference. Value examples: ['ad154bf7-8185-4230-a8d8-3ef59b4e0012'].),\n  (gateway_name:VARCHAR, Value examples: ['Stripe'].),\n  (gateway_ref:VARCHAR, Value examples: ['tx_123abc456def'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1'].),\n  (ip_address:VARCHAR, Value examples: ['192.168.0.1'].),\n  (user_agent:TEXT, Value examples: ['Mozilla/5.0 (iPhone'].),\n]\n# Table: wallet_user_balance_daily\n[\n  (user_id:BIGINT, Value examples: ['1', '2'].),\n  (balance:DECIMAL, Value examples: ['525.80', '429.76'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: wallet_merchant_balance_daily\n[\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3'].),\n  (balance:DECIMAL, Value examples: ['3897.99', '155.24', '2775.25'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: notifications\n[\n  (id:SERIAL,),\n  (user_id:INT, Value examples: ['1', '1', '2'].),\n  (message:TEXT, Value examples: ['Your order #123abc has been shipped!', 'Get 20% off your next purchase! Limited time offer.', 'A package is being returned to you. Refund processing...'].),\n  (type:VARCHAR, possible values: transaction, promotion, security, general. Value examples: ['transaction', 'promotion', 'transaction'].),\n  (status:VARCHAR, possible values: unread, read, archived. Value examples: ['unread', 'unread', 'read'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:16:00', '2023-06-02 09:00:00', '2023-06-07 10:12:00'].),\n  (read_at:TIMESTAMP, NULL if not read.),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'email', 'mobile_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'NULL', 'mobile_1av8p0'].),\n  (action_url:TEXT, can be external https or deeplink url within the app. Value examples: ['app://orders/123abc', 'https://techmart.com/promo/TECH20', 'app://orders?status=returned'].),\n]\n# Table: user_sessions\n[\n  (user_id:BIGINT, Value examples: ['1', '1', '1'].),\n  (session_start_ts:TIMESTAMP, Value examples: ['2023-06-01 09:45:22', '2023-06-02 13:30:00', '2023-06-06 14:19:00'].),\n  (session_end_ts:TIMESTAMP, Value examples: ['2023-06-01 10:20:35', '2023-06-02 14:15:15', '2023-06-06 14:22:10'].),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'web_app', 'web_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'web_33lq1dh', 'web_33lq1dh'].),\n]\n# Table: user_setting_snapshot\n[\n  (user_id:BIGINT, Value examples: ['1', '4', '5'].),\n  (snapshot_date:DATE, Value examples: ['2023-06-07', '2023-06-07', '2023-06-07'].),\n  (tx_limit_daily:DECIMAL, Value examples: ['1000.00', '5000.00', '100.00'].),\n  (tx_limit_monthly:DECIMAL, Value examples: ['5000.00', '20000.00', '500.00'].),\n  (membership_status:INTEGER, 0 for bronze, 1 for silver, 2 for gold, 3 for platinum, 4 for VIP. Value examples: ['2', '4', '0'].),\n  (password_hash:VARCHAR, Value examples: ['bcryptHash($2yz9!&ka1)', 'bcryptHash(Vacay2023*&!Rm)', 'bcryptHash(cRaf7yCr8zy)'].),\n  (api_key:VARCHAR, Value examples: ['9d61c49b-8977-4914-a36b-80d1445e38fa', 'NULL', 'NULL'].),\n  (verified_devices:TEXT, comma separated list of device ids. Value examples: ['mobile_8fh2k1', 'mobile_34jdkl', 'web_8902wknz'].),\n  (verified_ips:TEXT, comma separated list of IP addresses. Value examples: ['192.168.0.1', '143.92.64.138', '192.64.112.188'].),\n  (mfa_enabled:BOOLEAN, Value examples: ['true', 'false', 'false'].),\n  (marketing_opt_in:BOOLEAN, Value examples: ['false', 'true', 'false'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-07 00:00:00', '2023-06-07 00:00:00', '2023-06-07 00:00:00'].),\n  (PRIMARY:KEY,),\n]\n\n【Foreign keys】\n\n【参考信息】\nCPUR (coupon usage rate) = Ratio of distinct coupons used to number of distinct transactions.\nAMB = Average balance of user wallets over a recent period\nSTR (success transaction rate) = Ratio of successful transactions to total transactions\nTo get any user's settings, only select the latest snapshot of user_setting_snapshot for each user\n\n【用户问题】\nWhat is the marketing opt-in preference for each user? Return the user ID and boolean opt-in value\n\n```sql",
        "role": "user"
      },
      {
        "content": "WITH user_latest_setting AS (SELECT u.uid, s.marketing_opt_in, s.created_at, ROW_NUMBER() OVER (PARTITION BY u.uid ORDER BY s.created_at DESC) AS rn FROM consumer_div.users u JOIN consumer_div.user_setting_snapshot s ON u.uid = s.user_id) SELECT UID, marketing_opt_in FROM user_latest_setting WHERE rn = 1",
        "role": "assistant"
      }
    ],
    "db_name": "ewallet",
    "id": 291,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the LUB for each user.\n\n【数据库schema】\n【DB_ID】 ewallet\n【Schema】\n# Table: users\n[\n  (uid:BIGINT,),\n  (username:VARCHAR,),\n  (email:VARCHAR,),\n  (phone_number:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (last_login_at:TIMESTAMP,),\n  (user_type:VARCHAR, possible values: individual, business, admin.),\n  (status:VARCHAR, possible values: active, inactive, suspended, deleted.),\n  (country:VARCHAR, 2-letter country code.),\n  (address_billing:TEXT,),\n  (address_delivery:TEXT,),\n  (kyc_status:VARCHAR, possible values: pending, approved, rejected.),\n  (kyc_verified_at:TIMESTAMP,),\n]\n# Table: merchants\n[\n  (mid:BIGINT,),\n  (name:VARCHAR,),\n  (description:TEXT,),\n  (website_url:VARCHAR,),\n  (logo_url:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (country:VARCHAR, 2-letter country code.),\n  (state:VARCHAR,),\n  (city:VARCHAR,),\n  (postal_code:VARCHAR,),\n  (address:TEXT,),\n  (status:VARCHAR, possible values: active, inactive, suspended.),\n  (category:VARCHAR,),\n  (sub_category:VARCHAR,),\n  (mcc:INT, Merchant Category Code.),\n  (contact_name:VARCHAR,),\n  (contact_email:VARCHAR,),\n  (contact_phone:VARCHAR,),\n]\n# Table: coupons\n[\n  (cid:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (code:VARCHAR, Value examples: ['TECH20', 'NEWYEAR30', 'DINEDISCOUNT', 'HOME15'].),\n  (description:TEXT, Value examples: ['20% off tech and electronics', '30% off workout gear', 'Get $10 off $50 order', '15% off weekly rental'].),\n  (start_date:DATE, Value examples: ['2023-05-01', '2023-01-01', '2023-06-01', '2023-07-01'].),\n  (end_date:DATE, Value examples: ['2023-05-31', '2023-01-15', '2023-06-30', '2023-08-31'].),\n  (discount_type:VARCHAR, possible values: percentage, fixed_amount. Value examples: ['percentage', 'percentage', 'fixed_amount', 'percentage'].),\n  (discount_value:DECIMAL, Value examples: ['20.00', '30.00', '10.00', '15.00'].),\n  (min_purchase_amount:DECIMAL, Value examples: ['100.00', 'NULL', '50.00', '1000.00'].),\n  (max_discount_amount:DECIMAL, Value examples: ['NULL', 'NULL', '10.00', '300.00'].),\n  (redemption_limit:INT, Value examples: ['500', '1000', 'NULL', '200'].),\n  (status:VARCHAR, possible values: active, inactive, expired. Value examples: ['active', 'expired', 'active', 'active'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-04-01 09:00:00', '2022-12-01 12:00:00', '2023-05-15 15:30:00', '2023-05-01 09:15:00'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-04-15 11:30:00', '2023-01-16 18:45:00', 'NULL', 'NULL'].),\n]\n# Table: wallet_transactions_daily\n[\n  (txid:SERIAL,),\n  (sender_id:BIGINT, Value examples: ['1'].),\n  (sender_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (receiver_id:BIGINT, Value examples: ['1'].),\n  (receiver_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (amount:DECIMAL, Value examples: ['99.99'].),\n  (status:VARCHAR, possible values: pending, success, failed, refunded. Value examples: ['success'].),\n  (type:VARCHAR, possible values: credit, debit. Value examples: ['debit'].),\n  (description:TEXT, Value examples: ['Online purchase'].),\n  (coupon_id:BIGINT, NULL if transaction doesn't involve a coupon. Value examples: ['NULL'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:15:30'].),\n  (completed_at:TIMESTAMP, NULL if failed. Value examples: ['2023-06-01 10:15:45'].),\n  (transaction_ref:VARCHAR, randomly generated uuid4 for users' reference. Value examples: ['ad154bf7-8185-4230-a8d8-3ef59b4e0012'].),\n  (gateway_name:VARCHAR, Value examples: ['Stripe'].),\n  (gateway_ref:VARCHAR, Value examples: ['tx_123abc456def'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1'].),\n  (ip_address:VARCHAR, Value examples: ['192.168.0.1'].),\n  (user_agent:TEXT, Value examples: ['Mozilla/5.0 (iPhone'].),\n]\n# Table: wallet_user_balance_daily\n[\n  (user_id:BIGINT, Value examples: ['1', '2'].),\n  (balance:DECIMAL, Value examples: ['525.80', '429.76'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: wallet_merchant_balance_daily\n[\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3'].),\n  (balance:DECIMAL, Value examples: ['3897.99', '155.24', '2775.25'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: notifications\n[\n  (id:SERIAL,),\n  (user_id:INT, Value examples: ['1', '1', '2'].),\n  (message:TEXT, Value examples: ['Your order #123abc has been shipped!', 'Get 20% off your next purchase! Limited time offer.', 'A package is being returned to you. Refund processing...'].),\n  (type:VARCHAR, possible values: transaction, promotion, security, general. Value examples: ['transaction', 'promotion', 'transaction'].),\n  (status:VARCHAR, possible values: unread, read, archived. Value examples: ['unread', 'unread', 'read'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:16:00', '2023-06-02 09:00:00', '2023-06-07 10:12:00'].),\n  (read_at:TIMESTAMP, NULL if not read.),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'email', 'mobile_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'NULL', 'mobile_1av8p0'].),\n  (action_url:TEXT, can be external https or deeplink url within the app. Value examples: ['app://orders/123abc', 'https://techmart.com/promo/TECH20', 'app://orders?status=returned'].),\n]\n# Table: user_sessions\n[\n  (user_id:BIGINT, Value examples: ['1', '1', '1'].),\n  (session_start_ts:TIMESTAMP, Value examples: ['2023-06-01 09:45:22', '2023-06-02 13:30:00', '2023-06-06 14:19:00'].),\n  (session_end_ts:TIMESTAMP, Value examples: ['2023-06-01 10:20:35', '2023-06-02 14:15:15', '2023-06-06 14:22:10'].),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'web_app', 'web_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'web_33lq1dh', 'web_33lq1dh'].),\n]\n# Table: user_setting_snapshot\n[\n  (user_id:BIGINT, Value examples: ['1', '4', '5'].),\n  (snapshot_date:DATE, Value examples: ['2023-06-07', '2023-06-07', '2023-06-07'].),\n  (tx_limit_daily:DECIMAL, Value examples: ['1000.00', '5000.00', '100.00'].),\n  (tx_limit_monthly:DECIMAL, Value examples: ['5000.00', '20000.00', '500.00'].),\n  (membership_status:INTEGER, 0 for bronze, 1 for silver, 2 for gold, 3 for platinum, 4 for VIP. Value examples: ['2', '4', '0'].),\n  (password_hash:VARCHAR, Value examples: ['bcryptHash($2yz9!&ka1)', 'bcryptHash(Vacay2023*&!Rm)', 'bcryptHash(cRaf7yCr8zy)'].),\n  (api_key:VARCHAR, Value examples: ['9d61c49b-8977-4914-a36b-80d1445e38fa', 'NULL', 'NULL'].),\n  (verified_devices:TEXT, comma separated list of device ids. Value examples: ['mobile_8fh2k1', 'mobile_34jdkl', 'web_8902wknz'].),\n  (verified_ips:TEXT, comma separated list of IP addresses. Value examples: ['192.168.0.1', '143.92.64.138', '192.64.112.188'].),\n  (mfa_enabled:BOOLEAN, Value examples: ['true', 'false', 'false'].),\n  (marketing_opt_in:BOOLEAN, Value examples: ['false', 'true', 'false'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-07 00:00:00', '2023-06-07 00:00:00', '2023-06-07 00:00:00'].),\n  (PRIMARY:KEY,),\n]\n\n【Foreign keys】\n\n【参考信息】\nTo get the total number of transactions per user, join the users and wallet_transactions_daily tables in a common table expression (CTE), then group by user_id to count transactions\nLUB = Latest User Balance, which is the most recent balance for each user\nTo determine user notification preferences, use a join between the users and user_setting_snapshot tables in a CTE, focusing on selecting the most recent snapshot for each user.\nFor analyzing coupon usage, start with a join between the coupons and wallet_transactions_daily tables in a CTE, apply filtering as needed, and then perform aggregation for the total discount amount\n\n【用户问题】\nWhat is the LUB for each user.\n\n```sql",
        "role": "user"
      },
      {
        "content": "WITH user_balances AS (SELECT user_id, balance, ROW_NUMBER() OVER (PARTITION BY user_id ORDER BY updated_at DESC) AS rn FROM consumer_div.wallet_user_balance_daily) SELECT user_id, balance FROM user_balances WHERE rn = 1",
        "role": "assistant"
      }
    ],
    "db_name": "ewallet",
    "id": 292,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the MRR for each merchant? Return the merchant name, category, revenue amount, and revenue rank.\n\n【数据库schema】\n【DB_ID】 ewallet\n【Schema】\n# Table: users\n[\n  (uid:BIGINT,),\n  (username:VARCHAR,),\n  (email:VARCHAR,),\n  (phone_number:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (last_login_at:TIMESTAMP,),\n  (user_type:VARCHAR, possible values: individual, business, admin.),\n  (status:VARCHAR, possible values: active, inactive, suspended, deleted.),\n  (country:VARCHAR, 2-letter country code.),\n  (address_billing:TEXT,),\n  (address_delivery:TEXT,),\n  (kyc_status:VARCHAR, possible values: pending, approved, rejected.),\n  (kyc_verified_at:TIMESTAMP,),\n]\n# Table: merchants\n[\n  (mid:BIGINT,),\n  (name:VARCHAR,),\n  (description:TEXT,),\n  (website_url:VARCHAR,),\n  (logo_url:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (country:VARCHAR, 2-letter country code.),\n  (state:VARCHAR,),\n  (city:VARCHAR,),\n  (postal_code:VARCHAR,),\n  (address:TEXT,),\n  (status:VARCHAR, possible values: active, inactive, suspended.),\n  (category:VARCHAR,),\n  (sub_category:VARCHAR,),\n  (mcc:INT, Merchant Category Code.),\n  (contact_name:VARCHAR,),\n  (contact_email:VARCHAR,),\n  (contact_phone:VARCHAR,),\n]\n# Table: coupons\n[\n  (cid:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (code:VARCHAR, Value examples: ['TECH20', 'NEWYEAR30', 'DINEDISCOUNT', 'HOME15'].),\n  (description:TEXT, Value examples: ['20% off tech and electronics', '30% off workout gear', 'Get $10 off $50 order', '15% off weekly rental'].),\n  (start_date:DATE, Value examples: ['2023-05-01', '2023-01-01', '2023-06-01', '2023-07-01'].),\n  (end_date:DATE, Value examples: ['2023-05-31', '2023-01-15', '2023-06-30', '2023-08-31'].),\n  (discount_type:VARCHAR, possible values: percentage, fixed_amount. Value examples: ['percentage', 'percentage', 'fixed_amount', 'percentage'].),\n  (discount_value:DECIMAL, Value examples: ['20.00', '30.00', '10.00', '15.00'].),\n  (min_purchase_amount:DECIMAL, Value examples: ['100.00', 'NULL', '50.00', '1000.00'].),\n  (max_discount_amount:DECIMAL, Value examples: ['NULL', 'NULL', '10.00', '300.00'].),\n  (redemption_limit:INT, Value examples: ['500', '1000', 'NULL', '200'].),\n  (status:VARCHAR, possible values: active, inactive, expired. Value examples: ['active', 'expired', 'active', 'active'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-04-01 09:00:00', '2022-12-01 12:00:00', '2023-05-15 15:30:00', '2023-05-01 09:15:00'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-04-15 11:30:00', '2023-01-16 18:45:00', 'NULL', 'NULL'].),\n]\n# Table: wallet_transactions_daily\n[\n  (txid:SERIAL,),\n  (sender_id:BIGINT, Value examples: ['1'].),\n  (sender_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (receiver_id:BIGINT, Value examples: ['1'].),\n  (receiver_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (amount:DECIMAL, Value examples: ['99.99'].),\n  (status:VARCHAR, possible values: pending, success, failed, refunded. Value examples: ['success'].),\n  (type:VARCHAR, possible values: credit, debit. Value examples: ['debit'].),\n  (description:TEXT, Value examples: ['Online purchase'].),\n  (coupon_id:BIGINT, NULL if transaction doesn't involve a coupon. Value examples: ['NULL'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:15:30'].),\n  (completed_at:TIMESTAMP, NULL if failed. Value examples: ['2023-06-01 10:15:45'].),\n  (transaction_ref:VARCHAR, randomly generated uuid4 for users' reference. Value examples: ['ad154bf7-8185-4230-a8d8-3ef59b4e0012'].),\n  (gateway_name:VARCHAR, Value examples: ['Stripe'].),\n  (gateway_ref:VARCHAR, Value examples: ['tx_123abc456def'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1'].),\n  (ip_address:VARCHAR, Value examples: ['192.168.0.1'].),\n  (user_agent:TEXT, Value examples: ['Mozilla/5.0 (iPhone'].),\n]\n# Table: wallet_user_balance_daily\n[\n  (user_id:BIGINT, Value examples: ['1', '2'].),\n  (balance:DECIMAL, Value examples: ['525.80', '429.76'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: wallet_merchant_balance_daily\n[\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3'].),\n  (balance:DECIMAL, Value examples: ['3897.99', '155.24', '2775.25'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: notifications\n[\n  (id:SERIAL,),\n  (user_id:INT, Value examples: ['1', '1', '2'].),\n  (message:TEXT, Value examples: ['Your order #123abc has been shipped!', 'Get 20% off your next purchase! Limited time offer.', 'A package is being returned to you. Refund processing...'].),\n  (type:VARCHAR, possible values: transaction, promotion, security, general. Value examples: ['transaction', 'promotion', 'transaction'].),\n  (status:VARCHAR, possible values: unread, read, archived. Value examples: ['unread', 'unread', 'read'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:16:00', '2023-06-02 09:00:00', '2023-06-07 10:12:00'].),\n  (read_at:TIMESTAMP, NULL if not read.),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'email', 'mobile_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'NULL', 'mobile_1av8p0'].),\n  (action_url:TEXT, can be external https or deeplink url within the app. Value examples: ['app://orders/123abc', 'https://techmart.com/promo/TECH20', 'app://orders?status=returned'].),\n]\n# Table: user_sessions\n[\n  (user_id:BIGINT, Value examples: ['1', '1', '1'].),\n  (session_start_ts:TIMESTAMP, Value examples: ['2023-06-01 09:45:22', '2023-06-02 13:30:00', '2023-06-06 14:19:00'].),\n  (session_end_ts:TIMESTAMP, Value examples: ['2023-06-01 10:20:35', '2023-06-02 14:15:15', '2023-06-06 14:22:10'].),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'web_app', 'web_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'web_33lq1dh', 'web_33lq1dh'].),\n]\n# Table: user_setting_snapshot\n[\n  (user_id:BIGINT, Value examples: ['1', '4', '5'].),\n  (snapshot_date:DATE, Value examples: ['2023-06-07', '2023-06-07', '2023-06-07'].),\n  (tx_limit_daily:DECIMAL, Value examples: ['1000.00', '5000.00', '100.00'].),\n  (tx_limit_monthly:DECIMAL, Value examples: ['5000.00', '20000.00', '500.00'].),\n  (membership_status:INTEGER, 0 for bronze, 1 for silver, 2 for gold, 3 for platinum, 4 for VIP. Value examples: ['2', '4', '0'].),\n  (password_hash:VARCHAR, Value examples: ['bcryptHash($2yz9!&ka1)', 'bcryptHash(Vacay2023*&!Rm)', 'bcryptHash(cRaf7yCr8zy)'].),\n  (api_key:VARCHAR, Value examples: ['9d61c49b-8977-4914-a36b-80d1445e38fa', 'NULL', 'NULL'].),\n  (verified_devices:TEXT, comma separated list of device ids. Value examples: ['mobile_8fh2k1', 'mobile_34jdkl', 'web_8902wknz'].),\n  (verified_ips:TEXT, comma separated list of IP addresses. Value examples: ['192.168.0.1', '143.92.64.138', '192.64.112.188'].),\n  (mfa_enabled:BOOLEAN, Value examples: ['true', 'false', 'false'].),\n  (marketing_opt_in:BOOLEAN, Value examples: ['false', 'true', 'false'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-07 00:00:00', '2023-06-07 00:00:00', '2023-06-07 00:00:00'].),\n  (PRIMARY:KEY,),\n]\n\n【Foreign keys】\n\n【参考信息】\nTo get user notification preferences, join the users and user_setting_snapshot tables in a CTE, then select the latest snapshot for each user\nMerchant category should be matched case-insensitively with wildcards, e.g., using LOWER(merchants.category) LIKE '%...%'.\nMRR = Merchant Revenue Rank, which ranks merchants based on their total successful received transaction amounts. Filter receiver_type=1 in consumer_div.wallet_transactions_daily for merchants. Merchant with rank 1 has the highest revenue.\nTo analyze user engagement, join the users and user_sessions tables in a CTE, then aggregate to calculate total session duration per user\n\n【用户问题】\nWhat is the MRR for each merchant? Return the merchant name, category, revenue amount, and revenue rank.\n\n```sql",
        "role": "user"
      },
      {
        "content": "WITH merchant_revenue AS (SELECT m.mid, m.name, m.category AS merchant_category, SUM(w.amount) AS total_revenue FROM consumer_div.merchants m INNER JOIN consumer_div.wallet_transactions_daily w ON m.mid = w.receiver_id AND w.receiver_type = 1 WHERE w.status = 'success' GROUP BY m.mid, m.name, m.category) SELECT *, RANK() OVER (ORDER BY total_revenue DESC) AS mrr FROM merchant_revenue",
        "role": "assistant"
      }
    ],
    "db_name": "ewallet",
    "id": 293,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nFor users in the US and Canada, how many total notifications were sent in each of the last 3 weeks excluding the current week? How many of those were sent on weekends?\n\n【数据库schema】\n【DB_ID】 ewallet\n【Schema】\n# Table: users\n[\n  (uid:BIGINT,),\n  (username:VARCHAR,),\n  (email:VARCHAR,),\n  (phone_number:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (last_login_at:TIMESTAMP,),\n  (user_type:VARCHAR, possible values: individual, business, admin.),\n  (status:VARCHAR, possible values: active, inactive, suspended, deleted.),\n  (country:VARCHAR, 2-letter country code.),\n  (address_billing:TEXT,),\n  (address_delivery:TEXT,),\n  (kyc_status:VARCHAR, possible values: pending, approved, rejected.),\n  (kyc_verified_at:TIMESTAMP,),\n]\n# Table: merchants\n[\n  (mid:BIGINT,),\n  (name:VARCHAR,),\n  (description:TEXT,),\n  (website_url:VARCHAR,),\n  (logo_url:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (country:VARCHAR, 2-letter country code.),\n  (state:VARCHAR,),\n  (city:VARCHAR,),\n  (postal_code:VARCHAR,),\n  (address:TEXT,),\n  (status:VARCHAR, possible values: active, inactive, suspended.),\n  (category:VARCHAR,),\n  (sub_category:VARCHAR,),\n  (mcc:INT, Merchant Category Code.),\n  (contact_name:VARCHAR,),\n  (contact_email:VARCHAR,),\n  (contact_phone:VARCHAR,),\n]\n# Table: coupons\n[\n  (cid:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (code:VARCHAR, Value examples: ['TECH20', 'NEWYEAR30', 'DINEDISCOUNT', 'HOME15'].),\n  (description:TEXT, Value examples: ['20% off tech and electronics', '30% off workout gear', 'Get $10 off $50 order', '15% off weekly rental'].),\n  (start_date:DATE, Value examples: ['2023-05-01', '2023-01-01', '2023-06-01', '2023-07-01'].),\n  (end_date:DATE, Value examples: ['2023-05-31', '2023-01-15', '2023-06-30', '2023-08-31'].),\n  (discount_type:VARCHAR, possible values: percentage, fixed_amount. Value examples: ['percentage', 'percentage', 'fixed_amount', 'percentage'].),\n  (discount_value:DECIMAL, Value examples: ['20.00', '30.00', '10.00', '15.00'].),\n  (min_purchase_amount:DECIMAL, Value examples: ['100.00', 'NULL', '50.00', '1000.00'].),\n  (max_discount_amount:DECIMAL, Value examples: ['NULL', 'NULL', '10.00', '300.00'].),\n  (redemption_limit:INT, Value examples: ['500', '1000', 'NULL', '200'].),\n  (status:VARCHAR, possible values: active, inactive, expired. Value examples: ['active', 'expired', 'active', 'active'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-04-01 09:00:00', '2022-12-01 12:00:00', '2023-05-15 15:30:00', '2023-05-01 09:15:00'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-04-15 11:30:00', '2023-01-16 18:45:00', 'NULL', 'NULL'].),\n]\n# Table: wallet_transactions_daily\n[\n  (txid:SERIAL,),\n  (sender_id:BIGINT, Value examples: ['1'].),\n  (sender_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (receiver_id:BIGINT, Value examples: ['1'].),\n  (receiver_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (amount:DECIMAL, Value examples: ['99.99'].),\n  (status:VARCHAR, possible values: pending, success, failed, refunded. Value examples: ['success'].),\n  (type:VARCHAR, possible values: credit, debit. Value examples: ['debit'].),\n  (description:TEXT, Value examples: ['Online purchase'].),\n  (coupon_id:BIGINT, NULL if transaction doesn't involve a coupon. Value examples: ['NULL'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:15:30'].),\n  (completed_at:TIMESTAMP, NULL if failed. Value examples: ['2023-06-01 10:15:45'].),\n  (transaction_ref:VARCHAR, randomly generated uuid4 for users' reference. Value examples: ['ad154bf7-8185-4230-a8d8-3ef59b4e0012'].),\n  (gateway_name:VARCHAR, Value examples: ['Stripe'].),\n  (gateway_ref:VARCHAR, Value examples: ['tx_123abc456def'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1'].),\n  (ip_address:VARCHAR, Value examples: ['192.168.0.1'].),\n  (user_agent:TEXT, Value examples: ['Mozilla/5.0 (iPhone'].),\n]\n# Table: wallet_user_balance_daily\n[\n  (user_id:BIGINT, Value examples: ['1', '2'].),\n  (balance:DECIMAL, Value examples: ['525.80', '429.76'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: wallet_merchant_balance_daily\n[\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3'].),\n  (balance:DECIMAL, Value examples: ['3897.99', '155.24', '2775.25'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: notifications\n[\n  (id:SERIAL,),\n  (user_id:INT, Value examples: ['1', '1', '2'].),\n  (message:TEXT, Value examples: ['Your order #123abc has been shipped!', 'Get 20% off your next purchase! Limited time offer.', 'A package is being returned to you. Refund processing...'].),\n  (type:VARCHAR, possible values: transaction, promotion, security, general. Value examples: ['transaction', 'promotion', 'transaction'].),\n  (status:VARCHAR, possible values: unread, read, archived. Value examples: ['unread', 'unread', 'read'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:16:00', '2023-06-02 09:00:00', '2023-06-07 10:12:00'].),\n  (read_at:TIMESTAMP, NULL if not read.),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'email', 'mobile_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'NULL', 'mobile_1av8p0'].),\n  (action_url:TEXT, can be external https or deeplink url within the app. Value examples: ['app://orders/123abc', 'https://techmart.com/promo/TECH20', 'app://orders?status=returned'].),\n]\n# Table: user_sessions\n[\n  (user_id:BIGINT, Value examples: ['1', '1', '1'].),\n  (session_start_ts:TIMESTAMP, Value examples: ['2023-06-01 09:45:22', '2023-06-02 13:30:00', '2023-06-06 14:19:00'].),\n  (session_end_ts:TIMESTAMP, Value examples: ['2023-06-01 10:20:35', '2023-06-02 14:15:15', '2023-06-06 14:22:10'].),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'web_app', 'web_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'web_33lq1dh', 'web_33lq1dh'].),\n]\n# Table: user_setting_snapshot\n[\n  (user_id:BIGINT, Value examples: ['1', '4', '5'].),\n  (snapshot_date:DATE, Value examples: ['2023-06-07', '2023-06-07', '2023-06-07'].),\n  (tx_limit_daily:DECIMAL, Value examples: ['1000.00', '5000.00', '100.00'].),\n  (tx_limit_monthly:DECIMAL, Value examples: ['5000.00', '20000.00', '500.00'].),\n  (membership_status:INTEGER, 0 for bronze, 1 for silver, 2 for gold, 3 for platinum, 4 for VIP. Value examples: ['2', '4', '0'].),\n  (password_hash:VARCHAR, Value examples: ['bcryptHash($2yz9!&ka1)', 'bcryptHash(Vacay2023*&!Rm)', 'bcryptHash(cRaf7yCr8zy)'].),\n  (api_key:VARCHAR, Value examples: ['9d61c49b-8977-4914-a36b-80d1445e38fa', 'NULL', 'NULL'].),\n  (verified_devices:TEXT, comma separated list of device ids. Value examples: ['mobile_8fh2k1', 'mobile_34jdkl', 'web_8902wknz'].),\n  (verified_ips:TEXT, comma separated list of IP addresses. Value examples: ['192.168.0.1', '143.92.64.138', '192.64.112.188'].),\n  (mfa_enabled:BOOLEAN, Value examples: ['true', 'false', 'false'].),\n  (marketing_opt_in:BOOLEAN, Value examples: ['false', 'true', 'false'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-07 00:00:00', '2023-06-07 00:00:00', '2023-06-07 00:00:00'].),\n  (PRIMARY:KEY,),\n]\n\n【Foreign keys】\n\n【参考信息】\nTo gauge user engagement, link users to their sessions without defining a specific date range for total session duration analysis\nTo analyze coupon usage, join the coupons and transactions tables to aggregate total discount amounts without specifying a merchant\nMerchant categories should be matched using a case-insensitive pattern without necessitating wildcards.\nWeekends are Saturdays and Sundays. Truncate created_at to week for aggregation.\n\n【用户问题】\nFor users in the US and Canada, how many total notifications were sent in each of the last 3 weeks excluding the current week? How many of those were sent on weekends?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT DATE_TRUNC('week', n.created_at) AS WEEK, COUNT(*) AS total_notifications, COUNT(CASE WHEN EXTRACT(dow FROM n.created_at) IN (0, 6) THEN 1 END) AS weekend_notifications FROM consumer_div.notifications n JOIN consumer_div.users u ON n.user_id = u.uid WHERE u.country IN ('US', 'CA') AND n.created_at >= DATE_TRUNC('week', CURRENT_DATE) - INTERVAL '3 weeks' AND n.created_at < DATE_TRUNC('week', CURRENT_DATE) GROUP BY WEEK",
        "role": "assistant"
      }
    ],
    "db_name": "ewallet",
    "id": 294,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many wallet transactions were made by users from the US in the last 7 days inclusive of today? Return the number of transactions and total transaction amount.\n\n【数据库schema】\n【DB_ID】 ewallet\n【Schema】\n# Table: users\n[\n  (uid:BIGINT,),\n  (username:VARCHAR,),\n  (email:VARCHAR,),\n  (phone_number:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (last_login_at:TIMESTAMP,),\n  (user_type:VARCHAR, possible values: individual, business, admin.),\n  (status:VARCHAR, possible values: active, inactive, suspended, deleted.),\n  (country:VARCHAR, 2-letter country code.),\n  (address_billing:TEXT,),\n  (address_delivery:TEXT,),\n  (kyc_status:VARCHAR, possible values: pending, approved, rejected.),\n  (kyc_verified_at:TIMESTAMP,),\n]\n# Table: merchants\n[\n  (mid:BIGINT,),\n  (name:VARCHAR,),\n  (description:TEXT,),\n  (website_url:VARCHAR,),\n  (logo_url:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (country:VARCHAR, 2-letter country code.),\n  (state:VARCHAR,),\n  (city:VARCHAR,),\n  (postal_code:VARCHAR,),\n  (address:TEXT,),\n  (status:VARCHAR, possible values: active, inactive, suspended.),\n  (category:VARCHAR,),\n  (sub_category:VARCHAR,),\n  (mcc:INT, Merchant Category Code.),\n  (contact_name:VARCHAR,),\n  (contact_email:VARCHAR,),\n  (contact_phone:VARCHAR,),\n]\n# Table: coupons\n[\n  (cid:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (code:VARCHAR, Value examples: ['TECH20', 'NEWYEAR30', 'DINEDISCOUNT', 'HOME15'].),\n  (description:TEXT, Value examples: ['20% off tech and electronics', '30% off workout gear', 'Get $10 off $50 order', '15% off weekly rental'].),\n  (start_date:DATE, Value examples: ['2023-05-01', '2023-01-01', '2023-06-01', '2023-07-01'].),\n  (end_date:DATE, Value examples: ['2023-05-31', '2023-01-15', '2023-06-30', '2023-08-31'].),\n  (discount_type:VARCHAR, possible values: percentage, fixed_amount. Value examples: ['percentage', 'percentage', 'fixed_amount', 'percentage'].),\n  (discount_value:DECIMAL, Value examples: ['20.00', '30.00', '10.00', '15.00'].),\n  (min_purchase_amount:DECIMAL, Value examples: ['100.00', 'NULL', '50.00', '1000.00'].),\n  (max_discount_amount:DECIMAL, Value examples: ['NULL', 'NULL', '10.00', '300.00'].),\n  (redemption_limit:INT, Value examples: ['500', '1000', 'NULL', '200'].),\n  (status:VARCHAR, possible values: active, inactive, expired. Value examples: ['active', 'expired', 'active', 'active'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-04-01 09:00:00', '2022-12-01 12:00:00', '2023-05-15 15:30:00', '2023-05-01 09:15:00'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-04-15 11:30:00', '2023-01-16 18:45:00', 'NULL', 'NULL'].),\n]\n# Table: wallet_transactions_daily\n[\n  (txid:SERIAL,),\n  (sender_id:BIGINT, Value examples: ['1'].),\n  (sender_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (receiver_id:BIGINT, Value examples: ['1'].),\n  (receiver_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (amount:DECIMAL, Value examples: ['99.99'].),\n  (status:VARCHAR, possible values: pending, success, failed, refunded. Value examples: ['success'].),\n  (type:VARCHAR, possible values: credit, debit. Value examples: ['debit'].),\n  (description:TEXT, Value examples: ['Online purchase'].),\n  (coupon_id:BIGINT, NULL if transaction doesn't involve a coupon. Value examples: ['NULL'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:15:30'].),\n  (completed_at:TIMESTAMP, NULL if failed. Value examples: ['2023-06-01 10:15:45'].),\n  (transaction_ref:VARCHAR, randomly generated uuid4 for users' reference. Value examples: ['ad154bf7-8185-4230-a8d8-3ef59b4e0012'].),\n  (gateway_name:VARCHAR, Value examples: ['Stripe'].),\n  (gateway_ref:VARCHAR, Value examples: ['tx_123abc456def'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1'].),\n  (ip_address:VARCHAR, Value examples: ['192.168.0.1'].),\n  (user_agent:TEXT, Value examples: ['Mozilla/5.0 (iPhone'].),\n]\n# Table: wallet_user_balance_daily\n[\n  (user_id:BIGINT, Value examples: ['1', '2'].),\n  (balance:DECIMAL, Value examples: ['525.80', '429.76'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: wallet_merchant_balance_daily\n[\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3'].),\n  (balance:DECIMAL, Value examples: ['3897.99', '155.24', '2775.25'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: notifications\n[\n  (id:SERIAL,),\n  (user_id:INT, Value examples: ['1', '1', '2'].),\n  (message:TEXT, Value examples: ['Your order #123abc has been shipped!', 'Get 20% off your next purchase! Limited time offer.', 'A package is being returned to you. Refund processing...'].),\n  (type:VARCHAR, possible values: transaction, promotion, security, general. Value examples: ['transaction', 'promotion', 'transaction'].),\n  (status:VARCHAR, possible values: unread, read, archived. Value examples: ['unread', 'unread', 'read'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:16:00', '2023-06-02 09:00:00', '2023-06-07 10:12:00'].),\n  (read_at:TIMESTAMP, NULL if not read.),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'email', 'mobile_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'NULL', 'mobile_1av8p0'].),\n  (action_url:TEXT, can be external https or deeplink url within the app. Value examples: ['app://orders/123abc', 'https://techmart.com/promo/TECH20', 'app://orders?status=returned'].),\n]\n# Table: user_sessions\n[\n  (user_id:BIGINT, Value examples: ['1', '1', '1'].),\n  (session_start_ts:TIMESTAMP, Value examples: ['2023-06-01 09:45:22', '2023-06-02 13:30:00', '2023-06-06 14:19:00'].),\n  (session_end_ts:TIMESTAMP, Value examples: ['2023-06-01 10:20:35', '2023-06-02 14:15:15', '2023-06-06 14:22:10'].),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'web_app', 'web_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'web_33lq1dh', 'web_33lq1dh'].),\n]\n# Table: user_setting_snapshot\n[\n  (user_id:BIGINT, Value examples: ['1', '4', '5'].),\n  (snapshot_date:DATE, Value examples: ['2023-06-07', '2023-06-07', '2023-06-07'].),\n  (tx_limit_daily:DECIMAL, Value examples: ['1000.00', '5000.00', '100.00'].),\n  (tx_limit_monthly:DECIMAL, Value examples: ['5000.00', '20000.00', '500.00'].),\n  (membership_status:INTEGER, 0 for bronze, 1 for silver, 2 for gold, 3 for platinum, 4 for VIP. Value examples: ['2', '4', '0'].),\n  (password_hash:VARCHAR, Value examples: ['bcryptHash($2yz9!&ka1)', 'bcryptHash(Vacay2023*&!Rm)', 'bcryptHash(cRaf7yCr8zy)'].),\n  (api_key:VARCHAR, Value examples: ['9d61c49b-8977-4914-a36b-80d1445e38fa', 'NULL', 'NULL'].),\n  (verified_devices:TEXT, comma separated list of device ids. Value examples: ['mobile_8fh2k1', 'mobile_34jdkl', 'web_8902wknz'].),\n  (verified_ips:TEXT, comma separated list of IP addresses. Value examples: ['192.168.0.1', '143.92.64.138', '192.64.112.188'].),\n  (mfa_enabled:BOOLEAN, Value examples: ['true', 'false', 'false'].),\n  (marketing_opt_in:BOOLEAN, Value examples: ['false', 'true', 'false'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-07 00:00:00', '2023-06-07 00:00:00', '2023-06-07 00:00:00'].),\n  (PRIMARY:KEY,),\n]\n\n【Foreign keys】\n\n【参考信息】\nTo analyze coupon usage, join the coupons and wallet_transactions tables in a CTE, filter for a specific merchant, then aggregate to get the total discount amount\nLast 7 days = CURRENT_DATE - INTERVAL '7 days' to CURRENT_DATE. Always join wallet_transactions_daily with users before using the wallet_transactions_daily table.\nTo get user notification preferences, join the users and user_setting_snapshot tables in a CTE, then select the latest snapshot for each user.\nTo get the total number of transactions per user, join the users and wallet_transactions tables in a CTE, then aggregate by user_uid and count the number of transactions\n\n【用户问题】\nHow many wallet transactions were made by users from the US in the last 7 days inclusive of today? Return the number of transactions and total transaction amount.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT COUNT(*) AS num_transactions, SUM(amount) AS total_amount FROM consumer_div.wallet_transactions_daily t JOIN consumer_div.users u ON t.sender_id = u.uid WHERE u.country = 'US' AND t.created_at >= CURRENT_DATE - INTERVAL '7 days' AND t.created_at < CURRENT_DATE + INTERVAL '1 day'",
        "role": "assistant"
      }
    ],
    "db_name": "ewallet",
    "id": 295,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich merchant created the highest number of coupons within the same month that the merchant was created (coupon or merchant can be created earlier than the other)? Return the number of coupons along with the merchant's id and name.\n\n【数据库schema】\n【DB_ID】 ewallet\n【Schema】\n# Table: users\n[\n  (uid:BIGINT,),\n  (username:VARCHAR,),\n  (email:VARCHAR,),\n  (phone_number:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (last_login_at:TIMESTAMP,),\n  (user_type:VARCHAR, possible values: individual, business, admin.),\n  (status:VARCHAR, possible values: active, inactive, suspended, deleted.),\n  (country:VARCHAR, 2-letter country code.),\n  (address_billing:TEXT,),\n  (address_delivery:TEXT,),\n  (kyc_status:VARCHAR, possible values: pending, approved, rejected.),\n  (kyc_verified_at:TIMESTAMP,),\n]\n# Table: merchants\n[\n  (mid:BIGINT,),\n  (name:VARCHAR,),\n  (description:TEXT,),\n  (website_url:VARCHAR,),\n  (logo_url:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (country:VARCHAR, 2-letter country code.),\n  (state:VARCHAR,),\n  (city:VARCHAR,),\n  (postal_code:VARCHAR,),\n  (address:TEXT,),\n  (status:VARCHAR, possible values: active, inactive, suspended.),\n  (category:VARCHAR,),\n  (sub_category:VARCHAR,),\n  (mcc:INT, Merchant Category Code.),\n  (contact_name:VARCHAR,),\n  (contact_email:VARCHAR,),\n  (contact_phone:VARCHAR,),\n]\n# Table: coupons\n[\n  (cid:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (code:VARCHAR, Value examples: ['TECH20', 'NEWYEAR30', 'DINEDISCOUNT', 'HOME15'].),\n  (description:TEXT, Value examples: ['20% off tech and electronics', '30% off workout gear', 'Get $10 off $50 order', '15% off weekly rental'].),\n  (start_date:DATE, Value examples: ['2023-05-01', '2023-01-01', '2023-06-01', '2023-07-01'].),\n  (end_date:DATE, Value examples: ['2023-05-31', '2023-01-15', '2023-06-30', '2023-08-31'].),\n  (discount_type:VARCHAR, possible values: percentage, fixed_amount. Value examples: ['percentage', 'percentage', 'fixed_amount', 'percentage'].),\n  (discount_value:DECIMAL, Value examples: ['20.00', '30.00', '10.00', '15.00'].),\n  (min_purchase_amount:DECIMAL, Value examples: ['100.00', 'NULL', '50.00', '1000.00'].),\n  (max_discount_amount:DECIMAL, Value examples: ['NULL', 'NULL', '10.00', '300.00'].),\n  (redemption_limit:INT, Value examples: ['500', '1000', 'NULL', '200'].),\n  (status:VARCHAR, possible values: active, inactive, expired. Value examples: ['active', 'expired', 'active', 'active'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-04-01 09:00:00', '2022-12-01 12:00:00', '2023-05-15 15:30:00', '2023-05-01 09:15:00'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-04-15 11:30:00', '2023-01-16 18:45:00', 'NULL', 'NULL'].),\n]\n# Table: wallet_transactions_daily\n[\n  (txid:SERIAL,),\n  (sender_id:BIGINT, Value examples: ['1'].),\n  (sender_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (receiver_id:BIGINT, Value examples: ['1'].),\n  (receiver_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (amount:DECIMAL, Value examples: ['99.99'].),\n  (status:VARCHAR, possible values: pending, success, failed, refunded. Value examples: ['success'].),\n  (type:VARCHAR, possible values: credit, debit. Value examples: ['debit'].),\n  (description:TEXT, Value examples: ['Online purchase'].),\n  (coupon_id:BIGINT, NULL if transaction doesn't involve a coupon. Value examples: ['NULL'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:15:30'].),\n  (completed_at:TIMESTAMP, NULL if failed. Value examples: ['2023-06-01 10:15:45'].),\n  (transaction_ref:VARCHAR, randomly generated uuid4 for users' reference. Value examples: ['ad154bf7-8185-4230-a8d8-3ef59b4e0012'].),\n  (gateway_name:VARCHAR, Value examples: ['Stripe'].),\n  (gateway_ref:VARCHAR, Value examples: ['tx_123abc456def'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1'].),\n  (ip_address:VARCHAR, Value examples: ['192.168.0.1'].),\n  (user_agent:TEXT, Value examples: ['Mozilla/5.0 (iPhone'].),\n]\n# Table: wallet_user_balance_daily\n[\n  (user_id:BIGINT, Value examples: ['1', '2'].),\n  (balance:DECIMAL, Value examples: ['525.80', '429.76'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: wallet_merchant_balance_daily\n[\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3'].),\n  (balance:DECIMAL, Value examples: ['3897.99', '155.24', '2775.25'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: notifications\n[\n  (id:SERIAL,),\n  (user_id:INT, Value examples: ['1', '1', '2'].),\n  (message:TEXT, Value examples: ['Your order #123abc has been shipped!', 'Get 20% off your next purchase! Limited time offer.', 'A package is being returned to you. Refund processing...'].),\n  (type:VARCHAR, possible values: transaction, promotion, security, general. Value examples: ['transaction', 'promotion', 'transaction'].),\n  (status:VARCHAR, possible values: unread, read, archived. Value examples: ['unread', 'unread', 'read'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:16:00', '2023-06-02 09:00:00', '2023-06-07 10:12:00'].),\n  (read_at:TIMESTAMP, NULL if not read.),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'email', 'mobile_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'NULL', 'mobile_1av8p0'].),\n  (action_url:TEXT, can be external https or deeplink url within the app. Value examples: ['app://orders/123abc', 'https://techmart.com/promo/TECH20', 'app://orders?status=returned'].),\n]\n# Table: user_sessions\n[\n  (user_id:BIGINT, Value examples: ['1', '1', '1'].),\n  (session_start_ts:TIMESTAMP, Value examples: ['2023-06-01 09:45:22', '2023-06-02 13:30:00', '2023-06-06 14:19:00'].),\n  (session_end_ts:TIMESTAMP, Value examples: ['2023-06-01 10:20:35', '2023-06-02 14:15:15', '2023-06-06 14:22:10'].),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'web_app', 'web_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'web_33lq1dh', 'web_33lq1dh'].),\n]\n# Table: user_setting_snapshot\n[\n  (user_id:BIGINT, Value examples: ['1', '4', '5'].),\n  (snapshot_date:DATE, Value examples: ['2023-06-07', '2023-06-07', '2023-06-07'].),\n  (tx_limit_daily:DECIMAL, Value examples: ['1000.00', '5000.00', '100.00'].),\n  (tx_limit_monthly:DECIMAL, Value examples: ['5000.00', '20000.00', '500.00'].),\n  (membership_status:INTEGER, 0 for bronze, 1 for silver, 2 for gold, 3 for platinum, 4 for VIP. Value examples: ['2', '4', '0'].),\n  (password_hash:VARCHAR, Value examples: ['bcryptHash($2yz9!&ka1)', 'bcryptHash(Vacay2023*&!Rm)', 'bcryptHash(cRaf7yCr8zy)'].),\n  (api_key:VARCHAR, Value examples: ['9d61c49b-8977-4914-a36b-80d1445e38fa', 'NULL', 'NULL'].),\n  (verified_devices:TEXT, comma separated list of device ids. Value examples: ['mobile_8fh2k1', 'mobile_34jdkl', 'web_8902wknz'].),\n  (verified_ips:TEXT, comma separated list of IP addresses. Value examples: ['192.168.0.1', '143.92.64.138', '192.64.112.188'].),\n  (mfa_enabled:BOOLEAN, Value examples: ['true', 'false', 'false'].),\n  (marketing_opt_in:BOOLEAN, Value examples: ['false', 'true', 'false'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-07 00:00:00', '2023-06-07 00:00:00', '2023-06-07 00:00:00'].),\n  (PRIMARY:KEY,),\n]\n\n【Foreign keys】\n\n【参考信息】\nTo analyze coupon usage, join the coupons and wallet_transactions_daily tables in a CTE, filtering for specific merchants, then aggregate If events from 2 different tables from the same interval are to be joined, join on the respective truncated date fields eg `FROM t1 JOIN t2 ON DATE_TRUNC('<interval>', t1.date)=DATE_TRUNC('<interval>', t2.date). To get the total number of transactions per user, join the users and wallet_transactions_daily tables in a CTE, then aggregate by user_id To get user notification preferences, join the users and user_setting_snapshot tables in a CTE, selecting the most recent snapshot for each user.\n\n【用户问题】\nWhich merchant created the highest number of coupons within the same month that the merchant was created (coupon or merchant can be created earlier than the other)? Return the number of coupons along with the merchant's id and name.\n\n```sql",
        "role": "user"
      },
      {
        "content": "WITH coupons_per_merchant AS (SELECT m.mid, COUNT(c.cid) AS num_coupons FROM consumer_div.coupons c JOIN consumer_div.merchants m ON m.mid = c.merchant_id AND DATE_TRUNC('month', c.created_at) = DATE_TRUNC('month', m.created_at) GROUP BY m.mid) SELECT coupons_per_merchant.mid, m.name, coupons_per_merchant.num_coupons FROM coupons_per_merchant JOIN consumer_div.merchants m USING(mid) ORDER BY coupons_per_merchant.num_coupons DESC LIMIT 1",
        "role": "assistant"
      }
    ],
    "db_name": "ewallet",
    "id": 296,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the PMDAU (Per Month Daily Active Users) for wallet transactions in the last 2 months excluding the current month?\n\n【数据库schema】\n【DB_ID】 ewallet\n【Schema】\n# Table: users\n[\n  (uid:BIGINT,),\n  (username:VARCHAR,),\n  (email:VARCHAR,),\n  (phone_number:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (last_login_at:TIMESTAMP,),\n  (user_type:VARCHAR, possible values: individual, business, admin.),\n  (status:VARCHAR, possible values: active, inactive, suspended, deleted.),\n  (country:VARCHAR, 2-letter country code.),\n  (address_billing:TEXT,),\n  (address_delivery:TEXT,),\n  (kyc_status:VARCHAR, possible values: pending, approved, rejected.),\n  (kyc_verified_at:TIMESTAMP,),\n]\n# Table: merchants\n[\n  (mid:BIGINT,),\n  (name:VARCHAR,),\n  (description:TEXT,),\n  (website_url:VARCHAR,),\n  (logo_url:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (country:VARCHAR, 2-letter country code.),\n  (state:VARCHAR,),\n  (city:VARCHAR,),\n  (postal_code:VARCHAR,),\n  (address:TEXT,),\n  (status:VARCHAR, possible values: active, inactive, suspended.),\n  (category:VARCHAR,),\n  (sub_category:VARCHAR,),\n  (mcc:INT, Merchant Category Code.),\n  (contact_name:VARCHAR,),\n  (contact_email:VARCHAR,),\n  (contact_phone:VARCHAR,),\n]\n# Table: coupons\n[\n  (cid:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (code:VARCHAR, Value examples: ['TECH20', 'NEWYEAR30', 'DINEDISCOUNT', 'HOME15'].),\n  (description:TEXT, Value examples: ['20% off tech and electronics', '30% off workout gear', 'Get $10 off $50 order', '15% off weekly rental'].),\n  (start_date:DATE, Value examples: ['2023-05-01', '2023-01-01', '2023-06-01', '2023-07-01'].),\n  (end_date:DATE, Value examples: ['2023-05-31', '2023-01-15', '2023-06-30', '2023-08-31'].),\n  (discount_type:VARCHAR, possible values: percentage, fixed_amount. Value examples: ['percentage', 'percentage', 'fixed_amount', 'percentage'].),\n  (discount_value:DECIMAL, Value examples: ['20.00', '30.00', '10.00', '15.00'].),\n  (min_purchase_amount:DECIMAL, Value examples: ['100.00', 'NULL', '50.00', '1000.00'].),\n  (max_discount_amount:DECIMAL, Value examples: ['NULL', 'NULL', '10.00', '300.00'].),\n  (redemption_limit:INT, Value examples: ['500', '1000', 'NULL', '200'].),\n  (status:VARCHAR, possible values: active, inactive, expired. Value examples: ['active', 'expired', 'active', 'active'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-04-01 09:00:00', '2022-12-01 12:00:00', '2023-05-15 15:30:00', '2023-05-01 09:15:00'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-04-15 11:30:00', '2023-01-16 18:45:00', 'NULL', 'NULL'].),\n]\n# Table: wallet_transactions_daily\n[\n  (txid:SERIAL,),\n  (sender_id:BIGINT, Value examples: ['1'].),\n  (sender_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (receiver_id:BIGINT, Value examples: ['1'].),\n  (receiver_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (amount:DECIMAL, Value examples: ['99.99'].),\n  (status:VARCHAR, possible values: pending, success, failed, refunded. Value examples: ['success'].),\n  (type:VARCHAR, possible values: credit, debit. Value examples: ['debit'].),\n  (description:TEXT, Value examples: ['Online purchase'].),\n  (coupon_id:BIGINT, NULL if transaction doesn't involve a coupon. Value examples: ['NULL'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:15:30'].),\n  (completed_at:TIMESTAMP, NULL if failed. Value examples: ['2023-06-01 10:15:45'].),\n  (transaction_ref:VARCHAR, randomly generated uuid4 for users' reference. Value examples: ['ad154bf7-8185-4230-a8d8-3ef59b4e0012'].),\n  (gateway_name:VARCHAR, Value examples: ['Stripe'].),\n  (gateway_ref:VARCHAR, Value examples: ['tx_123abc456def'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1'].),\n  (ip_address:VARCHAR, Value examples: ['192.168.0.1'].),\n  (user_agent:TEXT, Value examples: ['Mozilla/5.0 (iPhone'].),\n]\n# Table: wallet_user_balance_daily\n[\n  (user_id:BIGINT, Value examples: ['1', '2'].),\n  (balance:DECIMAL, Value examples: ['525.80', '429.76'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: wallet_merchant_balance_daily\n[\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3'].),\n  (balance:DECIMAL, Value examples: ['3897.99', '155.24', '2775.25'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: notifications\n[\n  (id:SERIAL,),\n  (user_id:INT, Value examples: ['1', '1', '2'].),\n  (message:TEXT, Value examples: ['Your order #123abc has been shipped!', 'Get 20% off your next purchase! Limited time offer.', 'A package is being returned to you. Refund processing...'].),\n  (type:VARCHAR, possible values: transaction, promotion, security, general. Value examples: ['transaction', 'promotion', 'transaction'].),\n  (status:VARCHAR, possible values: unread, read, archived. Value examples: ['unread', 'unread', 'read'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:16:00', '2023-06-02 09:00:00', '2023-06-07 10:12:00'].),\n  (read_at:TIMESTAMP, NULL if not read.),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'email', 'mobile_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'NULL', 'mobile_1av8p0'].),\n  (action_url:TEXT, can be external https or deeplink url within the app. Value examples: ['app://orders/123abc', 'https://techmart.com/promo/TECH20', 'app://orders?status=returned'].),\n]\n# Table: user_sessions\n[\n  (user_id:BIGINT, Value examples: ['1', '1', '1'].),\n  (session_start_ts:TIMESTAMP, Value examples: ['2023-06-01 09:45:22', '2023-06-02 13:30:00', '2023-06-06 14:19:00'].),\n  (session_end_ts:TIMESTAMP, Value examples: ['2023-06-01 10:20:35', '2023-06-02 14:15:15', '2023-06-06 14:22:10'].),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'web_app', 'web_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'web_33lq1dh', 'web_33lq1dh'].),\n]\n# Table: user_setting_snapshot\n[\n  (user_id:BIGINT, Value examples: ['1', '4', '5'].),\n  (snapshot_date:DATE, Value examples: ['2023-06-07', '2023-06-07', '2023-06-07'].),\n  (tx_limit_daily:DECIMAL, Value examples: ['1000.00', '5000.00', '100.00'].),\n  (tx_limit_monthly:DECIMAL, Value examples: ['5000.00', '20000.00', '500.00'].),\n  (membership_status:INTEGER, 0 for bronze, 1 for silver, 2 for gold, 3 for platinum, 4 for VIP. Value examples: ['2', '4', '0'].),\n  (password_hash:VARCHAR, Value examples: ['bcryptHash($2yz9!&ka1)', 'bcryptHash(Vacay2023*&!Rm)', 'bcryptHash(cRaf7yCr8zy)'].),\n  (api_key:VARCHAR, Value examples: ['9d61c49b-8977-4914-a36b-80d1445e38fa', 'NULL', 'NULL'].),\n  (verified_devices:TEXT, comma separated list of device ids. Value examples: ['mobile_8fh2k1', 'mobile_34jdkl', 'web_8902wknz'].),\n  (verified_ips:TEXT, comma separated list of IP addresses. Value examples: ['192.168.0.1', '143.92.64.138', '192.64.112.188'].),\n  (mfa_enabled:BOOLEAN, Value examples: ['true', 'false', 'false'].),\n  (marketing_opt_in:BOOLEAN, Value examples: ['false', 'true', 'false'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-07 00:00:00', '2023-06-07 00:00:00', '2023-06-07 00:00:00'].),\n  (PRIMARY:KEY,),\n]\n\n【Foreign keys】\n\n【参考信息】\nPMDAU (Per Month Daily Active Users) = COUNT(DISTINCT(sender_id) ... WHERE t.sender_type = 0. Truncate created_at to month for aggregation. To analyze coupon usage, join the coupons and wallet_transactions_daily tables in a CTE, filter for transactions associated with a specific merchant, then aggregate to calculate the total discount amount received To get the total number of transactions per user, join the users and wallet_transactions_daily tables in a common table expression (CTE), then aggregate by user_id and count the transactions To get user notification preferences, join the users and user_setting_snapshot tables in a CTE, then select the most recent snapshot for each user.\n\n【用户问题】\nWhat is the PMDAU (Per Month Daily Active Users) for wallet transactions in the last 2 months excluding the current month?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT DATE_TRUNC('month', t.created_at) AS MONTH, COUNT(DISTINCT t.sender_id) AS active_users FROM consumer_div.wallet_transactions_daily t WHERE t.sender_type = 0 AND t.created_at >= DATE_TRUNC('month', CURRENT_DATE) - INTERVAL '2 months' AND t.created_at < DATE_TRUNC('month', CURRENT_DATE) GROUP BY MONTH",
        "role": "assistant"
      }
    ],
    "db_name": "ewallet",
    "id": 297,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhich users from the US have unread promotional notifications? Return the username and the total number of unread promotional notifications.\n\n【数据库schema】\n【DB_ID】 ewallet\n【Schema】\n# Table: users\n[\n  (uid:BIGINT,),\n  (username:VARCHAR,),\n  (email:VARCHAR,),\n  (phone_number:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (last_login_at:TIMESTAMP,),\n  (user_type:VARCHAR, possible values: individual, business, admin.),\n  (status:VARCHAR, possible values: active, inactive, suspended, deleted.),\n  (country:VARCHAR, 2-letter country code.),\n  (address_billing:TEXT,),\n  (address_delivery:TEXT,),\n  (kyc_status:VARCHAR, possible values: pending, approved, rejected.),\n  (kyc_verified_at:TIMESTAMP,),\n]\n# Table: merchants\n[\n  (mid:BIGINT,),\n  (name:VARCHAR,),\n  (description:TEXT,),\n  (website_url:VARCHAR,),\n  (logo_url:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (country:VARCHAR, 2-letter country code.),\n  (state:VARCHAR,),\n  (city:VARCHAR,),\n  (postal_code:VARCHAR,),\n  (address:TEXT,),\n  (status:VARCHAR, possible values: active, inactive, suspended.),\n  (category:VARCHAR,),\n  (sub_category:VARCHAR,),\n  (mcc:INT, Merchant Category Code.),\n  (contact_name:VARCHAR,),\n  (contact_email:VARCHAR,),\n  (contact_phone:VARCHAR,),\n]\n# Table: coupons\n[\n  (cid:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (code:VARCHAR, Value examples: ['TECH20', 'NEWYEAR30', 'DINEDISCOUNT', 'HOME15'].),\n  (description:TEXT, Value examples: ['20% off tech and electronics', '30% off workout gear', 'Get $10 off $50 order', '15% off weekly rental'].),\n  (start_date:DATE, Value examples: ['2023-05-01', '2023-01-01', '2023-06-01', '2023-07-01'].),\n  (end_date:DATE, Value examples: ['2023-05-31', '2023-01-15', '2023-06-30', '2023-08-31'].),\n  (discount_type:VARCHAR, possible values: percentage, fixed_amount. Value examples: ['percentage', 'percentage', 'fixed_amount', 'percentage'].),\n  (discount_value:DECIMAL, Value examples: ['20.00', '30.00', '10.00', '15.00'].),\n  (min_purchase_amount:DECIMAL, Value examples: ['100.00', 'NULL', '50.00', '1000.00'].),\n  (max_discount_amount:DECIMAL, Value examples: ['NULL', 'NULL', '10.00', '300.00'].),\n  (redemption_limit:INT, Value examples: ['500', '1000', 'NULL', '200'].),\n  (status:VARCHAR, possible values: active, inactive, expired. Value examples: ['active', 'expired', 'active', 'active'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-04-01 09:00:00', '2022-12-01 12:00:00', '2023-05-15 15:30:00', '2023-05-01 09:15:00'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-04-15 11:30:00', '2023-01-16 18:45:00', 'NULL', 'NULL'].),\n]\n# Table: wallet_transactions_daily\n[\n  (txid:SERIAL,),\n  (sender_id:BIGINT, Value examples: ['1'].),\n  (sender_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (receiver_id:BIGINT, Value examples: ['1'].),\n  (receiver_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (amount:DECIMAL, Value examples: ['99.99'].),\n  (status:VARCHAR, possible values: pending, success, failed, refunded. Value examples: ['success'].),\n  (type:VARCHAR, possible values: credit, debit. Value examples: ['debit'].),\n  (description:TEXT, Value examples: ['Online purchase'].),\n  (coupon_id:BIGINT, NULL if transaction doesn't involve a coupon. Value examples: ['NULL'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:15:30'].),\n  (completed_at:TIMESTAMP, NULL if failed. Value examples: ['2023-06-01 10:15:45'].),\n  (transaction_ref:VARCHAR, randomly generated uuid4 for users' reference. Value examples: ['ad154bf7-8185-4230-a8d8-3ef59b4e0012'].),\n  (gateway_name:VARCHAR, Value examples: ['Stripe'].),\n  (gateway_ref:VARCHAR, Value examples: ['tx_123abc456def'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1'].),\n  (ip_address:VARCHAR, Value examples: ['192.168.0.1'].),\n  (user_agent:TEXT, Value examples: ['Mozilla/5.0 (iPhone'].),\n]\n# Table: wallet_user_balance_daily\n[\n  (user_id:BIGINT, Value examples: ['1', '2'].),\n  (balance:DECIMAL, Value examples: ['525.80', '429.76'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: wallet_merchant_balance_daily\n[\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3'].),\n  (balance:DECIMAL, Value examples: ['3897.99', '155.24', '2775.25'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: notifications\n[\n  (id:SERIAL,),\n  (user_id:INT, Value examples: ['1', '1', '2'].),\n  (message:TEXT, Value examples: ['Your order #123abc has been shipped!', 'Get 20% off your next purchase! Limited time offer.', 'A package is being returned to you. Refund processing...'].),\n  (type:VARCHAR, possible values: transaction, promotion, security, general. Value examples: ['transaction', 'promotion', 'transaction'].),\n  (status:VARCHAR, possible values: unread, read, archived. Value examples: ['unread', 'unread', 'read'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:16:00', '2023-06-02 09:00:00', '2023-06-07 10:12:00'].),\n  (read_at:TIMESTAMP, NULL if not read.),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'email', 'mobile_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'NULL', 'mobile_1av8p0'].),\n  (action_url:TEXT, can be external https or deeplink url within the app. Value examples: ['app://orders/123abc', 'https://techmart.com/promo/TECH20', 'app://orders?status=returned'].),\n]\n# Table: user_sessions\n[\n  (user_id:BIGINT, Value examples: ['1', '1', '1'].),\n  (session_start_ts:TIMESTAMP, Value examples: ['2023-06-01 09:45:22', '2023-06-02 13:30:00', '2023-06-06 14:19:00'].),\n  (session_end_ts:TIMESTAMP, Value examples: ['2023-06-01 10:20:35', '2023-06-02 14:15:15', '2023-06-06 14:22:10'].),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'web_app', 'web_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'web_33lq1dh', 'web_33lq1dh'].),\n]\n# Table: user_setting_snapshot\n[\n  (user_id:BIGINT, Value examples: ['1', '4', '5'].),\n  (snapshot_date:DATE, Value examples: ['2023-06-07', '2023-06-07', '2023-06-07'].),\n  (tx_limit_daily:DECIMAL, Value examples: ['1000.00', '5000.00', '100.00'].),\n  (tx_limit_monthly:DECIMAL, Value examples: ['5000.00', '20000.00', '500.00'].),\n  (membership_status:INTEGER, 0 for bronze, 1 for silver, 2 for gold, 3 for platinum, 4 for VIP. Value examples: ['2', '4', '0'].),\n  (password_hash:VARCHAR, Value examples: ['bcryptHash($2yz9!&ka1)', 'bcryptHash(Vacay2023*&!Rm)', 'bcryptHash(cRaf7yCr8zy)'].),\n  (api_key:VARCHAR, Value examples: ['9d61c49b-8977-4914-a36b-80d1445e38fa', 'NULL', 'NULL'].),\n  (verified_devices:TEXT, comma separated list of device ids. Value examples: ['mobile_8fh2k1', 'mobile_34jdkl', 'web_8902wknz'].),\n  (verified_ips:TEXT, comma separated list of IP addresses. Value examples: ['192.168.0.1', '143.92.64.138', '192.64.112.188'].),\n  (mfa_enabled:BOOLEAN, Value examples: ['true', 'false', 'false'].),\n  (marketing_opt_in:BOOLEAN, Value examples: ['false', 'true', 'false'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-07 00:00:00', '2023-06-07 00:00:00', '2023-06-07 00:00:00'].),\n  (PRIMARY:KEY,),\n]\n\n【Foreign keys】\n\n【参考信息】\nFor merchant revenue analysis, rank merchants by their total successful transaction amounts without specifying any rank number To derive user engagement metrics, aggregate total session durations for users by joining with the user_sessions table over an unspecified date range. To calculate the Average Balance of user wallets, join the users and wallet_transactions_daily tables, then compute the average balance for a specified period User country should be matched case-insensitively, e.g., LOWER(users.country) = 'us'. Notification type and status should be matched exactly.\n\n【用户问题】\nWhich users from the US have unread promotional notifications? Return the username and the total number of unread promotional notifications.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT u.username, COUNT(n.id) AS total_notifications FROM consumer_div.users u JOIN consumer_div.notifications n ON u.uid = n.user_id WHERE n.type = 'promotion' AND n.status = 'unread' AND LOWER(u.country) = 'us' GROUP BY u.username",
        "role": "assistant"
      }
    ],
    "db_name": "ewallet",
    "id": 298,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nHow many active retail merchants have issued coupons? Return the merchant name and the total number of coupons issued.\n\n【数据库schema】\n【DB_ID】 ewallet\n【Schema】\n# Table: users\n[\n  (uid:BIGINT,),\n  (username:VARCHAR,),\n  (email:VARCHAR,),\n  (phone_number:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (last_login_at:TIMESTAMP,),\n  (user_type:VARCHAR, possible values: individual, business, admin.),\n  (status:VARCHAR, possible values: active, inactive, suspended, deleted.),\n  (country:VARCHAR, 2-letter country code.),\n  (address_billing:TEXT,),\n  (address_delivery:TEXT,),\n  (kyc_status:VARCHAR, possible values: pending, approved, rejected.),\n  (kyc_verified_at:TIMESTAMP,),\n]\n# Table: merchants\n[\n  (mid:BIGINT,),\n  (name:VARCHAR,),\n  (description:TEXT,),\n  (website_url:VARCHAR,),\n  (logo_url:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (country:VARCHAR, 2-letter country code.),\n  (state:VARCHAR,),\n  (city:VARCHAR,),\n  (postal_code:VARCHAR,),\n  (address:TEXT,),\n  (status:VARCHAR, possible values: active, inactive, suspended.),\n  (category:VARCHAR,),\n  (sub_category:VARCHAR,),\n  (mcc:INT, Merchant Category Code.),\n  (contact_name:VARCHAR,),\n  (contact_email:VARCHAR,),\n  (contact_phone:VARCHAR,),\n]\n# Table: coupons\n[\n  (cid:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (code:VARCHAR, Value examples: ['TECH20', 'NEWYEAR30', 'DINEDISCOUNT', 'HOME15'].),\n  (description:TEXT, Value examples: ['20% off tech and electronics', '30% off workout gear', 'Get $10 off $50 order', '15% off weekly rental'].),\n  (start_date:DATE, Value examples: ['2023-05-01', '2023-01-01', '2023-06-01', '2023-07-01'].),\n  (end_date:DATE, Value examples: ['2023-05-31', '2023-01-15', '2023-06-30', '2023-08-31'].),\n  (discount_type:VARCHAR, possible values: percentage, fixed_amount. Value examples: ['percentage', 'percentage', 'fixed_amount', 'percentage'].),\n  (discount_value:DECIMAL, Value examples: ['20.00', '30.00', '10.00', '15.00'].),\n  (min_purchase_amount:DECIMAL, Value examples: ['100.00', 'NULL', '50.00', '1000.00'].),\n  (max_discount_amount:DECIMAL, Value examples: ['NULL', 'NULL', '10.00', '300.00'].),\n  (redemption_limit:INT, Value examples: ['500', '1000', 'NULL', '200'].),\n  (status:VARCHAR, possible values: active, inactive, expired. Value examples: ['active', 'expired', 'active', 'active'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-04-01 09:00:00', '2022-12-01 12:00:00', '2023-05-15 15:30:00', '2023-05-01 09:15:00'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-04-15 11:30:00', '2023-01-16 18:45:00', 'NULL', 'NULL'].),\n]\n# Table: wallet_transactions_daily\n[\n  (txid:SERIAL,),\n  (sender_id:BIGINT, Value examples: ['1'].),\n  (sender_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (receiver_id:BIGINT, Value examples: ['1'].),\n  (receiver_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (amount:DECIMAL, Value examples: ['99.99'].),\n  (status:VARCHAR, possible values: pending, success, failed, refunded. Value examples: ['success'].),\n  (type:VARCHAR, possible values: credit, debit. Value examples: ['debit'].),\n  (description:TEXT, Value examples: ['Online purchase'].),\n  (coupon_id:BIGINT, NULL if transaction doesn't involve a coupon. Value examples: ['NULL'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:15:30'].),\n  (completed_at:TIMESTAMP, NULL if failed. Value examples: ['2023-06-01 10:15:45'].),\n  (transaction_ref:VARCHAR, randomly generated uuid4 for users' reference. Value examples: ['ad154bf7-8185-4230-a8d8-3ef59b4e0012'].),\n  (gateway_name:VARCHAR, Value examples: ['Stripe'].),\n  (gateway_ref:VARCHAR, Value examples: ['tx_123abc456def'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1'].),\n  (ip_address:VARCHAR, Value examples: ['192.168.0.1'].),\n  (user_agent:TEXT, Value examples: ['Mozilla/5.0 (iPhone'].),\n]\n# Table: wallet_user_balance_daily\n[\n  (user_id:BIGINT, Value examples: ['1', '2'].),\n  (balance:DECIMAL, Value examples: ['525.80', '429.76'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: wallet_merchant_balance_daily\n[\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3'].),\n  (balance:DECIMAL, Value examples: ['3897.99', '155.24', '2775.25'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: notifications\n[\n  (id:SERIAL,),\n  (user_id:INT, Value examples: ['1', '1', '2'].),\n  (message:TEXT, Value examples: ['Your order #123abc has been shipped!', 'Get 20% off your next purchase! Limited time offer.', 'A package is being returned to you. Refund processing...'].),\n  (type:VARCHAR, possible values: transaction, promotion, security, general. Value examples: ['transaction', 'promotion', 'transaction'].),\n  (status:VARCHAR, possible values: unread, read, archived. Value examples: ['unread', 'unread', 'read'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:16:00', '2023-06-02 09:00:00', '2023-06-07 10:12:00'].),\n  (read_at:TIMESTAMP, NULL if not read.),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'email', 'mobile_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'NULL', 'mobile_1av8p0'].),\n  (action_url:TEXT, can be external https or deeplink url within the app. Value examples: ['app://orders/123abc', 'https://techmart.com/promo/TECH20', 'app://orders?status=returned'].),\n]\n# Table: user_sessions\n[\n  (user_id:BIGINT, Value examples: ['1', '1', '1'].),\n  (session_start_ts:TIMESTAMP, Value examples: ['2023-06-01 09:45:22', '2023-06-02 13:30:00', '2023-06-06 14:19:00'].),\n  (session_end_ts:TIMESTAMP, Value examples: ['2023-06-01 10:20:35', '2023-06-02 14:15:15', '2023-06-06 14:22:10'].),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'web_app', 'web_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'web_33lq1dh', 'web_33lq1dh'].),\n]\n# Table: user_setting_snapshot\n[\n  (user_id:BIGINT, Value examples: ['1', '4', '5'].),\n  (snapshot_date:DATE, Value examples: ['2023-06-07', '2023-06-07', '2023-06-07'].),\n  (tx_limit_daily:DECIMAL, Value examples: ['1000.00', '5000.00', '100.00'].),\n  (tx_limit_monthly:DECIMAL, Value examples: ['5000.00', '20000.00', '500.00'].),\n  (membership_status:INTEGER, 0 for bronze, 1 for silver, 2 for gold, 3 for platinum, 4 for VIP. Value examples: ['2', '4', '0'].),\n  (password_hash:VARCHAR, Value examples: ['bcryptHash($2yz9!&ka1)', 'bcryptHash(Vacay2023*&!Rm)', 'bcryptHash(cRaf7yCr8zy)'].),\n  (api_key:VARCHAR, Value examples: ['9d61c49b-8977-4914-a36b-80d1445e38fa', 'NULL', 'NULL'].),\n  (verified_devices:TEXT, comma separated list of device ids. Value examples: ['mobile_8fh2k1', 'mobile_34jdkl', 'web_8902wknz'].),\n  (verified_ips:TEXT, comma separated list of IP addresses. Value examples: ['192.168.0.1', '143.92.64.138', '192.64.112.188'].),\n  (mfa_enabled:BOOLEAN, Value examples: ['true', 'false', 'false'].),\n  (marketing_opt_in:BOOLEAN, Value examples: ['false', 'true', 'false'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-07 00:00:00', '2023-06-07 00:00:00', '2023-06-07 00:00:00'].),\n  (PRIMARY:KEY,),\n]\n\n【Foreign keys】\n\n【参考信息】\nTo determine user notification settings, combine the users and user_settings tables in a CTE, selecting the most recent settings for each user.\nMerchant category should be matched case-insensitively with wildcards, e.g., LOWER(merchants.category) LIKE '%...%'.\nTo get the total number of transactions per user, join the users and wallet_transactions tables in a common table expression (CTE), then sum up transactions by user ID\nTo assess coupon utilization, link the coupons and wallet_transactions tables in a CTE, filter for particular merchants, then calculate the total discount amounts\n\n【用户问题】\nHow many active retail merchants have issued coupons? Return the merchant name and the total number of coupons issued.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT m.name, COUNT(c.cid) AS total_coupons FROM consumer_div.merchants m JOIN consumer_div.coupons c ON m.mid = c.merchant_id WHERE m.status = 'active' AND LOWER(m.category) LIKE '%retail%' GROUP BY m.name",
        "role": "assistant"
      }
    ],
    "db_name": "ewallet",
    "id": 299,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the TUC in the past month, inclusive of 1 month ago? Return the total count.\n\n【数据库schema】\n【DB_ID】 ewallet\n【Schema】\n# Table: users\n[\n  (uid:BIGINT,),\n  (username:VARCHAR,),\n  (email:VARCHAR,),\n  (phone_number:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (last_login_at:TIMESTAMP,),\n  (user_type:VARCHAR, possible values: individual, business, admin.),\n  (status:VARCHAR, possible values: active, inactive, suspended, deleted.),\n  (country:VARCHAR, 2-letter country code.),\n  (address_billing:TEXT,),\n  (address_delivery:TEXT,),\n  (kyc_status:VARCHAR, possible values: pending, approved, rejected.),\n  (kyc_verified_at:TIMESTAMP,),\n]\n# Table: merchants\n[\n  (mid:BIGINT,),\n  (name:VARCHAR,),\n  (description:TEXT,),\n  (website_url:VARCHAR,),\n  (logo_url:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (country:VARCHAR, 2-letter country code.),\n  (state:VARCHAR,),\n  (city:VARCHAR,),\n  (postal_code:VARCHAR,),\n  (address:TEXT,),\n  (status:VARCHAR, possible values: active, inactive, suspended.),\n  (category:VARCHAR,),\n  (sub_category:VARCHAR,),\n  (mcc:INT, Merchant Category Code.),\n  (contact_name:VARCHAR,),\n  (contact_email:VARCHAR,),\n  (contact_phone:VARCHAR,),\n]\n# Table: coupons\n[\n  (cid:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (code:VARCHAR, Value examples: ['TECH20', 'NEWYEAR30', 'DINEDISCOUNT', 'HOME15'].),\n  (description:TEXT, Value examples: ['20% off tech and electronics', '30% off workout gear', 'Get $10 off $50 order', '15% off weekly rental'].),\n  (start_date:DATE, Value examples: ['2023-05-01', '2023-01-01', '2023-06-01', '2023-07-01'].),\n  (end_date:DATE, Value examples: ['2023-05-31', '2023-01-15', '2023-06-30', '2023-08-31'].),\n  (discount_type:VARCHAR, possible values: percentage, fixed_amount. Value examples: ['percentage', 'percentage', 'fixed_amount', 'percentage'].),\n  (discount_value:DECIMAL, Value examples: ['20.00', '30.00', '10.00', '15.00'].),\n  (min_purchase_amount:DECIMAL, Value examples: ['100.00', 'NULL', '50.00', '1000.00'].),\n  (max_discount_amount:DECIMAL, Value examples: ['NULL', 'NULL', '10.00', '300.00'].),\n  (redemption_limit:INT, Value examples: ['500', '1000', 'NULL', '200'].),\n  (status:VARCHAR, possible values: active, inactive, expired. Value examples: ['active', 'expired', 'active', 'active'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-04-01 09:00:00', '2022-12-01 12:00:00', '2023-05-15 15:30:00', '2023-05-01 09:15:00'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-04-15 11:30:00', '2023-01-16 18:45:00', 'NULL', 'NULL'].),\n]\n# Table: wallet_transactions_daily\n[\n  (txid:SERIAL,),\n  (sender_id:BIGINT, Value examples: ['1'].),\n  (sender_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (receiver_id:BIGINT, Value examples: ['1'].),\n  (receiver_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (amount:DECIMAL, Value examples: ['99.99'].),\n  (status:VARCHAR, possible values: pending, success, failed, refunded. Value examples: ['success'].),\n  (type:VARCHAR, possible values: credit, debit. Value examples: ['debit'].),\n  (description:TEXT, Value examples: ['Online purchase'].),\n  (coupon_id:BIGINT, NULL if transaction doesn't involve a coupon. Value examples: ['NULL'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:15:30'].),\n  (completed_at:TIMESTAMP, NULL if failed. Value examples: ['2023-06-01 10:15:45'].),\n  (transaction_ref:VARCHAR, randomly generated uuid4 for users' reference. Value examples: ['ad154bf7-8185-4230-a8d8-3ef59b4e0012'].),\n  (gateway_name:VARCHAR, Value examples: ['Stripe'].),\n  (gateway_ref:VARCHAR, Value examples: ['tx_123abc456def'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1'].),\n  (ip_address:VARCHAR, Value examples: ['192.168.0.1'].),\n  (user_agent:TEXT, Value examples: ['Mozilla/5.0 (iPhone'].),\n]\n# Table: wallet_user_balance_daily\n[\n  (user_id:BIGINT, Value examples: ['1', '2'].),\n  (balance:DECIMAL, Value examples: ['525.80', '429.76'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: wallet_merchant_balance_daily\n[\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3'].),\n  (balance:DECIMAL, Value examples: ['3897.99', '155.24', '2775.25'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: notifications\n[\n  (id:SERIAL,),\n  (user_id:INT, Value examples: ['1', '1', '2'].),\n  (message:TEXT, Value examples: ['Your order #123abc has been shipped!', 'Get 20% off your next purchase! Limited time offer.', 'A package is being returned to you. Refund processing...'].),\n  (type:VARCHAR, possible values: transaction, promotion, security, general. Value examples: ['transaction', 'promotion', 'transaction'].),\n  (status:VARCHAR, possible values: unread, read, archived. Value examples: ['unread', 'unread', 'read'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:16:00', '2023-06-02 09:00:00', '2023-06-07 10:12:00'].),\n  (read_at:TIMESTAMP, NULL if not read.),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'email', 'mobile_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'NULL', 'mobile_1av8p0'].),\n  (action_url:TEXT, can be external https or deeplink url within the app. Value examples: ['app://orders/123abc', 'https://techmart.com/promo/TECH20', 'app://orders?status=returned'].),\n]\n# Table: user_sessions\n[\n  (user_id:BIGINT, Value examples: ['1', '1', '1'].),\n  (session_start_ts:TIMESTAMP, Value examples: ['2023-06-01 09:45:22', '2023-06-02 13:30:00', '2023-06-06 14:19:00'].),\n  (session_end_ts:TIMESTAMP, Value examples: ['2023-06-01 10:20:35', '2023-06-02 14:15:15', '2023-06-06 14:22:10'].),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'web_app', 'web_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'web_33lq1dh', 'web_33lq1dh'].),\n]\n# Table: user_setting_snapshot\n[\n  (user_id:BIGINT, Value examples: ['1', '4', '5'].),\n  (snapshot_date:DATE, Value examples: ['2023-06-07', '2023-06-07', '2023-06-07'].),\n  (tx_limit_daily:DECIMAL, Value examples: ['1000.00', '5000.00', '100.00'].),\n  (tx_limit_monthly:DECIMAL, Value examples: ['5000.00', '20000.00', '500.00'].),\n  (membership_status:INTEGER, 0 for bronze, 1 for silver, 2 for gold, 3 for platinum, 4 for VIP. Value examples: ['2', '4', '0'].),\n  (password_hash:VARCHAR, Value examples: ['bcryptHash($2yz9!&ka1)', 'bcryptHash(Vacay2023*&!Rm)', 'bcryptHash(cRaf7yCr8zy)'].),\n  (api_key:VARCHAR, Value examples: ['9d61c49b-8977-4914-a36b-80d1445e38fa', 'NULL', 'NULL'].),\n  (verified_devices:TEXT, comma separated list of device ids. Value examples: ['mobile_8fh2k1', 'mobile_34jdkl', 'web_8902wknz'].),\n  (verified_ips:TEXT, comma separated list of IP addresses. Value examples: ['192.168.0.1', '143.92.64.138', '192.64.112.188'].),\n  (mfa_enabled:BOOLEAN, Value examples: ['true', 'false', 'false'].),\n  (marketing_opt_in:BOOLEAN, Value examples: ['false', 'true', 'false'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-07 00:00:00', '2023-06-07 00:00:00', '2023-06-07 00:00:00'].),\n  (PRIMARY:KEY,),\n]\n\n【Foreign keys】\n\n【参考信息】\nTo analyze coupon usage, join the coupons and transactions tables in a CTE, filtering for any required criteria, then aggregate to find the total discount amount TUC = Total number of user sessions in the past month To get user notification preferences, join the users and settings tables in a CTE, selecting the most recent settings snapshot for each user. To get the total number of transactions per user, join the users and transactions tables in a common table expression (CTE), then aggregate by user_id to count transactions\n\n【用户问题】\nWhat is the TUC in the past month, inclusive of 1 month ago? Return the total count.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT COUNT(*) AS TUC FROM consumer_div.user_sessions WHERE session_start_ts >= CURRENT_DATE - INTERVAL '1 month' OR session_end_ts >= CURRENT_DATE - INTERVAL '1 month'",
        "role": "assistant"
      }
    ],
    "db_name": "ewallet",
    "id": 300,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat is the average AMB for user wallets updated in the past week, inclusive of 7 days ago? Return the average balance.\n\n【数据库schema】\n【DB_ID】 ewallet\n【Schema】\n# Table: users\n[\n  (uid:BIGINT,),\n  (username:VARCHAR,),\n  (email:VARCHAR,),\n  (phone_number:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (last_login_at:TIMESTAMP,),\n  (user_type:VARCHAR, possible values: individual, business, admin.),\n  (status:VARCHAR, possible values: active, inactive, suspended, deleted.),\n  (country:VARCHAR, 2-letter country code.),\n  (address_billing:TEXT,),\n  (address_delivery:TEXT,),\n  (kyc_status:VARCHAR, possible values: pending, approved, rejected.),\n  (kyc_verified_at:TIMESTAMP,),\n]\n# Table: merchants\n[\n  (mid:BIGINT,),\n  (name:VARCHAR,),\n  (description:TEXT,),\n  (website_url:VARCHAR,),\n  (logo_url:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (country:VARCHAR, 2-letter country code.),\n  (state:VARCHAR,),\n  (city:VARCHAR,),\n  (postal_code:VARCHAR,),\n  (address:TEXT,),\n  (status:VARCHAR, possible values: active, inactive, suspended.),\n  (category:VARCHAR,),\n  (sub_category:VARCHAR,),\n  (mcc:INT, Merchant Category Code.),\n  (contact_name:VARCHAR,),\n  (contact_email:VARCHAR,),\n  (contact_phone:VARCHAR,),\n]\n# Table: coupons\n[\n  (cid:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (code:VARCHAR, Value examples: ['TECH20', 'NEWYEAR30', 'DINEDISCOUNT', 'HOME15'].),\n  (description:TEXT, Value examples: ['20% off tech and electronics', '30% off workout gear', 'Get $10 off $50 order', '15% off weekly rental'].),\n  (start_date:DATE, Value examples: ['2023-05-01', '2023-01-01', '2023-06-01', '2023-07-01'].),\n  (end_date:DATE, Value examples: ['2023-05-31', '2023-01-15', '2023-06-30', '2023-08-31'].),\n  (discount_type:VARCHAR, possible values: percentage, fixed_amount. Value examples: ['percentage', 'percentage', 'fixed_amount', 'percentage'].),\n  (discount_value:DECIMAL, Value examples: ['20.00', '30.00', '10.00', '15.00'].),\n  (min_purchase_amount:DECIMAL, Value examples: ['100.00', 'NULL', '50.00', '1000.00'].),\n  (max_discount_amount:DECIMAL, Value examples: ['NULL', 'NULL', '10.00', '300.00'].),\n  (redemption_limit:INT, Value examples: ['500', '1000', 'NULL', '200'].),\n  (status:VARCHAR, possible values: active, inactive, expired. Value examples: ['active', 'expired', 'active', 'active'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-04-01 09:00:00', '2022-12-01 12:00:00', '2023-05-15 15:30:00', '2023-05-01 09:15:00'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-04-15 11:30:00', '2023-01-16 18:45:00', 'NULL', 'NULL'].),\n]\n# Table: wallet_transactions_daily\n[\n  (txid:SERIAL,),\n  (sender_id:BIGINT, Value examples: ['1'].),\n  (sender_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (receiver_id:BIGINT, Value examples: ['1'].),\n  (receiver_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (amount:DECIMAL, Value examples: ['99.99'].),\n  (status:VARCHAR, possible values: pending, success, failed, refunded. Value examples: ['success'].),\n  (type:VARCHAR, possible values: credit, debit. Value examples: ['debit'].),\n  (description:TEXT, Value examples: ['Online purchase'].),\n  (coupon_id:BIGINT, NULL if transaction doesn't involve a coupon. Value examples: ['NULL'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:15:30'].),\n  (completed_at:TIMESTAMP, NULL if failed. Value examples: ['2023-06-01 10:15:45'].),\n  (transaction_ref:VARCHAR, randomly generated uuid4 for users' reference. Value examples: ['ad154bf7-8185-4230-a8d8-3ef59b4e0012'].),\n  (gateway_name:VARCHAR, Value examples: ['Stripe'].),\n  (gateway_ref:VARCHAR, Value examples: ['tx_123abc456def'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1'].),\n  (ip_address:VARCHAR, Value examples: ['192.168.0.1'].),\n  (user_agent:TEXT, Value examples: ['Mozilla/5.0 (iPhone'].),\n]\n# Table: wallet_user_balance_daily\n[\n  (user_id:BIGINT, Value examples: ['1', '2'].),\n  (balance:DECIMAL, Value examples: ['525.80', '429.76'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: wallet_merchant_balance_daily\n[\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3'].),\n  (balance:DECIMAL, Value examples: ['3897.99', '155.24', '2775.25'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: notifications\n[\n  (id:SERIAL,),\n  (user_id:INT, Value examples: ['1', '1', '2'].),\n  (message:TEXT, Value examples: ['Your order #123abc has been shipped!', 'Get 20% off your next purchase! Limited time offer.', 'A package is being returned to you. Refund processing...'].),\n  (type:VARCHAR, possible values: transaction, promotion, security, general. Value examples: ['transaction', 'promotion', 'transaction'].),\n  (status:VARCHAR, possible values: unread, read, archived. Value examples: ['unread', 'unread', 'read'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:16:00', '2023-06-02 09:00:00', '2023-06-07 10:12:00'].),\n  (read_at:TIMESTAMP, NULL if not read.),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'email', 'mobile_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'NULL', 'mobile_1av8p0'].),\n  (action_url:TEXT, can be external https or deeplink url within the app. Value examples: ['app://orders/123abc', 'https://techmart.com/promo/TECH20', 'app://orders?status=returned'].),\n]\n# Table: user_sessions\n[\n  (user_id:BIGINT, Value examples: ['1', '1', '1'].),\n  (session_start_ts:TIMESTAMP, Value examples: ['2023-06-01 09:45:22', '2023-06-02 13:30:00', '2023-06-06 14:19:00'].),\n  (session_end_ts:TIMESTAMP, Value examples: ['2023-06-01 10:20:35', '2023-06-02 14:15:15', '2023-06-06 14:22:10'].),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'web_app', 'web_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'web_33lq1dh', 'web_33lq1dh'].),\n]\n# Table: user_setting_snapshot\n[\n  (user_id:BIGINT, Value examples: ['1', '4', '5'].),\n  (snapshot_date:DATE, Value examples: ['2023-06-07', '2023-06-07', '2023-06-07'].),\n  (tx_limit_daily:DECIMAL, Value examples: ['1000.00', '5000.00', '100.00'].),\n  (tx_limit_monthly:DECIMAL, Value examples: ['5000.00', '20000.00', '500.00'].),\n  (membership_status:INTEGER, 0 for bronze, 1 for silver, 2 for gold, 3 for platinum, 4 for VIP. Value examples: ['2', '4', '0'].),\n  (password_hash:VARCHAR, Value examples: ['bcryptHash($2yz9!&ka1)', 'bcryptHash(Vacay2023*&!Rm)', 'bcryptHash(cRaf7yCr8zy)'].),\n  (api_key:VARCHAR, Value examples: ['9d61c49b-8977-4914-a36b-80d1445e38fa', 'NULL', 'NULL'].),\n  (verified_devices:TEXT, comma separated list of device ids. Value examples: ['mobile_8fh2k1', 'mobile_34jdkl', 'web_8902wknz'].),\n  (verified_ips:TEXT, comma separated list of IP addresses. Value examples: ['192.168.0.1', '143.92.64.138', '192.64.112.188'].),\n  (mfa_enabled:BOOLEAN, Value examples: ['true', 'false', 'false'].),\n  (marketing_opt_in:BOOLEAN, Value examples: ['false', 'true', 'false'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-07 00:00:00', '2023-06-07 00:00:00', '2023-06-07 00:00:00'].),\n  (PRIMARY:KEY,),\n]\n\n【Foreign keys】\n\n【参考信息】\nFor coupon usage analysis, join the coupons and wallet_transactions_daily tables in a CTE, filtering for merchants of interest, and aggregate to compute the total discount amount utilized\nTo get the total number of transactions per user, join the users and wallet_transactions_daily tables in a Common Table Expression (CTE), then aggregate by user_id to count the transactions\nTo determine user notification preferences, join the users table with the user_setting_snapshot table in a CTE, selecting the most recent settings snapshot for each user.\nAMB = average balance per user (for the given time duration)\n\n【用户问题】\nWhat is the average AMB for user wallets updated in the past week, inclusive of 7 days ago? Return the average balance.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT AVG(balance) AS AMB FROM consumer_div.wallet_user_balance_daily WHERE updated_at >= CURRENT_DATE - INTERVAL '7 days'",
        "role": "assistant"
      }
    ],
    "db_name": "ewallet",
    "id": 301,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nCalculate the CPUR for each merchant, considering only successful transactions. Return the merchant name and CPUR.\n\n【数据库schema】\n【DB_ID】 ewallet\n【Schema】\n# Table: users\n[\n  (uid:BIGINT,),\n  (username:VARCHAR,),\n  (email:VARCHAR,),\n  (phone_number:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (last_login_at:TIMESTAMP,),\n  (user_type:VARCHAR, possible values: individual, business, admin.),\n  (status:VARCHAR, possible values: active, inactive, suspended, deleted.),\n  (country:VARCHAR, 2-letter country code.),\n  (address_billing:TEXT,),\n  (address_delivery:TEXT,),\n  (kyc_status:VARCHAR, possible values: pending, approved, rejected.),\n  (kyc_verified_at:TIMESTAMP,),\n]\n# Table: merchants\n[\n  (mid:BIGINT,),\n  (name:VARCHAR,),\n  (description:TEXT,),\n  (website_url:VARCHAR,),\n  (logo_url:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (country:VARCHAR, 2-letter country code.),\n  (state:VARCHAR,),\n  (city:VARCHAR,),\n  (postal_code:VARCHAR,),\n  (address:TEXT,),\n  (status:VARCHAR, possible values: active, inactive, suspended.),\n  (category:VARCHAR,),\n  (sub_category:VARCHAR,),\n  (mcc:INT, Merchant Category Code.),\n  (contact_name:VARCHAR,),\n  (contact_email:VARCHAR,),\n  (contact_phone:VARCHAR,),\n]\n# Table: coupons\n[\n  (cid:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (code:VARCHAR, Value examples: ['TECH20', 'NEWYEAR30', 'DINEDISCOUNT', 'HOME15'].),\n  (description:TEXT, Value examples: ['20% off tech and electronics', '30% off workout gear', 'Get $10 off $50 order', '15% off weekly rental'].),\n  (start_date:DATE, Value examples: ['2023-05-01', '2023-01-01', '2023-06-01', '2023-07-01'].),\n  (end_date:DATE, Value examples: ['2023-05-31', '2023-01-15', '2023-06-30', '2023-08-31'].),\n  (discount_type:VARCHAR, possible values: percentage, fixed_amount. Value examples: ['percentage', 'percentage', 'fixed_amount', 'percentage'].),\n  (discount_value:DECIMAL, Value examples: ['20.00', '30.00', '10.00', '15.00'].),\n  (min_purchase_amount:DECIMAL, Value examples: ['100.00', 'NULL', '50.00', '1000.00'].),\n  (max_discount_amount:DECIMAL, Value examples: ['NULL', 'NULL', '10.00', '300.00'].),\n  (redemption_limit:INT, Value examples: ['500', '1000', 'NULL', '200'].),\n  (status:VARCHAR, possible values: active, inactive, expired. Value examples: ['active', 'expired', 'active', 'active'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-04-01 09:00:00', '2022-12-01 12:00:00', '2023-05-15 15:30:00', '2023-05-01 09:15:00'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-04-15 11:30:00', '2023-01-16 18:45:00', 'NULL', 'NULL'].),\n]\n# Table: wallet_transactions_daily\n[\n  (txid:SERIAL,),\n  (sender_id:BIGINT, Value examples: ['1'].),\n  (sender_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (receiver_id:BIGINT, Value examples: ['1'].),\n  (receiver_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (amount:DECIMAL, Value examples: ['99.99'].),\n  (status:VARCHAR, possible values: pending, success, failed, refunded. Value examples: ['success'].),\n  (type:VARCHAR, possible values: credit, debit. Value examples: ['debit'].),\n  (description:TEXT, Value examples: ['Online purchase'].),\n  (coupon_id:BIGINT, NULL if transaction doesn't involve a coupon. Value examples: ['NULL'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:15:30'].),\n  (completed_at:TIMESTAMP, NULL if failed. Value examples: ['2023-06-01 10:15:45'].),\n  (transaction_ref:VARCHAR, randomly generated uuid4 for users' reference. Value examples: ['ad154bf7-8185-4230-a8d8-3ef59b4e0012'].),\n  (gateway_name:VARCHAR, Value examples: ['Stripe'].),\n  (gateway_ref:VARCHAR, Value examples: ['tx_123abc456def'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1'].),\n  (ip_address:VARCHAR, Value examples: ['192.168.0.1'].),\n  (user_agent:TEXT, Value examples: ['Mozilla/5.0 (iPhone'].),\n]\n# Table: wallet_user_balance_daily\n[\n  (user_id:BIGINT, Value examples: ['1', '2'].),\n  (balance:DECIMAL, Value examples: ['525.80', '429.76'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: wallet_merchant_balance_daily\n[\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3'].),\n  (balance:DECIMAL, Value examples: ['3897.99', '155.24', '2775.25'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: notifications\n[\n  (id:SERIAL,),\n  (user_id:INT, Value examples: ['1', '1', '2'].),\n  (message:TEXT, Value examples: ['Your order #123abc has been shipped!', 'Get 20% off your next purchase! Limited time offer.', 'A package is being returned to you. Refund processing...'].),\n  (type:VARCHAR, possible values: transaction, promotion, security, general. Value examples: ['transaction', 'promotion', 'transaction'].),\n  (status:VARCHAR, possible values: unread, read, archived. Value examples: ['unread', 'unread', 'read'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:16:00', '2023-06-02 09:00:00', '2023-06-07 10:12:00'].),\n  (read_at:TIMESTAMP, NULL if not read.),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'email', 'mobile_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'NULL', 'mobile_1av8p0'].),\n  (action_url:TEXT, can be external https or deeplink url within the app. Value examples: ['app://orders/123abc', 'https://techmart.com/promo/TECH20', 'app://orders?status=returned'].),\n]\n# Table: user_sessions\n[\n  (user_id:BIGINT, Value examples: ['1', '1', '1'].),\n  (session_start_ts:TIMESTAMP, Value examples: ['2023-06-01 09:45:22', '2023-06-02 13:30:00', '2023-06-06 14:19:00'].),\n  (session_end_ts:TIMESTAMP, Value examples: ['2023-06-01 10:20:35', '2023-06-02 14:15:15', '2023-06-06 14:22:10'].),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'web_app', 'web_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'web_33lq1dh', 'web_33lq1dh'].),\n]\n# Table: user_setting_snapshot\n[\n  (user_id:BIGINT, Value examples: ['1', '4', '5'].),\n  (snapshot_date:DATE, Value examples: ['2023-06-07', '2023-06-07', '2023-06-07'].),\n  (tx_limit_daily:DECIMAL, Value examples: ['1000.00', '5000.00', '100.00'].),\n  (tx_limit_monthly:DECIMAL, Value examples: ['5000.00', '20000.00', '500.00'].),\n  (membership_status:INTEGER, 0 for bronze, 1 for silver, 2 for gold, 3 for platinum, 4 for VIP. Value examples: ['2', '4', '0'].),\n  (password_hash:VARCHAR, Value examples: ['bcryptHash($2yz9!&ka1)', 'bcryptHash(Vacay2023*&!Rm)', 'bcryptHash(cRaf7yCr8zy)'].),\n  (api_key:VARCHAR, Value examples: ['9d61c49b-8977-4914-a36b-80d1445e38fa', 'NULL', 'NULL'].),\n  (verified_devices:TEXT, comma separated list of device ids. Value examples: ['mobile_8fh2k1', 'mobile_34jdkl', 'web_8902wknz'].),\n  (verified_ips:TEXT, comma separated list of IP addresses. Value examples: ['192.168.0.1', '143.92.64.138', '192.64.112.188'].),\n  (mfa_enabled:BOOLEAN, Value examples: ['true', 'false', 'false'].),\n  (marketing_opt_in:BOOLEAN, Value examples: ['false', 'true', 'false'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-07 00:00:00', '2023-06-07 00:00:00', '2023-06-07 00:00:00'].),\n  (PRIMARY:KEY,),\n]\n\n【Foreign keys】\n\n【参考信息】\nTo get the total number of transactions per user, join the users and wallet_transactions tables, then aggregate by user_id To analyze user engagement, join the users and user_sessions tables, then aggregate to calculate the total session duration per user for a given period. CPUR (coupon usage rate) = number of distinct coupons used / number of distinct transactions To get user notification preferences, join the users and user_settings tables, then select the latest settings for each user\n\n【用户问题】\nCalculate the CPUR for each merchant, considering only successful transactions. Return the merchant name and CPUR.\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT m.name, (COUNT(DISTINCT c.cid) * 1.0 / NULLIF(COUNT(DISTINCT t.txid), 0)) AS cpur FROM consumer_div.merchants m JOIN consumer_div.coupons c ON m.mid = c.merchant_id JOIN consumer_div.wallet_transactions_daily t ON c.cid = t.coupon_id AND t.status = 'success' GROUP BY m.name;",
        "role": "assistant"
      }
    ],
    "db_name": "ewallet",
    "id": 302,
    "sql_type": "postgresql",
    "test": 0
  },
  {
    "conversations": [
      {
        "content": "你是一名PostgreSQL专家，现在需要阅读并理解下面的【数据库schema】描述，以及可能用到的【参考信息】，并运用PostgreSQL知识生成sql语句回答【用户问题】。\n【用户问题】\nWhat was the STR for wallet transactions in the previous month?\n\n【数据库schema】\n【DB_ID】 ewallet\n【Schema】\n# Table: users\n[\n  (uid:BIGINT,),\n  (username:VARCHAR,),\n  (email:VARCHAR,),\n  (phone_number:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (last_login_at:TIMESTAMP,),\n  (user_type:VARCHAR, possible values: individual, business, admin.),\n  (status:VARCHAR, possible values: active, inactive, suspended, deleted.),\n  (country:VARCHAR, 2-letter country code.),\n  (address_billing:TEXT,),\n  (address_delivery:TEXT,),\n  (kyc_status:VARCHAR, possible values: pending, approved, rejected.),\n  (kyc_verified_at:TIMESTAMP,),\n]\n# Table: merchants\n[\n  (mid:BIGINT,),\n  (name:VARCHAR,),\n  (description:TEXT,),\n  (website_url:VARCHAR,),\n  (logo_url:VARCHAR,),\n  (created_at:TIMESTAMP,),\n  (country:VARCHAR, 2-letter country code.),\n  (state:VARCHAR,),\n  (city:VARCHAR,),\n  (postal_code:VARCHAR,),\n  (address:TEXT,),\n  (status:VARCHAR, possible values: active, inactive, suspended.),\n  (category:VARCHAR,),\n  (sub_category:VARCHAR,),\n  (mcc:INT, Merchant Category Code.),\n  (contact_name:VARCHAR,),\n  (contact_email:VARCHAR,),\n  (contact_phone:VARCHAR,),\n]\n# Table: coupons\n[\n  (cid:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3', '4'].),\n  (code:VARCHAR, Value examples: ['TECH20', 'NEWYEAR30', 'DINEDISCOUNT', 'HOME15'].),\n  (description:TEXT, Value examples: ['20% off tech and electronics', '30% off workout gear', 'Get $10 off $50 order', '15% off weekly rental'].),\n  (start_date:DATE, Value examples: ['2023-05-01', '2023-01-01', '2023-06-01', '2023-07-01'].),\n  (end_date:DATE, Value examples: ['2023-05-31', '2023-01-15', '2023-06-30', '2023-08-31'].),\n  (discount_type:VARCHAR, possible values: percentage, fixed_amount. Value examples: ['percentage', 'percentage', 'fixed_amount', 'percentage'].),\n  (discount_value:DECIMAL, Value examples: ['20.00', '30.00', '10.00', '15.00'].),\n  (min_purchase_amount:DECIMAL, Value examples: ['100.00', 'NULL', '50.00', '1000.00'].),\n  (max_discount_amount:DECIMAL, Value examples: ['NULL', 'NULL', '10.00', '300.00'].),\n  (redemption_limit:INT, Value examples: ['500', '1000', 'NULL', '200'].),\n  (status:VARCHAR, possible values: active, inactive, expired. Value examples: ['active', 'expired', 'active', 'active'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-04-01 09:00:00', '2022-12-01 12:00:00', '2023-05-15 15:30:00', '2023-05-01 09:15:00'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-04-15 11:30:00', '2023-01-16 18:45:00', 'NULL', 'NULL'].),\n]\n# Table: wallet_transactions_daily\n[\n  (txid:SERIAL,),\n  (sender_id:BIGINT, Value examples: ['1'].),\n  (sender_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (receiver_id:BIGINT, Value examples: ['1'].),\n  (receiver_type:INT, 0 for user, 1 for merchant. Value examples: ['0'].),\n  (amount:DECIMAL, Value examples: ['99.99'].),\n  (status:VARCHAR, possible values: pending, success, failed, refunded. Value examples: ['success'].),\n  (type:VARCHAR, possible values: credit, debit. Value examples: ['debit'].),\n  (description:TEXT, Value examples: ['Online purchase'].),\n  (coupon_id:BIGINT, NULL if transaction doesn't involve a coupon. Value examples: ['NULL'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:15:30'].),\n  (completed_at:TIMESTAMP, NULL if failed. Value examples: ['2023-06-01 10:15:45'].),\n  (transaction_ref:VARCHAR, randomly generated uuid4 for users' reference. Value examples: ['ad154bf7-8185-4230-a8d8-3ef59b4e0012'].),\n  (gateway_name:VARCHAR, Value examples: ['Stripe'].),\n  (gateway_ref:VARCHAR, Value examples: ['tx_123abc456def'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1'].),\n  (ip_address:VARCHAR, Value examples: ['192.168.0.1'].),\n  (user_agent:TEXT, Value examples: ['Mozilla/5.0 (iPhone'].),\n]\n# Table: wallet_user_balance_daily\n[\n  (user_id:BIGINT, Value examples: ['1', '2'].),\n  (balance:DECIMAL, Value examples: ['525.80', '429.76'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: wallet_merchant_balance_daily\n[\n  (merchant_id:BIGINT, Value examples: ['1', '2', '3'].),\n  (balance:DECIMAL, Value examples: ['3897.99', '155.24', '2775.25'].),\n  (updated_at:TIMESTAMP, Value examples: ['2023-06-07 23:59:59', '2023-06-07 23:59:59', '2023-06-07 23:59:59'].),\n]\n# Table: notifications\n[\n  (id:SERIAL,),\n  (user_id:INT, Value examples: ['1', '1', '2'].),\n  (message:TEXT, Value examples: ['Your order #123abc has been shipped!', 'Get 20% off your next purchase! Limited time offer.', 'A package is being returned to you. Refund processing...'].),\n  (type:VARCHAR, possible values: transaction, promotion, security, general. Value examples: ['transaction', 'promotion', 'transaction'].),\n  (status:VARCHAR, possible values: unread, read, archived. Value examples: ['unread', 'unread', 'read'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-01 10:16:00', '2023-06-02 09:00:00', '2023-06-07 10:12:00'].),\n  (read_at:TIMESTAMP, NULL if not read.),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'email', 'mobile_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'NULL', 'mobile_1av8p0'].),\n  (action_url:TEXT, can be external https or deeplink url within the app. Value examples: ['app://orders/123abc', 'https://techmart.com/promo/TECH20', 'app://orders?status=returned'].),\n]\n# Table: user_sessions\n[\n  (user_id:BIGINT, Value examples: ['1', '1', '1'].),\n  (session_start_ts:TIMESTAMP, Value examples: ['2023-06-01 09:45:22', '2023-06-02 13:30:00', '2023-06-06 14:19:00'].),\n  (session_end_ts:TIMESTAMP, Value examples: ['2023-06-01 10:20:35', '2023-06-02 14:15:15', '2023-06-06 14:22:10'].),\n  (device_type:VARCHAR, possible values: mobile_app, web_app, email, sms. Value examples: ['mobile_app', 'web_app', 'web_app'].),\n  (device_id:VARCHAR, Value examples: ['mobile_8fh2k1', 'web_33lq1dh', 'web_33lq1dh'].),\n]\n# Table: user_setting_snapshot\n[\n  (user_id:BIGINT, Value examples: ['1', '4', '5'].),\n  (snapshot_date:DATE, Value examples: ['2023-06-07', '2023-06-07', '2023-06-07'].),\n  (tx_limit_daily:DECIMAL, Value examples: ['1000.00', '5000.00', '100.00'].),\n  (tx_limit_monthly:DECIMAL, Value examples: ['5000.00', '20000.00', '500.00'].),\n  (membership_status:INTEGER, 0 for bronze, 1 for silver, 2 for gold, 3 for platinum, 4 for VIP. Value examples: ['2', '4', '0'].),\n  (password_hash:VARCHAR, Value examples: ['bcryptHash($2yz9!&ka1)', 'bcryptHash(Vacay2023*&!Rm)', 'bcryptHash(cRaf7yCr8zy)'].),\n  (api_key:VARCHAR, Value examples: ['9d61c49b-8977-4914-a36b-80d1445e38fa', 'NULL', 'NULL'].),\n  (verified_devices:TEXT, comma separated list of device ids. Value examples: ['mobile_8fh2k1', 'mobile_34jdkl', 'web_8902wknz'].),\n  (verified_ips:TEXT, comma separated list of IP addresses. Value examples: ['192.168.0.1', '143.92.64.138', '192.64.112.188'].),\n  (mfa_enabled:BOOLEAN, Value examples: ['true', 'false', 'false'].),\n  (marketing_opt_in:BOOLEAN, Value examples: ['false', 'true', 'false'].),\n  (created_at:TIMESTAMP, Value examples: ['2023-06-07 00:00:00', '2023-06-07 00:00:00', '2023-06-07 00:00:00'].),\n  (PRIMARY:KEY,),\n]\n\n【Foreign keys】\n\n【参考信息】\nTo analyze user engagement, join the users and sessions tables in a CTE, then aggregate to measure total session length per user for a specified period.\nTo get user notification preferences, join the users and settings tables in a CTE, then filter for the most recent settings per user\nSTR (success transaction rate) = number of successful transactions / total number of transactions\nTo analyze coupon usage, join the coupons and transactions tables in a CTE, filter for a particular merchant, then aggregate to calculate the total discount value\n\n【用户问题】\nWhat was the STR for wallet transactions in the previous month?\n\n```sql",
        "role": "user"
      },
      {
        "content": "SELECT (SUM(CASE WHEN status = 'success' THEN 1 ELSE 0 END) * 1.0 / COUNT(*)) AS STR FROM consumer_div.wallet_transactions_daily WHERE created_at >= DATE_TRUNC('month', CURRENT_DATE - INTERVAL '1 month') AND created_at < DATE_TRUNC('month', CURRENT_DATE)",
        "role": "assistant"
      }
    ],
    "db_name": "ewallet",
    "id": 303,
    "sql_type": "postgresql",
    "test": 0
  }
]